(global["webpackJsonp"] = global["webpackJsonp"] || []).push([["vendor"],{

/***/ "../node_modules/css-loader/dist/cjs.js?!../node_modules/nativescript-theme-core/css/core.light.css":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("../node_modules/css-loader/dist/runtime/api.js")(false);
// Module
exports.push([module.i, "/*!\r\n * NativeScript Theme v1.0.6 (https://nativescript.org)\r\n * Copyright 2016-2016 The Theme Authors\r\n * Copyright 2016-2016 Telerik\r\n * Licensed under MIT (https://github.com/NativeScript/theme/blob/master/LICENSE)\r\n */.c-white{color:#fff}.c-bg-white{background-color:#fff}.c-black{color:#000}.c-bg-black{background-color:#000}.c-aqua{color:#00caab}.c-bg-aqua{background-color:#00caab}.c-blue{color:#3d5afe}.c-bg-blue{background-color:#3d5afe}.c-charcoal{color:#303030}.c-bg-charcoal{background-color:#303030}.c-brown{color:#795548}.c-bg-brown{background-color:#795548}.c-forest{color:#006968}.c-bg-forest{background-color:#006968}.c-grey{color:#e0e0e0}.c-bg-grey{background-color:#e0e0e0}.c-grey-light{color:#bababa}.c-bg-grey-light{background-color:#bababa}.c-grey-dark{color:#5c687c}.c-bg-grey-dark{background-color:#5c687c}.c-purple{color:#8130ff}.c-bg-purple{background-color:#8130ff}.c-lemon{color:#ffea00}.c-bg-lemon{background-color:#ffea00}.c-lime{color:#aee406}.c-bg-lime{background-color:#aee406}.c-orange{color:#f57c00}.c-bg-orange{background-color:#f57c00}.c-ruby{color:#ff1744}.c-bg-ruby{background-color:#ff1744}.c-sky{color:#30bcff}.c-bg-sky{background-color:#30bcff}.w-full{width:100%}.w-100{width:100}.h-full{height:100%}.h-100{height:100}.m-0{margin:0}.m-t-0{margin-top:0}.m-r-0{margin-right:0}.m-b-0{margin-bottom:0}.m-l-0{margin-left:0}.m-x-0{margin-right:0;margin-left:0}.m-y-0{margin-top:0;margin-bottom:0}.m-2{margin:2}.m-t-2{margin-top:2}.m-r-2{margin-right:2}.m-b-2{margin-bottom:2}.m-l-2{margin-left:2}.m-x-2{margin-right:2;margin-left:2}.m-y-2{margin-top:2;margin-bottom:2}.m-4{margin:4}.m-t-4{margin-top:4}.m-r-4{margin-right:4}.m-b-4{margin-bottom:4}.m-l-4{margin-left:4}.m-x-4{margin-right:4;margin-left:4}.m-y-4{margin-top:4;margin-bottom:4}.m-5{margin:5}.m-t-5{margin-top:5}.m-r-5{margin-right:5}.m-b-5{margin-bottom:5}.m-l-5{margin-left:5}.m-x-5{margin-right:5;margin-left:5}.m-y-5{margin-top:5;margin-bottom:5}.m-8{margin:8}.m-t-8{margin-top:8}.m-r-8{margin-right:8}.m-b-8{margin-bottom:8}.m-l-8{margin-left:8}.m-x-8{margin-right:8;margin-left:8}.m-y-8{margin-top:8;margin-bottom:8}.m-10{margin:10}.m-t-10{margin-top:10}.m-r-10{margin-right:10}.m-b-10{margin-bottom:10}.m-l-10{margin-left:10}.m-x-10{margin-right:10;margin-left:10}.m-y-10{margin-top:10;margin-bottom:10}.m-12{margin:12}.m-t-12{margin-top:12}.m-r-12{margin-right:12}.m-b-12{margin-bottom:12}.m-l-12{margin-left:12}.m-x-12{margin-right:12;margin-left:12}.m-y-12{margin-top:12;margin-bottom:12}.m-15{margin:15}.m-t-15{margin-top:15}.m-r-15{margin-right:15}.m-b-15{margin-bottom:15}.m-l-15{margin-left:15}.m-x-15{margin-right:15;margin-left:15}.m-y-15{margin-top:15;margin-bottom:15}.m-16{margin:16}.m-t-16{margin-top:16}.m-r-16{margin-right:16}.m-b-16{margin-bottom:16}.m-l-16{margin-left:16}.m-x-16{margin-right:16;margin-left:16}.m-y-16{margin-top:16;margin-bottom:16}.m-20{margin:20}.m-t-20{margin-top:20}.m-r-20{margin-right:20}.m-b-20{margin-bottom:20}.m-l-20{margin-left:20}.m-x-20{margin-right:20;margin-left:20}.m-y-20{margin-top:20;margin-bottom:20}.m-24{margin:24}.m-t-24{margin-top:24}.m-r-24{margin-right:24}.m-b-24{margin-bottom:24}.m-l-24{margin-left:24}.m-x-24{margin-right:24;margin-left:24}.m-y-24{margin-top:24;margin-bottom:24}.m-25{margin:25}.m-t-25{margin-top:25}.m-r-25{margin-right:25}.m-b-25{margin-bottom:25}.m-l-25{margin-left:25}.m-x-25{margin-right:25;margin-left:25}.m-y-25{margin-top:25;margin-bottom:25}.m-28{margin:28}.m-t-28{margin-top:28}.m-r-28{margin-right:28}.m-b-28{margin-bottom:28}.m-l-28{margin-left:28}.m-x-28{margin-right:28;margin-left:28}.m-y-28{margin-top:28;margin-bottom:28}.m-30{margin:30}.m-t-30{margin-top:30}.m-r-30{margin-right:30}.m-b-30{margin-bottom:30}.m-l-30{margin-left:30}.m-x-30{margin-right:30;margin-left:30}.m-y-30{margin-top:30;margin-bottom:30}.p-0{padding:0}.p-t-0{padding-top:0}.p-r-0{padding-right:0}.p-b-0{padding-bottom:0}.p-l-0{padding-left:0}.p-x-0{padding-right:0;padding-left:0}.p-y-0{padding-top:0;padding-bottom:0}.p-2{padding:2}.p-t-2{padding-top:2}.p-r-2{padding-right:2}.p-b-2{padding-bottom:2}.p-l-2{padding-left:2}.p-x-2{padding-right:2;padding-left:2}.p-y-2{padding-top:2;padding-bottom:2}.p-4{padding:4}.p-t-4{padding-top:4}.p-r-4{padding-right:4}.p-b-4{padding-bottom:4}.p-l-4{padding-left:4}.p-x-4{padding-right:4;padding-left:4}.p-y-4{padding-top:4;padding-bottom:4}.p-5{padding:5}.p-t-5{padding-top:5}.p-r-5{padding-right:5}.p-b-5{padding-bottom:5}.p-l-5{padding-left:5}.p-x-5{padding-right:5;padding-left:5}.p-y-5{padding-top:5;padding-bottom:5}.p-8{padding:8}.p-t-8{padding-top:8}.p-r-8{padding-right:8}.p-b-8{padding-bottom:8}.p-l-8{padding-left:8}.p-x-8{padding-right:8;padding-left:8}.p-y-8{padding-top:8;padding-bottom:8}.p-10{padding:10}.p-t-10{padding-top:10}.p-r-10{padding-right:10}.p-b-10{padding-bottom:10}.p-l-10{padding-left:10}.p-x-10{padding-right:10;padding-left:10}.p-y-10{padding-top:10;padding-bottom:10}.p-12{padding:12}.p-t-12{padding-top:12}.p-r-12{padding-right:12}.p-b-12{padding-bottom:12}.p-l-12{padding-left:12}.p-x-12{padding-right:12;padding-left:12}.p-y-12{padding-top:12;padding-bottom:12}.p-15{padding:15}.p-t-15{padding-top:15}.p-r-15{padding-right:15}.p-b-15{padding-bottom:15}.p-l-15{padding-left:15}.p-x-15{padding-right:15;padding-left:15}.p-y-15{padding-top:15;padding-bottom:15}.p-16{padding:16}.p-t-16{padding-top:16}.p-r-16{padding-right:16}.p-b-16{padding-bottom:16}.p-l-16{padding-left:16}.p-x-16{padding-right:16;padding-left:16}.p-y-16{padding-top:16;padding-bottom:16}.p-20{padding:20}.p-t-20{padding-top:20}.p-r-20{padding-right:20}.p-b-20{padding-bottom:20}.p-l-20{padding-left:20}.p-x-20{padding-right:20;padding-left:20}.p-y-20{padding-top:20;padding-bottom:20}.p-24{padding:24}.p-t-24{padding-top:24}.p-r-24{padding-right:24}.p-b-24{padding-bottom:24}.p-l-24{padding-left:24}.p-x-24{padding-right:24;padding-left:24}.p-y-24{padding-top:24;padding-bottom:24}.p-25{padding:25}.p-t-25{padding-top:25}.p-r-25{padding-right:25}.p-b-25{padding-bottom:25}.p-l-25{padding-left:25}.p-x-25{padding-right:25;padding-left:25}.p-y-25{padding-top:25;padding-bottom:25}.p-28{padding:28}.p-t-28{padding-top:28}.p-r-28{padding-right:28}.p-b-28{padding-bottom:28}.p-l-28{padding-left:28}.p-x-28{padding-right:28;padding-left:28}.p-y-28{padding-top:28;padding-bottom:28}.p-30{padding:30}.p-t-30{padding-top:30}.p-r-30{padding-right:30}.p-b-30{padding-bottom:30}.p-l-30{padding-left:30}.p-x-30{padding-right:30;padding-left:30}.p-y-30{padding-top:30;padding-bottom:30}.hr-light{height:1;background-color:#e0e0e0;width:100%}.hr-dark{height:1;background-color:#303030;width:100%}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.text-lowercase{text-transform:lowercase}.text-uppercase{text-transform:uppercase}.text-capitalize{text-transform:capitalize}.font-weight-normal{font-weight:normal}.font-weight-bold{font-weight:bold}.font-italic{font-style:italic}.t-10{font-size:10}.t-12{font-size:12}.t-14{font-size:14}.t-15{font-size:15}.t-16{font-size:16}.t-17{font-size:17}.t-18{font-size:18}.t-19{font-size:19}.t-20{font-size:20}.t-25{font-size:25}.t-30{font-size:30}.img-rounded{border-radius:5}.img-circle{border-radius:20}.img-thumbnail{border-radius:0}.invisible{visibility:collapse}.pull-left{horizontal-align:left}.pull-right{horizontal-align:right}.m-x-auto{horizontal-align:center}.m-y-auto{vertical-align:center}.text-primary{color:#30bcff}.text-danger{color:#d50000}.text-muted{color:#9e9e9e}.bg-primary{background-color:#30bcff;color:#fff}.bg-danger{background-color:#d50000;color:#fff}.action-bar{background-color:#F8F8F8;color:#212121}.action-bar .action-bar-title{font-weight:bold;font-size:17;vertical-align:center}.action-bar .action-item{font-weight:normal}.activity-indicator{color:#30bcff;width:30;height:30}.btn{color:#30bcff;background-color:transparent;min-height:36;min-width:64;padding:10 10 10 10;font-size:18;margin:8 16 8 16}.btn.btn-active:highlighted{color:#fff;background-color:#c0ebff}.btn-primary{background-color:#30bcff;border-color:#30bcff;color:#fff}.btn-primary.btn-active:highlighted{background-color:#01a0ec;border-color:#01a0ec}.btn-primary.btn-aqua{background-color:#00caab}.btn-primary.btn-blue{background-color:#3d5afe}.btn-primary.btn-brown{background-color:#795548}.btn-primary.btn-forest{background-color:#006968}.btn-primary.btn-grey{background-color:#5c687c}.btn-primary.btn-lemon{background-color:#ffea00;color:#000}.btn-primary.btn-lime{background-color:#aee406;color:#000}.btn-primary.btn-orange{background-color:#f57c00}.btn-primary.btn-purple{background-color:#8130ff}.btn-primary.btn-ruby{background-color:#ff1744}.btn-primary.btn-sky{background-color:#30bcff}.btn-outline{background-color:transparent;border-color:#30bcff;color:#30bcff}.btn-outline.btn-active:highlighted{background-color:#c0ebff}.btn[isEnabled=false]{color:#a4a4a4;background-color:#e0e0e0;border-color:#e0e0e0}.fa{font-family:FontAwesome, fontawesome-webfont}.form .input{padding:16 8 16 8;background-color:transparent}.form .input.input-border{border-width:1;border-color:#e0e0e0;border-radius:2;padding:16}.form .input.input-rounded{border-width:1;border-color:#e0e0e0;border-radius:28;padding:16}.form .input[isEnabled='false']{background-color:#fafafa}.form .input-field{margin:8}.form .input-field .label{font-size:12;color:#bababa}.form .input-field .input{padding:0;margin:0 0 8 0}.form .input-field .hr-light.active,.form .input-field .hr-dark.active{background-color:#30bcff}.form .input-field.input-sides .label{font-size:18;margin:0 0 8 0}.h1,.h2,.h3,.h4,.h5,.h6{margin-bottom:4;font-weight:normal;color:#212121}.body,.body2,.footnote{font-weight:normal;color:#757575}.h1{font-size:32}.h2{font-size:22}.h3{font-size:15}.h4{font-size:12}.h5{font-size:11}.h6{font-size:10}.body{font-size:14}.body2{font-size:17}.footnote{font-size:13}.list-group .list-group-item{color:#212121;font-size:16;margin:0;padding:16}.list-group .list-group-item Label{vertical-align:center}.list-group .list-group-item .thumb{stretch:fill;width:40;height:40;margin-right:16}.list-group .list-group-item.active{background-color:#e0e0e0}.list-group .list-group-item .list-group-item-text{color:#757575;font-size:14}.page{background-color:#fff}.progress{color:#30bcff;background-color:#bababa}.segmented-bar{font-size:13;background-color:#fff;color:#212121;selected-background-color:#30bcff}.sidedrawer-left,.sidedrawer-center{background-color:#fafafa}.sidedrawer-header{background-color:#fafafa;height:148;width:100%}.sidedrawer-left .sidedrawer-header{padding:16 16 0 16}.sidedrawer-center .sidedrawer-header{padding:20 15 0 15}.sidedrawer-header-image{background-color:#e0e0e0}.sidedrawer-left .sidedrawer-header-image{height:64;width:64;border-radius:32;horizontal-align:left;margin-bottom:36}.sidedrawer-center .sidedrawer-header-image{height:74;width:74;border-radius:37;horizontal-align:center;margin-bottom:24}.sidedrawer-header-brand{color:#737373}.sidedrawer-left .sidedrawer-header-brand{horizontal-align:left;font-size:14}.sidedrawer-center .sidedrawer-header-brand{horizontal-align:center;font-size:15}.sidedrawer-list-item{height:48;horizontal-align:left;width:100%;orientation:horizontal}.sidedrawer-list-item .sidedrawer-list-item-icon{width:24;text-align:center;font-size:20;height:48;vertical-align:center}.sidedrawer-list-item.active{color:#fff;background-color:#30bcff}.sidedrawer-list-item.active .sidedrawer-list-item-icon{color:#fff}.sidedrawer-left .sidedrawer-list-item-icon{margin:0 16 0 16}.sidedrawer-center .sidedrawer-list-item-icon{margin:0 0 0 15}.sidedrawer-list-item-text{horizontal-align:left;text-align:left;font-size:15;background-color:transparent;border-width:0.1;width:80%;vertical-align:center}.sidedrawer-left .sidedrawer-list-item-text{padding-left:16}.sidedrawer-center .sidedrawer-list-item-text{padding-left:15}.slider{background-color:#30bcff}.slider[isEnabled=false]{background-color:#e0e0e0;color:#e0e0e0}.switch[checked=true]{background-color:#30bcff;color:#30bcff}.switch[checked=true][isEnabled=false]{background-color:#e0e0e0;color:#fff}.switch[isEnabled=false]{background-color:#e0e0e0;color:#e0e0e0}.tab-view{selected-color:#30bcff;tabs-background-color:#fff}.tab-view .tab-view-item{background-color:#fff;tabs-background-color:#fff}#login-background{margin-top:-20;background-size:cover;background-position:center}.login-wrap{padding:0 40}.logo-wrap{margin:60 0 10 0;padding:20 0}.logo-wrap .login-logo{text-align:center;font-size:30;font-weight:bold;margin-bottom:10;opacity:1;color:#212121;opacity:.9}.logo-wrap .login-logo-sub{color:#212121;opacity:.8;text-align:center}.login-wrapper{padding:20;background-color:#fff;border-radius:3}.login-wrapper TextField{padding:10 10;margin:10 0 0 0}.go-back{font-size:14;text-align:center;color:#212121;margin-top:10}.action-bar .action-bar-title{font-weight:500;font-size:20}.action-bar .action-item{android-elevation:0;background-color:rgba(255,0,0,0);border-color:rgba(255,0,0,0);border-width:1}.btn{font-family:'Roboto Medium';font-size:14}.btn-primary{border-color:rgba(255,0,0,0)}.btn-outline{android-elevation:0;background-color:rgba(255,0,0,0);border-width:1;border-color:#30bcff;height:36;padding:0}.btn-rounded-sm{border-radius:2;height:36;padding:0}.btn-rounded-lg{border-radius:40;height:36;padding:0}.form{font-family:'Roboto Regular'}.form .input{font-size:16}.h1{font-size:34}.h2{font-size:24}.h3{font-size:16}.h5{font-size:11;font-weight:bold}.body2{font-size:14;font-weight:500}.sidedrawer-list-item-icon{margin:0 16 0 16;padding-top:14}.sidedrawer-list-item-icon,.sidedrawer-list-item{color:#737373}.sidedrawer-list-item{font-family:'Roboto Medium';font-size:14}.slider{color:#30bcff;margin:20 16}.switch{margin:14 16;color:#e0e0e0;background-color:#e0e0e0}.switch[checked=true]{color:#30bcff}\n", ""]);



/***/ }),

/***/ "../node_modules/css-loader/dist/runtime/api.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/*
  MIT License http://www.opensource.org/licenses/mit-license.php
  Author Tobias Koppers @sokra
*/
// css base code, injected by the css-loader
module.exports = function (useSourceMap) {
  var list = []; // return the list of modules as css string

  list.toString = function toString() {
    return this.map(function (item) {
      var content = cssWithMappingToString(item, useSourceMap);

      if (item[2]) {
        return '@media ' + item[2] + '{' + content + '}';
      } else {
        return content;
      }
    }).join('');
  }; // import a list of modules into the list


  list.i = function (modules, mediaQuery) {
    if (typeof modules === 'string') {
      modules = [[null, modules, '']];
    }

    var alreadyImportedModules = {};

    for (var i = 0; i < this.length; i++) {
      var id = this[i][0];

      if (id != null) {
        alreadyImportedModules[id] = true;
      }
    }

    for (i = 0; i < modules.length; i++) {
      var item = modules[i]; // skip already imported module
      // this implementation is not 100% perfect for weird media query combinations
      // when a module is imported multiple times with different media queries.
      // I hope this will never occur (Hey this way we have smaller bundles)

      if (item[0] == null || !alreadyImportedModules[item[0]]) {
        if (mediaQuery && !item[2]) {
          item[2] = mediaQuery;
        } else if (mediaQuery) {
          item[2] = '(' + item[2] + ') and (' + mediaQuery + ')';
        }

        list.push(item);
      }
    }
  };

  return list;
};

function cssWithMappingToString(item, useSourceMap) {
  var content = item[1] || '';
  var cssMapping = item[3];

  if (!cssMapping) {
    return content;
  }

  if (useSourceMap && typeof btoa === 'function') {
    var sourceMapping = toComment(cssMapping);
    var sourceURLs = cssMapping.sources.map(function (source) {
      return '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */';
    });
    return [content].concat(sourceURLs).concat([sourceMapping]).join('\n');
  }

  return [content].join('\n');
} // Adapted from convert-source-map (MIT)


function toComment(sourceMap) {
  // eslint-disable-next-line no-undef
  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));
  var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;
  return '/*# ' + data + ' */';
}

/***/ }),

/***/ "../node_modules/css-unit-converter/index.js":
/***/ (function(module, exports) {

var conversions = {
    // length
    'px': {
        'px': 1,
        'cm': 96.0/2.54,
        'mm': 96.0/25.4,
        'in': 96,
        'pt': 96.0/72.0,
        'pc': 16
    },
    'cm': {
        'px': 2.54/96.0,
        'cm': 1,
        'mm': 0.1,
        'in': 2.54,
        'pt': 2.54/72.0,
        'pc': 2.54/6.0
    },
    'mm': {
        'px': 25.4/96.0,
        'cm': 10,
        'mm': 1,
        'in': 25.4,
        'pt': 25.4/72.0,
        'pc': 25.4/6.0
    },
    'in': {
        'px': 1.0/96.0,
        'cm': 1.0/2.54,
        'mm': 1.0/25.4,
        'in': 1,
        'pt': 1.0/72.0,
        'pc': 1.0/6.0
    },
    'pt': {
        'px': 0.75,
        'cm': 72.0/2.54,
        'mm': 72.0/25.4,
        'in': 72,
        'pt': 1,
        'pc': 12
    },
    'pc': {
        'px': 6.0/96.0,
        'cm': 6.0/2.54,
        'mm': 6.0/25.4,
        'in': 6,
        'pt': 6.0/72.0,
        'pc': 1
    },
    // angle
    'deg': {
        'deg': 1,
        'grad': 0.9,
        'rad': 180/Math.PI,
        'turn': 360
    },
    'grad': {
        'deg': 400/360,
        'grad': 1,
        'rad': 200/Math.PI,
        'turn': 400
    },
    'rad': {
        'deg': Math.PI/180,
        'grad': Math.PI/200,
        'rad': 1,
        'turn': Math.PI*2
    },
    'turn': {
        'deg': 1/360,
        'grad': 1/400,
        'rad': 0.5/Math.PI,
        'turn': 1
    },
    // time
    's': {
        's': 1,
        'ms': 1/1000
    },
    'ms': {
        's': 1000,
        'ms': 1
    },
    // frequency
    'Hz': {
        'Hz': 1,
        'kHz': 1000
    },
    'kHz': {
        'Hz': 1/1000,
        'kHz': 1
    },
    // resolution
    'dpi': {
        'dpi': 1,
        'dpcm': 1.0/2.54,
        'dppx': 1/96
    },
    'dpcm': {
        'dpi': 2.54,
        'dpcm': 1,
        'dppx': 2.54/96.0
    },
    'dppx': {
        'dpi': 96,
        'dpcm': 96.0/2.54,
        'dppx': 1
    }
};

module.exports = function (value, sourceUnit, targetUnit, precision) {
    if (!conversions.hasOwnProperty(targetUnit))
        throw new Error("Cannot convert to " + targetUnit);

    if (!conversions[targetUnit].hasOwnProperty(sourceUnit))
        throw new Error("Cannot convert from " + sourceUnit + " to " + targetUnit);

    precision = Math.pow(10, parseInt(precision) || 5);
    return Math.round((conversions[targetUnit][sourceUnit] * value) * precision) / precision;
};


/***/ }),

/***/ "../node_modules/define-properties/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var keys = __webpack_require__("../node_modules/object-keys/index.js");
var hasSymbols = typeof Symbol === 'function' && typeof Symbol('foo') === 'symbol';

var toStr = Object.prototype.toString;
var concat = Array.prototype.concat;
var origDefineProperty = Object.defineProperty;

var isFunction = function (fn) {
	return typeof fn === 'function' && toStr.call(fn) === '[object Function]';
};

var arePropertyDescriptorsSupported = function () {
	var obj = {};
	try {
		origDefineProperty(obj, 'x', { enumerable: false, value: obj });
		// eslint-disable-next-line no-unused-vars, no-restricted-syntax
		for (var _ in obj) { // jscs:ignore disallowUnusedVariables
			return false;
		}
		return obj.x === obj;
	} catch (e) { /* this is IE 8. */
		return false;
	}
};
var supportsDescriptors = origDefineProperty && arePropertyDescriptorsSupported();

var defineProperty = function (object, name, value, predicate) {
	if (name in object && (!isFunction(predicate) || !predicate())) {
		return;
	}
	if (supportsDescriptors) {
		origDefineProperty(object, name, {
			configurable: true,
			enumerable: false,
			value: value,
			writable: true
		});
	} else {
		object[name] = value;
	}
};

var defineProperties = function (object, map) {
	var predicates = arguments.length > 2 ? arguments[2] : {};
	var props = keys(map);
	if (hasSymbols) {
		props = concat.call(props, Object.getOwnPropertySymbols(map));
	}
	for (var i = 0; i < props.length; i += 1) {
		defineProperty(object, props[i], map[props[i]], predicates[props[i]]);
	}
};

defineProperties.supportsDescriptors = !!supportsDescriptors;

module.exports = defineProperties;


/***/ }),

/***/ "../node_modules/es-abstract/GetIntrinsic.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/* globals
	Atomics,
	SharedArrayBuffer,
*/

var undefined; // eslint-disable-line no-shadow-restricted-names

var $TypeError = TypeError;

var ThrowTypeError = Object.getOwnPropertyDescriptor
	? (function () { return Object.getOwnPropertyDescriptor(arguments, 'callee').get; }())
	: function () { throw new $TypeError(); };

var hasSymbols = __webpack_require__("../node_modules/has-symbols/index.js")();

var getProto = Object.getPrototypeOf || function (x) { return x.__proto__; }; // eslint-disable-line no-proto

var generator; // = function * () {};
var generatorFunction = generator ? getProto(generator) : undefined;
var asyncFn; // async function() {};
var asyncFunction = asyncFn ? asyncFn.constructor : undefined;
var asyncGen; // async function * () {};
var asyncGenFunction = asyncGen ? getProto(asyncGen) : undefined;
var asyncGenIterator = asyncGen ? asyncGen() : undefined;

var TypedArray = typeof Uint8Array === 'undefined' ? undefined : getProto(Uint8Array);

var INTRINSICS = {
	'$ %Array%': Array,
	'$ %ArrayBuffer%': typeof ArrayBuffer === 'undefined' ? undefined : ArrayBuffer,
	'$ %ArrayBufferPrototype%': typeof ArrayBuffer === 'undefined' ? undefined : ArrayBuffer.prototype,
	'$ %ArrayIteratorPrototype%': hasSymbols ? getProto([][Symbol.iterator]()) : undefined,
	'$ %ArrayPrototype%': Array.prototype,
	'$ %ArrayProto_entries%': Array.prototype.entries,
	'$ %ArrayProto_forEach%': Array.prototype.forEach,
	'$ %ArrayProto_keys%': Array.prototype.keys,
	'$ %ArrayProto_values%': Array.prototype.values,
	'$ %AsyncFromSyncIteratorPrototype%': undefined,
	'$ %AsyncFunction%': asyncFunction,
	'$ %AsyncFunctionPrototype%': asyncFunction ? asyncFunction.prototype : undefined,
	'$ %AsyncGenerator%': asyncGen ? getProto(asyncGenIterator) : undefined,
	'$ %AsyncGeneratorFunction%': asyncGenFunction,
	'$ %AsyncGeneratorPrototype%': asyncGenFunction ? asyncGenFunction.prototype : undefined,
	'$ %AsyncIteratorPrototype%': asyncGenIterator && hasSymbols && Symbol.asyncIterator ? asyncGenIterator[Symbol.asyncIterator]() : undefined,
	'$ %Atomics%': typeof Atomics === 'undefined' ? undefined : Atomics,
	'$ %Boolean%': Boolean,
	'$ %BooleanPrototype%': Boolean.prototype,
	'$ %DataView%': typeof DataView === 'undefined' ? undefined : DataView,
	'$ %DataViewPrototype%': typeof DataView === 'undefined' ? undefined : DataView.prototype,
	'$ %Date%': Date,
	'$ %DatePrototype%': Date.prototype,
	'$ %decodeURI%': decodeURI,
	'$ %decodeURIComponent%': decodeURIComponent,
	'$ %encodeURI%': encodeURI,
	'$ %encodeURIComponent%': encodeURIComponent,
	'$ %Error%': Error,
	'$ %ErrorPrototype%': Error.prototype,
	'$ %eval%': eval, // eslint-disable-line no-eval
	'$ %EvalError%': EvalError,
	'$ %EvalErrorPrototype%': EvalError.prototype,
	'$ %Float32Array%': typeof Float32Array === 'undefined' ? undefined : Float32Array,
	'$ %Float32ArrayPrototype%': typeof Float32Array === 'undefined' ? undefined : Float32Array.prototype,
	'$ %Float64Array%': typeof Float64Array === 'undefined' ? undefined : Float64Array,
	'$ %Float64ArrayPrototype%': typeof Float64Array === 'undefined' ? undefined : Float64Array.prototype,
	'$ %Function%': Function,
	'$ %FunctionPrototype%': Function.prototype,
	'$ %Generator%': generator ? getProto(generator()) : undefined,
	'$ %GeneratorFunction%': generatorFunction,
	'$ %GeneratorPrototype%': generatorFunction ? generatorFunction.prototype : undefined,
	'$ %Int8Array%': typeof Int8Array === 'undefined' ? undefined : Int8Array,
	'$ %Int8ArrayPrototype%': typeof Int8Array === 'undefined' ? undefined : Int8Array.prototype,
	'$ %Int16Array%': typeof Int16Array === 'undefined' ? undefined : Int16Array,
	'$ %Int16ArrayPrototype%': typeof Int16Array === 'undefined' ? undefined : Int8Array.prototype,
	'$ %Int32Array%': typeof Int32Array === 'undefined' ? undefined : Int32Array,
	'$ %Int32ArrayPrototype%': typeof Int32Array === 'undefined' ? undefined : Int32Array.prototype,
	'$ %isFinite%': isFinite,
	'$ %isNaN%': isNaN,
	'$ %IteratorPrototype%': hasSymbols ? getProto(getProto([][Symbol.iterator]())) : undefined,
	'$ %JSON%': JSON,
	'$ %JSONParse%': JSON.parse,
	'$ %Map%': typeof Map === 'undefined' ? undefined : Map,
	'$ %MapIteratorPrototype%': typeof Map === 'undefined' || !hasSymbols ? undefined : getProto(new Map()[Symbol.iterator]()),
	'$ %MapPrototype%': typeof Map === 'undefined' ? undefined : Map.prototype,
	'$ %Math%': Math,
	'$ %Number%': Number,
	'$ %NumberPrototype%': Number.prototype,
	'$ %Object%': Object,
	'$ %ObjectPrototype%': Object.prototype,
	'$ %ObjProto_toString%': Object.prototype.toString,
	'$ %ObjProto_valueOf%': Object.prototype.valueOf,
	'$ %parseFloat%': parseFloat,
	'$ %parseInt%': parseInt,
	'$ %Promise%': typeof Promise === 'undefined' ? undefined : Promise,
	'$ %PromisePrototype%': typeof Promise === 'undefined' ? undefined : Promise.prototype,
	'$ %PromiseProto_then%': typeof Promise === 'undefined' ? undefined : Promise.prototype.then,
	'$ %Promise_all%': typeof Promise === 'undefined' ? undefined : Promise.all,
	'$ %Promise_reject%': typeof Promise === 'undefined' ? undefined : Promise.reject,
	'$ %Promise_resolve%': typeof Promise === 'undefined' ? undefined : Promise.resolve,
	'$ %Proxy%': typeof Proxy === 'undefined' ? undefined : Proxy,
	'$ %RangeError%': RangeError,
	'$ %RangeErrorPrototype%': RangeError.prototype,
	'$ %ReferenceError%': ReferenceError,
	'$ %ReferenceErrorPrototype%': ReferenceError.prototype,
	'$ %Reflect%': typeof Reflect === 'undefined' ? undefined : Reflect,
	'$ %RegExp%': RegExp,
	'$ %RegExpPrototype%': RegExp.prototype,
	'$ %Set%': typeof Set === 'undefined' ? undefined : Set,
	'$ %SetIteratorPrototype%': typeof Set === 'undefined' || !hasSymbols ? undefined : getProto(new Set()[Symbol.iterator]()),
	'$ %SetPrototype%': typeof Set === 'undefined' ? undefined : Set.prototype,
	'$ %SharedArrayBuffer%': typeof SharedArrayBuffer === 'undefined' ? undefined : SharedArrayBuffer,
	'$ %SharedArrayBufferPrototype%': typeof SharedArrayBuffer === 'undefined' ? undefined : SharedArrayBuffer.prototype,
	'$ %String%': String,
	'$ %StringIteratorPrototype%': hasSymbols ? getProto(''[Symbol.iterator]()) : undefined,
	'$ %StringPrototype%': String.prototype,
	'$ %Symbol%': hasSymbols ? Symbol : undefined,
	'$ %SymbolPrototype%': hasSymbols ? Symbol.prototype : undefined,
	'$ %SyntaxError%': SyntaxError,
	'$ %SyntaxErrorPrototype%': SyntaxError.prototype,
	'$ %ThrowTypeError%': ThrowTypeError,
	'$ %TypedArray%': TypedArray,
	'$ %TypedArrayPrototype%': TypedArray ? TypedArray.prototype : undefined,
	'$ %TypeError%': $TypeError,
	'$ %TypeErrorPrototype%': $TypeError.prototype,
	'$ %Uint8Array%': typeof Uint8Array === 'undefined' ? undefined : Uint8Array,
	'$ %Uint8ArrayPrototype%': typeof Uint8Array === 'undefined' ? undefined : Uint8Array.prototype,
	'$ %Uint8ClampedArray%': typeof Uint8ClampedArray === 'undefined' ? undefined : Uint8ClampedArray,
	'$ %Uint8ClampedArrayPrototype%': typeof Uint8ClampedArray === 'undefined' ? undefined : Uint8ClampedArray.prototype,
	'$ %Uint16Array%': typeof Uint16Array === 'undefined' ? undefined : Uint16Array,
	'$ %Uint16ArrayPrototype%': typeof Uint16Array === 'undefined' ? undefined : Uint16Array.prototype,
	'$ %Uint32Array%': typeof Uint32Array === 'undefined' ? undefined : Uint32Array,
	'$ %Uint32ArrayPrototype%': typeof Uint32Array === 'undefined' ? undefined : Uint32Array.prototype,
	'$ %URIError%': URIError,
	'$ %URIErrorPrototype%': URIError.prototype,
	'$ %WeakMap%': typeof WeakMap === 'undefined' ? undefined : WeakMap,
	'$ %WeakMapPrototype%': typeof WeakMap === 'undefined' ? undefined : WeakMap.prototype,
	'$ %WeakSet%': typeof WeakSet === 'undefined' ? undefined : WeakSet,
	'$ %WeakSetPrototype%': typeof WeakSet === 'undefined' ? undefined : WeakSet.prototype
};

var bind = __webpack_require__("../node_modules/function-bind/index.js");
var $replace = bind.call(Function.call, String.prototype.replace);

/* adapted from https://github.com/lodash/lodash/blob/4.17.15/dist/lodash.js#L6735-L6744 */
var rePropName = /[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g;
var reEscapeChar = /\\(\\)?/g; /** Used to match backslashes in property paths. */
var stringToPath = function stringToPath(string) {
	var result = [];
	$replace(string, rePropName, function (match, number, quote, subString) {
		result[result.length] = quote ? $replace(subString, reEscapeChar, '$1') : (number || match);
	});
	return result;
};
/* end adaptation */

var getBaseIntrinsic = function getBaseIntrinsic(name, allowMissing) {
	var key = '$ ' + name;
	if (!(key in INTRINSICS)) {
		throw new SyntaxError('intrinsic ' + name + ' does not exist!');
	}

	// istanbul ignore if // hopefully this is impossible to test :-)
	if (typeof INTRINSICS[key] === 'undefined' && !allowMissing) {
		throw new $TypeError('intrinsic ' + name + ' exists, but is not available. Please file an issue!');
	}

	return INTRINSICS[key];
};

module.exports = function GetIntrinsic(name, allowMissing) {
	if (arguments.length > 1 && typeof allowMissing !== 'boolean') {
		throw new TypeError('"allowMissing" argument must be a boolean');
	}

	var parts = stringToPath(name);

	if (parts.length === 0) {
		return getBaseIntrinsic(name, allowMissing);
	}

	var value = getBaseIntrinsic('%' + parts[0] + '%', allowMissing);
	for (var i = 1; i < parts.length; i += 1) {
		if (value != null) {
			value = value[parts[i]];
		}
	}
	return value;
};


/***/ }),

/***/ "../node_modules/es-abstract/es5.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var GetIntrinsic = __webpack_require__("../node_modules/es-abstract/GetIntrinsic.js");

var $Object = GetIntrinsic('%Object%');
var $EvalError = GetIntrinsic('%EvalError%');
var $TypeError = GetIntrinsic('%TypeError%');
var $String = GetIntrinsic('%String%');
var $Date = GetIntrinsic('%Date%');
var $Number = GetIntrinsic('%Number%');
var $floor = GetIntrinsic('%Math.floor%');
var $DateUTC = GetIntrinsic('%Date.UTC%');
var $abs = GetIntrinsic('%Math.abs%');

var assertRecord = __webpack_require__("../node_modules/es-abstract/helpers/assertRecord.js");
var isPropertyDescriptor = __webpack_require__("../node_modules/es-abstract/helpers/isPropertyDescriptor.js");
var $isNaN = __webpack_require__("../node_modules/es-abstract/helpers/isNaN.js");
var $isFinite = __webpack_require__("../node_modules/es-abstract/helpers/isFinite.js");
var sign = __webpack_require__("../node_modules/es-abstract/helpers/sign.js");
var mod = __webpack_require__("../node_modules/es-abstract/helpers/mod.js");
var isPrefixOf = __webpack_require__("../node_modules/es-abstract/helpers/isPrefixOf.js");
var callBound = __webpack_require__("../node_modules/es-abstract/helpers/callBound.js");

var IsCallable = __webpack_require__("../node_modules/is-callable/index.js");
var toPrimitive = __webpack_require__("../node_modules/es-to-primitive/es5.js");

var has = __webpack_require__("../node_modules/has/src/index.js");

var $getUTCFullYear = callBound('Date.prototype.getUTCFullYear');

var HoursPerDay = 24;
var MinutesPerHour = 60;
var SecondsPerMinute = 60;
var msPerSecond = 1e3;
var msPerMinute = msPerSecond * SecondsPerMinute;
var msPerHour = msPerMinute * MinutesPerHour;
var msPerDay = 86400000;

// https://es5.github.io/#x9
var ES5 = {
	ToPrimitive: toPrimitive,

	ToBoolean: function ToBoolean(value) {
		return !!value;
	},
	ToNumber: function ToNumber(value) {
		return +value; // eslint-disable-line no-implicit-coercion
	},
	ToInteger: function ToInteger(value) {
		var number = this.ToNumber(value);
		if ($isNaN(number)) { return 0; }
		if (number === 0 || !$isFinite(number)) { return number; }
		return sign(number) * Math.floor(Math.abs(number));
	},
	ToInt32: function ToInt32(x) {
		return this.ToNumber(x) >> 0;
	},
	ToUint32: function ToUint32(x) {
		return this.ToNumber(x) >>> 0;
	},
	ToUint16: function ToUint16(value) {
		var number = this.ToNumber(value);
		if ($isNaN(number) || number === 0 || !$isFinite(number)) { return 0; }
		var posInt = sign(number) * Math.floor(Math.abs(number));
		return mod(posInt, 0x10000);
	},
	ToString: function ToString(value) {
		return $String(value);
	},
	ToObject: function ToObject(value) {
		this.CheckObjectCoercible(value);
		return $Object(value);
	},
	CheckObjectCoercible: function CheckObjectCoercible(value, optMessage) {
		/* jshint eqnull:true */
		if (value == null) {
			throw new $TypeError(optMessage || 'Cannot call method on ' + value);
		}
		return value;
	},
	IsCallable: IsCallable,
	SameValue: function SameValue(x, y) {
		if (x === y) { // 0 === -0, but they are not identical.
			if (x === 0) { return 1 / x === 1 / y; }
			return true;
		}
		return $isNaN(x) && $isNaN(y);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-8
	Type: function Type(x) {
		if (x === null) {
			return 'Null';
		}
		if (typeof x === 'undefined') {
			return 'Undefined';
		}
		if (typeof x === 'function' || typeof x === 'object') {
			return 'Object';
		}
		if (typeof x === 'number') {
			return 'Number';
		}
		if (typeof x === 'boolean') {
			return 'Boolean';
		}
		if (typeof x === 'string') {
			return 'String';
		}
	},

	// https://ecma-international.org/ecma-262/6.0/#sec-property-descriptor-specification-type
	IsPropertyDescriptor: function IsPropertyDescriptor(Desc) {
		return isPropertyDescriptor(this, Desc);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-8.10.1
	IsAccessorDescriptor: function IsAccessorDescriptor(Desc) {
		if (typeof Desc === 'undefined') {
			return false;
		}

		assertRecord(this, 'Property Descriptor', 'Desc', Desc);

		if (!has(Desc, '[[Get]]') && !has(Desc, '[[Set]]')) {
			return false;
		}

		return true;
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-8.10.2
	IsDataDescriptor: function IsDataDescriptor(Desc) {
		if (typeof Desc === 'undefined') {
			return false;
		}

		assertRecord(this, 'Property Descriptor', 'Desc', Desc);

		if (!has(Desc, '[[Value]]') && !has(Desc, '[[Writable]]')) {
			return false;
		}

		return true;
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-8.10.3
	IsGenericDescriptor: function IsGenericDescriptor(Desc) {
		if (typeof Desc === 'undefined') {
			return false;
		}

		assertRecord(this, 'Property Descriptor', 'Desc', Desc);

		if (!this.IsAccessorDescriptor(Desc) && !this.IsDataDescriptor(Desc)) {
			return true;
		}

		return false;
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-8.10.4
	FromPropertyDescriptor: function FromPropertyDescriptor(Desc) {
		if (typeof Desc === 'undefined') {
			return Desc;
		}

		assertRecord(this, 'Property Descriptor', 'Desc', Desc);

		if (this.IsDataDescriptor(Desc)) {
			return {
				value: Desc['[[Value]]'],
				writable: !!Desc['[[Writable]]'],
				enumerable: !!Desc['[[Enumerable]]'],
				configurable: !!Desc['[[Configurable]]']
			};
		} else if (this.IsAccessorDescriptor(Desc)) {
			return {
				get: Desc['[[Get]]'],
				set: Desc['[[Set]]'],
				enumerable: !!Desc['[[Enumerable]]'],
				configurable: !!Desc['[[Configurable]]']
			};
		} else {
			throw new $TypeError('FromPropertyDescriptor must be called with a fully populated Property Descriptor');
		}
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-8.10.5
	ToPropertyDescriptor: function ToPropertyDescriptor(Obj) {
		if (this.Type(Obj) !== 'Object') {
			throw new $TypeError('ToPropertyDescriptor requires an object');
		}

		var desc = {};
		if (has(Obj, 'enumerable')) {
			desc['[[Enumerable]]'] = this.ToBoolean(Obj.enumerable);
		}
		if (has(Obj, 'configurable')) {
			desc['[[Configurable]]'] = this.ToBoolean(Obj.configurable);
		}
		if (has(Obj, 'value')) {
			desc['[[Value]]'] = Obj.value;
		}
		if (has(Obj, 'writable')) {
			desc['[[Writable]]'] = this.ToBoolean(Obj.writable);
		}
		if (has(Obj, 'get')) {
			var getter = Obj.get;
			if (typeof getter !== 'undefined' && !this.IsCallable(getter)) {
				throw new TypeError('getter must be a function');
			}
			desc['[[Get]]'] = getter;
		}
		if (has(Obj, 'set')) {
			var setter = Obj.set;
			if (typeof setter !== 'undefined' && !this.IsCallable(setter)) {
				throw new $TypeError('setter must be a function');
			}
			desc['[[Set]]'] = setter;
		}

		if ((has(desc, '[[Get]]') || has(desc, '[[Set]]')) && (has(desc, '[[Value]]') || has(desc, '[[Writable]]'))) {
			throw new $TypeError('Invalid property descriptor. Cannot both specify accessors and a value or writable attribute');
		}
		return desc;
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-11.9.3
	'Abstract Equality Comparison': function AbstractEqualityComparison(x, y) {
		var xType = this.Type(x);
		var yType = this.Type(y);
		if (xType === yType) {
			return x === y; // ES6+ specified this shortcut anyways.
		}
		if (x == null && y == null) {
			return true;
		}
		if (xType === 'Number' && yType === 'String') {
			return this['Abstract Equality Comparison'](x, this.ToNumber(y));
		}
		if (xType === 'String' && yType === 'Number') {
			return this['Abstract Equality Comparison'](this.ToNumber(x), y);
		}
		if (xType === 'Boolean') {
			return this['Abstract Equality Comparison'](this.ToNumber(x), y);
		}
		if (yType === 'Boolean') {
			return this['Abstract Equality Comparison'](x, this.ToNumber(y));
		}
		if ((xType === 'String' || xType === 'Number') && yType === 'Object') {
			return this['Abstract Equality Comparison'](x, this.ToPrimitive(y));
		}
		if (xType === 'Object' && (yType === 'String' || yType === 'Number')) {
			return this['Abstract Equality Comparison'](this.ToPrimitive(x), y);
		}
		return false;
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-11.9.6
	'Strict Equality Comparison': function StrictEqualityComparison(x, y) {
		var xType = this.Type(x);
		var yType = this.Type(y);
		if (xType !== yType) {
			return false;
		}
		if (xType === 'Undefined' || xType === 'Null') {
			return true;
		}
		return x === y; // shortcut for steps 4-7
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-11.8.5
	// eslint-disable-next-line max-statements
	'Abstract Relational Comparison': function AbstractRelationalComparison(x, y, LeftFirst) {
		if (this.Type(LeftFirst) !== 'Boolean') {
			throw new $TypeError('Assertion failed: LeftFirst argument must be a Boolean');
		}
		var px;
		var py;
		if (LeftFirst) {
			px = this.ToPrimitive(x, $Number);
			py = this.ToPrimitive(y, $Number);
		} else {
			py = this.ToPrimitive(y, $Number);
			px = this.ToPrimitive(x, $Number);
		}
		var bothStrings = this.Type(px) === 'String' && this.Type(py) === 'String';
		if (!bothStrings) {
			var nx = this.ToNumber(px);
			var ny = this.ToNumber(py);
			if ($isNaN(nx) || $isNaN(ny)) {
				return undefined;
			}
			if ($isFinite(nx) && $isFinite(ny) && nx === ny) {
				return false;
			}
			if (nx === 0 && ny === 0) {
				return false;
			}
			if (nx === Infinity) {
				return false;
			}
			if (ny === Infinity) {
				return true;
			}
			if (ny === -Infinity) {
				return false;
			}
			if (nx === -Infinity) {
				return true;
			}
			return nx < ny; // by now, these are both nonzero, finite, and not equal
		}
		if (isPrefixOf(py, px)) {
			return false;
		}
		if (isPrefixOf(px, py)) {
			return true;
		}
		return px < py; // both strings, neither a prefix of the other. shortcut for steps c-f
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.10
	msFromTime: function msFromTime(t) {
		return mod(t, msPerSecond);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.10
	SecFromTime: function SecFromTime(t) {
		return mod($floor(t / msPerSecond), SecondsPerMinute);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.10
	MinFromTime: function MinFromTime(t) {
		return mod($floor(t / msPerMinute), MinutesPerHour);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.10
	HourFromTime: function HourFromTime(t) {
		return mod($floor(t / msPerHour), HoursPerDay);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.2
	Day: function Day(t) {
		return $floor(t / msPerDay);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.2
	TimeWithinDay: function TimeWithinDay(t) {
		return mod(t, msPerDay);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.3
	DayFromYear: function DayFromYear(y) {
		return (365 * (y - 1970)) + $floor((y - 1969) / 4) - $floor((y - 1901) / 100) + $floor((y - 1601) / 400);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.3
	TimeFromYear: function TimeFromYear(y) {
		return msPerDay * this.DayFromYear(y);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.3
	YearFromTime: function YearFromTime(t) {
		// largest y such that this.TimeFromYear(y) <= t
		return $getUTCFullYear(new $Date(t));
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.6
	WeekDay: function WeekDay(t) {
		return mod(this.Day(t) + 4, 7);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.3
	DaysInYear: function DaysInYear(y) {
		if (mod(y, 4) !== 0) {
			return 365;
		}
		if (mod(y, 100) !== 0) {
			return 366;
		}
		if (mod(y, 400) !== 0) {
			return 365;
		}
		return 366;
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.3
	InLeapYear: function InLeapYear(t) {
		var days = this.DaysInYear(this.YearFromTime(t));
		if (days === 365) {
			return 0;
		}
		if (days === 366) {
			return 1;
		}
		throw new $EvalError('Assertion failed: there are not 365 or 366 days in a year, got: ' + days);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.4
	DayWithinYear: function DayWithinYear(t) {
		return this.Day(t) - this.DayFromYear(this.YearFromTime(t));
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.4
	MonthFromTime: function MonthFromTime(t) {
		var day = this.DayWithinYear(t);
		if (0 <= day && day < 31) {
			return 0;
		}
		var leap = this.InLeapYear(t);
		if (31 <= day && day < (59 + leap)) {
			return 1;
		}
		if ((59 + leap) <= day && day < (90 + leap)) {
			return 2;
		}
		if ((90 + leap) <= day && day < (120 + leap)) {
			return 3;
		}
		if ((120 + leap) <= day && day < (151 + leap)) {
			return 4;
		}
		if ((151 + leap) <= day && day < (181 + leap)) {
			return 5;
		}
		if ((181 + leap) <= day && day < (212 + leap)) {
			return 6;
		}
		if ((212 + leap) <= day && day < (243 + leap)) {
			return 7;
		}
		if ((243 + leap) <= day && day < (273 + leap)) {
			return 8;
		}
		if ((273 + leap) <= day && day < (304 + leap)) {
			return 9;
		}
		if ((304 + leap) <= day && day < (334 + leap)) {
			return 10;
		}
		if ((334 + leap) <= day && day < (365 + leap)) {
			return 11;
		}
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.5
	DateFromTime: function DateFromTime(t) {
		var m = this.MonthFromTime(t);
		var d = this.DayWithinYear(t);
		if (m === 0) {
			return d + 1;
		}
		if (m === 1) {
			return d - 30;
		}
		var leap = this.InLeapYear(t);
		if (m === 2) {
			return d - 58 - leap;
		}
		if (m === 3) {
			return d - 89 - leap;
		}
		if (m === 4) {
			return d - 119 - leap;
		}
		if (m === 5) {
			return d - 150 - leap;
		}
		if (m === 6) {
			return d - 180 - leap;
		}
		if (m === 7) {
			return d - 211 - leap;
		}
		if (m === 8) {
			return d - 242 - leap;
		}
		if (m === 9) {
			return d - 272 - leap;
		}
		if (m === 10) {
			return d - 303 - leap;
		}
		if (m === 11) {
			return d - 333 - leap;
		}
		throw new $EvalError('Assertion failed: MonthFromTime returned an impossible value: ' + m);
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.12
	MakeDay: function MakeDay(year, month, date) {
		if (!$isFinite(year) || !$isFinite(month) || !$isFinite(date)) {
			return NaN;
		}
		var y = this.ToInteger(year);
		var m = this.ToInteger(month);
		var dt = this.ToInteger(date);
		var ym = y + $floor(m / 12);
		var mn = mod(m, 12);
		var t = $DateUTC(ym, mn, 1);
		if (this.YearFromTime(t) !== ym || this.MonthFromTime(t) !== mn || this.DateFromTime(t) !== 1) {
			return NaN;
		}
		return this.Day(t) + dt - 1;
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.13
	MakeDate: function MakeDate(day, time) {
		if (!$isFinite(day) || !$isFinite(time)) {
			return NaN;
		}
		return (day * msPerDay) + time;
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.11
	MakeTime: function MakeTime(hour, min, sec, ms) {
		if (!$isFinite(hour) || !$isFinite(min) || !$isFinite(sec) || !$isFinite(ms)) {
			return NaN;
		}
		var h = this.ToInteger(hour);
		var m = this.ToInteger(min);
		var s = this.ToInteger(sec);
		var milli = this.ToInteger(ms);
		var t = (h * msPerHour) + (m * msPerMinute) + (s * msPerSecond) + milli;
		return t;
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-15.9.1.14
	TimeClip: function TimeClip(time) {
		if (!$isFinite(time) || $abs(time) > 8.64e15) {
			return NaN;
		}
		return $Number(new $Date(this.ToNumber(time)));
	},

	// https://ecma-international.org/ecma-262/5.1/#sec-5.2
	modulo: function modulo(x, y) {
		return mod(x, y);
	}
};

module.exports = ES5;


/***/ }),

/***/ "../node_modules/es-abstract/helpers/assertRecord.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var GetIntrinsic = __webpack_require__("../node_modules/es-abstract/GetIntrinsic.js");

var $TypeError = GetIntrinsic('%TypeError%');
var $SyntaxError = GetIntrinsic('%SyntaxError%');

var has = __webpack_require__("../node_modules/has/src/index.js");

var predicates = {
	// https://ecma-international.org/ecma-262/6.0/#sec-property-descriptor-specification-type
	'Property Descriptor': function isPropertyDescriptor(ES, Desc) {
		if (ES.Type(Desc) !== 'Object') {
			return false;
		}
		var allowed = {
			'[[Configurable]]': true,
			'[[Enumerable]]': true,
			'[[Get]]': true,
			'[[Set]]': true,
			'[[Value]]': true,
			'[[Writable]]': true
		};

		for (var key in Desc) { // eslint-disable-line
			if (has(Desc, key) && !allowed[key]) {
				return false;
			}
		}

		var isData = has(Desc, '[[Value]]');
		var IsAccessor = has(Desc, '[[Get]]') || has(Desc, '[[Set]]');
		if (isData && IsAccessor) {
			throw new $TypeError('Property Descriptors may not be both accessor and data descriptors');
		}
		return true;
	}
};

module.exports = function assertRecord(ES, recordType, argumentName, value) {
	var predicate = predicates[recordType];
	if (typeof predicate !== 'function') {
		throw new $SyntaxError('unknown record type: ' + recordType);
	}
	if (!predicate(ES, value)) {
		throw new $TypeError(argumentName + ' must be a ' + recordType);
	}
};


/***/ }),

/***/ "../node_modules/es-abstract/helpers/callBind.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var bind = __webpack_require__("../node_modules/function-bind/index.js");

var GetIntrinsic = __webpack_require__("../node_modules/es-abstract/GetIntrinsic.js");

var $Function = GetIntrinsic('%Function%');
var $apply = $Function.apply;
var $call = $Function.call;

module.exports = function callBind() {
	return bind.apply($call, arguments);
};

module.exports.apply = function applyBind() {
	return bind.apply($apply, arguments);
};


/***/ }),

/***/ "../node_modules/es-abstract/helpers/callBound.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var GetIntrinsic = __webpack_require__("../node_modules/es-abstract/GetIntrinsic.js");

var callBind = __webpack_require__("../node_modules/es-abstract/helpers/callBind.js");

var $indexOf = callBind(GetIntrinsic('String.prototype.indexOf'));

module.exports = function callBoundIntrinsic(name, allowMissing) {
	var intrinsic = GetIntrinsic(name, !!allowMissing);
	if (typeof intrinsic === 'function' && $indexOf(name, '.prototype.')) {
		return callBind(intrinsic);
	}
	return intrinsic;
};


/***/ }),

/***/ "../node_modules/es-abstract/helpers/isFinite.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var $isNaN = Number.isNaN || function (a) { return a !== a; };

module.exports = Number.isFinite || function (x) { return typeof x === 'number' && !$isNaN(x) && x !== Infinity && x !== -Infinity; };


/***/ }),

/***/ "../node_modules/es-abstract/helpers/isNaN.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = Number.isNaN || function isNaN(a) {
	return a !== a;
};


/***/ }),

/***/ "../node_modules/es-abstract/helpers/isPrefixOf.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var $strSlice = __webpack_require__("../node_modules/es-abstract/helpers/callBound.js")('String.prototype.slice');

module.exports = function isPrefixOf(prefix, string) {
	if (prefix === string) {
		return true;
	}
	if (prefix.length > string.length) {
		return false;
	}
	return $strSlice(string, 0, prefix.length) === prefix;
};


/***/ }),

/***/ "../node_modules/es-abstract/helpers/isPropertyDescriptor.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var GetIntrinsic = __webpack_require__("../node_modules/es-abstract/GetIntrinsic.js");

var has = __webpack_require__("../node_modules/has/src/index.js");
var $TypeError = GetIntrinsic('%TypeError%');

module.exports = function IsPropertyDescriptor(ES, Desc) {
	if (ES.Type(Desc) !== 'Object') {
		return false;
	}
	var allowed = {
		'[[Configurable]]': true,
		'[[Enumerable]]': true,
		'[[Get]]': true,
		'[[Set]]': true,
		'[[Value]]': true,
		'[[Writable]]': true
	};

    for (var key in Desc) { // eslint-disable-line
		if (has(Desc, key) && !allowed[key]) {
			return false;
		}
	}

	if (ES.IsDataDescriptor(Desc) && ES.IsAccessorDescriptor(Desc)) {
		throw new $TypeError('Property Descriptors may not be both accessor and data descriptors');
	}
	return true;
};


/***/ }),

/***/ "../node_modules/es-abstract/helpers/mod.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function mod(number, modulo) {
	var remain = number % modulo;
	return Math.floor(remain >= 0 ? remain : remain + modulo);
};


/***/ }),

/***/ "../node_modules/es-abstract/helpers/sign.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function sign(number) {
	return number >= 0 ? 1 : -1;
};


/***/ }),

/***/ "../node_modules/es-to-primitive/es5.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var toStr = Object.prototype.toString;

var isPrimitive = __webpack_require__("../node_modules/es-to-primitive/helpers/isPrimitive.js");

var isCallable = __webpack_require__("../node_modules/is-callable/index.js");

// http://ecma-international.org/ecma-262/5.1/#sec-8.12.8
var ES5internalSlots = {
	'[[DefaultValue]]': function (O) {
		var actualHint;
		if (arguments.length > 1) {
			actualHint = arguments[1];
		} else {
			actualHint = toStr.call(O) === '[object Date]' ? String : Number;
		}

		if (actualHint === String || actualHint === Number) {
			var methods = actualHint === String ? ['toString', 'valueOf'] : ['valueOf', 'toString'];
			var value, i;
			for (i = 0; i < methods.length; ++i) {
				if (isCallable(O[methods[i]])) {
					value = O[methods[i]]();
					if (isPrimitive(value)) {
						return value;
					}
				}
			}
			throw new TypeError('No default value');
		}
		throw new TypeError('invalid [[DefaultValue]] hint supplied');
	}
};

// http://ecma-international.org/ecma-262/5.1/#sec-9.1
module.exports = function ToPrimitive(input) {
	if (isPrimitive(input)) {
		return input;
	}
	if (arguments.length > 1) {
		return ES5internalSlots['[[DefaultValue]]'](input, arguments[1]);
	}
	return ES5internalSlots['[[DefaultValue]]'](input);
};


/***/ }),

/***/ "../node_modules/es-to-primitive/helpers/isPrimitive.js":
/***/ (function(module, exports) {

module.exports = function isPrimitive(value) {
	return value === null || (typeof value !== 'function' && typeof value !== 'object');
};


/***/ }),

/***/ "../node_modules/for-each/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var isCallable = __webpack_require__("../node_modules/is-callable/index.js");

var toStr = Object.prototype.toString;
var hasOwnProperty = Object.prototype.hasOwnProperty;

var forEachArray = function forEachArray(array, iterator, receiver) {
    for (var i = 0, len = array.length; i < len; i++) {
        if (hasOwnProperty.call(array, i)) {
            if (receiver == null) {
                iterator(array[i], i, array);
            } else {
                iterator.call(receiver, array[i], i, array);
            }
        }
    }
};

var forEachString = function forEachString(string, iterator, receiver) {
    for (var i = 0, len = string.length; i < len; i++) {
        // no such thing as a sparse string.
        if (receiver == null) {
            iterator(string.charAt(i), i, string);
        } else {
            iterator.call(receiver, string.charAt(i), i, string);
        }
    }
};

var forEachObject = function forEachObject(object, iterator, receiver) {
    for (var k in object) {
        if (hasOwnProperty.call(object, k)) {
            if (receiver == null) {
                iterator(object[k], k, object);
            } else {
                iterator.call(receiver, object[k], k, object);
            }
        }
    }
};

var forEach = function forEach(list, iterator, thisArg) {
    if (!isCallable(iterator)) {
        throw new TypeError('iterator must be a function');
    }

    var receiver;
    if (arguments.length >= 3) {
        receiver = thisArg;
    }

    if (toStr.call(list) === '[object Array]') {
        forEachArray(list, iterator, receiver);
    } else if (typeof list === 'string') {
        forEachString(list, iterator, receiver);
    } else {
        forEachObject(list, iterator, receiver);
    }
};

module.exports = forEach;


/***/ }),

/***/ "../node_modules/function-bind/implementation.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/* eslint no-invalid-this: 1 */

var ERROR_MESSAGE = 'Function.prototype.bind called on incompatible ';
var slice = Array.prototype.slice;
var toStr = Object.prototype.toString;
var funcType = '[object Function]';

module.exports = function bind(that) {
    var target = this;
    if (typeof target !== 'function' || toStr.call(target) !== funcType) {
        throw new TypeError(ERROR_MESSAGE + target);
    }
    var args = slice.call(arguments, 1);

    var bound;
    var binder = function () {
        if (this instanceof bound) {
            var result = target.apply(
                this,
                args.concat(slice.call(arguments))
            );
            if (Object(result) === result) {
                return result;
            }
            return this;
        } else {
            return target.apply(
                that,
                args.concat(slice.call(arguments))
            );
        }
    };

    var boundLength = Math.max(0, target.length - args.length);
    var boundArgs = [];
    for (var i = 0; i < boundLength; i++) {
        boundArgs.push('$' + i);
    }

    bound = Function('binder', 'return function (' + boundArgs.join(',') + '){ return binder.apply(this,arguments); }')(binder);

    if (target.prototype) {
        var Empty = function Empty() {};
        Empty.prototype = target.prototype;
        bound.prototype = new Empty();
        Empty.prototype = null;
    }

    return bound;
};


/***/ }),

/***/ "../node_modules/function-bind/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var implementation = __webpack_require__("../node_modules/function-bind/implementation.js");

module.exports = Function.prototype.bind || implementation;


/***/ }),

/***/ "../node_modules/global/window.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {var win;

if (typeof window !== "undefined") {
    win = window;
} else if (typeof global !== "undefined") {
    win = global;
} else if (typeof self !== "undefined"){
    win = self;
} else {
    win = {};
}

module.exports = win;

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/has-symbols/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(global) {

var origSymbol = global.Symbol;
var hasSymbolSham = __webpack_require__("../node_modules/has-symbols/shams.js");

module.exports = function hasNativeSymbols() {
	if (typeof origSymbol !== 'function') { return false; }
	if (typeof Symbol !== 'function') { return false; }
	if (typeof origSymbol('foo') !== 'symbol') { return false; }
	if (typeof Symbol('bar') !== 'symbol') { return false; }

	return hasSymbolSham();
};

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/has-symbols/shams.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/* eslint complexity: [2, 17], max-statements: [2, 33] */
module.exports = function hasSymbols() {
	if (typeof Symbol !== 'function' || typeof Object.getOwnPropertySymbols !== 'function') { return false; }
	if (typeof Symbol.iterator === 'symbol') { return true; }

	var obj = {};
	var sym = Symbol('test');
	var symObj = Object(sym);
	if (typeof sym === 'string') { return false; }

	if (Object.prototype.toString.call(sym) !== '[object Symbol]') { return false; }
	if (Object.prototype.toString.call(symObj) !== '[object Symbol]') { return false; }

	// temp disabled per https://github.com/ljharb/object.assign/issues/17
	// if (sym instanceof Symbol) { return false; }
	// temp disabled per https://github.com/WebReflection/get-own-property-symbols/issues/4
	// if (!(symObj instanceof Symbol)) { return false; }

	// if (typeof Symbol.prototype.toString !== 'function') { return false; }
	// if (String(sym) !== Symbol.prototype.toString.call(sym)) { return false; }

	var symVal = 42;
	obj[sym] = symVal;
	for (sym in obj) { return false; } // eslint-disable-line no-restricted-syntax
	if (typeof Object.keys === 'function' && Object.keys(obj).length !== 0) { return false; }

	if (typeof Object.getOwnPropertyNames === 'function' && Object.getOwnPropertyNames(obj).length !== 0) { return false; }

	var syms = Object.getOwnPropertySymbols(obj);
	if (syms.length !== 1 || syms[0] !== sym) { return false; }

	if (!Object.prototype.propertyIsEnumerable.call(obj, sym)) { return false; }

	if (typeof Object.getOwnPropertyDescriptor === 'function') {
		var descriptor = Object.getOwnPropertyDescriptor(obj, sym);
		if (descriptor.value !== symVal || descriptor.enumerable !== true) { return false; }
	}

	return true;
};


/***/ }),

/***/ "../node_modules/has/src/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var bind = __webpack_require__("../node_modules/function-bind/index.js");

module.exports = bind.call(Function.call, Object.prototype.hasOwnProperty);


/***/ }),

/***/ "../node_modules/is-callable/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var fnToStr = Function.prototype.toString;

var constructorRegex = /^\s*class\b/;
var isES6ClassFn = function isES6ClassFunction(value) {
	try {
		var fnStr = fnToStr.call(value);
		return constructorRegex.test(fnStr);
	} catch (e) {
		return false; // not a function
	}
};

var tryFunctionObject = function tryFunctionToStr(value) {
	try {
		if (isES6ClassFn(value)) { return false; }
		fnToStr.call(value);
		return true;
	} catch (e) {
		return false;
	}
};
var toStr = Object.prototype.toString;
var fnClass = '[object Function]';
var genClass = '[object GeneratorFunction]';
var hasToStringTag = typeof Symbol === 'function' && typeof Symbol.toStringTag === 'symbol';

module.exports = function isCallable(value) {
	if (!value) { return false; }
	if (typeof value !== 'function' && typeof value !== 'object') { return false; }
	if (typeof value === 'function' && !value.prototype) { return true; }
	if (hasToStringTag) { return tryFunctionObject(value); }
	if (isES6ClassFn(value)) { return false; }
	var strClass = toStr.call(value);
	return strClass === fnClass || strClass === genClass;
};


/***/ }),

/***/ "../node_modules/is-function/index.js":
/***/ (function(module, exports) {

module.exports = isFunction

var toString = Object.prototype.toString

function isFunction (fn) {
  var string = toString.call(fn)
  return string === '[object Function]' ||
    (typeof fn === 'function' && string !== '[object RegExp]') ||
    (typeof window !== 'undefined' &&
     // IE8 and below
     (fn === window.setTimeout ||
      fn === window.alert ||
      fn === window.confirm ||
      fn === window.prompt))
};


/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/hmr/hmr-update.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
const hot = __webpack_require__("../node_modules/nativescript-dev-webpack/hot.js");
const file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
function hmrUpdate() {
    const currentAppFolder = file_system_1.knownFolders.currentApp();
    const latestHash = __webpack_require__["h"]();
    return hot(latestHash, filename => {
        const fullFilePath = file_system_1.path.join(currentAppFolder.path, filename);
        return file_system_1.File.exists(fullFilePath) ? currentAppFolder.getFile(filename) : null;
    });
}
exports.hmrUpdate = hmrUpdate;
//# sourceMappingURL=hmr-update.js.map

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/hmr/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var hmr_update_1 = __webpack_require__("../node_modules/nativescript-dev-webpack/hmr/hmr-update.js");
exports.hmrUpdate = hmr_update_1.hmrUpdate;
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/hot.js":
/***/ (function(module, exports, __webpack_require__) {

const hmrPrefix = 'HMR:';
const log = {
    info: (message) => console.info(`${hmrPrefix} ${message}`),
    warn: (message) => console.warn(`${hmrPrefix} ${message}`),
    error: (message) => console.error(`${hmrPrefix} ${message}`),
};
const refresh = 'Application needs to be restarted in order to apply the changes.';
const hotOptions = {
    ignoreUnaccepted: false,
    ignoreDeclined: false,
    ignoreErrored: false,
    onUnaccepted(data) {
        const chain = [].concat(data.chain);
        const last = chain[chain.length - 1];

        if (last === 0) {
            chain.pop();
        }

        log.warn(`Ignored an update to unaccepted module: `);
        chain.forEach(mod => log.warn(`          ${mod}`));
    },
    onDeclined(data) {
        log.warn(`Ignored an update to declined module:`);
        data.chain.forEach(mod => log.warn(`          ${mod}`));
    },
    onErrored(data) {
        log.warn(
            `Ignored an error while updating module ${data.moduleId} <${data.type}>`
        );
        log.warn(data.error);
    },
};

let nextHash;
let currentHash;

function upToDate() {
    return nextHash.indexOf(__webpack_require__.h()) >= 0;
}

function result(modules, appliedModules) {
    const unaccepted = modules.filter(
        (moduleId) => appliedModules && appliedModules.indexOf(moduleId) < 0
    );

    if (unaccepted.length > 0) {
        log.warn('The following modules could not be updated:');

        for (const moduleId of unaccepted) {
            log.warn(`           ${moduleId}`);
        }
    }

    if (!(appliedModules || []).length) {
        log.info('No Modules Updated.');
    } else {
        log.info('The following modules were updated:');

        for (const moduleId of appliedModules) {
            log.info(`          ${moduleId}`);
        }

        const numberIds = appliedModules.every(
            (moduleId) => typeof moduleId === 'number'
        );
        if (numberIds) {
            log.info(
                'Please consider using the NamedModulesPlugin for module names.'
            );
        }
    }
}

function check(options) {
    return module.hot
        .check()
        .then((modules) => {
            if (!modules) {
                log.warn(
                    `Cannot find update. ${refresh}`
                );
                return null;
            }

            return module.hot
                .apply(hotOptions)
                .then((appliedModules) => {
                    let nextCheck;
                    if (!upToDate()) {
                        nextCheck = check(options);
                    }

                    result(modules, appliedModules);

                    if (upToDate()) {
                        // Do not modify message - CLI depends on this exact content to determine hmr operation status.
                        log.info(`Successfully applied update with hmr hash ${currentHash}. App is up to date.`);
                    }

                    return nextCheck || null;
                })
                .catch((err) => {
                    const status = module.hot.status();
                    if (['abort', 'fail'].indexOf(status) >= 0) {
                        // Do not modify message - CLI depends on this exact content to determine hmr operation status.
                        log.error(`Cannot apply update with hmr hash ${currentHash}.`);
                        log.error(err.message || err.stack);
                    } else {
                        log.error(`Update failed: ${err.message || err.stack}`);
                    }
                });
        })
        .catch((err) => {
            const status = module.hot.status();
            if (['abort', 'fail'].indexOf(status) >= 0) {
                log.error(`Cannot check for update. ${refresh}`);
                log.error(err.message || err.stack);
            } else {
                log.error(`Update check failed: ${err.message || err.stack}`);
            }
        });
}

if (true) {
    log.info('Hot Module Replacement Enabled. Waiting for signal.');
} else {}

function update(latestHash, options) {
    nextHash = latestHash;
    if (!upToDate()) {
        const status = module.hot.status();

        if (status === 'idle') {
            //Do not modify message - CLI depends on this exact content to determine hmr operation status.
            log.info(`Checking for updates to the bundle with hmr hash ${currentHash}.`);
            return check(options);
        } else if (['abort', 'fail'].indexOf(status) >= 0) {
            log.warn(
                `Cannot apply update. A previous update ${status}ed. ${refresh}`
            );
        }
    }
};

function getNextHash(hash, getFileContent) {
    const file = getFileContent(`${hash}.hot-update.json`);
    if (!file) {
        return Promise.resolve(hash);
    }

    return file.readText().then(hotUpdateContent => {
        if (hotUpdateContent) {
            const manifest = JSON.parse(hotUpdateContent);
            const newHash = manifest.h;
            return getNextHash(newHash, getFileContent);
        } else {
            return Promise.resolve(hash);
        }
    }).catch(error => Promise.reject(error));
}

module.exports = function checkState(initialHash, getFileContent) {
    currentHash = initialHash;
    return getNextHash(initialHash, getFileContent).then(nextHash => {
        if (nextHash != initialHash) {
            return update(nextHash, {});
        }
    })
}


/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/load-application-css-angular.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {const loadCss = __webpack_require__("../node_modules/nativescript-dev-webpack/load-application-css.js");

module.exports = function() {
    loadCss(function() {
        global.registerModule("./app.css", () => __webpack_require__("./app.css"));
        global.registerModule("app.css", () => __webpack_require__("./app.css"));
    });
}

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/load-application-css.js":
/***/ (function(module, exports, __webpack_require__) {

module.exports = function (loadModuleFn) {
    const application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
    __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");

    loadModuleFn();

    application.loadAppCss();
}


/***/ }),

/***/ "../node_modules/node-libs-browser/mock/empty.js":
/***/ (function(module, exports) {



/***/ }),

/***/ "../node_modules/object-keys/implementation.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var keysShim;
if (!Object.keys) {
	// modified from https://github.com/es-shims/es5-shim
	var has = Object.prototype.hasOwnProperty;
	var toStr = Object.prototype.toString;
	var isArgs = __webpack_require__("../node_modules/object-keys/isArguments.js"); // eslint-disable-line global-require
	var isEnumerable = Object.prototype.propertyIsEnumerable;
	var hasDontEnumBug = !isEnumerable.call({ toString: null }, 'toString');
	var hasProtoEnumBug = isEnumerable.call(function () {}, 'prototype');
	var dontEnums = [
		'toString',
		'toLocaleString',
		'valueOf',
		'hasOwnProperty',
		'isPrototypeOf',
		'propertyIsEnumerable',
		'constructor'
	];
	var equalsConstructorPrototype = function (o) {
		var ctor = o.constructor;
		return ctor && ctor.prototype === o;
	};
	var excludedKeys = {
		$applicationCache: true,
		$console: true,
		$external: true,
		$frame: true,
		$frameElement: true,
		$frames: true,
		$innerHeight: true,
		$innerWidth: true,
		$onmozfullscreenchange: true,
		$onmozfullscreenerror: true,
		$outerHeight: true,
		$outerWidth: true,
		$pageXOffset: true,
		$pageYOffset: true,
		$parent: true,
		$scrollLeft: true,
		$scrollTop: true,
		$scrollX: true,
		$scrollY: true,
		$self: true,
		$webkitIndexedDB: true,
		$webkitStorageInfo: true,
		$window: true
	};
	var hasAutomationEqualityBug = (function () {
		/* global window */
		if (typeof window === 'undefined') { return false; }
		for (var k in window) {
			try {
				if (!excludedKeys['$' + k] && has.call(window, k) && window[k] !== null && typeof window[k] === 'object') {
					try {
						equalsConstructorPrototype(window[k]);
					} catch (e) {
						return true;
					}
				}
			} catch (e) {
				return true;
			}
		}
		return false;
	}());
	var equalsConstructorPrototypeIfNotBuggy = function (o) {
		/* global window */
		if (typeof window === 'undefined' || !hasAutomationEqualityBug) {
			return equalsConstructorPrototype(o);
		}
		try {
			return equalsConstructorPrototype(o);
		} catch (e) {
			return false;
		}
	};

	keysShim = function keys(object) {
		var isObject = object !== null && typeof object === 'object';
		var isFunction = toStr.call(object) === '[object Function]';
		var isArguments = isArgs(object);
		var isString = isObject && toStr.call(object) === '[object String]';
		var theKeys = [];

		if (!isObject && !isFunction && !isArguments) {
			throw new TypeError('Object.keys called on a non-object');
		}

		var skipProto = hasProtoEnumBug && isFunction;
		if (isString && object.length > 0 && !has.call(object, 0)) {
			for (var i = 0; i < object.length; ++i) {
				theKeys.push(String(i));
			}
		}

		if (isArguments && object.length > 0) {
			for (var j = 0; j < object.length; ++j) {
				theKeys.push(String(j));
			}
		} else {
			for (var name in object) {
				if (!(skipProto && name === 'prototype') && has.call(object, name)) {
					theKeys.push(String(name));
				}
			}
		}

		if (hasDontEnumBug) {
			var skipConstructor = equalsConstructorPrototypeIfNotBuggy(object);

			for (var k = 0; k < dontEnums.length; ++k) {
				if (!(skipConstructor && dontEnums[k] === 'constructor') && has.call(object, dontEnums[k])) {
					theKeys.push(dontEnums[k]);
				}
			}
		}
		return theKeys;
	};
}
module.exports = keysShim;


/***/ }),

/***/ "../node_modules/object-keys/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var slice = Array.prototype.slice;
var isArgs = __webpack_require__("../node_modules/object-keys/isArguments.js");

var origKeys = Object.keys;
var keysShim = origKeys ? function keys(o) { return origKeys(o); } : __webpack_require__("../node_modules/object-keys/implementation.js");

var originalKeys = Object.keys;

keysShim.shim = function shimObjectKeys() {
	if (Object.keys) {
		var keysWorksWithArguments = (function () {
			// Safari 5.0 bug
			var args = Object.keys(arguments);
			return args && args.length === arguments.length;
		}(1, 2));
		if (!keysWorksWithArguments) {
			Object.keys = function keys(object) { // eslint-disable-line func-name-matching
				if (isArgs(object)) {
					return originalKeys(slice.call(object));
				}
				return originalKeys(object);
			};
		}
	} else {
		Object.keys = keysShim;
	}
	return Object.keys || keysShim;
};

module.exports = keysShim;


/***/ }),

/***/ "../node_modules/object-keys/isArguments.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var toStr = Object.prototype.toString;

module.exports = function isArguments(value) {
	var str = toStr.call(value);
	var isArgs = str === '[object Arguments]';
	if (!isArgs) {
		isArgs = str !== '[object Array]' &&
			value !== null &&
			typeof value === 'object' &&
			typeof value.length === 'number' &&
			value.length >= 0 &&
			toStr.call(value.callee) === '[object Function]';
	}
	return isArgs;
};


/***/ }),

/***/ "../node_modules/parse-headers/parse-headers.js":
/***/ (function(module, exports, __webpack_require__) {

var trim = __webpack_require__("../node_modules/string.prototype.trim/index.js")
  , forEach = __webpack_require__("../node_modules/for-each/index.js")
  , isArray = function(arg) {
      return Object.prototype.toString.call(arg) === '[object Array]';
    }

module.exports = function (headers) {
  if (!headers)
    return {}

  var result = {}

  forEach(
      trim(headers).split('\n')
    , function (row) {
        var index = row.indexOf(':')
          , key = trim(row.slice(0, index)).toLowerCase()
          , value = trim(row.slice(index + 1))

        if (typeof(result[key]) === 'undefined') {
          result[key] = value
        } else if (isArray(result[key])) {
          result[key].push(value)
        } else {
          result[key] = [ result[key], value ]
        }
      }
  )

  return result
}


/***/ }),

/***/ "../node_modules/path-browserify/index.js":
/***/ (function(module, exports) {

// .dirname, .basename, and .extname methods are extracted from Node.js v8.11.1,
// backported and transplited with Babel, with backwards-compat fixes

// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

// resolves . and .. elements in a path array with directory names there
// must be no slashes, empty elements, or device names (c:\) in the array
// (so also no leading and trailing slashes - it does not distinguish
// relative and absolute paths)
function normalizeArray(parts, allowAboveRoot) {
  // if the path tries to go above the root, `up` ends up > 0
  var up = 0;
  for (var i = parts.length - 1; i >= 0; i--) {
    var last = parts[i];
    if (last === '.') {
      parts.splice(i, 1);
    } else if (last === '..') {
      parts.splice(i, 1);
      up++;
    } else if (up) {
      parts.splice(i, 1);
      up--;
    }
  }

  // if the path is allowed to go above the root, restore leading ..s
  if (allowAboveRoot) {
    for (; up--; up) {
      parts.unshift('..');
    }
  }

  return parts;
}

// path.resolve([from ...], to)
// posix version
exports.resolve = function() {
  var resolvedPath = '',
      resolvedAbsolute = false;

  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {
    var path = (i >= 0) ? arguments[i] : global.process.cwd();

    // Skip empty and invalid entries
    if (typeof path !== 'string') {
      throw new TypeError('Arguments to path.resolve must be strings');
    } else if (!path) {
      continue;
    }

    resolvedPath = path + '/' + resolvedPath;
    resolvedAbsolute = path.charAt(0) === '/';
  }

  // At this point the path should be resolved to a full absolute path, but
  // handle relative paths to be safe (might happen when process.cwd() fails)

  // Normalize the path
  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {
    return !!p;
  }), !resolvedAbsolute).join('/');

  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';
};

// path.normalize(path)
// posix version
exports.normalize = function(path) {
  var isAbsolute = exports.isAbsolute(path),
      trailingSlash = substr(path, -1) === '/';

  // Normalize the path
  path = normalizeArray(filter(path.split('/'), function(p) {
    return !!p;
  }), !isAbsolute).join('/');

  if (!path && !isAbsolute) {
    path = '.';
  }
  if (path && trailingSlash) {
    path += '/';
  }

  return (isAbsolute ? '/' : '') + path;
};

// posix version
exports.isAbsolute = function(path) {
  return path.charAt(0) === '/';
};

// posix version
exports.join = function() {
  var paths = Array.prototype.slice.call(arguments, 0);
  return exports.normalize(filter(paths, function(p, index) {
    if (typeof p !== 'string') {
      throw new TypeError('Arguments to path.join must be strings');
    }
    return p;
  }).join('/'));
};


// path.relative(from, to)
// posix version
exports.relative = function(from, to) {
  from = exports.resolve(from).substr(1);
  to = exports.resolve(to).substr(1);

  function trim(arr) {
    var start = 0;
    for (; start < arr.length; start++) {
      if (arr[start] !== '') break;
    }

    var end = arr.length - 1;
    for (; end >= 0; end--) {
      if (arr[end] !== '') break;
    }

    if (start > end) return [];
    return arr.slice(start, end - start + 1);
  }

  var fromParts = trim(from.split('/'));
  var toParts = trim(to.split('/'));

  var length = Math.min(fromParts.length, toParts.length);
  var samePartsLength = length;
  for (var i = 0; i < length; i++) {
    if (fromParts[i] !== toParts[i]) {
      samePartsLength = i;
      break;
    }
  }

  var outputParts = [];
  for (var i = samePartsLength; i < fromParts.length; i++) {
    outputParts.push('..');
  }

  outputParts = outputParts.concat(toParts.slice(samePartsLength));

  return outputParts.join('/');
};

exports.sep = '/';
exports.delimiter = ':';

exports.dirname = function (path) {
  if (typeof path !== 'string') path = path + '';
  if (path.length === 0) return '.';
  var code = path.charCodeAt(0);
  var hasRoot = code === 47 /*/*/;
  var end = -1;
  var matchedSlash = true;
  for (var i = path.length - 1; i >= 1; --i) {
    code = path.charCodeAt(i);
    if (code === 47 /*/*/) {
        if (!matchedSlash) {
          end = i;
          break;
        }
      } else {
      // We saw the first non-path separator
      matchedSlash = false;
    }
  }

  if (end === -1) return hasRoot ? '/' : '.';
  if (hasRoot && end === 1) {
    // return '//';
    // Backwards-compat fix:
    return '/';
  }
  return path.slice(0, end);
};

function basename(path) {
  if (typeof path !== 'string') path = path + '';

  var start = 0;
  var end = -1;
  var matchedSlash = true;
  var i;

  for (i = path.length - 1; i >= 0; --i) {
    if (path.charCodeAt(i) === 47 /*/*/) {
        // If we reached a path separator that was not part of a set of path
        // separators at the end of the string, stop now
        if (!matchedSlash) {
          start = i + 1;
          break;
        }
      } else if (end === -1) {
      // We saw the first non-path separator, mark this as the end of our
      // path component
      matchedSlash = false;
      end = i + 1;
    }
  }

  if (end === -1) return '';
  return path.slice(start, end);
}

// Uses a mixed approach for backwards-compatibility, as ext behavior changed
// in new Node.js versions, so only basename() above is backported here
exports.basename = function (path, ext) {
  var f = basename(path);
  if (ext && f.substr(-1 * ext.length) === ext) {
    f = f.substr(0, f.length - ext.length);
  }
  return f;
};

exports.extname = function (path) {
  if (typeof path !== 'string') path = path + '';
  var startDot = -1;
  var startPart = 0;
  var end = -1;
  var matchedSlash = true;
  // Track the state of characters (if any) we see before our first dot and
  // after any path separator we find
  var preDotState = 0;
  for (var i = path.length - 1; i >= 0; --i) {
    var code = path.charCodeAt(i);
    if (code === 47 /*/*/) {
        // If we reached a path separator that was not part of a set of path
        // separators at the end of the string, stop now
        if (!matchedSlash) {
          startPart = i + 1;
          break;
        }
        continue;
      }
    if (end === -1) {
      // We saw the first non-path separator, mark this as the end of our
      // extension
      matchedSlash = false;
      end = i + 1;
    }
    if (code === 46 /*.*/) {
        // If this is our first dot, mark it as the start of our extension
        if (startDot === -1)
          startDot = i;
        else if (preDotState !== 1)
          preDotState = 1;
    } else if (startDot !== -1) {
      // We saw a non-dot and non-path separator before our dot, so we should
      // have a good chance at having a non-empty extension
      preDotState = -1;
    }
  }

  if (startDot === -1 || end === -1 ||
      // We saw a non-dot character immediately before the dot
      preDotState === 0 ||
      // The (right-most) trimmed path component is exactly '..'
      preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {
    return '';
  }
  return path.slice(startDot, end);
};

function filter (xs, f) {
    if (xs.filter) return xs.filter(f);
    var res = [];
    for (var i = 0; i < xs.length; i++) {
        if (f(xs[i], i, xs)) res.push(xs[i]);
    }
    return res;
}

// String.prototype.substr - negative index don't work in IE8
var substr = 'ab'.substr(-1) === 'b'
    ? function (str, start, len) { return str.substr(start, len) }
    : function (str, start, len) {
        if (start < 0) start = str.length + start;
        return str.substr(start, len);
    }
;


/***/ }),

/***/ "../node_modules/postcss-value-parser/lib/index.js":
/***/ (function(module, exports, __webpack_require__) {

var parse = __webpack_require__("../node_modules/postcss-value-parser/lib/parse.js");
var walk = __webpack_require__("../node_modules/postcss-value-parser/lib/walk.js");
var stringify = __webpack_require__("../node_modules/postcss-value-parser/lib/stringify.js");

function ValueParser(value) {
  if (this instanceof ValueParser) {
    this.nodes = parse(value);
    return this;
  }
  return new ValueParser(value);
}

ValueParser.prototype.toString = function() {
  return Array.isArray(this.nodes) ? stringify(this.nodes) : "";
};

ValueParser.prototype.walk = function(cb, bubble) {
  walk(this.nodes, cb, bubble);
  return this;
};

ValueParser.unit = __webpack_require__("../node_modules/postcss-value-parser/lib/unit.js");

ValueParser.walk = walk;

ValueParser.stringify = stringify;

module.exports = ValueParser;


/***/ }),

/***/ "../node_modules/postcss-value-parser/lib/parse.js":
/***/ (function(module, exports) {

var openParentheses = "(".charCodeAt(0);
var closeParentheses = ")".charCodeAt(0);
var singleQuote = "'".charCodeAt(0);
var doubleQuote = '"'.charCodeAt(0);
var backslash = "\\".charCodeAt(0);
var slash = "/".charCodeAt(0);
var comma = ",".charCodeAt(0);
var colon = ":".charCodeAt(0);
var star = "*".charCodeAt(0);

module.exports = function(input) {
  var tokens = [];
  var value = input;

  var next, quote, prev, token, escape, escapePos, whitespacePos;
  var pos = 0;
  var code = value.charCodeAt(pos);
  var max = value.length;
  var stack = [{ nodes: tokens }];
  var balanced = 0;
  var parent;

  var name = "";
  var before = "";
  var after = "";

  while (pos < max) {
    // Whitespaces
    if (code <= 32) {
      next = pos;
      do {
        next += 1;
        code = value.charCodeAt(next);
      } while (code <= 32);
      token = value.slice(pos, next);

      prev = tokens[tokens.length - 1];
      if (code === closeParentheses && balanced) {
        after = token;
      } else if (prev && prev.type === "div") {
        prev.after = token;
      } else if (
        code === comma ||
        code === colon ||
        (code === slash && value.charCodeAt(next + 1) !== star)
      ) {
        before = token;
      } else {
        tokens.push({
          type: "space",
          sourceIndex: pos,
          value: token
        });
      }

      pos = next;

      // Quotes
    } else if (code === singleQuote || code === doubleQuote) {
      next = pos;
      quote = code === singleQuote ? "'" : '"';
      token = {
        type: "string",
        sourceIndex: pos,
        quote: quote
      };
      do {
        escape = false;
        next = value.indexOf(quote, next + 1);
        if (~next) {
          escapePos = next;
          while (value.charCodeAt(escapePos - 1) === backslash) {
            escapePos -= 1;
            escape = !escape;
          }
        } else {
          value += quote;
          next = value.length - 1;
          token.unclosed = true;
        }
      } while (escape);
      token.value = value.slice(pos + 1, next);

      tokens.push(token);
      pos = next + 1;
      code = value.charCodeAt(pos);

      // Comments
    } else if (code === slash && value.charCodeAt(pos + 1) === star) {
      token = {
        type: "comment",
        sourceIndex: pos
      };

      next = value.indexOf("*/", pos);
      if (next === -1) {
        token.unclosed = true;
        next = value.length;
      }

      token.value = value.slice(pos + 2, next);
      tokens.push(token);

      pos = next + 2;
      code = value.charCodeAt(pos);

      // Dividers
    } else if (code === slash || code === comma || code === colon) {
      token = value[pos];

      tokens.push({
        type: "div",
        sourceIndex: pos - before.length,
        value: token,
        before: before,
        after: ""
      });
      before = "";

      pos += 1;
      code = value.charCodeAt(pos);

      // Open parentheses
    } else if (openParentheses === code) {
      // Whitespaces after open parentheses
      next = pos;
      do {
        next += 1;
        code = value.charCodeAt(next);
      } while (code <= 32);
      token = {
        type: "function",
        sourceIndex: pos - name.length,
        value: name,
        before: value.slice(pos + 1, next)
      };
      pos = next;

      if (name === "url" && code !== singleQuote && code !== doubleQuote) {
        next -= 1;
        do {
          escape = false;
          next = value.indexOf(")", next + 1);
          if (~next) {
            escapePos = next;
            while (value.charCodeAt(escapePos - 1) === backslash) {
              escapePos -= 1;
              escape = !escape;
            }
          } else {
            value += ")";
            next = value.length - 1;
            token.unclosed = true;
          }
        } while (escape);
        // Whitespaces before closed
        whitespacePos = next;
        do {
          whitespacePos -= 1;
          code = value.charCodeAt(whitespacePos);
        } while (code <= 32);
        if (pos !== whitespacePos + 1) {
          token.nodes = [
            {
              type: "word",
              sourceIndex: pos,
              value: value.slice(pos, whitespacePos + 1)
            }
          ];
        } else {
          token.nodes = [];
        }
        if (token.unclosed && whitespacePos + 1 !== next) {
          token.after = "";
          token.nodes.push({
            type: "space",
            sourceIndex: whitespacePos + 1,
            value: value.slice(whitespacePos + 1, next)
          });
        } else {
          token.after = value.slice(whitespacePos + 1, next);
        }
        pos = next + 1;
        code = value.charCodeAt(pos);
        tokens.push(token);
      } else {
        balanced += 1;
        token.after = "";
        tokens.push(token);
        stack.push(token);
        tokens = token.nodes = [];
        parent = token;
      }
      name = "";

      // Close parentheses
    } else if (closeParentheses === code && balanced) {
      pos += 1;
      code = value.charCodeAt(pos);

      parent.after = after;
      after = "";
      balanced -= 1;
      stack.pop();
      parent = stack[balanced];
      tokens = parent.nodes;

      // Words
    } else {
      next = pos;
      do {
        if (code === backslash) {
          next += 1;
        }
        next += 1;
        code = value.charCodeAt(next);
      } while (
        next < max &&
        !(
          code <= 32 ||
          code === singleQuote ||
          code === doubleQuote ||
          code === comma ||
          code === colon ||
          code === slash ||
          code === openParentheses ||
          (code === closeParentheses && balanced)
        )
      );
      token = value.slice(pos, next);

      if (openParentheses === code) {
        name = token;
      } else {
        tokens.push({
          type: "word",
          sourceIndex: pos,
          value: token
        });
      }

      pos = next;
    }
  }

  for (pos = stack.length - 1; pos; pos -= 1) {
    stack[pos].unclosed = true;
  }

  return stack[0].nodes;
};


/***/ }),

/***/ "../node_modules/postcss-value-parser/lib/stringify.js":
/***/ (function(module, exports) {

function stringifyNode(node, custom) {
  var type = node.type;
  var value = node.value;
  var buf;
  var customResult;

  if (custom && (customResult = custom(node)) !== undefined) {
    return customResult;
  } else if (type === "word" || type === "space") {
    return value;
  } else if (type === "string") {
    buf = node.quote || "";
    return buf + value + (node.unclosed ? "" : buf);
  } else if (type === "comment") {
    return "/*" + value + (node.unclosed ? "" : "*/");
  } else if (type === "div") {
    return (node.before || "") + value + (node.after || "");
  } else if (Array.isArray(node.nodes)) {
    buf = stringify(node.nodes);
    if (type !== "function") {
      return buf;
    }
    return (
      value +
      "(" +
      (node.before || "") +
      buf +
      (node.after || "") +
      (node.unclosed ? "" : ")")
    );
  }
  return value;
}

function stringify(nodes, custom) {
  var result, i;

  if (Array.isArray(nodes)) {
    result = "";
    for (i = nodes.length - 1; ~i; i -= 1) {
      result = stringifyNode(nodes[i], custom) + result;
    }
    return result;
  }
  return stringifyNode(nodes, custom);
}

module.exports = stringify;


/***/ }),

/***/ "../node_modules/postcss-value-parser/lib/unit.js":
/***/ (function(module, exports) {

var minus = "-".charCodeAt(0);
var plus = "+".charCodeAt(0);
var dot = ".".charCodeAt(0);
var exp = "e".charCodeAt(0);
var EXP = "E".charCodeAt(0);

module.exports = function(value) {
  var pos = 0;
  var length = value.length;
  var dotted = false;
  var sciPos = -1;
  var containsNumber = false;
  var code;

  while (pos < length) {
    code = value.charCodeAt(pos);

    if (code >= 48 && code <= 57) {
      containsNumber = true;
    } else if (code === exp || code === EXP) {
      if (sciPos > -1) {
        break;
      }
      sciPos = pos;
    } else if (code === dot) {
      if (dotted) {
        break;
      }
      dotted = true;
    } else if (code === plus || code === minus) {
      if (pos !== 0) {
        break;
      }
    } else {
      break;
    }

    pos += 1;
  }

  if (sciPos + 1 === pos) pos--;

  return containsNumber
    ? {
        number: value.slice(0, pos),
        unit: value.slice(pos)
      }
    : false;
};


/***/ }),

/***/ "../node_modules/postcss-value-parser/lib/walk.js":
/***/ (function(module, exports) {

module.exports = function walk(nodes, cb, bubble) {
  var i, max, node, result;

  for (i = 0, max = nodes.length; i < max; i += 1) {
    node = nodes[i];
    if (!bubble) {
      result = cb(node, i, nodes);
    }

    if (
      result !== false &&
      node.type === "function" &&
      Array.isArray(node.nodes)
    ) {
      walk(node.nodes, cb, bubble);
    }

    if (bubble) {
      cb(node, i, nodes);
    }
  }
};


/***/ }),

/***/ "../node_modules/reduce-css-calc/dist/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _postcssValueParser = __webpack_require__("../node_modules/postcss-value-parser/lib/index.js");

var _postcssValueParser2 = _interopRequireDefault(_postcssValueParser);

var _parser = __webpack_require__("../node_modules/reduce-css-calc/dist/parser.js");

var _reducer = __webpack_require__("../node_modules/reduce-css-calc/dist/lib/reducer.js");

var _reducer2 = _interopRequireDefault(_reducer);

var _stringifier = __webpack_require__("../node_modules/reduce-css-calc/dist/lib/stringifier.js");

var _stringifier2 = _interopRequireDefault(_stringifier);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// eslint-disable-line
var MATCH_CALC = /((?:\-[a-z]+\-)?calc)/;

exports.default = function (value) {
  var precision = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;

  return (0, _postcssValueParser2.default)(value).walk(function (node) {
    // skip anything which isn't a calc() function
    if (node.type !== 'function' || !MATCH_CALC.test(node.value)) return;

    // stringify calc expression and produce an AST
    var contents = _postcssValueParser2.default.stringify(node.nodes);

    // skip constant() and env()
    if (contents.indexOf('constant') >= 0 || contents.indexOf('env') >= 0) return;

    var ast = _parser.parser.parse(contents);

    // reduce AST to its simplest form, that is, either to a single value
    // or a simplified calc expression
    var reducedAst = (0, _reducer2.default)(ast, precision);

    // stringify AST and write it back
    node.type = 'word';
    node.value = (0, _stringifier2.default)(node.value, reducedAst, precision);
  }, true).toString();
};

module.exports = exports['default'];

/***/ }),

/***/ "../node_modules/reduce-css-calc/dist/lib/convert.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _cssUnitConverter = __webpack_require__("../node_modules/css-unit-converter/index.js");

var _cssUnitConverter2 = _interopRequireDefault(_cssUnitConverter);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function convertNodes(left, right, precision) {
  switch (left.type) {
    case 'LengthValue':
    case 'AngleValue':
    case 'TimeValue':
    case 'FrequencyValue':
    case 'ResolutionValue':
      return convertAbsoluteLength(left, right, precision);
    default:
      return { left: left, right: right };
  }
}

function convertAbsoluteLength(left, right, precision) {
  if (right.type === left.type) {
    right = {
      type: left.type,
      value: (0, _cssUnitConverter2.default)(right.value, right.unit, left.unit, precision),
      unit: left.unit
    };
  }
  return { left: left, right: right };
}

exports.default = convertNodes;
module.exports = exports['default'];

/***/ }),

/***/ "../node_modules/reduce-css-calc/dist/lib/reducer.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.flip = flip;

var _convert = __webpack_require__("../node_modules/reduce-css-calc/dist/lib/convert.js");

var _convert2 = _interopRequireDefault(_convert);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function reduce(node, precision) {
  if (node.type === "MathExpression") return reduceMathExpression(node, precision);

  return node;
}

function isEqual(left, right) {
  return left.type === right.type && left.value === right.value;
}

function isValueType(type) {
  switch (type) {
    case 'LengthValue':
    case 'AngleValue':
    case 'TimeValue':
    case 'FrequencyValue':
    case 'ResolutionValue':
    case 'EmValue':
    case 'ExValue':
    case 'ChValue':
    case 'RemValue':
    case 'VhValue':
    case 'VwValue':
    case 'VminValue':
    case 'VmaxValue':
    case 'PercentageValue':
    case 'Value':
      return true;
  }
  return false;
}

function convertMathExpression(node, precision) {
  var nodes = (0, _convert2.default)(node.left, node.right, precision);
  var left = reduce(nodes.left, precision);
  var right = reduce(nodes.right, precision);

  if (left.type === "MathExpression" && right.type === "MathExpression") {

    if (left.operator === '/' && right.operator === '*' || left.operator === '-' && right.operator === '+' || left.operator === '*' && right.operator === '/' || left.operator === '+' && right.operator === '-') {

      if (isEqual(left.right, right.right)) nodes = (0, _convert2.default)(left.left, right.left, precision);else if (isEqual(left.right, right.left)) nodes = (0, _convert2.default)(left.left, right.right, precision);

      left = reduce(nodes.left, precision);
      right = reduce(nodes.right, precision);
    }
  }

  node.left = left;
  node.right = right;
  return node;
}

function flip(operator) {
  return operator === '+' ? '-' : '+';
}

function flipValue(node) {
  if (isValueType(node.type)) node.value = -node.value;else if (node.type == 'MathExpression') {
    node.left = flipValue(node.left);
    node.right = flipValue(node.right);
  }
  return node;
}

function reduceAddSubExpression(node, precision) {
  var _node = node,
      left = _node.left,
      right = _node.right,
      op = _node.operator;


  if (left.type === 'CssVariable' || right.type === 'CssVariable') return node;

  // something + 0 => something
  // something - 0 => something
  if (right.value === 0) return left;

  // 0 + something => something
  if (left.value === 0 && op === "+") return right;

  // 0 - something => -something
  if (left.value === 0 && op === "-") return flipValue(right);

  // value + value
  // value - value
  if (left.type === right.type && isValueType(left.type)) {
    node = Object.assign({}, left);
    if (op === "+") node.value = left.value + right.value;else node.value = left.value - right.value;
  }

  // value <op> (expr)
  if (isValueType(left.type) && (right.operator === '+' || right.operator === '-') && right.type === 'MathExpression') {
    // value + (value + something) => (value + value) + something
    // value + (value - something) => (value + value) - something
    // value - (value + something) => (value - value) - something
    // value - (value - something) => (value - value) + something
    if (left.type === right.left.type) {
      node = Object.assign({}, node);
      node.left = reduce({
        type: 'MathExpression',
        operator: op,
        left: left,
        right: right.left
      }, precision);
      node.right = right.right;
      node.operator = op === '-' ? flip(right.operator) : right.operator;
      return reduce(node, precision);
    }
    // value + (something + value) => (value + value) + something
    // value + (something - value) => (value - value) + something
    // value - (something + value) => (value - value) - something
    // value - (something - value) => (value + value) - something
    else if (left.type === right.right.type) {
        node = Object.assign({}, node);
        node.left = reduce({
          type: 'MathExpression',
          operator: op === '-' ? flip(right.operator) : right.operator,
          left: left,
          right: right.right
        }, precision);
        node.right = right.left;
        return reduce(node, precision);
      }
  }

  // (expr) <op> value
  if (left.type === 'MathExpression' && (left.operator === '+' || left.operator === '-') && isValueType(right.type)) {
    // (value + something) + value => (value + value) + something
    // (value - something) + value => (value + value) - something
    // (value + something) - value => (value - value) + something
    // (value - something) - value => (value - value) - something
    if (right.type === left.left.type) {
      node = Object.assign({}, left);
      node.left = reduce({
        type: 'MathExpression',
        operator: op,
        left: left.left,
        right: right
      }, precision);
      return reduce(node, precision);
    }
    // (something + value) + value => something + (value + value)
    // (something - value1) + value2 => something - (value2 - value1)
    // (something + value) - value => something + (value - value)
    // (something - value) - value => something - (value + value)
    else if (right.type === left.right.type) {
        node = Object.assign({}, left);
        if (left.operator === '-') {
          node.right = reduce({
            type: 'MathExpression',
            operator: op === '-' ? '+' : '-',
            left: right,
            right: left.right
          }, precision);
          node.operator = op === '-' ? '-' : '+';
        } else {
          node.right = reduce({
            type: 'MathExpression',
            operator: op,
            left: left.right,
            right: right
          }, precision);
        }
        if (node.right.value < 0) {
          node.right.value *= -1;
          node.operator = node.operator === '-' ? '+' : '-';
        }
        return reduce(node, precision);
      }
  }
  return node;
}

function reduceDivisionExpression(node, precision) {
  if (!isValueType(node.right.type)) return node;

  if (node.right.type !== 'Value') throw new Error('Cannot divide by "' + node.right.unit + '", number expected');

  if (node.right.value === 0) throw new Error('Cannot divide by zero');

  // (expr) / value
  if (node.left.type === 'MathExpression') {
    if (isValueType(node.left.left.type) && isValueType(node.left.right.type)) {
      node.left.left.value /= node.right.value;
      node.left.right.value /= node.right.value;
      return reduce(node.left, precision);
    }
    return node;
  }
  // something / value
  else if (isValueType(node.left.type)) {
      node.left.value /= node.right.value;
      return node.left;
    }
  return node;
}

function reduceMultiplicationExpression(node) {
  // (expr) * value
  if (node.left.type === 'MathExpression' && node.right.type === 'Value') {
    if (isValueType(node.left.left.type) && isValueType(node.left.right.type)) {
      node.left.left.value *= node.right.value;
      node.left.right.value *= node.right.value;
      return node.left;
    }
  }
  // something * value
  else if (isValueType(node.left.type) && node.right.type === 'Value') {
      node.left.value *= node.right.value;
      return node.left;
    }
    // value * (expr)
    else if (node.left.type === 'Value' && node.right.type === 'MathExpression') {
        if (isValueType(node.right.left.type) && isValueType(node.right.right.type)) {
          node.right.left.value *= node.left.value;
          node.right.right.value *= node.left.value;
          return node.right;
        }
      }
      // value * something
      else if (node.left.type === 'Value' && isValueType(node.right.type)) {
          node.right.value *= node.left.value;
          return node.right;
        }
  return node;
}

function reduceMathExpression(node, precision) {
  node = convertMathExpression(node, precision);

  switch (node.operator) {
    case "+":
    case "-":
      return reduceAddSubExpression(node, precision);
    case "/":
      return reduceDivisionExpression(node, precision);
    case "*":
      return reduceMultiplicationExpression(node);
  }
  return node;
}

exports.default = reduce;

/***/ }),

/***/ "../node_modules/reduce-css-calc/dist/lib/stringifier.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

exports.default = function (calc, node, precision) {
  var str = stringify(node, precision);

  if (node.type === "MathExpression") {
    // if calc expression couldn't be resolved to a single value, re-wrap it as
    // a calc()
    str = calc + "(" + str + ")";
  }
  return str;
};

var _reducer = __webpack_require__("../node_modules/reduce-css-calc/dist/lib/reducer.js");

var order = {
  "*": 0,
  "/": 0,
  "+": 1,
  "-": 1
};

function round(value, prec) {
  if (prec !== false) {
    var precision = Math.pow(10, prec);
    return Math.round(value * precision) / precision;
  }
  return value;
}

function stringify(node, prec) {
  switch (node.type) {
    case "MathExpression":
      {
        var left = node.left,
            right = node.right,
            op = node.operator;

        var str = "";

        if (left.type === 'MathExpression' && order[op] < order[left.operator]) str += "(" + stringify(left, prec) + ")";else str += stringify(left, prec);

        str += " " + node.operator + " ";

        if (right.type === 'MathExpression' && order[op] < order[right.operator]) str += "(" + stringify(right, prec) + ")";else if (right.type === 'MathExpression' && op === "-" && ["+", "-"].includes(right.operator)) {
          // fix #52 : a-(b+c) = a-b-c
          right.operator = (0, _reducer.flip)(right.operator);
          str += stringify(right, prec);
        } else str += stringify(right, prec);

        return str;
      }
    case "Value":
      return round(node.value, prec);
    case 'CssVariable':
      return node.value;
    default:
      return round(node.value, prec) + node.unit;
  }
}

module.exports = exports["default"];

/***/ }),

/***/ "../node_modules/reduce-css-calc/dist/parser.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(module) {/* parser generated by jison 0.4.18 */
/*
  Returns a Parser object of the following structure:

  Parser: {
    yy: {}
  }

  Parser.prototype: {
    yy: {},
    trace: function(),
    symbols_: {associative list: name ==> number},
    terminals_: {associative list: number ==> name},
    productions_: [...],
    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),
    table: [...],
    defaultActions: {...},
    parseError: function(str, hash),
    parse: function(input),

    lexer: {
        EOF: 1,
        parseError: function(str, hash),
        setInput: function(input),
        input: function(),
        unput: function(str),
        more: function(),
        less: function(n),
        pastInput: function(),
        upcomingInput: function(),
        showPosition: function(),
        test_match: function(regex_match_array, rule_index),
        next: function(),
        lex: function(),
        begin: function(condition),
        popState: function(),
        _currentRules: function(),
        topState: function(),
        pushState: function(condition),

        options: {
            ranges: boolean           (optional: true ==> token location info will include a .range[] member)
            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)
            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)
        },

        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),
        rules: [...],
        conditions: {associative list: name ==> set},
    }
  }


  token location info (@$, _$, etc.): {
    first_line: n,
    last_line: n,
    first_column: n,
    last_column: n,
    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)
  }


  the parseError function receives a 'hash' object with these members for lexer and parser errors: {
    text:        (matched text)
    token:       (the produced terminal token, if any)
    line:        (yylineno)
  }
  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {
    loc:         (yylloc)
    expected:    (string describing the set of expected tokens)
    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)
  }
*/
var parser = (function(){
var o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,5],$V1=[1,3],$V2=[1,4],$V3=[1,24],$V4=[1,9],$V5=[1,10],$V6=[1,11],$V7=[1,12],$V8=[1,13],$V9=[1,14],$Va=[1,15],$Vb=[1,16],$Vc=[1,17],$Vd=[1,18],$Ve=[1,19],$Vf=[1,20],$Vg=[1,21],$Vh=[1,22],$Vi=[1,23],$Vj=[1,26],$Vk=[1,27],$Vl=[1,28],$Vm=[1,29],$Vn=[1,35],$Vo=[5,6,7,8,9,11],$Vp=[5,6,7,11];
var parser = {trace: function trace() { },
yy: {},
symbols_: {"error":2,"expression":3,"math_expression":4,"EOF":5,"ADD":6,"SUB":7,"MUL":8,"DIV":9,"LPAREN":10,"RPAREN":11,"NESTED_CALC":12,"PREFIX":13,"css_variable":14,"css_value":15,"value":16,"NUMBER":17,"CSS_VAR":18,"LENGTH":19,"ANGLE":20,"TIME":21,"FREQ":22,"RES":23,"EMS":24,"EXS":25,"CHS":26,"REMS":27,"VHS":28,"VWS":29,"VMINS":30,"VMAXS":31,"PERCENTAGE":32,"$accept":0,"$end":1},
terminals_: {2:"error",5:"EOF",6:"ADD",7:"SUB",8:"MUL",9:"DIV",10:"LPAREN",11:"RPAREN",12:"NESTED_CALC",13:"PREFIX",17:"NUMBER",18:"CSS_VAR",19:"LENGTH",20:"ANGLE",21:"TIME",22:"FREQ",23:"RES",24:"EMS",25:"EXS",26:"CHS",27:"REMS",28:"VHS",29:"VWS",30:"VMINS",31:"VMAXS",32:"PERCENTAGE"},
productions_: [0,[3,2],[4,3],[4,3],[4,3],[4,3],[4,3],[4,4],[4,7],[4,1],[4,1],[4,1],[16,1],[16,2],[14,1],[15,1],[15,1],[15,1],[15,1],[15,1],[15,1],[15,1],[15,1],[15,1],[15,1],[15,1],[15,1],[15,1],[15,1],[15,2]],
performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {
/* this == yyval */

var $0 = $$.length - 1;
switch (yystate) {
case 1:
 return $$[$0-1]; 
break;
case 2: case 3: case 4: case 5:
 this.$ = { type: 'MathExpression', operator: $$[$0-1], left: $$[$0-2], right: $$[$0] }; 
break;
case 6: case 7: case 8:
 this.$ = $$[$0-1]; 
break;
case 9: case 10: case 11:
 this.$ = $$[$0]; 
break;
case 12:
 this.$ = { type: 'Value', value: parseFloat($$[$0]) }; 
break;
case 13:
 this.$ = { type: 'Value', value: parseFloat($$[$0]) * -1 }; 
break;
case 14:
 this.$ = { type: 'CssVariable', value: $$[$0] }; 
break;
case 15:
 this.$ = { type: 'LengthValue', value: parseFloat($$[$0]), unit: /[a-z]+/.exec($$[$0])[0] }; 
break;
case 16:
 this.$ = { type: 'AngleValue', value: parseFloat($$[$0]), unit: /[a-z]+/.exec($$[$0])[0] }; 
break;
case 17:
 this.$ = { type: 'TimeValue', value: parseFloat($$[$0]), unit: /[a-z]+/.exec($$[$0])[0] }; 
break;
case 18:
 this.$ = { type: 'FrequencyValue', value: parseFloat($$[$0]), unit: /[a-z]+/.exec($$[$0])[0] }; 
break;
case 19:
 this.$ = { type: 'ResolutionValue', value: parseFloat($$[$0]), unit: /[a-z]+/.exec($$[$0])[0] }; 
break;
case 20:
 this.$ = { type: 'EmValue', value: parseFloat($$[$0]), unit: 'em' }; 
break;
case 21:
 this.$ = { type: 'ExValue', value: parseFloat($$[$0]), unit: 'ex' }; 
break;
case 22:
 this.$ = { type: 'ChValue', value: parseFloat($$[$0]), unit: 'ch' }; 
break;
case 23:
 this.$ = { type: 'RemValue', value: parseFloat($$[$0]), unit: 'rem' }; 
break;
case 24:
 this.$ = { type: 'VhValue', value: parseFloat($$[$0]), unit: 'vh' }; 
break;
case 25:
 this.$ = { type: 'VwValue', value: parseFloat($$[$0]), unit: 'vw' }; 
break;
case 26:
 this.$ = { type: 'VminValue', value: parseFloat($$[$0]), unit: 'vmin' }; 
break;
case 27:
 this.$ = { type: 'VmaxValue', value: parseFloat($$[$0]), unit: 'vmax' }; 
break;
case 28:
 this.$ = { type: 'PercentageValue', value: parseFloat($$[$0]), unit: '%' }; 
break;
case 29:
 var prev = $$[$0]; prev.value *= -1; this.$ = prev; 
break;
}
},
table: [{3:1,4:2,7:$V0,10:$V1,12:$V2,14:6,15:7,16:8,17:$V3,18:$V4,19:$V5,20:$V6,21:$V7,22:$V8,23:$V9,24:$Va,25:$Vb,26:$Vc,27:$Vd,28:$Ve,29:$Vf,30:$Vg,31:$Vh,32:$Vi},{1:[3]},{5:[1,25],6:$Vj,7:$Vk,8:$Vl,9:$Vm},{4:30,7:$V0,10:$V1,12:$V2,14:6,15:7,16:8,17:$V3,18:$V4,19:$V5,20:$V6,21:$V7,22:$V8,23:$V9,24:$Va,25:$Vb,26:$Vc,27:$Vd,28:$Ve,29:$Vf,30:$Vg,31:$Vh,32:$Vi},{10:[1,31]},{7:$Vn,13:[1,32],15:33,17:[1,34],19:$V5,20:$V6,21:$V7,22:$V8,23:$V9,24:$Va,25:$Vb,26:$Vc,27:$Vd,28:$Ve,29:$Vf,30:$Vg,31:$Vh,32:$Vi},o($Vo,[2,9]),o($Vo,[2,10]),o($Vo,[2,11]),o($Vo,[2,14]),o($Vo,[2,15]),o($Vo,[2,16]),o($Vo,[2,17]),o($Vo,[2,18]),o($Vo,[2,19]),o($Vo,[2,20]),o($Vo,[2,21]),o($Vo,[2,22]),o($Vo,[2,23]),o($Vo,[2,24]),o($Vo,[2,25]),o($Vo,[2,26]),o($Vo,[2,27]),o($Vo,[2,28]),o($Vo,[2,12]),{1:[2,1]},{4:36,7:$V0,10:$V1,12:$V2,14:6,15:7,16:8,17:$V3,18:$V4,19:$V5,20:$V6,21:$V7,22:$V8,23:$V9,24:$Va,25:$Vb,26:$Vc,27:$Vd,28:$Ve,29:$Vf,30:$Vg,31:$Vh,32:$Vi},{4:37,7:$V0,10:$V1,12:$V2,14:6,15:7,16:8,17:$V3,18:$V4,19:$V5,20:$V6,21:$V7,22:$V8,23:$V9,24:$Va,25:$Vb,26:$Vc,27:$Vd,28:$Ve,29:$Vf,30:$Vg,31:$Vh,32:$Vi},{4:38,7:$V0,10:$V1,12:$V2,14:6,15:7,16:8,17:$V3,18:$V4,19:$V5,20:$V6,21:$V7,22:$V8,23:$V9,24:$Va,25:$Vb,26:$Vc,27:$Vd,28:$Ve,29:$Vf,30:$Vg,31:$Vh,32:$Vi},{4:39,7:$V0,10:$V1,12:$V2,14:6,15:7,16:8,17:$V3,18:$V4,19:$V5,20:$V6,21:$V7,22:$V8,23:$V9,24:$Va,25:$Vb,26:$Vc,27:$Vd,28:$Ve,29:$Vf,30:$Vg,31:$Vh,32:$Vi},{6:$Vj,7:$Vk,8:$Vl,9:$Vm,11:[1,40]},{4:41,7:$V0,10:$V1,12:$V2,14:6,15:7,16:8,17:$V3,18:$V4,19:$V5,20:$V6,21:$V7,22:$V8,23:$V9,24:$Va,25:$Vb,26:$Vc,27:$Vd,28:$Ve,29:$Vf,30:$Vg,31:$Vh,32:$Vi},{7:[1,42]},o($Vo,[2,29]),o($Vo,[2,13]),{7:$Vn,15:33,19:$V5,20:$V6,21:$V7,22:$V8,23:$V9,24:$Va,25:$Vb,26:$Vc,27:$Vd,28:$Ve,29:$Vf,30:$Vg,31:$Vh,32:$Vi},o($Vp,[2,2],{8:$Vl,9:$Vm}),o($Vp,[2,3],{8:$Vl,9:$Vm}),o($Vo,[2,4]),o($Vo,[2,5]),o($Vo,[2,6]),{6:$Vj,7:$Vk,8:$Vl,9:$Vm,11:[1,43]},{12:[1,44]},o($Vo,[2,7]),{10:[1,45]},{4:46,7:$V0,10:$V1,12:$V2,14:6,15:7,16:8,17:$V3,18:$V4,19:$V5,20:$V6,21:$V7,22:$V8,23:$V9,24:$Va,25:$Vb,26:$Vc,27:$Vd,28:$Ve,29:$Vf,30:$Vg,31:$Vh,32:$Vi},{6:$Vj,7:$Vk,8:$Vl,9:$Vm,11:[1,47]},o($Vo,[2,8])],
defaultActions: {25:[2,1]},
parseError: function parseError(str, hash) {
    if (hash.recoverable) {
        this.trace(str);
    } else {
        var error = new Error(str);
        error.hash = hash;
        throw error;
    }
},
parse: function parse(input) {
    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;
    var args = lstack.slice.call(arguments, 1);
    var lexer = Object.create(this.lexer);
    var sharedState = { yy: {} };
    for (var k in this.yy) {
        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {
            sharedState.yy[k] = this.yy[k];
        }
    }
    lexer.setInput(input, sharedState.yy);
    sharedState.yy.lexer = lexer;
    sharedState.yy.parser = this;
    if (typeof lexer.yylloc == 'undefined') {
        lexer.yylloc = {};
    }
    var yyloc = lexer.yylloc;
    lstack.push(yyloc);
    var ranges = lexer.options && lexer.options.ranges;
    if (typeof sharedState.yy.parseError === 'function') {
        this.parseError = sharedState.yy.parseError;
    } else {
        this.parseError = Object.getPrototypeOf(this).parseError;
    }
    function popStack(n) {
        stack.length = stack.length - 2 * n;
        vstack.length = vstack.length - n;
        lstack.length = lstack.length - n;
    }
    _token_stack:
        var lex = function () {
            var token;
            token = lexer.lex() || EOF;
            if (typeof token !== 'number') {
                token = self.symbols_[token] || token;
            }
            return token;
        };
    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;
    while (true) {
        state = stack[stack.length - 1];
        if (this.defaultActions[state]) {
            action = this.defaultActions[state];
        } else {
            if (symbol === null || typeof symbol == 'undefined') {
                symbol = lex();
            }
            action = table[state] && table[state][symbol];
        }
                    if (typeof action === 'undefined' || !action.length || !action[0]) {
                var errStr = '';
                expected = [];
                for (p in table[state]) {
                    if (this.terminals_[p] && p > TERROR) {
                        expected.push('\'' + this.terminals_[p] + '\'');
                    }
                }
                if (lexer.showPosition) {
                    errStr = 'Parse error on line ' + (yylineno + 1) + ':\n' + lexer.showPosition() + '\nExpecting ' + expected.join(', ') + ', got \'' + (this.terminals_[symbol] || symbol) + '\'';
                } else {
                    errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\'' + (this.terminals_[symbol] || symbol) + '\'');
                }
                this.parseError(errStr, {
                    text: lexer.match,
                    token: this.terminals_[symbol] || symbol,
                    line: lexer.yylineno,
                    loc: yyloc,
                    expected: expected
                });
            }
        if (action[0] instanceof Array && action.length > 1) {
            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);
        }
        switch (action[0]) {
        case 1:
            stack.push(symbol);
            vstack.push(lexer.yytext);
            lstack.push(lexer.yylloc);
            stack.push(action[1]);
            symbol = null;
            if (!preErrorSymbol) {
                yyleng = lexer.yyleng;
                yytext = lexer.yytext;
                yylineno = lexer.yylineno;
                yyloc = lexer.yylloc;
                if (recovering > 0) {
                    recovering--;
                }
            } else {
                symbol = preErrorSymbol;
                preErrorSymbol = null;
            }
            break;
        case 2:
            len = this.productions_[action[1]][1];
            yyval.$ = vstack[vstack.length - len];
            yyval._$ = {
                first_line: lstack[lstack.length - (len || 1)].first_line,
                last_line: lstack[lstack.length - 1].last_line,
                first_column: lstack[lstack.length - (len || 1)].first_column,
                last_column: lstack[lstack.length - 1].last_column
            };
            if (ranges) {
                yyval._$.range = [
                    lstack[lstack.length - (len || 1)].range[0],
                    lstack[lstack.length - 1].range[1]
                ];
            }
            r = this.performAction.apply(yyval, [
                yytext,
                yyleng,
                yylineno,
                sharedState.yy,
                action[1],
                vstack,
                lstack
            ].concat(args));
            if (typeof r !== 'undefined') {
                return r;
            }
            if (len) {
                stack = stack.slice(0, -1 * len * 2);
                vstack = vstack.slice(0, -1 * len);
                lstack = lstack.slice(0, -1 * len);
            }
            stack.push(this.productions_[action[1]][0]);
            vstack.push(yyval.$);
            lstack.push(yyval._$);
            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];
            stack.push(newState);
            break;
        case 3:
            return true;
        }
    }
    return true;
}};
/* generated by jison-lex 0.3.4 */
var lexer = (function(){
var lexer = ({

EOF:1,

parseError:function parseError(str, hash) {
        if (this.yy.parser) {
            this.yy.parser.parseError(str, hash);
        } else {
            throw new Error(str);
        }
    },

// resets the lexer, sets new input
setInput:function (input, yy) {
        this.yy = yy || this.yy || {};
        this._input = input;
        this._more = this._backtrack = this.done = false;
        this.yylineno = this.yyleng = 0;
        this.yytext = this.matched = this.match = '';
        this.conditionStack = ['INITIAL'];
        this.yylloc = {
            first_line: 1,
            first_column: 0,
            last_line: 1,
            last_column: 0
        };
        if (this.options.ranges) {
            this.yylloc.range = [0,0];
        }
        this.offset = 0;
        return this;
    },

// consumes and returns one char from the input
input:function () {
        var ch = this._input[0];
        this.yytext += ch;
        this.yyleng++;
        this.offset++;
        this.match += ch;
        this.matched += ch;
        var lines = ch.match(/(?:\r\n?|\n).*/g);
        if (lines) {
            this.yylineno++;
            this.yylloc.last_line++;
        } else {
            this.yylloc.last_column++;
        }
        if (this.options.ranges) {
            this.yylloc.range[1]++;
        }

        this._input = this._input.slice(1);
        return ch;
    },

// unshifts one char (or a string) into the input
unput:function (ch) {
        var len = ch.length;
        var lines = ch.split(/(?:\r\n?|\n)/g);

        this._input = ch + this._input;
        this.yytext = this.yytext.substr(0, this.yytext.length - len);
        //this.yyleng -= len;
        this.offset -= len;
        var oldLines = this.match.split(/(?:\r\n?|\n)/g);
        this.match = this.match.substr(0, this.match.length - 1);
        this.matched = this.matched.substr(0, this.matched.length - 1);

        if (lines.length - 1) {
            this.yylineno -= lines.length - 1;
        }
        var r = this.yylloc.range;

        this.yylloc = {
            first_line: this.yylloc.first_line,
            last_line: this.yylineno + 1,
            first_column: this.yylloc.first_column,
            last_column: lines ?
                (lines.length === oldLines.length ? this.yylloc.first_column : 0)
                 + oldLines[oldLines.length - lines.length].length - lines[0].length :
              this.yylloc.first_column - len
        };

        if (this.options.ranges) {
            this.yylloc.range = [r[0], r[0] + this.yyleng - len];
        }
        this.yyleng = this.yytext.length;
        return this;
    },

// When called from action, caches matched text and appends it on next action
more:function () {
        this._more = true;
        return this;
    },

// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.
reject:function () {
        if (this.options.backtrack_lexer) {
            this._backtrack = true;
        } else {
            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n' + this.showPosition(), {
                text: "",
                token: null,
                line: this.yylineno
            });

        }
        return this;
    },

// retain first n characters of the match
less:function (n) {
        this.unput(this.match.slice(n));
    },

// displays already matched input, i.e. for error messages
pastInput:function () {
        var past = this.matched.substr(0, this.matched.length - this.match.length);
        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\n/g, "");
    },

// displays upcoming input, i.e. for error messages
upcomingInput:function () {
        var next = this.match;
        if (next.length < 20) {
            next += this._input.substr(0, 20-next.length);
        }
        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\n/g, "");
    },

// displays the character position where the lexing error occurred, i.e. for error messages
showPosition:function () {
        var pre = this.pastInput();
        var c = new Array(pre.length + 1).join("-");
        return pre + this.upcomingInput() + "\n" + c + "^";
    },

// test the lexed token: return FALSE when not a match, otherwise return token
test_match:function (match, indexed_rule) {
        var token,
            lines,
            backup;

        if (this.options.backtrack_lexer) {
            // save context
            backup = {
                yylineno: this.yylineno,
                yylloc: {
                    first_line: this.yylloc.first_line,
                    last_line: this.last_line,
                    first_column: this.yylloc.first_column,
                    last_column: this.yylloc.last_column
                },
                yytext: this.yytext,
                match: this.match,
                matches: this.matches,
                matched: this.matched,
                yyleng: this.yyleng,
                offset: this.offset,
                _more: this._more,
                _input: this._input,
                yy: this.yy,
                conditionStack: this.conditionStack.slice(0),
                done: this.done
            };
            if (this.options.ranges) {
                backup.yylloc.range = this.yylloc.range.slice(0);
            }
        }

        lines = match[0].match(/(?:\r\n?|\n).*/g);
        if (lines) {
            this.yylineno += lines.length;
        }
        this.yylloc = {
            first_line: this.yylloc.last_line,
            last_line: this.yylineno + 1,
            first_column: this.yylloc.last_column,
            last_column: lines ?
                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\r?\n?/)[0].length :
                         this.yylloc.last_column + match[0].length
        };
        this.yytext += match[0];
        this.match += match[0];
        this.matches = match;
        this.yyleng = this.yytext.length;
        if (this.options.ranges) {
            this.yylloc.range = [this.offset, this.offset += this.yyleng];
        }
        this._more = false;
        this._backtrack = false;
        this._input = this._input.slice(match[0].length);
        this.matched += match[0];
        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);
        if (this.done && this._input) {
            this.done = false;
        }
        if (token) {
            return token;
        } else if (this._backtrack) {
            // recover context
            for (var k in backup) {
                this[k] = backup[k];
            }
            return false; // rule action called reject() implying the next rule should be tested instead.
        }
        return false;
    },

// return next match in input
next:function () {
        if (this.done) {
            return this.EOF;
        }
        if (!this._input) {
            this.done = true;
        }

        var token,
            match,
            tempMatch,
            index;
        if (!this._more) {
            this.yytext = '';
            this.match = '';
        }
        var rules = this._currentRules();
        for (var i = 0; i < rules.length; i++) {
            tempMatch = this._input.match(this.rules[rules[i]]);
            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {
                match = tempMatch;
                index = i;
                if (this.options.backtrack_lexer) {
                    token = this.test_match(tempMatch, rules[i]);
                    if (token !== false) {
                        return token;
                    } else if (this._backtrack) {
                        match = false;
                        continue; // rule action called reject() implying a rule MISmatch.
                    } else {
                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)
                        return false;
                    }
                } else if (!this.options.flex) {
                    break;
                }
            }
        }
        if (match) {
            token = this.test_match(match, rules[index]);
            if (token !== false) {
                return token;
            }
            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)
            return false;
        }
        if (this._input === "") {
            return this.EOF;
        } else {
            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\n' + this.showPosition(), {
                text: "",
                token: null,
                line: this.yylineno
            });
        }
    },

// return next match that has a token
lex:function lex() {
        var r = this.next();
        if (r) {
            return r;
        } else {
            return this.lex();
        }
    },

// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)
begin:function begin(condition) {
        this.conditionStack.push(condition);
    },

// pop the previously active lexer condition state off the condition stack
popState:function popState() {
        var n = this.conditionStack.length - 1;
        if (n > 0) {
            return this.conditionStack.pop();
        } else {
            return this.conditionStack[0];
        }
    },

// produce the lexer rule set which is active for the currently active lexer condition state
_currentRules:function _currentRules() {
        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {
            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;
        } else {
            return this.conditions["INITIAL"].rules;
        }
    },

// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available
topState:function topState(n) {
        n = this.conditionStack.length - 1 - Math.abs(n || 0);
        if (n >= 0) {
            return this.conditionStack[n];
        } else {
            return "INITIAL";
        }
    },

// alias for begin(condition)
pushState:function pushState(condition) {
        this.begin(condition);
    },

// return the number of states currently on the stack
stateStackSize:function stateStackSize() {
        return this.conditionStack.length;
    },
options: {},
performAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {
var YYSTATE=YY_START;
switch($avoiding_name_collisions) {
case 0:/* skip whitespace */
break;
case 1:return 8;
break;
case 2:return 9;
break;
case 3:return 6;
break;
case 4:return 7;
break;
case 5:return 19;
break;
case 6:return 19;
break;
case 7:return 19;
break;
case 8:return 19;
break;
case 9:return 19;
break;
case 10:return 19;
break;
case 11:return 20;
break;
case 12:return 20;
break;
case 13:return 20;
break;
case 14:return 20;
break;
case 15:return 21;
break;
case 16:return 21;
break;
case 17:return 22;
break;
case 18:return 22;
break;
case 19:return 23;
break;
case 20:return 23;
break;
case 21:return 23;
break;
case 22:return 24;
break;
case 23:return 25;
break;
case 24:return 26;
break;
case 25:return 27;
break;
case 26:return 29;
break;
case 27:return 28;
break;
case 28:return 30;
break;
case 29:return 31;
break;
case 30:return 32;
break;
case 31:return 17;
break;
case 32:return 12;
break;
case 33:return 18;
break;
case 34:return 13;
break;
case 35:return 10;
break;
case 36:return 11;
break;
case 37:return 5;
break;
}
},
rules: [/^(?:\s+)/,/^(?:\*)/,/^(?:\/)/,/^(?:\+)/,/^(?:-)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)px\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)cm\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)mm\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)in\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)pt\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)pc\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)deg\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)grad\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)rad\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)turn\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)s\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)ms\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)Hz\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)kHz\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)dpi\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)dpcm\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)dppx\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)em\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)ex\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)ch\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)rem\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)vw\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)vh\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)vmin\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)vmax\b)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)%)/,/^(?:([0-9]+(\.[0-9]*)?|\.[0-9]+)\b)/,/^(?:(calc))/,/^(?:(var\([^\)]*\)))/,/^(?:([a-z]+))/,/^(?:\()/,/^(?:\))/,/^(?:$)/],
conditions: {"INITIAL":{"rules":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"inclusive":true}}
});
return lexer;
})();
parser.lexer = lexer;
function Parser () {
  this.yy = {};
}
Parser.prototype = parser;parser.Parser = Parser;
return new Parser;
})();


if (true) {
exports.parser = parser;
exports.Parser = parser.Parser;
exports.parse = function () { return parser.parse.apply(parser, arguments); };
exports.main = function commonjsMain(args) {
    if (!args[1]) {
        console.log('Usage: '+args[0]+' FILE');
        global.process.exit(1);
    }
    var source = __webpack_require__("../node_modules/node-libs-browser/mock/empty.js").readFileSync(__webpack_require__("../node_modules/path-browserify/index.js").normalize(args[1]), "utf8");
    return exports.parser.parse(source);
};
if ( true && __webpack_require__.c[__webpack_require__.s] === module) {
  exports.main(global.process.argv.slice(1));
}
}
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/module.js")(module)))

/***/ }),

/***/ "../node_modules/string.prototype.trim/implementation.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var bind = __webpack_require__("../node_modules/function-bind/index.js");
var ES = __webpack_require__("../node_modules/es-abstract/es5.js");
var replace = bind.call(Function.call, String.prototype.replace);

/* eslint-disable no-control-regex */
var leftWhitespace = /^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/;
var rightWhitespace = /[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;
/* eslint-enable no-control-regex */

module.exports = function trim() {
	var S = ES.ToString(ES.CheckObjectCoercible(this));
	return replace(replace(S, leftWhitespace, ''), rightWhitespace, '');
};


/***/ }),

/***/ "../node_modules/string.prototype.trim/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var bind = __webpack_require__("../node_modules/function-bind/index.js");
var define = __webpack_require__("../node_modules/define-properties/index.js");

var implementation = __webpack_require__("../node_modules/string.prototype.trim/implementation.js");
var getPolyfill = __webpack_require__("../node_modules/string.prototype.trim/polyfill.js");
var shim = __webpack_require__("../node_modules/string.prototype.trim/shim.js");

var boundTrim = bind.call(Function.call, getPolyfill());

define(boundTrim, {
	getPolyfill: getPolyfill,
	implementation: implementation,
	shim: shim
});

module.exports = boundTrim;


/***/ }),

/***/ "../node_modules/string.prototype.trim/polyfill.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var implementation = __webpack_require__("../node_modules/string.prototype.trim/implementation.js");

var zeroWidthSpace = '\u200b';

module.exports = function getPolyfill() {
	if (String.prototype.trim && zeroWidthSpace.trim() === zeroWidthSpace) {
		return String.prototype.trim;
	}
	return implementation;
};


/***/ }),

/***/ "../node_modules/string.prototype.trim/shim.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var define = __webpack_require__("../node_modules/define-properties/index.js");
var getPolyfill = __webpack_require__("../node_modules/string.prototype.trim/polyfill.js");

module.exports = function shimStringTrim() {
	var polyfill = getPolyfill();
	define(String.prototype, { trim: polyfill }, {
		trim: function testTrim() {
			return String.prototype.trim !== polyfill;
		}
	});
	return polyfill;
};


/***/ }),

/***/ "../node_modules/tns-core-modules/application/application-common.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/globals.js");
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
exports.Observable = observable_1.Observable;
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var events = new observable_1.Observable();
var launched = false;
function setLaunched() {
    launched = true;
    events.off("launch", setLaunched);
}
events.on("launch", setLaunched);
if (profiling_1.level() > 0) {
    events.on("displayed", function () {
        var duration = profiling_1.uptime();
        var end = profiling_1.time();
        var start = end - duration;
        profiling_1.trace("Displayed in " + duration.toFixed(2) + "ms", start, end);
    });
}
function hasLaunched() {
    return launched;
}
exports.hasLaunched = hasLaunched;
var system_classes_1 = __webpack_require__("../node_modules/tns-core-modules/css/system-classes.js");
var enums_1 = __webpack_require__("../node_modules/tns-core-modules/ui/enums/enums.js");
exports.launchEvent = "launch";
exports.suspendEvent = "suspend";
exports.displayedEvent = "displayed";
exports.resumeEvent = "resume";
exports.exitEvent = "exit";
exports.lowMemoryEvent = "lowMemory";
exports.uncaughtErrorEvent = "uncaughtError";
exports.discardedErrorEvent = "discardedError";
exports.orientationChangedEvent = "orientationChanged";
var ORIENTATION_CSS_CLASSES = [
    "" + system_classes_1.CLASS_PREFIX + enums_1.DeviceOrientation.portrait,
    "" + system_classes_1.CLASS_PREFIX + enums_1.DeviceOrientation.landscape,
    "" + system_classes_1.CLASS_PREFIX + enums_1.DeviceOrientation.unknown
];
var cssFile = "./app.css";
var resources = {};
function getResources() {
    return resources;
}
exports.getResources = getResources;
function setResources(res) {
    resources = res;
}
exports.setResources = setResources;
exports.android = undefined;
exports.ios = undefined;
exports.on = events.on.bind(events);
exports.off = events.off.bind(events);
exports.notify = events.notify.bind(events);
exports.hasListeners = events.hasListeners.bind(events);
var app;
function setApplication(instance) {
    app = instance;
}
exports.setApplication = setApplication;
function livesync(rootView, context) {
    events.notify({ eventName: "livesync", object: app });
    var liveSyncCore = global.__onLiveSyncCore;
    var reapplyAppStyles = false;
    if (context && context.path) {
        var styleExtensions = ["css", "scss"];
        var appStylesFullFileName = getCssFileName();
        var appStylesFileName_1 = appStylesFullFileName.substring(0, appStylesFullFileName.lastIndexOf(".") + 1);
        reapplyAppStyles = styleExtensions.some(function (ext) { return context.path === appStylesFileName_1.concat(ext); });
    }
    if (rootView && reapplyAppStyles) {
        rootView._onCssStateChange();
    }
    else if (liveSyncCore) {
        liveSyncCore(context);
    }
}
exports.livesync = livesync;
function setCssFileName(cssFileName) {
    cssFile = cssFileName;
    events.notify({ eventName: "cssChanged", object: app, cssFile: cssFileName });
}
exports.setCssFileName = setCssFileName;
function getCssFileName() {
    return cssFile;
}
exports.getCssFileName = getCssFileName;
function loadAppCss() {
    try {
        events.notify({ eventName: "loadAppCss", object: app, cssFile: getCssFileName() });
    }
    catch (e) {
        throw new Error("The file " + getCssFileName() + " couldn't be loaded! " +
            "You may need to register it inside ./app/vendor.ts.");
    }
}
exports.loadAppCss = loadAppCss;
function orientationChanged(rootView, newOrientation) {
    var newOrientationCssClass = "" + system_classes_1.CLASS_PREFIX + newOrientation;
    if (!rootView.cssClasses.has(newOrientationCssClass)) {
        var removeCssClass_1 = function (c) {
            system_classes_1.removeFromRootViewCssClasses(c);
            rootView.cssClasses.delete(c);
        };
        ORIENTATION_CSS_CLASSES.forEach(function (c) { return removeCssClass_1(c); });
        system_classes_1.pushToRootViewCssClasses(newOrientationCssClass);
        rootView.cssClasses.add(newOrientationCssClass);
        rootView._onCssStateChange();
    }
}
exports.orientationChanged = orientationChanged;
global.__onUncaughtError = function (error) {
    events.notify({ eventName: exports.uncaughtErrorEvent, object: app, android: error, ios: error, error: error });
};
global.__onDiscardedError = function (error) {
    events.notify({ eventName: exports.discardedErrorEvent, object: app, error: error });
};
//# sourceMappingURL=application-common.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/application/application.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var application_common_1 = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/application/application-common.js"));
var ActivityCreated = "activityCreated";
var ActivityDestroyed = "activityDestroyed";
var ActivityStarted = "activityStarted";
var ActivityPaused = "activityPaused";
var ActivityResumed = "activityResumed";
var ActivityStopped = "activityStopped";
var SaveActivityState = "saveActivityState";
var ActivityResult = "activityResult";
var ActivityBackPressed = "activityBackPressed";
var ActivityNewIntent = "activityNewIntent";
var ActivityRequestPermissions = "activityRequestPermissions";
var AndroidApplication = (function (_super) {
    __extends(AndroidApplication, _super);
    function AndroidApplication() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.callbacks = {};
        _this._registeredReceivers = {};
        _this._pendingReceiverRegistrations = new Array();
        return _this;
    }
    AndroidApplication.prototype.init = function (nativeApp) {
        if (this.nativeApp === nativeApp) {
            return;
        }
        if (this.nativeApp) {
            throw new Error("application.android already initialized.");
        }
        this.nativeApp = nativeApp;
        this.packageName = nativeApp.getPackageName();
        this.context = nativeApp.getApplicationContext();
        this.callbacks.lifecycleCallbacks = initLifecycleCallbacks();
        this.callbacks.componentCallbacks = initComponentCallbacks();
        this.nativeApp.registerActivityLifecycleCallbacks(this.callbacks.lifecycleCallbacks);
        this.nativeApp.registerComponentCallbacks(this.callbacks.componentCallbacks);
        this._registerPendingReceivers();
    };
    AndroidApplication.prototype._registerPendingReceivers = function () {
        var _this = this;
        this._pendingReceiverRegistrations.forEach(function (func) { return func(_this.context); });
        this._pendingReceiverRegistrations.length = 0;
    };
    Object.defineProperty(AndroidApplication.prototype, "orientation", {
        get: function () {
            if (!this._orientation) {
                var resources = this.context.getResources();
                var configuration = resources.getConfiguration();
                var orientation_1 = configuration.orientation;
                this._orientation = getOrientationValue(orientation_1);
            }
            return this._orientation;
        },
        set: function (value) {
            this._orientation = value;
        },
        enumerable: true,
        configurable: true
    });
    AndroidApplication.prototype.registerBroadcastReceiver = function (intentFilter, onReceiveCallback) {
        ensureBroadCastReceiverClass();
        var that = this;
        var registerFunc = function (context) {
            var receiver = new BroadcastReceiverClass(onReceiveCallback);
            context.registerReceiver(receiver, new android.content.IntentFilter(intentFilter));
            that._registeredReceivers[intentFilter] = receiver;
        };
        if (this.context) {
            registerFunc(this.context);
        }
        else {
            this._pendingReceiverRegistrations.push(registerFunc);
        }
    };
    AndroidApplication.prototype.unregisterBroadcastReceiver = function (intentFilter) {
        var receiver = this._registeredReceivers[intentFilter];
        if (receiver) {
            this.context.unregisterReceiver(receiver);
            this._registeredReceivers[intentFilter] = undefined;
            delete this._registeredReceivers[intentFilter];
        }
    };
    AndroidApplication.activityCreatedEvent = ActivityCreated;
    AndroidApplication.activityDestroyedEvent = ActivityDestroyed;
    AndroidApplication.activityStartedEvent = ActivityStarted;
    AndroidApplication.activityPausedEvent = ActivityPaused;
    AndroidApplication.activityResumedEvent = ActivityResumed;
    AndroidApplication.activityStoppedEvent = ActivityStopped;
    AndroidApplication.saveActivityStateEvent = SaveActivityState;
    AndroidApplication.activityResultEvent = ActivityResult;
    AndroidApplication.activityBackPressedEvent = ActivityBackPressed;
    AndroidApplication.activityNewIntentEvent = ActivityNewIntent;
    AndroidApplication.activityRequestPermissionsEvent = ActivityRequestPermissions;
    return AndroidApplication;
}(application_common_1.Observable));
exports.AndroidApplication = AndroidApplication;
var androidApp = new AndroidApplication();
exports.android = androidApp;
application_common_1.setApplication(androidApp);
var mainEntry;
var started = false;
var createRootFrame = { value: true };
function _start(entry) {
    if (started) {
        throw new Error("Application is already started.");
    }
    started = true;
    mainEntry = typeof entry === "string" ? { moduleName: entry } : entry;
    if (!androidApp.nativeApp) {
        var nativeApp = getNativeApplication();
        androidApp.init(nativeApp);
    }
}
exports._start = _start;
function _shouldCreateRootFrame() {
    return createRootFrame.value;
}
exports._shouldCreateRootFrame = _shouldCreateRootFrame;
function run(entry) {
    createRootFrame.value = false;
    _start(entry);
}
exports.run = run;
function addCss(cssText) {
    application_common_1.notify({ eventName: "cssChanged", object: androidApp, cssText: cssText });
    var rootView = getRootView();
    if (rootView) {
        rootView._onCssStateChange();
    }
}
exports.addCss = addCss;
var CALLBACKS = "_callbacks";
function _resetRootView(entry) {
    var activity = androidApp.foregroundActivity;
    if (!activity) {
        throw new Error("Cannot find android activity.");
    }
    createRootFrame.value = false;
    mainEntry = typeof entry === "string" ? { moduleName: entry } : entry;
    var callbacks = activity[CALLBACKS];
    if (!callbacks) {
        throw new Error("Cannot find android activity callbacks.");
    }
    callbacks.resetActivityContent(activity);
}
exports._resetRootView = _resetRootView;
function getMainEntry() {
    return mainEntry;
}
exports.getMainEntry = getMainEntry;
function getRootView() {
    var activity = androidApp.foregroundActivity || androidApp.startActivity;
    if (!activity) {
        return undefined;
    }
    var callbacks = activity[CALLBACKS];
    return callbacks ? callbacks.getRootView() : undefined;
}
exports.getRootView = getRootView;
function getNativeApplication() {
    var nativeApp = androidApp.nativeApp;
    if (!nativeApp) {
        if (!nativeApp && com.tns.NativeScriptApplication) {
            nativeApp = com.tns.NativeScriptApplication.getInstance();
        }
        if (!nativeApp) {
            var clazz = java.lang.Class.forName("android.app.ActivityThread");
            if (clazz) {
                var method = clazz.getMethod("currentApplication", null);
                if (method) {
                    nativeApp = method.invoke(null, null);
                }
            }
        }
        if (!nativeApp) {
            throw new Error("Failed to retrieve native Android Application object. If you have a custom android.app.Application type implemented make sure that you've called the '<application-module>.android.init' method.");
        }
    }
    return nativeApp;
}
exports.getNativeApplication = getNativeApplication;
application_common_1.on(application_common_1.orientationChangedEvent, function (args) {
    var rootView = getRootView();
    if (rootView) {
        application_common_1.orientationChanged(rootView, args.newValue);
    }
});
global.__onLiveSync = function __onLiveSync(context) {
    if (androidApp && androidApp.paused) {
        return;
    }
    var rootView = getRootView();
    application_common_1.livesync(rootView, context);
};
function getOrientationValue(orientation) {
    switch (orientation) {
        case android.content.res.Configuration.ORIENTATION_LANDSCAPE:
            return "landscape";
        case android.content.res.Configuration.ORIENTATION_PORTRAIT:
            return "portrait";
        default:
            return "unknown";
    }
}
function initLifecycleCallbacks() {
    var setThemeOnLaunch = profiling_1.profile("setThemeOnLaunch", function (activity) {
        var activityInfo = activity.getPackageManager().getActivityInfo(activity.getComponentName(), android.content.pm.PackageManager.GET_META_DATA);
        if (activityInfo.metaData) {
            var setThemeOnLaunch_1 = activityInfo.metaData.getInt("SET_THEME_ON_LAUNCH", -1);
            if (setThemeOnLaunch_1 !== -1) {
                activity.setTheme(setThemeOnLaunch_1);
            }
        }
    });
    var notifyActivityCreated = profiling_1.profile("notifyActivityCreated", function (activity, savedInstanceState) {
        androidApp.notify({ eventName: ActivityCreated, object: androidApp, activity: activity, bundle: savedInstanceState });
    });
    var subscribeForGlobalLayout = profiling_1.profile("subscribeForGlobalLayout", function (activity) {
        var rootView = activity.getWindow().getDecorView().getRootView();
        global.onGlobalLayoutListener = new android.view.ViewTreeObserver.OnGlobalLayoutListener({
            onGlobalLayout: function () {
                application_common_1.notify({ eventName: application_common_1.displayedEvent, object: androidApp, activity: activity });
                var viewTreeObserver = rootView.getViewTreeObserver();
                viewTreeObserver.removeOnGlobalLayoutListener(global.onGlobalLayoutListener);
            }
        });
        rootView.getViewTreeObserver().addOnGlobalLayoutListener(global.onGlobalLayoutListener);
    });
    var lifecycleCallbacks = new android.app.Application.ActivityLifecycleCallbacks({
        onActivityCreated: profiling_1.profile("onActivityCreated", function (activity, savedInstanceState) {
            setThemeOnLaunch(activity);
            if (!androidApp.startActivity) {
                androidApp.startActivity = activity;
            }
            notifyActivityCreated(activity, savedInstanceState);
            if (application_common_1.hasListeners(application_common_1.displayedEvent)) {
                subscribeForGlobalLayout(activity);
            }
        }),
        onActivityDestroyed: profiling_1.profile("onActivityDestroyed", function (activity) {
            if (activity === androidApp.foregroundActivity) {
                androidApp.foregroundActivity = undefined;
            }
            if (activity === androidApp.startActivity) {
                androidApp.startActivity = undefined;
            }
            androidApp.notify({ eventName: ActivityDestroyed, object: androidApp, activity: activity });
            gc();
        }),
        onActivityPaused: profiling_1.profile("onActivityPaused", function (activity) {
            if (activity.isNativeScriptActivity) {
                androidApp.paused = true;
                application_common_1.notify({ eventName: application_common_1.suspendEvent, object: androidApp, android: activity });
            }
            androidApp.notify({ eventName: ActivityPaused, object: androidApp, activity: activity });
        }),
        onActivityResumed: profiling_1.profile("onActivityResumed", function (activity) {
            androidApp.foregroundActivity = activity;
            androidApp.notify({ eventName: ActivityResumed, object: androidApp, activity: activity });
        }),
        onActivitySaveInstanceState: profiling_1.profile("onActivitySaveInstanceState", function (activity, outState) {
            androidApp.notify({ eventName: SaveActivityState, object: androidApp, activity: activity, bundle: outState });
        }),
        onActivityStarted: profiling_1.profile("onActivityStarted", function (activity) {
            androidApp.notify({ eventName: ActivityStarted, object: androidApp, activity: activity });
        }),
        onActivityStopped: profiling_1.profile("onActivityStopped", function (activity) {
            androidApp.notify({ eventName: ActivityStopped, object: androidApp, activity: activity });
        })
    });
    return lifecycleCallbacks;
}
function initComponentCallbacks() {
    var componentCallbacks = new android.content.ComponentCallbacks2({
        onLowMemory: profiling_1.profile("onLowMemory", function () {
            gc();
            java.lang.System.gc();
            application_common_1.notify({ eventName: application_common_1.lowMemoryEvent, object: this, android: this });
        }),
        onTrimMemory: profiling_1.profile("onTrimMemory", function (level) {
        }),
        onConfigurationChanged: profiling_1.profile("onConfigurationChanged", function (newConfig) {
            var newConfigOrientation = newConfig.orientation;
            var newOrientation = getOrientationValue(newConfigOrientation);
            if (androidApp.orientation !== newOrientation) {
                androidApp.orientation = newOrientation;
                application_common_1.notify({
                    eventName: application_common_1.orientationChangedEvent,
                    android: androidApp.nativeApp,
                    newValue: androidApp.orientation,
                    object: androidApp
                });
            }
        })
    });
    return componentCallbacks;
}
var BroadcastReceiverClass;
function ensureBroadCastReceiverClass() {
    if (BroadcastReceiverClass) {
        return;
    }
    var BroadcastReceiver = (function (_super) {
        __extends(BroadcastReceiver, _super);
        function BroadcastReceiver(onReceiveCallback) {
            var _this = _super.call(this) || this;
            _this._onReceiveCallback = onReceiveCallback;
            return global.__native(_this);
        }
        BroadcastReceiver.prototype.onReceive = function (context, intent) {
            if (this._onReceiveCallback) {
                this._onReceiveCallback(context, intent);
            }
        };
        return BroadcastReceiver;
    }(android.content.BroadcastReceiver));
    BroadcastReceiverClass = BroadcastReceiver;
}
//# sourceMappingURL=application.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/bundle-entry-points.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {if (true) {
    __webpack_require__("../node_modules/tns-core-modules/globals/globals.js");
    global.registerModule("text/formatted-string", function () { return __webpack_require__("../node_modules/tns-core-modules/text/formatted-string.js"); });
    global.registerModule("text/span", function () { return __webpack_require__("../node_modules/tns-core-modules/text/span.js"); });
    global.registerModule("ui/action-bar", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar.js"); });
    global.registerModule("ui/activity-indicator", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator.js"); });
    global.registerModule("ui/border", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/border/border.js"); });
    global.registerModule("ui/bottom-navigation", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/bottom-navigation/bottom-navigation.js"); });
    global.registerModule("ui/button", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/button/button.js"); });
    global.registerModule("ui/content-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js"); });
    global.registerModule("ui/date-picker", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/date-picker/date-picker.js"); });
    global.registerModule("ui/frame", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js"); });
    global.registerModule("ui/html-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/html-view/html-view.js"); });
    global.registerModule("ui/image", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/image/image.js"); });
    global.registerModule("ui/label", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js"); });
    global.registerModule("ui/layouts/absolute-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout.js"); });
    global.registerModule("ui/layouts/dock-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout.js"); });
    global.registerModule("ui/layouts/grid-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout.js"); });
    global.registerModule("ui/layouts/stack-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout.js"); });
    global.registerModule("ui/layouts/flexbox-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout.js"); });
    global.registerModule("ui/layouts/wrap-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout.js"); });
    global.registerModule("ui/list-picker", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/list-picker/list-picker.js"); });
    global.registerModule("ui/page", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/page/page.js"); });
    global.registerModule("ui/placeholder", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/placeholder/placeholder.js"); });
    global.registerModule("ui/progress", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/progress/progress.js"); });
    global.registerModule("ui/proxy-view-container", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/proxy-view-container/proxy-view-container.js"); });
    global.registerModule("ui/repeater", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/repeater/repeater.js"); });
    global.registerModule("ui/scroll-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/scroll-view/scroll-view.js"); });
    global.registerModule("ui/search-bar", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/search-bar/search-bar.js"); });
    global.registerModule("ui/segmented-bar", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar.js"); });
    global.registerModule("ui/slider", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/slider/slider.js"); });
    global.registerModule("ui/switch", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/switch/switch.js"); });
    global.registerModule("ui/tab-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tab-view/tab-view.js"); });
    global.registerModule("ui/tab-navigation-base/tab-strip", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js"); });
    global.registerModule("ui/tab-navigation-base/tab-strip-item", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js"); });
    global.registerModule("ui/tab-navigation-base/tab-content-item", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item.js"); });
    global.registerModule("ui/tabs", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tabs/tabs.js"); });
    global.registerModule("ui/web-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/web-view/web-view.js"); });
    global.registerModule("ui/text-field", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field.js"); });
    global.registerModule("ui/text-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/text-view/text-view.js"); });
    global.registerModule("ui/time-picker", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/time-picker/time-picker.js"); });
    global.registerModule("ui/list-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/list-view/list-view.js"); });
}
//# sourceMappingURL=bundle-entry-points.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/color/color-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var knownColors = __webpack_require__("../node_modules/tns-core-modules/color/known-colors.js");
var SHARP = "#";
var HEX_REGEX = /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)|(^#[0-9A-F]{8}$)/i;
var Color = (function () {
    function Color() {
        if (arguments.length === 1) {
            var arg = arguments[0];
            if (types.isString(arg)) {
                if (isRgbOrRgba(arg)) {
                    this._argb = argbFromRgbOrRgba(arg);
                }
                else if (knownColors.isKnownName(arg)) {
                    var hex = knownColors.getKnownColor(arg);
                    this._name = arg;
                    this._argb = this._argbFromString(hex);
                }
                else if (HEX_REGEX.test(arg)) {
                    var hex = this._normalizeHex(arg);
                    this._argb = this._argbFromString(hex);
                }
                else {
                    throw new Error("Invalid color: " + arg);
                }
            }
            else if (types.isNumber(arg)) {
                this._argb = arg >>> 0;
            }
            else {
                throw new Error("Expected 1 or 4 constructor parameters.");
            }
        }
        else if (arguments.length === 4) {
            this._argb = (arguments[0] & 0xFF) * 0x01000000
                + (arguments[1] & 0xFF) * 0x00010000
                + (arguments[2] & 0xFF) * 0x00000100
                + (arguments[3] & 0xFF) * 0x00000001;
        }
        else {
            throw new Error("Expected 1 or 4 constructor parameters.");
        }
    }
    Object.defineProperty(Color.prototype, "a", {
        get: function () { return (this._argb / 0x01000000) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "r", {
        get: function () { return (this._argb / 0x00010000) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "g", {
        get: function () { return (this._argb / 0x00000100) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "b", {
        get: function () { return (this._argb / 0x00000001) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "argb", {
        get: function () {
            return this._argb;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "hex", {
        get: function () {
            if (this.a === 0xFF) {
                return ("#" + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b)).toUpperCase();
            }
            else {
                return ("#" + this._componentToHex(this.a) + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b)).toUpperCase();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "name", {
        get: function () {
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "ios", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "android", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Color.prototype._argbFromString = function (hex) {
        if (hex.charAt(0) === "#") {
            hex = hex.substr(1);
        }
        if (hex.length === 3) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
        }
        else if (hex.length === 4) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2] + hex[3] + hex[3];
        }
        var intVal = parseInt(hex, 16);
        if (hex.length === 6) {
            intVal = (intVal & 0x00FFFFFF) + 0xFF000000;
        }
        return intVal;
    };
    Color.prototype.equals = function (value) {
        return value && this.argb === value.argb;
    };
    Color.equals = function (value1, value2) {
        if (!value1 && !value2) {
            return true;
        }
        if (!value1 || !value2) {
            return false;
        }
        return value1.equals(value2);
    };
    Color.isValid = function (value) {
        if (types.isNullOrUndefined(value) || value instanceof Color) {
            return true;
        }
        if (!types.isString(value)) {
            return false;
        }
        if (knownColors.isKnownName(value)) {
            return true;
        }
        return HEX_REGEX.test(value) || isRgbOrRgba(value);
    };
    Color.prototype._componentToHex = function (component) {
        var hex = component.toString(16);
        if (hex.length === 1) {
            hex = "0" + hex;
        }
        return hex;
    };
    Color.prototype._normalizeHex = function (hexStr) {
        if (hexStr.charAt(0) === SHARP && hexStr.length === 4) {
            hexStr = hexStr.charAt(0)
                + hexStr.charAt(1) + hexStr.charAt(1)
                + hexStr.charAt(2) + hexStr.charAt(2)
                + hexStr.charAt(3) + hexStr.charAt(3);
        }
        return hexStr;
    };
    Color.prototype.toString = function () {
        return this.hex;
    };
    return Color;
}());
exports.Color = Color;
function isRgbOrRgba(value) {
    var toLower = value.toLowerCase();
    return (toLower.indexOf("rgb(") === 0 || toLower.indexOf("rgba(") === 0) && toLower.indexOf(")") === (toLower.length - 1);
}
function argbFromRgbOrRgba(value) {
    var toLower = value.toLowerCase();
    var parts = toLower.replace("rgba(", "").replace("rgb(", "").replace(")", "").trim().split(",");
    var r = 255;
    var g = 255;
    var b = 255;
    var a = 255;
    if (parts[0]) {
        r = parseInt(parts[0].trim());
    }
    if (parts[1]) {
        g = parseInt(parts[1].trim());
    }
    if (parts[2]) {
        b = parseInt(parts[2].trim());
    }
    if (parts[3]) {
        a = Math.round(parseFloat(parts[3].trim()) * 255);
    }
    return (a & 0xFF) * 0x01000000
        + (r & 0xFF) * 0x00010000
        + (g & 0xFF) * 0x00000100
        + (b & 0xFF) * 0x00000001;
}
//# sourceMappingURL=color-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/color/color.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var common = __webpack_require__("../node_modules/tns-core-modules/color/color-common.js");
var Color = (function (_super) {
    __extends(Color, _super);
    function Color() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Color.prototype, "android", {
        get: function () {
            return this.argb >> 0;
        },
        enumerable: true,
        configurable: true
    });
    return Color;
}(common.Color));
exports.Color = Color;
//# sourceMappingURL=color.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/color/known-colors.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var _allColors = {};
function registerColor(name, value) {
    _allColors[name.toLowerCase()] = value;
    return value;
}
function isKnownName(name) {
    if (!name) {
        return undefined;
    }
    return name.toLowerCase() in _allColors;
}
exports.isKnownName = isKnownName;
function getKnownColor(name) {
    if (!name) {
        return undefined;
    }
    return _allColors[name.toLowerCase()];
}
exports.getKnownColor = getKnownColor;
exports.Transparent = registerColor("Transparent", "#00000000");
exports.AliceBlue = registerColor("AliceBlue", "#F0F8FF");
exports.AntiqueWhite = registerColor("AntiqueWhite", "#FAEBD7");
exports.Aqua = registerColor("Aqua", "#00FFFF");
exports.Aquamarine = registerColor("Aquamarine", "#7FFFD4");
exports.Azure = registerColor("Azure", "#F0FFFF");
exports.Beige = registerColor("Beige", "#F5F5DC");
exports.Bisque = registerColor("Bisque", "#FFE4C4");
exports.Black = registerColor("Black", "#000000");
exports.BlanchedAlmond = registerColor("BlanchedAlmond", "#FFEBCD");
exports.Blue = registerColor("Blue", "#0000FF");
exports.BlueViolet = registerColor("BlueViolet", "#8A2BE2");
exports.Brown = registerColor("Brown", "#A52A2A");
exports.BurlyWood = registerColor("BurlyWood", "#DEB887");
exports.CadetBlue = registerColor("CadetBlue", "#5F9EA0");
exports.Chartreuse = registerColor("Chartreuse", "#7FFF00");
exports.Chocolate = registerColor("Chocolate", "#D2691E");
exports.Coral = registerColor("Coral", "#FF7F50");
exports.CornflowerBlue = registerColor("CornflowerBlue", "#6495ED");
exports.Cornsilk = registerColor("Cornsilk", "#FFF8DC");
exports.Crimson = registerColor("Crimson", "#DC143C");
exports.Cyan = registerColor("Cyan", "#00FFFF");
exports.DarkBlue = registerColor("DarkBlue", "#00008B");
exports.DarkCyan = registerColor("DarkCyan", "#008B8B");
exports.DarkGoldenRod = registerColor("DarkGoldenRod", "#B8860B");
exports.DarkGray = registerColor("DarkGray", "#A9A9A9");
exports.DarkGreen = registerColor("DarkGreen", "#006400");
exports.DarkKhaki = registerColor("DarkKhaki", "#BDB76B");
exports.DarkMagenta = registerColor("DarkMagenta", "#8B008B");
exports.DarkOliveGreen = registerColor("DarkOliveGreen", "#556B2F");
exports.DarkOrange = registerColor("DarkOrange", "#FF8C00");
exports.DarkOrchid = registerColor("DarkOrchid", "#9932CC");
exports.DarkRed = registerColor("DarkRed", "#8B0000");
exports.DarkSalmon = registerColor("DarkSalmon", "#E9967A");
exports.DarkSeaGreen = registerColor("DarkSeaGreen", "#8FBC8F");
exports.DarkSlateBlue = registerColor("DarkSlateBlue", "#483D8B");
exports.DarkSlateGray = registerColor("DarkSlateGray", "#2F4F4F");
exports.DarkTurquoise = registerColor("DarkTurquoise", "#00CED1");
exports.DarkViolet = registerColor("DarkViolet", "#9400D3");
exports.DeepPink = registerColor("DeepPink", "#FF1493");
exports.DeepSkyBlue = registerColor("DeepSkyBlue", "#00BFFF");
exports.DimGray = registerColor("DimGray", "#696969");
exports.DodgerBlue = registerColor("DodgerBlue", "#1E90FF");
exports.FireBrick = registerColor("FireBrick", "#B22222");
exports.FloralWhite = registerColor("FloralWhite", "#FFFAF0");
exports.ForestGreen = registerColor("ForestGreen", "#228B22");
exports.Fuchsia = registerColor("Fuchsia", "#FF00FF");
exports.Gainsboro = registerColor("Gainsboro", "#DCDCDC");
exports.GhostWhite = registerColor("GhostWhite", "#F8F8FF");
exports.Gold = registerColor("Gold", "#FFD700");
exports.GoldenRod = registerColor("GoldenRod", "#DAA520");
exports.Gray = registerColor("Gray", "#808080");
exports.Green = registerColor("Green", "#008000");
exports.GreenYellow = registerColor("GreenYellow", "#ADFF2F");
exports.HoneyDew = registerColor("HoneyDew", "#F0FFF0");
exports.HotPink = registerColor("HotPink", "#FF69B4");
exports.IndianRed = registerColor("IndianRed", "#CD5C5C");
exports.Indigo = registerColor("Indigo", "#4B0082");
exports.Ivory = registerColor("Ivory", "#FFFFF0");
exports.Khaki = registerColor("Khaki", "#F0E68C");
exports.Lavender = registerColor("Lavender", "#E6E6FA");
exports.LavenderBlush = registerColor("LavenderBlush", "#FFF0F5");
exports.LawnGreen = registerColor("LawnGreen", "#7CFC00");
exports.LemonChiffon = registerColor("LemonChiffon", "#FFFACD");
exports.LightBlue = registerColor("LightBlue", "#ADD8E6");
exports.LightCoral = registerColor("LightCoral", "#F08080");
exports.LightCyan = registerColor("LightCyan", "#E0FFFF");
exports.LightGoldenRodYellow = registerColor("LightGoldenRodYellow", "#FAFAD2");
exports.LightGray = registerColor("LightGray", "#D3D3D3");
exports.LightGreen = registerColor("LightGreen", "#90EE90");
exports.LightPink = registerColor("LightPink", "#FFB6C1");
exports.LightSalmon = registerColor("LightSalmon", "#FFA07A");
exports.LightSeaGreen = registerColor("LightSeaGreen", "#20B2AA");
exports.LightSkyBlue = registerColor("LightSkyBlue", "#87CEFA");
exports.LightSlateGray = registerColor("LightSlateGray", "#778899");
exports.LightSteelBlue = registerColor("LightSteelBlue", "#B0C4DE");
exports.LightYellow = registerColor("LightYellow", "#FFFFE0");
exports.Lime = registerColor("Lime", "#00FF00");
exports.LimeGreen = registerColor("LimeGreen", "#32CD32");
exports.Linen = registerColor("Linen", "#FAF0E6");
exports.Magenta = registerColor("Magenta", "#FF00FF");
exports.Maroon = registerColor("Maroon", "#800000");
exports.MediumAquaMarine = registerColor("MediumAquaMarine", "#66CDAA");
exports.MediumBlue = registerColor("MediumBlue", "#0000CD");
exports.MediumOrchid = registerColor("MediumOrchid", "#BA55D3");
exports.MediumPurple = registerColor("MediumPurple", "#9370DB");
exports.MediumSeaGreen = registerColor("MediumSeaGreen", "#3CB371");
exports.MediumSlateBlue = registerColor("MediumSlateBlue", "#7B68EE");
exports.MediumSpringGreen = registerColor("MediumSpringGreen", "#00FA9A");
exports.MediumTurquoise = registerColor("MediumTurquoise", "#48D1CC");
exports.MediumVioletRed = registerColor("MediumVioletRed", "#C71585");
exports.MidnightBlue = registerColor("MidnightBlue", "#191970");
exports.MintCream = registerColor("MintCream", "#F5FFFA");
exports.MistyRose = registerColor("MistyRose", "#FFE4E1");
exports.Moccasin = registerColor("Moccasin", "#FFE4B5");
exports.NavajoWhite = registerColor("NavajoWhite", "#FFDEAD");
exports.Navy = registerColor("Navy", "#000080");
exports.OldLace = registerColor("OldLace", "#FDF5E6");
exports.Olive = registerColor("Olive", "#808000");
exports.OliveDrab = registerColor("OliveDrab", "#6B8E23");
exports.Orange = registerColor("Orange", "#FFA500");
exports.OrangeRed = registerColor("OrangeRed", "#FF4500");
exports.Orchid = registerColor("Orchid", "#DA70D6");
exports.PaleGoldenRod = registerColor("PaleGoldenRod", "#EEE8AA");
exports.PaleGreen = registerColor("PaleGreen", "#98FB98");
exports.PaleTurquoise = registerColor("PaleTurquoise", "#AFEEEE");
exports.PaleVioletRed = registerColor("PaleVioletRed", "#DB7093");
exports.PapayaWhip = registerColor("PapayaWhip", "#FFEFD5");
exports.PeachPuff = registerColor("PeachPuff", "#FFDAB9");
exports.Peru = registerColor("Peru", "#CD853F");
exports.Pink = registerColor("Pink", "#FFC0CB");
exports.Plum = registerColor("Plum", "#DDA0DD");
exports.PowderBlue = registerColor("PowderBlue", "#B0E0E6");
exports.Purple = registerColor("Purple", "#800080");
exports.RebeccaPurple = registerColor("RebeccaPurple", "#663399");
exports.Red = registerColor("Red", "#FF0000");
exports.RosyBrown = registerColor("RosyBrown", "#BC8F8F");
exports.RoyalBlue = registerColor("RoyalBlue", "#4169E1");
exports.SaddleBrown = registerColor("SaddleBrown", "#8B4513");
exports.Salmon = registerColor("Salmon", "#FA8072");
exports.SandyBrown = registerColor("SandyBrown", "#F4A460");
exports.SeaGreen = registerColor("SeaGreen", "#2E8B57");
exports.SeaShell = registerColor("SeaShell", "#FFF5EE");
exports.Sienna = registerColor("Sienna", "#A0522D");
exports.Silver = registerColor("Silver", "#C0C0C0");
exports.SkyBlue = registerColor("SkyBlue", "#87CEEB");
exports.SlateBlue = registerColor("SlateBlue", "#6A5ACD");
exports.SlateGray = registerColor("SlateGray", "#708090");
exports.Snow = registerColor("Snow", "#FFFAFA");
exports.SpringGreen = registerColor("SpringGreen", "#00FF7F");
exports.SteelBlue = registerColor("SteelBlue", "#4682B4");
exports.Tan = registerColor("Tan", "#D2B48C");
exports.Teal = registerColor("Teal", "#008080");
exports.Thistle = registerColor("Thistle", "#D8BFD8");
exports.Tomato = registerColor("Tomato", "#FF6347");
exports.Turquoise = registerColor("Turquoise", "#40E0D0");
exports.Violet = registerColor("Violet", "#EE82EE");
exports.Wheat = registerColor("Wheat", "#F5DEB3");
exports.White = registerColor("White", "#FFFFFF");
exports.WhiteSmoke = registerColor("WhiteSmoke", "#F5F5F5");
exports.Yellow = registerColor("Yellow", "#FFFF00");
exports.YellowGreen = registerColor("YellowGreen", "#9ACD32");
//# sourceMappingURL=known-colors.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/css-value/index.js":
/***/ (function(module, exports) {


exports.parse = parse;

function parse(str) {
  return new Parser(str).parse();
}

function Parser(str) {
  this.str = str;
}

Parser.prototype.skip = function(m){
  this.str = this.str.slice(m[0].length);
};

Parser.prototype.comma = function(){
  var m = /^, */.exec(this.str);
  if (!m) return;
  this.skip(m);
  return { type: 'comma', string: ',' };
};

Parser.prototype.ident = function(){
  var m = /^([\w-]+) */.exec(this.str);
  if (!m) return;
  this.skip(m);
  return {
    type: 'ident',
    string: m[1]
  }
};

Parser.prototype.int = function(){
  var m = /^(([-\+]?\d+)(\S+)?) */.exec(this.str);
  if (!m) return;
  this.skip(m);
  var n = ~~m[2];
  var u = m[3];

  return {
    type: 'number',
    string: m[1],
    unit: u || '',
    value: n
  }
};

Parser.prototype.float = function(){
  var m = /^(((?:[-\+]?\d+)?\.\d+)(\S+)?) */.exec(this.str);
  if (!m) return;
  this.skip(m);
  var n = parseFloat(m[2]);
  var u = m[3];

  return {
    type: 'number',
    string: m[1],
    unit: u || '',
    value: n
  }
};

Parser.prototype.number = function(){
  return this.float() || this.int();
};

Parser.prototype.double = function(){
  var m = /^"([^"]*)" */.exec(this.str);
  if (!m) return m;
  this.skip(m);
  return {
    type: 'string',
    quote: '"',
    string: '"' + m[1] + '"',
    value: m[1]
  }
};

Parser.prototype.single = function(){
  var m = /^'([^']*)' */.exec(this.str);
  if (!m) return m;
  this.skip(m);
  return {
    type: 'string',
    quote: "'",
    string: "'" + m[1] + "'",
    value: m[1]
  }
};

Parser.prototype.string = function(){
  return this.single() || this.double();
};


Parser.prototype.value = function(){
  return this.number()
    || this.ident()
    || this.string()
    || this.comma();
};

Parser.prototype.parse = function(){
  var vals = [];

  while (this.str.length) {
    var obj = this.value();
    if (!obj) throw new Error('failed to parse near `' + this.str.slice(0, 10) + '...`');
    vals.push(obj);
  }

  return vals;
};


/***/ }),

/***/ "../node_modules/tns-core-modules/css/index.js":
/***/ (function(module, exports, __webpack_require__) {

exports.parse = __webpack_require__("../node_modules/tns-core-modules/css/lib/parse/index.js");


/***/ }),

/***/ "../node_modules/tns-core-modules/css/lib/parse/index.js":
/***/ (function(module, exports) {

// http://www.w3.org/TR/CSS21/grammar.html
// https://github.com/visionmedia/css-parse/pull/49#issuecomment-30088027
var commentre = /\/\*[^*]*\*+([^/*][^*]*\*+)*\//g

module.exports = function(css, options){
  options = options || {};

  /**
   * Positional.
   */

  var lineno = 1;
  var column = 1;

  /**
   * Update lineno and column based on `str`.
   */

  function updatePosition(str) {
    var lines = str.match(/\n/g);
    if (lines) lineno += lines.length;
    var i = str.lastIndexOf('\n');
    column = ~i ? str.length - i : column + str.length;
  }

  /**
   * Mark position and patch `node.position`.
   */

  function position() {
    var start = { line: lineno, column: column };
    return function(node){
      node.position = new Position(start);
      whitespace();
      return node;
    };
  }

  /**
   * Store position information for a node
   */

  function Position(start) {
    this.start = start;
    this.end = { line: lineno, column: column };
    this.source = options.source;
  }

  /**
   * Non-enumerable source string
   */

  Position.prototype.content = css;

  /**
   * Error `msg`.
   */

  var errorsList = [];

  function error(msg) {
    var err = new Error(options.source + ':' + lineno + ':' + column + ': ' + msg);
    err.reason = msg;
    err.filename = options.source;
    err.line = lineno;
    err.column = column;
    err.source = css;

    if (options.silent) {
      errorsList.push(err);
    } else {
      throw err;
    }
  }

  /**
   * Parse stylesheet.
   */

  function stylesheet() {
    var rulesList = rules();

    return {
      type: 'stylesheet',
      stylesheet: {
        rules: rulesList,
        parsingErrors: errorsList
      }
    };
  }

  /**
   * Opening brace.
   */

  function open() {
    return match(/^{\s*/);
  }

  /**
   * Closing brace.
   */

  function close() {
    return match(/^}/);
  }

  /**
   * Parse ruleset.
   */

  function rules() {
    var node;
    var rules = [];
    whitespace();
    comments(rules);
    while (css.length && css.charAt(0) != '}' && (node = atrule() || rule())) {
      if (node !== false) {
        rules.push(node);
        comments(rules);
      }
    }
    return rules;
  }

  /**
   * Match `re` and return captures.
   */

  function match(re) {
    var m = re.exec(css);
    if (!m) return;
    var str = m[0];
    updatePosition(str);
    css = css.slice(str.length);
    return m;
  }

  /**
   * Parse whitespace.
   */

  function whitespace() {
    match(/^\s*/);
  }

  /**
   * Parse comments;
   */

  function comments(rules) {
    var c;
    rules = rules || [];
    while (c = comment()) {
      if (c !== false) {
        rules.push(c);
      }
    }
    return rules;
  }

  /**
   * Parse comment.
   */

  function comment() {
    var pos = position();
    if ('/' != css.charAt(0) || '*' != css.charAt(1)) return;

    var i = 2;
    while ("" != css.charAt(i) && ('*' != css.charAt(i) || '/' != css.charAt(i + 1))) ++i;
    i += 2;

    if ("" === css.charAt(i-1)) {
      return error('End of comment missing');
    }

    var str = css.slice(2, i - 2);
    column += 2;
    updatePosition(str);
    css = css.slice(i);
    column += 2;

    return pos({
      type: 'comment',
      comment: str
    });
  }

  /**
   * Parse selector.
   */

  function selector() {
    var m = match(/^([^{]+)/);
    if (!m) return;
    /* @fix Remove all comments from selectors
     * http://ostermiller.org/findcomment.html */
    return trim(m[0])
      .replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g, '')
      .replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g, function(m) {
        return m.replace(/,/g, '\u200C');
      })
      .split(/\s*(?![^(]*\)),\s*/)
      .map(function(s) {
        return s.replace(/\u200C/g, ',');
      });
  }

  /**
   * Parse declaration.
   */

  function declaration() {
    var pos = position();

    // prop
    var prop = match(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);
    if (!prop) return;
    prop = trim(prop[0]);

    // :
    if (!match(/^:\s*/)) return error("property missing ':'");

    // val
    var val = match(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/);

    var ret = pos({
      type: 'declaration',
      property: prop.replace(commentre, ''),
      value: val ? trim(val[0]).replace(commentre, '') : ''
    });

    // ;
    match(/^[;\s]*/);

    return ret;
  }

  /**
   * Parse declarations.
   */

  function declarations() {
    var decls = [];

    if (!open()) return error("missing '{'");
    comments(decls);

    // declarations
    var decl;
    while (decl = declaration()) {
      if (decl !== false) {
        decls.push(decl);
        comments(decls);
      }
    }

    if (!close()) return error("missing '}'");
    return decls;
  }

  /**
   * Parse keyframe.
   */

  function keyframe() {
    var m;
    var vals = [];
    var pos = position();

    while (m = match(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/)) {
      vals.push(m[1]);
      match(/^,\s*/);
    }

    if (!vals.length) return;

    return pos({
      type: 'keyframe',
      values: vals,
      declarations: declarations()
    });
  }

  /**
   * Parse keyframes.
   */

  function atkeyframes() {
    var pos = position();
    var m = match(/^@([-\w]+)?keyframes\s*/);

    if (!m) return;
    var vendor = m[1];

    // identifier
    var m = match(/^([-\w]+)\s*/);
    if (!m) return error("@keyframes missing name");
    var name = m[1];

    if (!open()) return error("@keyframes missing '{'");

    var frame;
    var frames = comments();
    while (frame = keyframe()) {
      frames.push(frame);
      frames = frames.concat(comments());
    }

    if (!close()) return error("@keyframes missing '}'");

    return pos({
      type: 'keyframes',
      name: name,
      vendor: vendor,
      keyframes: frames
    });
  }

  /**
   * Parse supports.
   */

  function atsupports() {
    var pos = position();
    var m = match(/^@supports *([^{]+)/);

    if (!m) return;
    var supports = trim(m[1]);

    if (!open()) return error("@supports missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@supports missing '}'");

    return pos({
      type: 'supports',
      supports: supports,
      rules: style
    });
  }

  /**
   * Parse host.
   */

  function athost() {
    var pos = position();
    var m = match(/^@host\s*/);

    if (!m) return;

    if (!open()) return error("@host missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@host missing '}'");

    return pos({
      type: 'host',
      rules: style
    });
  }

  /**
   * Parse media.
   */

  function atmedia() {
    var pos = position();
    var m = match(/^@media *([^{]+)/);

    if (!m) return;
    var media = trim(m[1]);

    if (!open()) return error("@media missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@media missing '}'");

    return pos({
      type: 'media',
      media: media,
      rules: style
    });
  }


  /**
   * Parse custom-media.
   */

  function atcustommedia() {
    var pos = position();
    var m = match(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);
    if (!m) return;

    return pos({
      type: 'custom-media',
      name: trim(m[1]),
      media: trim(m[2])
    });
  }

  /**
   * Parse paged media.
   */

  function atpage() {
    var pos = position();
    var m = match(/^@page */);
    if (!m) return;

    var sel = selector() || [];

    if (!open()) return error("@page missing '{'");
    var decls = comments();

    // declarations
    var decl;
    while (decl = declaration()) {
      decls.push(decl);
      decls = decls.concat(comments());
    }

    if (!close()) return error("@page missing '}'");

    return pos({
      type: 'page',
      selectors: sel,
      declarations: decls
    });
  }

  /**
   * Parse document.
   */

  function atdocument() {
    var pos = position();
    var m = match(/^@([-\w]+)?document *([^{]+)/);
    if (!m) return;

    var vendor = trim(m[1]);
    var doc = trim(m[2]);

    if (!open()) return error("@document missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@document missing '}'");

    return pos({
      type: 'document',
      document: doc,
      vendor: vendor,
      rules: style
    });
  }

  /**
   * Parse font-face.
   */

  function atfontface() {
    var pos = position();
    var m = match(/^@font-face\s*/);
    if (!m) return;

    if (!open()) return error("@font-face missing '{'");
    var decls = comments();

    // declarations
    var decl;
    while (decl = declaration()) {
      decls.push(decl);
      decls = decls.concat(comments());
    }

    if (!close()) return error("@font-face missing '}'");

    return pos({
      type: 'font-face',
      declarations: decls
    });
  }

  /**
   * Parse import
   */

  var atimport = _compileAtrule('import');

  /**
   * Parse charset
   */

  var atcharset = _compileAtrule('charset');

  /**
   * Parse namespace
   */

  var atnamespace = _compileAtrule('namespace');

  /**
   * Parse non-block at-rules
   */


  function _compileAtrule(name) {
    var re = new RegExp('^@' + name + '\\s*([^;]+);');
    return function() {
      var pos = position();
      var m = match(re);
      if (!m) return;
      var ret = { type: name };
      ret[name] = m[1].trim();
      return pos(ret);
    }
  }

  /**
   * Parse at rule.
   */

  function atrule() {
    if (css[0] != '@') return;

    return atkeyframes()
      || atmedia()
      || atcustommedia()
      || atsupports()
      || atimport()
      || atcharset()
      || atnamespace()
      || atdocument()
      || atpage()
      || athost()
      || atfontface();
  }

  /**
   * Parse rule.
   */

  function rule() {
    var pos = position();
    var sel = selector();

    if (!sel) return error('selector missing');
    comments();

    return pos({
      type: 'rule',
      selectors: sel,
      declarations: declarations()
    });
  }

  return addParent(stylesheet());
};

/**
 * Trim `str`.
 */

function trim(str) {
  return str ? str.replace(/^\s+|\s+$/g, '') : '';
}

/**
 * Adds non-enumerable parent node reference to each node.
 */

function addParent(obj, parent) {
  var isNode = obj && typeof obj.type === 'string';
  var childParent = isNode ? obj : parent;

  for (var k in obj) {
    var value = obj[k];
    if (Array.isArray(value)) {
      value.forEach(function(v) { addParent(v, childParent); });
    } else if (value && typeof value === 'object') {
      addParent(value, childParent);
    }
  }

  if (isNode) {
    Object.defineProperty(obj, 'parent', {
      configurable: true,
      writable: true,
      enumerable: false,
      value: parent || null
    });
  }

  return obj;
}


/***/ }),

/***/ "../node_modules/tns-core-modules/css/parser.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var urlRegEx = /\s*url\((?:('|")([^\1]*)\1|([^\)]*))\)\s*/gy;
function parseURL(text, start) {
    if (start === void 0) { start = 0; }
    urlRegEx.lastIndex = start;
    var result = urlRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = urlRegEx.lastIndex;
    var value = result[2] || result[3];
    return { start: start, end: end, value: value };
}
exports.parseURL = parseURL;
var hexColorRegEx = /\s*#((?:[0-9A-F]{8})|(?:[0-9A-F]{6})|(?:[0-9A-F]{3}))\s*/giy;
function parseHexColor(text, start) {
    if (start === void 0) { start = 0; }
    hexColorRegEx.lastIndex = start;
    var result = hexColorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = hexColorRegEx.lastIndex;
    var hex = result[1];
    var argb;
    if (hex.length === 8) {
        argb = parseInt("0x" + hex);
    }
    else if (hex.length === 6) {
        argb = parseInt("0xFF" + hex);
    }
    else if (hex.length === 3) {
        argb = parseInt("0xFF" + hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2]);
    }
    return { start: start, end: end, value: argb };
}
exports.parseHexColor = parseHexColor;
function rgbaToArgbNumber(r, g, b, a) {
    if (a === void 0) { a = 1; }
    if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255 && a >= 0 && a <= 1) {
        return (Math.round(a * 0xFF) * 0x01000000) + (r * 0x010000) + (g * 0x000100) + (b * 0x000001);
    }
    else {
        return null;
    }
}
var rgbColorRegEx = /\s*(rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\))/gy;
function parseRGBColor(text, start) {
    if (start === void 0) { start = 0; }
    rgbColorRegEx.lastIndex = start;
    var result = rgbColorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = rgbColorRegEx.lastIndex;
    var value = result[1] && rgbaToArgbNumber(parseInt(result[2]), parseInt(result[3]), parseInt(result[4]));
    return { start: start, end: end, value: value };
}
exports.parseRGBColor = parseRGBColor;
var rgbaColorRegEx = /\s*(rgba\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*,\s*([01]?\.?\d*)\s*\))/gy;
function parseRGBAColor(text, start) {
    if (start === void 0) { start = 0; }
    rgbaColorRegEx.lastIndex = start;
    var result = rgbaColorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = rgbaColorRegEx.lastIndex;
    var value = rgbaToArgbNumber(parseInt(result[2]), parseInt(result[3]), parseInt(result[4]), parseFloat(result[5]));
    return { start: start, end: end, value: value };
}
exports.parseRGBAColor = parseRGBAColor;
var colors;
(function (colors) {
    colors[colors["transparent"] = 0] = "transparent";
    colors[colors["aliceblue"] = 4293982463] = "aliceblue";
    colors[colors["antiquewhite"] = 4294634455] = "antiquewhite";
    colors[colors["aqua"] = 4278255615] = "aqua";
    colors[colors["aquamarine"] = 4286578644] = "aquamarine";
    colors[colors["azure"] = 4293984255] = "azure";
    colors[colors["beige"] = 4294309340] = "beige";
    colors[colors["bisque"] = 4294960324] = "bisque";
    colors[colors["black"] = 4278190080] = "black";
    colors[colors["blanchedalmond"] = 4294962125] = "blanchedalmond";
    colors[colors["blue"] = 4278190335] = "blue";
    colors[colors["blueviolet"] = 4287245282] = "blueviolet";
    colors[colors["brown"] = 4289014314] = "brown";
    colors[colors["burlywood"] = 4292786311] = "burlywood";
    colors[colors["cadetblue"] = 4284456608] = "cadetblue";
    colors[colors["chartreuse"] = 4286578432] = "chartreuse";
    colors[colors["chocolate"] = 4291979550] = "chocolate";
    colors[colors["coral"] = 4294934352] = "coral";
    colors[colors["cornflowerblue"] = 4284782061] = "cornflowerblue";
    colors[colors["cornsilk"] = 4294965468] = "cornsilk";
    colors[colors["crimson"] = 4292613180] = "crimson";
    colors[colors["cyan"] = 4278255615] = "cyan";
    colors[colors["darkblue"] = 4278190219] = "darkblue";
    colors[colors["darkcyan"] = 4278225803] = "darkcyan";
    colors[colors["darkgoldenrod"] = 4290283019] = "darkgoldenrod";
    colors[colors["darkgray"] = 4289309097] = "darkgray";
    colors[colors["darkgreen"] = 4278215680] = "darkgreen";
    colors[colors["darkgrey"] = 4289309097] = "darkgrey";
    colors[colors["darkkhaki"] = 4290623339] = "darkkhaki";
    colors[colors["darkmagenta"] = 4287299723] = "darkmagenta";
    colors[colors["darkolivegreen"] = 4283788079] = "darkolivegreen";
    colors[colors["darkorange"] = 4294937600] = "darkorange";
    colors[colors["darkorchid"] = 4288230092] = "darkorchid";
    colors[colors["darkred"] = 4287299584] = "darkred";
    colors[colors["darksalmon"] = 4293498490] = "darksalmon";
    colors[colors["darkseagreen"] = 4287609999] = "darkseagreen";
    colors[colors["darkslateblue"] = 4282924427] = "darkslateblue";
    colors[colors["darkslategray"] = 4281290575] = "darkslategray";
    colors[colors["darkslategrey"] = 4281290575] = "darkslategrey";
    colors[colors["darkturquoise"] = 4278243025] = "darkturquoise";
    colors[colors["darkviolet"] = 4287889619] = "darkviolet";
    colors[colors["deeppink"] = 4294907027] = "deeppink";
    colors[colors["deepskyblue"] = 4278239231] = "deepskyblue";
    colors[colors["dimgray"] = 4285098345] = "dimgray";
    colors[colors["dimgrey"] = 4285098345] = "dimgrey";
    colors[colors["dodgerblue"] = 4280193279] = "dodgerblue";
    colors[colors["firebrick"] = 4289864226] = "firebrick";
    colors[colors["floralwhite"] = 4294966000] = "floralwhite";
    colors[colors["forestgreen"] = 4280453922] = "forestgreen";
    colors[colors["fuchsia"] = 4294902015] = "fuchsia";
    colors[colors["gainsboro"] = 4292664540] = "gainsboro";
    colors[colors["ghostwhite"] = 4294506751] = "ghostwhite";
    colors[colors["gold"] = 4294956800] = "gold";
    colors[colors["goldenrod"] = 4292519200] = "goldenrod";
    colors[colors["gray"] = 4286611584] = "gray";
    colors[colors["green"] = 4278222848] = "green";
    colors[colors["greenyellow"] = 4289593135] = "greenyellow";
    colors[colors["grey"] = 4286611584] = "grey";
    colors[colors["honeydew"] = 4293984240] = "honeydew";
    colors[colors["hotpink"] = 4294928820] = "hotpink";
    colors[colors["indianred"] = 4291648604] = "indianred";
    colors[colors["indigo"] = 4283105410] = "indigo";
    colors[colors["ivory"] = 4294967280] = "ivory";
    colors[colors["khaki"] = 4293977740] = "khaki";
    colors[colors["lavender"] = 4293322490] = "lavender";
    colors[colors["lavenderblush"] = 4294963445] = "lavenderblush";
    colors[colors["lawngreen"] = 4286381056] = "lawngreen";
    colors[colors["lemonchiffon"] = 4294965965] = "lemonchiffon";
    colors[colors["lightblue"] = 4289583334] = "lightblue";
    colors[colors["lightcoral"] = 4293951616] = "lightcoral";
    colors[colors["lightcyan"] = 4292935679] = "lightcyan";
    colors[colors["lightgoldenrodyellow"] = 4294638290] = "lightgoldenrodyellow";
    colors[colors["lightgray"] = 4292072403] = "lightgray";
    colors[colors["lightgreen"] = 4287688336] = "lightgreen";
    colors[colors["lightgrey"] = 4292072403] = "lightgrey";
    colors[colors["lightpink"] = 4294948545] = "lightpink";
    colors[colors["lightsalmon"] = 4294942842] = "lightsalmon";
    colors[colors["lightseagreen"] = 4280332970] = "lightseagreen";
    colors[colors["lightskyblue"] = 4287090426] = "lightskyblue";
    colors[colors["lightslategray"] = 4286023833] = "lightslategray";
    colors[colors["lightslategrey"] = 4286023833] = "lightslategrey";
    colors[colors["lightsteelblue"] = 4289774814] = "lightsteelblue";
    colors[colors["lightyellow"] = 4294967264] = "lightyellow";
    colors[colors["lime"] = 4278255360] = "lime";
    colors[colors["limegreen"] = 4281519410] = "limegreen";
    colors[colors["linen"] = 4294635750] = "linen";
    colors[colors["magenta"] = 4294902015] = "magenta";
    colors[colors["maroon"] = 4286578688] = "maroon";
    colors[colors["mediumaquamarine"] = 4284927402] = "mediumaquamarine";
    colors[colors["mediumblue"] = 4278190285] = "mediumblue";
    colors[colors["mediumorchid"] = 4290401747] = "mediumorchid";
    colors[colors["mediumpurple"] = 4287852763] = "mediumpurple";
    colors[colors["mediumseagreen"] = 4282168177] = "mediumseagreen";
    colors[colors["mediumslateblue"] = 4286277870] = "mediumslateblue";
    colors[colors["mediumspringgreen"] = 4278254234] = "mediumspringgreen";
    colors[colors["mediumturquoise"] = 4282962380] = "mediumturquoise";
    colors[colors["mediumvioletred"] = 4291237253] = "mediumvioletred";
    colors[colors["midnightblue"] = 4279834992] = "midnightblue";
    colors[colors["mintcream"] = 4294311930] = "mintcream";
    colors[colors["mistyrose"] = 4294960353] = "mistyrose";
    colors[colors["moccasin"] = 4294960309] = "moccasin";
    colors[colors["navajowhite"] = 4294958765] = "navajowhite";
    colors[colors["navy"] = 4278190208] = "navy";
    colors[colors["oldlace"] = 4294833638] = "oldlace";
    colors[colors["olive"] = 4286611456] = "olive";
    colors[colors["olivedrab"] = 4285238819] = "olivedrab";
    colors[colors["orange"] = 4294944000] = "orange";
    colors[colors["orangered"] = 4294919424] = "orangered";
    colors[colors["orchid"] = 4292505814] = "orchid";
    colors[colors["palegoldenrod"] = 4293847210] = "palegoldenrod";
    colors[colors["palegreen"] = 4288215960] = "palegreen";
    colors[colors["paleturquoise"] = 4289720046] = "paleturquoise";
    colors[colors["palevioletred"] = 4292571283] = "palevioletred";
    colors[colors["papayawhip"] = 4294963157] = "papayawhip";
    colors[colors["peachpuff"] = 4294957753] = "peachpuff";
    colors[colors["peru"] = 4291659071] = "peru";
    colors[colors["pink"] = 4294951115] = "pink";
    colors[colors["plum"] = 4292714717] = "plum";
    colors[colors["powderblue"] = 4289781990] = "powderblue";
    colors[colors["purple"] = 4286578816] = "purple";
    colors[colors["rebeccapurple"] = 4284887961] = "rebeccapurple";
    colors[colors["red"] = 4294901760] = "red";
    colors[colors["rosybrown"] = 4290547599] = "rosybrown";
    colors[colors["royalblue"] = 4282477025] = "royalblue";
    colors[colors["saddlebrown"] = 4287317267] = "saddlebrown";
    colors[colors["salmon"] = 4294606962] = "salmon";
    colors[colors["sandybrown"] = 4294222944] = "sandybrown";
    colors[colors["seagreen"] = 4281240407] = "seagreen";
    colors[colors["seashell"] = 4294964718] = "seashell";
    colors[colors["sienna"] = 4288696877] = "sienna";
    colors[colors["silver"] = 4290822336] = "silver";
    colors[colors["skyblue"] = 4287090411] = "skyblue";
    colors[colors["slateblue"] = 4285160141] = "slateblue";
    colors[colors["slategray"] = 4285563024] = "slategray";
    colors[colors["slategrey"] = 4285563024] = "slategrey";
    colors[colors["snow"] = 4294966010] = "snow";
    colors[colors["springgreen"] = 4278255487] = "springgreen";
    colors[colors["steelblue"] = 4282811060] = "steelblue";
    colors[colors["tan"] = 4291998860] = "tan";
    colors[colors["teal"] = 4278222976] = "teal";
    colors[colors["thistle"] = 4292394968] = "thistle";
    colors[colors["tomato"] = 4294927175] = "tomato";
    colors[colors["turquoise"] = 4282441936] = "turquoise";
    colors[colors["violet"] = 4293821166] = "violet";
    colors[colors["wheat"] = 4294303411] = "wheat";
    colors[colors["white"] = 4294967295] = "white";
    colors[colors["whitesmoke"] = 4294309365] = "whitesmoke";
    colors[colors["yellow"] = 4294967040] = "yellow";
    colors[colors["yellowgreen"] = 4288335154] = "yellowgreen";
})(colors = exports.colors || (exports.colors = {}));
function parseColorKeyword(value, start, keyword) {
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    if (keyword && keyword.value in colors) {
        var end = keyword.end;
        var value_1 = colors[keyword.value];
        return { start: start, end: end, value: value_1 };
    }
    return null;
}
exports.parseColorKeyword = parseColorKeyword;
function parseColor(value, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    return parseHexColor(value, start) || parseColorKeyword(value, start, keyword) || parseRGBColor(value, start) || parseRGBAColor(value, start);
}
exports.parseColor = parseColor;
var keywordRegEx = /\s*([a-z][\w\-]*)\s*/giy;
function parseKeyword(text, start) {
    if (start === void 0) { start = 0; }
    keywordRegEx.lastIndex = start;
    var result = keywordRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = keywordRegEx.lastIndex;
    var value = result[1];
    return { start: start, end: end, value: value };
}
var backgroundRepeatKeywords = new Set(["repeat", "repeat-x", "repeat-y", "no-repeat"]);
function parseRepeat(value, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    if (keyword && backgroundRepeatKeywords.has(keyword.value)) {
        var end = keyword.end;
        var value_2 = keyword.value;
        return { start: start, end: end, value: value_2 };
    }
    return null;
}
exports.parseRepeat = parseRepeat;
var unitRegEx = /\s*([\+\-]?(?:\d+\.\d+|\d+|\.\d+)(?:[eE][\+\-]?\d+)?)([a-zA-Z]+|%)?\s*/gy;
function parseUnit(text, start) {
    if (start === void 0) { start = 0; }
    unitRegEx.lastIndex = start;
    var result = unitRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = unitRegEx.lastIndex;
    var value = parseFloat(result[1]);
    var unit = result[2] || "dip";
    return { start: start, end: end, value: { value: value, unit: unit } };
}
exports.parseUnit = parseUnit;
function parsePercentageOrLength(text, start) {
    if (start === void 0) { start = 0; }
    var unitResult = parseUnit(text, start);
    if (unitResult) {
        var start_1 = unitResult.start, end = unitResult.end;
        var value = unitResult.value;
        if (value.unit === "%") {
            value.value /= 100;
        }
        else if (!value.unit) {
            value.unit = "dip";
        }
        else if (value.unit === "px" || value.unit === "dip") {
        }
        else {
            return null;
        }
        return { start: start_1, end: end, value: value };
    }
    return null;
}
exports.parsePercentageOrLength = parsePercentageOrLength;
var angleUnitsToRadMap = {
    "deg": function (start, end, deg) { return ({ start: start, end: end, value: deg / 180 * Math.PI }); },
    "rad": function (start, end, rad) { return ({ start: start, end: end, value: rad }); },
    "grad": function (start, end, grad) { return ({ start: start, end: end, value: grad / 200 * Math.PI }); },
    "turn": function (start, end, turn) { return ({ start: start, end: end, value: turn * Math.PI * 2 }); }
};
function parseAngle(value, start) {
    if (start === void 0) { start = 0; }
    var angleResult = parseUnit(value, start);
    if (angleResult) {
        var start_2 = angleResult.start, end = angleResult.end, value_3 = angleResult.value;
        return (angleUnitsToRadMap[value_3.unit] || (function (_, __, ___) { return null; }))(start_2, end, value_3.value);
    }
    return null;
}
exports.parseAngle = parseAngle;
var backgroundSizeKeywords = new Set(["auto", "contain", "cover"]);
function parseBackgroundSize(value, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    var end = start;
    if (keyword && backgroundSizeKeywords.has(keyword.value)) {
        end = keyword.end;
        var value_4 = keyword.value;
        return { start: start, end: end, value: value_4 };
    }
    var firstLength = parsePercentageOrLength(value, end);
    if (firstLength) {
        end = firstLength.end;
        var secondLength = parsePercentageOrLength(value, firstLength.end);
        if (secondLength) {
            end = secondLength.end;
            return { start: start, end: end, value: { x: firstLength.value, y: secondLength.value } };
        }
        else {
            return { start: start, end: end, value: { x: firstLength.value, y: "auto" } };
        }
    }
    return null;
}
exports.parseBackgroundSize = parseBackgroundSize;
var backgroundPositionKeywords = Object.freeze(new Set(["left", "right", "top", "bottom", "center"]));
var backgroundPositionKeywordsDirection = {
    "left": "x",
    "right": "x",
    "center": "center",
    "top": "y",
    "bottom": "y"
};
function parseBackgroundPosition(text, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(text, start); }
    function formatH(align, offset) {
        if (align.value === "center") {
            return "center";
        }
        if (offset && offset.value.value !== 0) {
            return { align: align.value, offset: offset.value };
        }
        return align.value;
    }
    function formatV(align, offset) {
        if (align.value === "center") {
            return "center";
        }
        if (offset && offset.value.value !== 0) {
            return { align: align.value, offset: offset.value };
        }
        return align.value;
    }
    var end = start;
    if (keyword && backgroundPositionKeywords.has(keyword.value)) {
        end = keyword.end;
        var firstDirection = backgroundPositionKeywordsDirection[keyword.value];
        var firstLength = firstDirection !== "center" && parsePercentageOrLength(text, end);
        if (firstLength) {
            end = firstLength.end;
        }
        var secondKeyword = parseKeyword(text, end);
        if (secondKeyword && backgroundPositionKeywords.has(secondKeyword.value)) {
            end = secondKeyword.end;
            var secondDirection = backgroundPositionKeywordsDirection[secondKeyword.end];
            if (firstDirection === secondDirection && firstDirection !== "center") {
                return null;
            }
            var secondLength = secondDirection !== "center" && parsePercentageOrLength(text, end);
            if (secondLength) {
                end = secondLength.end;
            }
            if ((firstDirection === secondDirection && secondDirection === "center") || (firstDirection === "x" || secondDirection === "y")) {
                return { start: start, end: end, value: {
                        x: formatH(keyword, firstLength),
                        y: formatV(secondKeyword, secondLength)
                    } };
            }
            else {
                return { start: start, end: end, value: {
                        x: formatH(secondKeyword, secondLength),
                        y: formatV(keyword, firstLength),
                    } };
            }
        }
        else {
            if (firstDirection === "center") {
                return { start: start, end: end, value: { x: "center", y: "center" } };
            }
            else if (firstDirection === "x") {
                return { start: start, end: end, value: { x: formatH(keyword, firstLength), y: "center" } };
            }
            else {
                return { start: start, end: end, value: { x: "center", y: formatV(keyword, firstLength) } };
            }
        }
    }
    else {
        var firstLength = parsePercentageOrLength(text, end);
        if (firstLength) {
            end = firstLength.end;
            var secondLength = parsePercentageOrLength(text, end);
            if (secondLength) {
                end = secondLength.end;
                return { start: start, end: end, value: { x: { align: "left", offset: firstLength.value }, y: { align: "top", offset: secondLength.value } } };
            }
            else {
                return { start: start, end: end, value: { x: { align: "left", offset: firstLength.value }, y: "center" } };
            }
        }
        else {
            return null;
        }
    }
}
exports.parseBackgroundPosition = parseBackgroundPosition;
var directionRegEx = /\s*to\s*(left|right|top|bottom)\s*(left|right|top|bottom)?\s*/gy;
var sideDirections = {
    top: Math.PI * 0 / 2,
    right: Math.PI * 1 / 2,
    bottom: Math.PI * 2 / 2,
    left: Math.PI * 3 / 2
};
var cornerDirections = {
    top: {
        right: Math.PI * 1 / 4,
        left: Math.PI * 7 / 4
    },
    right: {
        top: Math.PI * 1 / 4,
        bottom: Math.PI * 3 / 4
    },
    bottom: {
        right: Math.PI * 3 / 4,
        left: Math.PI * 5 / 4
    },
    left: {
        top: Math.PI * 7 / 4,
        bottom: Math.PI * 5 / 4
    }
};
function parseDirection(text, start) {
    if (start === void 0) { start = 0; }
    directionRegEx.lastIndex = start;
    var result = directionRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = directionRegEx.lastIndex;
    var firstDirection = result[1];
    if (result[2]) {
        var secondDirection = result[2];
        var value = cornerDirections[firstDirection][secondDirection];
        return value === undefined ? null : { start: start, end: end, value: value };
    }
    else {
        return { start: start, end: end, value: sideDirections[firstDirection] };
    }
}
var openingBracketRegEx = /\s*\(\s*/gy;
var closingBracketRegEx = /\s*\)\s*/gy;
var closingBracketOrCommaRegEx = /\s*(\)|,)\s*/gy;
function parseArgumentsList(text, start, argument) {
    openingBracketRegEx.lastIndex = start;
    var openingBracket = openingBracketRegEx.exec(text);
    if (!openingBracket) {
        return null;
    }
    var end = openingBracketRegEx.lastIndex;
    var value = [];
    closingBracketRegEx.lastIndex = end;
    var closingBracket = closingBracketRegEx.exec(text);
    if (closingBracket) {
        return { start: start, end: end, value: value };
    }
    for (var index_1 = 0; true; index_1++) {
        var arg = argument(text, end, index_1);
        if (!arg) {
            return null;
        }
        end = arg.end;
        value.push(arg);
        closingBracketOrCommaRegEx.lastIndex = end;
        var closingBracketOrComma = closingBracketOrCommaRegEx.exec(text);
        if (closingBracketOrComma) {
            end = closingBracketOrCommaRegEx.lastIndex;
            if (closingBracketOrComma[1] === ",") {
                continue;
            }
            else if (closingBracketOrComma[1] === ")") {
                return { start: start, end: end, value: value };
            }
        }
        else {
            return null;
        }
    }
}
function parseColorStop(text, start) {
    if (start === void 0) { start = 0; }
    var color = parseColor(text, start);
    if (!color) {
        return null;
    }
    var end = color.end;
    var offset = parsePercentageOrLength(text, end);
    if (offset) {
        end = offset.end;
        return { start: start, end: end, value: { argb: color.value, offset: offset.value } };
    }
    return { start: start, end: end, value: { argb: color.value } };
}
exports.parseColorStop = parseColorStop;
var linearGradientStartRegEx = /\s*linear-gradient\s*/gy;
function parseLinearGradient(text, start) {
    if (start === void 0) { start = 0; }
    linearGradientStartRegEx.lastIndex = start;
    var lgs = linearGradientStartRegEx.exec(text);
    if (!lgs) {
        return null;
    }
    var end = linearGradientStartRegEx.lastIndex;
    var angle = Math.PI;
    var colors = [];
    var parsedArgs = parseArgumentsList(text, end, function (text, start, index) {
        if (index === 0) {
            var angleArg = parseAngle(text, start) || parseDirection(text, start);
            if (angleArg) {
                angle = angleArg.value;
                return angleArg;
            }
        }
        var colorStop = parseColorStop(text, start);
        if (colorStop) {
            colors.push(colorStop.value);
            return colorStop;
        }
        return null;
    });
    if (!parsedArgs) {
        return null;
    }
    end = parsedArgs.end;
    return { start: start, end: end, value: { angle: angle, colors: colors } };
}
exports.parseLinearGradient = parseLinearGradient;
var slashRegEx = /\s*(\/)\s*/gy;
function parseSlash(text, start) {
    slashRegEx.lastIndex = start;
    var slash = slashRegEx.exec(text);
    if (!slash) {
        return null;
    }
    var end = slashRegEx.lastIndex;
    return { start: start, end: end, value: "/" };
}
function parseBackground(text, start) {
    if (start === void 0) { start = 0; }
    var value = {};
    var end = start;
    while (end < text.length) {
        var keyword = parseKeyword(text, end);
        var color = parseColor(text, end, keyword);
        if (color) {
            value.color = color.value;
            end = color.end;
            continue;
        }
        var repeat = parseRepeat(text, end, keyword);
        if (repeat) {
            value.repeat = repeat.value;
            end = repeat.end;
            continue;
        }
        var position = parseBackgroundPosition(text, end, keyword);
        if (position) {
            position.value.text = text.substring(position.start, position.end);
            value.position = position.value;
            end = position.end;
            var slash = parseSlash(text, end);
            if (slash) {
                end = slash.end;
                var size = parseBackgroundSize(text, end);
                if (!size) {
                    return null;
                }
                value.size = size.value;
                end = size.end;
            }
            continue;
        }
        var url = parseURL(text, end);
        if (url) {
            value.image = url.value;
            end = url.end;
            continue;
        }
        var gradient = parseLinearGradient(text, end);
        if (gradient) {
            value.image = gradient.value;
            end = gradient.end;
            continue;
        }
        return null;
    }
    return { start: start, end: end, value: value };
}
exports.parseBackground = parseBackground;
var universalSelectorRegEx = /\*/gy;
function parseUniversalSelector(text, start) {
    if (start === void 0) { start = 0; }
    universalSelectorRegEx.lastIndex = start;
    var result = universalSelectorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = universalSelectorRegEx.lastIndex;
    return { start: start, end: end, value: { type: "*" } };
}
exports.parseUniversalSelector = parseUniversalSelector;
var simpleIdentifierSelectorRegEx = /(#|\.|:|\b)([_-\w][_-\w\d\\/]*)/gy;
function parseSimpleIdentifierSelector(text, start) {
    if (start === void 0) { start = 0; }
    simpleIdentifierSelectorRegEx.lastIndex = start;
    var result = simpleIdentifierSelectorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = simpleIdentifierSelectorRegEx.lastIndex;
    var type = result[1];
    var identifier = result[2].replace(/\\/g, "");
    var value = { type: type, identifier: identifier };
    return { start: start, end: end, value: value };
}
exports.parseSimpleIdentifierSelector = parseSimpleIdentifierSelector;
var attributeSelectorRegEx = /\[\s*([_-\w][_-\w\d]*)\s*(?:(=|\^=|\$=|\*=|\~=|\|=)\s*(?:([_-\w][_-\w\d]*)|"((?:[^\\"]|\\(?:"|n|r|f|\\|0-9a-f))*)"|'((?:[^\\']|\\(?:'|n|r|f|\\|0-9a-f))*)')\s*)?\]/gy;
function parseAttributeSelector(text, start) {
    attributeSelectorRegEx.lastIndex = start;
    var result = attributeSelectorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = attributeSelectorRegEx.lastIndex;
    var property = result[1];
    if (result[2]) {
        var test_1 = result[2];
        var value = result[3] || result[4] || result[5];
        return { start: start, end: end, value: { type: "[]", property: property, test: test_1, value: value } };
    }
    return { start: start, end: end, value: { type: "[]", property: property } };
}
exports.parseAttributeSelector = parseAttributeSelector;
function parseSimpleSelector(text, start) {
    if (start === void 0) { start = 0; }
    return parseUniversalSelector(text, start) ||
        parseSimpleIdentifierSelector(text, start) ||
        parseAttributeSelector(text, start);
}
exports.parseSimpleSelector = parseSimpleSelector;
function parseSimpleSelectorSequence(text, start) {
    var simpleSelector = parseSimpleSelector(text, start);
    if (!simpleSelector) {
        return null;
    }
    var end = simpleSelector.end;
    var value = [];
    while (simpleSelector) {
        value.push(simpleSelector.value);
        end = simpleSelector.end;
        simpleSelector = parseSimpleSelector(text, end);
    }
    return { start: start, end: end, value: value };
}
exports.parseSimpleSelectorSequence = parseSimpleSelectorSequence;
var combinatorRegEx = /\s*(\+|~|>)?\s*/gy;
function parseCombinator(text, start) {
    if (start === void 0) { start = 0; }
    combinatorRegEx.lastIndex = start;
    var result = combinatorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = combinatorRegEx.lastIndex;
    var value = result[1] || " ";
    return { start: start, end: end, value: value };
}
exports.parseCombinator = parseCombinator;
var whiteSpaceRegEx = /\s*/gy;
function parseSelector(text, start) {
    if (start === void 0) { start = 0; }
    var end = start;
    whiteSpaceRegEx.lastIndex = end;
    var leadingWhiteSpace = whiteSpaceRegEx.exec(text);
    if (leadingWhiteSpace) {
        end = whiteSpaceRegEx.lastIndex;
    }
    var value = [];
    var combinator;
    var expectSimpleSelector = true;
    var pair;
    do {
        var simpleSelectorSequence = parseSimpleSelectorSequence(text, end);
        if (!simpleSelectorSequence) {
            if (expectSimpleSelector) {
                return null;
            }
            else {
                break;
            }
        }
        end = simpleSelectorSequence.end;
        if (combinator) {
            pair[1] = combinator.value;
        }
        pair = [simpleSelectorSequence.value, undefined];
        value.push(pair);
        combinator = parseCombinator(text, end);
        if (combinator) {
            end = combinator.end;
        }
        expectSimpleSelector = combinator && combinator.value !== " ";
    } while (combinator);
    return { start: start, end: end, value: value };
}
exports.parseSelector = parseSelector;
var whitespaceRegEx = /[\s\t\n\r\f]*/gym;
var singleQuoteStringRegEx = /'((?:[^\n\r\f\']|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))*)(:?'|$)/gym;
var doubleQuoteStringRegEx = /"((?:[^\n\r\f\"]|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))*)(:?"|$)/gym;
var commentRegEx = /(\/\*(?:[^\*]|\*[^\/])*\*\/)/gym;
var numberRegEx = /[\+\-]?(?:\d+\.\d+|\d+|\.\d+)(?:[eE][\+\-]?\d+)?/gym;
var nameRegEx = /-?(?:(?:[a-zA-Z_]|[^\x00-\x7F]|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))(?:[a-zA-Z_0-9\-]*|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))*)/gym;
var CSS3Parser = (function () {
    function CSS3Parser(text) {
        this.text = text;
        this.nextInputCodePointIndex = 0;
    }
    CSS3Parser.prototype.tokenize = function () {
        var tokens = [];
        var inputToken;
        do {
            inputToken = this.consumeAToken();
            tokens.push(inputToken);
        } while (inputToken);
        return tokens;
    };
    CSS3Parser.prototype.consumeAToken = function () {
        if (this.reconsumedInputToken) {
            var result = this.reconsumedInputToken;
            this.reconsumedInputToken = null;
            return result;
        }
        var char = this.text[this.nextInputCodePointIndex];
        switch (char) {
            case "\"": return this.consumeAStringToken();
            case "'": return this.consumeAStringToken();
            case "(":
            case ")":
            case ",":
            case ":":
            case ";":
            case "[":
            case "]":
            case "{":
            case "}":
                this.nextInputCodePointIndex++;
                return char;
            case "#": return this.consumeAHashToken() || this.consumeADelimToken();
            case " ":
            case "\t":
            case "\n":
            case "\r":
            case "\f":
                return this.consumeAWhitespace();
            case "@": return this.consumeAtKeyword() || this.consumeADelimToken();
            case "\\": return this.consumeAnIdentLikeToken() || this.consumeADelimToken();
            case "0":
            case "1":
            case "2":
            case "3":
            case "4":
            case "5":
            case "6":
            case "7":
            case "8":
            case "9":
                return this.consumeANumericToken();
            case "u":
            case "U":
                if (this.text[this.nextInputCodePointIndex + 1] === "+") {
                    var thirdChar = this.text[this.nextInputCodePointIndex + 2];
                    if (thirdChar >= "0" && thirdChar <= "9" || thirdChar === "?") {
                        throw new Error("Unicode tokens not supported!");
                    }
                }
                return this.consumeAnIdentLikeToken() || this.consumeADelimToken();
            case "$":
            case "*":
            case "^":
            case "|":
            case "~":
                return this.consumeAMatchToken() || this.consumeADelimToken();
            case "-": return this.consumeANumericToken() || this.consumeAnIdentLikeToken() || this.consumeCDC() || this.consumeADelimToken();
            case "+":
            case ".":
                return this.consumeANumericToken() || this.consumeADelimToken();
            case "/": return this.consumeAComment() || this.consumeADelimToken();
            case "<": return this.consumeCDO() || this.consumeADelimToken();
            case undefined: return undefined;
            default: return this.consumeAnIdentLikeToken() || this.consumeADelimToken();
        }
    };
    CSS3Parser.prototype.consumeADelimToken = function () {
        return { type: 2, text: this.text[this.nextInputCodePointIndex++] };
    };
    CSS3Parser.prototype.consumeAWhitespace = function () {
        whitespaceRegEx.lastIndex = this.nextInputCodePointIndex;
        whitespaceRegEx.exec(this.text);
        this.nextInputCodePointIndex = whitespaceRegEx.lastIndex;
        return " ";
    };
    CSS3Parser.prototype.consumeAHashToken = function () {
        this.nextInputCodePointIndex++;
        var hashName = this.consumeAName();
        if (hashName) {
            return { type: 12, text: "#" + hashName.text };
        }
        this.nextInputCodePointIndex--;
        return null;
    };
    CSS3Parser.prototype.consumeCDO = function () {
        if (this.text.substr(this.nextInputCodePointIndex, 4) === "<!--") {
            this.nextInputCodePointIndex += 4;
            return "<!--";
        }
        return null;
    };
    CSS3Parser.prototype.consumeCDC = function () {
        if (this.text.substr(this.nextInputCodePointIndex, 3) === "-->") {
            this.nextInputCodePointIndex += 3;
            return "-->";
        }
        return null;
    };
    CSS3Parser.prototype.consumeAMatchToken = function () {
        if (this.text[this.nextInputCodePointIndex + 1] === "=") {
            var token = this.text.substr(this.nextInputCodePointIndex, 2);
            this.nextInputCodePointIndex += 2;
            return token;
        }
        return null;
    };
    CSS3Parser.prototype.consumeANumericToken = function () {
        numberRegEx.lastIndex = this.nextInputCodePointIndex;
        var result = numberRegEx.exec(this.text);
        if (!result) {
            return null;
        }
        this.nextInputCodePointIndex = numberRegEx.lastIndex;
        if (this.text[this.nextInputCodePointIndex] === "%") {
            return { type: 4, text: result[0] };
        }
        var name = this.consumeAName();
        if (name) {
            return { type: 5, text: result[0] + name.text };
        }
        return { type: 3, text: result[0] };
    };
    CSS3Parser.prototype.consumeAnIdentLikeToken = function () {
        var name = this.consumeAName();
        if (!name) {
            return null;
        }
        if (this.text[this.nextInputCodePointIndex] === "(") {
            this.nextInputCodePointIndex++;
            if (name.text.toLowerCase() === "url") {
                return this.consumeAURLToken();
            }
            return { type: 8, name: name.text, text: name.text + "(" };
        }
        return name;
    };
    CSS3Parser.prototype.consumeAStringToken = function () {
        var char = this.text[this.nextInputCodePointIndex];
        var result;
        if (char === "'") {
            singleQuoteStringRegEx.lastIndex = this.nextInputCodePointIndex;
            result = singleQuoteStringRegEx.exec(this.text);
            if (!result) {
                return null;
            }
            this.nextInputCodePointIndex = singleQuoteStringRegEx.lastIndex;
        }
        else if (char === "\"") {
            doubleQuoteStringRegEx.lastIndex = this.nextInputCodePointIndex;
            result = doubleQuoteStringRegEx.exec(this.text);
            if (!result) {
                return null;
            }
            this.nextInputCodePointIndex = doubleQuoteStringRegEx.lastIndex;
        }
        return { type: 1, text: result[0] };
    };
    CSS3Parser.prototype.consumeAURLToken = function () {
        var start = this.nextInputCodePointIndex - 3 - 1;
        var urlToken = { type: 7, text: undefined };
        this.consumeAWhitespace();
        if (this.nextInputCodePointIndex >= this.text.length) {
            return urlToken;
        }
        var nextInputCodePoint = this.text[this.nextInputCodePointIndex];
        if (nextInputCodePoint === "\"" || nextInputCodePoint === "'") {
            var stringToken = this.consumeAStringToken();
            urlToken.text = stringToken.text;
            this.consumeAWhitespace();
            if (this.text[this.nextInputCodePointIndex] === ")" || this.nextInputCodePointIndex >= this.text.length) {
                this.nextInputCodePointIndex++;
                var end = this.nextInputCodePointIndex;
                urlToken.text = this.text.substring(start, end);
                return urlToken;
            }
            else {
                return null;
            }
        }
        while (this.nextInputCodePointIndex < this.text.length) {
            var char = this.text[this.nextInputCodePointIndex++];
            switch (char) {
                case ")": return urlToken;
                case " ":
                case "\t":
                case "\n":
                case "\r":
                case "\f":
                    this.consumeAWhitespace();
                    if (this.text[this.nextInputCodePointIndex] === ")") {
                        this.nextInputCodePointIndex++;
                        return urlToken;
                    }
                    else {
                        return null;
                    }
                case "\"":
                case "\'":
                    return null;
                case "\\":
                    throw new Error("Escaping not yet supported!");
                default:
                    urlToken.text += char;
            }
        }
        return urlToken;
    };
    CSS3Parser.prototype.consumeAName = function () {
        nameRegEx.lastIndex = this.nextInputCodePointIndex;
        var result = nameRegEx.exec(this.text);
        if (!result) {
            return null;
        }
        this.nextInputCodePointIndex = nameRegEx.lastIndex;
        return { type: 6, text: result[0] };
    };
    CSS3Parser.prototype.consumeAtKeyword = function () {
        this.nextInputCodePointIndex++;
        var name = this.consumeAName();
        if (name) {
            return { type: 11, text: name.text };
        }
        this.nextInputCodePointIndex--;
        return null;
    };
    CSS3Parser.prototype.consumeAComment = function () {
        if (this.text[this.nextInputCodePointIndex + 1] === "*") {
            commentRegEx.lastIndex = this.nextInputCodePointIndex;
            var result = commentRegEx.exec(this.text);
            if (!result) {
                return null;
            }
            this.nextInputCodePointIndex = commentRegEx.lastIndex;
            return this.consumeAToken();
        }
        return null;
    };
    CSS3Parser.prototype.reconsumeTheCurrentInputToken = function (currentInputToken) {
        this.reconsumedInputToken = currentInputToken;
    };
    CSS3Parser.prototype.parseAStylesheet = function () {
        this.topLevelFlag = true;
        var stylesheet = {
            rules: this.consumeAListOfRules()
        };
        return stylesheet;
    };
    CSS3Parser.prototype.consumeAListOfRules = function () {
        var rules = [];
        var inputToken;
        while (inputToken = this.consumeAToken()) {
            switch (inputToken) {
                case " ": continue;
                case "<!--":
                case "-->":
                    if (this.topLevelFlag) {
                        continue;
                    }
                    this.reconsumeTheCurrentInputToken(inputToken);
                    var atRule = this.consumeAnAtRule();
                    if (atRule) {
                        rules.push(atRule);
                    }
                    continue;
            }
            if (inputToken.type === 11) {
                this.reconsumeTheCurrentInputToken(inputToken);
                var atRule = this.consumeAnAtRule();
                if (atRule) {
                    rules.push(atRule);
                }
                continue;
            }
            this.reconsumeTheCurrentInputToken(inputToken);
            var qualifiedRule = this.consumeAQualifiedRule();
            if (qualifiedRule) {
                rules.push(qualifiedRule);
            }
        }
        return rules;
    };
    CSS3Parser.prototype.consumeAnAtRule = function () {
        var inputToken = this.consumeAToken();
        var atRule = {
            type: "at-rule",
            name: inputToken.text,
            prelude: [],
            block: undefined
        };
        while (inputToken = this.consumeAToken()) {
            if (inputToken === ";") {
                return atRule;
            }
            else if (inputToken === "{") {
                atRule.block = this.consumeASimpleBlock(inputToken);
                return atRule;
            }
            else if (inputToken.type === 9 && inputToken.associatedToken === "{") {
                atRule.block = inputToken;
                return atRule;
            }
            this.reconsumeTheCurrentInputToken(inputToken);
            var component = this.consumeAComponentValue();
            if (component) {
                atRule.prelude.push(component);
            }
        }
        return atRule;
    };
    CSS3Parser.prototype.consumeAQualifiedRule = function () {
        var qualifiedRule = {
            type: "qualified-rule",
            prelude: [],
            block: undefined
        };
        var inputToken;
        while (inputToken = this.consumeAToken()) {
            if (inputToken === "{") {
                var block = this.consumeASimpleBlock(inputToken);
                qualifiedRule.block = block;
                return qualifiedRule;
            }
            else if (inputToken.type === 9) {
                var simpleBlock = inputToken;
                if (simpleBlock.associatedToken === "{") {
                    qualifiedRule.block = simpleBlock;
                    return qualifiedRule;
                }
            }
            this.reconsumeTheCurrentInputToken(inputToken);
            var componentValue = this.consumeAComponentValue();
            if (componentValue) {
                qualifiedRule.prelude.push(componentValue);
            }
        }
        return null;
    };
    CSS3Parser.prototype.consumeAComponentValue = function () {
        var inputToken = this.consumeAToken();
        switch (inputToken) {
            case "{":
            case "[":
            case "(":
                this.nextInputCodePointIndex++;
                return this.consumeASimpleBlock(inputToken);
        }
        if (typeof inputToken === "object" && inputToken.type === 8) {
            return this.consumeAFunction(inputToken.name);
        }
        return inputToken;
    };
    CSS3Parser.prototype.consumeASimpleBlock = function (associatedToken) {
        var endianToken = {
            "[": "]",
            "{": "}",
            "(": ")"
        }[associatedToken];
        var start = this.nextInputCodePointIndex - 1;
        var block = {
            type: 9,
            text: undefined,
            associatedToken: associatedToken,
            values: []
        };
        var nextInputToken;
        while (nextInputToken = this.text[this.nextInputCodePointIndex]) {
            if (nextInputToken === endianToken) {
                this.nextInputCodePointIndex++;
                var end = this.nextInputCodePointIndex;
                block.text = this.text.substring(start, end);
                return block;
            }
            var value = this.consumeAComponentValue();
            if (value) {
                block.values.push(value);
            }
        }
        block.text = this.text.substring(start);
        return block;
    };
    CSS3Parser.prototype.consumeAFunction = function (name) {
        var start = this.nextInputCodePointIndex;
        var funcToken = { type: 14, name: name, text: undefined, components: [] };
        do {
            if (this.nextInputCodePointIndex >= this.text.length) {
                funcToken.text = name + "(" + this.text.substring(start);
                return funcToken;
            }
            var nextInputToken = this.text[this.nextInputCodePointIndex];
            switch (nextInputToken) {
                case ")":
                    this.nextInputCodePointIndex++;
                    var end = this.nextInputCodePointIndex;
                    funcToken.text = name + "(" + this.text.substring(start, end);
                    return funcToken;
                default:
                    var component = this.consumeAComponentValue();
                    if (component) {
                        funcToken.components.push(component);
                    }
            }
        } while (true);
    };
    return CSS3Parser;
}());
exports.CSS3Parser = CSS3Parser;
var CSSNativeScript = (function () {
    function CSSNativeScript() {
    }
    CSSNativeScript.prototype.parseStylesheet = function (stylesheet) {
        return {
            type: "stylesheet",
            stylesheet: {
                rules: this.parseRules(stylesheet.rules)
            }
        };
    };
    CSSNativeScript.prototype.parseRules = function (rules) {
        var _this = this;
        return rules.map(function (rule) { return _this.parseRule(rule); });
    };
    CSSNativeScript.prototype.parseRule = function (rule) {
        if (rule.type === "at-rule") {
            return this.parseAtRule(rule);
        }
        else if (rule.type === "qualified-rule") {
            return this.parseQualifiedRule(rule);
        }
    };
    CSSNativeScript.prototype.parseAtRule = function (rule) {
        if (rule.name === "import") {
            return {
                import: rule.prelude.map(function (m) { return typeof m === "string" ? m : m.text; }).join("").trim(),
                type: "import"
            };
        }
        return;
    };
    CSSNativeScript.prototype.parseQualifiedRule = function (rule) {
        return {
            type: "rule",
            selectors: this.preludeToSelectorsStringArray(rule.prelude),
            declarations: this.ruleBlockToDeclarations(rule.block.values)
        };
    };
    CSSNativeScript.prototype.ruleBlockToDeclarations = function (declarationsInputTokens) {
        var declarations = [];
        var property = "";
        var value = "";
        var reading = "property";
        for (var i = 0; i < declarationsInputTokens.length; i++) {
            var inputToken = declarationsInputTokens[i];
            if (reading === "property") {
                if (inputToken === ":") {
                    reading = "value";
                }
                else if (typeof inputToken === "string") {
                    property += inputToken;
                }
                else {
                    property += inputToken.text;
                }
            }
            else {
                if (inputToken === ";") {
                    property = property.trim();
                    value = value.trim();
                    declarations.push({ type: "declaration", property: property, value: value });
                    property = "";
                    value = "";
                    reading = "property";
                }
                else if (typeof inputToken === "string") {
                    value += inputToken;
                }
                else {
                    value += inputToken.text;
                }
            }
        }
        property = property.trim();
        value = value.trim();
        if (property || value) {
            declarations.push({ type: "declaration", property: property, value: value });
        }
        return declarations;
    };
    CSSNativeScript.prototype.preludeToSelectorsStringArray = function (prelude) {
        var selectors = [];
        var selector = "";
        prelude.forEach(function (inputToken) {
            if (typeof inputToken === "string") {
                if (inputToken === ",") {
                    if (selector) {
                        selectors.push(selector.trim());
                    }
                    selector = "";
                }
                else {
                    selector += inputToken;
                }
            }
            else if (typeof inputToken === "object") {
                selector += inputToken.text;
            }
        });
        if (selector) {
            selectors.push(selector.trim());
        }
        return selectors;
    };
    return CSSNativeScript;
}());
exports.CSSNativeScript = CSSNativeScript;
//# sourceMappingURL=parser.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/css/system-classes.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var MODAL = "modal";
var ROOT = "root";
exports.CLASS_PREFIX = "ns-";
var modalRootViewCssClass = "" + exports.CLASS_PREFIX + MODAL;
var rootViewCssClasses = ["" + exports.CLASS_PREFIX + ROOT];
function getModalRootViewCssClass() {
    return modalRootViewCssClass;
}
exports.getModalRootViewCssClass = getModalRootViewCssClass;
function getRootViewCssClasses() {
    return rootViewCssClasses;
}
exports.getRootViewCssClasses = getRootViewCssClasses;
function pushToRootViewCssClasses(value) {
    rootViewCssClasses.push(value);
    return rootViewCssClasses.length;
}
exports.pushToRootViewCssClasses = pushToRootViewCssClasses;
function removeFromRootViewCssClasses(value) {
    var index = rootViewCssClasses.indexOf(value);
    var removedElement;
    if (index > -1) {
        removedElement = rootViewCssClasses.splice(index, 1);
    }
    return removedElement;
}
exports.removeFromRootViewCssClasses = removeFromRootViewCssClasses;
//# sourceMappingURL=system-classes.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/data/observable-array/observable-array.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var ChangeType = (function () {
    function ChangeType() {
    }
    ChangeType.Add = "add";
    ChangeType.Delete = "delete";
    ChangeType.Update = "update";
    ChangeType.Splice = "splice";
    return ChangeType;
}());
exports.ChangeType = ChangeType;
var CHANGE = "change";
var ObservableArray = (function (_super) {
    __extends(ObservableArray, _super);
    function ObservableArray() {
        var _this = _super.call(this) || this;
        if (arguments.length === 1 && Array.isArray(arguments[0])) {
            _this._array = arguments[0].slice();
        }
        else {
            _this._array = Array.apply(null, arguments);
        }
        _this._addArgs = {
            eventName: CHANGE, object: _this,
            action: ChangeType.Add,
            index: null,
            removed: new Array(),
            addedCount: 1
        };
        _this._deleteArgs = {
            eventName: CHANGE, object: _this,
            action: ChangeType.Delete,
            index: null,
            removed: null,
            addedCount: 0
        };
        return _this;
    }
    ObservableArray.prototype.getItem = function (index) {
        return this._array[index];
    };
    ObservableArray.prototype.setItem = function (index, value) {
        var oldValue = this._array[index];
        this._array[index] = value;
        this.notify({
            eventName: CHANGE, object: this,
            action: ChangeType.Update,
            index: index,
            removed: [oldValue],
            addedCount: 1
        });
    };
    Object.defineProperty(ObservableArray.prototype, "length", {
        get: function () {
            return this._array.length;
        },
        set: function (value) {
            if (types.isNumber(value) && this._array && this._array.length !== value) {
                this.splice(value, this._array.length - value);
            }
        },
        enumerable: true,
        configurable: true
    });
    ObservableArray.prototype.toString = function () {
        return this._array.toString();
    };
    ObservableArray.prototype.toLocaleString = function () {
        return this._array.toLocaleString();
    };
    ObservableArray.prototype.concat = function () {
        this._addArgs.index = this._array.length;
        var result = this._array.concat.apply(this._array, arguments);
        return result;
    };
    ObservableArray.prototype.join = function (separator) {
        return this._array.join(separator);
    };
    ObservableArray.prototype.pop = function () {
        this._deleteArgs.index = this._array.length - 1;
        var result = this._array.pop();
        this._deleteArgs.removed = [result];
        this.notify(this._deleteArgs);
        this._notifyLengthChange();
        return result;
    };
    ObservableArray.prototype.push = function () {
        this._addArgs.index = this._array.length;
        if (arguments.length === 1 && Array.isArray(arguments[0])) {
            var source = arguments[0];
            for (var i = 0, l = source.length; i < l; i++) {
                this._array.push(source[i]);
            }
        }
        else {
            this._array.push.apply(this._array, arguments);
        }
        this._addArgs.addedCount = this._array.length - this._addArgs.index;
        this.notify(this._addArgs);
        this._notifyLengthChange();
        return this._array.length;
    };
    ObservableArray.prototype._notifyLengthChange = function () {
        var lengthChangedData = this._createPropertyChangeData("length", this._array.length);
        this.notify(lengthChangedData);
    };
    ObservableArray.prototype.reverse = function () {
        return this._array.reverse();
    };
    ObservableArray.prototype.shift = function () {
        var result = this._array.shift();
        this._deleteArgs.index = 0;
        this._deleteArgs.removed = [result];
        this.notify(this._deleteArgs);
        this._notifyLengthChange();
        return result;
    };
    ObservableArray.prototype.slice = function (start, end) {
        return this._array.slice(start, end);
    };
    ObservableArray.prototype.sort = function (compareFn) {
        return this._array.sort(compareFn);
    };
    ObservableArray.prototype.splice = function (start, deleteCount) {
        var length = this._array.length;
        var result = this._array.splice.apply(this._array, arguments);
        this.notify({
            eventName: CHANGE, object: this,
            action: ChangeType.Splice,
            index: start,
            removed: result,
            addedCount: this._array.length + result.length - length
        });
        if (this._array.length !== length) {
            this._notifyLengthChange();
        }
        return result;
    };
    ObservableArray.prototype.unshift = function () {
        var length = this._array.length;
        var result = this._array.unshift.apply(this._array, arguments);
        this._addArgs.index = 0;
        this._addArgs.addedCount = result - length;
        this.notify(this._addArgs);
        this._notifyLengthChange();
        return result;
    };
    ObservableArray.prototype.indexOf = function (searchElement, fromIndex) {
        var index = fromIndex ? fromIndex : 0;
        for (var i = index, l = this._array.length; i < l; i++) {
            if (this._array[i] === searchElement) {
                return i;
            }
        }
        return -1;
    };
    ObservableArray.prototype.lastIndexOf = function (searchElement, fromIndex) {
        var index = fromIndex ? fromIndex : this._array.length - 1;
        for (var i = index; i >= 0; i--) {
            if (this._array[i] === searchElement) {
                return i;
            }
        }
        return -1;
    };
    ObservableArray.prototype.every = function (callbackfn, thisArg) {
        return this._array.every(callbackfn, thisArg);
    };
    ObservableArray.prototype.some = function (callbackfn, thisArg) {
        return this._array.some(callbackfn, thisArg);
    };
    ObservableArray.prototype.forEach = function (callbackfn, thisArg) {
        this._array.forEach(callbackfn, thisArg);
    };
    ObservableArray.prototype.map = function (callbackfn, thisArg) {
        return this._array.map(callbackfn, thisArg);
    };
    ObservableArray.prototype.filter = function (callbackfn, thisArg) {
        return this._array.filter(callbackfn, thisArg);
    };
    ObservableArray.prototype.reduce = function (callbackfn, initialValue) {
        return initialValue !== undefined ? this._array.reduce(callbackfn, initialValue) : this._array.reduce(callbackfn);
    };
    ObservableArray.prototype.reduceRight = function (callbackfn, initialValue) {
        return initialValue !== undefined ? this._array.reduceRight(callbackfn, initialValue) : this._array.reduceRight(callbackfn);
    };
    ObservableArray.changeEvent = CHANGE;
    return ObservableArray;
}(observable.Observable));
exports.ObservableArray = ObservableArray;
//# sourceMappingURL=observable-array.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/data/observable/observable.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var _wrappedIndex = 0;
var WrappedValue = (function () {
    function WrappedValue(wrapped) {
        this.wrapped = wrapped;
    }
    WrappedValue.unwrap = function (value) {
        return (value instanceof WrappedValue) ? value.wrapped : value;
    };
    WrappedValue.wrap = function (value) {
        var w = _wrappedValues[_wrappedIndex++ % 5];
        w.wrapped = value;
        return w;
    };
    return WrappedValue;
}());
exports.WrappedValue = WrappedValue;
var _wrappedValues = [
    new WrappedValue(null),
    new WrappedValue(null),
    new WrappedValue(null),
    new WrappedValue(null),
    new WrappedValue(null)
];
var Observable = (function () {
    function Observable() {
        this._observers = {};
    }
    Observable.prototype.get = function (name) {
        return this[name];
    };
    Observable.prototype.set = function (name, value) {
        var oldValue = this[name];
        if (this[name] === value) {
            return;
        }
        var newValue = WrappedValue.unwrap(value);
        this[name] = newValue;
        this.notifyPropertyChange(name, newValue, oldValue);
    };
    Observable.prototype.on = function (eventNames, callback, thisArg) {
        this.addEventListener(eventNames, callback, thisArg);
    };
    Observable.prototype.once = function (event, callback, thisArg) {
        var list = this._getEventList(event, true);
        list.push({ callback: callback, thisArg: thisArg, once: true });
    };
    Observable.prototype.off = function (eventNames, callback, thisArg) {
        this.removeEventListener(eventNames, callback, thisArg);
    };
    Observable.prototype.addEventListener = function (eventNames, callback, thisArg) {
        if (typeof eventNames !== "string") {
            throw new TypeError("Events name(s) must be string.");
        }
        if (typeof callback !== "function") {
            throw new TypeError("callback must be function.");
        }
        var events = eventNames.split(",");
        for (var i = 0, l = events.length; i < l; i++) {
            var event_1 = events[i].trim();
            var list = this._getEventList(event_1, true);
            list.push({
                callback: callback,
                thisArg: thisArg
            });
        }
    };
    Observable.prototype.removeEventListener = function (eventNames, callback, thisArg) {
        if (typeof eventNames !== "string") {
            throw new TypeError("Events name(s) must be string.");
        }
        if (callback && typeof callback !== "function") {
            throw new TypeError("callback must be function.");
        }
        var events = eventNames.split(",");
        for (var i = 0, l = events.length; i < l; i++) {
            var event_2 = events[i].trim();
            if (callback) {
                var list = this._getEventList(event_2, false);
                if (list) {
                    var index_1 = this._indexOfListener(list, callback, thisArg);
                    if (index_1 >= 0) {
                        list.splice(index_1, 1);
                    }
                    if (list.length === 0) {
                        delete this._observers[event_2];
                    }
                }
            }
            else {
                this._observers[event_2] = undefined;
                delete this._observers[event_2];
            }
        }
    };
    Observable.prototype.notify = function (data) {
        var observers = this._observers[data.eventName];
        if (!observers) {
            return;
        }
        for (var i = observers.length - 1; i >= 0; i--) {
            var entry = observers[i];
            if (entry.once) {
                observers.splice(i, 1);
            }
            if (entry.thisArg) {
                entry.callback.apply(entry.thisArg, [data]);
            }
            else {
                entry.callback(data);
            }
        }
    };
    Observable.prototype.notifyPropertyChange = function (name, value, oldValue) {
        this.notify(this._createPropertyChangeData(name, value, oldValue));
    };
    Observable.prototype.hasListeners = function (eventName) {
        return eventName in this._observers;
    };
    Observable.prototype._createPropertyChangeData = function (propertyName, value, oldValue) {
        return { eventName: Observable.propertyChangeEvent, object: this, propertyName: propertyName, value: value, oldValue: oldValue };
    };
    Observable.prototype._emit = function (eventNames) {
        var events = eventNames.split(",");
        for (var i = 0, l = events.length; i < l; i++) {
            var event_3 = events[i].trim();
            this.notify({ eventName: event_3, object: this });
        }
    };
    Observable.prototype._getEventList = function (eventName, createIfNeeded) {
        if (!eventName) {
            throw new TypeError("EventName must be valid string.");
        }
        var list = this._observers[eventName];
        if (!list && createIfNeeded) {
            list = [];
            this._observers[eventName] = list;
        }
        return list;
    };
    Observable.prototype._indexOfListener = function (list, callback, thisArg) {
        for (var i = 0; i < list.length; i++) {
            var entry = list[i];
            if (thisArg) {
                if (entry.callback === callback && entry.thisArg === thisArg) {
                    return i;
                }
            }
            else {
                if (entry.callback === callback) {
                    return i;
                }
            }
        }
        return -1;
    };
    Observable.propertyChangeEvent = "propertyChange";
    return Observable;
}());
exports.Observable = Observable;
var ObservableFromObject = (function (_super) {
    __extends(ObservableFromObject, _super);
    function ObservableFromObject() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._map = {};
        return _this;
    }
    ObservableFromObject.prototype.get = function (name) {
        return this._map[name];
    };
    ObservableFromObject.prototype.set = function (name, value) {
        var currentValue = this._map[name];
        if (currentValue === value) {
            return;
        }
        var newValue = WrappedValue.unwrap(value);
        this._map[name] = newValue;
        this.notifyPropertyChange(name, newValue, currentValue);
    };
    return ObservableFromObject;
}(Observable));
function defineNewProperty(target, propertyName) {
    Object.defineProperty(target, propertyName, {
        get: function () {
            return target._map[propertyName];
        },
        set: function (value) {
            target.set(propertyName, value);
        },
        enumerable: true,
        configurable: true
    });
}
function addPropertiesFromObject(observable, source, recursive) {
    if (recursive === void 0) { recursive = false; }
    Object.keys(source).forEach(function (prop) {
        var value = source[prop];
        if (recursive
            && !Array.isArray(value)
            && value
            && typeof value === "object"
            && !(value instanceof Observable)) {
            value = fromObjectRecursive(value);
        }
        defineNewProperty(observable, prop);
        observable.set(prop, value);
    });
}
function fromObject(source) {
    var observable = new ObservableFromObject();
    addPropertiesFromObject(observable, source, false);
    return observable;
}
exports.fromObject = fromObject;
function fromObjectRecursive(source) {
    var observable = new ObservableFromObject();
    addPropertiesFromObject(observable, source, true);
    return observable;
}
exports.fromObjectRecursive = fromObjectRecursive;
//# sourceMappingURL=observable.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/debugger.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var network;
function getNetwork() {
    return network;
}
exports.getNetwork = getNetwork;
function setNetwork(newNetwork) {
    network = newNetwork;
}
exports.setNetwork = setNetwork;
var dom;
function getDOM() {
    return dom;
}
exports.getDOM = getDOM;
function setDOM(newDOM) {
    dom = newDOM;
}
exports.setDOM = setDOM;
var css;
function getCSS() {
    return css;
}
exports.getCSS = getCSS;
function setCSS(newCSS) {
    css = newCSS;
}
exports.setCSS = setCSS;
var NetworkAgent;
(function (NetworkAgent) {
    function responseReceived(requestId, result, headers) {
        var requestIdStr = requestId.toString();
        var mimeType = headers["Content-Type"] || headers["content-type"] || "application/octet-stream";
        var contentLengthHeader = headers["Content-Length"] || headers["content-length"];
        var contentLength = parseInt(contentLengthHeader, 10);
        if (isNaN(contentLength)) {
            contentLength = 0;
        }
        var response = {
            url: result.url || "",
            status: result.statusCode,
            statusText: result.statusText || "",
            headers: headers,
            mimeType: mimeType,
            fromDiskCache: false,
            connectionReused: true,
            connectionId: 0,
            encodedDataLength: contentLength,
            securityState: "info"
        };
        var responseData = {
            requestId: requestIdStr,
            type: mimeTypeToType(response.mimeType),
            response: response,
            timestamp: getTimeStamp()
        };
        global.__inspector.responseReceived(responseData);
        global.__inspector.loadingFinished({
            requestId: requestIdStr,
            timestamp: getTimeStamp(),
            encodedDataLength: contentLength
        });
        var hasTextContent = responseData.type === "Document" || responseData.type === "Script";
        var data;
        if (!hasTextContent) {
            if (responseData.type === "Image") {
                var bitmap = result.responseAsImage;
                if (bitmap) {
                    var outputStream = new java.io.ByteArrayOutputStream();
                    bitmap.compress(android.graphics.Bitmap.CompressFormat.PNG, 100, outputStream);
                    var base64Image = android.util.Base64.encodeToString(outputStream.toByteArray(), android.util.Base64.DEFAULT);
                    data = base64Image;
                }
            }
        }
        else {
            data = result.responseAsString;
        }
        var successfulRequestData = {
            requestId: requestIdStr,
            data: data,
            hasTextContent: hasTextContent
        };
        global.__inspector.dataForRequestId(successfulRequestData);
    }
    NetworkAgent.responseReceived = responseReceived;
    function requestWillBeSent(requestId, options) {
        var request = {
            url: options.url,
            method: options.method,
            headers: options.headers || {},
            postData: options.content ? options.content.toString() : "",
            initialPriority: "Medium",
            referrerPolicy: "no-referrer-when-downgrade"
        };
        var requestData = {
            requestId: requestId.toString(),
            url: request.url,
            request: request,
            timestamp: getTimeStamp(),
            type: "Document",
            wallTime: 0
        };
        global.__inspector.requestWillBeSent(requestData);
    }
    NetworkAgent.requestWillBeSent = requestWillBeSent;
    function getTimeStamp() {
        var d = new Date();
        return Math.round(d.getTime() / 1000);
    }
    function mimeTypeToType(mimeType) {
        var type = "Document";
        if (mimeType) {
            if (mimeType.indexOf("image") === 0) {
                type = "Image";
            }
            else if (mimeType.indexOf("javascript") !== -1 || mimeType.indexOf("json") !== -1) {
                type = "Script";
            }
        }
        return type;
    }
})(NetworkAgent = exports.NetworkAgent || (exports.NetworkAgent = {}));
//# sourceMappingURL=debugger.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/devtools-elements.common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var dom_node_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/dom-node.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var frameTopmost = function () { return __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js").topmost(); };
var unsetValue;
function unsetViewValue(view, name) {
    if (!unsetValue) {
        unsetValue = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js").unsetValue;
    }
    view[name] = unsetValue;
}
function getViewById(nodeId) {
    var node = dom_node_1.getNodeById(nodeId);
    var view;
    if (node) {
        view = node.viewRef.get();
    }
    return view;
}
function getDocument() {
    var topMostFrame = frameTopmost();
    if (!topMostFrame) {
        return undefined;
    }
    try {
        topMostFrame.ensureDomNode();
    }
    catch (e) {
        console.log("ERROR in getDocument(): " + e);
    }
    return topMostFrame.domNode.toObject();
}
exports.getDocument = getDocument;
function getComputedStylesForNode(nodeId) {
    var view = getViewById(nodeId);
    if (view) {
        return view.domNode.getComputedProperties();
    }
    return [];
}
exports.getComputedStylesForNode = getComputedStylesForNode;
exports.removeNode = utils_1.mainThreadify(function removeNode(nodeId) {
    var view = getViewById(nodeId);
    if (view) {
        var parent_1 = view.parent;
        if (parent_1.removeChild) {
            parent_1.removeChild(view);
        }
        else if (parent_1.content === view) {
            parent_1.content = null;
        }
        else {
            console.log("Can't remove child from " + parent_1);
        }
    }
});
exports.setAttributeAsText = utils_1.mainThreadify(function setAttributeAsText(nodeId, text, name) {
    var view = getViewById(nodeId);
    if (view) {
        var hasOriginalAttribute = !!name.trim();
        if (text) {
            var textParts = text.split("=");
            if (textParts.length === 2) {
                var attrName = textParts[0];
                var attrValue = textParts[1].replace(/['"]+/g, "");
                if (name !== attrName && hasOriginalAttribute) {
                    unsetViewValue(view, name);
                    view[attrName] = attrValue;
                }
                else {
                    view[hasOriginalAttribute ? name : attrName] = attrValue;
                }
            }
        }
        else {
            unsetViewValue(view, name);
        }
        view.domNode.loadAttributes();
    }
});
//# sourceMappingURL=devtools-elements.common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/devtools-elements.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var devtools_elements_common_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/devtools-elements.common.js");
var dom_node_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/dom-node.js");
function attachDOMInspectorEventCallbacks(DOMDomainFrontend) {
    dom_node_1.registerInspectorEvents(DOMDomainFrontend);
    var originalChildNodeInserted = DOMDomainFrontend.childNodeInserted;
    DOMDomainFrontend.childNodeInserted = function (parentId, lastId, node) {
        originalChildNodeInserted(parentId, lastId, JSON.stringify(node.toObject()));
    };
}
exports.attachDOMInspectorEventCallbacks = attachDOMInspectorEventCallbacks;
function attachDOMInspectorCommandCallbacks(DOMDomainBackend) {
    DOMDomainBackend.getDocument = function () {
        return JSON.stringify(devtools_elements_common_1.getDocument());
    };
    DOMDomainBackend.getComputedStylesForNode = function (nodeId) {
        return JSON.stringify(devtools_elements_common_1.getComputedStylesForNode(nodeId));
    };
    DOMDomainBackend.removeNode = devtools_elements_common_1.removeNode;
    DOMDomainBackend.setAttributeAsText = devtools_elements_common_1.setAttributeAsText;
}
exports.attachDOMInspectorCommandCallbacks = attachDOMInspectorCommandCallbacks;
function attachCSSInspectorCommandCallbacks(CSSDomainFrontend) {
}
exports.attachCSSInspectorCommandCallbacks = attachCSSInspectorCommandCallbacks;
//# sourceMappingURL=devtools-elements.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/dom-node.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var registeredDomNodes = {};
var ELEMENT_NODE_TYPE = 1;
var ROOT_NODE_TYPE = 9;
var propertyBlacklist = [
    "effectivePaddingLeft",
    "effectivePaddingBottom",
    "effectivePaddingRight",
    "effectivePaddingTop",
    "effectiveBorderTopWidth",
    "effectiveBorderRightWidth",
    "effectiveBorderBottomWidth",
    "effectiveBorderLeftWidth",
    "effectiveMinWidth",
    "effectiveMinHeight",
    "effectiveWidth",
    "effectiveHeight",
    "effectiveMarginLeft",
    "effectiveMarginTop",
    "effectiveMarginRight",
    "effectiveMarginBottom",
    "nodeName",
    "nodeType",
    "decodeWidth",
    "decodeHeight",
    "ng-reflect-items",
    "domNode",
    "touchListenerIsSet",
    "bindingContext",
    "nativeView"
];
function lazy(action) {
    var _value;
    return function () { return _value || (_value = action()); };
}
var percentLengthToStringLazy = lazy(function () { return __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js").PercentLength.convertToString; });
var getSetPropertiesLazy = lazy(function () { return __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js").getSetProperties; });
var getComputedCssValuesLazy = lazy(function () { return __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js").getComputedCssValues; });
function registerInspectorEvents(inspector) {
    inspectorFrontendInstance = inspector;
}
exports.registerInspectorEvents = registerInspectorEvents;
var inspectorFrontendInstance;
function notifyInspector(callback) {
    if (inspectorFrontendInstance) {
        callback(inspectorFrontendInstance);
    }
}
function valueToString(value) {
    if (typeof value === "undefined" || value === null) {
        return "";
    }
    else if (typeof value === "object" && value.unit) {
        return percentLengthToStringLazy()(value);
    }
    else {
        return value + "";
    }
}
function propertyFilter(_a) {
    var name = _a[0], value = _a[1];
    if (name[0] === "_") {
        return false;
    }
    if (value !== null && typeof value === "object") {
        return false;
    }
    if (propertyBlacklist.indexOf(name) >= 0) {
        return false;
    }
    return true;
}
function registerNode(domNode) {
    registeredDomNodes[domNode.nodeId] = domNode;
}
function unregisterNode(domNode) {
    delete registeredDomNodes[domNode.nodeId];
}
function getNodeById(id) {
    return registeredDomNodes[id];
}
exports.getNodeById = getNodeById;
var DOMNode = (function () {
    function DOMNode(view) {
        this.nodeValue = "";
        this.attributes = [];
        this.viewRef = new WeakRef(view);
        this.nodeType = view.typeName === "Frame" ? ROOT_NODE_TYPE : ELEMENT_NODE_TYPE;
        this.nodeId = view._domId;
        this.nodeName = view.typeName;
        this.localName = this.nodeName;
        this.loadAttributes();
        registerNode(this);
    }
    DOMNode.prototype.loadAttributes = function () {
        var _this = this;
        this.attributes = [];
        getSetPropertiesLazy()(this.viewRef.get())
            .filter(propertyFilter)
            .forEach(function (pair) { return _this.attributes.push(pair[0], pair[1] + ""); });
    };
    Object.defineProperty(DOMNode.prototype, "children", {
        get: function () {
            var view = this.viewRef.get();
            if (!view) {
                return [];
            }
            var res = [];
            view.eachChild(function (child) {
                child.ensureDomNode();
                res.push(child.domNode);
                return true;
            });
            return res;
        },
        enumerable: true,
        configurable: true
    });
    DOMNode.prototype.onChildAdded = function (childView) {
        var _this = this;
        notifyInspector(function (ins) {
            var view = _this.viewRef.get();
            var previousChild;
            view.eachChild(function (child) {
                if (child === childView) {
                    return false;
                }
                previousChild = child;
                return true;
            });
            var index = !!previousChild ? previousChild._domId : 0;
            childView.ensureDomNode();
            ins.childNodeInserted(_this.nodeId, index, childView.domNode);
        });
    };
    DOMNode.prototype.onChildRemoved = function (view) {
        var _this = this;
        notifyInspector(function (ins) {
            ins.childNodeRemoved(_this.nodeId, view._domId);
        });
    };
    DOMNode.prototype.attributeModified = function (name, value) {
        var _this = this;
        notifyInspector(function (ins) {
            if (propertyBlacklist.indexOf(name) < 0) {
                ins.attributeModified(_this.nodeId, name, valueToString(value));
            }
        });
    };
    DOMNode.prototype.attributeRemoved = function (name) {
        var _this = this;
        notifyInspector(function (ins) {
            ins.attributeRemoved(_this.nodeId, name);
        });
    };
    DOMNode.prototype.getComputedProperties = function () {
        var view = this.viewRef.get();
        if (!view) {
            return [];
        }
        var result = getComputedCssValuesLazy()(view)
            .filter(function (pair) { return pair[0][0] !== "_"; })
            .map(function (pair) {
            return {
                name: pair[0],
                value: valueToString(pair[1])
            };
        });
        return result;
    };
    DOMNode.prototype.dispose = function () {
        unregisterNode(this);
        this.viewRef.clear();
    };
    DOMNode.prototype.toObject = function () {
        return {
            nodeId: this.nodeId,
            nodeType: this.nodeType,
            nodeName: this.nodeName,
            localName: this.localName,
            nodeValue: this.nodeValue,
            children: this.children.map(function (c) { return c.toObject(); }),
            attributes: this.attributes,
            backendNodeId: 0
        };
    };
    return DOMNode;
}());
exports.DOMNode = DOMNode;
//# sourceMappingURL=dom-node.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/fetch/fetch.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {(function () {
    'use strict';

    exports.XMLHttpRequest = global.XMLHttpRequest;
    exports.FormData = global.FormData;

    if (!exports.XMLHttpRequest) {
        var xhr = __webpack_require__("../node_modules/xhr/index.js");
        exports.XMLHttpRequest = xhr.XMLHttpRequest;
        exports.FormData = xhr.FormData;
    }

    function normalizeName(name) {
        if (typeof name !== 'string') {
            name = name.toString();
        }
        if (/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(name)) {
            throw new TypeError('Invalid character in header field name')
        }
        return name.toLowerCase()
    }

    function normalizeValue(value) {
        if (typeof value !== 'string') {
            value = value.toString();
        }
        return value
    }

    function Headers(headers) {
        this.map = {}

        if (headers instanceof Headers) {
            headers.forEach(function (value, name) {
                this.append(name, value)
            }, this)

        } else if (headers) {
            Object.getOwnPropertyNames(headers).forEach(function (name) {
                this.append(name, headers[name])
            }, this)
        }
    }

    Headers.prototype.append = function (name, value) {
        name = normalizeName(name)
        value = normalizeValue(value)
        var list = this.map[name]
        if (!list) {
            list = []
            this.map[name] = list
        }
        list.push(value)
    }

    Headers.prototype['delete'] = function (name) {
        delete this.map[normalizeName(name)]
    }

    Headers.prototype.get = function (name) {
        var values = this.map[normalizeName(name)]
        return values ? values[0] : null
    }

    Headers.prototype.getAll = function (name) {
        return this.map[normalizeName(name)] || []
    }

    Headers.prototype.has = function (name) {
        return this.map.hasOwnProperty(normalizeName(name))
    }

    Headers.prototype.set = function (name, value) {
        this.map[normalizeName(name)] = [normalizeValue(value)]
    }

    Headers.prototype.forEach = function (callback, thisArg) {
        Object.getOwnPropertyNames(this.map).forEach(function (name) {
            this.map[name].forEach(function (value) {
                callback.call(thisArg, value, name, this)
            }, this)
        }, this)
    }

    function consumed(body) {
        if (body.bodyUsed) {
            return Promise.reject(new TypeError('Already read'))
        }
        body.bodyUsed = true
    }

    function fileReaderReady(reader) {
        return new Promise(function (resolve, reject) {
            reader.onload = function () {
                resolve(reader.result)
            }
            reader.onerror = function () {
                reject(reader.error)
            }
        })
    }

    function readBlobAsArrayBuffer(blob) {
        var reader = new FileReader()
        reader.readAsArrayBuffer(blob)
        return fileReaderReady(reader)
    }

    function readBlobAsText(blob) {
        var reader = new FileReader()
        reader.readAsText(blob)
        return fileReaderReady(reader)
    }

    var support = {
        blob: 'FileReader' in exports && 'Blob' in exports && (function () {
            try {
                new Blob();
                return true
            } catch (e) {
                return false
            }
        })(),
        formData: 'FormData' in exports
    }

    function Body() {
        this.bodyUsed = false


        this._initBody = function (body) {
            this._bodyInit = body
            if (typeof body === 'string') {
                this._bodyText = body
            } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {
                this._bodyBlob = body
            } else if (support.formData && exports.FormData.prototype.isPrototypeOf(body)) {
                this._bodyFormData = body
            } else if (!body) {
                this._bodyText = ''
            } else {
                throw new Error('unsupported BodyInit type')
            }
        }

        if (support.blob) {
            this.blob = function () {
                var rejected = consumed(this)
                if (rejected) {
                    return rejected
                }

                if (this._bodyBlob) {
                    return Promise.resolve(this._bodyBlob)
                } else if (this._bodyFormData) {
                    throw new Error('could not read FormData body as blob')
                } else {
                    return Promise.resolve(new Blob([this._bodyText]))
                }
            }

            this.arrayBuffer = function () {
                return this.blob().then(readBlobAsArrayBuffer)
            }

            this.text = function () {
                var rejected = consumed(this)
                if (rejected) {
                    return rejected
                }

                if (this._bodyBlob) {
                    return readBlobAsText(this._bodyBlob)
                } else if (this._bodyFormData) {
                    throw new Error('could not read FormData body as text')
                } else {
                    return Promise.resolve(this._bodyText)
                }
            }
        } else {
            this.text = function () {
                var rejected = consumed(this)
                return rejected ? rejected : Promise.resolve(this._bodyText)
            }
        }

        if (support.formData) {
            this.formData = function () {
                return this.text().then(decode)
            }
        }

        this.json = function () {
            return this.text().then(JSON.parse)
        }

        return this
    }

    // HTTP methods whose capitalization should be normalized
    var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']

    function normalizeMethod(method) {
        var upcased = method.toUpperCase()
        return (methods.indexOf(upcased) > -1) ? upcased : method
    }

    function Request(url, options) {
        options = options || {}
        this.url = url

        this.credentials = options.credentials || 'omit'
        this.headers = new Headers(options.headers)
        this.method = normalizeMethod(options.method || 'GET')
        this.mode = options.mode || null
        this.referrer = null

        if ((this.method === 'GET' || this.method === 'HEAD') && options.body) {
            throw new TypeError('Body not allowed for GET or HEAD requests')
        }
        this._initBody(options.body)
    }

    function decode(body) {
        var form = new exports.FormData()
        body.trim().split('&').forEach(function (bytes) {
            if (bytes) {
                var split = bytes.split('=')
                var name = split.shift().replace(/\+/g, ' ')
                var value = split.join('=').replace(/\+/g, ' ')
                form.append(decodeURIComponent(name), decodeURIComponent(value))
            }
        })
        return form
    }

    function headers(xhr) {
        var head = new Headers()
        var pairs = xhr.getAllResponseHeaders().trim().split('\n')
        pairs.forEach(function (header) {
            var split = header.trim().split(':')
            var key = split.shift().trim()
            var value = split.join(':').trim()
            head.append(key, value)
        })
        return head
    }

    Body.call(Request.prototype)

    function Response(bodyInit, options) {
        if (!options) {
            options = {}
        }

        this._initBody(bodyInit)
        this.type = 'default'
        this.url = null
        this.status = options.status
        this.ok = this.status >= 200 && this.status < 300
        this.statusText = options.statusText
        this.headers = options.headers instanceof Headers ? options.headers : new Headers(options.headers)
        this.url = options.url || ''
    }

    Body.call(Response.prototype)

    exports.Headers = Headers;
    exports.Request = Request;
    exports.Response = Response;

    exports.fetch = function (input, init) {
        // TODO: Request constructor should accept input, init
        var request
        if (Request.prototype.isPrototypeOf(input) && !init) {
            request = input
        } else {
            request = new Request(input, init)
        }

        return new Promise(function (resolve, reject) {
            var xhr = new exports.XMLHttpRequest()

            function responseURL() {
                if ('responseURL' in xhr) {
                    return xhr.responseURL
                }

                // Avoid security warnings on getResponseHeader when not allowed by CORS
                if (/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())) {
                    return xhr.getResponseHeader('X-Request-URL')
                }

                return;
            }

            xhr.onload = function () {
                var status = (xhr.status === 1223) ? 204 : xhr.status
                if (status < 100 || status > 599) {
                    reject(new TypeError('Network request failed'))
                    return
                }
                var options = {
                    status: status,
                    statusText: xhr.statusText,
                    headers: headers(xhr),
                    url: responseURL()
                }
                //var body = 'response' in xhr ? xhr.response : xhr.responseText;
                resolve(new Response(xhr.responseText, options))
            }

            xhr.onerror = function (error) {
                reject(new TypeError(['Network request failed:', error.message].join(' ')))
            }

            xhr.open(request.method, request.url, true)

            if (request.credentials === 'include') {
                xhr.withCredentials = true
            }

            if ('responseType' in xhr && support.blob) {
                xhr.responseType = 'blob'
            }

            request.headers.forEach(function (value, name) {
                xhr.setRequestHeader(name, value)
            })

            xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)
        })
    }
    exports.fetch.polyfill = true

})();
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/file-system/file-system-access.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var textModule = __webpack_require__("../node_modules/tns-core-modules/text/text.js");
var application_1 = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var applicationContext;
function getApplicationContext() {
    if (!applicationContext) {
        applicationContext = application_1.getNativeApplication().getApplicationContext();
    }
    return applicationContext;
}
var FileSystemAccess = (function () {
    function FileSystemAccess() {
        this._pathSeparator = "/";
    }
    FileSystemAccess.prototype.getLastModified = function (path) {
        var javaFile = new java.io.File(path);
        return new Date(javaFile.lastModified());
    };
    FileSystemAccess.prototype.getFileSize = function (path) {
        var javaFile = new java.io.File(path);
        return javaFile.length();
    };
    FileSystemAccess.prototype.getParent = function (path, onError) {
        try {
            var javaFile = new java.io.File(path);
            var parent_1 = javaFile.getParentFile();
            return { path: parent_1.getAbsolutePath(), name: parent_1.getName() };
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
            return undefined;
        }
    };
    FileSystemAccess.prototype.getFile = function (path, onError) {
        return this.ensureFile(new java.io.File(path), false, onError);
    };
    FileSystemAccess.prototype.getFolder = function (path, onError) {
        var javaFile = new java.io.File(path);
        var dirInfo = this.ensureFile(javaFile, true, onError);
        if (!dirInfo) {
            return undefined;
        }
        return { path: dirInfo.path, name: dirInfo.name };
    };
    FileSystemAccess.prototype.eachEntity = function (path, onEntity, onError) {
        if (!onEntity) {
            return;
        }
        this.enumEntities(path, onEntity, onError);
    };
    FileSystemAccess.prototype.getEntities = function (path, onError) {
        var fileInfos = new Array();
        var onEntity = function (entity) {
            fileInfos.push(entity);
            return true;
        };
        var errorOccurred;
        var localError = function (error) {
            if (onError) {
                onError(error);
            }
            errorOccurred = true;
        };
        this.enumEntities(path, onEntity, localError);
        if (!errorOccurred) {
            return fileInfos;
        }
        return null;
    };
    FileSystemAccess.prototype.fileExists = function (path) {
        var file = new java.io.File(path);
        return file.exists();
    };
    FileSystemAccess.prototype.folderExists = function (path) {
        var file = new java.io.File(path);
        return file.exists() && file.isDirectory();
    };
    FileSystemAccess.prototype.deleteFile = function (path, onError) {
        try {
            var javaFile = new java.io.File(path);
            if (!javaFile.isFile()) {
                if (onError) {
                    onError({ message: "The specified parameter is not a File entity." });
                }
                return;
            }
            if (!javaFile.delete()) {
                if (onError) {
                    onError({ message: "File deletion failed" });
                }
            }
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.deleteFolder = function (path, onError) {
        try {
            var javaFile = new java.io.File(path);
            if (!javaFile.getCanonicalFile().isDirectory()) {
                if (onError) {
                    onError({ message: "The specified parameter is not a Folder entity." });
                }
                return;
            }
            this.deleteFolderContent(javaFile);
            if (!javaFile.delete()) {
                if (onError) {
                    onError({ message: "Folder deletion failed." });
                }
            }
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.emptyFolder = function (path, onError) {
        try {
            var javaFile = new java.io.File(path);
            if (!javaFile.getCanonicalFile().isDirectory()) {
                if (onError) {
                    onError({ message: "The specified parameter is not a Folder entity." });
                }
                return;
            }
            this.deleteFolderContent(javaFile);
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.rename = function (path, newPath, onError) {
        var javaFile = new java.io.File(path);
        if (!javaFile.exists()) {
            if (onError) {
                onError(new Error("The file to rename does not exist"));
            }
            return;
        }
        var newFile = new java.io.File(newPath);
        if (newFile.exists()) {
            if (onError) {
                onError(new Error("A file with the same name already exists."));
            }
            return;
        }
        if (!javaFile.renameTo(newFile)) {
            if (onError) {
                onError(new Error("Failed to rename file '" + path + "' to '" + newPath + "'"));
            }
        }
    };
    FileSystemAccess.prototype.getDocumentsFolderPath = function () {
        var dir = getApplicationContext().getFilesDir();
        return dir.getAbsolutePath();
    };
    FileSystemAccess.prototype.getLogicalRootPath = function () {
        var dir = getApplicationContext().getFilesDir();
        return dir.getCanonicalPath();
    };
    FileSystemAccess.prototype.getTempFolderPath = function () {
        var dir = getApplicationContext().getCacheDir();
        return dir.getAbsolutePath();
    };
    FileSystemAccess.prototype.getCurrentAppPath = function () {
        return this.getLogicalRootPath() + "/app";
    };
    FileSystemAccess.prototype.read = function (path, onError) {
        try {
            var javaFile = new java.io.File(path);
            var stream = new java.io.FileInputStream(javaFile);
            var bytes = Array.create("byte", javaFile.length());
            var dataInputStream = new java.io.DataInputStream(stream);
            dataInputStream.readFully(bytes);
            return bytes;
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.write = function (path, bytes, onError) {
        try {
            var javaFile = new java.io.File(path);
            var stream = new java.io.FileOutputStream(javaFile);
            stream.write(bytes, 0, bytes.length);
            stream.close();
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.readText = function (path, onError, encoding) {
        try {
            var javaFile = new java.io.File(path);
            var stream = new java.io.FileInputStream(javaFile);
            var actualEncoding = encoding;
            if (!actualEncoding) {
                actualEncoding = textModule.encoding.UTF_8;
            }
            var reader = new java.io.InputStreamReader(stream, actualEncoding);
            var bufferedReader = new java.io.BufferedReader(reader);
            var line = undefined;
            var result = "";
            while (true) {
                line = bufferedReader.readLine();
                if (line === null) {
                    break;
                }
                if (result.length > 0) {
                    result += "\n";
                }
                result += line;
            }
            if (actualEncoding === textModule.encoding.UTF_8) {
                result = FileSystemAccess._removeUtf8Bom(result);
            }
            bufferedReader.close();
            return result;
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess._removeUtf8Bom = function (s) {
        if (s.charCodeAt(0) === 0xFEFF) {
            s = s.slice(1);
        }
        return s;
    };
    FileSystemAccess.prototype.writeText = function (path, content, onError, encoding) {
        try {
            var javaFile = new java.io.File(path);
            var stream = new java.io.FileOutputStream(javaFile);
            var actualEncoding = encoding;
            if (!actualEncoding) {
                actualEncoding = textModule.encoding.UTF_8;
            }
            var writer = new java.io.OutputStreamWriter(stream, actualEncoding);
            writer.write(content);
            writer.close();
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.deleteFolderContent = function (file) {
        var filesList = file.listFiles();
        if (filesList.length === 0) {
            return true;
        }
        var childFile;
        var success = false;
        for (var i = 0; i < filesList.length; i++) {
            childFile = filesList[i];
            if (childFile.getCanonicalFile().isDirectory()) {
                success = this.deleteFolderContent(childFile);
                if (!success) {
                    break;
                }
            }
            success = childFile.delete();
        }
        return success;
    };
    FileSystemAccess.prototype.ensureFile = function (javaFile, isFolder, onError) {
        try {
            if (!javaFile.exists()) {
                var created = void 0;
                if (isFolder) {
                    created = javaFile.mkdirs();
                }
                else {
                    javaFile.getParentFile().mkdirs();
                    created = javaFile.createNewFile();
                }
                if (!created) {
                    if (onError) {
                        onError("Failed to create new java File for path " + javaFile.getAbsolutePath());
                    }
                    return undefined;
                }
                else {
                    javaFile.setReadable(true);
                    javaFile.setWritable(true);
                }
            }
            var path = javaFile.getAbsolutePath();
            return { path: path, name: javaFile.getName(), extension: this.getFileExtension(path) };
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
            return undefined;
        }
    };
    FileSystemAccess.prototype.getFileExtension = function (path) {
        var dotIndex = path.lastIndexOf(".");
        if (dotIndex && dotIndex >= 0 && dotIndex < path.length) {
            return path.substring(dotIndex);
        }
        return "";
    };
    FileSystemAccess.prototype.enumEntities = function (path, callback, onError) {
        try {
            var javaFile = new java.io.File(path);
            if (!javaFile.getCanonicalFile().isDirectory()) {
                if (onError) {
                    onError("There is no folder existing at path " + path);
                }
                return;
            }
            var filesList = javaFile.listFiles();
            var length_1 = filesList.length;
            var info = void 0;
            var retVal = void 0;
            for (var i = 0; i < length_1; i++) {
                javaFile = filesList[i];
                info = {
                    path: javaFile.getAbsolutePath(),
                    name: javaFile.getName()
                };
                if (javaFile.isFile()) {
                    info.extension = this.getFileExtension(info.path);
                }
                retVal = callback(info);
                if (retVal === false) {
                    break;
                }
            }
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.getPathSeparator = function () {
        return this._pathSeparator;
    };
    FileSystemAccess.prototype.normalizePath = function (path) {
        var file = new java.io.File(path);
        return file.getAbsolutePath();
    };
    FileSystemAccess.prototype.joinPath = function (left, right) {
        var file1 = new java.io.File(left);
        var file2 = new java.io.File(file1, right);
        return file2.getPath();
    };
    FileSystemAccess.prototype.joinPaths = function (paths) {
        if (!paths || paths.length === 0) {
            return "";
        }
        if (paths.length === 1) {
            return paths[0];
        }
        var result = paths[0];
        for (var i = 1; i < paths.length; i++) {
            result = this.joinPath(result, paths[i]);
        }
        return result;
    };
    return FileSystemAccess;
}());
exports.FileSystemAccess = FileSystemAccess;
//# sourceMappingURL=file-system-access.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/file-system/file-system.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var file_system_access_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system-access.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var fileAccess;
function getFileAccess() {
    if (!fileAccess) {
        fileAccess = new file_system_access_1.FileSystemAccess();
    }
    return fileAccess;
}
var platform;
function ensurePlatform() {
    if (!platform) {
        platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
    }
}
function createFile(info) {
    var file = new File();
    file._path = info.path;
    file._name = info.name;
    file._extension = info.extension;
    return file;
}
function createFolder(info) {
    var documents = knownFolders.documents();
    if (info.path === documents.path) {
        return documents;
    }
    var temp = knownFolders.temp();
    if (info.path === temp.path) {
        return temp;
    }
    var folder = new Folder();
    folder._path = info.path;
    folder._name = info.name;
    return folder;
}
var FileSystemEntity = (function () {
    function FileSystemEntity() {
    }
    Object.defineProperty(FileSystemEntity.prototype, "parent", {
        get: function () {
            var onError = function (error) {
                throw error;
            };
            var folderInfo = getFileAccess().getParent(this.path, onError);
            if (!folderInfo) {
                return undefined;
            }
            return createFolder(folderInfo);
        },
        enumerable: true,
        configurable: true
    });
    FileSystemEntity.prototype.remove = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.removeSync(localError);
            if (!hasError) {
                resolve();
            }
        });
    };
    FileSystemEntity.prototype.removeSync = function (onError) {
        if (this._isKnown) {
            if (onError) {
                onError({ message: "Cannot delete known folder." });
            }
            return;
        }
        var fileAccess = getFileAccess();
        if (this instanceof File) {
            fileAccess.deleteFile(this.path, onError);
        }
        else if (this instanceof Folder) {
            fileAccess.deleteFolder(this.path, onError);
        }
    };
    FileSystemEntity.prototype.rename = function (newName) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.renameSync(newName, localError);
            if (!hasError) {
                resolve();
            }
        });
    };
    FileSystemEntity.prototype.renameSync = function (newName, onError) {
        if (this._isKnown) {
            if (onError) {
                onError(new Error("Cannot rename known folder."));
            }
            return;
        }
        var parentFolder = this.parent;
        if (!parentFolder) {
            if (onError) {
                onError(new Error("No parent folder."));
            }
            return;
        }
        var fileAccess = getFileAccess();
        var path = parentFolder.path;
        var newPath = fileAccess.joinPath(path, newName);
        var localError = function (error) {
            if (onError) {
                onError(error);
            }
            return null;
        };
        fileAccess.rename(this.path, newPath, localError);
        this._path = newPath;
        this._name = newName;
        if (this instanceof File) {
            this._extension = fileAccess.getFileExtension(newPath);
        }
    };
    Object.defineProperty(FileSystemEntity.prototype, "name", {
        get: function () {
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FileSystemEntity.prototype, "path", {
        get: function () {
            return this._path;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FileSystemEntity.prototype, "lastModified", {
        get: function () {
            var value = this._lastModified;
            if (!this._lastModified) {
                value = this._lastModified = getFileAccess().getLastModified(this.path);
            }
            return value;
        },
        enumerable: true,
        configurable: true
    });
    return FileSystemEntity;
}());
exports.FileSystemEntity = FileSystemEntity;
var File = (function (_super) {
    __extends(File, _super);
    function File() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    File.fromPath = function (path) {
        var onError = function (error) {
            throw error;
        };
        var fileInfo = getFileAccess().getFile(path, onError);
        if (!fileInfo) {
            return undefined;
        }
        return createFile(fileInfo);
    };
    File.exists = function (path) {
        return getFileAccess().fileExists(path);
    };
    Object.defineProperty(File.prototype, "extension", {
        get: function () {
            return this._extension;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(File.prototype, "isLocked", {
        get: function () {
            return !!this._locked;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(File.prototype, "size", {
        get: function () {
            return getFileAccess().getFileSize(this.path);
        },
        enumerable: true,
        configurable: true
    });
    File.prototype.readSync = function (onError) {
        this.checkAccess();
        this._locked = true;
        var that = this;
        var localError = function (error) {
            that._locked = false;
            if (onError) {
                onError(error);
            }
        };
        var content = getFileAccess().read(this.path, localError);
        this._locked = false;
        return content;
    };
    File.prototype.writeSync = function (content, onError) {
        this.checkAccess();
        try {
            this._locked = true;
            var that_1 = this;
            var localError = function (error) {
                that_1._locked = false;
                if (onError) {
                    onError(error);
                }
            };
            getFileAccess().write(this.path, content, localError);
        }
        finally {
            this._locked = false;
        }
    };
    File.prototype.readText = function (encoding) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            var content = _this.readTextSync(localError, encoding);
            if (!hasError) {
                resolve(content);
            }
        });
    };
    File.prototype.readTextSync = function (onError, encoding) {
        this.checkAccess();
        this._locked = true;
        var that = this;
        var localError = function (error) {
            that._locked = false;
            if (onError) {
                onError(error);
            }
        };
        var content = getFileAccess().readText(this.path, localError, encoding);
        this._locked = false;
        return content;
    };
    File.prototype.writeText = function (content, encoding) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.writeTextSync(content, localError, encoding);
            if (!hasError) {
                resolve();
            }
        });
    };
    File.prototype.writeTextSync = function (content, onError, encoding) {
        this.checkAccess();
        try {
            this._locked = true;
            var that_2 = this;
            var localError = function (error) {
                that_2._locked = false;
                if (onError) {
                    onError(error);
                }
            };
            getFileAccess().writeText(this.path, content, localError, encoding);
        }
        finally {
            this._locked = false;
        }
    };
    File.prototype.checkAccess = function () {
        if (this.isLocked) {
            throw new Error("Cannot access a locked file.");
        }
    };
    __decorate([
        profiling_1.profile
    ], File.prototype, "readTextSync", null);
    return File;
}(FileSystemEntity));
exports.File = File;
var Folder = (function (_super) {
    __extends(Folder, _super);
    function Folder() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Folder.fromPath = function (path) {
        var onError = function (error) {
            throw error;
        };
        var folderInfo = getFileAccess().getFolder(path, onError);
        if (!folderInfo) {
            return undefined;
        }
        return createFolder(folderInfo);
    };
    Folder.exists = function (path) {
        return getFileAccess().folderExists(path);
    };
    Folder.prototype.contains = function (name) {
        var fileAccess = getFileAccess();
        var path = fileAccess.joinPath(this.path, name);
        if (fileAccess.fileExists(path)) {
            return true;
        }
        return fileAccess.folderExists(path);
    };
    Folder.prototype.clear = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var onError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.clearSync(onError);
            if (!hasError) {
                resolve();
            }
        });
    };
    Folder.prototype.clearSync = function (onError) {
        getFileAccess().emptyFolder(this.path, onError);
    };
    Object.defineProperty(Folder.prototype, "isKnown", {
        get: function () {
            return this._isKnown;
        },
        enumerable: true,
        configurable: true
    });
    Folder.prototype.getFile = function (name) {
        var fileAccess = getFileAccess();
        var path = fileAccess.joinPath(this.path, name);
        var onError = function (error) {
            throw error;
        };
        var fileInfo = fileAccess.getFile(path, onError);
        if (!fileInfo) {
            return undefined;
        }
        return createFile(fileInfo);
    };
    Folder.prototype.getFolder = function (name) {
        var fileAccess = getFileAccess();
        var path = fileAccess.joinPath(this.path, name);
        var onError = function (error) {
            throw error;
        };
        var folderInfo = fileAccess.getFolder(path, onError);
        if (!folderInfo) {
            return undefined;
        }
        return createFolder(folderInfo);
    };
    Folder.prototype.getEntities = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            var entities = _this.getEntitiesSync(localError);
            if (!hasError) {
                resolve(entities);
            }
        });
    };
    Folder.prototype.getEntitiesSync = function (onError) {
        var fileInfos = getFileAccess().getEntities(this.path, onError);
        if (!fileInfos) {
            return null;
        }
        var entities = new Array();
        for (var i = 0; i < fileInfos.length; i++) {
            if (fileInfos[i].extension) {
                entities.push(createFile(fileInfos[i]));
            }
            else {
                entities.push(createFolder(fileInfos[i]));
            }
        }
        return entities;
    };
    Folder.prototype.eachEntity = function (onEntity) {
        if (!onEntity) {
            return;
        }
        var onSuccess = function (fileInfo) {
            var entity;
            if (fileInfo.extension) {
                entity = createFile(fileInfo);
            }
            else {
                entity = createFolder(fileInfo);
            }
            return onEntity(entity);
        };
        var onError = function (error) {
            throw error;
        };
        getFileAccess().eachEntity(this.path, onSuccess, onError);
    };
    return Folder;
}(FileSystemEntity));
exports.Folder = Folder;
var knownFolders;
(function (knownFolders) {
    var _documents;
    var _temp;
    var _app;
    function documents() {
        if (!_documents) {
            var path_1 = getFileAccess().getDocumentsFolderPath();
            _documents = new Folder();
            _documents._path = path_1;
            _documents._isKnown = true;
        }
        return _documents;
    }
    knownFolders.documents = documents;
    function temp() {
        if (!_temp) {
            var path_2 = getFileAccess().getTempFolderPath();
            _temp = new Folder();
            _temp._path = path_2;
            _temp._isKnown = true;
        }
        return _temp;
    }
    knownFolders.temp = temp;
    function currentApp() {
        if (!_app) {
            var path_3 = getFileAccess().getCurrentAppPath();
            _app = new Folder();
            _app._path = path_3;
            _app._isKnown = true;
        }
        return _app;
    }
    knownFolders.currentApp = currentApp;
    var ios;
    (function (ios) {
        function _checkPlatform(knownFolderName) {
            ensurePlatform();
            if (!platform.isIOS) {
                throw new Error("The \"" + knownFolderName + "\" known folder is available on iOS only!");
            }
        }
        var _library;
        function library() {
            _checkPlatform("library");
            if (!_library) {
                var existingFolderInfo = getExistingFolderInfo(5);
                if (existingFolderInfo) {
                    _library = existingFolderInfo.folder;
                    _library._path = existingFolderInfo.path;
                    _library._isKnown = true;
                }
            }
            return _library;
        }
        ios.library = library;
        var _developer;
        function developer() {
            _checkPlatform("developer");
            if (!_developer) {
                var existingFolderInfo = getExistingFolderInfo(6);
                if (existingFolderInfo) {
                    _developer = existingFolderInfo.folder;
                    _developer._path = existingFolderInfo.path;
                    _developer._isKnown = true;
                }
            }
            return _developer;
        }
        ios.developer = developer;
        var _desktop;
        function desktop() {
            _checkPlatform("desktop");
            if (!_desktop) {
                var existingFolderInfo = getExistingFolderInfo(12);
                if (existingFolderInfo) {
                    _desktop = existingFolderInfo.folder;
                    _desktop._path = existingFolderInfo.path;
                    _desktop._isKnown = true;
                }
            }
            return _desktop;
        }
        ios.desktop = desktop;
        var _downloads;
        function downloads() {
            _checkPlatform("downloads");
            if (!_downloads) {
                var existingFolderInfo = getExistingFolderInfo(15);
                if (existingFolderInfo) {
                    _downloads = existingFolderInfo.folder;
                    _downloads._path = existingFolderInfo.path;
                    _downloads._isKnown = true;
                }
            }
            return _downloads;
        }
        ios.downloads = downloads;
        var _movies;
        function movies() {
            _checkPlatform("movies");
            if (!_movies) {
                var existingFolderInfo = getExistingFolderInfo(17);
                if (existingFolderInfo) {
                    _movies = existingFolderInfo.folder;
                    _movies._path = existingFolderInfo.path;
                    _movies._isKnown = true;
                }
            }
            return _movies;
        }
        ios.movies = movies;
        var _music;
        function music() {
            _checkPlatform("music");
            if (!_music) {
                var existingFolderInfo = getExistingFolderInfo(18);
                if (existingFolderInfo) {
                    _music = existingFolderInfo.folder;
                    _music._path = existingFolderInfo.path;
                    _music._isKnown = true;
                }
            }
            return _music;
        }
        ios.music = music;
        var _pictures;
        function pictures() {
            _checkPlatform("pictures");
            if (!_pictures) {
                var existingFolderInfo = getExistingFolderInfo(19);
                if (existingFolderInfo) {
                    _pictures = existingFolderInfo.folder;
                    _pictures._path = existingFolderInfo.path;
                    _pictures._isKnown = true;
                }
            }
            return _pictures;
        }
        ios.pictures = pictures;
        var _sharedPublic;
        function sharedPublic() {
            _checkPlatform("sharedPublic");
            if (!_sharedPublic) {
                var existingFolderInfo = getExistingFolderInfo(21);
                if (existingFolderInfo) {
                    _sharedPublic = existingFolderInfo.folder;
                    _sharedPublic._path = existingFolderInfo.path;
                    _sharedPublic._isKnown = true;
                }
            }
            return _sharedPublic;
        }
        ios.sharedPublic = sharedPublic;
        function getExistingFolderInfo(pathDirectory) {
            var fileAccess = getFileAccess();
            var folderPath = fileAccess.getKnownPath(pathDirectory);
            var folderInfo = fileAccess.getExistingFolder(folderPath);
            if (folderInfo) {
                return {
                    folder: createFolder(folderInfo),
                    path: folderPath
                };
            }
            return undefined;
        }
    })(ios = knownFolders.ios || (knownFolders.ios = {}));
})(knownFolders = exports.knownFolders || (exports.knownFolders = {}));
var path;
(function (path_4) {
    function normalize(path) {
        return getFileAccess().normalizePath(path);
    }
    path_4.normalize = normalize;
    function join() {
        var paths = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            paths[_i] = arguments[_i];
        }
        var fileAccess = getFileAccess();
        return fileAccess.joinPaths(paths);
    }
    path_4.join = join;
    path_4.separator = getFileAccess().getPathSeparator();
})(path = exports.path || (exports.path = {}));
//# sourceMappingURL=file-system.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/core/globals-core.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/ts-helpers.js");
__webpack_require__("../node_modules/tns-core-modules/globals/register-module-helpers.js");
global.moduleMerge = function (sourceExports, destExports) {
    for (var key in sourceExports) {
        destExports[key] = sourceExports[key];
    }
};
global.zonedCallback = function (callback) {
    if (global.zone) {
        return global.zone.bind(callback);
    }
    if (global.Zone) {
        return global.Zone.current.wrap(callback);
    }
    else {
        return callback;
    }
};
global.System = {
    import: function (path) {
        return new Promise(function (resolve, reject) {
            try {
                resolve(global.require(path));
            }
            catch (e) {
                reject(e);
            }
        });
    }
};
//# sourceMappingURL=globals-core.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/decorators.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
function Deprecated(target, key, descriptor) {
    if (descriptor) {
        var originalMethod_1 = descriptor.value;
        descriptor.value = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            console.log(key.toString() + " is deprecated");
            return originalMethod_1.apply(this, args);
        };
        return descriptor;
    }
    else {
        console.log((target && target.name || target) + " is deprecated");
        return target;
    }
}
exports.Deprecated = Deprecated;
global.Deprecated = Deprecated;
function Experimental(target, key, descriptor) {
    if (descriptor) {
        var originalMethod_2 = descriptor.value;
        descriptor.value = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            console.log(key.toString() + " is experimental");
            return originalMethod_2.apply(this, args);
        };
        return descriptor;
    }
    else {
        console.log((target && target.name || target) + " is experimental");
        return target;
    }
}
exports.Experimental = Experimental;
global.Experimental = Experimental;
//# sourceMappingURL=decorators.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/globals.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/core/globals-core.js");
__webpack_require__("../node_modules/tns-core-modules/globals/polyfills/timers/timers.js");
__webpack_require__("../node_modules/tns-core-modules/globals/polyfills/dialogs/dialogs.js");
__webpack_require__("../node_modules/tns-core-modules/globals/polyfills/xhr/xhr.js");
__webpack_require__("../node_modules/tns-core-modules/globals/polyfills/fetch/fetch.js");
__webpack_require__("../node_modules/tns-core-modules/globals/decorators.js");
//# sourceMappingURL=globals.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/polyfills/dialogs/dialogs.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/core/globals-core.js");
var polyfill_helpers_1 = __webpack_require__("../node_modules/tns-core-modules/globals/polyfills/polyfill-helpers/polyfill-helpers.js");
global.registerModule("tns-core-modules/ui/dialogs", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs.js"); });
polyfill_helpers_1.installPolyfills("tns-core-modules/ui/dialogs", ["alert", "confirm", "prompt", "login", "action"]);
//# sourceMappingURL=dialogs.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/polyfills/fetch/fetch.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/core/globals-core.js");
__webpack_require__("../node_modules/tns-core-modules/globals/polyfills/xhr/xhr.js");
var polyfill_helpers_1 = __webpack_require__("../node_modules/tns-core-modules/globals/polyfills/polyfill-helpers/polyfill-helpers.js");
global.registerModule("fetch", function () { return __webpack_require__("../node_modules/tns-core-modules/fetch/fetch.js"); });
polyfill_helpers_1.installPolyfills("fetch", ["fetch", "Headers", "Request", "Response"]);
//# sourceMappingURL=fetch.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/polyfills/polyfill-helpers/polyfill-helpers.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/core/globals-core.js");
function registerOnGlobalContext(moduleName, exportName) {
    Object.defineProperty(global, exportName, {
        get: function () {
            var m = global.loadModule(moduleName);
            var resolvedValue = m[exportName];
            Object.defineProperty(global, exportName, { value: resolvedValue, configurable: true, writable: true });
            return resolvedValue;
        },
        configurable: true
    });
}
function installPolyfills(moduleName, exportNames) {
    if (global.__snapshot) {
        var loadedModule_1 = global.loadModule(moduleName);
        exportNames.forEach(function (exportName) { return global[exportName] = loadedModule_1[exportName]; });
    }
    else {
        exportNames.forEach(function (exportName) { return registerOnGlobalContext(moduleName, exportName); });
    }
}
exports.installPolyfills = installPolyfills;
//# sourceMappingURL=polyfill-helpers.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/polyfills/timers/timers.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/core/globals-core.js");
var polyfill_helpers_1 = __webpack_require__("../node_modules/tns-core-modules/globals/polyfills/polyfill-helpers/polyfill-helpers.js");
global.registerModule("timer", function () { return __webpack_require__("../node_modules/tns-core-modules/timer/timer.js"); });
polyfill_helpers_1.installPolyfills("timer", ["setTimeout", "clearTimeout", "setInterval", "clearInterval"]);
//# sourceMappingURL=timers.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/polyfills/xhr/xhr.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/core/globals-core.js");
var polyfill_helpers_1 = __webpack_require__("../node_modules/tns-core-modules/globals/polyfills/polyfill-helpers/polyfill-helpers.js");
global.registerModule("xhr", function () { return __webpack_require__("../node_modules/xhr/index.js"); });
polyfill_helpers_1.installPolyfills("xhr", ["XMLHttpRequest", "FormData"]);
//# sourceMappingURL=xhr.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/register-module-helpers.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {var modules = new Map();
var modulesLoadedForUI = new Set();
var defaultExtensionMap = {
    ".js": ".js",
    ".ts": ".js",
    ".css": ".css",
    ".scss": ".css",
    ".less": ".css",
    ".sass": ".css",
    ".xml": ".xml"
};
global.moduleResolvers = [global.require];
global.registerModule = function (name, loader) {
    modules.set(name, { loader: loader, moduleId: name });
};
global._unregisterModule = function _unregisterModule(name) {
    modules.delete(name);
};
global._isModuleLoadedForUI = function _isModuleLoadedForUI(moduleName) {
    return modulesLoadedForUI.has(moduleName);
};
global.registerWebpackModules = function registerWebpackModules(context, extensionMap) {
    if (extensionMap === void 0) { extensionMap = {}; }
    context.keys().forEach(function (moduleId) {
        var extDotIndex = moduleId.lastIndexOf(".");
        var base = moduleId.substr(0, extDotIndex);
        var originalExt = moduleId.substr(extDotIndex);
        var registerExt = extensionMap[originalExt] || defaultExtensionMap[originalExt] || originalExt;
        var isSourceFile = originalExt !== registerExt;
        var registerName = base + registerExt;
        var registerWithName = function (nickName) {
            modules.set(nickName, {
                moduleId: moduleId,
                loader: function () {
                    return context(moduleId);
                }
            });
        };
        if (registerName.startsWith("./") && registerName.endsWith(".js")) {
            var jsNickNames = [
                registerName.substr(2, registerName.length - 5),
                registerName.substr(0, registerName.length - 3),
                registerName.substr(2),
            ];
            jsNickNames.forEach(function (jsNickName) {
                if (isSourceFile || !global.moduleExists(jsNickName)) {
                    registerWithName(jsNickName);
                }
            });
        }
        else if (registerName.startsWith("./")) {
            var moduleNickNames = [
                registerName.substr(2),
            ];
            moduleNickNames.forEach(function (moduleNickName) {
                if (!global.moduleExists(moduleNickName)) {
                    registerWithName(moduleNickName);
                }
            });
        }
        if (isSourceFile || !global.moduleExists(registerName)) {
            registerWithName(registerName);
        }
    });
};
global.moduleExists = function moduleExists(name) {
    return modules.has(name);
};
global.loadModule = function loadModule(name, isUIModule) {
    if (isUIModule === void 0) { isUIModule = false; }
    var moduleInfo = modules.get(name);
    if (moduleInfo) {
        if (isUIModule) {
            modulesLoadedForUI.add(moduleInfo.moduleId);
        }
        var result = moduleInfo.loader(name);
        if (result.enableAutoAccept) {
            result.enableAutoAccept();
        }
        return result;
    }
    var _loop_1 = function (resolver) {
        var result = resolver(name);
        if (result) {
            modules.set(name, { moduleId: name, loader: function () { return result; } });
            return { value: result };
        }
    };
    for (var _i = 0, _a = global.moduleResolvers; _i < _a.length; _i++) {
        var resolver = _a[_i];
        var state_1 = _loop_1(resolver);
        if (typeof state_1 === "object")
            return state_1.value;
    }
};
global.getRegisteredModules = function getRegisteredModules() {
    return Array.from(modules.keys());
};
//# sourceMappingURL=register-module-helpers.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/ts-helpers.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
if (!global.__extends) {
    global.__extends = function (d, b) {
        for (var p in b) {
            if (b.hasOwnProperty(p)) {
                d[p] = b[p];
            }
        }
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
}
var tslib = __webpack_require__("../node_modules/tslib/tslib.es6.js");
for (var _i = 0, _a = Object.keys(tslib); _i < _a.length; _i++) {
    var fnName = _a[_i];
    if (typeof tslib[fnName] !== "function") {
        continue;
    }
    if (fnName in global) {
        continue;
    }
    global[fnName] = tslib[fnName];
}
//# sourceMappingURL=ts-helpers.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/http/http-request/http-request-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
function getFilenameFromUrl(url) {
    var fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
    var slashPos = url.lastIndexOf("/") + 1;
    var questionMarkPos = url.lastIndexOf("?");
    var actualFileName;
    if (questionMarkPos !== -1) {
        actualFileName = url.substring(slashPos, questionMarkPos);
    }
    else {
        actualFileName = url.substring(slashPos);
    }
    var result = fs.path.join(fs.knownFolders.documents().path, actualFileName);
    return result;
}
exports.getFilenameFromUrl = getFilenameFromUrl;
//# sourceMappingURL=http-request-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/http/http-request/http-request.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var http_request_common_1 = __webpack_require__("../node_modules/tns-core-modules/http/http-request/http-request-common.js");
var debugger_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/debugger.js");
var HttpResponseEncoding;
(function (HttpResponseEncoding) {
    HttpResponseEncoding[HttpResponseEncoding["UTF8"] = 0] = "UTF8";
    HttpResponseEncoding[HttpResponseEncoding["GBK"] = 1] = "GBK";
})(HttpResponseEncoding = exports.HttpResponseEncoding || (exports.HttpResponseEncoding = {}));
function parseJSON(source) {
    var src = source.trim();
    if (src.lastIndexOf(")") === src.length - 1) {
        return JSON.parse(src.substring(src.indexOf("(") + 1, src.lastIndexOf(")")));
    }
    return JSON.parse(src);
}
var requestIdCounter = 0;
var pendingRequests = {};
var imageSource;
function ensureImageSource() {
    if (!imageSource) {
        imageSource = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
    }
}
var platform;
function ensurePlatform() {
    if (!platform) {
        platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
    }
}
var fs;
function ensureFileSystem() {
    if (!fs) {
        fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
    }
}
var completeCallback;
function ensureCompleteCallback() {
    if (completeCallback) {
        return;
    }
    completeCallback = new org.nativescript.widgets.Async.CompleteCallback({
        onComplete: function (result, context) {
            onRequestComplete(context, result);
        },
        onError: function (error, context) {
            onRequestError(error, context);
        },
    });
}
function onRequestComplete(requestId, result) {
    var callbacks = pendingRequests[requestId];
    delete pendingRequests[requestId];
    if (result.error) {
        callbacks.rejectCallback(new Error(result.error.toString()));
        return;
    }
    var headers = {};
    if (result.headers) {
        var jHeaders = result.headers;
        var length_1 = jHeaders.size();
        var pair = void 0;
        for (var i = 0; i < length_1; i++) {
            pair = jHeaders.get(i);
            addHeader(headers, pair.key, pair.value);
        }
    }
    if (global.__inspector && global.__inspector.isConnected) {
        debugger_1.NetworkAgent.responseReceived(requestId, result, headers);
    }
    callbacks.resolveCallback({
        content: {
            raw: result.raw,
            toString: function (encoding) {
                var str;
                if (encoding) {
                    str = decodeResponse(result.raw, encoding);
                }
                else {
                    str = result.responseAsString;
                }
                if (typeof str === "string") {
                    return str;
                }
                else {
                    throw new Error("Response content may not be converted to string");
                }
            },
            toJSON: function (encoding) {
                var str;
                if (encoding) {
                    str = decodeResponse(result.raw, encoding);
                }
                else {
                    str = result.responseAsString;
                }
                return parseJSON(str);
            },
            toImage: function () {
                ensureImageSource();
                return new Promise(function (resolveImage, rejectImage) {
                    if (result.responseAsImage != null) {
                        resolveImage(imageSource.fromNativeSource(result.responseAsImage));
                    }
                    else {
                        rejectImage(new Error("Response content may not be converted to an Image"));
                    }
                });
            },
            toFile: function (destinationFilePath) {
                ensureFileSystem();
                if (!destinationFilePath) {
                    destinationFilePath = http_request_common_1.getFilenameFromUrl(callbacks.url);
                }
                var stream;
                try {
                    var file = fs.File.fromPath(destinationFilePath);
                    var javaFile = new java.io.File(destinationFilePath);
                    stream = new java.io.FileOutputStream(javaFile);
                    stream.write(result.raw.toByteArray());
                    return file;
                }
                catch (exception) {
                    throw new Error("Cannot save file with path: " + destinationFilePath + ".");
                }
                finally {
                    if (stream) {
                        stream.close();
                    }
                }
            }
        },
        statusCode: result.statusCode,
        headers: headers
    });
}
function onRequestError(error, requestId) {
    var callbacks = pendingRequests[requestId];
    delete pendingRequests[requestId];
    if (callbacks) {
        callbacks.rejectCallback(new Error(error));
    }
}
function buildJavaOptions(options) {
    if (typeof options.url !== "string") {
        throw new Error("Http request must provide a valid url.");
    }
    var javaOptions = new org.nativescript.widgets.Async.Http.RequestOptions();
    javaOptions.url = options.url;
    if (typeof options.method === "string") {
        javaOptions.method = options.method;
    }
    if (typeof options.content === "string" || options.content instanceof FormData) {
        javaOptions.content = options.content.toString();
    }
    if (typeof options.timeout === "number") {
        javaOptions.timeout = options.timeout;
    }
    if (typeof options.dontFollowRedirects === "boolean") {
        javaOptions.dontFollowRedirects = options.dontFollowRedirects;
    }
    if (options.headers) {
        var arrayList = new java.util.ArrayList();
        var pair = org.nativescript.widgets.Async.Http.KeyValuePair;
        for (var key in options.headers) {
            arrayList.add(new pair(key, options.headers[key] + ""));
        }
        javaOptions.headers = arrayList;
    }
    ensurePlatform();
    var screen = platform.screen.mainScreen;
    javaOptions.screenWidth = screen.widthPixels;
    javaOptions.screenHeight = screen.heightPixels;
    return javaOptions;
}
function request(options) {
    if (options === undefined || options === null) {
        return;
    }
    return new Promise(function (resolve, reject) {
        try {
            var javaOptions = buildJavaOptions(options);
            if (global.__inspector && global.__inspector.isConnected) {
                debugger_1.NetworkAgent.requestWillBeSent(requestIdCounter, options);
            }
            var callbacks = {
                url: options.url,
                resolveCallback: resolve,
                rejectCallback: reject
            };
            pendingRequests[requestIdCounter] = callbacks;
            ensureCompleteCallback();
            org.nativescript.widgets.Async.Http.MakeRequest(javaOptions, completeCallback, new java.lang.Integer(requestIdCounter));
            requestIdCounter++;
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.request = request;
function decodeResponse(raw, encoding) {
    var charsetName = "UTF-8";
    if (encoding === HttpResponseEncoding.GBK) {
        charsetName = "GBK";
    }
    return raw.toString(charsetName);
}
function addHeader(headers, key, value) {
    if (!headers[key]) {
        headers[key] = value;
    }
    else if (Array.isArray(headers[key])) {
        headers[key].push(value);
    }
    else {
        var values = [headers[key]];
        values.push(value);
        headers[key] = values;
    }
}
exports.addHeader = addHeader;
//# sourceMappingURL=http-request.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/http/http.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var httpRequest = __webpack_require__("../node_modules/tns-core-modules/http/http-request/http-request.js");
__export(__webpack_require__("../node_modules/tns-core-modules/http/http-request/http-request.js"));
function getString(arg) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                var str = r.content.toString();
                resolve(str);
            }
            catch (e) {
                reject(e);
            }
        }, function (e) { return reject(e); });
    });
}
exports.getString = getString;
function getJSON(arg) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                var json = r.content.toJSON();
                resolve(json);
            }
            catch (e) {
                reject(e);
            }
        }, function (e) { return reject(e); });
    });
}
exports.getJSON = getJSON;
function getImage(arg) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                resolve(r.content.toImage());
            }
            catch (err) {
                reject(err);
            }
        }, function (err) {
            reject(err);
        });
    });
}
exports.getImage = getImage;
function getFile(arg, destinationFilePath) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                var file = r.content.toFile(destinationFilePath);
                resolve(file);
            }
            catch (e) {
                reject(e);
            }
        }, function (e) { return reject(e); });
    });
}
exports.getFile = getFile;
//# sourceMappingURL=http.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/image-asset/image-asset-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var ImageAssetBase = (function (_super) {
    __extends(ImageAssetBase, _super);
    function ImageAssetBase() {
        var _this = _super.call(this) || this;
        _this._options = { keepAspectRatio: true, autoScaleFactor: true };
        return _this;
    }
    Object.defineProperty(ImageAssetBase.prototype, "options", {
        get: function () {
            return this._options;
        },
        set: function (value) {
            this._options = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageAssetBase.prototype, "nativeImage", {
        get: function () {
            return this._nativeImage;
        },
        set: function (value) {
            this._nativeImage = value;
        },
        enumerable: true,
        configurable: true
    });
    ImageAssetBase.prototype.getImageAsync = function (callback) {
    };
    return ImageAssetBase;
}(observable_1.Observable));
exports.ImageAssetBase = ImageAssetBase;
function getAspectSafeDimensions(sourceWidth, sourceHeight, reqWidth, reqHeight) {
    var widthCoef = sourceWidth / reqWidth;
    var heightCoef = sourceHeight / reqHeight;
    var aspectCoef = Math.min(widthCoef, heightCoef);
    return {
        width: Math.floor(sourceWidth / aspectCoef),
        height: Math.floor(sourceHeight / aspectCoef)
    };
}
exports.getAspectSafeDimensions = getAspectSafeDimensions;
function getRequestedImageSize(src, options) {
    var screen = platform_1.screen.mainScreen;
    var reqWidth = options.width || Math.min(src.width, screen.widthPixels);
    var reqHeight = options.height || Math.min(src.height, screen.heightPixels);
    if (options && options.keepAspectRatio) {
        var safeAspectSize = getAspectSafeDimensions(src.width, src.height, reqWidth, reqHeight);
        reqWidth = safeAspectSize.width;
        reqHeight = safeAspectSize.height;
    }
    return {
        width: reqWidth,
        height: reqHeight
    };
}
exports.getRequestedImageSize = getRequestedImageSize;
//# sourceMappingURL=image-asset-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/image-asset/image-asset.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var image_asset_common_1 = __webpack_require__("../node_modules/tns-core-modules/image-asset/image-asset-common.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
__export(__webpack_require__("../node_modules/tns-core-modules/image-asset/image-asset-common.js"));
var ImageAsset = (function (_super) {
    __extends(ImageAsset, _super);
    function ImageAsset(asset) {
        var _this = _super.call(this) || this;
        var fileName = typeof asset === "string" ? asset.trim() : "";
        if (fileName.indexOf("~/") === 0) {
            fileName = file_system_1.path.join(file_system_1.knownFolders.currentApp().path, fileName.replace("~/", ""));
        }
        _this.android = fileName;
        return _this;
    }
    Object.defineProperty(ImageAsset.prototype, "android", {
        get: function () {
            return this._android;
        },
        set: function (value) {
            this._android = value;
        },
        enumerable: true,
        configurable: true
    });
    ImageAsset.prototype.getImageAsync = function (callback) {
        var bitmapOptions = new android.graphics.BitmapFactory.Options();
        bitmapOptions.inJustDecodeBounds = true;
        var bitmap = android.graphics.BitmapFactory.decodeFile(this.android, bitmapOptions);
        var sourceSize = {
            width: bitmapOptions.outWidth,
            height: bitmapOptions.outHeight
        };
        var requestedSize = image_asset_common_1.getRequestedImageSize(sourceSize, this.options);
        var sampleSize = org.nativescript.widgets.image.Fetcher.calculateInSampleSize(bitmapOptions.outWidth, bitmapOptions.outHeight, requestedSize.width, requestedSize.height);
        var finalBitmapOptions = new android.graphics.BitmapFactory.Options();
        finalBitmapOptions.inSampleSize = sampleSize;
        try {
            var error = null;
            bitmap = android.graphics.BitmapFactory.decodeFile(this.android, finalBitmapOptions);
            if (bitmap) {
                if (requestedSize.width !== bitmap.getWidth() || requestedSize.height !== bitmap.getHeight()) {
                    bitmap = android.graphics.Bitmap.createScaledBitmap(bitmap, requestedSize.width, requestedSize.height, true);
                }
                var rotationAngle = calculateAngleFromFile(this.android);
                if (rotationAngle !== 0) {
                    var matrix = new android.graphics.Matrix();
                    matrix.postRotate(rotationAngle);
                    bitmap = android.graphics.Bitmap.createBitmap(bitmap, 0, 0, bitmap.getWidth(), bitmap.getHeight(), matrix, true);
                }
            }
            if (!bitmap) {
                error = "Asset '" + this.android + "' cannot be found.";
            }
            callback(bitmap, error);
        }
        catch (ex) {
            callback(null, ex);
        }
    };
    return ImageAsset;
}(image_asset_common_1.ImageAssetBase));
exports.ImageAsset = ImageAsset;
function calculateAngleFromFile(filename) {
    var rotationAngle = 0;
    var ei = new android.media.ExifInterface(filename);
    var orientation = ei.getAttributeInt(android.media.ExifInterface.TAG_ORIENTATION, android.media.ExifInterface.ORIENTATION_NORMAL);
    switch (orientation) {
        case android.media.ExifInterface.ORIENTATION_ROTATE_90:
            rotationAngle = 90;
            break;
        case android.media.ExifInterface.ORIENTATION_ROTATE_180:
            rotationAngle = 180;
            break;
        case android.media.ExifInterface.ORIENTATION_ROTATE_270:
            rotationAngle = 270;
            break;
    }
    return rotationAngle;
}
//# sourceMappingURL=image-asset.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/image-source/image-source.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
exports.isFileOrResourcePath = utils_1.isFileOrResourcePath;
var application_1 = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var http;
function ensureHttp() {
    if (!http) {
        http = __webpack_require__("../node_modules/tns-core-modules/http/http.js");
    }
}
var application;
var resources;
function getApplication() {
    if (!application) {
        application = application_1.getNativeApplication();
    }
    return application;
}
function getResources() {
    if (!resources) {
        resources = getApplication().getResources();
    }
    return resources;
}
var ImageSource = (function () {
    function ImageSource() {
    }
    ImageSource.prototype.fromAsset = function (asset) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            asset.getImageAsync(function (image, err) {
                if (image) {
                    _this.setNativeSource(image);
                    resolve(_this);
                }
                else {
                    reject(err);
                }
            });
        });
    };
    ImageSource.prototype.loadFromResource = function (name) {
        this.android = null;
        var res = getResources();
        if (res) {
            var identifier = res.getIdentifier(name, "drawable", getApplication().getPackageName());
            if (0 < identifier) {
                var bitmapDrawable = res.getDrawable(identifier);
                if (bitmapDrawable && bitmapDrawable.getBitmap) {
                    this.android = bitmapDrawable.getBitmap();
                }
            }
        }
        return this.android != null;
    };
    ImageSource.prototype.fromResource = function (name) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            resolve(_this.loadFromResource(name));
        });
    };
    ImageSource.prototype.setRotationAngleFromFile = function (filename) {
        this.rotationAngle = 0;
        var ei = new android.media.ExifInterface(filename);
        var orientation = ei.getAttributeInt(android.media.ExifInterface.TAG_ORIENTATION, android.media.ExifInterface.ORIENTATION_NORMAL);
        switch (orientation) {
            case android.media.ExifInterface.ORIENTATION_ROTATE_90:
                this.rotationAngle = 90;
                break;
            case android.media.ExifInterface.ORIENTATION_ROTATE_180:
                this.rotationAngle = 180;
                break;
            case android.media.ExifInterface.ORIENTATION_ROTATE_270:
                this.rotationAngle = 270;
                break;
        }
    };
    ImageSource.prototype.loadFromFile = function (path) {
        var fileName = typeof path === "string" ? path.trim() : "";
        if (fileName.indexOf("~/") === 0) {
            fileName = file_system_1.path.join(file_system_1.knownFolders.currentApp().path, fileName.replace("~/", ""));
        }
        this.setRotationAngleFromFile(fileName);
        this.android = android.graphics.BitmapFactory.decodeFile(fileName, null);
        return this.android != null;
    };
    ImageSource.prototype.fromFile = function (path) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            resolve(_this.loadFromFile(path));
        });
    };
    ImageSource.prototype.loadFromData = function (data) {
        this.android = android.graphics.BitmapFactory.decodeStream(data);
        return this.android != null;
    };
    ImageSource.prototype.fromData = function (data) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            resolve(_this.loadFromData(data));
        });
    };
    ImageSource.prototype.loadFromBase64 = function (source) {
        if (typeof source === "string") {
            var bytes = android.util.Base64.decode(source, android.util.Base64.DEFAULT);
            this.android = android.graphics.BitmapFactory.decodeByteArray(bytes, 0, bytes.length);
        }
        return this.android != null;
    };
    ImageSource.prototype.fromBase64 = function (data) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            resolve(_this.loadFromBase64(data));
        });
    };
    ImageSource.prototype.loadFromFontIconCode = function (source, font, color) {
        var paint = new android.graphics.Paint();
        paint.setTypeface(font.getAndroidTypeface());
        paint.setAntiAlias(true);
        if (color) {
            paint.setColor(color.android);
        }
        var fontSize = utils_1.layout.toDevicePixels(font.fontSize);
        if (!fontSize) {
            fontSize = paint.getTextSize();
        }
        var density = utils_1.layout.getDisplayDensity();
        var scaledFontSize = fontSize * density;
        paint.setTextSize(scaledFontSize);
        var textBounds = new android.graphics.Rect();
        paint.getTextBounds(source, 0, source.length, textBounds);
        var textWidth = textBounds.width();
        var textHeight = textBounds.height();
        if (textWidth > 0 && textHeight > 0) {
            var bitmap = android.graphics.Bitmap
                .createBitmap(textWidth, textHeight, android.graphics.Bitmap.Config.ARGB_8888);
            var canvas = new android.graphics.Canvas(bitmap);
            canvas.drawText(source, -textBounds.left, -textBounds.top, paint);
            this.android = bitmap;
        }
        return this.android != null;
    };
    ImageSource.prototype.setNativeSource = function (source) {
        if (source && !(source instanceof android.graphics.Bitmap)) {
            throw new Error("The method setNativeSource() expects android.graphics.Bitmap instance.");
        }
        this.android = source;
    };
    ImageSource.prototype.saveToFile = function (path, format, quality) {
        if (quality === void 0) { quality = 100; }
        if (!this.android) {
            return false;
        }
        var targetFormat = getTargetFormat(format);
        var outputStream = new java.io.BufferedOutputStream(new java.io.FileOutputStream(path));
        var res = this.android.compress(targetFormat, quality, outputStream);
        outputStream.close();
        return res;
    };
    ImageSource.prototype.toBase64String = function (format, quality) {
        if (quality === void 0) { quality = 100; }
        if (!this.android) {
            return null;
        }
        var targetFormat = getTargetFormat(format);
        var outputStream = new java.io.ByteArrayOutputStream();
        var base64Stream = new android.util.Base64OutputStream(outputStream, android.util.Base64.NO_WRAP);
        this.android.compress(targetFormat, quality, base64Stream);
        base64Stream.close();
        outputStream.close();
        return outputStream.toString();
    };
    Object.defineProperty(ImageSource.prototype, "height", {
        get: function () {
            if (this.android) {
                return this.android.getHeight();
            }
            return NaN;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageSource.prototype, "width", {
        get: function () {
            if (this.android) {
                return this.android.getWidth();
            }
            return NaN;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageSource.prototype, "rotationAngle", {
        get: function () {
            return this._rotationAngle;
        },
        set: function (value) {
            this._rotationAngle = value;
        },
        enumerable: true,
        configurable: true
    });
    return ImageSource;
}());
exports.ImageSource = ImageSource;
function getTargetFormat(format) {
    switch (format) {
        case "jpeg":
        case "jpg":
            return android.graphics.Bitmap.CompressFormat.JPEG;
        default:
            return android.graphics.Bitmap.CompressFormat.PNG;
    }
}
function fromAsset(asset) {
    var image = new ImageSource();
    return image.fromAsset(asset);
}
exports.fromAsset = fromAsset;
function fromResource(name) {
    var image = new ImageSource();
    return image.loadFromResource(name) ? image : null;
}
exports.fromResource = fromResource;
function fromFile(path) {
    var image = new ImageSource();
    return image.loadFromFile(path) ? image : null;
}
exports.fromFile = fromFile;
function fromData(data) {
    var image = new ImageSource();
    return image.loadFromData(data) ? image : null;
}
exports.fromData = fromData;
function fromFontIconCode(source, font, color) {
    var image = new ImageSource();
    return image.loadFromFontIconCode(source, font, color) ? image : null;
}
exports.fromFontIconCode = fromFontIconCode;
function fromBase64(source) {
    var image = new ImageSource();
    return image.loadFromBase64(source) ? image : null;
}
exports.fromBase64 = fromBase64;
function fromNativeSource(source) {
    var imageSource = new ImageSource();
    imageSource.setNativeSource(source);
    return imageSource;
}
exports.fromNativeSource = fromNativeSource;
function fromUrl(url) {
    ensureHttp();
    return http.getImage(url);
}
exports.fromUrl = fromUrl;
function fromFileOrResource(path) {
    if (!utils_1.isFileOrResourcePath(path)) {
        throw new Error(path + " is not a valid file or resource.");
    }
    if (path.indexOf(utils_1.RESOURCE_PREFIX) === 0) {
        return fromResource(path.substr(utils_1.RESOURCE_PREFIX.length));
    }
    return fromFile(path);
}
exports.fromFileOrResource = fromFileOrResource;
//# sourceMappingURL=image-source.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/easysax/easysax.js":
/***/ (function(module, exports, __webpack_require__) {

	/*
	new function() {
		var parser = new EasySAXParser();

		parser.ns('rss', { // or false
			rss: 'http://purl.org/rss/1.0/',
			atom: 'http://www.w3.org/2005/Atom',
			xhtml: 'http://www.w3.org/1999/xhtml',
			media: 'http://search.yahoo.com/mrss/'
		});


		parser.on('error', function(msg) {
			//console.log(msg)
		});

		parser.on('startNode', function(elem, attr, uq, tagend, getStrNode) {
			attr();
			return;
			if (tagend) {
				console.log('   '+str)
			} else {
				console.log('+  '+str)
			};
		});

		parser.on('endNode', function(elem, uq, tagstart, str) {
			return;
			if (!tagstart) console.log('-  ' + str)
		});

		parser.on('textNode', function(s, uq) {
			uq(s);
			return
			console.log('   '+s)
		});

		parser.on('cdata', function(data) {
		});


		parser.on('comment', function(text) {
			//console.log('--'+text+'--')
		});

		//parser.on('question', function() {}); // <? ... ?>
		//parser.on('attention', function() {}); // <!XXXXX zzzz="eeee">

		console.time('easysax');
		for(var z=1000;z--;) {
			parser.parse(xml)
		};
		console.timeEnd('easysax');
	};


	*/

// << ------------------------------------------------------------------------ >> //


if (true /*&& this == exports*/) {
	module.exports.EasySAXParser = EasySAXParser;
};

function EasySAXParser() {
	'use strict';

	if (!this) return null;

    this.angularSyntax = false;

	function nullFunc() {};

	this.onTextNode = nullFunc;
    this.onStartNode = nullFunc;
    this.onEndNode = nullFunc;
    this.onCDATA = nullFunc;
    this.onError = nullFunc;
    this.onComment = null;
    this.onQuestion = null;
    this.onAttention = null;
	this.is_onComment = this.is_onQuestion = this.is_onAttention = false;

	this.isNamespace = false;
    this.useNS = null;
    this.default_xmlns = null;
    this.xmlns = null;
	this.nsmatrix = {xmlns: this.xmlns};
	this.hasSurmiseNS = false;
	;


	this.attr_string = ''; //  
	this.attr_posstart = 0; //
	this.attr_res; //     , null -   , object -  , true -  , false -  xml
}

EasySAXParser.prototype.on = function(name, cb) {
    if (typeof cb !== 'function') {
        if (cb !== null) return;
    };

    switch(name) {
        case 'error': this.onError = cb || nullFunc; break;
        case 'startNode': this.onStartNode = cb || nullFunc; break;
        case 'endNode': this.onEndNode = cb || nullFunc; break;
        case 'textNode': this.onTextNode = cb || nullFunc; break;
        case 'cdata': this.onCDATA = cb || nullFunc; break;

        case 'comment': this.onComment = cb; this.is_onComment = !!cb; break;
        case 'question': this.onQuestion = cb; this.is_onQuestion = !!cb; break; // <? ....  ?>
        case 'attention': this.onAttention = cb; this.is_onAttention = !!cb; break; // <!XXXXX zzzz="eeee">
    };
};

EasySAXParser.prototype.ns = function(root, ns) {
    if (!root || typeof root !== 'string' || !ns) {
        return;
    };

    var u, x = {}, ok, v, i;

    for(i in ns) {
        v = ns[i];
        if (typeof v === 'string') {
            if (root === v) ok = true;
            x[i] = v;
        };
    };

    if (ok) {
        this.isNamespace = true;
        this.default_xmlns = root;
        this.useNS = x;
    };
};


EasySAXParser.prototype.parse = function(xml) {
    if (typeof xml !== 'string') {
        return;
    };

    if (this.isNamespace) {
        this.nsmatrix = {xmlns: this.default_xmlns};

        parse(xml);

        this.nsmatrix = false;

    } else {
        parse(xml);
    };

    this.attr_res = true;
};

// -----------------------------------------------------

var xharsQuot={constructor: false, hasOwnProperty: false, isPrototypeOf: false, propertyIsEnumerable: false, toLocaleString: false, toString: false, valueOf: false
    , quot: '"'
    , QUOT: '"'
    , amp: '&'
    , AMP: '&'
    , nbsp: '\u00A0'
    , apos: '\''
    , lt: '<'
    , LT: '<'
    , gt: '>'
    , GT: '>'
    , copy: '\u00A9'
    , laquo: '\u00AB'
    , raquo: '\u00BB'
    , reg: '\u00AE'
    , deg: '\u00B0'
    , plusmn: '\u00B1'
    , sup2: '\u00B2'
    , sup3: '\u00B3'
    , micro: '\u00B5'
    , para: '\u00B6'
};


function rpEntities(s, d, x, z) {
    if (z) {
        return xharsQuot[z] || '\x01';
    };

    if (d) {
        return String.fromCodePoint(d);
    };

    return String.fromCodePoint(parseInt(x, 16));
};

function unEntities(s, i) {
    s = String(s);
    if (s.length > 3 && s.indexOf('&') !== -1) {
        if (s.indexOf('&gt;') !== -1) s = s.replace(/&gt;/g, '>');
        if (s.indexOf('&lt;') !== -1) s = s.replace(/&lt;/g, '<');
        if (s.indexOf('&quot;') !== -1) s = s.replace(/&quot;/g, '"');

        if (s.indexOf('&') !== -1) {
            s = s.replace(/&#(\d+);|&#x([0123456789abcdef]+);|&(\w+);/ig, rpEntities);
        };
    };

    return s;
};


EasySAXParser.prototype.allowedAngularAttributeChars = function(w) {
    if (!this.angularSyntax) {
        return false;
    } else {
        return (
            w === 40 || // (
            w === 41 || // )
            w === 91 || // [
            w === 93 || // ]
            w === 94 || // ^
            w === 35    // #
        );
    }
};

	/*
		   . ! -    .

		     false
		        true
		     ()
	*/

EasySAXParser.prototype.getAttrs = function() {
    if (this.attr_res !== null) {
        return this.attr_res;
    };

    /*
    if (xxtest !== u && attr_string.indexOf(xxtest) === -1) {
        / *
            //  
            if (getAttrs('html').type == 'html') {
                ...
            };
        * /
        return true;
    };
    */

    var u
    , res = {}
    , s = this.attr_string
    , i = this.attr_posstart
    , l = s.length
    , attr_list = this.hasSurmiseNS ? [] : false
    , name, value = ''
    , ok = false
    , noValueAttribute = false
    , j, w, nn, n
    , hasNewMatrix
    , alias, newalias
    ;

    aa:
    for(; i < l; i++) {
        w = s.charCodeAt(i);

        if (w===32 || (w<14 && w > 8) ) { // \f\n\r\t\v
            continue
        };

        // Check for valid attribute start char
        if ((w < 65 && !this.allowedAngularAttributeChars(w)) ||
                w > 122 || (w > 90 && w < 97 && !this.allowedAngularAttributeChars(w)) ) { //  
            return this.attr_res = false; // error. invalid char
        };

        for(j = i + 1; j < l; j++) { //     
            w = s.charCodeAt(j);

            if (w > 96 && w < 123 || w > 64 && w < 91 || w > 47 && w < 59 || w === 45 || w === 95 || w === 46 /* https://github.com/telerik/xPlatCore/issues/179 */) {
                if (noValueAttribute) {
                    j--; //Started next attribute. Get back and break out of the loop.
                    break;
                } else {
                    continue;
                }
            };

            if (this.allowedAngularAttributeChars(w)) {
                continue;
            }

            if (w === 32 || (w > 8 && w < 14) ) {  // \f\n\r\t\v 
                noValueAttribute = true;
                continue;
            } else if (w === 61) { // "=" == 61
                noValueAttribute = false;
                break;
            } else {
                //console.log('error 2');
                if (!noValueAttribute)
                    return this.attr_res = false; // error. invalid char
            };

            break;
        };

        name = s.substring(i, j).trim();
        ok = true;

        if (name === 'xmlns:xmlns') {
            //console.log('error 6')
            return this.attr_res = false; // error. invalid name
        };

        w = s.charCodeAt(j+1);

        while (w = s.charCodeAt(j+1)) {
            if (w===32 || (w > 8 && w<14) ) {  // \f\n\r\t\v 
                j++;
            } else {
                break;
            }
        }

        if (!noValueAttribute) {
            if (w === 34) {  // '"'
                j = s.indexOf('"', i = j+2 );

            } else {
                if (w === 39) {
                    j = s.indexOf('\'', i = j+2 );

                } else {  // "'"
                    return this.attr_res = false; // error. invalid char
                };
            };
        }

        if (j === -1) {
            //console.log('error 4')
            return this.attr_res = false; // error. invalid char
        };


        if (j+1 < l && !noValueAttribute) {
            w = s.charCodeAt(j+1);

            if (w > 32 || w < 9 || (w < 32 && w > 13)) {
                // error. invalid char
                //console.log('error 5')
                return this.attr_res = false;
            };
        };


        if (noValueAttribute) {
            value = '';
        } else {
            value = s.substring(i, j);
        }

        //i = j + 1; // .       
        i = j; // .       

        if (this.isNamespace) { //
            if (this.hasSurmiseNS) {
                //       xmlns

                if (newalias = name === 'xmlns' ? 'xmlns' : name.charCodeAt(0) === 120 && name.substr(0, 6) === 'xmlns:' && name.substr(6) ) {
                    alias = this.useNS[unEntities(value)];

                    if (alias) {
                        if (this.nsmatrix[newalias] !== alias) {
                            if (!hasNewMatrix) {
                                hasNewMatrix = true;
                                nn = {}; for (n in this.nsmatrix) nn[n] = this.nsmatrix[n];
                                this.nsmatrix = nn;
                            };

                            this.nsmatrix[newalias] = alias;
                        };
                    } else {
                        if (this.nsmatrix[newalias]) {
                            if (!hasNewMatrix) {
                                hasNewMatrix = true;
                                nn = {}; for (n in this.nsmatrix) nn[n] = this.nsmatrix[n];
                                this.nsmatrix = nn;
                            };

                            this.nsmatrix[newalias] = false;
                        };
                    };

                    res[name] = value;
                    continue;
                };

                attr_list.push(name, value);
                continue;
            };

            w = name.length;
            while(--w) {
                if (name.charCodeAt(w) === 58) { // ':'
                    if (w = this.nsmatrix[name.substring(0, w)] ) {
                        res[w + name.substr(w)] = value;
                    };
                    continue aa;

                    // 'xml:base' ???
                };
            };
        };

        res[name] = value;
        noValueAttribute = false;
    };


    if (!ok) {
        return this.attr_res = true;  //  ,   
    };


    if (this.hasSurmiseNS)  {
        bb:

        for (i = 0, l = attr_list.length; i < l; i++) {
            name = attr_list[i++];

            w = name.length;
            while(--w) { // name.indexOf(':')
                if (name.charCodeAt(w) === 58) { // ':'
                    if (w = this.nsmatrix[name.substring(0, w)]) {
                        res[w + name.substr(w)] = attr_list[i];
                    };
                    continue bb;
                    break;
                };
            };

            res[name] = attr_list[i];
        };
    };

    return this.attr_res = res;
};


// xml - string
EasySAXParser.prototype.parse = function(xml) {
    var u
    , xml = String(xml)
    , nodestack = []
    , stacknsmatrix = []
    //, string_node
    , elem
    , tagend = false
    , tagstart = false
    , j = 0, i = 0, k = 0, len
    , x, y, q, w
    , xmlns
    , stopIndex = 0
    , stop //    "namespace" .        
    , _nsmatrix
    , ok
    , pos = 0, ln = 0, lnStart = -2, lnEnd = -1
    ;

    len = xml.length;
    function getStringNode() {
        return xml.substring(i, j+1)
    };
    function findLineAndColumnFromPos() {
        while (lnStart < lnEnd && lnEnd < pos) {
            lnStart = lnEnd;
            lnEnd = xml.indexOf("\n", lnEnd + 1);
            ++ln;
        }
        return { line: ln, column: pos - lnStart };
    }
    function position(p) {
        pos = p;
        return findLineAndColumnFromPos;
    }

    while(j !== -1) {
        stop = stopIndex > 0;

        if (xml.charCodeAt(j) === 60) { // "<"
            i = j;
        } else {
            i = xml.indexOf('<', j);
        };

        if (i === -1) { //  

            if (nodestack.length) {
                this.onError('end file', position(j));
                return;
            };

            return;
        };

        if (j !== i && !stop) {
            ok = this.onTextNode(xml.substring(j, i), unEntities, position(j));
            if (ok === false) return;
        };

        w = xml.charCodeAt(i+1);

        if (w === 33) { // "!"
            w = xml.charCodeAt(i+2);
            if (w === 91 && xml.substr(i+3, 6) === 'CDATA[') { // 91 == "["
                j = xml.indexOf(']]>', i);
                if (j === -1) {
                    this.onError('cdata', position(i));
                    return;
                };

                //x = xml.substring(i+9, j);
                if (!stop) {
                    ok = this.onCDATA(xml.substring(i+9, j), false, position(i));
                    if (ok === false) return;
                };

                j += 3;
                continue;
            };

            if (w === 45 && xml.charCodeAt(i+3) === 45) { // 45 == "-"
                j = xml.indexOf('-->', i);
                if (j === -1) {
                    this.onError('expected -->', position(i));
                    return;
                };


                if (this.is_onComment && !stop) {
                    ok = this.onComment(xml.substring(i+4, j), unEntities, position(i));
                    if (ok === false) return;
                };

                j += 3;
                continue;
            };

            j = xml.indexOf('>', i+1);
            if (j === -1) {
                this.onError('expected ">"', position(i + 1));
                return;
            };

            if (this.is_onAttention && !stop) {
                ok = this.onAttention(xml.substring(i, j+1), unEntities, position(i));
                if (ok === false) return;
            };

            j += 1;
            continue;

        } else {
            if (w === 63) { // "?"
                j = xml.indexOf('?>', i);
                if (j === -1) { // error
                    this.onError('...?>', position(i));
                    return;
                };

                if (this.is_onQuestion) {
                    ok = this.onQuestion(xml.substring(i, j+2), position(i));
                    if (ok === false) return;
                };

                j += 2;
                continue;
            };
        };

        var inside=false;
        for (k=i,j=-1;k<len;k++) {
            var c = xml.charCodeAt(k);
            if (!inside) {

                if (c === 34) { // '"'
                    inside = c;
                }
                else if (c === 39) { // "'"
                    inside = c;
                }
                else if (c === 62) { // <
                    j = k; break;
                }
            } else {
                if (c === inside) { inside = false; }
            }
        }

        if (j == -1) { // error
            this.onError('...>', position(i + 1));
            return;
        };

        this.attr_res = true; //  

        //if (xml.charCodeAt(i+1) === 47) { // </...
        if (w === 47) { // </...
            tagstart = false;
            tagend = true;

            //          
            x = elem = nodestack.pop();
            q = i + 2 + x.length;

            //console.log()
            if (xml.substring(i+2, q) !== x) {
                this.onError('close tagname', position(i + 2));
                return;
            };

            //       
            for(; q < j; q++) {
                w = xml.charCodeAt(q);

                if (w===32 || (w > 8 && w<14) ) {  // \f\n\r\t\v 
                    continue;
                };

                this.onError('close tag', position(i + 2));
                return;
            };

        } else {
            if (xml.charCodeAt(j-1) ===  47) { // .../>
                x = elem = xml.substring(i+1, j-1);

                tagstart = true;
                tagend = true;
            } else {
                x = elem = xml.substring(i+1, j);

                tagstart = true;
                tagend = false;
            };

            if ( !(w > 96  && w < 123 || w > 64 && w <91) ) {
                this.onError('first char nodeName', position(i + 1));
                return;
            };

            for(q = 1, y = x.length; q < y; q++) {
                w = x.charCodeAt(q);

                if (w > 96 && w < 123 || w > 64 && w < 91 || w > 47 && w < 59 || w === 45 || w === 95 || w === 46 /* https://github.com/telerik/xPlatCore/issues/179 */) {
                    continue;
                };

                if (w===32 || (w<14 && w > 8)) { // \f\n\r\t\v 
                    elem = x.substring(0, q)
                    this.attr_res = null; //   
                    break;
                };

                this.onError('invalid nodeName', position(i + 1));
                return;
            };

            if (!tagend) {
                nodestack.push(elem);
            };
        };


        if (this.isNamespace) {
            if (stop) {
                if (tagend) {
                    if (!tagstart) {
                        if (--stopIndex === 0) {
                            this.nsmatrix = stacknsmatrix.pop();
                        };
                    };

                } else {
                    stopIndex += 1;
                };


                j += 1;
                continue;
            };

            _nsmatrix = this.nsmatrix;

            if (!tagend) {
                stacknsmatrix.push(this.nsmatrix);

                if (this.attr_res !== true) {
                    if (this.hasSurmiseNS = x.indexOf('xmlns', q) !== -1) {
                        this.attr_string = x;
                        this.attr_posstart = q;

                        this.getAttrs();

                        this.hasSurmiseNS = false;
                    };
                };
            };


            w = elem.indexOf(':');
            if (w !== -1) {
                xmlns = this.nsmatrix[elem.substring(0, w)];
                elem = elem.substr(w+1);

            } else {
                xmlns = this.nsmatrix.xmlns;
            };

            if (!xmlns) {
                if (tagend) {
                    if (tagstart) {
                        this.nsmatrix = _nsmatrix;
                    } else {
                        this.nsmatrix = stacknsmatrix.pop();
                    };
                } else {
                    stopIndex = 1; //        
                    this.attr_res = true;
                };

                j += 1;
                continue;
            };

            elem = xmlns + ':' + elem;
        };

        //string_node = xml.substring(i, j+1); //    

        if (tagstart) { // is_onStartNode
            this.attr_string = x;
            this.attr_posstart = q;

            var that = this;
            ok = this.onStartNode(elem, function() { return that.getAttrs() }, unEntities, tagend
                , getStringNode, position(i)
            );

            if (ok === false) {
                return;
            };

            this.attr_res = true;
        };

        if (tagend) {
            ok = this.onEndNode(elem, unEntities, tagstart
                , getStringNode, position(i)
            );

            if (ok === false) {
                return;
            };

            if (this.isNamespace) {
                if (tagstart) {
                    this.nsmatrix = _nsmatrix;
                } else {
                    this.nsmatrix = stacknsmatrix.pop();
                };
            };
        };

        j += 1;
    };
};


/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/esprima/esprima.js":
/***/ (function(module, exports) {

/*
  Copyright (C) 2013 Ariya Hidayat <ariya.hidayat@gmail.com>
  Copyright (C) 2013 Thaddee Tyl <thaddee.tyl@gmail.com>
  Copyright (C) 2012 Ariya Hidayat <ariya.hidayat@gmail.com>
  Copyright (C) 2012 Mathias Bynens <mathias@qiwi.be>
  Copyright (C) 2012 Joost-Wim Boekesteijn <joost-wim@boekesteijn.nl>
  Copyright (C) 2012 Kris Kowal <kris.kowal@cixar.com>
  Copyright (C) 2012 Yusuke Suzuki <utatane.tea@gmail.com>
  Copyright (C) 2012 Arpad Borsos <arpad.borsos@googlemail.com>
  Copyright (C) 2011 Ariya Hidayat <ariya.hidayat@gmail.com>

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

(function (global) {
    'use strict';

    var Token,
        TokenName,
        Syntax,
        Messages,
        source,
        index,
        length,
        delegate,
        lookahead,
        state;

    Token = {
        BooleanLiteral: 1,
        EOF: 2,
        Identifier: 3,
        Keyword: 4,
        NullLiteral: 5,
        NumericLiteral: 6,
        Punctuator: 7,
        StringLiteral: 8
    };

    TokenName = {};
    TokenName[Token.BooleanLiteral] = 'Boolean';
    TokenName[Token.EOF] = '<end>';
    TokenName[Token.Identifier] = 'Identifier';
    TokenName[Token.Keyword] = 'Keyword';
    TokenName[Token.NullLiteral] = 'Null';
    TokenName[Token.NumericLiteral] = 'Numeric';
    TokenName[Token.Punctuator] = 'Punctuator';
    TokenName[Token.StringLiteral] = 'String';

    Syntax = {
        ArrayExpression: 'ArrayExpression',
        BinaryExpression: 'BinaryExpression',
        CallExpression: 'CallExpression',
        ConditionalExpression: 'ConditionalExpression',
        EmptyStatement: 'EmptyStatement',
        ExpressionStatement: 'ExpressionStatement',
        Identifier: 'Identifier',
        Literal: 'Literal',
        LabeledStatement: 'LabeledStatement',
        LogicalExpression: 'LogicalExpression',
        MemberExpression: 'MemberExpression',
        ObjectExpression: 'ObjectExpression',
        Program: 'Program',
        Property: 'Property',
        ThisExpression: 'ThisExpression',
        UnaryExpression: 'UnaryExpression'
    };

    // Error messages should be identical to V8.
    Messages = {
        UnexpectedToken: 'Unexpected token %0',
        UnknownLabel: 'Undefined label \'%0\'',
        Redeclaration: '%0 \'%1\' has already been declared'
    };

    // Ensure the condition is true, otherwise throw an error.
    // This is only to have a better contract semantic, i.e. another safety net
    // to catch a logic error. The condition shall be fulfilled in normal case.
    // Do NOT use this to enforce a certain condition on any user input.

    function assert(condition, message) {
        if (!condition) {
            throw new Error('ASSERT: ' + message);
        }
    }

    function isDecimalDigit(ch) {
        return (ch >= 48 && ch <= 57);   // 0..9
    }


    // 7.2 White Space

    function isWhiteSpace(ch) {
        return (ch === 32) ||  // space
            (ch === 9) ||      // tab
            (ch === 0xB) ||
            (ch === 0xC) ||
            (ch === 0xA0) ||
            (ch >= 0x1680 && '\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\uFEFF'.indexOf(String.fromCharCode(ch)) > 0);
    }

    // 7.3 Line Terminators

    function isLineTerminator(ch) {
        return (ch === 10) || (ch === 13) || (ch === 0x2028) || (ch === 0x2029);
    }

    // 7.6 Identifier Names and Identifiers

    function isIdentifierStart(ch) {
        return (ch === 36) || (ch === 95) ||  // $ (dollar) and _ (underscore)
            (ch >= 65 && ch <= 90) ||         // A..Z
            (ch >= 97 && ch <= 122);          // a..z
    }

    function isIdentifierPart(ch) {
        return (ch === 36) || (ch === 95) ||  // $ (dollar) and _ (underscore)
            (ch >= 65 && ch <= 90) ||         // A..Z
            (ch >= 97 && ch <= 122) ||        // a..z
            (ch >= 48 && ch <= 57);           // 0..9
    }

    // 7.6.1.1 Keywords

    function isKeyword(id) {
        return (id === 'this')
    }

    // 7.4 Comments

    function skipWhitespace() {
        while (index < length && isWhiteSpace(source.charCodeAt(index))) {
            ++index;
        }
    }

    function getIdentifier() {
        var start, ch;

        start = index++;
        while (index < length) {
            ch = source.charCodeAt(index);
            if (isIdentifierPart(ch)) {
                ++index;
            } else {
                break;
            }
        }

        return source.slice(start, index);
    }

    function scanIdentifier() {
        var start, id, type;

        start = index;

        id = getIdentifier();

        // There is no keyword or literal with only one character.
        // Thus, it must be an identifier.
        if (id.length === 1) {
            type = Token.Identifier;
        } else if (isKeyword(id)) {
            type = Token.Keyword;
        } else if (id === 'null') {
            type = Token.NullLiteral;
        } else if (id === 'true' || id === 'false') {
            type = Token.BooleanLiteral;
        } else {
            type = Token.Identifier;
        }

        return {
            type: type,
            value: id,
            range: [start, index]
        };
    }


    // 7.7 Punctuators

    function scanPunctuator() {
        var start = index,
            code = source.charCodeAt(index),
            code2,
            ch1 = source[index],
            ch2;

        switch (code) {

            // Check for most common single-character punctuators.
            case 46:   // . dot
            case 40:   // ( open bracket
            case 41:   // ) close bracket
            case 59:   // ; semicolon
            case 44:   // , comma
            case 123:  // { open curly brace
            case 125:  // } close curly brace
            case 91:   // [
            case 93:   // ]
            case 58:   // :
            case 63:   // ?
                ++index;
                return {
                    type: Token.Punctuator,
                    value: String.fromCharCode(code),
                    range: [start, index]
                };

            default:
                code2 = source.charCodeAt(index + 1);

                // '=' (char #61) marks an assignment or comparison operator.
                if (code2 === 61) {
                    switch (code) {
                        case 37:  // %
                        case 38:  // &
                        case 42:  // *:
                        case 43:  // +
                        case 45:  // -
                        case 47:  // /
                        case 60:  // <
                        case 62:  // >
                        case 124: // |
                            index += 2;
                            return {
                                type: Token.Punctuator,
                                value: String.fromCharCode(code) + String.fromCharCode(code2),
                                range: [start, index]
                            };

                        case 33: // !
                        case 61: // =
                            index += 2;

                            // !== and ===
                            if (source.charCodeAt(index) === 61) {
                                ++index;
                            }
                            return {
                                type: Token.Punctuator,
                                value: source.slice(start, index),
                                range: [start, index]
                            };
                        default:
                            break;
                    }
                }
                break;
        }

        // Peek more characters.

        ch2 = source[index + 1];

        // Other 2-character punctuators: && ||

        if (ch1 === ch2 && ('&|'.indexOf(ch1) >= 0)) {
            index += 2;
            return {
                type: Token.Punctuator,
                value: ch1 + ch2,
                range: [start, index]
            };
        }

        if ('<>=!+-*%&|^/'.indexOf(ch1) >= 0) {
            ++index;
            return {
                type: Token.Punctuator,
                value: ch1,
                range: [start, index]
            };
        }

        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
    }

    // 7.8.3 Numeric Literals
    function scanNumericLiteral() {
        var number, start, ch;

        ch = source[index];
        assert(isDecimalDigit(ch.charCodeAt(0)) || (ch === '.'),
            'Numeric literal must start with a decimal digit or a decimal point');

        start = index;
        number = '';
        if (ch !== '.') {
            number = source[index++];
            ch = source[index];

            // Hex number starts with '0x'.
            // Octal number starts with '0'.
            if (number === '0') {
                // decimal number starts with '0' such as '09' is illegal.
                if (ch && isDecimalDigit(ch.charCodeAt(0))) {
                    throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
                }
            }

            while (isDecimalDigit(source.charCodeAt(index))) {
                number += source[index++];
            }
            ch = source[index];
        }

        if (ch === '.') {
            number += source[index++];
            while (isDecimalDigit(source.charCodeAt(index))) {
                number += source[index++];
            }
            ch = source[index];
        }

        if (ch === 'e' || ch === 'E') {
            number += source[index++];

            ch = source[index];
            if (ch === '+' || ch === '-') {
                number += source[index++];
            }
            if (isDecimalDigit(source.charCodeAt(index))) {
                while (isDecimalDigit(source.charCodeAt(index))) {
                    number += source[index++];
                }
            } else {
                throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
            }
        }

        if (isIdentifierStart(source.charCodeAt(index))) {
            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
        }

        return {
            type: Token.NumericLiteral,
            value: parseFloat(number),
            range: [start, index]
        };
    }

    // 7.8.4 String Literals

    function scanStringLiteral() {
        var str = '', quote, start, ch, octal = false;

        quote = source[index];
        assert((quote === '\'' || quote === '"'),
            'String literal must starts with a quote');

        start = index;
        ++index;

        while (index < length) {
            ch = source[index++];

            if (ch === quote) {
                quote = '';
                break;
            } else if (ch === '\\') {
                ch = source[index++];
                if (!ch || !isLineTerminator(ch.charCodeAt(0))) {
                    switch (ch) {
                        case 'n':
                            str += '\n';
                            break;
                        case 'r':
                            str += '\r';
                            break;
                        case 't':
                            str += '\t';
                            break;
                        case 'b':
                            str += '\b';
                            break;
                        case 'f':
                            str += '\f';
                            break;
                        case 'v':
                            str += '\x0B';
                            break;

                        default:
                            str += ch;
                            break;
                    }
                } else {
                    if (ch === '\r' && source[index] === '\n') {
                        ++index;
                    }
                }
            } else if (isLineTerminator(ch.charCodeAt(0))) {
                break;
            } else {
                str += ch;
            }
        }

        if (quote !== '') {
            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
        }

        return {
            type: Token.StringLiteral,
            value: str,
            octal: octal,
            range: [start, index]
        };
    }

    function isIdentifierName(token) {
        return token.type === Token.Identifier ||
            token.type === Token.Keyword ||
            token.type === Token.BooleanLiteral ||
            token.type === Token.NullLiteral;
    }

    function advance() {
        var ch;

        skipWhitespace();

        if (index >= length) {
            return {
                type: Token.EOF,
                range: [index, index]
            };
        }

        ch = source.charCodeAt(index);

        // Very common: ( and ) and ;
        if (ch === 40 || ch === 41 || ch === 58) {
            return scanPunctuator();
        }

        // String literal starts with single quote (#39) or double quote (#34).
        if (ch === 39 || ch === 34) {
            return scanStringLiteral();
        }

        if (isIdentifierStart(ch)) {
            return scanIdentifier();
        }

        // Dot (.) char #46 can also start a floating-point number, hence the need
        // to check the next character.
        if (ch === 46) {
            if (isDecimalDigit(source.charCodeAt(index + 1))) {
                return scanNumericLiteral();
            }
            return scanPunctuator();
        }

        if (isDecimalDigit(ch)) {
            return scanNumericLiteral();
        }

        return scanPunctuator();
    }

    function lex() {
        var token;

        token = lookahead;
        index = token.range[1];

        lookahead = advance();

        index = token.range[1];

        return token;
    }

    function peek() {
        var pos;

        pos = index;
        lookahead = advance();
        index = pos;
    }

    // Throw an exception

    function throwError(token, messageFormat) {
        var error,
            args = Array.prototype.slice.call(arguments, 2),
            msg = messageFormat.replace(
                /%(\d)/g,
                function (whole, index) {
                    assert(index < args.length, 'Message reference must be in range');
                    return args[index];
                }
            );

        error = new Error(msg);
        error.index = index;
        error.description = msg;
        throw error;
    }

    // Throw an exception because of the token.

    function throwUnexpected(token) {
        throwError(token, Messages.UnexpectedToken, token.value);
    }

    // Expect the next token to match the specified punctuator.
    // If not, an exception will be thrown.

    function expect(value) {
        var token = lex();
        if (token.type !== Token.Punctuator || token.value !== value) {
            throwUnexpected(token);
        }
    }

    // Return true if the next token matches the specified punctuator.

    function match(value) {
        return lookahead.type === Token.Punctuator && lookahead.value === value;
    }

    // Return true if the next token matches the specified keyword

    function matchKeyword(keyword) {
        return lookahead.type === Token.Keyword && lookahead.value === keyword;
    }

    function consumeSemicolon() {
        // Catch the very common case first: immediately a semicolon (char #59).
        if (source.charCodeAt(index) === 59) {
            lex();
            return;
        }

        skipWhitespace();

        if (match(';')) {
            lex();
            return;
        }

        if (lookahead.type !== Token.EOF && !match('}')) {
            throwUnexpected(lookahead);
        }
    }

    // 11.1.4 Array Initialiser

    function parseArrayInitialiser() {
        var elements = [];

        expect('[');

        while (!match(']')) {
            if (match(',')) {
                lex();
                elements.push(null);
            } else {
                elements.push(parseExpression());

                if (!match(']')) {
                    expect(',');
                }
            }
        }

        expect(']');

        return delegate.createArrayExpression(elements);
    }

    // 11.1.5 Object Initialiser

    function parseObjectPropertyKey() {
        var token;

        skipWhitespace();
        token = lex();

        // Note: This function is called only from parseObjectProperty(), where
        // EOF and Punctuator tokens are already filtered out.
        if (token.type === Token.StringLiteral || token.type === Token.NumericLiteral) {
            return delegate.createLiteral(token);
        }

        return delegate.createIdentifier(token.value);
    }

    function parseObjectProperty() {
        var token, key;

        token = lookahead;
        skipWhitespace();

        if (token.type === Token.EOF || token.type === Token.Punctuator) {
            throwUnexpected(token);
        }

        key = parseObjectPropertyKey();
        expect(':');
        return delegate.createProperty('init', key, parseExpression());
    }

    function parseObjectInitialiser() {
        var properties = [];

        expect('{');

        while (!match('}')) {
            properties.push(parseObjectProperty());

            if (!match('}')) {
                expect(',');
            }
        }

        expect('}');

        return delegate.createObjectExpression(properties);
    }

    // 11.1.6 The Grouping Operator

    function parseGroupExpression() {
        var expr;

        expect('(');

        expr = parseExpression();

        expect(')');

        return expr;
    }


    // 11.1 Primary Expressions

    function parsePrimaryExpression() {
        var type, token, expr;

        if (match('(')) {
            return parseGroupExpression();
        }

        type = lookahead.type;

        if (type === Token.Identifier) {
            expr = delegate.createIdentifier(lex().value);
        } else if (type === Token.StringLiteral || type === Token.NumericLiteral) {
            expr = delegate.createLiteral(lex());
        } else if (type === Token.Keyword) {
            if (matchKeyword('this')) {
                lex();
                expr = delegate.createThisExpression();
            }
        } else if (type === Token.BooleanLiteral) {
            token = lex();
            token.value = (token.value === 'true');
            expr = delegate.createLiteral(token);
        } else if (type === Token.NullLiteral) {
            token = lex();
            token.value = null;
            expr = delegate.createLiteral(token);
        } else if (match('[')) {
            expr = parseArrayInitialiser();
        } else if (match('{')) {
            expr = parseObjectInitialiser();
        }

        if (expr) {
            return expr;
        }

        throwUnexpected(lex());
    }

    // 11.2 Left-Hand-Side Expressions

    function parseArguments() {
        var args = [];

        expect('(');

        if (!match(')')) {
            while (index < length) {
                args.push(parseExpression());
                if (match(')')) {
                    break;
                }
                expect(',');
            }
        }

        expect(')');

        return args;
    }

    function parseNonComputedProperty() {
        var token;

        token = lex();

        if (!isIdentifierName(token)) {
            throwUnexpected(token);
        }

        return delegate.createIdentifier(token.value);
    }

    function parseNonComputedMember() {
        expect('.');

        return parseNonComputedProperty();
    }

    function parseComputedMember() {
        var expr;

        expect('[');

        expr = parseExpression();

        expect(']');

        return expr;
    }

    function parseLeftHandSideExpression() {
        var expr, args, property;

        expr = parsePrimaryExpression();

        while (true) {
            if (match('[')) {
                property = parseComputedMember();
                expr = delegate.createMemberExpression('[', expr, property);
            } else if (match('.')) {
                property = parseNonComputedMember();
                expr = delegate.createMemberExpression('.', expr, property);
            } else if (match('(')) {
                args = parseArguments();
                expr = delegate.createCallExpression(expr, args);
            } else {
                break;
            }
        }

        return expr;
    }

    // 11.3 Postfix Expressions

    var parsePostfixExpression = parseLeftHandSideExpression;

    // 11.4 Unary Operators

    function parseUnaryExpression() {
        var token, expr;

        if (lookahead.type !== Token.Punctuator && lookahead.type !== Token.Keyword) {
            expr = parsePostfixExpression();
        } else if (match('+') || match('-') || match('!')) {
            token = lex();
            expr = parseUnaryExpression();
            expr = delegate.createUnaryExpression(token.value, expr);
        } else if (matchKeyword('delete') || matchKeyword('void') || matchKeyword('typeof')) {
            throwError({}, Messages.UnexpectedToken);
        } else {
            expr = parsePostfixExpression();
        }

        return expr;
    }

    function binaryPrecedence(token) {
        var prec = 0;

        if (token.type !== Token.Punctuator && token.type !== Token.Keyword) {
            return 0;
        }

        switch (token.value) {
            case '||':
                prec = 1;
                break;

            case '&&':
                prec = 2;
                break;

            case '==':
            case '!=':
            case '===':
            case '!==':
                prec = 6;
                break;

            case '<':
            case '>':
            case '<=':
            case '>=':
            case 'instanceof':
                prec = 7;
                break;

            case 'in':
                prec = 7;
                break;

            case '+':
            case '-':
                prec = 9;
                break;

            case '*':
            case '/':
            case '%':
                prec = 11;
                break;

            default:
                break;
        }

        return prec;
    }

    // 11.5 Multiplicative Operators
    // 11.6 Additive Operators
    // 11.7 Bitwise Shift Operators
    // 11.8 Relational Operators
    // 11.9 Equality Operators
    // 11.10 Binary Bitwise Operators
    // 11.11 Binary Logical Operators

    function parseBinaryExpression() {
        var expr, token, prec, stack, right, operator, left, i;

        left = parseUnaryExpression();

        token = lookahead;
        prec = binaryPrecedence(token);
        if (prec === 0) {
            return left;
        }
        token.prec = prec;
        lex();

        right = parseUnaryExpression();

        stack = [left, token, right];

        while ((prec = binaryPrecedence(lookahead)) > 0) {

            // Reduce: make a binary expression from the three topmost entries.
            while ((stack.length > 2) && (prec <= stack[stack.length - 2].prec)) {
                right = stack.pop();
                operator = stack.pop().value;
                left = stack.pop();
                expr = delegate.createBinaryExpression(operator, left, right);
                stack.push(expr);
            }

            // Shift.
            token = lex();
            token.prec = prec;
            stack.push(token);
            expr = parseUnaryExpression();
            stack.push(expr);
        }

        // Final reduce to clean-up the stack.
        i = stack.length - 1;
        expr = stack[i];
        while (i > 1) {
            expr = delegate.createBinaryExpression(stack[i - 1].value, stack[i - 2], expr);
            i -= 2;
        }

        return expr;
    }


    // 11.12 Conditional Operator

    function parseConditionalExpression() {
        var expr, consequent, alternate;

        expr = parseBinaryExpression();

        if (match('?')) {
            lex();
            consequent = parseConditionalExpression();
            expect(':');
            alternate = parseConditionalExpression();

            expr = delegate.createConditionalExpression(expr, consequent, alternate);
        }

        return expr;
    }

    // Simplification since we do not support AssignmentExpression.
    var parseExpression = parseConditionalExpression;

    // Polymer Syntax extensions

    // Filter ::
    //   Identifier
    //   Identifier "(" ")"
    //   Identifier "(" FilterArguments ")"

    function parseFilter() {
        var identifier, args;

        identifier = lex();

        if (identifier.type !== Token.Identifier) {
            throwUnexpected(identifier);
        }

        args = match('(') ? parseArguments() : [];

        return delegate.createFilter(identifier.value, args);
    }

    // Filters ::
    //   "|" Filter
    //   Filters "|" Filter

    function parseFilters() {
        while (match('|')) {
            lex();
            parseFilter();
        }
    }

    // TopLevel ::
    //   LabelledExpressions
    //   AsExpression
    //   InExpression
    //   FilterExpression

    // AsExpression ::
    //   FilterExpression as Identifier

    // InExpression ::
    //   Identifier, Identifier in FilterExpression
    //   Identifier in FilterExpression

    // FilterExpression ::
    //   Expression
    //   Expression Filters

    function parseTopLevel() {
        skipWhitespace();
        peek();

        var expr = parseExpression();
        if (expr) {
            if (lookahead.value === ',' || lookahead.value == 'in' &&
                       expr.type === Syntax.Identifier) {
                parseInExpression(expr);
            } else {
                parseFilters();
                if (lookahead.value === 'as') {
                    parseAsExpression(expr);
                } else {
                    delegate.createTopLevel(expr);
                }
            }
        }

        if (lookahead.type !== Token.EOF) {
            throwUnexpected(lookahead);
        }
    }

    function parseAsExpression(expr) {
        lex();  // as
        var identifier = lex().value;
        delegate.createAsExpression(expr, identifier);
    }

    function parseInExpression(identifier) {
        var indexName;
        if (lookahead.value === ',') {
            lex();
            if (lookahead.type !== Token.Identifier)
                throwUnexpected(lookahead);
            indexName = lex().value;
        }

        lex();  // in
        var expr = parseExpression();
        parseFilters();
        delegate.createInExpression(identifier.name, indexName, expr);
    }

    function parse(code, inDelegate) {
        delegate = inDelegate;
        source = code;
        index = 0;
        length = source.length;
        lookahead = null;
        state = {
            labelSet: {}
        };

        return parseTopLevel();
    }

    global.esprima = {
        parse: parse
    };
})(module.exports);

/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/polymer-expressions/path-parser.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/*
 * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */



function detectEval() {
    // Don't test for eval if we're running in a Chrome App environment.
    // We check for APIs set that only exist in a Chrome App context.
    if (typeof chrome !== 'undefined' && chrome.app && chrome.app.runtime) {
        return false;
    }

    // Firefox OS Apps do not allow eval. This feature detection is very hacky
    // but even if some other platform adds support for this function this code
    // will continue to work.
    if (typeof navigator != 'undefined' && navigator.getDeviceStorage) {
        return false;
    }

    try {
        var f = new Function('', 'return true;');
        return f();
    } catch (ex) {
        return false;
    }
}

var hasEval = detectEval();

function isIndex(s) {
    return +s === s >>> 0 && s !== '';
}

function toNumber(s) {
    return +s;
}

function isObject(obj) {
    return obj === Object(obj);
}

var numberIsNaN = Number.isNaN || function (value) {
    return typeof value === 'number' && isNaN(value);
}

function areSameValue(left, right) {
    if (left === right)
        return left !== 0 || 1 / left === 1 / right;
    if (numberIsNaN(left) && numberIsNaN(right))
        return true;

    return left !== left && right !== right;
}

var createObject = ('__proto__' in {}) ?
  function (obj) { return obj; } :
  function (obj) {
      var proto = obj.__proto__;
      if (!proto)
          return obj;
      var newObject = Object.create(proto);
      Object.getOwnPropertyNames(obj).forEach(function (name) {
          Object.defineProperty(newObject, name,
                               Object.getOwnPropertyDescriptor(obj, name));
      });
      return newObject;
  };

var identStart = '[\$_a-zA-Z]';
var identPart = '[\$_a-zA-Z0-9]';
var identRegExp = new RegExp('^' + identStart + '+' + identPart + '*' + '$');

function getPathCharType(char) {
    if (char === undefined)
        return 'eof';

    var code = char.charCodeAt(0);

    switch (code) {
        case 0x5B: // [
        case 0x5D: // ]
        case 0x2E: // .
        case 0x22: // "
        case 0x27: // '
        case 0x30: // 0
            return char;

        case 0x5F: // _
        case 0x24: // $
            return 'ident';

        case 0x20: // Space
        case 0x09: // Tab
        case 0x0A: // Newline
        case 0x0D: // Return
        case 0xA0:  // No-break space
        case 0xFEFF:  // Byte Order Mark
        case 0x2028:  // Line Separator
        case 0x2029:  // Paragraph Separator
            return 'ws';
    }

    // a-z, A-Z
    if ((0x61 <= code && code <= 0x7A) || (0x41 <= code && code <= 0x5A))
        return 'ident';

    // 1-9
    if (0x31 <= code && code <= 0x39)
        return 'number';

    return 'else';
}

var pathStateMachine = {
    'beforePath': {
        'ws': ['beforePath'],
        'ident': ['inIdent', 'append'],
        '[': ['beforeElement'],
        'eof': ['afterPath']
    },

    'inPath': {
        'ws': ['inPath'],
        '.': ['beforeIdent'],
        '[': ['beforeElement'],
        'eof': ['afterPath']
    },

    'beforeIdent': {
        'ws': ['beforeIdent'],
        'ident': ['inIdent', 'append']
    },

    'inIdent': {
        'ident': ['inIdent', 'append'],
        '0': ['inIdent', 'append'],
        'number': ['inIdent', 'append'],
        'ws': ['inPath', 'push'],
        '.': ['beforeIdent', 'push'],
        '[': ['beforeElement', 'push'],
        'eof': ['afterPath', 'push']
    },

    'beforeElement': {
        'ws': ['beforeElement'],
        '0': ['afterZero', 'append'],
        'number': ['inIndex', 'append'],
        "'": ['inSingleQuote', 'append', ''],
        '"': ['inDoubleQuote', 'append', '']
    },

    'afterZero': {
        'ws': ['afterElement', 'push'],
        ']': ['inPath', 'push']
    },

    'inIndex': {
        '0': ['inIndex', 'append'],
        'number': ['inIndex', 'append'],
        'ws': ['afterElement'],
        ']': ['inPath', 'push']
    },

    'inSingleQuote': {
        "'": ['afterElement'],
        'eof': ['error'],
        'else': ['inSingleQuote', 'append']
    },

    'inDoubleQuote': {
        '"': ['afterElement'],
        'eof': ['error'],
        'else': ['inDoubleQuote', 'append']
    },

    'afterElement': {
        'ws': ['afterElement'],
        ']': ['inPath', 'push']
    }
}

function noop() { }

function parsePath(path) {
    var keys = [];
    var index = -1;
    var c, newChar, key, type, transition, action, typeMap, mode = 'beforePath';

    var actions = {
        push: function () {
            if (key === undefined)
                return;

            keys.push(key);
            key = undefined;
        },

        append: function () {
            if (key === undefined)
                key = newChar
            else
                key += newChar;
        }
    };

    function maybeUnescapeQuote() {
        if (index >= path.length)
            return;

        var nextChar = path[index + 1];
        if ((mode == 'inSingleQuote' && nextChar == "'") ||
            (mode == 'inDoubleQuote' && nextChar == '"')) {
            index++;
            newChar = nextChar;
            actions.append();
            return true;
        }
    }

    while (mode) {
        index++;
        c = path[index];

        if (c == '\\' && maybeUnescapeQuote(mode))
            continue;

        type = getPathCharType(c);
        typeMap = pathStateMachine[mode];
        transition = typeMap[type] || typeMap['else'] || 'error';

        if (transition == 'error')
            return; // parse error;

        mode = transition[0];
        action = actions[transition[1]] || noop;
        newChar = transition[2] === undefined ? c : transition[2];
        action();

        if (mode === 'afterPath') {
            return keys;
        }
    }

    return; // parse error
}

function isIdent(s) {
    return identRegExp.test(s);
}

var constructorIsPrivate = {};

function Path(parts, privateToken) {
    if (privateToken !== constructorIsPrivate)
        throw Error('Use Path.get to retrieve path objects');

    for (var i = 0; i < parts.length; i++) {
        this.push(String(parts[i]));
    }

    if (hasEval && this.length) {
        this.getValueFrom = this.compiledGetValueFromFn();
    }
}

// TODO(rafaelw): Make simple LRU cache
var pathCache = {};

function getPath(pathString) {
    if (pathString instanceof Path)
        return pathString;

    if (pathString == null || pathString.length == 0)
        pathString = '';

    if (typeof pathString != 'string') {
        if (isIndex(pathString.length)) {
            // Constructed with array-like (pre-parsed) keys
            return new Path(pathString, constructorIsPrivate);
        }

        pathString = String(pathString);
    }

    var path = pathCache[pathString];
    if (path)
        return path;

    var parts = parsePath(pathString);
    if (!parts)
        return invalidPath;

    var path = new Path(parts, constructorIsPrivate);
    pathCache[pathString] = path;
    return path;
}

Path.get = getPath;

function formatAccessor(key) {
    if (isIndex(key)) {
        return '[' + key + ']';
    } else {
        return '["' + key.replace(/"/g, '\\"') + '"]';
    }
}

Path.prototype = createObject({
    __proto__: [],
    valid: true,

    toString: function () {
        var pathString = '';
        for (var i = 0; i < this.length; i++) {
            var key = this[i];
            if (isIdent(key)) {
                pathString += i ? '.' + key : key;
            } else {
                pathString += formatAccessor(key);
            }
        }

        return pathString;
    },

    getValueFrom: function (obj, directObserver) {
        for (var i = 0; i < this.length; i++) {
            if (obj == null)
                return;
            obj = obj[this[i]];
        }
        return obj;
    },

    iterateObjects: function (obj, observe) {
        for (var i = 0; i < this.length; i++) {
            if (i)
                obj = obj[this[i - 1]];
            if (!isObject(obj))
                return;
            observe(obj, this[i]);
        }
    },

    compiledGetValueFromFn: function () {
        var str = '';
        var pathString = 'obj';
        str += 'if (obj != null';
        var i = 0;
        var key;
        for (; i < (this.length - 1) ; i++) {
            key = this[i];
            pathString += isIdent(key) ? '.' + key : formatAccessor(key);
            str += ' &&\n     ' + pathString + ' != null';
        }
        str += ')\n';

        var key = this[i];
        pathString += isIdent(key) ? '.' + key : formatAccessor(key);

        str += '  return ' + pathString + ';\nelse\n  return undefined;';
        return new Function('obj', str);
    },

    setValueFrom: function (obj, value) {
        if (!this.length)
            return false;

        for (var i = 0; i < this.length - 1; i++) {
            if (!isObject(obj))
                return false;
            obj = obj[this[i]];
        }

        if (!isObject(obj))
            return false;

        obj[this[i]] = value;
        return true;
    }
});

var invalidPath = new Path('', constructorIsPrivate);
invalidPath.valid = false;
invalidPath.getValueFrom = invalidPath.setValueFrom = function () { };

exports.Path = Path;


/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/polymer-expressions/polymer-expressions.js":
/***/ (function(module, exports, __webpack_require__) {

// Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
// This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
// The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
// The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
// Code distributed by Google as part of the polymer project is also
// subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt

var esprima = __webpack_require__("../node_modules/tns-core-modules/js-libs/esprima/esprima.js").esprima;
var Path = __webpack_require__("../node_modules/tns-core-modules/js-libs/polymer-expressions/path-parser.js").Path;

(function (global) {
    'use strict';

    // TODO(rafaelw): Implement simple LRU.
    var expressionParseCache = Object.create(null);

    function getExpression(expressionText) {
        var expression = expressionParseCache[expressionText];
        if (!expression) {
            var delegate = new ASTDelegate();
            esprima.parse(expressionText, delegate);
            expression = new Expression(delegate);
            expressionParseCache[expressionText] = expression;
        }
        return expression;
    }

    function Literal(value) {
        this.value = value;
        this.valueFn_ = undefined;
    }

    Literal.prototype = {
        valueFn: function () {
            if (!this.valueFn_) {
                var value = this.value;
                this.valueFn_ = function () {
                    return value;
                }
            }

            return this.valueFn_;
        }
    }

    function IdentPath(name) {
        this.name = name;
        this.path = Path.get(name);
    }

    IdentPath.prototype = {
        valueFn: function () {
            if (!this.valueFn_) {
                var name = this.name;
                var path = this.path;
                this.valueFn_ = function (model, observer, changedModel) {
                    if (observer)
                        observer.addPath(model, path);

                    if (changedModel) {
                        var result = path.getValueFrom(changedModel);
                        if (result !== undefined) {
                            return result;
                        }
                    }

                    return path.getValueFrom(model);
                }
            }

            return this.valueFn_;
        },

        setValue: function (model, newValue) {
            if (this.path.length == 1) {
                model = findScope(model, this.path[0]);
            }

            return this.path.setValueFrom(model, newValue);
        }
    };

    function MemberExpression(object, property, accessor) {
        this.computed = accessor == '[';

        this.dynamicDeps = typeof object == 'function' ||
                           object.dynamicDeps ||
                           (this.computed && !(property instanceof Literal));

        this.simplePath =
            !this.dynamicDeps &&
            (property instanceof IdentPath || property instanceof Literal) &&
            (object instanceof MemberExpression || object instanceof IdentPath);

        this.object = this.simplePath ? object : getFn(object);
        this.property = !this.computed || this.simplePath ?
            property : getFn(property);
    }

    MemberExpression.prototype = {
        get fullPath() {
            if (!this.fullPath_) {

                var parts = this.object instanceof MemberExpression ?
                    this.object.fullPath.slice() : [this.object.name];
                parts.push(this.property instanceof IdentPath ?
                    this.property.name : this.property.value);
                this.fullPath_ = Path.get(parts);
            }

            return this.fullPath_;
        },

        valueFn: function () {
            if (!this.valueFn_) {
                var object = this.object;

                if (this.simplePath) {
                    var path = this.fullPath;

                    this.valueFn_ = function (model, observer) {
                        if (observer)
                            observer.addPath(model, path);

                        return path.getValueFrom(model);
                    };
                } else if (!this.computed) {
                    var path = Path.get(this.property.name);

                    this.valueFn_ = function (model, observer, filterRegistry) {
                        var context = object(model, observer, filterRegistry);

                        if (observer)
                            observer.addPath(context, path);

                        return path.getValueFrom(context);
                    }
                } else {
                    // Computed property.
                    var property = this.property;

                    this.valueFn_ = function (model, observer, filterRegistry) {
                        var context = object(model, observer, filterRegistry);
                        var propName = property(model, observer, filterRegistry);
                        if (observer)
                            observer.addPath(context, [propName]);

                        return context ? context[propName] : undefined;
                    };
                }
            }
            return this.valueFn_;
        },

        setValue: function (model, newValue) {
            if (this.simplePath) {
                this.fullPath.setValueFrom(model, newValue);
                return newValue;
            }

            var object = this.object(model);
            var propName = this.property instanceof IdentPath ? this.property.name :
                this.property(model);
            return object[propName] = newValue;
        }
    };

    function Filter(name, args) {
        this.name = name;
        this.args = [];
        for (var i = 0; i < args.length; i++) {
            this.args[i] = getFn(args[i]);
        }
    }

    Filter.prototype = {
        transform: function (model, observer, filterRegistry, toModelDirection,
                            initialArgs) {
            var fn = filterRegistry[this.name];
            var context = model;
            if (fn) {
                context = undefined;
            } else {
                fn = context[this.name];
                if (!fn) {
                    console.error('Cannot find function or filter: ' + this.name);
                    return;
                }
            }

            // If toModelDirection is falsey, then the "normal" (dom-bound) direction
            // is used. Otherwise, it looks for a 'toModel' property function on the
            // object.
            if (toModelDirection) {
                fn = fn.toModel;
            } else if (typeof fn.toView == 'function') {
                fn = fn.toView;
            }

            if (typeof fn != 'function') {
                console.error('Cannot find function or filter: ' + this.name);
                return;
            }

            var args = initialArgs || [];
            for (var i = 0; i < this.args.length; i++) {
                args.push(getFn(this.args[i])(model, observer, filterRegistry));
            }

            return fn.apply(context, args);
        }
    };

    function notImplemented() { throw Error('Not Implemented'); }

    var unaryOperators = {
        '+': function (v) { return +v; },
        '-': function (v) { return -v; },
        '!': function (v) { return !v; }
    };

    var binaryOperators = {
        '+': function (l, r) { return l + r; },
        '-': function (l, r) { return l - r; },
        '*': function (l, r) { return l * r; },
        '/': function (l, r) { return l / r; },
        '%': function (l, r) { return l % r; },
        '<': function (l, r) { return l < r; },
        '>': function (l, r) { return l > r; },
        '<=': function (l, r) { return l <= r; },
        '>=': function (l, r) { return l >= r; },
        '==': function (l, r) { return l == r; },
        '!=': function (l, r) { return l != r; },
        '===': function (l, r) { return l === r; },
        '!==': function (l, r) { return l !== r; },
        '&&': function (l, r) { return l && r; },
        '||': function (l, r) { return l || r; },
    };

    function getFn(arg) {
        return typeof arg == 'function' ? arg : arg.valueFn();
    }

    function ASTDelegate() {
        this.expression = null;
        this.filters = [];
        this.deps = {};
        this.currentPath = undefined;
        this.scopeIdent = undefined;
        this.indexIdent = undefined;
        this.dynamicDeps = false;
    }

    ASTDelegate.prototype = {
        createUnaryExpression: function (op, argument) {
            if (!unaryOperators[op])
                throw Error('Disallowed operator: ' + op);

            argument = getFn(argument);

            return function (model, observer, filterRegistry) {
                return unaryOperators[op](argument(model, observer, filterRegistry));
            };
        },

        createBinaryExpression: function (op, left, right) {
            if (!binaryOperators[op])
                throw Error('Disallowed operator: ' + op);

            left = getFn(left);
            right = getFn(right);

            switch (op) {
                case '||':
                    this.dynamicDeps = true;
                    return function (model, observer, filterRegistry) {
                        return left(model, observer, filterRegistry) ||
                            right(model, observer, filterRegistry);
                    };
                case '&&':
                    this.dynamicDeps = true;
                    return function (model, observer, filterRegistry) {
                        return left(model, observer, filterRegistry) &&
                            right(model, observer, filterRegistry);
                    };
            }

            return function (model, observer, filterRegistry) {
                return binaryOperators[op](left(model, observer, filterRegistry),
                                           right(model, observer, filterRegistry));
            };
        },

        createConditionalExpression: function (test, consequent, alternate) {
            test = getFn(test);
            consequent = getFn(consequent);
            alternate = getFn(alternate);

            this.dynamicDeps = true;

            return function (model, observer, filterRegistry) {
                return test(model, observer, filterRegistry) ?
                    consequent(model, observer, filterRegistry) :
                    alternate(model, observer, filterRegistry);
            }
        },

        createIdentifier: function (name) {
            var ident = new IdentPath(name);
            ident.type = 'Identifier';
            return ident;
        },

        createMemberExpression: function (accessor, object, property) {
            var ex = new MemberExpression(object, property, accessor);
            if (ex.dynamicDeps)
                this.dynamicDeps = true;
            return ex;
        },

        createCallExpression: function (expression, args) {
            if (!(expression instanceof IdentPath))
                throw Error('Only identifier function invocations are allowed');

            var filter = new Filter(expression.name, args);

            return function (model, observer, filterRegistry) {
                return filter.transform(model, observer, filterRegistry, false);
            };
        },

        createLiteral: function (token) {
            return new Literal(token.value);
        },

        createArrayExpression: function (elements) {
            for (var i = 0; i < elements.length; i++)
                elements[i] = getFn(elements[i]);

            return function (model, observer, filterRegistry) {
                var arr = []
                for (var i = 0; i < elements.length; i++)
                    arr.push(elements[i](model, observer, filterRegistry));
                return arr;
            }
        },

        createProperty: function (kind, key, value) {
            return {
                key: key instanceof IdentPath ? key.name : key.value,
                value: value
            };
        },

        createObjectExpression: function (properties) {
            for (var i = 0; i < properties.length; i++)
                properties[i].value = getFn(properties[i].value);

            return function (model, observer, filterRegistry) {
                var obj = {};
                for (var i = 0; i < properties.length; i++)
                    obj[properties[i].key] =
                        properties[i].value(model, observer, filterRegistry);
                return obj;
            }
        },

        createFilter: function (name, args) {
            this.filters.push(new Filter(name, args));
        },

        createAsExpression: function (expression, scopeIdent) {
            this.expression = expression;
            this.scopeIdent = scopeIdent;
        },

        createInExpression: function (scopeIdent, indexIdent, expression) {
            this.expression = expression;
            this.scopeIdent = scopeIdent;
            this.indexIdent = indexIdent;
        },

        createTopLevel: function (expression) {
            this.expression = expression;
        },

        createThisExpression: notImplemented
    }

    function Expression(delegate) {
        this.scopeIdent = delegate.scopeIdent;
        this.indexIdent = delegate.indexIdent;

        if (!delegate.expression)
            throw Error('No expression found.');

        this.expression = delegate.expression;
        getFn(this.expression); // forces enumeration of path dependencies

        this.filters = delegate.filters;
        this.dynamicDeps = delegate.dynamicDeps;
    }

    Expression.prototype = {
        getValue: function (model, isBackConvert, changedModel, observer) {
            var value = getFn(this.expression)(model.context, observer, changedModel);
            for (var i = 0; i < this.filters.length; i++) {
                value = this.filters[i].transform(model.context, observer, model.context, isBackConvert, [value]);
            }

            return value;
        },

        setValue: function (model, newValue, filterRegistry) {
            var count = this.filters ? this.filters.length : 0;
            while (count-- > 0) {
                newValue = this.filters[count].transform(model, undefined,
                    filterRegistry, true, [newValue]);
            }

            if (this.expression.setValue)
                return this.expression.setValue(model, newValue);
        }
    }

    /**
     * Converts a style property name to a css property name. For example:
     * "WebkitUserSelect" to "-webkit-user-select"
     */
    function convertStylePropertyName(name) {
        return String(name).replace(/[A-Z]/g, function (c) {
            return '-' + c.toLowerCase();
        });
    }

    var parentScopeName = '@' + Math.random().toString(36).slice(2);

    // Single ident paths must bind directly to the appropriate scope object.
    // I.e. Pushed values in two-bindings need to be assigned to the actual model
    // object.
    function findScope(model, prop) {
        while (model[parentScopeName] &&
               !Object.prototype.hasOwnProperty.call(model, prop)) {
            model = model[parentScopeName];
        }

        return model;
    }

    function isLiteralExpression(pathString) {
        switch (pathString) {
            case '':
                return false;

            case 'false':
            case 'null':
            case 'true':
                return true;
        }

        if (!isNaN(Number(pathString)))
            return true;

        return false;
    };

    function PolymerExpressions() { }

    PolymerExpressions.prototype = {
        // "built-in" filters
        styleObject: function (value) {
            var parts = [];
            for (var key in value) {
                parts.push(convertStylePropertyName(key) + ': ' + value[key]);
            }
            return parts.join('; ');
        },

        tokenList: function (value) {
            var tokens = [];
            for (var key in value) {
                if (value[key])
                    tokens.push(key);
            }
            return tokens.join(' ');
        },

        // binding delegate API
        prepareInstancePositionChanged: function (template) {
            var indexIdent = template.polymerExpressionIndexIdent_;
            if (!indexIdent)
                return;

            return function (templateInstance, index) {
                templateInstance.model[indexIdent] = index;
            };
        },

        prepareInstanceModel: function (template) {
            var scopeName = template.polymerExpressionScopeIdent_;
            if (!scopeName)
                return;

            var parentScope = template.templateInstance ?
                template.templateInstance.model :
                template.model;

            var indexName = template.polymerExpressionIndexIdent_;

            return function (model) {
                return createScopeObject(parentScope, model, scopeName, indexName);
            };
        }
    };

    var createScopeObject = ('__proto__' in {}) ?
      function (parentScope, model, scopeName, indexName) {
          var scope = {};
          scope[scopeName] = model;
          scope[indexName] = undefined;
          scope[parentScopeName] = parentScope;
          scope.__proto__ = parentScope;
          return scope;
      } :
      function (parentScope, model, scopeName, indexName) {
          var scope = Object.create(parentScope);
          Object.defineProperty(scope, scopeName,
              { value: model, configurable: true, writable: true });
          Object.defineProperty(scope, indexName,
              { value: undefined, configurable: true, writable: true });
          Object.defineProperty(scope, parentScopeName,
              { value: parentScope, configurable: true, writable: true });
          return scope;
      };

    global.PolymerExpressions = PolymerExpressions;
    PolymerExpressions.getExpression = getExpression;
})(module.exports);

/***/ }),

/***/ "../node_modules/tns-core-modules/matrix/matrix.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var number_utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/number-utils.js");
exports.getTransformMatrix = function (_a) {
    var property = _a.property, value = _a.value;
    return TRANSFORM_MATRIXES[property](value);
};
var TRANSFORM_MATRIXES = {
    "scale": function (_a) {
        var x = _a.x, y = _a.y;
        return [
            x, 0, 0,
            0, y, 0,
            0, 0, 1,
        ];
    },
    "translate": function (_a) {
        var x = _a.x, y = _a.y;
        return [
            1, 0, x,
            0, 1, y,
            0, 0, 1,
        ];
    },
    "rotate": function (angleInDeg) {
        var angleInRad = number_utils_1.degreesToRadians(angleInDeg);
        return [
            Math.cos(angleInRad), -Math.sin(angleInRad), 0,
            Math.sin(angleInRad), Math.cos(angleInRad), 0,
            0, 0, 1,
        ];
    },
};
exports.matrixArrayToCssMatrix = function (m) { return [
    m[0], m[3], m[1],
    m[4], m[2], m[5],
]; };
function multiplyAffine2d(m1, m2) {
    return [
        m1[0] * m2[0] + m1[1] * m2[3],
        m1[0] * m2[1] + m1[1] * m2[4],
        m1[0] * m2[2] + m1[1] * m2[5] + m1[2],
        m1[3] * m2[0] + m1[4] * m2[3],
        m1[3] * m2[1] + m1[4] * m2[4],
        m1[3] * m2[2] + m1[4] * m2[5] + m1[5]
    ];
}
exports.multiplyAffine2d = multiplyAffine2d;
function decompose2DTransformMatrix(matrix) {
    verifyTransformMatrix(matrix);
    var _a = __spreadArrays(matrix), A = _a[0], B = _a[1], C = _a[2], D = _a[3], E = _a[4], F = _a[5];
    var determinant = A * D - B * C;
    var translate = { x: E || 0, y: F || 0 };
    var rotate = 0;
    var scale = { x: 1, y: 1 };
    if (A || B) {
        var R = Math.sqrt(A * A + B * B);
        rotate = B > 0 ? Math.acos(A / R) : -Math.acos(A / R);
        scale = { x: R, y: determinant / R };
    }
    else if (C || D) {
        var R = Math.sqrt(C * C + D * D);
        rotate = Math.PI / 2 - (D > 0 ? Math.acos(-C / R) : -Math.acos(C / R));
        scale = { x: determinant / R, y: R };
    }
    rotate = number_utils_1.radiansToDegrees(rotate);
    return { translate: translate, rotate: rotate, scale: scale };
}
exports.decompose2DTransformMatrix = decompose2DTransformMatrix;
function verifyTransformMatrix(matrix) {
    if (matrix.length < 6) {
        throw new Error("Transform matrix should be 2x3.");
    }
}
//# sourceMappingURL=matrix.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var appCommonModule = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var qualifier_matcher_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/qualifier-matcher/qualifier-matcher.js");
var non_bundle_workflow_compat_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/non-bundle-workflow-compat.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var ModuleNameResolver = (function () {
    function ModuleNameResolver(context, moduleListProvider) {
        if (moduleListProvider === void 0) { moduleListProvider = global.getRegisteredModules; }
        this.context = context;
        this.moduleListProvider = moduleListProvider;
        this._cache = {};
    }
    ModuleNameResolver.prototype.resolveModuleName = function (path, ext) {
        var key = path + ext;
        var result = this._cache[key];
        if (result === undefined) {
            result = this.resolveModuleNameImpl(path, ext);
            this._cache[key] = result;
        }
        if (trace_1.isEnabled()) {
            trace_1.write("path: '" + path + "' with ext: '" + ext + "' resolved: '" + result + "'", trace_1.categories.ModuleNameResolver);
        }
        return result;
    };
    ModuleNameResolver.prototype.clearCache = function () {
        this._cache = {};
    };
    ModuleNameResolver.prototype.resolveModuleNameImpl = function (path, ext) {
        var result = null;
        ext = ext ? "." + ext : "";
        if (false) {}
        var candidates = this.getCandidates(path, ext);
        result = qualifier_matcher_1.findMatch(path, ext, candidates, this.context);
        return result;
    };
    ModuleNameResolver.prototype.getCandidates = function (path, ext) {
        var candidates = this.moduleListProvider()
            .filter(function (moduleName) { return moduleName.startsWith(path) && (!ext || moduleName.endsWith(ext)); });
        return candidates;
    };
    return ModuleNameResolver;
}());
exports.ModuleNameResolver = ModuleNameResolver;
var resolverInstance;
function resolveModuleName(path, ext) {
    if (global.__snapshot) {
        return resolveModuleSnapshot(path, ext);
    }
    if (!resolverInstance) {
        resolverInstance = new ModuleNameResolver({
            width: platform_1.screen.mainScreen.widthDIPs,
            height: platform_1.screen.mainScreen.heightDIPs,
            os: platform_1.device.os,
            deviceType: platform_1.device.deviceType
        });
    }
    return resolverInstance.resolveModuleName(path, ext);
}
exports.resolveModuleName = resolveModuleName;
function resolveModuleSnapshot(path, ext) {
    trace_1.write("Resolving module in SNAPSHOT context - path: '" + path + "' with ext: '" + ext + "'", trace_1.categories.ModuleNameResolver);
    return new ModuleNameResolver({
        width: 400,
        height: 800,
        os: "Android",
        deviceType: "Phone"
    }).resolveModuleName(path, ext);
}
function clearCache() {
    if (resolverInstance) {
        resolverInstance.clearCache();
    }
}
exports.clearCache = clearCache;
function _setResolver(resolver) {
    resolverInstance = resolver;
}
exports._setResolver = _setResolver;
appCommonModule.on("livesync", function (args) { return clearCache(); });
appCommonModule.on("orientationChanged", function (args) {
    resolverInstance = undefined;
});
//# sourceMappingURL=module-name-resolver.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/module-name-resolver/non-bundle-workflow-compat.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var appCommonModule = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var cache = new Set();
var initialized = false;
function register(name, loader) {
    if (trace_1.isEnabled()) {
        trace_1.write("[Compat] Register module: " + name, trace_1.categories.ModuleNameResolver);
    }
    global.registerModule(name, loader);
    if (name.startsWith("tns_modules")) {
        var nonTnsModulesName = name.substr("tns_modules".length + 1);
        if (trace_1.isEnabled()) {
            trace_1.write("[Compat] Register module: " + nonTnsModulesName, trace_1.categories.ModuleNameResolver);
        }
        global.registerModule(nonTnsModulesName, loader);
    }
}
function processFile(file) {
    var filePathRelativeToApp = file.path.substr(fs.knownFolders.currentApp().path.length + 1);
    var loadContent = function () { return file.readTextSync(); };
    switch (file.extension.toLocaleLowerCase()) {
        case ".js":
            var noExtPath = filePathRelativeToApp.substr(0, filePathRelativeToApp.length - ".js".length);
            register(filePathRelativeToApp, function () { return global.require(file.path); });
            register(noExtPath, function () { return global.require(file.path); });
            break;
        case ".css":
            register(filePathRelativeToApp, loadContent);
            break;
        case ".xml":
            register(filePathRelativeToApp, loadContent);
            break;
    }
    if (file.name === "package.json") {
        var json = global.require(file.path);
        if (json.main) {
            var name_1 = filePathRelativeToApp.substr(0, filePathRelativeToApp.length - "package.json".length - 1);
            var requirePath_1 = fs.path.join(file.parent.path, json.main);
            register(name_1, function () { return global.require(requirePath_1); });
        }
    }
}
function processFolder(path) {
    if (cache.has(path)) {
        return true;
    }
    cache.add(path);
    if (trace_1.isEnabled()) {
        trace_1.write("[Compat] Processing folder: " + path, trace_1.categories.ModuleNameResolver);
    }
    var folderEmpty = true;
    if (fs.Folder.exists(path)) {
        var folder = fs.Folder.fromPath(path);
        folder.eachEntity(function (file) {
            if (file instanceof fs.File) {
                processFile(file);
                folderEmpty = false;
            }
            return true;
        });
    }
    return !folderEmpty;
}
function registerModulesFromFileSystem(moduleName) {
    initialize();
    var folderProcessed = false;
    var parentFolderProcessed = false;
    var path = fs.path.join(fs.knownFolders.currentApp().path, moduleName);
    if (fs.Folder.exists(path)) {
        folderProcessed = processFolder(path);
    }
    var parentName = moduleName.substr(0, moduleName.lastIndexOf(fs.path.separator));
    var parentFolderPath = fs.path.join(fs.knownFolders.currentApp().path, parentName);
    if (fs.Folder.exists(parentFolderPath)) {
        parentFolderProcessed = processFolder(parentFolderPath);
    }
    if (folderProcessed || (parentFolderProcessed && parentName)) {
        return;
    }
    var tnsModulesPath = fs.path.join(fs.knownFolders.currentApp().path, "tns_modules", moduleName);
    if (fs.Folder.exists(tnsModulesPath)) {
        processFolder(tnsModulesPath);
    }
    if (parentName) {
        var tnsParentFolderPath = fs.path.join(fs.knownFolders.currentApp().path, "tns_modules", parentName);
        if (fs.Folder.exists(tnsParentFolderPath)) {
            processFolder(tnsParentFolderPath);
        }
    }
}
exports.registerModulesFromFileSystem = registerModulesFromFileSystem;
function initialize() {
    if (!initialized) {
        appCommonModule.on("livesync", function (args) { return cache.clear(); });
        initialized = true;
    }
}
//# sourceMappingURL=non-bundle-workflow-compat.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/module-name-resolver/qualifier-matcher/qualifier-matcher.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var MIN_WH = "minWH";
var MIN_W = "minW";
var MIN_H = "minH";
var PRIORITY_STEP = 10000;
var minWidthHeightQualifier = {
    isMatch: function (value) {
        return value.indexOf(MIN_WH) === 0;
    },
    getMatchValue: function (value, context) {
        var numVal = parseInt(value.substr(MIN_WH.length));
        if (isNaN(numVal)) {
            return -1;
        }
        var actualLength = Math.min(context.width, context.height);
        if (actualLength < numVal) {
            return -1;
        }
        return PRIORITY_STEP - (actualLength - numVal);
    }
};
var minWidthQualifier = {
    isMatch: function (value) {
        return value.indexOf(MIN_W) === 0 && value.indexOf(MIN_WH) < 0;
    },
    getMatchValue: function (value, context) {
        var numVal = parseInt(value.substr(MIN_W.length));
        if (isNaN(numVal)) {
            return -1;
        }
        var actualWidth = context.width;
        if (actualWidth < numVal) {
            return -1;
        }
        return PRIORITY_STEP - (actualWidth - numVal);
    }
};
var minHeightQualifier = {
    isMatch: function (value) {
        return value.indexOf(MIN_H) === 0 && value.indexOf(MIN_WH) < 0;
    },
    getMatchValue: function (value, context) {
        var numVal = parseInt(value.substr(MIN_H.length));
        if (isNaN(numVal)) {
            return -1;
        }
        var actualHeight = context.height;
        if (actualHeight < numVal) {
            return -1;
        }
        return PRIORITY_STEP - (actualHeight - numVal);
    }
};
var platformQualifier = {
    isMatch: function (value) {
        return value === "android" ||
            value === "ios";
    },
    getMatchValue: function (value, context) {
        return value === context.os.toLowerCase() ? 1 : -1;
    }
};
var orientationQualifier = {
    isMatch: function (value) {
        return value === "land" ||
            value === "port";
    },
    getMatchValue: function (value, context) {
        var isLandscape = (context.width > context.height) ? 1 : -1;
        return (value === "land") ? isLandscape : -isLandscape;
    }
};
var supportedQualifiers = [
    minWidthHeightQualifier,
    minWidthQualifier,
    minHeightQualifier,
    orientationQualifier,
    platformQualifier
];
function checkQualifiers(qualifiers, context) {
    var result = 0;
    var value;
    for (var i = 0; i < qualifiers.length; i++) {
        if (qualifiers[i]) {
            value = checkQualifier(qualifiers[i], context);
            if (value < 0) {
                return -1;
            }
            result += value;
        }
    }
    return result;
}
function checkQualifier(value, context) {
    var result;
    for (var i = 0; i < supportedQualifiers.length; i++) {
        if (supportedQualifiers[i].isMatch(value)) {
            result = supportedQualifiers[i].getMatchValue(value, context);
            if (result > 0) {
                result += (supportedQualifiers.length - i) * PRIORITY_STEP;
            }
            return result;
        }
    }
    return -1;
}
function findMatch(path, ext, candidates, context) {
    var bestValue = -1;
    var result = null;
    for (var i = 0; i < candidates.length; i++) {
        var filePath = candidates[i];
        var qualifiersStr = filePath.substr(path.length, filePath.length - path.length - (ext ? ext.length : 0));
        var qualifiers = qualifiersStr.split(".");
        var value = checkQualifiers(qualifiers, context);
        if (value >= 0 && value > bestValue) {
            bestValue = value;
            result = candidates[i];
        }
    }
    return result;
}
exports.findMatch = findMatch;
//# sourceMappingURL=qualifier-matcher.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/platform/platform.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var appModule = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var MIN_TABLET_PIXELS = 600;
var platformNames;
(function (platformNames) {
    platformNames.android = "Android";
    platformNames.ios = "iOS";
})(platformNames = exports.platformNames || (exports.platformNames = {}));
var Device = (function () {
    function Device() {
    }
    Object.defineProperty(Device.prototype, "manufacturer", {
        get: function () {
            if (!this._manufacturer) {
                this._manufacturer = android.os.Build.MANUFACTURER;
            }
            return this._manufacturer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "os", {
        get: function () {
            return platformNames.android;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "osVersion", {
        get: function () {
            if (!this._osVersion) {
                this._osVersion = android.os.Build.VERSION.RELEASE;
            }
            return this._osVersion;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "model", {
        get: function () {
            if (!this._model) {
                this._model = android.os.Build.MODEL;
            }
            return this._model;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "sdkVersion", {
        get: function () {
            if (!this._sdkVersion) {
                this._sdkVersion = android.os.Build.VERSION.SDK;
            }
            return this._sdkVersion;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "deviceType", {
        get: function () {
            if (!this._deviceType) {
                var dips = Math.min(screen.mainScreen.widthPixels, screen.mainScreen.heightPixels) / screen.mainScreen.scale;
                if (dips >= MIN_TABLET_PIXELS) {
                    this._deviceType = "Tablet";
                }
                else {
                    this._deviceType = "Phone";
                }
            }
            return this._deviceType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "uuid", {
        get: function () {
            if (!this._uuid) {
                var nativeApp = appModule.android.nativeApp;
                this._uuid = android.provider.Settings.Secure.getString(nativeApp.getContentResolver(), android.provider.Settings.Secure.ANDROID_ID);
            }
            return this._uuid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "language", {
        get: function () {
            if (!this._language) {
                this._language = java.util.Locale.getDefault().getLanguage().replace("_", "-");
            }
            return this._language;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "region", {
        get: function () {
            if (!this._region) {
                this._region = java.util.Locale.getDefault().getCountry();
            }
            return this._region;
        },
        enumerable: true,
        configurable: true
    });
    return Device;
}());
var MainScreen = (function () {
    function MainScreen() {
    }
    MainScreen.prototype.reinitMetrics = function () {
        if (!this._metrics) {
            this._metrics = new android.util.DisplayMetrics();
        }
        this.initMetrics();
    };
    MainScreen.prototype.initMetrics = function () {
        var nativeApp = appModule.getNativeApplication();
        nativeApp.getSystemService(android.content.Context.WINDOW_SERVICE).getDefaultDisplay().getRealMetrics(this._metrics);
    };
    Object.defineProperty(MainScreen.prototype, "metrics", {
        get: function () {
            if (!this._metrics) {
                appModule.on("cssChanged", this.reinitMetrics, this);
                appModule.on(appModule.orientationChangedEvent, this.reinitMetrics, this);
                this._metrics = new android.util.DisplayMetrics();
                this.initMetrics();
            }
            return this._metrics;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "widthPixels", {
        get: function () {
            return this.metrics.widthPixels;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "heightPixels", {
        get: function () {
            return this.metrics.heightPixels;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "scale", {
        get: function () {
            return this.metrics.density;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "widthDIPs", {
        get: function () {
            return this.metrics.widthPixels / this.metrics.density;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "heightDIPs", {
        get: function () {
            return this.metrics.heightPixels / this.metrics.density;
        },
        enumerable: true,
        configurable: true
    });
    return MainScreen;
}());
exports.device = new Device();
var screen;
(function (screen) {
    screen.mainScreen = new MainScreen();
})(screen = exports.screen || (exports.screen = {}));
exports.isAndroid = true;
exports.isIOS = false;
//# sourceMappingURL=platform.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/profiling/profiling.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
function uptime() {
    return global.android ? org.nativescript.Process.getUpTime() : global.__tns_uptime();
}
exports.uptime = uptime;
function log(message) {
    if (global.__nslog) {
        global.__nslog("CONSOLE LOG: " + message);
    }
    console.log(message);
}
exports.log = log;
var timers = {};
var anyGlobal = global;
var profileNames = [];
exports.time = global.__time || Date.now;
function start(name) {
    var info = timers[name];
    if (info) {
        info.currentStart = exports.time();
        info.runCount++;
    }
    else {
        info = {
            totalTime: 0,
            count: 0,
            currentStart: exports.time(),
            runCount: 1
        };
        timers[name] = info;
        profileNames.push(name);
    }
}
exports.start = start;
function stop(name) {
    var info = timers[name];
    if (!info) {
        throw new Error("No timer started: " + name);
    }
    if (info.runCount) {
        info.runCount--;
        if (info.runCount) {
            info.count++;
        }
        else {
            info.lastTime = exports.time() - info.currentStart;
            info.totalTime += info.lastTime;
            info.count++;
            info.currentStart = 0;
        }
    }
    else {
        throw new Error("Timer " + name + " paused more times than started.");
    }
    return info;
}
exports.stop = stop;
function timer(name) {
    return timers[name];
}
exports.timer = timer;
function print(name) {
    var info = timers[name];
    if (!info) {
        throw new Error("No timer started: " + name);
    }
    console.log("---- [" + name + "] STOP total: " + info.totalTime + " count:" + info.count);
    return info;
}
exports.print = print;
function isRunning(name) {
    var info = timers[name];
    return !!(info && info.runCount);
}
exports.isRunning = isRunning;
function countersProfileFunctionFactory(fn, name, type) {
    if (type === void 0) { type = 1; }
    profileNames.push(name);
    return function () {
        start(name);
        try {
            return fn.apply(this, arguments);
        }
        finally {
            stop(name);
        }
    };
}
function timelineProfileFunctionFactory(fn, name, type) {
    if (type === void 0) { type = 1; }
    return type === 1 ? function () {
        var start = exports.time();
        try {
            return fn.apply(this, arguments);
        }
        finally {
            var end = exports.time();
            console.log("Timeline: Modules: " + name + " " + this + "  (" + start + "ms. - " + end + "ms.)");
        }
    } : function () {
        var start = exports.time();
        try {
            return fn.apply(this, arguments);
        }
        finally {
            var end = exports.time();
            console.log("Timeline: Modules: " + name + "  (" + start + "ms. - " + end + "ms.)");
        }
    };
}
var Level;
(function (Level) {
    Level[Level["none"] = 0] = "none";
    Level[Level["lifecycle"] = 1] = "lifecycle";
    Level[Level["timeline"] = 2] = "timeline";
})(Level = exports.Level || (exports.Level = {}));
var tracingLevel = Level.none;
var profileFunctionFactory;
function enable(mode) {
    if (mode === void 0) { mode = "counters"; }
    profileFunctionFactory = mode && {
        counters: countersProfileFunctionFactory,
        timeline: timelineProfileFunctionFactory
    }[mode];
    tracingLevel = {
        lifecycle: Level.lifecycle,
        timeline: Level.timeline,
    }[mode] || Level.none;
}
exports.enable = enable;
try {
    var appConfig = __webpack_require__("./package.json");
    if (appConfig && appConfig.profiling) {
        enable(appConfig.profiling);
    }
}
catch (e1) {
    try {
        console.log("Profiling startup failed to figure out defaults from package.json, error: " + e1);
    }
    catch (e2) {
    }
}
function disable() {
    profileFunctionFactory = undefined;
}
exports.disable = disable;
function profileFunction(fn, customName) {
    return profileFunctionFactory(fn, customName || fn.name);
}
var profileMethodUnnamed = function (target, key, descriptor) {
    if (descriptor === undefined) {
        descriptor = Object.getOwnPropertyDescriptor(target, key);
    }
    var originalMethod = descriptor.value;
    var className = "";
    if (target && target.constructor && target.constructor.name) {
        className = target.constructor.name + ".";
    }
    var name = className + key;
    descriptor.value = profileFunctionFactory(originalMethod, name, 1);
    return descriptor;
};
var profileStaticMethodUnnamed = function (ctor, key, descriptor) {
    if (descriptor === undefined) {
        descriptor = Object.getOwnPropertyDescriptor(ctor, key);
    }
    var originalMethod = descriptor.value;
    var className = "";
    if (ctor && ctor.name) {
        className = ctor.name + ".";
    }
    var name = className + key;
    descriptor.value = profileFunctionFactory(originalMethod, name, 0);
    return descriptor;
};
function profileMethodNamed(name) {
    return function (target, key, descriptor) {
        if (descriptor === undefined) {
            descriptor = Object.getOwnPropertyDescriptor(target, key);
        }
        var originalMethod = descriptor.value;
        descriptor.value = profileFunctionFactory(originalMethod, name);
        return descriptor;
    };
}
var voidMethodDecorator = function () {
};
function profile(nameFnOrTarget, fnOrKey, descriptor) {
    if (typeof nameFnOrTarget === "object" && (typeof fnOrKey === "string" || typeof fnOrKey === "symbol")) {
        if (!profileFunctionFactory) {
            return;
        }
        return profileMethodUnnamed(nameFnOrTarget, fnOrKey, descriptor);
    }
    else if (typeof nameFnOrTarget === "function" && (typeof fnOrKey === "string" || typeof fnOrKey === "symbol")) {
        if (!profileFunctionFactory) {
            return;
        }
        return profileStaticMethodUnnamed(nameFnOrTarget, fnOrKey, descriptor);
    }
    else if (typeof nameFnOrTarget === "string" && typeof fnOrKey === "function") {
        if (!profileFunctionFactory) {
            return fnOrKey;
        }
        return profileFunction(fnOrKey, nameFnOrTarget);
    }
    else if (typeof nameFnOrTarget === "function") {
        if (!profileFunctionFactory) {
            return nameFnOrTarget;
        }
        return profileFunction(nameFnOrTarget);
    }
    else if (typeof nameFnOrTarget === "string") {
        if (!profileFunctionFactory) {
            return voidMethodDecorator;
        }
        return profileMethodNamed(nameFnOrTarget);
    }
    else {
        if (!profileFunctionFactory) {
            return voidMethodDecorator;
        }
        return profileMethodUnnamed;
    }
}
exports.profile = profile;
function dumpProfiles() {
    profileNames.forEach(function (name) {
        var info = timers[name];
        if (info) {
            console.log("---- [" + name + "] STOP total: " + info.totalTime + " count:" + info.count);
        }
        else {
            console.log("---- [" + name + "] Never called");
        }
    });
}
exports.dumpProfiles = dumpProfiles;
function resetProfiles() {
    profileNames.forEach(function (name) {
        var info = timers[name];
        if (info) {
            if (info.runCount) {
                console.log("---- timer with name [" + name + "] is currently running and won't be reset");
            }
            else {
                timers[name] = undefined;
            }
        }
    });
}
exports.resetProfiles = resetProfiles;
function startCPUProfile(name) {
    if (anyGlobal.android) {
        __startCPUProfiler(name);
    }
}
exports.startCPUProfile = startCPUProfile;
function stopCPUProfile(name) {
    if (anyGlobal.android) {
        __stopCPUProfiler(name);
    }
}
exports.stopCPUProfile = stopCPUProfile;
function level() {
    return tracingLevel;
}
exports.level = level;
function trace(message, start, end) {
    log("Timeline: Modules: " + message + "  (" + start + "ms. - " + end + "ms.)");
}
exports.trace = trace;
//# sourceMappingURL=profiling.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/text/formatted-string.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var span_1 = __webpack_require__("../node_modules/tns-core-modules/text/span.js");
exports.Span = span_1.Span;
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var observable_array_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable-array/observable-array.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var knownCollections;
(function (knownCollections) {
    knownCollections.spans = "spans";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var FormattedString = (function (_super) {
    __extends(FormattedString, _super);
    function FormattedString() {
        var _this = _super.call(this) || this;
        _this._spans = new observable_array_1.ObservableArray();
        _this._spans.addEventListener(observable_array_1.ObservableArray.changeEvent, _this.onSpansCollectionChanged, _this);
        return _this;
    }
    Object.defineProperty(FormattedString.prototype, "fontFamily", {
        get: function () {
            return this.style.fontFamily;
        },
        set: function (value) {
            this.style.fontFamily = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "fontSize", {
        get: function () {
            return this.style.fontSize;
        },
        set: function (value) {
            this.style.fontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "fontStyle", {
        get: function () {
            return this.style.fontStyle;
        },
        set: function (value) {
            this.style.fontStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "fontWeight", {
        get: function () {
            return this.style.fontWeight;
        },
        set: function (value) {
            this.style.fontWeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "textDecoration", {
        get: function () {
            return this.style.textDecoration;
        },
        set: function (value) {
            this.style.textDecoration = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "color", {
        get: function () {
            return this.style.color;
        },
        set: function (value) {
            this.style.color = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "backgroundColor", {
        get: function () {
            return this.style.backgroundColor;
        },
        set: function (value) {
            this.style.backgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "spans", {
        get: function () {
            if (!this._spans) {
                this._spans = new observable_array_1.ObservableArray();
            }
            return this._spans;
        },
        enumerable: true,
        configurable: true
    });
    FormattedString.prototype.toString = function () {
        var result = "";
        for (var i = 0, length_1 = this._spans.length; i < length_1; i++) {
            result += this._spans.getItem(i).text;
        }
        return result;
    };
    FormattedString.prototype._addArrayFromBuilder = function (name, value) {
        if (name === knownCollections.spans) {
            this.spans.push(value);
        }
    };
    FormattedString.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof span_1.Span) {
            this.spans.push(value);
        }
    };
    FormattedString.prototype.onSpansCollectionChanged = function (eventData) {
        if (eventData.addedCount > 0) {
            for (var i = 0; i < eventData.addedCount; i++) {
                var span = eventData.object.getItem(eventData.index + i);
                this._addView(span);
                this.addPropertyChangeHandler(span);
            }
        }
        if (eventData.removed && eventData.removed.length > 0) {
            for (var p = 0; p < eventData.removed.length; p++) {
                var span = eventData.removed[p];
                this.removePropertyChangeHandler(span);
                this._removeView(span);
            }
        }
        this.notifyPropertyChange(".", this);
    };
    FormattedString.prototype.addPropertyChangeHandler = function (span) {
        var style = span.style;
        span.on(observable_1.Observable.propertyChangeEvent, this.onPropertyChange, this);
        style.on("fontFamilyChange", this.onPropertyChange, this);
        style.on("fontSizeChange", this.onPropertyChange, this);
        style.on("fontStyleChange", this.onPropertyChange, this);
        style.on("fontWeightChange", this.onPropertyChange, this);
        style.on("textDecorationChange", this.onPropertyChange, this);
        style.on("colorChange", this.onPropertyChange, this);
        style.on("backgroundColorChange", this.onPropertyChange, this);
    };
    FormattedString.prototype.removePropertyChangeHandler = function (span) {
        var style = span.style;
        span.off(observable_1.Observable.propertyChangeEvent, this.onPropertyChange, this);
        style.off("fontFamilyChange", this.onPropertyChange, this);
        style.off("fontSizeChange", this.onPropertyChange, this);
        style.off("fontStyleChange", this.onPropertyChange, this);
        style.off("fontWeightChange", this.onPropertyChange, this);
        style.off("textDecorationChange", this.onPropertyChange, this);
        style.off("colorChange", this.onPropertyChange, this);
        style.off("backgroundColorChange", this.onPropertyChange, this);
    };
    FormattedString.prototype.onPropertyChange = function (data) {
        this.notifyPropertyChange(data.propertyName, this);
    };
    FormattedString.prototype.eachChild = function (callback) {
        this.spans.forEach(function (v, i, arr) { return callback(v); });
    };
    return FormattedString;
}(view_1.ViewBase));
exports.FormattedString = FormattedString;
//# sourceMappingURL=formatted-string.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/text/span.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var Span = (function (_super) {
    __extends(Span, _super);
    function Span() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Span.prototype, "fontFamily", {
        get: function () {
            return this.style.fontFamily;
        },
        set: function (value) {
            this.style.fontFamily = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "fontSize", {
        get: function () {
            return this.style.fontSize;
        },
        set: function (value) {
            this.style.fontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "fontStyle", {
        get: function () {
            return this.style.fontStyle;
        },
        set: function (value) {
            this.style.fontStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "fontWeight", {
        get: function () {
            return this.style.fontWeight;
        },
        set: function (value) {
            this.style.fontWeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "textDecoration", {
        get: function () {
            return this.style.textDecoration;
        },
        set: function (value) {
            this.style.textDecoration = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "color", {
        get: function () {
            return this.style.color;
        },
        set: function (value) {
            this.style.color = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "backgroundColor", {
        get: function () {
            return this.style.backgroundColor;
        },
        set: function (value) {
            this.style.backgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "text", {
        get: function () {
            return this._text;
        },
        set: function (value) {
            if (this._text !== value) {
                this._text = value;
                this.notifyPropertyChange("text", value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Span.prototype._setTextInternal = function (value) {
        this._text = value;
    };
    return Span;
}(view_1.ViewBase));
exports.Span = Span;
//# sourceMappingURL=span.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/text/text.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var encoding;
(function (encoding) {
    encoding.ISO_8859_1 = "ISO-8859-1";
    encoding.US_ASCII = "US-ASCII";
    encoding.UTF_16 = "UTF-16";
    encoding.UTF_16BE = "UTF-16BE";
    encoding.UTF_16LE = "UTF-16LE";
    encoding.UTF_8 = "UTF-8";
})(encoding = exports.encoding || (exports.encoding = {}));
//# sourceMappingURL=text.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/timer/timer.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var timeoutHandler;
var timeoutCallbacks = {};
var timerId = 0;
function createHandlerAndGetId() {
    if (!timeoutHandler) {
        timeoutHandler = new android.os.Handler(android.os.Looper.myLooper());
    }
    timerId++;
    return timerId;
}
function setTimeout(callback, milliseconds) {
    if (milliseconds === void 0) { milliseconds = 0; }
    var args = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    milliseconds += 0;
    var id = createHandlerAndGetId();
    var invoke = function () { return callback.apply(void 0, args); };
    var zoneBound = zonedCallback(invoke);
    var runnable = new java.lang.Runnable({
        run: function () {
            zoneBound();
            if (timeoutCallbacks[id]) {
                delete timeoutCallbacks[id];
            }
        }
    });
    if (!timeoutCallbacks[id]) {
        timeoutCallbacks[id] = runnable;
    }
    timeoutHandler.postDelayed(runnable, long(milliseconds));
    return id;
}
exports.setTimeout = setTimeout;
function clearTimeout(id) {
    var index = id;
    if (timeoutCallbacks[index]) {
        timeoutHandler.removeCallbacks(timeoutCallbacks[index]);
        delete timeoutCallbacks[index];
    }
}
exports.clearTimeout = clearTimeout;
function setInterval(callback, milliseconds) {
    if (milliseconds === void 0) { milliseconds = 0; }
    var args = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    milliseconds += 0;
    var id = createHandlerAndGetId();
    var handler = timeoutHandler;
    var invoke = function () { return callback.apply(void 0, args); };
    var zoneBound = zonedCallback(invoke);
    var runnable = new java.lang.Runnable({
        run: function () {
            zoneBound();
            if (timeoutCallbacks[id]) {
                handler.postDelayed(runnable, long(milliseconds));
            }
        }
    });
    if (!timeoutCallbacks[id]) {
        timeoutCallbacks[id] = runnable;
    }
    timeoutHandler.postDelayed(runnable, long(milliseconds));
    return id;
}
exports.setInterval = setInterval;
exports.clearInterval = clearTimeout;
//# sourceMappingURL=timer.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/trace/trace.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var enabled = false;
var _categories = {};
var _writers = [];
var _eventListeners = [];
var _errorHandler;
function enable() {
    enabled = true;
}
exports.enable = enable;
function disable() {
    enabled = false;
}
exports.disable = disable;
function isEnabled() {
    return enabled;
}
exports.isEnabled = isEnabled;
function isCategorySet(category) {
    return category in _categories;
}
exports.isCategorySet = isCategorySet;
function addWriter(writer) {
    _writers.push(writer);
}
exports.addWriter = addWriter;
function removeWriter(writer) {
    var index = _writers.indexOf(writer);
    if (index >= 0) {
        _writers.splice(index, 1);
    }
}
exports.removeWriter = removeWriter;
function clearWriters() {
    if (_writers.length > 0) {
        _writers.splice(0, _writers.length);
    }
}
exports.clearWriters = clearWriters;
function setCategories(categories) {
    _categories = {};
    addCategories(categories);
}
exports.setCategories = setCategories;
function addCategories(categories) {
    var split = categories.split(",");
    for (var i = 0; i < split.length; i++) {
        _categories[split[i].trim()] = true;
    }
}
exports.addCategories = addCategories;
function write(message, category, type) {
    var i;
    if (type === messageType.error) {
        for (i = 0; i < _writers.length; i++) {
            _writers[i].write(message, category, type);
        }
        return;
    }
    if (!enabled) {
        return;
    }
    if (!(category in _categories)) {
        return;
    }
    for (i = 0; i < _writers.length; i++) {
        _writers[i].write(message, category, type);
    }
}
exports.write = write;
function notifyEvent(object, name, data) {
    if (!enabled) {
        return;
    }
    var i, listener, filters;
    for (i = 0; i < _eventListeners.length; i++) {
        listener = _eventListeners[i];
        if (listener.filter) {
            filters = listener.filter.split(",");
            filters.forEach(function (value) {
                if (value.trim() === name) {
                    listener.on(object, name, data);
                }
            });
        }
        else {
            listener.on(object, name, data);
        }
    }
}
exports.notifyEvent = notifyEvent;
function addEventListener(listener) {
    _eventListeners.push(listener);
}
exports.addEventListener = addEventListener;
function removeEventListener(listener) {
    var index = _eventListeners.indexOf(listener);
    if (index >= 0) {
        _eventListeners.splice(index, 1);
    }
}
exports.removeEventListener = removeEventListener;
var messageType;
(function (messageType) {
    messageType.log = 0;
    messageType.info = 1;
    messageType.warn = 2;
    messageType.error = 3;
})(messageType = exports.messageType || (exports.messageType = {}));
var categories;
(function (categories) {
    categories.VisualTreeEvents = "VisualTreeEvents";
    categories.Layout = "Layout";
    categories.Style = "Style";
    categories.ViewHierarchy = "ViewHierarchy";
    categories.NativeLifecycle = "NativeLifecycle";
    categories.Debug = "Debug";
    categories.Navigation = "Navigation";
    categories.Test = "Test";
    categories.Binding = "Binding";
    categories.BindingError = "BindingError";
    categories.Error = "Error";
    categories.Animation = "Animation";
    categories.Transition = "Transition";
    categories.Livesync = "Livesync";
    categories.ModuleNameResolver = "ModuleNameResolver";
    categories.separator = ",";
    categories.All = [
        categories.VisualTreeEvents, categories.Layout, categories.Style,
        categories.ViewHierarchy, categories.NativeLifecycle,
        categories.Debug, categories.Navigation, categories.Test, categories.Binding,
        categories.Error, categories.Animation, categories.Transition, categories.Livesync,
        categories.ModuleNameResolver
    ]
        .join(categories.separator);
    function concat() {
        var result;
        for (var i = 0; i < arguments.length; i++) {
            if (!result) {
                result = arguments[i];
                continue;
            }
            result = result.concat(categories.separator, arguments[i]);
        }
        return result;
    }
    categories.concat = concat;
})(categories = exports.categories || (exports.categories = {}));
var ConsoleWriter = (function () {
    function ConsoleWriter() {
    }
    ConsoleWriter.prototype.write = function (message, category, type) {
        if (!console) {
            return;
        }
        var msgType;
        if (type === undefined) {
            msgType = messageType.log;
        }
        else {
            msgType = type;
        }
        switch (msgType) {
            case messageType.log:
                console.log(category + ": " + message);
                break;
            case messageType.info:
                console.info(category + ": " + message);
                break;
            case messageType.warn:
                console.warn(category + ": " + message);
                break;
            case messageType.error:
                console.error(category + ": " + message);
                break;
        }
    };
    return ConsoleWriter;
}());
addWriter(new ConsoleWriter());
var DefaultErrorHandler = (function () {
    function DefaultErrorHandler() {
    }
    DefaultErrorHandler.prototype.handlerError = function (error) {
        throw error;
    };
    return DefaultErrorHandler;
}());
exports.DefaultErrorHandler = DefaultErrorHandler;
setErrorHandler(new DefaultErrorHandler());
function getErrorHandler() {
    return _errorHandler;
}
exports.getErrorHandler = getErrorHandler;
function setErrorHandler(handler) {
    _errorHandler = handler;
}
exports.setErrorHandler = setErrorHandler;
function error(error) {
    if (!_errorHandler) {
        return;
    }
    if (typeof error === "string") {
        error = new Error(error);
    }
    _errorHandler.handlerError(error);
}
exports.error = error;
//# sourceMappingURL=trace.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/action-bar/action-bar-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var knownCollections;
(function (knownCollections) {
    knownCollections.actionItems = "actionItems";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var ActionBarBase = (function (_super) {
    __extends(ActionBarBase, _super);
    function ActionBarBase() {
        var _this = _super.call(this) || this;
        _this._actionItems = new ActionItems(_this);
        return _this;
    }
    Object.defineProperty(ActionBarBase.prototype, "navigationButton", {
        get: function () {
            return this._navigationButton;
        },
        set: function (value) {
            if (this._navigationButton !== value) {
                if (this._navigationButton) {
                    this._removeView(this._navigationButton);
                    this._navigationButton.actionBar = undefined;
                }
                this._navigationButton = value;
                if (this._navigationButton) {
                    this._navigationButton.actionBar = this;
                    this._addView(this._navigationButton);
                }
                this.update();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "actionItems", {
        get: function () {
            return this._actionItems;
        },
        set: function (value) {
            throw new Error("actionItems property is read-only");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "titleView", {
        get: function () {
            return this._titleView;
        },
        set: function (value) {
            if (this._titleView !== value) {
                if (this._titleView) {
                    this._removeView(this._titleView);
                    this._titleView.style[view_1.horizontalAlignmentProperty.cssName] = view_1.unsetValue;
                    this._titleView.style[view_1.verticalAlignmentProperty.cssName] = view_1.unsetValue;
                }
                this._titleView = value;
                if (value) {
                    this._addView(value);
                    var style = value.style;
                    if (!view_1.horizontalAlignmentProperty.isSet(style)) {
                        style[view_1.horizontalAlignmentProperty.cssName] = "center";
                    }
                    if (!view_1.verticalAlignmentProperty.isSet(style)) {
                        style[view_1.verticalAlignmentProperty.cssName] = "middle";
                    }
                }
                this.update();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "ios", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "android", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "_childrenCount", {
        get: function () {
            var actionViewsCount = 0;
            this._actionItems.getItems().forEach(function (actionItem) {
                if (actionItem.actionView) {
                    actionViewsCount++;
                }
            });
            return actionViewsCount + (this.titleView ? 1 : 0);
        },
        enumerable: true,
        configurable: true
    });
    ActionBarBase.prototype.update = function () {
    };
    ActionBarBase.prototype._onTitlePropertyChanged = function () {
    };
    ActionBarBase.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "actionItems") {
            this.actionItems.setItems(value);
        }
    };
    ActionBarBase.prototype.eachChildView = function (callback) {
        var titleView = this.titleView;
        if (titleView) {
            callback(titleView);
        }
    };
    ActionBarBase.prototype.eachChild = function (callback) {
        var titleView = this.titleView;
        if (titleView) {
            callback(titleView);
        }
        var navigationButton = this._navigationButton;
        if (navigationButton) {
            callback(navigationButton);
        }
        this.actionItems.getItems().forEach(function (actionItem) {
            callback(actionItem);
        });
    };
    ActionBarBase.prototype._isEmpty = function () {
        if (this.title ||
            this.titleView ||
            (this.android && this.android.icon) ||
            this.navigationButton ||
            this.actionItems.getItems().length > 0) {
            return false;
        }
        return true;
    };
    ActionBarBase = __decorate([
        view_1.CSSType("ActionBar")
    ], ActionBarBase);
    return ActionBarBase;
}(view_1.View));
exports.ActionBarBase = ActionBarBase;
var ActionItems = (function () {
    function ActionItems(actionBar) {
        this._items = new Array();
        this._actionBar = actionBar;
    }
    ActionItems.prototype.addItem = function (item) {
        if (!item) {
            throw new Error("Cannot add empty item");
        }
        this._items.push(item);
        item.actionBar = this._actionBar;
        this._actionBar._addView(item);
        this.invalidate();
    };
    ActionItems.prototype.removeItem = function (item) {
        if (!item) {
            throw new Error("Cannot remove empty item");
        }
        var itemIndex = this._items.indexOf(item);
        if (itemIndex < 0) {
            throw new Error("Cannot find item to remove");
        }
        this._items.splice(itemIndex, 1);
        this._actionBar._removeView(item);
        item.actionBar = undefined;
        this.invalidate();
    };
    ActionItems.prototype.getItems = function () {
        return this._items.slice();
    };
    ActionItems.prototype.getVisibleItems = function () {
        var visibleItems = [];
        this._items.forEach(function (item) {
            if (isVisible(item)) {
                visibleItems.push(item);
            }
        });
        return visibleItems;
    };
    ActionItems.prototype.getItemAt = function (index) {
        if (index < 0 || index >= this._items.length) {
            return undefined;
        }
        return this._items[index];
    };
    ActionItems.prototype.setItems = function (items) {
        while (this._items.length > 0) {
            this.removeItem(this._items[this._items.length - 1]);
        }
        for (var i = 0; i < items.length; i++) {
            this.addItem(items[i]);
        }
        this.invalidate();
    };
    ActionItems.prototype.invalidate = function () {
        if (this._actionBar) {
            this._actionBar.update();
        }
    };
    return ActionItems;
}());
exports.ActionItems = ActionItems;
var ActionItemBase = (function (_super) {
    __extends(ActionItemBase, _super);
    function ActionItemBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ActionItemBase.prototype, "actionView", {
        get: function () {
            return this._actionView;
        },
        set: function (value) {
            if (this._actionView !== value) {
                if (this._actionView) {
                    this._actionView.style[view_1.horizontalAlignmentProperty.cssName] = view_1.unsetValue;
                    this._actionView.style[view_1.verticalAlignmentProperty.cssName] = view_1.unsetValue;
                    this._removeView(this._actionView);
                }
                this._actionView = value;
                if (this._actionView) {
                    this._addView(this._actionView);
                }
                if (this._actionBar) {
                    this._actionBar.update();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionItemBase.prototype, "actionBar", {
        get: function () {
            return this._actionBar;
        },
        set: function (value) {
            if (value !== this._actionBar) {
                this._actionBar = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    ActionItemBase.prototype.onLoaded = function () {
        if (this._actionView) {
            this._actionView.style[view_1.horizontalAlignmentProperty.cssName] = "center";
            this._actionView.style[view_1.verticalAlignmentProperty.cssName] = "middle";
        }
        _super.prototype.onLoaded.call(this);
    };
    ActionItemBase.prototype._raiseTap = function () {
        this._emit(ActionItemBase.tapEvent);
    };
    ActionItemBase.prototype._addChildFromBuilder = function (name, value) {
        this.actionView = value;
    };
    ActionItemBase.prototype._onVisibilityChanged = function (visibility) {
        if (this.actionBar) {
            this.actionBar.update();
        }
    };
    ActionItemBase.prototype.eachChild = function (callback) {
        if (this._actionView) {
            callback(this._actionView);
        }
    };
    ActionItemBase.tapEvent = "tap";
    __decorate([
        profiling_1.profile
    ], ActionItemBase.prototype, "onLoaded", null);
    return ActionItemBase;
}(view_1.ViewBase));
exports.ActionItemBase = ActionItemBase;
function isVisible(item) {
    return item.visibility === "visible";
}
exports.isVisible = isVisible;
function onTitlePropertyChanged(actionBar, oldValue, newValue) {
    actionBar._onTitlePropertyChanged();
}
exports.titleProperty = new view_1.Property({ name: "title", valueChanged: onTitlePropertyChanged });
exports.titleProperty.register(ActionBarBase);
function onItemChanged(item, oldValue, newValue) {
    if (item.actionBar) {
        item.actionBar.update();
    }
}
function onVisibilityChanged(item, oldValue, newValue) {
    item._onVisibilityChanged(newValue);
}
function traceMissingIcon(icon) {
    view_1.traceWrite("Could not load action bar icon: " + icon, view_1.traceCategories.Error, view_1.traceMessageType.error);
}
exports.traceMissingIcon = traceMissingIcon;
exports.iosIconRenderingModeProperty = new view_1.Property({ name: "iosIconRenderingMode", defaultValue: "alwaysOriginal" });
exports.iosIconRenderingModeProperty.register(ActionBarBase);
exports.textProperty = new view_1.Property({ name: "text", defaultValue: "", valueChanged: onItemChanged });
exports.textProperty.register(ActionItemBase);
exports.iconProperty = new view_1.Property({ name: "icon", valueChanged: onItemChanged });
exports.iconProperty.register(ActionItemBase);
exports.visibilityProperty = new view_1.Property({ name: "visibility", defaultValue: "visible", valueChanged: onVisibilityChanged });
exports.visibilityProperty.register(ActionItemBase);
exports.flatProperty = new view_1.Property({ name: "flat", defaultValue: false, valueConverter: view_1.booleanConverter });
exports.flatProperty.register(ActionBarBase);
//# sourceMappingURL=action-bar-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/action-bar/action-bar.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var action_bar_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar-common.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar-common.js"));
var R_ID_HOME = 0x0102002c;
var ACTION_ITEM_ID_OFFSET = 10000;
var DEFAULT_ELEVATION = 4;
var AppCompatTextView;
var actionItemIdGenerator = ACTION_ITEM_ID_OFFSET;
function generateItemId() {
    actionItemIdGenerator++;
    return actionItemIdGenerator;
}
var appResources;
var MenuItemClickListener;
function initializeMenuItemClickListener() {
    if (MenuItemClickListener) {
        return;
    }
    AppCompatTextView = androidx.appcompat.widget.AppCompatTextView;
    var MenuItemClickListenerImpl = (function (_super) {
        __extends(MenuItemClickListenerImpl, _super);
        function MenuItemClickListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        MenuItemClickListenerImpl.prototype.onMenuItemClick = function (item) {
            var itemId = item.getItemId();
            return this.owner._onAndroidItemSelected(itemId);
        };
        MenuItemClickListenerImpl = __decorate([
            Interfaces([androidx.appcompat.widget.Toolbar.OnMenuItemClickListener])
        ], MenuItemClickListenerImpl);
        return MenuItemClickListenerImpl;
    }(java.lang.Object));
    MenuItemClickListener = MenuItemClickListenerImpl;
    appResources = application.android.context.getResources();
}
var ActionItem = (function (_super) {
    __extends(ActionItem, _super);
    function ActionItem() {
        var _this = _super.call(this) || this;
        _this._androidPosition = {
            position: "actionBar",
            systemIcon: undefined
        };
        _this._itemId = generateItemId();
        return _this;
    }
    Object.defineProperty(ActionItem.prototype, "android", {
        get: function () {
            return this._androidPosition;
        },
        set: function (value) {
            throw new Error("ActionItem.android is read-only");
        },
        enumerable: true,
        configurable: true
    });
    ActionItem.prototype._getItemId = function () {
        return this._itemId;
    };
    return ActionItem;
}(action_bar_common_1.ActionItemBase));
exports.ActionItem = ActionItem;
var AndroidActionBarSettings = (function () {
    function AndroidActionBarSettings(actionBar) {
        this._iconVisibility = "auto";
        this._actionBar = actionBar;
    }
    Object.defineProperty(AndroidActionBarSettings.prototype, "icon", {
        get: function () {
            return this._icon;
        },
        set: function (value) {
            if (value !== this._icon) {
                this._icon = value;
                this._actionBar._onIconPropertyChanged();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AndroidActionBarSettings.prototype, "iconVisibility", {
        get: function () {
            return this._iconVisibility;
        },
        set: function (value) {
            if (value !== this._iconVisibility) {
                this._iconVisibility = value;
                this._actionBar._onIconPropertyChanged();
            }
        },
        enumerable: true,
        configurable: true
    });
    return AndroidActionBarSettings;
}());
exports.AndroidActionBarSettings = AndroidActionBarSettings;
var NavigationButton = (function (_super) {
    __extends(NavigationButton, _super);
    function NavigationButton() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return NavigationButton;
}(ActionItem));
exports.NavigationButton = NavigationButton;
var ActionBar = (function (_super) {
    __extends(ActionBar, _super);
    function ActionBar() {
        var _this = _super.call(this) || this;
        _this._android = new AndroidActionBarSettings(_this);
        return _this;
    }
    Object.defineProperty(ActionBar.prototype, "android", {
        get: function () {
            return this._android;
        },
        enumerable: true,
        configurable: true
    });
    ActionBar.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof NavigationButton) {
            this.navigationButton = value;
        }
        else if (value instanceof ActionItem) {
            this.actionItems.addItem(value);
        }
        else if (value instanceof action_bar_common_1.View) {
            this.titleView = value;
        }
    };
    ActionBar.prototype.createNativeView = function () {
        return new androidx.appcompat.widget.Toolbar(this._context);
    };
    ActionBar.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        initializeMenuItemClickListener();
        var menuItemClickListener = new MenuItemClickListener(this);
        nativeView.setOnMenuItemClickListener(menuItemClickListener);
        nativeView.menuItemClickListener = menuItemClickListener;
    };
    ActionBar.prototype.disposeNativeView = function () {
        this.nativeViewProtected.menuItemClickListener.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    ActionBar.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.update();
    };
    ActionBar.prototype.update = function () {
        if (!this.nativeViewProtected) {
            return;
        }
        var page = this.page;
        if (!page.frame || !page.frame._getNavBarVisible(page)) {
            this.nativeViewProtected.setVisibility(android.view.View.GONE);
            return;
        }
        this.nativeViewProtected.setVisibility(android.view.View.VISIBLE);
        this._addActionItems();
        this._updateTitleAndTitleView();
        this._updateIcon();
        this._updateNavigationButton();
    };
    ActionBar.prototype._onAndroidItemSelected = function (itemId) {
        if (this.navigationButton && itemId === R_ID_HOME) {
            this.navigationButton._raiseTap();
            return true;
        }
        var menuItem = undefined;
        var items = this.actionItems.getItems();
        for (var i = 0; i < items.length; i++) {
            if (items[i]._getItemId() === itemId) {
                menuItem = items[i];
                break;
            }
        }
        if (menuItem) {
            menuItem._raiseTap();
            return true;
        }
        return false;
    };
    ActionBar.prototype._updateNavigationButton = function () {
        var navButton = this.navigationButton;
        if (navButton && action_bar_common_1.isVisible(navButton)) {
            var systemIcon = navButton.android.systemIcon;
            if (systemIcon !== undefined) {
                var systemResourceId = getSystemResourceId(systemIcon);
                if (systemResourceId) {
                    this.nativeViewProtected.setNavigationIcon(systemResourceId);
                }
            }
            else if (navButton.icon) {
                var drawableOrId = getDrawableOrResourceId(navButton.icon, appResources);
                if (drawableOrId) {
                    this.nativeViewProtected.setNavigationIcon(drawableOrId);
                }
            }
            this.nativeViewProtected.setNavigationContentDescription(navButton.text || null);
            var navBtn_1 = new WeakRef(navButton);
            this.nativeViewProtected.setNavigationOnClickListener(new android.view.View.OnClickListener({
                onClick: function (v) {
                    var owner = navBtn_1.get();
                    if (owner) {
                        owner._raiseTap();
                    }
                }
            }));
        }
        else {
            this.nativeViewProtected.setNavigationIcon(null);
        }
    };
    ActionBar.prototype._updateIcon = function () {
        var visibility = getIconVisibility(this.android.iconVisibility);
        if (visibility) {
            var icon = this.android.icon;
            if (icon !== undefined) {
                var drawableOrId = getDrawableOrResourceId(icon, appResources);
                if (drawableOrId) {
                    this.nativeViewProtected.setLogo(drawableOrId);
                }
            }
            else {
                var defaultIcon = application.android.nativeApp.getApplicationInfo().icon;
                this.nativeViewProtected.setLogo(defaultIcon);
            }
        }
        else {
            this.nativeViewProtected.setLogo(null);
        }
    };
    ActionBar.prototype._updateTitleAndTitleView = function () {
        if (!this.titleView) {
            var title = this.title;
            if (title !== undefined) {
                this.nativeViewProtected.setTitle(title);
            }
            else {
                var appContext = application.android.context;
                var appInfo = appContext.getApplicationInfo();
                var appLabel = appContext.getPackageManager().getApplicationLabel(appInfo);
                if (appLabel) {
                    this.nativeViewProtected.setTitle(appLabel);
                }
            }
        }
    };
    ActionBar.prototype._addActionItems = function () {
        var menu = this.nativeViewProtected.getMenu();
        var items = this.actionItems.getVisibleItems();
        menu.clear();
        for (var i = 0; i < items.length; i++) {
            var item = items[i];
            var menuItem = menu.add(android.view.Menu.NONE, item._getItemId(), android.view.Menu.NONE, item.text + "");
            if (item.actionView && item.actionView.android) {
                item.android.position = "actionBar";
                menuItem.setActionView(item.actionView.android);
                ActionBar._setOnClickListener(item);
            }
            else if (item.android.systemIcon) {
                var systemResourceId = getSystemResourceId(item.android.systemIcon);
                if (systemResourceId) {
                    menuItem.setIcon(systemResourceId);
                }
            }
            else if (item.icon) {
                if (utils_1.isFontIconURI(item.icon)) {
                    var fontIconCode = item.icon.split("//")[1];
                    var font = item.style.fontInternal;
                    var color = item.style.color;
                    var is = image_source_1.fromFontIconCode(fontIconCode, font, color);
                    if (is && is.android) {
                        var drawable = new android.graphics.drawable.BitmapDrawable(appResources, is.android);
                        menuItem.setIcon(drawable);
                    }
                }
                else {
                    var drawableOrId = getDrawableOrResourceId(item.icon, appResources);
                    if (drawableOrId) {
                        menuItem.setIcon(drawableOrId);
                    }
                }
            }
            var showAsAction = getShowAsAction(item);
            menuItem.setShowAsAction(showAsAction);
        }
    };
    ActionBar._setOnClickListener = function (item) {
        var weakRef = new WeakRef(item);
        item.actionView.android.setOnClickListener(new android.view.View.OnClickListener({
            onClick: function (v) {
                var owner = weakRef.get();
                if (owner) {
                    owner._raiseTap();
                }
            }
        }));
    };
    ActionBar.prototype._onTitlePropertyChanged = function () {
        if (this.nativeViewProtected) {
            this._updateTitleAndTitleView();
        }
    };
    ActionBar.prototype._onIconPropertyChanged = function () {
        if (this.nativeViewProtected) {
            this._updateIcon();
        }
    };
    ActionBar.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        if (atIndex === void 0) { atIndex = Number.MAX_VALUE; }
        _super.prototype._addViewToNativeVisualTree.call(this, child);
        if (this.nativeViewProtected && child.nativeViewProtected) {
            if (atIndex >= this.nativeViewProtected.getChildCount()) {
                this.nativeViewProtected.addView(child.nativeViewProtected);
            }
            else {
                this.nativeViewProtected.addView(child.nativeViewProtected, atIndex);
            }
            return true;
        }
        return false;
    };
    ActionBar.prototype._removeViewFromNativeVisualTree = function (child) {
        _super.prototype._removeViewFromNativeVisualTree.call(this, child);
        if (this.nativeViewProtected && child.nativeViewProtected) {
            this.nativeViewProtected.removeView(child.nativeViewProtected);
        }
    };
    ActionBar.prototype[action_bar_common_1.colorProperty.getDefault] = function () {
        var nativeView = this.nativeViewProtected;
        if (!defaultTitleTextColor) {
            var tv = getAppCompatTextView(nativeView);
            if (!tv) {
                var title = nativeView.getTitle();
                nativeView.setTitle("");
                tv = getAppCompatTextView(nativeView);
                if (title) {
                    nativeView.setTitle(title);
                }
            }
            defaultTitleTextColor = tv ? tv.getTextColors().getDefaultColor() : -570425344;
        }
        return defaultTitleTextColor;
    };
    ActionBar.prototype[action_bar_common_1.colorProperty.setNative] = function (value) {
        var color = value instanceof action_bar_common_1.Color ? value.android : value;
        this.nativeViewProtected.setTitleTextColor(color);
    };
    ActionBar.prototype[action_bar_common_1.flatProperty.setNative] = function (value) {
        var compat = androidx.core.view.ViewCompat;
        if (compat.setElevation) {
            if (value) {
                compat.setElevation(this.nativeViewProtected, 0);
            }
            else {
                var val = DEFAULT_ELEVATION * action_bar_common_1.layout.getDisplayDensity();
                compat.setElevation(this.nativeViewProtected, val);
            }
        }
    };
    return ActionBar;
}(action_bar_common_1.ActionBarBase));
exports.ActionBar = ActionBar;
function getAppCompatTextView(toolbar) {
    for (var i = 0, count = toolbar.getChildCount(); i < count; i++) {
        var child = toolbar.getChildAt(i);
        if (child instanceof AppCompatTextView) {
            return child;
        }
    }
    return null;
}
ActionBar.prototype.recycleNativeView = "auto";
var defaultTitleTextColor;
function getDrawableOrResourceId(icon, resources) {
    if (typeof icon !== "string") {
        return undefined;
    }
    var result = undefined;
    if (icon.indexOf(utils_1.RESOURCE_PREFIX) === 0) {
        var resourceId = resources.getIdentifier(icon.substr(utils_1.RESOURCE_PREFIX.length), "drawable", application.android.packageName);
        if (resourceId > 0) {
            result = resourceId;
        }
    }
    else {
        var drawable = void 0;
        var is = image_source_1.fromFileOrResource(icon);
        if (is) {
            drawable = new android.graphics.drawable.BitmapDrawable(appResources, is.android);
        }
        result = drawable;
    }
    if (!result) {
        action_bar_common_1.traceMissingIcon(icon);
    }
    return result;
}
function getShowAsAction(menuItem) {
    switch (menuItem.android.position) {
        case "actionBarIfRoom":
            return android.view.MenuItem.SHOW_AS_ACTION_IF_ROOM;
        case "popup":
            return android.view.MenuItem.SHOW_AS_ACTION_NEVER;
        case "actionBar":
        default:
            return android.view.MenuItem.SHOW_AS_ACTION_ALWAYS;
    }
}
function getIconVisibility(iconVisibility) {
    switch (iconVisibility) {
        case "always":
            return true;
        case "auto":
        case "never":
        default:
            return false;
    }
}
function getSystemResourceId(systemIcon) {
    return android.content.res.Resources.getSystem().getIdentifier(systemIcon, "drawable", "android");
}
//# sourceMappingURL=action-bar.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ActivityIndicatorBase = (function (_super) {
    __extends(ActivityIndicatorBase, _super);
    function ActivityIndicatorBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ActivityIndicatorBase = __decorate([
        view_1.CSSType("ActivityIndicator")
    ], ActivityIndicatorBase);
    return ActivityIndicatorBase;
}(view_1.View));
exports.ActivityIndicatorBase = ActivityIndicatorBase;
ActivityIndicatorBase.prototype.recycleNativeView = "auto";
exports.busyProperty = new view_1.Property({ name: "busy", defaultValue: false, valueConverter: view_1.booleanConverter });
exports.busyProperty.register(ActivityIndicatorBase);
//# sourceMappingURL=activity-indicator-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var activity_indicator_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator-common.js"));
var ActivityIndicator = (function (_super) {
    __extends(ActivityIndicator, _super);
    function ActivityIndicator() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ActivityIndicator.prototype.createNativeView = function () {
        var progressBar = new android.widget.ProgressBar(this._context);
        progressBar.setVisibility(android.view.View.INVISIBLE);
        progressBar.setIndeterminate(true);
        return progressBar;
    };
    ActivityIndicator.prototype[activity_indicator_common_1.busyProperty.getDefault] = function () {
        return false;
    };
    ActivityIndicator.prototype[activity_indicator_common_1.busyProperty.setNative] = function (value) {
        if (this.visibility === activity_indicator_common_1.Visibility.VISIBLE) {
            this.nativeViewProtected.setVisibility(value ? android.view.View.VISIBLE : android.view.View.INVISIBLE);
        }
    };
    ActivityIndicator.prototype[activity_indicator_common_1.visibilityProperty.getDefault] = function () {
        return activity_indicator_common_1.Visibility.HIDDEN;
    };
    ActivityIndicator.prototype[activity_indicator_common_1.visibilityProperty.setNative] = function (value) {
        switch (value) {
            case activity_indicator_common_1.Visibility.VISIBLE:
                this.nativeViewProtected.setVisibility(this.busy ? android.view.View.VISIBLE : android.view.View.INVISIBLE);
                break;
            case activity_indicator_common_1.Visibility.HIDDEN:
                this.nativeViewProtected.setVisibility(android.view.View.INVISIBLE);
                break;
            case activity_indicator_common_1.Visibility.COLLAPSE:
                this.nativeViewProtected.setVisibility(android.view.View.GONE);
                break;
            default:
                throw new Error("Invalid visibility value: " + value + ". Valid values are: \"" + activity_indicator_common_1.Visibility.VISIBLE + "\", \"" + activity_indicator_common_1.Visibility.HIDDEN + "\", \"" + activity_indicator_common_1.Visibility.COLLAPSE + "\".");
        }
    };
    ActivityIndicator.prototype[activity_indicator_common_1.colorProperty.getDefault] = function () {
        return -1;
    };
    ActivityIndicator.prototype[activity_indicator_common_1.colorProperty.setNative] = function (value) {
        if (value instanceof activity_indicator_common_1.Color) {
            this.nativeViewProtected.getIndeterminateDrawable().setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
        }
        else {
            this.nativeViewProtected.getIndeterminateDrawable().clearColorFilter();
        }
    };
    return ActivityIndicator;
}(activity_indicator_common_1.ActivityIndicatorBase));
exports.ActivityIndicator = ActivityIndicator;
//# sourceMappingURL=activity-indicator.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/animation/animation-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
exports.Color = color_1.Color;
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
exports.traceEnabled = trace_1.isEnabled;
exports.traceWrite = trace_1.write;
exports.traceCategories = trace_1.categories;
exports.traceType = trace_1.messageType;
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var Properties;
(function (Properties) {
    Properties.opacity = "opacity";
    Properties.backgroundColor = "backgroundColor";
    Properties.translate = "translate";
    Properties.rotate = "rotate";
    Properties.scale = "scale";
    Properties.height = "height";
    Properties.width = "width";
})(Properties = exports.Properties || (exports.Properties = {}));
var CubicBezierAnimationCurve = (function () {
    function CubicBezierAnimationCurve(x1, y1, x2, y2) {
        this.x1 = x1;
        this.y1 = y1;
        this.x2 = x2;
        this.y2 = y2;
    }
    return CubicBezierAnimationCurve;
}());
exports.CubicBezierAnimationCurve = CubicBezierAnimationCurve;
var AnimationBase = (function () {
    function AnimationBase(animationDefinitions, playSequentially) {
        if (!animationDefinitions || animationDefinitions.length === 0) {
            throw new Error("No animation definitions specified");
        }
        if (trace_1.isEnabled()) {
            trace_1.write("Analyzing " + animationDefinitions.length + " animation definitions...", trace_1.categories.Animation);
        }
        this._propertyAnimations = new Array();
        for (var i = 0, length_1 = animationDefinitions.length; i < length_1; i++) {
            if (animationDefinitions[i].curve) {
                animationDefinitions[i].curve = this._resolveAnimationCurve(animationDefinitions[i].curve);
            }
            this._propertyAnimations = this._propertyAnimations.concat(AnimationBase._createPropertyAnimations(animationDefinitions[i]));
        }
        if (this._propertyAnimations.length === 0) {
            throw new Error("Nothing to animate.");
        }
        if (trace_1.isEnabled()) {
            trace_1.write("Created " + this._propertyAnimations.length + " individual property animations.", trace_1.categories.Animation);
        }
        this._playSequentially = playSequentially;
    }
    AnimationBase.prototype._rejectAlreadyPlaying = function () {
        var reason = "Animation is already playing.";
        trace_1.write(reason, trace_1.categories.Animation, trace_1.messageType.warn);
        return new Promise(function (resolve, reject) {
            reject(reason);
        });
    };
    AnimationBase.prototype.play = function () {
        var _this_1 = this;
        var animationFinishedPromise = new Promise(function (resolve, reject) {
            _this_1._resolve = resolve;
            _this_1._reject = reject;
        });
        this.fixupAnimationPromise(animationFinishedPromise);
        this._isPlaying = true;
        return animationFinishedPromise;
    };
    AnimationBase.prototype.fixupAnimationPromise = function (promise) {
        var _this = this;
        promise.cancel = function () {
            _this.cancel();
        };
        var _then = promise.then;
        promise.then = function () {
            var r = _then.apply(promise, arguments);
            _this.fixupAnimationPromise(r);
            return r;
        };
        var _catch = promise.catch;
        promise.catch = function () {
            var r = _catch.apply(promise, arguments);
            _this.fixupAnimationPromise(r);
            return r;
        };
    };
    AnimationBase.prototype.cancel = function () {
    };
    Object.defineProperty(AnimationBase.prototype, "isPlaying", {
        get: function () {
            return this._isPlaying;
        },
        enumerable: true,
        configurable: true
    });
    AnimationBase.prototype._resolveAnimationFinishedPromise = function () {
        this._isPlaying = false;
        this._resolve();
    };
    AnimationBase.prototype._rejectAnimationFinishedPromise = function () {
        this._isPlaying = false;
        this._reject(new Error("Animation cancelled."));
    };
    AnimationBase._createPropertyAnimations = function (animationDefinition) {
        if (!animationDefinition.target) {
            throw new Error("No animation target specified.");
        }
        for (var item in animationDefinition) {
            if (animationDefinition[item] === undefined) {
                continue;
            }
            if ((item === Properties.opacity ||
                item === Properties.rotate ||
                item === "duration" ||
                item === "delay" ||
                item === "iterations") && typeof animationDefinition[item] !== "number") {
                throw new Error("Property " + item + " must be valid number. Value: " + animationDefinition[item]);
            }
            else if ((item === Properties.scale || item === Properties.translate) &&
                (typeof animationDefinition[item].x !== "number" || typeof animationDefinition[item].y !== "number")) {
                throw new Error("Property " + item + " must be valid Pair. Value: " + animationDefinition[item]);
            }
            else if (item === Properties.backgroundColor && !color_1.Color.isValid(animationDefinition.backgroundColor)) {
                throw new Error("Property " + item + " must be valid color. Value: " + animationDefinition[item]);
            }
            else if (item === Properties.width || item === Properties.height) {
                animationDefinition[item] = style_properties_1.PercentLength.parse(animationDefinition[item]);
            }
        }
        var propertyAnimations = new Array();
        if (animationDefinition.opacity !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.opacity,
                value: animationDefinition.opacity,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.backgroundColor !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.backgroundColor,
                value: typeof animationDefinition.backgroundColor === "string" ?
                    new color_1.Color(animationDefinition.backgroundColor) : animationDefinition.backgroundColor,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.translate !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.translate,
                value: animationDefinition.translate,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.scale !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.scale,
                value: animationDefinition.scale,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.rotate !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.rotate,
                value: animationDefinition.rotate,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.height !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.height,
                value: animationDefinition.height,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.width !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.width,
                value: animationDefinition.width,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (propertyAnimations.length === 0) {
            throw new Error("No known animation properties specified");
        }
        return propertyAnimations;
    };
    AnimationBase._getAnimationInfo = function (animation) {
        return JSON.stringify({
            target: animation.target.id,
            property: animation.property,
            value: animation.value,
            duration: animation.duration,
            delay: animation.delay,
            iterations: animation.iterations,
            curve: animation.curve
        });
    };
    return AnimationBase;
}());
exports.AnimationBase = AnimationBase;
//# sourceMappingURL=animation-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/animation/animation.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var animation_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation-common.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/animation/animation-common.js"));
var argbEvaluator;
function ensureArgbEvaluator() {
    if (!argbEvaluator) {
        argbEvaluator = new android.animation.ArgbEvaluator();
    }
}
var easeIn = lazy_1.default(function () { return new android.view.animation.AccelerateInterpolator(1); });
var easeOut = lazy_1.default(function () { return new android.view.animation.DecelerateInterpolator(1); });
var easeInOut = lazy_1.default(function () { return new android.view.animation.AccelerateDecelerateInterpolator(); });
var linear = lazy_1.default(function () { return new android.view.animation.LinearInterpolator(); });
var bounce = lazy_1.default(function () { return new android.view.animation.BounceInterpolator(); });
var keyPrefix = "ui.animation.";
var propertyKeys = {};
propertyKeys[animation_common_1.Properties.backgroundColor] = Symbol(keyPrefix + animation_common_1.Properties.backgroundColor);
propertyKeys[animation_common_1.Properties.opacity] = Symbol(keyPrefix + animation_common_1.Properties.opacity);
propertyKeys[animation_common_1.Properties.rotate] = Symbol(keyPrefix + animation_common_1.Properties.rotate);
propertyKeys[animation_common_1.Properties.scale] = Symbol(keyPrefix + animation_common_1.Properties.scale);
propertyKeys[animation_common_1.Properties.translate] = Symbol(keyPrefix + animation_common_1.Properties.translate);
propertyKeys[animation_common_1.Properties.height] = Symbol(keyPrefix + animation_common_1.Properties.height);
propertyKeys[animation_common_1.Properties.width] = Symbol(keyPrefix + animation_common_1.Properties.width);
function _resolveAnimationCurve(curve) {
    switch (curve) {
        case "easeIn":
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animation curve resolved to android.view.animation.AccelerateInterpolator(1).", animation_common_1.traceCategories.Animation);
            }
            return easeIn();
        case "easeOut":
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animation curve resolved to android.view.animation.DecelerateInterpolator(1).", animation_common_1.traceCategories.Animation);
            }
            return easeOut();
        case "easeInOut":
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animation curve resolved to android.view.animation.AccelerateDecelerateInterpolator().", animation_common_1.traceCategories.Animation);
            }
            return easeInOut();
        case "linear":
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animation curve resolved to android.view.animation.LinearInterpolator().", animation_common_1.traceCategories.Animation);
            }
            return linear();
        case "spring":
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animation curve resolved to android.view.animation.BounceInterpolator().", animation_common_1.traceCategories.Animation);
            }
            return bounce();
        case "ease":
            return androidx.core.view.animation.PathInterpolatorCompat.create(0.25, 0.1, 0.25, 1.0);
        default:
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animation curve resolved to original: " + curve, animation_common_1.traceCategories.Animation);
            }
            if (curve instanceof animation_common_1.CubicBezierAnimationCurve) {
                return androidx.core.view.animation.PathInterpolatorCompat.create(curve.x1, curve.y1, curve.x2, curve.y2);
            }
            else if (curve && curve.getInterpolation) {
                return curve;
            }
            else if (curve instanceof android.view.animation.LinearInterpolator) {
                return curve;
            }
            else {
                throw new Error("Invalid animation curve: " + curve);
            }
    }
}
exports._resolveAnimationCurve = _resolveAnimationCurve;
var Animation = (function (_super) {
    __extends(Animation, _super);
    function Animation(animationDefinitions, playSequentially) {
        var _this = _super.call(this, animationDefinitions, playSequentially) || this;
        _this._resetOnFinish = true;
        _this._valueSource = "animation";
        if (animationDefinitions.length > 0 && animationDefinitions[0].valueSource !== undefined) {
            _this._valueSource = animationDefinitions[0].valueSource;
        }
        var that = new WeakRef(_this);
        _this._animatorListener = new android.animation.Animator.AnimatorListener({
            onAnimationStart: function (animator) {
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("MainAnimatorListener.onAndroidAnimationStart(" + animator + ")", animation_common_1.traceCategories.Animation);
                }
            },
            onAnimationRepeat: function (animator) {
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("MainAnimatorListener.onAnimationRepeat(" + animator + ")", animation_common_1.traceCategories.Animation);
                }
            },
            onAnimationEnd: function (animator) {
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("MainAnimatorListener.onAnimationEnd(" + animator + ")", animation_common_1.traceCategories.Animation);
                }
                var thisRef = that.get();
                if (thisRef) {
                    thisRef._onAndroidAnimationEnd();
                }
            },
            onAnimationCancel: function (animator) {
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("MainAnimatorListener.onAnimationCancel(" + animator + ")", animation_common_1.traceCategories.Animation);
                }
                var thisRef = that.get();
                if (thisRef) {
                    thisRef._onAndroidAnimationCancel();
                }
            }
        });
        return _this;
    }
    Animation.prototype.play = function (resetOnFinish) {
        if (resetOnFinish !== undefined) {
            this._resetOnFinish = resetOnFinish;
        }
        if (this.isPlaying) {
            return this._rejectAlreadyPlaying();
        }
        if (this._animatorSet) {
            return this._play();
        }
        this._animators = new Array();
        this._propertyUpdateCallbacks = new Array();
        this._propertyResetCallbacks = new Array();
        for (var i = 0, length_1 = this._propertyAnimations.length; i < length_1; i++) {
            this._createAnimators(this._propertyAnimations[i]);
        }
        this._nativeAnimatorsArray = Array.create(android.animation.Animator, this._animators.length);
        for (var i = 0, length_2 = this._animators.length; i < length_2; i++) {
            this._nativeAnimatorsArray[i] = this._animators[i];
        }
        this._animatorSet = new android.animation.AnimatorSet();
        this._animatorSet.addListener(this._animatorListener);
        return this._play();
    };
    Animation.prototype.cancel = function () {
        if (!this.isPlaying) {
            animation_common_1.traceWrite("Animation is not currently playing.", animation_common_1.traceCategories.Animation, animation_common_1.traceType.warn);
            return;
        }
        animation_common_1.traceWrite("Cancelling AnimatorSet.", animation_common_1.traceCategories.Animation);
        this._animatorSet.cancel();
    };
    Animation.prototype._resolveAnimationCurve = function (curve) {
        return _resolveAnimationCurve(curve);
    };
    Animation.prototype._play = function () {
        var animationFinishedPromise = _super.prototype.play.call(this);
        if (platform_1.device.sdkVersion <= "23") {
            this._animatorSet = new android.animation.AnimatorSet();
            this._animatorSet.addListener(this._animatorListener);
        }
        if (this._animators.length > 0) {
            if (this._playSequentially) {
                this._animatorSet.playSequentially(this._nativeAnimatorsArray);
            }
            else {
                this._animatorSet.playTogether(this._nativeAnimatorsArray);
            }
        }
        if (animation_common_1.traceEnabled()) {
            animation_common_1.traceWrite("Starting " + this._nativeAnimatorsArray.length + " animations " + (this._playSequentially ? "sequentially." : "together."), animation_common_1.traceCategories.Animation);
        }
        this._animatorSet.setupStartValues();
        this._animatorSet.start();
        return animationFinishedPromise;
    };
    Animation.prototype._onAndroidAnimationEnd = function () {
        if (!this.isPlaying) {
            return;
        }
        this._propertyUpdateCallbacks.forEach(function (v) { return v(); });
        this._resolveAnimationFinishedPromise();
        if (this._resetOnFinish && this._target) {
            this._target._removeAnimation(this);
        }
    };
    Animation.prototype._onAndroidAnimationCancel = function () {
        this._propertyResetCallbacks.forEach(function (v) { return v(); });
        this._rejectAnimationFinishedPromise();
        if (this._target) {
            this._target._removeAnimation(this);
        }
    };
    Animation.prototype._createAnimators = function (propertyAnimation) {
        if (!propertyAnimation.target.nativeViewProtected) {
            return;
        }
        if (animation_common_1.traceEnabled()) {
            animation_common_1.traceWrite("Creating ObjectAnimator(s) for animation: " + Animation._getAnimationInfo(propertyAnimation) + "...", animation_common_1.traceCategories.Animation);
        }
        if (propertyAnimation.target === null || propertyAnimation.target === undefined) {
            throw new Error("Animation target cannot be null or undefined; property: " + propertyAnimation.property + "; value: " + propertyAnimation.value + ";");
        }
        if (propertyAnimation.property === null || propertyAnimation.property === undefined) {
            throw new Error("Animation property cannot be null or undefined; target: " + propertyAnimation.target + "; value: " + propertyAnimation.value + ";");
        }
        if (propertyAnimation.value === null || propertyAnimation.value === undefined) {
            throw new Error("Animation value cannot be null or undefined; target: " + propertyAnimation.target + "; property: " + propertyAnimation.property + ";");
        }
        this._target = propertyAnimation.target;
        var nativeArray;
        var nativeView = propertyAnimation.target.nativeViewProtected;
        var animators = new Array();
        var propertyUpdateCallbacks = new Array();
        var propertyResetCallbacks = new Array();
        var originalValue1;
        var originalValue2;
        var density = utils_1.layout.getDisplayDensity();
        var xyObjectAnimators;
        var animatorSet;
        var key = propertyKeys[propertyAnimation.property];
        if (key) {
            propertyAnimation.target[key] = propertyAnimation;
        }
        function checkAnimation(cb) {
            return function () {
                if (propertyAnimation.target[key] === propertyAnimation) {
                    delete propertyAnimation.target[key];
                    cb();
                }
            };
        }
        var setLocal = this._valueSource === "animation";
        var style = propertyAnimation.target.style;
        switch (propertyAnimation.property) {
            case animation_common_1.Properties.opacity:
                style_properties_1.opacityProperty._initDefaultNativeValue(style);
                originalValue1 = nativeView.getAlpha();
                nativeArray = Array.create("float", 1);
                nativeArray[0] = propertyAnimation.value;
                propertyUpdateCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[setLocal ? style_properties_1.opacityProperty.name : style_properties_1.opacityProperty.keyframe] = propertyAnimation.value;
                }));
                propertyResetCallbacks.push(checkAnimation(function () {
                    if (setLocal) {
                        propertyAnimation.target.style[style_properties_1.opacityProperty.name] = originalValue1;
                    }
                    else {
                        propertyAnimation.target.style[style_properties_1.opacityProperty.keyframe] = originalValue1;
                    }
                    if (propertyAnimation.target.nativeViewProtected) {
                        propertyAnimation.target[style_properties_1.opacityProperty.setNative](propertyAnimation.target.style.opacity);
                    }
                }));
                animators.push(android.animation.ObjectAnimator.ofFloat(nativeView, "alpha", nativeArray));
                break;
            case animation_common_1.Properties.backgroundColor:
                style_properties_1.backgroundColorProperty._initDefaultNativeValue(style);
                ensureArgbEvaluator();
                originalValue1 = propertyAnimation.target.backgroundColor;
                nativeArray = Array.create(java.lang.Object, 2);
                nativeArray[0] = propertyAnimation.target.backgroundColor ? java.lang.Integer.valueOf(propertyAnimation.target.backgroundColor.argb) : java.lang.Integer.valueOf(-1);
                nativeArray[1] = java.lang.Integer.valueOf(propertyAnimation.value.argb);
                var animator = android.animation.ValueAnimator.ofObject(argbEvaluator, nativeArray);
                animator.addUpdateListener(new android.animation.ValueAnimator.AnimatorUpdateListener({
                    onAnimationUpdate: function (animator) {
                        var argb = animator.getAnimatedValue().intValue();
                        propertyAnimation.target.style[setLocal ? style_properties_1.backgroundColorProperty.name : style_properties_1.backgroundColorProperty.keyframe] = new animation_common_1.Color(argb);
                    }
                }));
                propertyUpdateCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[setLocal ? style_properties_1.backgroundColorProperty.name : style_properties_1.backgroundColorProperty.keyframe] = propertyAnimation.value;
                }));
                propertyResetCallbacks.push(checkAnimation(function () {
                    if (setLocal) {
                        propertyAnimation.target.style[style_properties_1.backgroundColorProperty.name] = originalValue1;
                    }
                    else {
                        propertyAnimation.target.style[style_properties_1.backgroundColorProperty.keyframe] = originalValue1;
                    }
                    if (propertyAnimation.target.nativeViewProtected && propertyAnimation.target[style_properties_1.backgroundColorProperty.setNative]) {
                        propertyAnimation.target[style_properties_1.backgroundColorProperty.setNative](propertyAnimation.target.style.backgroundColor);
                    }
                }));
                animators.push(animator);
                break;
            case animation_common_1.Properties.translate:
                style_properties_1.translateXProperty._initDefaultNativeValue(style);
                style_properties_1.translateYProperty._initDefaultNativeValue(style);
                xyObjectAnimators = Array.create(android.animation.Animator, 2);
                nativeArray = Array.create("float", 1);
                nativeArray[0] = propertyAnimation.value.x * density;
                xyObjectAnimators[0] = android.animation.ObjectAnimator.ofFloat(nativeView, "translationX", nativeArray);
                xyObjectAnimators[0].setRepeatCount(Animation._getAndroidRepeatCount(propertyAnimation.iterations));
                nativeArray = Array.create("float", 1);
                nativeArray[0] = propertyAnimation.value.y * density;
                xyObjectAnimators[1] = android.animation.ObjectAnimator.ofFloat(nativeView, "translationY", nativeArray);
                xyObjectAnimators[1].setRepeatCount(Animation._getAndroidRepeatCount(propertyAnimation.iterations));
                originalValue1 = nativeView.getTranslationX() / density;
                originalValue2 = nativeView.getTranslationY() / density;
                propertyUpdateCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[setLocal ? style_properties_1.translateXProperty.name : style_properties_1.translateXProperty.keyframe] = propertyAnimation.value.x;
                    propertyAnimation.target.style[setLocal ? style_properties_1.translateYProperty.name : style_properties_1.translateYProperty.keyframe] = propertyAnimation.value.y;
                }));
                propertyResetCallbacks.push(checkAnimation(function () {
                    if (setLocal) {
                        propertyAnimation.target.style[style_properties_1.translateXProperty.name] = originalValue1;
                        propertyAnimation.target.style[style_properties_1.translateYProperty.name] = originalValue2;
                    }
                    else {
                        propertyAnimation.target.style[style_properties_1.translateXProperty.keyframe] = originalValue1;
                        propertyAnimation.target.style[style_properties_1.translateYProperty.keyframe] = originalValue2;
                    }
                    if (propertyAnimation.target.nativeViewProtected) {
                        propertyAnimation.target[style_properties_1.translateXProperty.setNative](propertyAnimation.target.style.translateX);
                        propertyAnimation.target[style_properties_1.translateYProperty.setNative](propertyAnimation.target.style.translateY);
                    }
                }));
                animatorSet = new android.animation.AnimatorSet();
                animatorSet.playTogether(xyObjectAnimators);
                animatorSet.setupStartValues();
                animators.push(animatorSet);
                break;
            case animation_common_1.Properties.scale:
                style_properties_1.scaleXProperty._initDefaultNativeValue(style);
                style_properties_1.scaleYProperty._initDefaultNativeValue(style);
                xyObjectAnimators = Array.create(android.animation.Animator, 2);
                nativeArray = Array.create("float", 1);
                nativeArray[0] = propertyAnimation.value.x;
                xyObjectAnimators[0] = android.animation.ObjectAnimator.ofFloat(nativeView, "scaleX", nativeArray);
                xyObjectAnimators[0].setRepeatCount(Animation._getAndroidRepeatCount(propertyAnimation.iterations));
                nativeArray = Array.create("float", 1);
                nativeArray[0] = propertyAnimation.value.y;
                xyObjectAnimators[1] = android.animation.ObjectAnimator.ofFloat(nativeView, "scaleY", nativeArray);
                xyObjectAnimators[1].setRepeatCount(Animation._getAndroidRepeatCount(propertyAnimation.iterations));
                originalValue1 = nativeView.getScaleX();
                originalValue2 = nativeView.getScaleY();
                propertyUpdateCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[setLocal ? style_properties_1.scaleXProperty.name : style_properties_1.scaleXProperty.keyframe] = propertyAnimation.value.x;
                    propertyAnimation.target.style[setLocal ? style_properties_1.scaleYProperty.name : style_properties_1.scaleYProperty.keyframe] = propertyAnimation.value.y;
                }));
                propertyResetCallbacks.push(checkAnimation(function () {
                    if (setLocal) {
                        propertyAnimation.target.style[style_properties_1.scaleXProperty.name] = originalValue1;
                        propertyAnimation.target.style[style_properties_1.scaleYProperty.name] = originalValue2;
                    }
                    else {
                        propertyAnimation.target.style[style_properties_1.scaleXProperty.keyframe] = originalValue1;
                        propertyAnimation.target.style[style_properties_1.scaleYProperty.keyframe] = originalValue2;
                    }
                    if (propertyAnimation.target.nativeViewProtected) {
                        propertyAnimation.target[style_properties_1.scaleXProperty.setNative](propertyAnimation.target.style.scaleX);
                        propertyAnimation.target[style_properties_1.scaleYProperty.setNative](propertyAnimation.target.style.scaleY);
                    }
                }));
                animatorSet = new android.animation.AnimatorSet();
                animatorSet.playTogether(xyObjectAnimators);
                animatorSet.setupStartValues();
                animators.push(animatorSet);
                break;
            case animation_common_1.Properties.rotate:
                style_properties_1.rotateProperty._initDefaultNativeValue(style);
                originalValue1 = nativeView.getRotation();
                nativeArray = Array.create("float", 1);
                nativeArray[0] = propertyAnimation.value;
                propertyUpdateCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[setLocal ? style_properties_1.rotateProperty.name : style_properties_1.rotateProperty.keyframe] = propertyAnimation.value;
                }));
                propertyResetCallbacks.push(checkAnimation(function () {
                    if (setLocal) {
                        propertyAnimation.target.style[style_properties_1.rotateProperty.name] = originalValue1;
                    }
                    else {
                        propertyAnimation.target.style[style_properties_1.rotateProperty.keyframe] = originalValue1;
                    }
                    if (propertyAnimation.target.nativeViewProtected) {
                        propertyAnimation.target[style_properties_1.rotateProperty.setNative](propertyAnimation.target.style.rotate);
                    }
                }));
                animators.push(android.animation.ObjectAnimator.ofFloat(nativeView, "rotation", nativeArray));
                break;
            case animation_common_1.Properties.width:
            case animation_common_1.Properties.height: {
                var isVertical = propertyAnimation.property === "height";
                var extentProperty_1 = isVertical ? style_properties_1.heightProperty : style_properties_1.widthProperty;
                extentProperty_1._initDefaultNativeValue(style);
                nativeArray = Array.create("float", 2);
                var toValue = propertyAnimation.value;
                var parent_1 = propertyAnimation.target.parent;
                if (!parent_1) {
                    throw new Error("cannot animate " + propertyAnimation.property + " on root view");
                }
                var parentExtent = isVertical ? parent_1.getMeasuredHeight() : parent_1.getMeasuredWidth();
                toValue = style_properties_1.PercentLength.toDevicePixels(toValue, parentExtent, parentExtent) / platform_1.screen.mainScreen.scale;
                var nativeHeight = isVertical ? nativeView.getHeight() : nativeView.getWidth();
                var targetStyle_1 = setLocal ? extentProperty_1.name : extentProperty_1.keyframe;
                originalValue1 = nativeHeight / platform_1.screen.mainScreen.scale;
                nativeArray[0] = originalValue1;
                nativeArray[1] = toValue;
                var extentAnimator = android.animation.ValueAnimator.ofFloat(nativeArray);
                extentAnimator.addUpdateListener(new android.animation.ValueAnimator.AnimatorUpdateListener({
                    onAnimationUpdate: function (animator) {
                        var argb = animator.getAnimatedValue().floatValue();
                        propertyAnimation.target.style[setLocal ? extentProperty_1.name : extentProperty_1.keyframe] = argb;
                    }
                }));
                propertyUpdateCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[targetStyle_1] = propertyAnimation.value;
                }));
                propertyResetCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[targetStyle_1] = originalValue1;
                    if (propertyAnimation.target.nativeViewProtected) {
                        var setter = propertyAnimation.target[extentProperty_1.setNative];
                        setter(propertyAnimation.target.style[propertyAnimation.property]);
                    }
                }));
                animators.push(extentAnimator);
                break;
            }
            default:
                throw new Error("Animating property '" + propertyAnimation.property + "' is unsupported");
        }
        for (var i = 0, length_3 = animators.length; i < length_3; i++) {
            if (propertyAnimation.duration !== undefined) {
                animators[i].setDuration(propertyAnimation.duration);
            }
            if (propertyAnimation.delay !== undefined) {
                animators[i].setStartDelay(propertyAnimation.delay);
            }
            if (propertyAnimation.iterations !== undefined && animators[i] instanceof android.animation.ValueAnimator) {
                animators[i].setRepeatCount(Animation._getAndroidRepeatCount(propertyAnimation.iterations));
            }
            if (propertyAnimation.curve !== undefined) {
                animators[i].setInterpolator(propertyAnimation.curve);
            }
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animator created: " + animators[i], animation_common_1.traceCategories.Animation);
            }
        }
        this._animators = this._animators.concat(animators);
        this._propertyUpdateCallbacks = this._propertyUpdateCallbacks.concat(propertyUpdateCallbacks);
        this._propertyResetCallbacks = this._propertyResetCallbacks.concat(propertyResetCallbacks);
    };
    Animation._getAndroidRepeatCount = function (iterations) {
        return (iterations === Number.POSITIVE_INFINITY) ? android.view.animation.Animation.INFINITE : iterations - 1;
    };
    return Animation;
}(animation_common_1.AnimationBase));
exports.Animation = Animation;
//# sourceMappingURL=animation.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/animation/keyframe-animation.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var enums_1 = __webpack_require__("../node_modules/tns-core-modules/ui/enums/enums.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var animation_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var Keyframes = (function () {
    function Keyframes() {
    }
    return Keyframes;
}());
exports.Keyframes = Keyframes;
var UnparsedKeyframe = (function () {
    function UnparsedKeyframe() {
    }
    return UnparsedKeyframe;
}());
exports.UnparsedKeyframe = UnparsedKeyframe;
var KeyframeDeclaration = (function () {
    function KeyframeDeclaration() {
    }
    return KeyframeDeclaration;
}());
exports.KeyframeDeclaration = KeyframeDeclaration;
var KeyframeInfo = (function () {
    function KeyframeInfo() {
        this.curve = enums_1.AnimationCurve.ease;
    }
    return KeyframeInfo;
}());
exports.KeyframeInfo = KeyframeInfo;
var KeyframeAnimationInfo = (function () {
    function KeyframeAnimationInfo() {
        this.name = "";
        this.duration = 0.3;
        this.delay = 0;
        this.iterations = 1;
        this.curve = "ease";
        this.isForwards = false;
        this.isReverse = false;
    }
    return KeyframeAnimationInfo;
}());
exports.KeyframeAnimationInfo = KeyframeAnimationInfo;
var KeyframeAnimation = (function () {
    function KeyframeAnimation() {
        this.delay = 0;
        this.iterations = 1;
    }
    KeyframeAnimation.keyframeAnimationFromInfo = function (info) {
        var length = info.keyframes.length;
        var animations = new Array();
        var startDuration = 0;
        if (info.isReverse) {
            for (var index_1 = length - 1; index_1 >= 0; index_1--) {
                var keyframe = info.keyframes[index_1];
                startDuration = KeyframeAnimation.parseKeyframe(info, keyframe, animations, startDuration);
            }
        }
        else {
            for (var index_2 = 0; index_2 < length; index_2++) {
                var keyframe = info.keyframes[index_2];
                startDuration = KeyframeAnimation.parseKeyframe(info, keyframe, animations, startDuration);
            }
            for (var index_3 = length - 1; index_3 > 0; index_3--) {
                var a1 = animations[index_3];
                var a2 = animations[index_3 - 1];
                if (a2["curve"] !== undefined) {
                    a1["curve"] = a2["curve"];
                    a2["curve"] = undefined;
                }
            }
        }
        animations.map(function (a) { return a["curve"] ? a : Object.assign(a, { curve: info.curve }); });
        var animation = new KeyframeAnimation();
        animation.delay = info.delay;
        animation.iterations = info.iterations;
        animation.animations = animations;
        animation._isForwards = info.isForwards;
        return animation;
    };
    KeyframeAnimation.parseKeyframe = function (info, keyframe, animations, startDuration) {
        var animation = {};
        for (var _i = 0, _a = keyframe.declarations; _i < _a.length; _i++) {
            var declaration = _a[_i];
            animation[declaration.property] = declaration.value;
        }
        var duration = keyframe.duration;
        if (duration === 0) {
            duration = 0.01;
        }
        else {
            duration = (info.duration * duration) - startDuration;
            startDuration += duration;
        }
        animation.duration = info.isReverse ? info.duration - duration : duration;
        animation.curve = keyframe.curve;
        animation.forceLayer = true;
        animation.valueSource = "keyframe";
        animations.push(animation);
        return startDuration;
    };
    Object.defineProperty(KeyframeAnimation.prototype, "isPlaying", {
        get: function () {
            return this._isPlaying;
        },
        enumerable: true,
        configurable: true
    });
    KeyframeAnimation.prototype.cancel = function () {
        if (!this.isPlaying) {
            trace_1.write("Keyframe animation is already playing.", trace_1.categories.Animation, trace_1.messageType.warn);
            return;
        }
        this._isPlaying = false;
        for (var i = this._nativeAnimations.length - 1; i >= 0; i--) {
            var animation = this._nativeAnimations[i];
            if (animation.isPlaying) {
                animation.cancel();
            }
        }
        if (this._nativeAnimations.length > 0) {
            var animation = this._nativeAnimations[0];
            this._resetAnimationValues(this._target, animation);
        }
        this._resetAnimations();
    };
    KeyframeAnimation.prototype.play = function (view) {
        var _this = this;
        if (this._isPlaying) {
            trace_1.write("Keyframe animation is already playing.", trace_1.categories.Animation, trace_1.messageType.warn);
            return new Promise(function (resolve) {
                resolve();
            });
        }
        var animationFinishedPromise = new Promise(function (resolve) {
            _this._resolve = resolve;
        });
        this._isPlaying = true;
        this._nativeAnimations = new Array();
        this._target = view;
        if (this.delay !== 0) {
            setTimeout(function () { return _this.animate(view, 0, _this.iterations); }, this.delay);
        }
        else {
            this.animate(view, 0, this.iterations);
        }
        return animationFinishedPromise;
    };
    KeyframeAnimation.prototype.animate = function (view, index, iterations) {
        var _this = this;
        if (!this._isPlaying) {
            return;
        }
        if (index === 0) {
            var animation = this.animations[0];
            if ("backgroundColor" in animation) {
                view.style[style_properties_1.backgroundColorProperty.keyframe] = animation.backgroundColor;
            }
            if ("scale" in animation) {
                view.style[style_properties_1.scaleXProperty.keyframe] = animation.scale.x;
                view.style[style_properties_1.scaleYProperty.keyframe] = animation.scale.y;
            }
            if ("translate" in animation) {
                view.style[style_properties_1.translateXProperty.keyframe] = animation.translate.x;
                view.style[style_properties_1.translateYProperty.keyframe] = animation.translate.y;
            }
            if ("rotate" in animation) {
                view.style[style_properties_1.rotateProperty.keyframe] = animation.rotate;
            }
            if ("opacity" in animation) {
                view.style[style_properties_1.opacityProperty.keyframe] = animation.opacity;
            }
            if ("height" in animation) {
                view.style[style_properties_1.heightProperty.keyframe] = animation.height;
            }
            if ("width" in animation) {
                view.style[style_properties_1.widthProperty.keyframe] = animation.width;
            }
            setTimeout(function () { return _this.animate(view, 1, iterations); }, 1);
        }
        else if (index < 0 || index >= this.animations.length) {
            iterations -= 1;
            if (iterations > 0) {
                this.animate(view, 0, iterations);
            }
            else {
                if (this._isForwards === false) {
                    var animation = this.animations[this.animations.length - 1];
                    this._resetAnimationValues(view, animation);
                }
                this._resolveAnimationFinishedPromise();
            }
        }
        else {
            var animation = void 0;
            var cachedAnimation = this._nativeAnimations[index - 1];
            if (cachedAnimation) {
                animation = cachedAnimation;
            }
            else {
                var animationDef = this.animations[index];
                animationDef.target = view;
                animation = new animation_1.Animation([animationDef]);
                this._nativeAnimations.push(animation);
            }
            var isLastIteration = iterations - 1 <= 0;
            animation.play(isLastIteration).then(function () {
                _this.animate(view, index + 1, iterations);
            }, function (error) {
                trace_1.write(typeof error === "string" ? error : error.message, trace_1.categories.Animation, trace_1.messageType.warn);
            }).catch(function (error) {
                trace_1.write(typeof error === "string" ? error : error.message, trace_1.categories.Animation, trace_1.messageType.warn);
            });
        }
    };
    KeyframeAnimation.prototype._resolveAnimationFinishedPromise = function () {
        this._nativeAnimations = new Array();
        this._isPlaying = false;
        this._target = null;
        this._resolve();
    };
    KeyframeAnimation.prototype._resetAnimations = function () {
        this._nativeAnimations = new Array();
        this._isPlaying = false;
        this._target = null;
    };
    KeyframeAnimation.prototype._resetAnimationValues = function (view, animation) {
        if ("backgroundColor" in animation) {
            view.style[style_properties_1.backgroundColorProperty.keyframe] = properties_1.unsetValue;
        }
        if ("scale" in animation) {
            view.style[style_properties_1.scaleXProperty.keyframe] = properties_1.unsetValue;
            view.style[style_properties_1.scaleYProperty.keyframe] = properties_1.unsetValue;
        }
        if ("translate" in animation) {
            view.style[style_properties_1.translateXProperty.keyframe] = properties_1.unsetValue;
            view.style[style_properties_1.translateYProperty.keyframe] = properties_1.unsetValue;
        }
        if ("rotate" in animation) {
            view.style[style_properties_1.rotateProperty.keyframe] = properties_1.unsetValue;
        }
        if ("opacity" in animation) {
            view.style[style_properties_1.opacityProperty.keyframe] = properties_1.unsetValue;
        }
        if ("height" in animation) {
            view.style[style_properties_1.heightProperty.keyframe] = properties_1.unsetValue;
        }
        if ("width" in animation) {
            view.style[style_properties_1.widthProperty.keyframe] = properties_1.unsetValue;
        }
    };
    return KeyframeAnimation;
}());
exports.KeyframeAnimation = KeyframeAnimation;
//# sourceMappingURL=keyframe-animation.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/border/border.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var content_view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js");
var Border = (function (_super) {
    __extends(Border, _super);
    function Border() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Border.prototype, "cornerRadius", {
        get: function () {
            if (typeof this.borderRadius === "number") {
                return this.borderRadius;
            }
            return 0;
        },
        set: function (value) {
            this.borderRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Border.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var width = content_view_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = content_view_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = content_view_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = content_view_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var horizontalBorderLength = this.effectiveBorderLeftWidth + this.effectiveBorderRightWidth;
        var verticalBorderLength = this.effectiveBorderTopWidth + this.effectiveBorderBottomWidth;
        var result = content_view_1.View.measureChild(this, this.layoutView, content_view_1.layout.makeMeasureSpec(width - horizontalBorderLength, widthMode), content_view_1.layout.makeMeasureSpec(height - verticalBorderLength, heightMode));
        var widthAndState = content_view_1.View.resolveSizeAndState(result.measuredWidth + horizontalBorderLength, width, widthMode, 0);
        var heightAndState = content_view_1.View.resolveSizeAndState(result.measuredHeight + verticalBorderLength, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    Border.prototype.onLayout = function (left, top, right, bottom) {
        var horizontalBorderLength = this.effectiveBorderLeftWidth + this.effectiveBorderRightWidth;
        var verticalBorderLength = this.effectiveBorderTopWidth + this.effectiveBorderBottomWidth;
        content_view_1.View.layoutChild(this, this.layoutView, this.effectiveBorderLeftWidth, this.effectiveBorderTopWidth, right - left - horizontalBorderLength, bottom - top - verticalBorderLength);
    };
    Border = __decorate([
        Deprecated,
        content_view_1.CSSType("Border")
    ], Border);
    return Border;
}(content_view_1.ContentView));
exports.Border = Border;
Border.prototype.recycleNativeView = "auto";
//# sourceMappingURL=border.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/bottom-navigation/bottom-navigation.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var tab_strip_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js");
var tab_strip_item_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js");
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var tab_navigation_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js"));
var PRIMARY_COLOR = "colorPrimary";
var DEFAULT_ELEVATION = 8;
var TABID = "_tabId";
var INDEX = "_index";
var ownerSymbol = Symbol("_owner");
var TabFragment;
var BottomNavigationBar;
var AttachStateChangeListener;
function makeFragmentName(viewId, id) {
    return "android:bottomnavigation:" + viewId + ":" + id;
}
function getTabById(id) {
    var ref = exports.tabs.find(function (ref) {
        var tab = ref.get();
        return tab && tab._domId === id;
    });
    return ref && ref.get();
}
function initializeNativeClasses() {
    if (BottomNavigationBar) {
        return;
    }
    var TabFragmentImplementation = (function (_super) {
        __extends(TabFragmentImplementation, _super);
        function TabFragmentImplementation() {
            var _this = _super.call(this) || this;
            return global.__native(_this);
        }
        TabFragmentImplementation.newInstance = function (tabId, index) {
            var args = new android.os.Bundle();
            args.putInt(TABID, tabId);
            args.putInt(INDEX, index);
            var fragment = new TabFragmentImplementation();
            fragment.setArguments(args);
            return fragment;
        };
        TabFragmentImplementation.prototype.onCreate = function (savedInstanceState) {
            _super.prototype.onCreate.call(this, savedInstanceState);
            var args = this.getArguments();
            this.tab = getTabById(args.getInt(TABID));
            this.index = args.getInt(INDEX);
            if (!this.tab) {
                throw new Error("Cannot find BottomNavigation");
            }
        };
        TabFragmentImplementation.prototype.onCreateView = function (inflater, container, savedInstanceState) {
            var tabItem = this.tab.items[this.index];
            return tabItem.nativeViewProtected;
        };
        return TabFragmentImplementation;
    }(org.nativescript.widgets.FragmentBase));
    var BottomNavigationBarImplementation = (function (_super) {
        __extends(BottomNavigationBarImplementation, _super);
        function BottomNavigationBarImplementation(context, owner) {
            var _this = _super.call(this, context) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        BottomNavigationBarImplementation.prototype.onSelectedPositionChange = function (position, prevPosition) {
            var owner = this.owner;
            if (!owner) {
                return;
            }
            owner.changeTab(position);
            var tabStripItems = owner.tabStrip && owner.tabStrip.items;
            if (position >= 0 && tabStripItems && tabStripItems[position]) {
                tabStripItems[position]._emit(tab_strip_item_1.TabStripItem.selectEvent);
            }
            if (prevPosition >= 0 && tabStripItems && tabStripItems[prevPosition]) {
                tabStripItems[prevPosition]._emit(tab_strip_item_1.TabStripItem.unselectEvent);
            }
            owner.selectedIndex = position;
        };
        BottomNavigationBarImplementation.prototype.onTap = function (position) {
            var owner = this.owner;
            if (!owner) {
                return false;
            }
            var tabStrip = owner.tabStrip;
            var tabStripItems = tabStrip && tabStrip.items;
            if (position >= 0 && tabStripItems[position]) {
                tabStripItems[position]._emit(tab_strip_item_1.TabStripItem.tapEvent);
                tabStrip.notify({ eventName: tab_strip_1.TabStrip.itemTapEvent, object: tabStrip, index: position });
            }
            if (!owner.items[position]) {
                return false;
            }
            return true;
        };
        return BottomNavigationBarImplementation;
    }(org.nativescript.widgets.BottomNavigationBar));
    var AttachListener = (function (_super) {
        __extends(AttachListener, _super);
        function AttachListener() {
            var _this = _super.call(this) || this;
            return global.__native(_this);
        }
        AttachListener.prototype.onViewAttachedToWindow = function (view) {
            var owner = view[ownerSymbol];
            if (owner) {
                owner._onAttachedToWindow();
            }
        };
        AttachListener.prototype.onViewDetachedFromWindow = function (view) {
            var owner = view[ownerSymbol];
            if (owner) {
                owner._onDetachedFromWindow();
            }
        };
        AttachListener = __decorate([
            Interfaces([android.view.View.OnAttachStateChangeListener])
        ], AttachListener);
        return AttachListener;
    }(java.lang.Object));
    TabFragment = TabFragmentImplementation;
    BottomNavigationBar = BottomNavigationBarImplementation;
    AttachStateChangeListener = new AttachListener();
}
function setElevation(bottomNavigationBar) {
    var compat = androidx.core.view.ViewCompat;
    if (compat.setElevation) {
        var val = DEFAULT_ELEVATION * utils_1.layout.getDisplayDensity();
        compat.setElevation(bottomNavigationBar, val);
    }
}
exports.tabs = new Array();
function iterateIndexRange(index, eps, lastIndex, callback) {
    var rangeStart = Math.max(0, index - eps);
    var rangeEnd = Math.min(index + eps, lastIndex);
    for (var i = rangeStart; i <= rangeEnd; i++) {
        callback(i);
    }
}
var BottomNavigation = (function (_super) {
    __extends(BottomNavigation, _super);
    function BottomNavigation() {
        var _this = _super.call(this) || this;
        _this._contentViewId = -1;
        _this._attachedToWindow = false;
        exports.tabs.push(new WeakRef(_this));
        return _this;
    }
    Object.defineProperty(BottomNavigation.prototype, "_hasFragments", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    BottomNavigation.prototype.onItemsChanged = function (oldItems, newItems) {
        _super.prototype.onItemsChanged.call(this, oldItems, newItems);
        if (oldItems) {
            oldItems.forEach(function (item, i, arr) {
                item.index = 0;
                item.tabItemSpec = null;
                item.setNativeView(null);
            });
        }
    };
    BottomNavigation.prototype.createNativeView = function () {
        initializeNativeClasses();
        var context = this._context;
        var nativeView = new org.nativescript.widgets.GridLayout(context);
        nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
        nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.auto));
        var contentView = new org.nativescript.widgets.ContentLayout(this._context);
        var contentViewLayoutParams = new org.nativescript.widgets.CommonLayoutParams();
        contentViewLayoutParams.row = 0;
        contentView.setLayoutParams(contentViewLayoutParams);
        nativeView.addView(contentView);
        nativeView.contentView = contentView;
        var bottomNavigationBar = new BottomNavigationBar(context, this);
        var bottomNavigationBarLayoutParams = new org.nativescript.widgets.CommonLayoutParams();
        bottomNavigationBarLayoutParams.row = 1;
        bottomNavigationBar.setLayoutParams(bottomNavigationBarLayoutParams);
        nativeView.addView(bottomNavigationBar);
        nativeView.bottomNavigationBar = bottomNavigationBar;
        setElevation(bottomNavigationBar);
        var primaryColor = utils_1.ad.resources.getPaletteColor(PRIMARY_COLOR, context);
        if (primaryColor) {
            bottomNavigationBar.setBackgroundColor(primaryColor);
        }
        return nativeView;
    };
    BottomNavigation.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        if (this._contentViewId < 0) {
            this._contentViewId = android.view.View.generateViewId();
        }
        var nativeView = this.nativeViewProtected;
        nativeView.addOnAttachStateChangeListener(AttachStateChangeListener);
        nativeView[ownerSymbol] = this;
        this._contentView = nativeView.contentView;
        this._contentView.setId(this._contentViewId);
        this._bottomNavigationBar = nativeView.bottomNavigationBar;
        this._bottomNavigationBar.owner = this;
        if (this.tabStrip) {
            this.tabStrip.setNativeView(this._bottomNavigationBar);
        }
    };
    BottomNavigation.prototype._loadUnloadTabItems = function (newIndex) {
        var _this = this;
        var items = this.items;
        var lastIndex = this.items.length - 1;
        var offsideItems = 0;
        var toUnload = [];
        var toLoad = [];
        iterateIndexRange(newIndex, offsideItems, lastIndex, function (i) { return toLoad.push(i); });
        items.forEach(function (item, i) {
            var indexOfI = toLoad.indexOf(i);
            if (indexOfI < 0) {
                toUnload.push(i);
            }
        });
        toUnload.forEach(function (index) {
            var item = items[index];
            if (items[index]) {
                item.unloadView(item.content);
            }
        });
        var newItem = items[newIndex];
        var selectedView = newItem && newItem.content;
        if (selectedView instanceof frame_1.Frame) {
            selectedView._pushInFrameStackRecursive();
        }
        toLoad.forEach(function (index) {
            var item = items[index];
            if (_this.isLoaded && items[index]) {
                item.loadView(item.content);
            }
        });
    };
    BottomNavigation.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        if (this.tabStrip) {
            this.setTabStripItems(this.tabStrip.items);
        }
        else {
            this._bottomNavigationBar.setVisibility(android.view.View.GONE);
        }
        if (this._attachedToWindow) {
            this.changeTab(this.selectedIndex);
        }
    };
    BottomNavigation.prototype._onAttachedToWindow = function () {
        _super.prototype._onAttachedToWindow.call(this);
        this._attachedToWindow = true;
        this.changeTab(this.selectedIndex);
    };
    BottomNavigation.prototype._onDetachedFromWindow = function () {
        _super.prototype._onDetachedFromWindow.call(this);
        this._attachedToWindow = false;
    };
    BottomNavigation.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        if (this.tabStrip) {
            this.setTabStripItems(null);
        }
        var fragmentToDetach = this._currentFragment;
        if (fragmentToDetach) {
            this.destroyItem(fragmentToDetach.index, fragmentToDetach);
            this.commitCurrentTransaction();
        }
    };
    BottomNavigation.prototype.disposeNativeView = function () {
        this._bottomNavigationBar.setItems(null);
        this._bottomNavigationBar = null;
        this.nativeViewProtected.removeOnAttachStateChangeListener(AttachStateChangeListener);
        this.nativeViewProtected[ownerSymbol] = null;
        _super.prototype.disposeNativeView.call(this);
    };
    BottomNavigation.prototype._onRootViewReset = function () {
        _super.prototype._onRootViewReset.call(this);
        this.disposeTabFragments();
    };
    BottomNavigation.prototype.disposeTabFragments = function () {
        var fragmentManager = this._getFragmentManager();
        var transaction = fragmentManager.beginTransaction();
        for (var _i = 0, _a = fragmentManager.getFragments().toArray(); _i < _a.length; _i++) {
            var fragment = _a[_i];
            transaction.remove(fragment);
        }
        transaction.commitNowAllowingStateLoss();
    };
    Object.defineProperty(BottomNavigation.prototype, "currentTransaction", {
        get: function () {
            if (!this._currentTransaction) {
                var fragmentManager = this._getFragmentManager();
                this._currentTransaction = fragmentManager.beginTransaction();
            }
            return this._currentTransaction;
        },
        enumerable: true,
        configurable: true
    });
    BottomNavigation.prototype.commitCurrentTransaction = function () {
        if (this._currentTransaction) {
            this._currentTransaction.commitNowAllowingStateLoss();
            this._currentTransaction = null;
        }
    };
    BottomNavigation.prototype.changeTab = function (index) {
        if (index === -1) {
            return;
        }
        var fragmentToDetach = this._currentFragment;
        if (fragmentToDetach) {
            this.destroyItem(fragmentToDetach.index, fragmentToDetach);
        }
        var fragment = this.instantiateItem(this._contentView, index);
        this.setPrimaryItem(index, fragment);
        this.commitCurrentTransaction();
    };
    BottomNavigation.prototype.instantiateItem = function (container, position) {
        var name = makeFragmentName(container.getId(), position);
        var fragmentManager = this._getFragmentManager();
        var fragment = fragmentManager.findFragmentByTag(name);
        if (fragment != null) {
            this.currentTransaction.attach(fragment);
        }
        else {
            fragment = TabFragment.newInstance(this._domId, position);
            this.currentTransaction.add(container.getId(), fragment, name);
        }
        if (fragment !== this._currentFragment) {
            fragment.setMenuVisibility(false);
            fragment.setUserVisibleHint(false);
        }
        return fragment;
    };
    BottomNavigation.prototype.setPrimaryItem = function (position, fragment) {
        if (fragment !== this._currentFragment) {
            if (this._currentFragment != null) {
                this._currentFragment.setMenuVisibility(false);
                this._currentFragment.setUserVisibleHint(false);
            }
            if (fragment != null) {
                fragment.setMenuVisibility(true);
                fragment.setUserVisibleHint(true);
            }
            this._currentFragment = fragment;
            var tabItems = this.items;
            var tabItem = tabItems ? tabItems[position] : null;
            if (tabItem) {
                tabItem.canBeLoaded = true;
                this._loadUnloadTabItems(position);
            }
        }
    };
    BottomNavigation.prototype.destroyItem = function (position, fragment) {
        if (fragment) {
            this.currentTransaction.detach(fragment);
            if (this._currentFragment === fragment) {
                this._currentFragment = null;
            }
        }
        if (this.items && this.items[position]) {
            this.items[position].canBeLoaded = false;
        }
    };
    BottomNavigation.prototype.setTabStripItems = function (items) {
        var _this = this;
        if (!this.tabStrip || !items) {
            this._bottomNavigationBar.setItems(null);
            return;
        }
        var tabItems = new Array();
        items.forEach(function (item, i, arr) {
            item.index = i;
            if (items[i]) {
                var tabItemSpec = _this.createTabItemSpec(items[i]);
                tabItems.push(tabItemSpec);
            }
        });
        this._bottomNavigationBar.setItems(tabItems);
        items.forEach(function (item, i, arr) {
            var textView = _this._bottomNavigationBar.getTextViewForItemAt(i);
            item.setNativeView(textView);
        });
    };
    BottomNavigation.prototype.createTabItemSpec = function (tabStripItem) {
        var tabItemSpec = new org.nativescript.widgets.TabItemSpec();
        if (tabStripItem.isLoaded) {
            var titleLabel = tabStripItem.label;
            var title = titleLabel.text;
            var textTransform = titleLabel.style.textTransform;
            if (textTransform) {
                title = text_base_1.getTransformedText(title, textTransform);
            }
            tabItemSpec.title = title;
            var backgroundColor = tabStripItem.style.backgroundColor;
            if (backgroundColor) {
                tabItemSpec.backgroundColor = backgroundColor.android;
            }
            var color = titleLabel.style.color;
            if (color) {
                tabItemSpec.color = color.android;
            }
            var fontInternal = titleLabel.style.fontInternal;
            if (fontInternal) {
                tabItemSpec.fontSize = fontInternal.fontSize;
                tabItemSpec.typeFace = fontInternal.getAndroidTypeface();
            }
            var iconSource = tabStripItem.image && tabStripItem.image.src;
            if (iconSource) {
                var icon = this.getIcon(tabStripItem);
                if (icon) {
                    tabItemSpec.iconDrawable = icon;
                }
                else {
                }
            }
        }
        return tabItemSpec;
    };
    BottomNavigation.prototype.getIcon = function (tabStripItem) {
        var iconSource = tabStripItem.image && tabStripItem.image.src;
        var is;
        if (utils_1.isFontIconURI(iconSource)) {
            var fontIconCode = iconSource.split("//")[1];
            var target = tabStripItem.image ? tabStripItem.image : tabStripItem;
            var font = target.style.fontInternal;
            var color = target.style.color;
            is = image_source_1.fromFontIconCode(fontIconCode, font, color);
        }
        else {
            is = image_source_1.fromFileOrResource(iconSource);
        }
        var imageDrawable;
        if (is && is.android) {
            var image = is.android;
            if (this.tabStrip && this.tabStrip.isIconSizeFixed) {
                image = this.getFixedSizeIcon(image);
            }
            imageDrawable = new android.graphics.drawable.BitmapDrawable(application.android.context.getResources(), image);
        }
        else {
        }
        return imageDrawable;
    };
    BottomNavigation.prototype.getFixedSizeIcon = function (image) {
        var inWidth = image.getWidth();
        var inHeight = image.getHeight();
        var iconSpecSize = tab_navigation_base_1.getIconSpecSize({ width: inWidth, height: inHeight });
        var widthPixels = iconSpecSize.width * utils_1.layout.getDisplayDensity();
        var heightPixels = iconSpecSize.height * utils_1.layout.getDisplayDensity();
        var scaledImage = android.graphics.Bitmap.createScaledBitmap(image, widthPixels, heightPixels, true);
        return scaledImage;
    };
    BottomNavigation.prototype.updateAndroidItemAt = function (index, spec) {
        this._bottomNavigationBar.updateItemAt(index, spec);
    };
    BottomNavigation.prototype.getTabBarBackgroundColor = function () {
        return this._bottomNavigationBar.getBackground();
    };
    BottomNavigation.prototype.setTabBarBackgroundColor = function (value) {
        if (value instanceof view_1.Color) {
            this._bottomNavigationBar.setBackgroundColor(value.android);
        }
        else {
            this._bottomNavigationBar.setBackground(tryCloneDrawable(value, this.nativeViewProtected.getResources));
        }
    };
    BottomNavigation.prototype.setTabBarItemTitle = function (tabStripItem, value) {
        var tabStripItemIndex = this.tabStrip.items.indexOf(tabStripItem);
        var tabItemSpec = this.createTabItemSpec(tabStripItem);
        this.updateAndroidItemAt(tabStripItemIndex, tabItemSpec);
    };
    BottomNavigation.prototype.setTabBarItemBackgroundColor = function (tabStripItem, value) {
        var tabStripItemIndex = this.tabStrip.items.indexOf(tabStripItem);
        var tabItemSpec = this.createTabItemSpec(tabStripItem);
        this.updateAndroidItemAt(tabStripItemIndex, tabItemSpec);
    };
    BottomNavigation.prototype.setTabBarItemColor = function (tabStripItem, value) {
        if (typeof value === "number") {
            tabStripItem.nativeViewProtected.setTextColor(value);
        }
        else {
            tabStripItem.nativeViewProtected.setTextColor(value.android);
        }
    };
    BottomNavigation.prototype.setTabBarIconColor = function (tabStripItem, value) {
        var index = tabStripItem.index;
        var tabBarItem = this._bottomNavigationBar.getViewForItemAt(index);
        var imgView = tabBarItem.getChildAt(0);
        var drawable = this.getIcon(tabStripItem);
        imgView.setImageDrawable(drawable);
    };
    BottomNavigation.prototype.setTabBarItemFontInternal = function (tabStripItem, value) {
        tabStripItem.nativeViewProtected.setTextSize(value.fontSize);
        tabStripItem.nativeViewProtected.setTypeface(value.getAndroidTypeface());
    };
    BottomNavigation.prototype.setTabBarItemTextTransform = function (tabStripItem, value) {
        var titleLabel = tabStripItem.label;
        var title = text_base_1.getTransformedText(titleLabel.text, value);
        tabStripItem.nativeViewProtected.setText(title);
    };
    BottomNavigation.prototype[tab_navigation_base_1.selectedIndexProperty.setNative] = function (value) {
        if (this.tabStrip) {
            this._bottomNavigationBar.setSelectedPosition(value);
        }
        else {
            this.changeTab(value);
        }
    };
    BottomNavigation.prototype[tab_navigation_base_1.itemsProperty.getDefault] = function () {
        return null;
    };
    BottomNavigation.prototype[tab_navigation_base_1.itemsProperty.setNative] = function (value) {
        if (value) {
            value.forEach(function (item, i) {
                item.index = i;
            });
        }
        tab_navigation_base_1.selectedIndexProperty.coerce(this);
    };
    BottomNavigation.prototype[tab_navigation_base_1.tabStripProperty.getDefault] = function () {
        return null;
    };
    BottomNavigation.prototype[tab_navigation_base_1.tabStripProperty.setNative] = function (value) {
        var items = this.tabStrip ? this.tabStrip.items : null;
        this.setTabStripItems(items);
    };
    BottomNavigation = __decorate([
        view_1.CSSType("BottomNavigation")
    ], BottomNavigation);
    return BottomNavigation;
}(tab_navigation_base_1.TabNavigationBase));
exports.BottomNavigation = BottomNavigation;
function tryCloneDrawable(value, resources) {
    if (value) {
        var constantState = value.getConstantState();
        if (constantState) {
            return constantState.newDrawable(resources);
        }
    }
    return value;
}
//# sourceMappingURL=bottom-navigation.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/binding-builder.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var expressionSymbolsRegex = /[\+\-\*\/%\?:<>=!\|&\(\)^~]/;
var bindingConstants;
(function (bindingConstants) {
    bindingConstants.sourceProperty = "sourceProperty";
    bindingConstants.targetProperty = "targetProperty";
    bindingConstants.expression = "expression";
    bindingConstants.twoWay = "twoWay";
    bindingConstants.source = "source";
    bindingConstants.bindingValueKey = "$value";
    bindingConstants.parentValueKey = "$parent";
    bindingConstants.parentsValueKey = "$parents";
    bindingConstants.newPropertyValueKey = "$newPropertyValue";
})(bindingConstants = exports.bindingConstants || (exports.bindingConstants = {}));
var hasEqualSignRegex = /=+/;
var equalSignComparisionOperatorsRegex = /(==|===|>=|<=|!=|!==)/;
exports.parentsRegex = /\$parents\s*\[\s*(['"]*)\w*\1\s*\]/g;
function isNamedParam(value) {
    var equalSignIndex = value.search(hasEqualSignRegex);
    if (equalSignIndex > -1) {
        var equalSignSurround = value.substr(equalSignIndex > 0 ? equalSignIndex - 1 : 0, 3);
        if (equalSignSurround.search(equalSignComparisionOperatorsRegex) === -1) {
            return true;
        }
    }
    return false;
}
function areNamedParams(params) {
    for (var i = 0; i < params.length; i++) {
        if (isNamedParam(params[i])) {
            return true;
        }
    }
    return false;
}
var namedParamConstants = {
    propName: "propName",
    propValue: "propValue"
};
function getPropertyNameValuePair(param, knownOptions, callback) {
    var nameValuePair = {};
    var propertyName = param.substr(0, param.indexOf("=")).trim();
    var propertyValue = param.substr(param.indexOf("=") + 1).trim();
    if (knownOptions) {
        if (!propertyName) {
            propertyName = knownOptions.defaultProperty;
        }
        else {
            propertyName = propertyName in knownOptions ? propertyName : null;
        }
    }
    if (propertyName) {
        if (callback) {
            nameValuePair = callback(propertyName, propertyValue);
        }
        else {
            nameValuePair[namedParamConstants.propName] = propertyName;
            nameValuePair[namedParamConstants.propValue] = propertyValue;
        }
        return nameValuePair;
    }
    return null;
}
function parseNamedProperties(parameterList, knownOptions, callback) {
    var result = {};
    var nameValuePair;
    for (var i = 0; i < parameterList.length; i++) {
        nameValuePair = getPropertyNameValuePair(parameterList[i], knownOptions, callback);
        if (nameValuePair) {
            result[nameValuePair[namedParamConstants.propName]] = nameValuePair[namedParamConstants.propValue];
        }
    }
    return result;
}
function getParamsArray(value) {
    var result = [];
    var skipComma = 0;
    var indexReached = 0;
    var singleQuoteBlock = false;
    var doubleQuoteBlock = false;
    for (var i = 0; i < value.length; i++) {
        if (value[i] === "\"") {
            doubleQuoteBlock = !doubleQuoteBlock;
        }
        if (value[i] === "'") {
            singleQuoteBlock = !singleQuoteBlock;
        }
        if (value[i] === "(" || value[i] === "[") {
            skipComma++;
        }
        if (value[i] === ")" || value[i] === "]") {
            skipComma--;
        }
        if (value[i] === "," && skipComma === 0 && !(singleQuoteBlock || doubleQuoteBlock)) {
            result.push(value.substr(indexReached, i - indexReached));
            indexReached = i + 1;
        }
    }
    result.push(value.substr(indexReached));
    return result;
}
function isExpression(expression) {
    if (expression.search(expressionSymbolsRegex) > -1) {
        var parentsMatches = expression.match(exports.parentsRegex);
        if (parentsMatches) {
            var restOfExpression = expression.substr(expression.indexOf(parentsMatches[0]) + parentsMatches[0].length);
            if (!(restOfExpression.search(expressionSymbolsRegex) > -1)) {
                return false;
            }
        }
        return true;
    }
    return false;
}
function getBindingOptions(name, value) {
    var namedParams = [];
    var params = getParamsArray(value);
    if (!areNamedParams(params)) {
        if (params.length === 1) {
            var trimmedValue = params[0].trim();
            var sourceProp = void 0;
            if (isExpression(trimmedValue)) {
                sourceProp = bindingConstants.bindingValueKey;
                namedParams.push(bindingConstants.expression + " = " + trimmedValue);
            }
            else {
                sourceProp = trimmedValue;
            }
            namedParams.push(bindingConstants.sourceProperty + " = " + sourceProp);
            namedParams.push(bindingConstants.twoWay + " = true");
        }
        else {
            namedParams.push(bindingConstants.sourceProperty + " = " + params[0].trim());
            namedParams.push(bindingConstants.expression + " = " + params[1].trim());
            var twoWay = params[2] ? params[2].toLowerCase().trim() === "true" : true;
            namedParams.push(bindingConstants.twoWay + " = " + twoWay);
        }
    }
    else {
        namedParams = params;
    }
    var bindingPropertyHandler = function (prop, value) {
        var result = {};
        result[namedParamConstants.propName] = prop;
        if (prop === bindingConstants.twoWay) {
            if (value === "true") {
                result[namedParamConstants.propValue] = true;
            }
            else {
                result[namedParamConstants.propValue] = false;
            }
        }
        else {
            result[namedParamConstants.propValue] = value;
        }
        return result;
    };
    var bindingOptionsParameters = parseNamedProperties(namedParams, xmlBindingProperties, bindingPropertyHandler);
    var bindOptions = {
        targetProperty: name
    };
    for (var prop in bindingOptionsParameters) {
        if (bindingOptionsParameters.hasOwnProperty(prop)) {
            bindOptions[prop] = bindingOptionsParameters[prop];
        }
    }
    if (bindOptions[bindingConstants.twoWay] === undefined) {
        bindOptions[bindingConstants.twoWay] = true;
    }
    return bindOptions;
}
exports.getBindingOptions = getBindingOptions;
var xmlBindingProperties = {
    sourceProperty: true,
    expression: true,
    twoWay: true,
    source: true,
    defaultProperty: bindingConstants.sourceProperty
};
//# sourceMappingURL=binding-builder.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/builder.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var debug_1 = __webpack_require__("../node_modules/tns-core-modules/utils/debug.js");
var xml = __webpack_require__("../node_modules/tns-core-modules/xml/xml.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var component_builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/component-builder/component-builder.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var module_name_resolver_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js");
var ios = platform_1.platformNames.ios.toLowerCase();
var android = platform_1.platformNames.android.toLowerCase();
var defaultNameSpaceMatcher = /tns\.xsd$/i;
function parse(value, context) {
    if (typeof value === "function") {
        return value();
    }
    else {
        var exports_1 = context ? getExports(context) : undefined;
        var componentModule = parseInternal(value, exports_1);
        return componentModule && componentModule.component;
    }
}
exports.parse = parse;
function parseMultipleTemplates(value, context) {
    var dummyComponent = "<ListView><ListView.itemTemplates>" + value + "</ListView.itemTemplates></ListView>";
    return parseInternal(dummyComponent, context).component["itemTemplates"];
}
exports.parseMultipleTemplates = parseMultipleTemplates;
function load(pathOrOptions, context) {
    var componentModule;
    if (typeof pathOrOptions === "string") {
        var moduleName = module_name_sanitizer_1.sanitizeModuleName(pathOrOptions);
        componentModule = loadInternal(moduleName, context);
    }
    else {
        componentModule = loadCustomComponent(pathOrOptions.path, pathOrOptions.name, pathOrOptions.attributes, pathOrOptions.exports, pathOrOptions.page, true);
    }
    return componentModule && componentModule.component;
}
exports.load = load;
exports.createViewFromEntry = profiling_1.profile("createViewFromEntry", function (entry) {
    if (entry.create) {
        var view = entry.create();
        if (!view) {
            throw new Error("Failed to create View with entry.create() function.");
        }
        return view;
    }
    else if (entry.moduleName) {
        var moduleName = module_name_sanitizer_1.sanitizeModuleName(entry.moduleName);
        var resolvedCodeModuleName = module_name_resolver_1.resolveModuleName(moduleName, "");
        var moduleExports = resolvedCodeModuleName ? global.loadModule(resolvedCodeModuleName, true) : null;
        if (moduleExports && moduleExports.createPage) {
            var view = moduleExports.createPage();
            var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(moduleName, "css");
            if (resolvedCssModuleName) {
                view.addCssFile(resolvedCssModuleName);
            }
            return view;
        }
        else {
            var componentModule = loadInternal(moduleName, moduleExports);
            var componentView = componentModule && componentModule.component;
            return componentView;
        }
    }
    throw new Error("Failed to load page XML file for module: " + entry.moduleName);
});
function loadInternal(moduleName, moduleExports) {
    var componentModule;
    var resolvedXmlModule = module_name_resolver_1.resolveModuleName(moduleName, "xml");
    if (resolvedXmlModule) {
        var text = global.loadModule(resolvedXmlModule, true);
        componentModule = parseInternal(text, moduleExports, resolvedXmlModule, moduleName);
    }
    var componentView = componentModule && componentModule.component;
    if (componentView) {
        componentView.exports = moduleExports;
        componentView._moduleName = moduleName;
    }
    if (!componentModule) {
        throw new Error("Failed to load component from module: " + moduleName);
    }
    return componentModule;
}
function loadCustomComponent(componentNamespace, componentName, attributes, context, parentPage, isRootComponent, moduleNamePath) {
    if (isRootComponent === void 0) { isRootComponent = true; }
    if (!parentPage && context) {
        parentPage = context["_parentPage"];
        delete context["_parentPage"];
    }
    var result;
    componentNamespace = module_name_sanitizer_1.sanitizeModuleName(componentNamespace);
    var moduleName = componentNamespace + "/" + componentName;
    var resolvedCodeModuleName = module_name_resolver_1.resolveModuleName(moduleName, "");
    var resolvedXmlModuleName = module_name_resolver_1.resolveModuleName(moduleName, "xml");
    var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(moduleName, "css");
    if (resolvedXmlModuleName) {
        var subExports = context;
        if (resolvedCodeModuleName) {
            subExports = global.loadModule(resolvedCodeModuleName, true);
        }
        if (!subExports) {
            subExports = {};
        }
        subExports["_parentPage"] = parentPage;
        result = loadInternal(moduleName, subExports);
        if (types_1.isDefined(result) && types_1.isDefined(result.component) && types_1.isDefined(attributes)) {
            for (var attr in attributes) {
                component_builder_1.setPropertyValue(result.component, subExports, context, attr, attributes[attr]);
            }
        }
    }
    else {
        result = component_builder_1.getComponentModule(componentName, componentNamespace, attributes, context, moduleNamePath, isRootComponent);
        if (!resolvedCssModuleName) {
            resolvedCssModuleName = module_name_resolver_1.resolveModuleName(componentNamespace, "css");
        }
    }
    if (parentPage && resolvedCssModuleName) {
        parentPage.addCssFile(resolvedCssModuleName);
    }
    return result;
}
function getExports(instance) {
    var isView = !!instance._domId;
    if (!isView) {
        return instance.exports || instance;
    }
    var exportObject = instance.exports;
    var parent = instance.parent;
    while (exportObject === undefined && parent) {
        exportObject = parent.exports;
        parent = parent.parent;
    }
    return exportObject;
}
function parseInternal(value, context, xmlModule, moduleName) {
    var start;
    var ui;
    var errorFormat = (debug_1.debug && xmlModule) ? xml2ui.SourceErrorFormat(xmlModule) : xml2ui.PositionErrorFormat;
    var componentSourceTracker = (debug_1.debug && xmlModule) ? xml2ui.ComponentSourceTracker(xmlModule) : function () {
    };
    (start = new xml2ui.XmlStringParser(errorFormat))
        .pipe(new xml2ui.PlatformFilter())
        .pipe(new xml2ui.XmlStateParser(ui = new xml2ui.ComponentParser(context, errorFormat, componentSourceTracker, moduleName)));
    start.parse(value);
    return ui.rootComponentModule;
}
var xml2ui;
(function (xml2ui) {
    var XmlProducerBase = (function () {
        function XmlProducerBase() {
        }
        XmlProducerBase.prototype.pipe = function (next) {
            this._next = next;
            return next;
        };
        XmlProducerBase.prototype.next = function (args) {
            this._next.parse(args);
        };
        return XmlProducerBase;
    }());
    xml2ui.XmlProducerBase = XmlProducerBase;
    var XmlStringParser = (function (_super) {
        __extends(XmlStringParser, _super);
        function XmlStringParser(error) {
            var _this = _super.call(this) || this;
            _this.error = error || PositionErrorFormat;
            return _this;
        }
        XmlStringParser.prototype.parse = function (value) {
            var _this = this;
            var xmlParser = new xml.XmlParser(function (args) {
                try {
                    _this.next(args);
                }
                catch (e) {
                    throw _this.error(e, args.position);
                }
            }, function (e, p) {
                throw _this.error(e, p);
            }, true);
            if (types_1.isString(value)) {
                xmlParser.parse(value);
            }
        };
        return XmlStringParser;
    }(XmlProducerBase));
    xml2ui.XmlStringParser = XmlStringParser;
    function PositionErrorFormat(e, p) {
        return new debug_1.ScopeError(e, "Parsing XML at " + p.line + ":" + p.column);
    }
    xml2ui.PositionErrorFormat = PositionErrorFormat;
    function SourceErrorFormat(uri) {
        return function (e, p) {
            var source = p ? new debug_1.Source(uri, p.line, p.column) : new debug_1.Source(uri, -1, -1);
            e = new debug_1.SourceError(e, source, "Building UI from XML.");
            return e;
        };
    }
    xml2ui.SourceErrorFormat = SourceErrorFormat;
    function ComponentSourceTracker(uri) {
        return function (component, p) {
            if (!debug_1.Source.get(component)) {
                var source = p ? new debug_1.Source(uri, p.line, p.column) : new debug_1.Source(uri, -1, -1);
                debug_1.Source.set(component, source);
            }
        };
    }
    xml2ui.ComponentSourceTracker = ComponentSourceTracker;
    var PlatformFilter = (function (_super) {
        __extends(PlatformFilter, _super);
        function PlatformFilter() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        PlatformFilter.prototype.parse = function (args) {
            if (args.eventType === xml.ParserEventType.StartElement) {
                if (PlatformFilter.isPlatform(args.elementName)) {
                    if (this.currentPlatformContext) {
                        throw new Error("Already in '" + this.currentPlatformContext + "' platform context and cannot switch to '" + args.elementName + "' platform! Platform tags cannot be nested.");
                    }
                    this.currentPlatformContext = args.elementName;
                    return;
                }
            }
            if (args.eventType === xml.ParserEventType.EndElement) {
                if (PlatformFilter.isPlatform(args.elementName)) {
                    this.currentPlatformContext = undefined;
                    return;
                }
            }
            if (this.currentPlatformContext && !PlatformFilter.isCurentPlatform(this.currentPlatformContext)) {
                return;
            }
            this.next(args);
        };
        PlatformFilter.isPlatform = function (value) {
            if (value) {
                var toLower = value.toLowerCase();
                return toLower === android || toLower === ios;
            }
            return false;
        };
        PlatformFilter.isCurentPlatform = function (value) {
            return value && value.toLowerCase() === platform_1.device.os.toLowerCase();
        };
        return PlatformFilter;
    }(XmlProducerBase));
    xml2ui.PlatformFilter = PlatformFilter;
    var XmlArgsReplay = (function (_super) {
        __extends(XmlArgsReplay, _super);
        function XmlArgsReplay(args, errorFormat) {
            var _this = _super.call(this) || this;
            _this.args = args;
            _this.error = errorFormat;
            return _this;
        }
        XmlArgsReplay.prototype.replay = function () {
            var _this = this;
            this.args.forEach(function (args) {
                try {
                    _this.next(args);
                }
                catch (e) {
                    throw _this.error(e, args.position);
                }
            });
        };
        return XmlArgsReplay;
    }(XmlProducerBase));
    xml2ui.XmlArgsReplay = XmlArgsReplay;
    var XmlStateParser = (function () {
        function XmlStateParser(state) {
            this.state = state;
        }
        XmlStateParser.prototype.parse = function (args) {
            this.state = this.state.parse(args);
        };
        return XmlStateParser;
    }());
    xml2ui.XmlStateParser = XmlStateParser;
    var TemplateParser = (function () {
        function TemplateParser(parent, templateProperty, setTemplateProperty) {
            if (setTemplateProperty === void 0) { setTemplateProperty = true; }
            this.parent = parent;
            this._context = templateProperty.context;
            this._recordedXmlStream = new Array();
            this._templateProperty = templateProperty;
            this._nestingLevel = 0;
            this._state = 0;
            this._setTemplateProperty = setTemplateProperty;
        }
        TemplateParser.prototype.parse = function (args) {
            if (args.eventType === xml.ParserEventType.StartElement) {
                this.parseStartElement(args.prefix, args.namespace, args.elementName, args.attributes);
            }
            else if (args.eventType === xml.ParserEventType.EndElement) {
                this.parseEndElement(args.prefix, args.elementName);
            }
            this._recordedXmlStream.push(args);
            return this._state === 2 ? this.parent : this;
        };
        Object.defineProperty(TemplateParser.prototype, "elementName", {
            get: function () {
                return this._templateProperty.elementName;
            },
            enumerable: true,
            configurable: true
        });
        TemplateParser.prototype.parseStartElement = function (prefix, namespace, elementName, attributes) {
            if (this._state === 0) {
                this._state = 1;
            }
            else if (this._state === 2) {
                throw new Error("Template must have exactly one root element but multiple elements were found.");
            }
            this._nestingLevel++;
        };
        TemplateParser.prototype.parseEndElement = function (prefix, elementName) {
            if (this._state === 0) {
                throw new Error("Template must have exactly one root element but none was found.");
            }
            else if (this._state === 2) {
                throw new Error("No more closing elements expected for this template.");
            }
            this._nestingLevel--;
            if (this._nestingLevel === 0) {
                this._state = 2;
                if (this._setTemplateProperty && this._templateProperty.name in this._templateProperty.parent.component) {
                    var template = this.buildTemplate();
                    this._templateProperty.parent.component[this._templateProperty.name] = template;
                }
            }
        };
        TemplateParser.prototype.buildTemplate = function () {
            var _this = this;
            var context = this._context;
            var errorFormat = this._templateProperty.errorFormat;
            var sourceTracker = this._templateProperty.sourceTracker;
            var template = profiling_1.profile("Template()", function () {
                var start;
                var ui;
                (start = new xml2ui.XmlArgsReplay(_this._recordedXmlStream, errorFormat))
                    .pipe(new XmlStateParser(ui = new ComponentParser(context, errorFormat, sourceTracker)));
                start.replay();
                return ui.rootComponentModule.component;
            });
            return template;
        };
        return TemplateParser;
    }());
    xml2ui.TemplateParser = TemplateParser;
    var MultiTemplateParser = (function () {
        function MultiTemplateParser(parent, templateProperty) {
            this.parent = parent;
            this.templateProperty = templateProperty;
            this._childParsers = new Array();
        }
        Object.defineProperty(MultiTemplateParser.prototype, "value", {
            get: function () { return this._value; },
            enumerable: true,
            configurable: true
        });
        MultiTemplateParser.prototype.parse = function (args) {
            if (args.eventType === xml.ParserEventType.StartElement && args.elementName === "template") {
                var childParser = new TemplateParser(this, this.templateProperty, false);
                childParser["key"] = args.attributes["key"];
                this._childParsers.push(childParser);
                return childParser;
            }
            if (args.eventType === xml.ParserEventType.EndElement) {
                var name_1 = ComponentParser.getComplexPropertyName(args.elementName);
                if (name_1 === this.templateProperty.name) {
                    var templates = new Array();
                    for (var i = 0; i < this._childParsers.length; i++) {
                        templates.push({
                            key: this._childParsers[i]["key"],
                            createView: this._childParsers[i].buildTemplate()
                        });
                    }
                    this._value = templates;
                    return this.parent.parse(args);
                }
            }
            return this;
        };
        return MultiTemplateParser;
    }());
    xml2ui.MultiTemplateParser = MultiTemplateParser;
    var ComponentParser = (function () {
        function ComponentParser(context, errorFormat, sourceTracker, moduleName) {
            this.moduleName = moduleName;
            this.parents = new Array();
            this.complexProperties = new Array();
            this.context = context;
            this.error = errorFormat;
            this.sourceTracker = sourceTracker;
        }
        ComponentParser.prototype.buildComponent = function (args) {
            if (args.prefix && args.namespace) {
                return loadCustomComponent(args.namespace, args.elementName, args.attributes, this.context, this.currentRootView, !this.currentRootView, this.moduleName);
            }
            else {
                var namespace = args.namespace;
                if (defaultNameSpaceMatcher.test(namespace || "")) {
                    namespace = undefined;
                }
                return component_builder_1.getComponentModule(args.elementName, namespace, args.attributes, this.context, this.moduleName, !this.currentRootView);
            }
        };
        ComponentParser.prototype.parse = function (args) {
            var parent = this.parents[this.parents.length - 1];
            var complexProperty = this.complexProperties[this.complexProperties.length - 1];
            if (args.eventType === xml.ParserEventType.StartElement) {
                if (ComponentParser.isComplexProperty(args.elementName)) {
                    var name_2 = ComponentParser.getComplexPropertyName(args.elementName);
                    var complexProperty_1 = {
                        parent: parent,
                        name: name_2,
                        items: []
                    };
                    this.complexProperties.push(complexProperty_1);
                    if (ComponentParser.isKnownTemplate(name_2, parent.exports)) {
                        return new TemplateParser(this, {
                            context: (parent ? getExports(parent.component) : null) || this.context,
                            parent: parent,
                            name: name_2,
                            elementName: args.elementName,
                            templateItems: [],
                            errorFormat: this.error,
                            sourceTracker: this.sourceTracker
                        });
                    }
                    if (ComponentParser.isKnownMultiTemplate(name_2, parent.exports)) {
                        var parser = new MultiTemplateParser(this, {
                            context: (parent ? getExports(parent.component) : null) || this.context,
                            parent: parent,
                            name: name_2,
                            elementName: args.elementName,
                            templateItems: [],
                            errorFormat: this.error,
                            sourceTracker: this.sourceTracker
                        });
                        complexProperty_1.parser = parser;
                        return parser;
                    }
                }
                else {
                    var componentModule = this.buildComponent(args);
                    if (componentModule) {
                        this.sourceTracker(componentModule.component, args.position);
                        if (parent) {
                            if (complexProperty) {
                                ComponentParser.addToComplexProperty(parent, complexProperty, componentModule);
                            }
                            else if (parent.component._addChildFromBuilder) {
                                parent.component._addChildFromBuilder(args.elementName, componentModule.component);
                            }
                        }
                        else if (this.parents.length === 0) {
                            this.rootComponentModule = componentModule;
                            if (this.rootComponentModule) {
                                this.currentRootView = this.rootComponentModule.component;
                                if (this.currentRootView.exports) {
                                    this.context = this.currentRootView.exports;
                                }
                            }
                        }
                        this.parents.push(componentModule);
                    }
                }
            }
            else if (args.eventType === xml.ParserEventType.EndElement) {
                if (ComponentParser.isComplexProperty(args.elementName)) {
                    if (complexProperty) {
                        if (complexProperty.parser) {
                            parent.component[complexProperty.name] = complexProperty.parser.value;
                        }
                        else if (parent && parent.component._addArrayFromBuilder) {
                            parent.component._addArrayFromBuilder(complexProperty.name, complexProperty.items);
                            complexProperty.items = [];
                        }
                    }
                    this.complexProperties.pop();
                }
                else {
                    this.parents.pop();
                }
            }
            return this;
        };
        ComponentParser.isComplexProperty = function (name) {
            return types_1.isString(name) && name.indexOf(".") !== -1;
        };
        ComponentParser.getComplexPropertyName = function (fullName) {
            var name;
            if (types_1.isString(fullName)) {
                var names = fullName.split(".");
                name = names[names.length - 1];
            }
            return name;
        };
        ComponentParser.isKnownTemplate = function (name, exports) {
            return ComponentParser.KNOWNTEMPLATES in exports && exports[ComponentParser.KNOWNTEMPLATES] && name in exports[ComponentParser.KNOWNTEMPLATES];
        };
        ComponentParser.isKnownMultiTemplate = function (name, exports) {
            return ComponentParser.KNOWNMULTITEMPLATES in exports && exports[ComponentParser.KNOWNMULTITEMPLATES] && name in exports[ComponentParser.KNOWNMULTITEMPLATES];
        };
        ComponentParser.addToComplexProperty = function (parent, complexProperty, elementModule) {
            var parentComponent = parent.component;
            if (ComponentParser.isKnownCollection(complexProperty.name, parent.exports)) {
                complexProperty.items.push(elementModule.component);
            }
            else if (parentComponent._addChildFromBuilder) {
                parentComponent._addChildFromBuilder(complexProperty.name, elementModule.component);
            }
            else {
                parentComponent[complexProperty.name] = elementModule.component;
            }
        };
        ComponentParser.isKnownCollection = function (name, context) {
            return ComponentParser.KNOWNCOLLECTIONS in context && context[ComponentParser.KNOWNCOLLECTIONS] && name in context[ComponentParser.KNOWNCOLLECTIONS];
        };
        ComponentParser.KNOWNCOLLECTIONS = "knownCollections";
        ComponentParser.KNOWNTEMPLATES = "knownTemplates";
        ComponentParser.KNOWNMULTITEMPLATES = "knownMultiTemplates";
        __decorate([
            profiling_1.profile
        ], ComponentParser.prototype, "buildComponent", null);
        return ComponentParser;
    }());
    xml2ui.ComponentParser = ComponentParser;
})(xml2ui || (xml2ui = {}));
//# sourceMappingURL=builder.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/component-builder/component-builder.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var bindable_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/bindable/bindable.js");
var binding_builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/binding-builder.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var module_name_resolver_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js");
var UI_PATH = "ui/";
var MODULES = {
    "TabViewItem": "ui/tab-view",
    "TabStrip": "ui/tab-navigation-base/tab-strip",
    "TabStripItem": "ui/tab-navigation-base/tab-strip-item",
    "TabContentItem": "ui/tab-navigation-base/tab-content-item",
    "FormattedString": "text/formatted-string",
    "Span": "text/span",
    "ActionItem": "ui/action-bar",
    "NavigationButton": "ui/action-bar",
    "SegmentedBarItem": "ui/segmented-bar",
};
var CODE_FILE = "codeFile";
var CSS_FILE = "cssFile";
var IMPORT = "import";
var createComponentInstance = profiling_1.profile("createComponentInstance", function (elementName, namespace) {
    var instance;
    var instanceModule;
    var resolvedModuleName;
    try {
        if (typeof namespace === "string") {
            resolvedModuleName = module_name_resolver_1.resolveModuleName(namespace, "");
            instanceModule = global.loadModule(resolvedModuleName, true);
        }
        else {
            resolvedModuleName = MODULES[elementName] || UI_PATH +
                (elementName.toLowerCase().indexOf("layout") !== -1 ? "layouts/" : "") +
                elementName.split(/(?=[A-Z])/).join("-").toLowerCase();
            instanceModule = global.loadModule(resolvedModuleName, false);
        }
        var instanceType = instanceModule[elementName] || Object;
        instance = new instanceType();
    }
    catch (ex) {
        var debug = __webpack_require__("../node_modules/tns-core-modules/utils/debug.js");
        throw new debug.ScopeError(ex, "Module '" + resolvedModuleName + "' not found for element '" + (namespace ? namespace + ":" : "") + elementName + "'.");
    }
    return { instance: instance, instanceModule: instanceModule };
});
var getComponentModuleExports = profiling_1.profile("getComponentModuleExports", function (instance, moduleExports, attributes) {
    if (attributes) {
        var codeFileAttribute = attributes[CODE_FILE] || attributes[IMPORT];
        if (codeFileAttribute) {
            var resolvedCodeFileModule = module_name_resolver_1.resolveModuleName(module_name_sanitizer_1.sanitizeModuleName(codeFileAttribute), "");
            if (resolvedCodeFileModule) {
                moduleExports = global.loadModule(resolvedCodeFileModule, true);
                instance.exports = moduleExports;
            }
            else {
                throw new Error("Code file with path \"" + codeFileAttribute + "\" cannot be found! Looking for webpack module with name \"" + resolvedCodeFileModule + "\"");
            }
        }
    }
    return moduleExports;
});
var applyComponentCss = profiling_1.profile("applyComponentCss", function (instance, moduleName, attributes) {
    var cssApplied = false;
    if (attributes && attributes[CSS_FILE]) {
        var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(module_name_sanitizer_1.sanitizeModuleName(attributes[CSS_FILE]), "css");
        if (resolvedCssModuleName) {
            instance.addCssFile(resolvedCssModuleName);
            cssApplied = true;
        }
        else {
            throw new Error("Css file with path \"" + attributes[CSS_FILE] + "\" cannot be found! Looking for webpack module with name \"" + resolvedCssModuleName + "\"");
        }
    }
    if (moduleName && !cssApplied) {
        var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(moduleName, "css");
        if (resolvedCssModuleName) {
            instance.addCssFile(resolvedCssModuleName);
        }
    }
});
var applyComponentAttributes = profiling_1.profile("applyComponentAttributes", function (instance, instanceModule, moduleExports, attributes) {
    if (instance && instanceModule) {
        for (var attr in attributes) {
            var attrValue = attributes[attr];
            if (attr.indexOf(":") !== -1) {
                var platformName = attr.split(":")[0].trim();
                if (platformName.toLowerCase() === platform.device.os.toLowerCase()) {
                    attr = attr.split(":")[1].trim();
                }
                else {
                    continue;
                }
            }
            if (attr.indexOf(".") !== -1) {
                var subObj = instance;
                var properties = attr.split(".");
                var subPropName = properties[properties.length - 1];
                for (var i = 0; i < properties.length - 1; i++) {
                    if (subObj !== undefined && subObj !== null) {
                        subObj = subObj[properties[i]];
                    }
                }
                if (subObj !== undefined && subObj !== null) {
                    setPropertyValue(subObj, instanceModule, moduleExports, subPropName, attrValue);
                }
            }
            else {
                setPropertyValue(instance, instanceModule, moduleExports, attr, attrValue);
            }
        }
    }
});
function getComponentModule(elementName, namespace, attributes, moduleExports, moduleNamePath, isRootComponent) {
    elementName = elementName.split("-").map(function (s) { return s[0].toUpperCase() + s.substring(1); }).join("");
    var _a = createComponentInstance(elementName, namespace), instance = _a.instance, instanceModule = _a.instanceModule;
    moduleExports = getComponentModuleExports(instance, moduleExports, attributes);
    if (isRootComponent) {
        applyComponentCss(instance, moduleNamePath, attributes);
    }
    applyComponentAttributes(instance, instanceModule, moduleExports, attributes);
    var componentModule;
    if (instance && instanceModule) {
        componentModule = { component: instance, exports: instanceModule };
    }
    return componentModule;
}
exports.getComponentModule = getComponentModule;
function setPropertyValue(instance, instanceModule, exports, propertyName, propertyValue) {
    if (isBinding(propertyValue) && instance.bind) {
        var bindOptions = binding_builder_1.getBindingOptions(propertyName, getBindingExpressionFromAttribute(propertyValue));
        instance.bind({
            sourceProperty: bindOptions[binding_builder_1.bindingConstants.sourceProperty],
            targetProperty: bindOptions[binding_builder_1.bindingConstants.targetProperty],
            expression: bindOptions[binding_builder_1.bindingConstants.expression],
            twoWay: bindOptions[binding_builder_1.bindingConstants.twoWay]
        }, bindOptions[binding_builder_1.bindingConstants.source]);
    }
    else if (bindable_1.isEventOrGesture(propertyName, instance)) {
        var handler = exports && exports[propertyValue];
        if (typeof handler === "function") {
            instance.on(propertyName, handler);
        }
    }
    else if (isKnownFunction(propertyName, instance) && exports && typeof exports[propertyValue] === "function") {
        instance[propertyName] = exports[propertyValue];
    }
    else {
        instance[propertyName] = propertyValue;
    }
}
exports.setPropertyValue = setPropertyValue;
function getBindingExpressionFromAttribute(value) {
    return value.replace("{{", "").replace("}}", "").trim();
}
function isBinding(value) {
    var isBinding;
    if (typeof value === "string") {
        var str = value.trim();
        isBinding = str.indexOf("{{") === 0 && str.lastIndexOf("}}") === str.length - 2;
    }
    return isBinding;
}
var KNOWN_FUNCTIONS = "knownFunctions";
function isKnownFunction(name, instance) {
    return instance.constructor
        && KNOWN_FUNCTIONS in instance.constructor
        && instance.constructor[KNOWN_FUNCTIONS].indexOf(name) !== -1;
}
//# sourceMappingURL=component-builder.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function sanitizeModuleName(moduleName, removeExtension) {
    if (removeExtension === void 0) { removeExtension = true; }
    moduleName = moduleName.trim();
    if (moduleName.startsWith("~/")) {
        moduleName = moduleName.substring(2);
    }
    else if (moduleName.startsWith("~")) {
        moduleName = moduleName.substring(1);
    }
    else if (moduleName.startsWith("/")) {
        moduleName = moduleName.substring(1);
    }
    if (removeExtension) {
        var extToRemove = ["js", "ts", "xml", "html", "css", "scss"];
        var extensionRegEx = new RegExp("(.*)\\.(?:" + extToRemove.join("|") + ")", "i");
        moduleName = moduleName.replace(extensionRegEx, "$1");
    }
    return moduleName;
}
exports.sanitizeModuleName = sanitizeModuleName;
//# sourceMappingURL=module-name-sanitizer.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/button/button-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var ButtonBase = (function (_super) {
    __extends(ButtonBase, _super);
    function ButtonBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ButtonBase.prototype, "textWrap", {
        get: function () {
            return this.style.whiteSpace === "normal";
        },
        set: function (value) {
            if (typeof value === "string") {
                value = text_base_1.booleanConverter(value);
            }
            this.style.whiteSpace = value ? "normal" : "nowrap";
        },
        enumerable: true,
        configurable: true
    });
    ButtonBase.tapEvent = "tap";
    ButtonBase = __decorate([
        text_base_1.CSSType("Button")
    ], ButtonBase);
    return ButtonBase;
}(text_base_1.TextBase));
exports.ButtonBase = ButtonBase;
ButtonBase.prototype.recycleNativeView = "auto";
//# sourceMappingURL=button-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/button/button.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var button_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/button/button-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var gestures_1 = __webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/button/button-common.js"));
var sdkVersion = lazy_1.default(function () { return parseInt(platform_1.device.sdkVersion); });
var ClickListener;
var APILEVEL;
var AndroidButton;
function initializeClickListener() {
    if (ClickListener) {
        return;
    }
    var ClickListenerImpl = (function (_super) {
        __extends(ClickListenerImpl, _super);
        function ClickListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        ClickListenerImpl.prototype.onClick = function (v) {
            var owner = this.owner;
            if (owner) {
                owner._emit(button_common_1.ButtonBase.tapEvent);
            }
        };
        ClickListenerImpl = __decorate([
            Interfaces([android.view.View.OnClickListener])
        ], ClickListenerImpl);
        return ClickListenerImpl;
    }(java.lang.Object));
    ClickListener = ClickListenerImpl;
}
var Button = (function (_super) {
    __extends(Button, _super);
    function Button() {
        var _this = _super.call(this) || this;
        if (!APILEVEL) {
            APILEVEL = android.os.Build.VERSION.SDK_INT;
        }
        return _this;
    }
    Button.prototype.createNativeView = function () {
        if (!AndroidButton) {
            AndroidButton = android.widget.Button;
        }
        return new AndroidButton(this._context);
    };
    Button.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        initializeClickListener();
        var clickListener = new ClickListener(this);
        nativeView.setOnClickListener(clickListener);
        nativeView.clickListener = clickListener;
    };
    Button.prototype.disposeNativeView = function () {
        if (this.nativeViewProtected) {
            this.nativeViewProtected.clickListener.owner = null;
        }
        _super.prototype.disposeNativeView.call(this);
    };
    Button.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        if (this._stateListAnimator && APILEVEL >= 21) {
            this.nativeViewProtected.setStateListAnimator(this._stateListAnimator);
            this._stateListAnimator = undefined;
        }
    };
    Button.prototype._updateButtonStateChangeHandler = function (subscribe) {
        var _this = this;
        if (subscribe) {
            this._highlightedHandler = this._highlightedHandler || (function (args) {
                switch (args.action) {
                    case gestures_1.TouchAction.up:
                    case gestures_1.TouchAction.cancel:
                        _this._goToVisualState("normal");
                        break;
                    case gestures_1.TouchAction.down:
                        _this._goToVisualState("highlighted");
                        break;
                }
            });
            this.on(gestures_1.GestureTypes.touch, this._highlightedHandler);
        }
        else {
            this.off(gestures_1.GestureTypes.touch, this._highlightedHandler);
        }
    };
    Button.prototype[button_common_1.paddingTopProperty.getDefault] = function () {
        return { value: this._defaultPaddingTop, unit: "px" };
    };
    Button.prototype[button_common_1.paddingTopProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingTop(this.nativeViewProtected, button_common_1.Length.toDevicePixels(value, 0) + button_common_1.Length.toDevicePixels(this.style.borderTopWidth, 0));
    };
    Button.prototype[button_common_1.paddingRightProperty.getDefault] = function () {
        return { value: this._defaultPaddingRight, unit: "px" };
    };
    Button.prototype[button_common_1.paddingRightProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingRight(this.nativeViewProtected, button_common_1.Length.toDevicePixels(value, 0) + button_common_1.Length.toDevicePixels(this.style.borderRightWidth, 0));
    };
    Button.prototype[button_common_1.paddingBottomProperty.getDefault] = function () {
        return { value: this._defaultPaddingBottom, unit: "px" };
    };
    Button.prototype[button_common_1.paddingBottomProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingBottom(this.nativeViewProtected, button_common_1.Length.toDevicePixels(value, 0) + button_common_1.Length.toDevicePixels(this.style.borderBottomWidth, 0));
    };
    Button.prototype[button_common_1.paddingLeftProperty.getDefault] = function () {
        return { value: this._defaultPaddingLeft, unit: "px" };
    };
    Button.prototype[button_common_1.paddingLeftProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingLeft(this.nativeViewProtected, button_common_1.Length.toDevicePixels(value, 0) + button_common_1.Length.toDevicePixels(this.style.borderLeftWidth, 0));
    };
    Button.prototype[button_common_1.zIndexProperty.setNative] = function (value) {
        if (APILEVEL >= 21) {
            var nativeView = this.nativeViewProtected;
            if (!this._stateListAnimator) {
                this._stateListAnimator = nativeView.getStateListAnimator();
            }
            nativeView.setStateListAnimator(null);
        }
        org.nativescript.widgets.ViewHelper.setZIndex(this.nativeViewProtected, value);
    };
    Button.prototype[button_common_1.textAlignmentProperty.setNative] = function (value) {
        var newValue = value === "initial" ? "center" : value;
        _super.prototype[button_common_1.textAlignmentProperty.setNative].call(this, newValue);
    };
    Button.prototype.getDefaultElevation = function () {
        if (sdkVersion() < 21) {
            return 0;
        }
        return 2;
    };
    Button.prototype.getDefaultDynamicElevationOffset = function () {
        if (sdkVersion() < 21) {
            return 0;
        }
        return 4;
    };
    __decorate([
        profiling_1.profile
    ], Button.prototype, "createNativeView", null);
    __decorate([
        button_common_1.PseudoClassHandler("normal", "highlighted", "pressed", "active")
    ], Button.prototype, "_updateButtonStateChangeHandler", null);
    return Button;
}(button_common_1.ButtonBase));
exports.Button = Button;
//# sourceMappingURL=button.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/content-view/content-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ContentView = (function (_super) {
    __extends(ContentView, _super);
    function ContentView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ContentView.prototype, "content", {
        get: function () {
            return this._content;
        },
        set: function (value) {
            var oldView = this._content;
            if (this._content) {
                this._removeView(this._content);
            }
            this._content = value;
            if (this._content) {
                this._addView(this._content);
            }
            this._onContentChanged(oldView, value);
            if (view_1.isIOS && oldView !== value) {
                this.requestLayout();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ContentView.prototype, "layoutView", {
        get: function () {
            var result;
            if (this._content) {
                var first_1 = true;
                this._content._eachLayoutView(function (child) {
                    if (first_1) {
                        first_1 = false;
                        result = child;
                    }
                    else {
                        throw new Error("More than one layout child inside a ContentView");
                    }
                });
            }
            return result;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ContentView.prototype, "_childrenCount", {
        get: function () {
            return this._content ? 1 : 0;
        },
        enumerable: true,
        configurable: true
    });
    ContentView.prototype._onContentChanged = function (oldView, newView) {
    };
    ContentView.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof view_1.View) {
            this.content = value;
        }
    };
    ContentView.prototype.eachChildView = function (callback) {
        var content = this._content;
        if (content) {
            callback(content);
        }
    };
    ContentView.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var result = view_1.View.measureChild(this, this.layoutView, widthMeasureSpec, heightMeasureSpec);
        var width = view_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = view_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = view_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = view_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var measureWidth = Math.max(result.measuredWidth, this.effectiveMinWidth);
        var measureHeight = Math.max(result.measuredHeight, this.effectiveMinHeight);
        var widthAndState = view_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
        var heightAndState = view_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    ContentView.prototype.onLayout = function (left, top, right, bottom) {
        view_1.View.layoutChild(this, this.layoutView, 0, 0, right - left, bottom - top);
    };
    return ContentView;
}(view_1.CustomLayoutView));
exports.ContentView = ContentView;
ContentView.prototype.recycleNativeView = "auto";
//# sourceMappingURL=content-view.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/bindable/bindable.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
exports.Observable = observable_1.Observable;
exports.WrappedValue = observable_1.WrappedValue;
var weak_event_listener_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js");
var binding_builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/binding-builder.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
exports.traceEnabled = trace_1.isEnabled;
exports.traceWrite = trace_1.write;
exports.traceError = trace_1.error;
exports.traceCategories = trace_1.categories;
exports.traceNotifyEvent = trace_1.notifyEvent;
exports.isCategorySet = trace_1.isCategorySet;
exports.traceMessageType = trace_1.messageType;
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var applicationCommon = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var polymerExpressions = __webpack_require__("../node_modules/tns-core-modules/js-libs/polymer-expressions/polymer-expressions.js");
var contextKey = "context";
var paramsRegex = /\[\s*(['"])*(\w*)\1\s*\]/;
var bc = binding_builder_1.bindingConstants;
var emptyArray = [];
var propertiesCache = {};
function getProperties(property) {
    if (!property) {
        return emptyArray;
    }
    var result = propertiesCache[property];
    if (result) {
        return result;
    }
    var parentsMatches = property.match(binding_builder_1.parentsRegex);
    result = property.replace(binding_builder_1.parentsRegex, "parentsMatch")
        .replace(/\]/g, "")
        .split(/\.|\[/);
    var parentsMatchesCounter = 0;
    for (var i = 0, resultLength = result.length; i < resultLength; i++) {
        if (result[i] === "parentsMatch") {
            result[i] = parentsMatches[parentsMatchesCounter++];
        }
    }
    propertiesCache[property] = result;
    return result;
}
function getEventOrGestureName(name) {
    return name.indexOf("on") === 0 ? name.substr(2, name.length - 2) : name;
}
exports.getEventOrGestureName = getEventOrGestureName;
function isGesture(eventOrGestureName) {
    var t = eventOrGestureName.trim().toLowerCase();
    return t === "tap"
        || t === "doubletap"
        || t === "pinch"
        || t === "pan"
        || t === "swipe"
        || t === "rotation"
        || t === "longpress"
        || t === "touch";
}
exports.isGesture = isGesture;
function isEventOrGesture(name, view) {
    if (typeof name === "string") {
        var eventOrGestureName = getEventOrGestureName(name);
        var evt = eventOrGestureName + "Event";
        return view.constructor && evt in view.constructor || isGesture(eventOrGestureName.toLowerCase());
    }
    return false;
}
exports.isEventOrGesture = isEventOrGesture;
var Binding = (function () {
    function Binding(target, options) {
        this.propertyChangeListeners = new Map();
        this.target = new WeakRef(target);
        this.options = options;
        this.sourceProperties = getProperties(options.sourceProperty);
        this.targetOptions = this.resolveOptions(target, getProperties(options.targetProperty));
        if (!this.targetOptions) {
            throw new Error("Invalid property: " + options.targetProperty + " for target: " + target);
        }
        if (options.twoWay) {
            var target_1 = this.targetOptions.instance.get();
            if (target_1 instanceof observable_1.Observable) {
                target_1.on(this.targetOptions.property + "Change", this.onTargetPropertyChanged, this);
            }
        }
    }
    Binding.prototype.onTargetPropertyChanged = function (data) {
        this.updateTwoWay(data.value);
    };
    Binding.prototype.loadedHandlerVisualTreeBinding = function (args) {
        var target = args.object;
        target.off("loaded", this.loadedHandlerVisualTreeBinding, this);
        var context = target.bindingContext;
        if (context !== undefined && context !== null) {
            this.update(context);
        }
    };
    Binding.prototype.clearSource = function () {
        var _this = this;
        this.propertyChangeListeners.forEach(function (observable, index, map) {
            weak_event_listener_1.removeWeakEventListener(observable, observable_1.Observable.propertyChangeEvent, _this.onSourcePropertyChanged, _this);
        });
        this.propertyChangeListeners.clear();
        if (this.source) {
            this.source.clear();
        }
        if (this.sourceOptions) {
            this.sourceOptions.instance.clear();
            this.sourceOptions = undefined;
        }
    };
    Binding.prototype.sourceAsObject = function (source) {
        var objectType = typeof source;
        if (objectType === "number") {
            source = new Number(source);
        }
        else if (objectType === "boolean") {
            source = new Boolean(source);
        }
        else if (objectType === "string") {
            source = new String(source);
        }
        return source;
    };
    Binding.prototype.bindingContextChanged = function (data) {
        var target = this.targetOptions.instance.get();
        if (!target) {
            this.unbind();
            return;
        }
        var value = data.value;
        if (value !== null && value !== undefined) {
            this.update(value);
        }
        else {
            this.clearBinding();
        }
    };
    Binding.prototype.bind = function (source) {
        var target = this.targetOptions.instance.get();
        if (this.sourceIsBindingContext && target instanceof observable_1.Observable && this.targetOptions.property !== "bindingContext") {
            target.on("bindingContextChange", this.bindingContextChanged, this);
        }
        this.update(source);
    };
    Binding.prototype.update = function (source) {
        this.clearSource();
        source = this.sourceAsObject(source);
        if (!types.isNullOrUndefined(source)) {
            this.source = new WeakRef(source);
            this.sourceOptions = this.resolveOptions(source, this.sourceProperties);
            var sourceValue = this.getSourcePropertyValue();
            this.updateTarget(sourceValue);
            this.addPropertyChangeListeners(this.source, this.sourceProperties);
        }
        else if (!this.sourceIsBindingContext) {
            var sourceValue = this.getSourcePropertyValue();
            this.updateTarget(sourceValue ? sourceValue : source);
        }
    };
    Binding.prototype.unbind = function () {
        var target = this.targetOptions.instance.get();
        if (target instanceof observable_1.Observable) {
            if (this.options.twoWay) {
                target.off(this.targetOptions.property + "Change", this.onTargetPropertyChanged, this);
            }
            if (this.sourceIsBindingContext && this.targetOptions.property !== "bindingContext") {
                target.off("bindingContextChange", this.bindingContextChanged, this);
            }
        }
        if (this.targetOptions) {
            this.targetOptions = undefined;
        }
        this.sourceProperties = undefined;
        if (!this.source) {
            return;
        }
        this.clearSource();
    };
    Binding.prototype.resolveObjectsAndProperties = function (source, properties) {
        var result = [];
        var currentObject = source;
        var currentObjectChanged = false;
        for (var i = 0, propsArrayLength = properties.length; i < propsArrayLength; i++) {
            var property = properties[i];
            if (property === bc.bindingValueKey) {
                currentObjectChanged = true;
            }
            if (property === bc.parentValueKey || property.indexOf(bc.parentsValueKey) === 0) {
                var parentView = this.getParentView(this.target.get(), property).view;
                if (parentView) {
                    currentObject = parentView.bindingContext;
                }
                else {
                    var targetInstance = this.target.get();
                    targetInstance.off("loaded", this.loadedHandlerVisualTreeBinding, this);
                    targetInstance.on("loaded", this.loadedHandlerVisualTreeBinding, this);
                }
                currentObjectChanged = true;
            }
            if (currentObject) {
                result.push({ instance: currentObject, property: property });
            }
            else {
                break;
            }
            if (!currentObjectChanged && (i < propsArrayLength - 1)) {
                currentObject = currentObject ? currentObject[properties[i]] : null;
            }
            currentObjectChanged = false;
        }
        return result;
    };
    Binding.prototype.addPropertyChangeListeners = function (source, sourceProperty, parentProperies) {
        var objectsAndProperties = this.resolveObjectsAndProperties(source.get(), sourceProperty);
        var prop = parentProperies || "";
        for (var i = 0, length_1 = objectsAndProperties.length; i < length_1; i++) {
            var propName = objectsAndProperties[i].property;
            prop += "$" + propName;
            var currentObject = objectsAndProperties[i].instance;
            if (!this.propertyChangeListeners.has(prop) && currentObject instanceof observable_1.Observable && currentObject._isViewBase) {
                weak_event_listener_1.addWeakEventListener(currentObject, propName + "Change", this.onSourcePropertyChanged, this);
                weak_event_listener_1.addWeakEventListener(currentObject, observable_1.Observable.propertyChangeEvent, this.onSourcePropertyChanged, this);
                this.propertyChangeListeners.set(prop, currentObject);
            }
            else if (!this.propertyChangeListeners.has(prop) && currentObject instanceof observable_1.Observable) {
                weak_event_listener_1.addWeakEventListener(currentObject, observable_1.Observable.propertyChangeEvent, this.onSourcePropertyChanged, this);
                this.propertyChangeListeners.set(prop, currentObject);
            }
        }
    };
    Binding.prototype.prepareExpressionForUpdate = function () {
        var escapedSourceProperty = utils_1.escapeRegexSymbols(this.options.sourceProperty);
        var expRegex = new RegExp(escapedSourceProperty, "g");
        var resultExp = this.options.expression.replace(expRegex, bc.newPropertyValueKey);
        return resultExp;
    };
    Binding.prototype.updateTwoWay = function (value) {
        if (this.updating || !this.options.twoWay) {
            return;
        }
        var newValue = value;
        if (this.options.expression) {
            var changedModel = {};
            changedModel[bc.bindingValueKey] = value;
            changedModel[bc.newPropertyValueKey] = value;
            var sourcePropertyName = "";
            if (this.sourceOptions) {
                sourcePropertyName = this.sourceOptions.property;
            }
            else if (typeof this.options.sourceProperty === "string" && this.options.sourceProperty.indexOf(".") === -1) {
                sourcePropertyName = this.options.sourceProperty;
            }
            if (sourcePropertyName !== "") {
                changedModel[sourcePropertyName] = value;
            }
            var updateExpression = this.prepareExpressionForUpdate();
            this.prepareContextForExpression(changedModel, updateExpression, undefined);
            var expressionValue = this._getExpressionValue(updateExpression, true, changedModel);
            if (expressionValue instanceof Error) {
                trace_1.write(expressionValue.message, trace_1.categories.Binding, trace_1.messageType.error);
            }
            newValue = expressionValue;
        }
        this.updateSource(newValue);
    };
    Binding.prototype._getExpressionValue = function (expression, isBackConvert, changedModel) {
        try {
            var exp_1 = polymerExpressions.PolymerExpressions.getExpression(expression);
            if (exp_1) {
                var context_1 = this.source && this.source.get && this.source.get() || global;
                var model = {};
                var addedProps = [];
                var resources = applicationCommon.getResources();
                for (var prop in resources) {
                    if (resources.hasOwnProperty(prop) && !context_1.hasOwnProperty(prop)) {
                        context_1[prop] = resources[prop];
                        addedProps.push(prop);
                    }
                }
                this.prepareContextForExpression(context_1, expression, addedProps);
                model[contextKey] = context_1;
                var result = exp_1.getValue(model, isBackConvert, changedModel ? changedModel : model);
                var addedPropsLength = addedProps.length;
                for (var i = 0; i < addedPropsLength; i++) {
                    delete context_1[addedProps[i]];
                }
                addedProps.length = 0;
                return result;
            }
            return new Error(expression + " is not a valid expression.");
        }
        catch (e) {
            var errorMessage = "Run-time error occured in file: " + e.sourceURL + " at line: " + e.line + " and column: " + e.column;
            return new Error(errorMessage);
        }
    };
    Binding.prototype.onSourcePropertyChanged = function (data) {
        var sourceProps = this.sourceProperties;
        var sourcePropsLength = sourceProps.length;
        var changedPropertyIndex = sourceProps.indexOf(data.propertyName);
        var parentProps = "";
        if (changedPropertyIndex > -1) {
            parentProps = "$" + sourceProps.slice(0, changedPropertyIndex + 1).join("$");
            while (this.propertyChangeListeners.get(parentProps) !== data.object) {
                changedPropertyIndex += sourceProps.slice(changedPropertyIndex + 1).indexOf(data.propertyName) + 1;
                parentProps = "$" + sourceProps.slice(0, changedPropertyIndex + 1).join("$");
            }
        }
        if (this.options.expression) {
            var expressionValue = this._getExpressionValue(this.options.expression, false, undefined);
            if (expressionValue instanceof Error) {
                trace_1.write(expressionValue.message, trace_1.categories.Binding, trace_1.messageType.error);
            }
            else {
                this.updateTarget(expressionValue);
            }
        }
        else {
            if (changedPropertyIndex > -1) {
                var props = sourceProps.slice(changedPropertyIndex + 1);
                var propsLength = props.length;
                if (propsLength > 0) {
                    var value = data.value;
                    for (var i = 0; i < propsLength; i++) {
                        value = value[props[i]];
                    }
                    this.updateTarget(value);
                }
                else if (data.propertyName === this.sourceOptions.property) {
                    this.updateTarget(data.value);
                }
            }
        }
        if (changedPropertyIndex > -1 && changedPropertyIndex < sourcePropsLength - 1) {
            var probablyChangedObject = this.propertyChangeListeners.get(parentProps);
            if (probablyChangedObject &&
                probablyChangedObject !== data.object[sourceProps[changedPropertyIndex]]) {
                for (var i = sourcePropsLength - 1; i > changedPropertyIndex; i--) {
                    var prop = "$" + sourceProps.slice(0, i + 1).join("$");
                    if (this.propertyChangeListeners.has(prop)) {
                        weak_event_listener_1.removeWeakEventListener(this.propertyChangeListeners.get(prop), observable_1.Observable.propertyChangeEvent, this.onSourcePropertyChanged, this);
                        this.propertyChangeListeners.delete(prop);
                    }
                }
                var newProps = sourceProps.slice(changedPropertyIndex + 1);
                var newObject = data.object[sourceProps[changedPropertyIndex]];
                if (!types.isNullOrUndefined(newObject) && typeof newObject === "object") {
                    this.addPropertyChangeListeners(new WeakRef(newObject), newProps, parentProps);
                }
            }
        }
    };
    Binding.prototype.prepareContextForExpression = function (model, expression, newProps) {
        var parentViewAndIndex;
        var parentView;
        var addedProps = newProps || [];
        if (expression.indexOf(bc.bindingValueKey) > -1) {
            model[bc.bindingValueKey] = model;
            addedProps.push(bc.bindingValueKey);
        }
        if (expression.indexOf(bc.parentValueKey) > -1) {
            parentView = this.getParentView(this.target.get(), bc.parentValueKey).view;
            if (parentView) {
                model[bc.parentValueKey] = parentView.bindingContext;
                addedProps.push(bc.parentValueKey);
            }
        }
        var parentsArray = expression.match(binding_builder_1.parentsRegex);
        if (parentsArray) {
            for (var i = 0; i < parentsArray.length; i++) {
                parentViewAndIndex = this.getParentView(this.target.get(), parentsArray[i]);
                if (parentViewAndIndex.view) {
                    model[bc.parentsValueKey] = model[bc.parentsValueKey] || {};
                    model[bc.parentsValueKey][parentViewAndIndex.index] = parentViewAndIndex.view.bindingContext;
                    addedProps.push(bc.parentsValueKey);
                }
            }
        }
    };
    Binding.prototype.getSourcePropertyValue = function () {
        if (this.options.expression) {
            var changedModel = {};
            changedModel[bc.bindingValueKey] = this.source ? this.source.get() : undefined;
            var expressionValue = this._getExpressionValue(this.options.expression, false, changedModel);
            if (expressionValue instanceof Error) {
                trace_1.write(expressionValue.message, trace_1.categories.Binding, trace_1.messageType.error);
            }
            else {
                return expressionValue;
            }
        }
        if (this.sourceOptions) {
            var sourceOptionsInstance = this.sourceOptions.instance.get();
            if (this.sourceOptions.property === bc.bindingValueKey) {
                return sourceOptionsInstance;
            }
            else if ((sourceOptionsInstance instanceof observable_1.Observable) && (this.sourceOptions.property && this.sourceOptions.property !== "")) {
                return sourceOptionsInstance.get(this.sourceOptions.property);
            }
            else if (sourceOptionsInstance && this.sourceOptions.property && this.sourceOptions.property !== "" &&
                this.sourceOptions.property in sourceOptionsInstance) {
                return sourceOptionsInstance[this.sourceOptions.property];
            }
            else {
                trace_1.write("Property: '" + this.sourceOptions.property + "' is invalid or does not exist. SourceProperty: '" + this.options.sourceProperty + "'", trace_1.categories.Binding, trace_1.messageType.error);
            }
        }
        return null;
    };
    Binding.prototype.clearBinding = function () {
        this.clearSource();
        this.updateTarget(properties_1.unsetValue);
    };
    Binding.prototype.updateTarget = function (value) {
        if (this.updating) {
            return;
        }
        this.updateOptions(this.targetOptions, types.isNullOrUndefined(value) ? properties_1.unsetValue : value);
    };
    Binding.prototype.updateSource = function (value) {
        if (this.updating || !this.source || !this.source.get()) {
            return;
        }
        this.updateOptions(this.sourceOptions, value);
    };
    Binding.prototype.getParentView = function (target, property) {
        if (!target) {
            return { view: null, index: null };
        }
        var result;
        if (property === bc.parentValueKey) {
            result = target.parent;
        }
        var index = null;
        if (property.indexOf(bc.parentsValueKey) === 0) {
            result = target.parent;
            var indexParams = paramsRegex.exec(property);
            if (indexParams && indexParams.length > 1) {
                index = indexParams[2];
            }
            if (!isNaN(index)) {
                var indexAsInt = parseInt(index);
                while (indexAsInt > 0) {
                    result = result.parent;
                    indexAsInt--;
                }
            }
            else if (types.isString(index)) {
                while (result && result.typeName !== index) {
                    result = result.parent;
                }
            }
        }
        return { view: result, index: index };
    };
    Binding.prototype.resolveOptions = function (obj, properties) {
        var objectsAndProperties = this.resolveObjectsAndProperties(obj, properties);
        if (objectsAndProperties.length > 0) {
            var resolvedObj = objectsAndProperties[objectsAndProperties.length - 1].instance;
            var prop = objectsAndProperties[objectsAndProperties.length - 1].property;
            return {
                instance: new WeakRef(this.sourceAsObject(resolvedObj)),
                property: prop
            };
        }
        return null;
    };
    Binding.prototype.updateOptions = function (options, value) {
        var optionsInstance;
        if (options && options.instance) {
            optionsInstance = options.instance.get();
        }
        if (!optionsInstance) {
            return;
        }
        this.updating = true;
        try {
            if (isEventOrGesture(options.property, optionsInstance) &&
                types.isFunction(value)) {
                optionsInstance.off(options.property, null, optionsInstance.bindingContext);
                optionsInstance.on(options.property, value, optionsInstance.bindingContext);
            }
            else if (optionsInstance instanceof observable_1.Observable) {
                optionsInstance.set(options.property, value);
            }
            else {
                optionsInstance[options.property] = value;
            }
        }
        catch (ex) {
            trace_1.write("Binding error while setting property " + options.property + " of " + optionsInstance + ": " + ex, trace_1.categories.Binding, trace_1.messageType.error);
        }
        this.updating = false;
    };
    return Binding;
}());
exports.Binding = Binding;
//# sourceMappingURL=bindable.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/properties/properties.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var reduceCSSCalc = __webpack_require__("../node_modules/reduce-css-calc/dist/index.js");
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var style_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style/style.js");
exports.Style = style_1.Style;
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
exports.unsetValue = new Object();
var cssPropertyNames = [];
var symbolPropertyMap = {};
var cssSymbolPropertyMap = {};
var inheritableProperties = new Array();
var inheritableCssProperties = new Array();
function print(map) {
    var symbols = Object.getOwnPropertySymbols(map);
    for (var _i = 0, symbols_1 = symbols; _i < symbols_1.length; _i++) {
        var symbol = symbols_1[_i];
        var prop = map[symbol];
        if (!prop.registered) {
            console.log("Property " + prop.name + " not Registered!!!!!");
        }
    }
}
function _printUnregisteredProperties() {
    print(symbolPropertyMap);
    print(cssSymbolPropertyMap);
}
exports._printUnregisteredProperties = _printUnregisteredProperties;
function _getProperties() {
    return getPropertiesFromMap(symbolPropertyMap);
}
exports._getProperties = _getProperties;
function _getStyleProperties() {
    return getPropertiesFromMap(cssSymbolPropertyMap);
}
exports._getStyleProperties = _getStyleProperties;
var cssVariableExpressionRegexp = /\bvar\(\s*(--[^,\s]+?)(?:\s*,\s*(.+))?\s*\)/;
var cssVariableAllExpressionsRegexp = /\bvar\(\s*(--[^,\s]+?)(?:\s*,\s*(.+))?\s*\)/g;
function isCssVariable(property) {
    return /^--[^,\s]+?$/.test(property);
}
exports.isCssVariable = isCssVariable;
function isCssCalcExpression(value) {
    return /\bcalc\(/.test(value);
}
exports.isCssCalcExpression = isCssCalcExpression;
function isCssVariableExpression(value) {
    return cssVariableExpressionRegexp.test(value);
}
exports.isCssVariableExpression = isCssVariableExpression;
function _evaluateCssVariableExpression(view, cssName, value) {
    if (typeof value !== "string") {
        return value;
    }
    if (!isCssVariableExpression(value)) {
        return value;
    }
    var output = value.trim();
    var lastValue;
    while (lastValue !== output) {
        lastValue = output;
        output = output.replace(cssVariableAllExpressionsRegexp, function (matchStr, cssVariableName, fallbackStr) {
            var cssVariableValue = view.style.getCssVariable(cssVariableName);
            if (cssVariableValue !== null) {
                return cssVariableValue;
            }
            if (fallbackStr) {
                var fallbackOutput = _evaluateCssVariableExpression(view, cssName, fallbackStr);
                if (fallbackOutput) {
                    return fallbackOutput.split(",")[0];
                }
            }
            trace_1.write("Failed to get value for css-variable \"" + cssVariableName + "\" used in \"" + cssName + "\"=[" + value + "] to " + view, trace_1.categories.Style, trace_1.messageType.error);
            return "unset";
        });
    }
    return output;
}
exports._evaluateCssVariableExpression = _evaluateCssVariableExpression;
function _evaluateCssCalcExpression(value) {
    if (typeof value !== "string") {
        return value;
    }
    if (isCssCalcExpression(value)) {
        return reduceCSSCalc(value.replace(/([0-9]+(\.[0-9]+)?)dip\b/g, "$1"));
    }
    else {
        return value;
    }
}
exports._evaluateCssCalcExpression = _evaluateCssCalcExpression;
function getPropertiesFromMap(map) {
    var props = [];
    Object.getOwnPropertySymbols(map).forEach(function (symbol) { return props.push(map[symbol]); });
    return props;
}
var Property = (function () {
    function Property(options) {
        this.enumerable = true;
        this.configurable = true;
        var propertyName = options.name;
        this.name = propertyName;
        var key = Symbol(propertyName + ":propertyKey");
        this.key = key;
        var getDefault = Symbol(propertyName + ":getDefault");
        this.getDefault = getDefault;
        var setNative = Symbol(propertyName + ":setNative");
        this.setNative = setNative;
        var defaultValueKey = Symbol(propertyName + ":nativeDefaultValue");
        this.defaultValueKey = defaultValueKey;
        var defaultValue = options.defaultValue;
        this.defaultValue = defaultValue;
        var eventName = propertyName + "Change";
        var equalityComparer = options.equalityComparer;
        var affectsLayout = options.affectsLayout;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var property = this;
        this.set = function (boxedValue) {
            var reset = boxedValue === exports.unsetValue;
            var value;
            var wrapped;
            if (reset) {
                value = defaultValue;
            }
            else {
                wrapped = boxedValue && boxedValue.wrapped;
                value = wrapped ? observable_1.WrappedValue.unwrap(boxedValue) : boxedValue;
                if (valueConverter && typeof value === "string") {
                    value = valueConverter(value);
                }
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (wrapped || changed) {
                if (affectsLayout) {
                    this.requestLayout();
                }
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                this[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                this[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = this[getDefault] ? this[getDefault]() : defaultValue;
                            }
                            this[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (this.domNode) {
                    if (reset) {
                        this.domNode.attributeRemoved(propertyName);
                    }
                    else {
                        this.domNode.attributeModified(propertyName, value);
                    }
                }
            }
        };
        this.get = function () {
            return key in this ? this[key] : defaultValue;
        };
        this.nativeValueChange = function (owner, value) {
            var oldValue = key in owner ? owner[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                owner[key] = value;
                if (valueChanged) {
                    valueChanged(owner, oldValue, value);
                }
                if (owner.nativeViewProtected && !(defaultValueKey in owner)) {
                    owner[defaultValueKey] = owner[getDefault] ? owner[getDefault]() : defaultValue;
                }
                if (owner.hasListeners(eventName)) {
                    owner.notify({ object: owner, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    owner.requestLayout();
                }
                if (owner.domNode) {
                    owner.domNode.attributeModified(propertyName, value);
                }
            }
        };
        symbolPropertyMap[key] = this;
    }
    Property.prototype.register = function (cls) {
        if (this.registered) {
            throw new Error("Property " + this.name + " already registered.");
        }
        this.registered = true;
        Object.defineProperty(cls.prototype, this.name, this);
    };
    Property.prototype.isSet = function (instance) {
        return this.key in instance;
    };
    return Property;
}());
exports.Property = Property;
Property.prototype.isStyleProperty = false;
var CoercibleProperty = (function (_super) {
    __extends(CoercibleProperty, _super);
    function CoercibleProperty(options) {
        var _this = _super.call(this, options) || this;
        var propertyName = options.name;
        var key = _this.key;
        var getDefault = _this.getDefault;
        var setNative = _this.setNative;
        var defaultValueKey = _this.defaultValueKey;
        var defaultValue = _this.defaultValue;
        var coerceKey = Symbol(propertyName + ":coerceKey");
        var eventName = propertyName + "Change";
        var affectsLayout = options.affectsLayout;
        var equalityComparer = options.equalityComparer;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var coerceCallback = options.coerceValue;
        var property = _this;
        _this.coerce = function (target) {
            var originalValue = coerceKey in target ? target[coerceKey] : defaultValue;
            target[propertyName] = originalValue;
        };
        _this.set = function (boxedValue) {
            var reset = boxedValue === exports.unsetValue;
            var value;
            var wrapped;
            if (reset) {
                value = defaultValue;
                delete this[coerceKey];
            }
            else {
                wrapped = boxedValue && boxedValue.wrapped;
                value = wrapped ? observable_1.WrappedValue.unwrap(boxedValue) : boxedValue;
                if (valueConverter && typeof value === "string") {
                    value = valueConverter(value);
                }
                this[coerceKey] = value;
                value = coerceCallback(this, value);
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (wrapped || changed) {
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                this[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                this[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = this[getDefault] ? this[getDefault]() : defaultValue;
                            }
                            this[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    this.requestLayout();
                }
                if (this.domNode) {
                    if (reset) {
                        this.domNode.attributeRemoved(propertyName);
                    }
                    else {
                        this.domNode.attributeModified(propertyName, value);
                    }
                }
            }
        };
        return _this;
    }
    return CoercibleProperty;
}(Property));
exports.CoercibleProperty = CoercibleProperty;
var InheritedProperty = (function (_super) {
    __extends(InheritedProperty, _super);
    function InheritedProperty(options) {
        var _this = _super.call(this, options) || this;
        var name = options.name;
        var key = _this.key;
        var defaultValue = options.defaultValue;
        var sourceKey = Symbol(name + ":valueSourceKey");
        _this.sourceKey = sourceKey;
        var setBase = _this.set;
        var setFunc = function (valueSource) { return function (value) {
            var that = this;
            var unboxedValue;
            var newValueSource;
            if (value === exports.unsetValue) {
                var parent_1 = that.parent;
                if (parent_1 && parent_1[sourceKey] !== 0) {
                    unboxedValue = parent_1[name];
                    newValueSource = 1;
                }
                else {
                    unboxedValue = defaultValue;
                    newValueSource = 0;
                }
            }
            else {
                unboxedValue = value;
                newValueSource = valueSource;
            }
            var currentValue = that[key];
            setBase.call(that, unboxedValue);
            var newValue = that[key];
            that[sourceKey] = newValueSource;
            if (currentValue !== newValue) {
                var reset_1 = newValueSource === 0;
                that.eachChild(function (child) {
                    var childValueSource = child[sourceKey] || 0;
                    if (reset_1) {
                        if (childValueSource === 1) {
                            setFunc.call(child, exports.unsetValue);
                        }
                    }
                    else {
                        if (childValueSource <= 1) {
                            setInheritedValue.call(child, newValue);
                        }
                    }
                    return true;
                });
            }
        }; };
        var setInheritedValue = setFunc(1);
        _this.setInheritedValue = setInheritedValue;
        _this.set = setFunc(3);
        inheritableProperties.push(_this);
        return _this;
    }
    return InheritedProperty;
}(Property));
exports.InheritedProperty = InheritedProperty;
var CssProperty = (function () {
    function CssProperty(options) {
        var propertyName = options.name;
        this.name = propertyName;
        cssPropertyNames.push(options.cssName);
        this.cssName = "css:" + options.cssName;
        this.cssLocalName = options.cssName;
        var key = Symbol(propertyName + ":propertyKey");
        this.key = key;
        var sourceKey = Symbol(propertyName + ":valueSourceKey");
        this.sourceKey = sourceKey;
        var getDefault = Symbol(propertyName + ":getDefault");
        this.getDefault = getDefault;
        var setNative = Symbol(propertyName + ":setNative");
        this.setNative = setNative;
        var defaultValueKey = Symbol(propertyName + ":nativeDefaultValue");
        this.defaultValueKey = defaultValueKey;
        var defaultValue = options.defaultValue;
        this.defaultValue = defaultValue;
        var eventName = propertyName + "Change";
        var affectsLayout = options.affectsLayout;
        var equalityComparer = options.equalityComparer;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var property = this;
        function setLocalValue(newValue) {
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write(newValue + " not set to view because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
                return;
            }
            var reset = newValue === exports.unsetValue || newValue === "";
            var value;
            if (reset) {
                value = defaultValue;
                delete this[sourceKey];
            }
            else {
                this[sourceKey] = 3;
                value = (valueConverter && typeof newValue === "string") ?
                    valueConverter(newValue) :
                    newValue;
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                view[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                view[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                            }
                            view[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    view.requestLayout();
                }
            }
        }
        function setCssValue(newValue) {
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write(newValue + " not set to view because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
                return;
            }
            var currentValueSource = this[sourceKey] || 0;
            if (currentValueSource === 3) {
                return;
            }
            var reset = newValue === exports.unsetValue || newValue === "";
            var value;
            if (reset) {
                value = defaultValue;
                delete this[sourceKey];
            }
            else {
                value = valueConverter && typeof newValue === "string" ?
                    valueConverter(newValue) :
                    newValue;
                this[sourceKey] = 2;
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                view[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                view[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                            }
                            view[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    view.requestLayout();
                }
            }
        }
        function get() {
            return key in this ? this[key] : defaultValue;
        }
        this.cssValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: get,
            set: setCssValue
        };
        this.localValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: get,
            set: setLocalValue
        };
        cssSymbolPropertyMap[key] = this;
    }
    CssProperty.prototype.register = function (cls) {
        if (this.registered) {
            throw new Error("Property " + this.name + " already registered.");
        }
        this.registered = true;
        Object.defineProperty(cls.prototype, this.name, this.localValueDescriptor);
        Object.defineProperty(cls.prototype, this.cssName, this.cssValueDescriptor);
        if (this.cssLocalName !== this.cssName) {
            Object.defineProperty(cls.prototype, this.cssLocalName, this.localValueDescriptor);
        }
    };
    CssProperty.prototype.isSet = function (instance) {
        return this.key in instance;
    };
    return CssProperty;
}());
exports.CssProperty = CssProperty;
CssProperty.prototype.isStyleProperty = true;
var CssAnimationProperty = (function () {
    function CssAnimationProperty(options) {
        var valueConverter = options.valueConverter, equalityComparer = options.equalityComparer, valueChanged = options.valueChanged, defaultValue = options.defaultValue;
        var propertyName = options.name;
        this.name = propertyName;
        cssPropertyNames.push(options.cssName);
        CssAnimationProperty.properties[propertyName] = this;
        if (options.cssName && options.cssName !== propertyName) {
            CssAnimationProperty.properties[options.cssName] = this;
        }
        this._valueConverter = options.valueConverter;
        var cssLocalName = (options.cssName || propertyName);
        this.cssLocalName = cssLocalName;
        var cssName = "css:" + cssLocalName;
        this.cssName = cssName;
        var keyframeName = "keyframe:" + propertyName;
        this.keyframe = keyframeName;
        var defaultName = "default:" + propertyName;
        var defaultValueKey = Symbol(defaultName);
        this.defaultValueKey = defaultValueKey;
        this.defaultValue = defaultValue;
        var cssValue = Symbol(cssName);
        var styleValue = Symbol("local:" + propertyName);
        var keyframeValue = Symbol(keyframeName);
        var computedValue = Symbol("computed-value:" + propertyName);
        this.key = computedValue;
        var computedSource = Symbol("computed-source:" + propertyName);
        this.source = computedSource;
        this.getDefault = Symbol(propertyName + ":getDefault");
        var getDefault = this.getDefault;
        var setNative = this.setNative = Symbol(propertyName + ":setNative");
        var eventName = propertyName + "Change";
        var property = this;
        function descriptor(symbol, propertySource, enumerable, configurable, getsComputed) {
            return {
                enumerable: enumerable, configurable: configurable,
                get: getsComputed ? function () { return this[computedValue]; } : function () { return this[symbol]; },
                set: function (boxedValue) {
                    var view = this.viewRef.get();
                    if (!view) {
                        trace_1.write(boxedValue + " not set to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                        return;
                    }
                    var oldValue = this[computedValue];
                    var oldSource = this[computedSource];
                    var wasSet = oldSource !== 0;
                    var reset = boxedValue === exports.unsetValue || boxedValue === "";
                    if (reset) {
                        this[symbol] = exports.unsetValue;
                        if (this[computedSource] === propertySource) {
                            if (this[styleValue] !== exports.unsetValue) {
                                this[computedSource] = 3;
                                this[computedValue] = this[styleValue];
                            }
                            else if (this[cssValue] !== exports.unsetValue) {
                                this[computedSource] = 2;
                                this[computedValue] = this[cssValue];
                            }
                            else {
                                delete this[computedSource];
                                delete this[computedValue];
                            }
                        }
                    }
                    else {
                        if (valueConverter && typeof boxedValue === "string") {
                            boxedValue = valueConverter(boxedValue);
                        }
                        this[symbol] = boxedValue;
                        if (this[computedSource] <= propertySource) {
                            this[computedSource] = propertySource;
                            this[computedValue] = boxedValue;
                        }
                    }
                    var value = this[computedValue];
                    var source = this[computedSource];
                    var isSet = source !== 0;
                    var computedValueChanged = oldValue !== value && (!equalityComparer || !equalityComparer(oldValue, value));
                    if (computedValueChanged && valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative] && (computedValueChanged || isSet !== wasSet)) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (isSet) {
                                if (!wasSet && !(defaultValueKey in this)) {
                                    this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                                }
                                view[setNative](value);
                            }
                            else if (wasSet) {
                                if (defaultValueKey in this) {
                                    view[setNative](this[defaultValueKey]);
                                }
                                else {
                                    view[setNative](defaultValue);
                                }
                            }
                        }
                    }
                    if (computedValueChanged && this.hasListeners(eventName)) {
                        this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                    }
                }
            };
        }
        var defaultPropertyDescriptor = descriptor(defaultValueKey, 0, false, false, false);
        var cssPropertyDescriptor = descriptor(cssValue, 2, false, false, false);
        var stylePropertyDescriptor = descriptor(styleValue, 3, true, true, true);
        var keyframePropertyDescriptor = descriptor(keyframeValue, 4, false, false, false);
        symbolPropertyMap[computedValue] = this;
        cssSymbolPropertyMap[computedValue] = this;
        this.register = function (cls) {
            cls.prototype[computedValue] = options.defaultValue;
            cls.prototype[computedSource] = 0;
            cls.prototype[cssValue] = exports.unsetValue;
            cls.prototype[styleValue] = exports.unsetValue;
            cls.prototype[keyframeValue] = exports.unsetValue;
            Object.defineProperty(cls.prototype, defaultName, defaultPropertyDescriptor);
            Object.defineProperty(cls.prototype, cssName, cssPropertyDescriptor);
            Object.defineProperty(cls.prototype, propertyName, stylePropertyDescriptor);
            if (options.cssName && options.cssName !== options.name) {
                Object.defineProperty(cls.prototype, options.cssName, stylePropertyDescriptor);
            }
            Object.defineProperty(cls.prototype, keyframeName, keyframePropertyDescriptor);
        };
    }
    CssAnimationProperty.prototype._initDefaultNativeValue = function (target) {
        var view = target.viewRef.get();
        if (!view) {
            trace_1.write("_initDefaultNativeValue not executed to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
            return;
        }
        var defaultValueKey = this.defaultValueKey;
        if (!(defaultValueKey in target)) {
            var getDefault = this.getDefault;
            target[defaultValueKey] = view[getDefault] ? view[getDefault]() : this.defaultValue;
        }
    };
    CssAnimationProperty._getByCssName = function (name) {
        return this.properties[name];
    };
    CssAnimationProperty._getPropertyNames = function () {
        return Object.keys(CssAnimationProperty.properties);
    };
    CssAnimationProperty.prototype.isSet = function (instance) {
        return instance[this.source] !== 0;
    };
    CssAnimationProperty.properties = {};
    return CssAnimationProperty;
}());
exports.CssAnimationProperty = CssAnimationProperty;
CssAnimationProperty.prototype.isStyleProperty = true;
var InheritedCssProperty = (function (_super) {
    __extends(InheritedCssProperty, _super);
    function InheritedCssProperty(options) {
        var _this = _super.call(this, options) || this;
        var propertyName = options.name;
        var key = _this.key;
        var sourceKey = _this.sourceKey;
        var getDefault = _this.getDefault;
        var setNative = _this.setNative;
        var defaultValueKey = _this.defaultValueKey;
        var eventName = propertyName + "Change";
        var defaultValue = options.defaultValue;
        var affectsLayout = options.affectsLayout;
        var equalityComparer = options.equalityComparer;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var property = _this;
        var setFunc = function (valueSource) { return function (boxedValue) {
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write(boxedValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
                return;
            }
            var reset = boxedValue === exports.unsetValue || boxedValue === "";
            var currentValueSource = this[sourceKey] || 0;
            if (reset) {
                if (valueSource === 2 && currentValueSource === 3) {
                    return;
                }
            }
            else {
                if (currentValueSource > valueSource) {
                    return;
                }
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var value;
            var unsetNativeValue = false;
            if (reset) {
                var parent_2 = view.parent;
                var style = parent_2 ? parent_2.style : null;
                if (style && style[sourceKey] > 0) {
                    value = style[propertyName];
                    this[sourceKey] = 1;
                    this[key] = value;
                }
                else {
                    value = defaultValue;
                    delete this[sourceKey];
                    delete this[key];
                    unsetNativeValue = true;
                }
            }
            else {
                this[sourceKey] = valueSource;
                if (valueConverter && typeof boxedValue === "string") {
                    value = valueConverter(boxedValue);
                }
                else {
                    value = boxedValue;
                }
                this[key] = value;
            }
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                if (valueChanged) {
                    valueChanged(this, oldValue, value);
                }
                if (view[setNative]) {
                    if (view._suspendNativeUpdatesCount) {
                        if (view._suspendedUpdates) {
                            view._suspendedUpdates[propertyName] = property;
                        }
                    }
                    else {
                        if (unsetNativeValue) {
                            if (defaultValueKey in this) {
                                view[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                view[setNative](defaultValue);
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                            }
                            view[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    view.requestLayout();
                }
                view.eachChild(function (child) {
                    var childStyle = child.style;
                    var childValueSource = childStyle[sourceKey] || 0;
                    if (reset) {
                        if (childValueSource === 1) {
                            setDefaultFunc.call(childStyle, exports.unsetValue);
                        }
                    }
                    else {
                        if (childValueSource <= 1) {
                            setInheritedFunc.call(childStyle, value);
                        }
                    }
                    return true;
                });
            }
        }; };
        var setDefaultFunc = setFunc(0);
        var setInheritedFunc = setFunc(1);
        _this.setInheritedValue = setInheritedFunc;
        _this.cssValueDescriptor.set = setFunc(2);
        _this.localValueDescriptor.set = setFunc(3);
        inheritableCssProperties.push(_this);
        return _this;
    }
    return InheritedCssProperty;
}(CssProperty));
exports.InheritedCssProperty = InheritedCssProperty;
var ShorthandProperty = (function () {
    function ShorthandProperty(options) {
        this.name = options.name;
        var key = Symbol(this.name + ":propertyKey");
        this.key = key;
        this.cssName = "css:" + options.cssName;
        this.cssLocalName = "" + options.cssName;
        var converter = options.converter;
        function setLocalValue(value) {
            var _this = this;
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write("setLocalValue not executed to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                return;
            }
            view._batchUpdate(function () {
                for (var _i = 0, _a = converter(value); _i < _a.length; _i++) {
                    var _b = _a[_i], p = _b[0], v = _b[1];
                    _this[p.name] = v;
                }
            });
        }
        function setCssValue(value) {
            var _this = this;
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write("setCssValue not executed to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                return;
            }
            view._batchUpdate(function () {
                for (var _i = 0, _a = converter(value); _i < _a.length; _i++) {
                    var _b = _a[_i], p = _b[0], v = _b[1];
                    _this[p.cssName] = v;
                }
            });
        }
        this.cssValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: options.getter,
            set: setCssValue
        };
        this.localValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: options.getter,
            set: setLocalValue
        };
        this.propertyBagDescriptor = {
            enumerable: false,
            configurable: true,
            set: function (value) {
                var _this = this;
                converter(value).forEach(function (_a) {
                    var property = _a[0], value = _a[1];
                    _this[property.cssLocalName] = value;
                });
            }
        };
        cssSymbolPropertyMap[key] = this;
    }
    ShorthandProperty.prototype.register = function (cls) {
        if (this.registered) {
            throw new Error("Property " + this.name + " already registered.");
        }
        this.registered = true;
        Object.defineProperty(cls.prototype, this.name, this.localValueDescriptor);
        Object.defineProperty(cls.prototype, this.cssName, this.cssValueDescriptor);
        if (this.cssLocalName !== this.cssName) {
            Object.defineProperty(cls.prototype, this.cssLocalName, this.localValueDescriptor);
        }
        Object.defineProperty(cls.prototype.PropertyBag, this.cssLocalName, this.propertyBagDescriptor);
    };
    return ShorthandProperty;
}());
exports.ShorthandProperty = ShorthandProperty;
function inheritablePropertyValuesOn(view) {
    var array = new Array();
    for (var _i = 0, inheritableProperties_1 = inheritableProperties; _i < inheritableProperties_1.length; _i++) {
        var prop = inheritableProperties_1[_i];
        var sourceKey = prop.sourceKey;
        var valueSource = view[sourceKey] || 0;
        if (valueSource !== 0) {
            array.push({ property: prop, value: view[prop.name] });
        }
    }
    return array;
}
function inheritableCssPropertyValuesOn(style) {
    var array = new Array();
    for (var _i = 0, inheritableCssProperties_1 = inheritableCssProperties; _i < inheritableCssProperties_1.length; _i++) {
        var prop = inheritableCssProperties_1[_i];
        var sourceKey = prop.sourceKey;
        var valueSource = style[sourceKey] || 0;
        if (valueSource !== 0) {
            array.push({ property: prop, value: style[prop.name] });
        }
    }
    return array;
}
exports.initNativeView = profiling_1.profile("\"properties\".initNativeView", function initNativeView(view) {
    if (view._suspendedUpdates) {
        applyPendingNativeSetters(view);
    }
    else {
        applyAllNativeSetters(view);
    }
    view._suspendedUpdates = {};
});
function applyPendingNativeSetters(view) {
    var suspendedUpdates = view._suspendedUpdates;
    for (var propertyName in suspendedUpdates) {
        var property = suspendedUpdates[propertyName];
        var setNative = property.setNative;
        if (view[setNative]) {
            var getDefault = property.getDefault, isStyleProperty = property.isStyleProperty, defaultValueKey = property.defaultValueKey, defaultValue = property.defaultValue;
            var value = void 0;
            if (isStyleProperty) {
                var style = view.style;
                if (property.isSet(view.style)) {
                    if (!(defaultValueKey in style)) {
                        style[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                    }
                    value = view.style[propertyName];
                }
                else {
                    value = style[defaultValueKey];
                }
            }
            else {
                if (property.isSet(view)) {
                    if (!(defaultValueKey in view)) {
                        view[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                    }
                    value = view[propertyName];
                }
                else {
                    value = view[defaultValueKey];
                }
            }
            view[setNative](value);
        }
    }
}
exports.applyPendingNativeSetters = applyPendingNativeSetters;
function applyAllNativeSetters(view) {
    var symbols = Object.getOwnPropertySymbols(view);
    for (var _i = 0, symbols_2 = symbols; _i < symbols_2.length; _i++) {
        var symbol = symbols_2[_i];
        var property = symbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        var setNative = property.setNative;
        var getDefault = property.getDefault;
        if (setNative in view) {
            var defaultValueKey = property.defaultValueKey;
            if (!(defaultValueKey in view)) {
                view[defaultValueKey] = view[getDefault] ? view[getDefault]() : property.defaultValue;
            }
            var value = view[symbol];
            view[setNative](value);
        }
    }
    var style = view.style;
    symbols = Object.getOwnPropertySymbols(style);
    for (var _a = 0, symbols_3 = symbols; _a < symbols_3.length; _a++) {
        var symbol = symbols_3[_a];
        var property = cssSymbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        if (view[property.setNative]) {
            var defaultValueKey = property.defaultValueKey;
            if (!(defaultValueKey in style)) {
                style[defaultValueKey] = view[property.getDefault] ? view[property.getDefault]() : property.defaultValue;
            }
            var value = style[symbol];
            view[property.setNative](value);
        }
    }
}
exports.applyAllNativeSetters = applyAllNativeSetters;
function resetNativeView(view) {
    var symbols = Object.getOwnPropertySymbols(view);
    for (var _i = 0, symbols_4 = symbols; _i < symbols_4.length; _i++) {
        var symbol = symbols_4[_i];
        var property = symbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        if (view[property.setNative]) {
            if (property.defaultValueKey in view) {
                view[property.setNative](view[property.defaultValueKey]);
                delete view[property.defaultValueKey];
            }
            else {
                view[property.setNative](property.defaultValue);
            }
        }
    }
    var style = view.style;
    symbols = Object.getOwnPropertySymbols(style);
    for (var _a = 0, symbols_5 = symbols; _a < symbols_5.length; _a++) {
        var symbol = symbols_5[_a];
        var property = cssSymbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        if (view[property.setNative]) {
            if (property.defaultValueKey in style) {
                view[property.setNative](style[property.defaultValueKey]);
                delete style[property.defaultValueKey];
            }
            else {
                view[property.setNative](property.defaultValue);
            }
        }
    }
}
exports.resetNativeView = resetNativeView;
function clearInheritedProperties(view) {
    for (var _i = 0, inheritableProperties_2 = inheritableProperties; _i < inheritableProperties_2.length; _i++) {
        var prop = inheritableProperties_2[_i];
        var sourceKey = prop.sourceKey;
        if (view[sourceKey] === 1) {
            prop.set.call(view, exports.unsetValue);
        }
    }
    var style = view.style;
    for (var _a = 0, inheritableCssProperties_2 = inheritableCssProperties; _a < inheritableCssProperties_2.length; _a++) {
        var prop = inheritableCssProperties_2[_a];
        var sourceKey = prop.sourceKey;
        if (style[sourceKey] === 1) {
            prop.setInheritedValue.call(style, exports.unsetValue);
        }
    }
}
exports.clearInheritedProperties = clearInheritedProperties;
function resetCSSProperties(style) {
    var symbols = Object.getOwnPropertySymbols(style);
    for (var _i = 0, symbols_6 = symbols; _i < symbols_6.length; _i++) {
        var symbol = symbols_6[_i];
        var cssProperty = void 0;
        if (cssProperty = cssSymbolPropertyMap[symbol]) {
            style[cssProperty.cssName] = exports.unsetValue;
            if (cssProperty instanceof CssAnimationProperty) {
                style[cssProperty.keyframe] = exports.unsetValue;
            }
        }
    }
}
exports.resetCSSProperties = resetCSSProperties;
function propagateInheritableProperties(view, child) {
    var inheritablePropertyValues = inheritablePropertyValuesOn(view);
    for (var _i = 0, inheritablePropertyValues_1 = inheritablePropertyValues; _i < inheritablePropertyValues_1.length; _i++) {
        var pair = inheritablePropertyValues_1[_i];
        var prop = pair.property;
        var sourceKey = prop.sourceKey;
        var currentValueSource = child[sourceKey] || 0;
        if (currentValueSource <= 1) {
            prop.setInheritedValue.call(child, pair.value);
        }
    }
}
exports.propagateInheritableProperties = propagateInheritableProperties;
function propagateInheritableCssProperties(parentStyle, childStyle) {
    var inheritableCssPropertyValues = inheritableCssPropertyValuesOn(parentStyle);
    for (var _i = 0, inheritableCssPropertyValues_1 = inheritableCssPropertyValues; _i < inheritableCssPropertyValues_1.length; _i++) {
        var pair = inheritableCssPropertyValues_1[_i];
        var prop = pair.property;
        var sourceKey = prop.sourceKey;
        var currentValueSource = childStyle[sourceKey] || 0;
        if (currentValueSource <= 1) {
            prop.setInheritedValue.call(childStyle, pair.value, 1);
        }
    }
}
exports.propagateInheritableCssProperties = propagateInheritableCssProperties;
function makeValidator() {
    var values = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        values[_i] = arguments[_i];
    }
    var set = new Set(values);
    return function (value) { return set.has(value); };
}
exports.makeValidator = makeValidator;
function makeParser(isValid) {
    return function (value) {
        var lower = value && value.toLowerCase();
        if (isValid(lower)) {
            return lower;
        }
        else {
            throw new Error("Invalid value: " + value);
        }
    };
}
exports.makeParser = makeParser;
function getSetProperties(view) {
    var result = [];
    Object.getOwnPropertyNames(view).forEach(function (prop) {
        result.push([prop, view[prop]]);
    });
    var symbols = Object.getOwnPropertySymbols(view);
    for (var _i = 0, symbols_7 = symbols; _i < symbols_7.length; _i++) {
        var symbol = symbols_7[_i];
        var property = symbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        var value = view[property.key];
        result.push([property.name, value]);
    }
    return result;
}
exports.getSetProperties = getSetProperties;
function getComputedCssValues(view) {
    var result = [];
    var style = view.style;
    for (var _i = 0, cssPropertyNames_1 = cssPropertyNames; _i < cssPropertyNames_1.length; _i++) {
        var prop = cssPropertyNames_1[_i];
        result.push([prop, style[prop]]);
    }
    result.push(["top", "auto"]);
    result.push(["left", "auto"]);
    result.push(["bottom", "auto"]);
    result.push(["right", "auto"]);
    return result;
}
exports.getComputedCssValues = getComputedCssValues;
//# sourceMappingURL=properties.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/view-base/view-base.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var system_classes_1 = __webpack_require__("../node_modules/tns-core-modules/css/system-classes.js");
var debug_1 = __webpack_require__("../node_modules/tns-core-modules/utils/debug.js");
var bindable_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/bindable/bindable.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
exports.isIOS = platform_1.isIOS;
exports.isAndroid = platform_1.isAndroid;
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
exports.layout = utils_1.layout;
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
exports.Color = color_1.Color;
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/bindable/bindable.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js"));
var ssm = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");
var domNodeModule;
function ensuredomNodeModule() {
    if (!domNodeModule) {
        domNodeModule = __webpack_require__("../node_modules/tns-core-modules/debugger/dom-node.js");
    }
}
var styleScopeModule;
function ensureStyleScopeModule() {
    if (!styleScopeModule) {
        styleScopeModule = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");
    }
}
var defaultBindingSource = {};
function getAncestor(view, criterion) {
    var matcher = null;
    if (typeof criterion === "string") {
        matcher = function (view) { return view.typeName === criterion; };
    }
    else {
        matcher = function (view) { return view instanceof criterion; };
    }
    for (var parent_1 = view.parent; parent_1 != null; parent_1 = parent_1.parent) {
        if (matcher(parent_1)) {
            return parent_1;
        }
    }
    return null;
}
exports.getAncestor = getAncestor;
function getViewById(view, id) {
    if (!view) {
        return undefined;
    }
    if (view.id === id) {
        return view;
    }
    var retVal;
    var descendantsCallback = function (child) {
        if (child.id === id) {
            retVal = child;
            return false;
        }
        return true;
    };
    eachDescendant(view, descendantsCallback);
    return retVal;
}
exports.getViewById = getViewById;
function eachDescendant(view, callback) {
    if (!callback || !view) {
        return;
    }
    var continueIteration;
    var localCallback = function (child) {
        continueIteration = callback(child);
        if (continueIteration) {
            child.eachChild(localCallback);
        }
        return continueIteration;
    };
    view.eachChild(localCallback);
}
exports.eachDescendant = eachDescendant;
var viewIdCounter = 1;
var Flags;
(function (Flags) {
    Flags["superOnLoadedCalled"] = "Loaded";
    Flags["superOnUnloadedCalled"] = "Unloaded";
})(Flags || (Flags = {}));
var SuspendType;
(function (SuspendType) {
    SuspendType[SuspendType["Incremental"] = 0] = "Incremental";
    SuspendType[SuspendType["Loaded"] = 1048576] = "Loaded";
    SuspendType[SuspendType["NativeView"] = 2097152] = "NativeView";
    SuspendType[SuspendType["UISetup"] = 4194304] = "UISetup";
    SuspendType[SuspendType["IncrementalCountMask"] = -7340033] = "IncrementalCountMask";
})(SuspendType || (SuspendType = {}));
(function (SuspendType) {
    function toString(type) {
        return (type ? "suspended" : "resumed") + "(" +
            "Incremental: " + (type & SuspendType.IncrementalCountMask) + ", " +
            "Loaded: " + !(type & SuspendType.Loaded) + ", " +
            "NativeView: " + !(type & SuspendType.NativeView) + ", " +
            "UISetup: " + !(type & SuspendType.UISetup) +
            ")";
    }
    SuspendType.toString = toString;
})(SuspendType || (SuspendType = {}));
var ViewBase = (function (_super) {
    __extends(ViewBase, _super);
    function ViewBase() {
        var _this = _super.call(this) || this;
        _this._onLoadedCalled = false;
        _this._onUnloadedCalled = false;
        _this._cssState = new ssm.CssState(new WeakRef(_this));
        _this.pseudoClassAliases = {
            "highlighted": [
                "active",
                "pressed"
            ]
        };
        _this.cssClasses = new Set();
        _this.cssPseudoClasses = new Set();
        _this._domId = viewIdCounter++;
        _this._style = new properties_1.Style(new WeakRef(_this));
        return _this;
    }
    Object.defineProperty(ViewBase.prototype, "parentNode", {
        get: function () {
            return this._templateParent || this.parent;
        },
        set: function (node) {
            this._templateParent = node;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "nativeView", {
        get: function () {
            return this.nativeViewProtected;
        },
        set: function (value) {
            this.setNativeView(value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "typeName", {
        get: function () {
            return types.getClass(this);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "style", {
        get: function () {
            return this._style;
        },
        set: function (inlineStyle) {
            if (typeof inlineStyle === "string") {
                this.setInlineStyle(inlineStyle);
            }
            else {
                throw new Error("View.style property is read-only.");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "android", {
        get: function () {
            return this._androidView;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "ios", {
        get: function () {
            return this._iosView;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "isLoaded", {
        get: function () {
            return this._isLoaded;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "class", {
        get: function () {
            return this.className;
        },
        set: function (v) {
            this.className = v;
        },
        enumerable: true,
        configurable: true
    });
    ViewBase.prototype.getViewById = function (id) {
        return getViewById(this, id);
    };
    Object.defineProperty(ViewBase.prototype, "page", {
        get: function () {
            if (this.parent) {
                return this.parent.page;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    ViewBase.prototype.ensureDomNode = function () {
        if (!this.domNode) {
            ensuredomNodeModule();
            this.domNode = new domNodeModule.DOMNode(this);
        }
    };
    ViewBase.prototype.set = function (name, value) {
        this[name] = bindable_1.WrappedValue.unwrap(value);
    };
    ViewBase.prototype.onLoaded = function () {
        var _this = this;
        this.setFlag(Flags.superOnLoadedCalled, true);
        if (this._isLoaded) {
            return;
        }
        this._isLoaded = true;
        this._cssState.onLoaded();
        this._resumeNativeUpdates(SuspendType.Loaded);
        this.eachChild(function (child) {
            _this.loadView(child);
            return true;
        });
        this._emit("loaded");
    };
    ViewBase.prototype.onUnloaded = function () {
        var _this = this;
        this.setFlag(Flags.superOnUnloadedCalled, true);
        if (!this._isLoaded) {
            return;
        }
        this._suspendNativeUpdates(SuspendType.Loaded);
        this.eachChild(function (child) {
            _this.unloadView(child);
            return true;
        });
        this._isLoaded = false;
        this._cssState.onUnloaded();
        this._emit("unloaded");
    };
    ViewBase.prototype._suspendNativeUpdates = function (type) {
        if (type) {
            this._suspendNativeUpdatesCount = this._suspendNativeUpdatesCount | type;
        }
        else {
            this._suspendNativeUpdatesCount++;
        }
    };
    ViewBase.prototype._resumeNativeUpdates = function (type) {
        if (type) {
            this._suspendNativeUpdatesCount = this._suspendNativeUpdatesCount & ~type;
        }
        else {
            if ((this._suspendNativeUpdatesCount & SuspendType.IncrementalCountMask) === 0) {
                throw new Error("Invalid call to " + this + "._resumeNativeUpdates");
            }
            this._suspendNativeUpdatesCount--;
        }
        if (!this._suspendNativeUpdatesCount) {
            this.onResumeNativeUpdates();
        }
    };
    ViewBase.prototype._batchUpdate = function (callback) {
        try {
            this._suspendNativeUpdates(SuspendType.Incremental);
            return callback();
        }
        finally {
            this._resumeNativeUpdates(SuspendType.Incremental);
        }
    };
    ViewBase.prototype.setFlag = function (flag, value) {
        switch (flag) {
            case Flags.superOnLoadedCalled:
                this._onLoadedCalled = value;
                break;
            case Flags.superOnUnloadedCalled:
                this._onUnloadedCalled = value;
                break;
        }
    };
    ViewBase.prototype.isFlagSet = function (flag) {
        switch (flag) {
            case Flags.superOnLoadedCalled:
                return this._onLoadedCalled;
            case Flags.superOnUnloadedCalled:
                return this._onUnloadedCalled;
        }
    };
    ViewBase.prototype.callFunctionWithSuper = function (flag, func) {
        this.setFlag(flag, false);
        func();
        if (!this.isFlagSet(flag)) {
            throw new Error("super." + flag + " not called in " + this);
        }
    };
    ViewBase.prototype.callLoaded = function () {
        var _this = this;
        this.callFunctionWithSuper(Flags.superOnLoadedCalled, function () { return _this.onLoaded(); });
    };
    ViewBase.prototype.callUnloaded = function () {
        var _this = this;
        this.callFunctionWithSuper(Flags.superOnUnloadedCalled, function () { return _this.onUnloaded(); });
    };
    ViewBase.prototype.notifyPseudoClassChanged = function (pseudoClass) {
        this.notify({ eventName: ":" + pseudoClass, object: this });
    };
    ViewBase.prototype.getAllAliasedStates = function (name) {
        var allStates = [];
        allStates.push(name);
        if (name in this.pseudoClassAliases) {
            for (var i = 0; i < this.pseudoClassAliases[name].length; i++) {
                allStates.push(this.pseudoClassAliases[name][i]);
            }
        }
        return allStates;
    };
    ViewBase.prototype.addPseudoClass = function (name) {
        var allStates = this.getAllAliasedStates(name);
        for (var i = 0; i < allStates.length; i++) {
            if (!this.cssPseudoClasses.has(allStates[i])) {
                this.cssPseudoClasses.add(allStates[i]);
                this.notifyPseudoClassChanged(allStates[i]);
            }
        }
    };
    ViewBase.prototype.deletePseudoClass = function (name) {
        var allStates = this.getAllAliasedStates(name);
        for (var i = 0; i < allStates.length; i++) {
            if (this.cssPseudoClasses.has(allStates[i])) {
                this.cssPseudoClasses.delete(allStates[i]);
                this.notifyPseudoClassChanged(allStates[i]);
            }
        }
    };
    ViewBase.prototype.bindingContextChanged = function (data) {
        this.bindings.get("bindingContext").bind(data.value);
    };
    ViewBase.prototype.bind = function (options, source) {
        if (source === void 0) { source = defaultBindingSource; }
        var targetProperty = options.targetProperty;
        this.unbind(targetProperty);
        if (!this.bindings) {
            this.bindings = new Map();
        }
        var binding = new bindable_1.Binding(this, options);
        this.bindings.set(targetProperty, binding);
        var bindingSource = source;
        if (bindingSource === defaultBindingSource) {
            bindingSource = this.bindingContext;
            binding.sourceIsBindingContext = true;
            if (targetProperty === "bindingContext") {
                this.bindingContextBoundToParentBindingContextChanged = true;
                var parent_2 = this.parent;
                if (parent_2) {
                    parent_2.on("bindingContextChange", this.bindingContextChanged, this);
                }
                else {
                    this.shouldAddHandlerToParentBindingContextChanged = true;
                }
            }
        }
        binding.bind(bindingSource);
    };
    ViewBase.prototype.unbind = function (property) {
        var bindings = this.bindings;
        if (!bindings) {
            return;
        }
        var binding = bindings.get(property);
        if (binding) {
            binding.unbind();
            bindings.delete(property);
            if (binding.sourceIsBindingContext) {
                if (property === "bindingContext") {
                    this.shouldAddHandlerToParentBindingContextChanged = false;
                    this.bindingContextBoundToParentBindingContextChanged = false;
                    var parent_3 = this.parent;
                    if (parent_3) {
                        parent_3.off("bindingContextChange", this.bindingContextChanged, this);
                    }
                }
            }
        }
    };
    ViewBase.prototype.requestLayout = function () {
        var parent = this.parent;
        if (parent) {
            parent.requestLayout();
        }
    };
    ViewBase.prototype.eachChild = function (callback) {
    };
    ViewBase.prototype._addView = function (view, atIndex) {
        if (bindable_1.traceEnabled()) {
            bindable_1.traceWrite(this + "._addView(" + view + ", " + atIndex + ")", bindable_1.traceCategories.ViewHierarchy);
        }
        if (!view) {
            throw new Error("Expecting a valid View instance.");
        }
        if (!(view instanceof ViewBase)) {
            throw new Error(view + " is not a valid View instance.");
        }
        if (view.parent) {
            throw new Error("View already has a parent. View: " + view + " Parent: " + view.parent);
        }
        view.parent = this;
        this._addViewCore(view, atIndex);
        view._parentChanged(null);
        if (this.domNode) {
            this.domNode.onChildAdded(view);
        }
    };
    ViewBase.prototype._addViewCore = function (view, atIndex) {
        properties_1.propagateInheritableProperties(this, view);
        view._inheritStyleScope(this._styleScope);
        properties_1.propagateInheritableCssProperties(this.style, view.style);
        if (this._context) {
            view._setupUI(this._context, atIndex);
        }
        if (this._isLoaded) {
            this.loadView(view);
        }
    };
    ViewBase.prototype.loadView = function (view) {
        if (view && !view.isLoaded) {
            view.callLoaded();
        }
    };
    ViewBase.prototype.unloadView = function (view) {
        if (view && view.isLoaded) {
            view.callUnloaded();
        }
    };
    ViewBase.prototype._removeView = function (view) {
        if (bindable_1.traceEnabled()) {
            bindable_1.traceWrite(this + "._removeView(" + view + ")", bindable_1.traceCategories.ViewHierarchy);
        }
        if (view.parent !== this) {
            throw new Error("View not added to this instance. View: " + view + " CurrentParent: " + view.parent + " ExpectedParent: " + this);
        }
        if (this.domNode) {
            this.domNode.onChildRemoved(view);
        }
        this._removeViewCore(view);
        view.parent = undefined;
        view._parentChanged(this);
    };
    ViewBase.prototype._removeViewCore = function (view) {
        this.unloadView(view);
        if (view._context) {
            view._tearDownUI();
        }
    };
    ViewBase.prototype.createNativeView = function () {
        return undefined;
    };
    ViewBase.prototype.disposeNativeView = function () {
    };
    ViewBase.prototype.initNativeView = function () {
    };
    ViewBase.prototype.resetNativeView = function () {
    };
    ViewBase.prototype.resetNativeViewInternal = function () {
    };
    ViewBase.prototype._setupAsRootView = function (context) {
        this._setupUI(context);
    };
    ViewBase.prototype._setupUI = function (context, atIndex, parentIsLoaded) {
        if (this._context === context) {
            return;
        }
        else if (this._context) {
            this._tearDownUI(true);
        }
        this._context = context;
        var nativeView = this.nativeViewProtected;
        if (!nativeView) {
            nativeView = this.createNativeView();
        }
        if (platform_1.isAndroid) {
            this._androidView = nativeView;
            if (nativeView) {
                if (this._isPaddingRelative === undefined) {
                    this._isPaddingRelative = nativeView.isPaddingRelative();
                }
                var result = nativeView.defaultPaddings;
                if (result === undefined) {
                    result = org.nativescript.widgets.ViewHelper.getPadding(nativeView);
                    nativeView.defaultPaddings = result;
                }
                this._defaultPaddingTop = result.top;
                this._defaultPaddingRight = result.right;
                this._defaultPaddingBottom = result.bottom;
                this._defaultPaddingLeft = result.left;
                var style = this.style;
                if (!style_properties_1.paddingTopProperty.isSet(style)) {
                    this.effectivePaddingTop = this._defaultPaddingTop;
                }
                if (!style_properties_1.paddingRightProperty.isSet(style)) {
                    this.effectivePaddingRight = this._defaultPaddingRight;
                }
                if (!style_properties_1.paddingBottomProperty.isSet(style)) {
                    this.effectivePaddingBottom = this._defaultPaddingBottom;
                }
                if (!style_properties_1.paddingLeftProperty.isSet(style)) {
                    this.effectivePaddingLeft = this._defaultPaddingLeft;
                }
            }
        }
        else {
            this._iosView = nativeView;
        }
        this.setNativeView(nativeView);
        if (this.parent) {
            var nativeIndex = this.parent._childIndexToNativeChildIndex(atIndex);
            this._isAddedToNativeVisualTree = this.parent._addViewToNativeVisualTree(this, nativeIndex);
        }
        this._resumeNativeUpdates(SuspendType.UISetup);
        this.eachChild(function (child) {
            child._setupUI(context);
            return true;
        });
    };
    ViewBase.prototype.setNativeView = function (value) {
        if (this.__nativeView === value) {
            return;
        }
        if (this.__nativeView) {
            this._suspendNativeUpdates(SuspendType.NativeView);
        }
        this.__nativeView = this.nativeViewProtected = value;
        if (this.__nativeView) {
            this._suspendedUpdates = undefined;
            this.initNativeView();
            this._resumeNativeUpdates(SuspendType.NativeView);
        }
    };
    ViewBase.prototype._tearDownUI = function (force) {
        if (!this._context) {
            return;
        }
        this.resetNativeViewInternal();
        this.eachChild(function (child) {
            child._tearDownUI(force);
            return true;
        });
        if (this.parent) {
            this.parent._removeViewFromNativeVisualTree(this);
        }
        this.disposeNativeView();
        this._suspendNativeUpdates(SuspendType.UISetup);
        if (platform_1.isAndroid) {
            this.setNativeView(null);
            this._androidView = null;
        }
        this._context = null;
        if (this.domNode) {
            this.domNode.dispose();
            this.domNode = undefined;
        }
    };
    ViewBase.prototype._childIndexToNativeChildIndex = function (index) {
        return index;
    };
    ViewBase.prototype._addViewToNativeVisualTree = function (view, atIndex) {
        if (view._isAddedToNativeVisualTree) {
            throw new Error("Child already added to the native visual tree.");
        }
        return true;
    };
    ViewBase.prototype._removeViewFromNativeVisualTree = function (view) {
        view._isAddedToNativeVisualTree = false;
    };
    ViewBase.prototype._goToVisualState = function (state) {
        if (bindable_1.traceEnabled()) {
            bindable_1.traceWrite(this + " going to state: " + state, bindable_1.traceCategories.Style);
        }
        if (state === this._visualState) {
            return;
        }
        this.deletePseudoClass(this._visualState);
        this._visualState = state;
        this.addPseudoClass(state);
    };
    ViewBase.prototype._applyXmlAttribute = function (attribute, value) {
        console.log("ViewBase._applyXmlAttribute(...) is deprecated; set attributes as plain properties instead");
        if (attribute === "style" || attribute === "rows" || attribute === "columns" || attribute === "fontAttributes") {
            this[attribute] = value;
            return true;
        }
        return false;
    };
    ViewBase.prototype.setInlineStyle = function (style) {
        if (typeof style !== "string") {
            throw new Error("Parameter should be valid CSS string!");
        }
        ensureStyleScopeModule();
        styleScopeModule.applyInlineStyle(this, style);
    };
    ViewBase.prototype._parentChanged = function (oldParent) {
        var newParent = this.parent;
        if (oldParent) {
            properties_1.clearInheritedProperties(this);
            if (this.bindingContextBoundToParentBindingContextChanged) {
                oldParent.off("bindingContextChange", this.bindingContextChanged, this);
            }
        }
        else if (this.shouldAddHandlerToParentBindingContextChanged) {
            newParent.on("bindingContextChange", this.bindingContextChanged, this);
            this.bindings.get("bindingContext").bind(newParent.bindingContext);
        }
    };
    ViewBase.prototype.onResumeNativeUpdates = function () {
        properties_1.initNativeView(this);
    };
    ViewBase.prototype.toString = function () {
        var str = this.typeName;
        if (this.id) {
            str += "<" + this.id + ">";
        }
        else {
            str += "(" + this._domId + ")";
        }
        var source = debug_1.Source.get(this);
        if (source) {
            str += "@" + source + ";";
        }
        return str;
    };
    ViewBase.prototype._onCssStateChange = function () {
        this._cssState.onChange();
        eachDescendant(this, function (child) {
            child._cssState.onChange();
            return true;
        });
    };
    ViewBase.prototype._inheritStyleScope = function (styleScope) {
        if (this._isStyleScopeHost) {
            return;
        }
        if (this._styleScope !== styleScope) {
            this._styleScope = styleScope;
            this._onCssStateChange();
            this.eachChild(function (child) {
                child._inheritStyleScope(styleScope);
                return true;
            });
        }
    };
    ViewBase.prototype.showModal = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var parent = this.parent;
        return parent && parent.showModal.apply(parent, args);
    };
    ViewBase.prototype.closeModal = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var parent = this.parent;
        if (parent) {
            parent.closeModal.apply(parent, args);
        }
    };
    ViewBase.prototype._dialogClosed = function () {
        eachDescendant(this, function (child) {
            child._dialogClosed();
            return true;
        });
    };
    ViewBase.prototype._onRootViewReset = function () {
        eachDescendant(this, function (child) {
            child._onRootViewReset();
            return true;
        });
    };
    ViewBase.loadedEvent = "loaded";
    ViewBase.unloadedEvent = "unloaded";
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "onLoaded", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "onUnloaded", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "addPseudoClass", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "deletePseudoClass", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "requestLayout", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "_addView", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "_setupUI", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "_tearDownUI", null);
    return ViewBase;
}(bindable_1.Observable));
exports.ViewBase = ViewBase;
ViewBase.prototype.isCollapsed = false;
ViewBase.prototype._oldLeft = 0;
ViewBase.prototype._oldTop = 0;
ViewBase.prototype._oldRight = 0;
ViewBase.prototype._oldBottom = 0;
ViewBase.prototype.effectiveMinWidth = 0;
ViewBase.prototype.effectiveMinHeight = 0;
ViewBase.prototype.effectiveWidth = 0;
ViewBase.prototype.effectiveHeight = 0;
ViewBase.prototype.effectiveMarginTop = 0;
ViewBase.prototype.effectiveMarginRight = 0;
ViewBase.prototype.effectiveMarginBottom = 0;
ViewBase.prototype.effectiveMarginLeft = 0;
ViewBase.prototype.effectivePaddingTop = 0;
ViewBase.prototype.effectivePaddingRight = 0;
ViewBase.prototype.effectivePaddingBottom = 0;
ViewBase.prototype.effectivePaddingLeft = 0;
ViewBase.prototype.effectiveBorderTopWidth = 0;
ViewBase.prototype.effectiveBorderRightWidth = 0;
ViewBase.prototype.effectiveBorderBottomWidth = 0;
ViewBase.prototype.effectiveBorderLeftWidth = 0;
ViewBase.prototype._defaultPaddingTop = 0;
ViewBase.prototype._defaultPaddingRight = 0;
ViewBase.prototype._defaultPaddingBottom = 0;
ViewBase.prototype._defaultPaddingLeft = 0;
ViewBase.prototype._isViewBase = true;
ViewBase.prototype.recycleNativeView = "never";
ViewBase.prototype._suspendNativeUpdatesCount =
    SuspendType.Loaded |
        SuspendType.NativeView |
        SuspendType.UISetup;
exports.bindingContextProperty = new properties_1.InheritedProperty({ name: "bindingContext" });
exports.bindingContextProperty.register(ViewBase);
exports.classNameProperty = new properties_1.Property({
    name: "className",
    valueChanged: function (view, oldValue, newValue) {
        var cssClasses = view.cssClasses;
        var modalViewCssClass = system_classes_1.getModalRootViewCssClass();
        var rootViewCssClasses = system_classes_1.getRootViewCssClasses();
        var shouldAddModalRootViewCssClass = cssClasses.has(modalViewCssClass);
        var shouldAddRootViewCssClasses = cssClasses.has(rootViewCssClasses[0]);
        cssClasses.clear();
        if (shouldAddModalRootViewCssClass) {
            cssClasses.add(modalViewCssClass);
        }
        else if (shouldAddRootViewCssClasses) {
            rootViewCssClasses.forEach(function (c) { return cssClasses.add(c); });
        }
        if (typeof newValue === "string" && newValue !== "") {
            newValue.split(" ").forEach(function (c) { return cssClasses.add(c); });
        }
        view._onCssStateChange();
    }
});
exports.classNameProperty.register(ViewBase);
exports.idProperty = new properties_1.Property({ name: "id", valueChanged: function (view, oldValue, newValue) { return view._onCssStateChange(); } });
exports.idProperty.register(ViewBase);
function booleanConverter(v) {
    var lowercase = (v + "").toLowerCase();
    if (lowercase === "true") {
        return true;
    }
    else if (lowercase === "false") {
        return false;
    }
    throw new Error("Invalid boolean: " + v);
}
exports.booleanConverter = booleanConverter;
//# sourceMappingURL=view-base.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/view/view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view-base/view-base.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var gestures_1 = __webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures.js");
var system_classes_1 = __webpack_require__("../node_modules/tns-core-modules/css/system-classes.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var style_scope_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
exports.LinearGradient = linear_gradient_1.LinearGradient;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view-base/view-base.js"));
var animationModule;
function ensureAnimationModule() {
    if (!animationModule) {
        animationModule = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
    }
}
function CSSType(type) {
    return function (cls) {
        cls.prototype.cssType = type;
    };
}
exports.CSSType = CSSType;
function viewMatchesModuleContext(view, context, types) {
    return context &&
        view._moduleName &&
        context.type &&
        types.some(function (type) { return type === context.type; }) &&
        context.path &&
        context.path.includes(view._moduleName);
}
exports.viewMatchesModuleContext = viewMatchesModuleContext;
function PseudoClassHandler() {
    var pseudoClasses = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        pseudoClasses[_i] = arguments[_i];
    }
    var stateEventNames = pseudoClasses.map(function (s) { return ":" + s; });
    var listeners = Symbol("listeners");
    return function (target, propertyKey, descriptor) {
        function update(change) {
            var prev = this[listeners] || 0;
            var next = prev + change;
            if (prev <= 0 && next > 0) {
                this[propertyKey](true);
            }
            else if (prev > 0 && next <= 0) {
                this[propertyKey](false);
            }
        }
        stateEventNames.forEach(function (s) { return target[s] = update; });
    };
}
exports.PseudoClassHandler = PseudoClassHandler;
exports._rootModalViews = new Array();
var ViewCommon = (function (_super) {
    __extends(ViewCommon, _super);
    function ViewCommon() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._gestureObservers = {};
        return _this;
    }
    Object.defineProperty(ViewCommon.prototype, "css", {
        get: function () {
            var scope = this._styleScope;
            return scope && scope.css;
        },
        set: function (value) {
            this._updateStyleScope(undefined, undefined, value);
        },
        enumerable: true,
        configurable: true
    });
    ViewCommon.prototype.addCss = function (cssString) {
        this._updateStyleScope(undefined, cssString);
    };
    ViewCommon.prototype.addCssFile = function (cssFileName) {
        this._updateStyleScope(cssFileName);
    };
    ViewCommon.prototype.changeCssFile = function (cssFileName) {
        var scope = this._styleScope;
        if (scope && cssFileName) {
            scope.changeCssFile(cssFileName);
            this._onCssStateChange();
        }
    };
    ViewCommon.prototype._updateStyleScope = function (cssFileName, cssString, css) {
        var scope = this._styleScope;
        if (!scope) {
            scope = new style_scope_1.StyleScope();
            this.setScopeProperty(scope, cssFileName, cssString, css);
            this._inheritStyleScope(scope);
            this._isStyleScopeHost = true;
        }
        else {
            this.setScopeProperty(scope, cssFileName, cssString, css);
            this._onCssStateChange();
        }
    };
    ViewCommon.prototype.setScopeProperty = function (scope, cssFileName, cssString, css) {
        if (cssFileName !== undefined) {
            scope.addCssFile(cssFileName);
        }
        else if (cssString !== undefined) {
            scope.addCss(cssString);
        }
        else if (css !== undefined) {
            scope.css = css;
        }
    };
    ViewCommon.prototype._closeAllModalViewsInternal = function () {
        if (exports._rootModalViews && exports._rootModalViews.length > 0) {
            exports._rootModalViews.forEach(function (v) {
                v.closeModal();
            });
            return true;
        }
        return false;
    };
    ViewCommon.prototype._getRootModalViews = function () {
        return exports._rootModalViews;
    };
    ViewCommon.prototype._onLivesync = function (context) {
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(this + "._onLivesync(" + JSON.stringify(context) + ")", view_base_1.traceCategories.Livesync);
        }
        if (this._closeAllModalViewsInternal()) {
            return true;
        }
        if (this._handleLivesync(context)) {
            return true;
        }
        var handled = false;
        this.eachChildView(function (child) {
            if (child._onLivesync(context)) {
                handled = true;
                return false;
            }
        });
        return handled;
    };
    ViewCommon.prototype._handleLivesync = function (context) {
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(this + "._handleLivesync(" + JSON.stringify(context) + ")", view_base_1.traceCategories.Livesync);
        }
        if (viewMatchesModuleContext(this, context, ["style"])) {
            if (view_base_1.traceEnabled()) {
                view_base_1.traceWrite("Change Handled: Changing CSS for " + this, view_base_1.traceCategories.Livesync);
            }
            var cssModuleName = module_name_sanitizer_1.sanitizeModuleName(context.path) + ".css";
            this.changeCssFile(cssModuleName);
            return true;
        }
        if (viewMatchesModuleContext(this, context, ["markup", "script"]) &&
            this.page &&
            this.page.frame) {
            if (view_base_1.traceEnabled()) {
                view_base_1.traceWrite("Change Handled: Changing " + context.type + " for " + this + " inside " + this.page, view_base_1.traceCategories.Livesync);
            }
            return this.page.frame._handleLivesync({ type: context.type, path: this.page._moduleName });
        }
        return false;
    };
    ViewCommon.prototype._setupAsRootView = function (context) {
        _super.prototype._setupAsRootView.call(this, context);
        if (!this._styleScope) {
            this._updateStyleScope();
        }
    };
    ViewCommon.prototype._observe = function (type, callback, thisArg) {
        if (!this._gestureObservers[type]) {
            this._gestureObservers[type] = [];
        }
        this._gestureObservers[type].push(gestures_1.observe(this, type, callback, thisArg));
    };
    ViewCommon.prototype.getGestureObservers = function (type) {
        return this._gestureObservers[type];
    };
    ViewCommon.prototype.addEventListener = function (arg, callback, thisArg) {
        if (typeof arg === "string") {
            arg = view_base_1.getEventOrGestureName(arg);
            var gesture = gestures_1.fromString(arg);
            if (gesture && !this._isEvent(arg)) {
                this._observe(gesture, callback, thisArg);
            }
            else {
                var events = (arg).split(",");
                if (events.length > 0) {
                    for (var i = 0; i < events.length; i++) {
                        var evt = events[i].trim();
                        var gst = gestures_1.fromString(evt);
                        if (gst && !this._isEvent(arg)) {
                            this._observe(gst, callback, thisArg);
                        }
                        else {
                            _super.prototype.addEventListener.call(this, evt, callback, thisArg);
                        }
                    }
                }
                else {
                    _super.prototype.addEventListener.call(this, arg, callback, thisArg);
                }
            }
        }
        else if (typeof arg === "number") {
            this._observe(arg, callback, thisArg);
        }
    };
    ViewCommon.prototype.removeEventListener = function (arg, callback, thisArg) {
        if (typeof arg === "string") {
            var gesture = gestures_1.fromString(arg);
            if (gesture && !this._isEvent(arg)) {
                this._disconnectGestureObservers(gesture);
            }
            else {
                var events = arg.split(",");
                if (events.length > 0) {
                    for (var i = 0; i < events.length; i++) {
                        var evt = events[i].trim();
                        var gst = gestures_1.fromString(evt);
                        if (gst && !this._isEvent(arg)) {
                            this._disconnectGestureObservers(gst);
                        }
                        else {
                            _super.prototype.removeEventListener.call(this, evt, callback, thisArg);
                        }
                    }
                }
                else {
                    _super.prototype.removeEventListener.call(this, arg, callback, thisArg);
                }
            }
        }
        else if (typeof arg === "number") {
            this._disconnectGestureObservers(arg);
        }
    };
    ViewCommon.prototype.onBackPressed = function () {
        return false;
    };
    ViewCommon.prototype._getFragmentManager = function () {
        return undefined;
    };
    ViewCommon.prototype.getModalOptions = function (args) {
        if (args.length === 0) {
            throw new Error("showModal without parameters is deprecated. Please call showModal on a view instance instead.");
        }
        else {
            var options = null;
            if (args.length === 2) {
                options = args[1];
            }
            else {
                if (args[0] instanceof ViewCommon) {
                    console.log("showModal(view: ViewBase, context: any, closeCallback: Function, fullscreen?: boolean, animated?: boolean, stretched?: boolean) " +
                        "is deprecated. Use showModal(view: ViewBase, modalOptions: ShowModalOptions) instead.");
                }
                else {
                    console.log("showModal(moduleName: string, context: any, closeCallback: Function, fullscreen?: boolean, animated?: boolean, stretched?: boolean) " +
                        "is deprecated. Use showModal(moduleName: string, modalOptions: ShowModalOptions) instead.");
                }
                options = {
                    context: args[1],
                    closeCallback: args[2],
                    fullscreen: args[3],
                    animated: args[4],
                    stretched: args[5]
                };
            }
            var firstArgument = args[0];
            var view = firstArgument instanceof ViewCommon
                ? firstArgument : builder_1.createViewFromEntry({ moduleName: firstArgument });
            return { view: view, options: options };
        }
    };
    ViewCommon.prototype.showModal = function () {
        var _a = this.getModalOptions(arguments), view = _a.view, options = _a.options;
        view._showNativeModalView(this, options);
        return view;
    };
    ViewCommon.prototype.closeModal = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var closeCallback = this._closeModalCallback;
        if (closeCallback) {
            closeCallback.apply(undefined, arguments);
        }
        else {
            var parent_1 = this.parent;
            if (parent_1) {
                parent_1.closeModal.apply(parent_1, args);
            }
        }
    };
    Object.defineProperty(ViewCommon.prototype, "modal", {
        get: function () {
            return this._modal;
        },
        enumerable: true,
        configurable: true
    });
    ViewCommon.prototype._showNativeModalView = function (parent, options) {
        exports._rootModalViews.push(this);
        var modalRootViewCssClass = system_classes_1.getModalRootViewCssClass();
        this.cssClasses.add(modalRootViewCssClass);
        parent._modal = this;
        this._modalParent = parent;
        this._modalContext = options.context;
        var that = this;
        this._closeModalCallback = function () {
            var originalArgs = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                originalArgs[_i] = arguments[_i];
            }
            if (that._closeModalCallback) {
                var modalIndex = exports._rootModalViews.indexOf(that);
                exports._rootModalViews.splice(modalIndex);
                that._modalParent = null;
                that._modalContext = null;
                that._closeModalCallback = null;
                that._dialogClosed();
                parent._modal = null;
                var whenClosedCallback = function () {
                    if (typeof options.closeCallback === "function") {
                        options.closeCallback.apply(undefined, originalArgs);
                    }
                };
                that._hideNativeModalView(parent, whenClosedCallback);
            }
        };
    };
    ViewCommon.prototype._raiseLayoutChangedEvent = function () {
        var args = {
            eventName: ViewCommon.layoutChangedEvent,
            object: this
        };
        this.notify(args);
    };
    ViewCommon.prototype._raiseShownModallyEvent = function () {
        var args = {
            eventName: ViewCommon.shownModallyEvent,
            object: this,
            context: this._modalContext,
            closeCallback: this._closeModalCallback
        };
        this.notify(args);
    };
    ViewCommon.prototype._raiseShowingModallyEvent = function () {
        var args = {
            eventName: ViewCommon.showingModallyEvent,
            object: this,
            context: this._modalContext,
            closeCallback: this._closeModalCallback
        };
        this.notify(args);
    };
    ViewCommon.prototype._isEvent = function (name) {
        return this.constructor && name + "Event" in this.constructor;
    };
    ViewCommon.prototype._disconnectGestureObservers = function (type) {
        var observers = this.getGestureObservers(type);
        if (observers) {
            for (var i = 0; i < observers.length; i++) {
                observers[i].disconnect();
            }
        }
    };
    Object.defineProperty(ViewCommon.prototype, "borderColor", {
        get: function () {
            return this.style.borderColor;
        },
        set: function (value) {
            this.style.borderColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopColor", {
        get: function () {
            return this.style.borderTopColor;
        },
        set: function (value) {
            this.style.borderTopColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderRightColor", {
        get: function () {
            return this.style.borderRightColor;
        },
        set: function (value) {
            this.style.borderRightColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomColor", {
        get: function () {
            return this.style.borderBottomColor;
        },
        set: function (value) {
            this.style.borderBottomColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderLeftColor", {
        get: function () {
            return this.style.borderLeftColor;
        },
        set: function (value) {
            this.style.borderLeftColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderWidth", {
        get: function () {
            return this.style.borderWidth;
        },
        set: function (value) {
            this.style.borderWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopWidth", {
        get: function () {
            return this.style.borderTopWidth;
        },
        set: function (value) {
            this.style.borderTopWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderRightWidth", {
        get: function () {
            return this.style.borderRightWidth;
        },
        set: function (value) {
            this.style.borderRightWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomWidth", {
        get: function () {
            return this.style.borderBottomWidth;
        },
        set: function (value) {
            this.style.borderBottomWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderLeftWidth", {
        get: function () {
            return this.style.borderLeftWidth;
        },
        set: function (value) {
            this.style.borderLeftWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderRadius", {
        get: function () {
            return this.style.borderRadius;
        },
        set: function (value) {
            this.style.borderRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopLeftRadius", {
        get: function () {
            return this.style.borderTopLeftRadius;
        },
        set: function (value) {
            this.style.borderTopLeftRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopRightRadius", {
        get: function () {
            return this.style.borderTopRightRadius;
        },
        set: function (value) {
            this.style.borderTopRightRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomRightRadius", {
        get: function () {
            return this.style.borderBottomRightRadius;
        },
        set: function (value) {
            this.style.borderBottomRightRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomLeftRadius", {
        get: function () {
            return this.style.borderBottomLeftRadius;
        },
        set: function (value) {
            this.style.borderBottomLeftRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "color", {
        get: function () {
            return this.style.color;
        },
        set: function (value) {
            this.style.color = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "background", {
        get: function () {
            return this.style.background;
        },
        set: function (value) {
            this.style.background = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundColor", {
        get: function () {
            return this.style.backgroundColor;
        },
        set: function (value) {
            this.style.backgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundImage", {
        get: function () {
            return this.style.backgroundImage;
        },
        set: function (value) {
            this.style.backgroundImage = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundSize", {
        get: function () {
            return this.style.backgroundSize;
        },
        set: function (value) {
            this.style.backgroundSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundPosition", {
        get: function () {
            return this.style.backgroundPosition;
        },
        set: function (value) {
            this.style.backgroundPosition = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundRepeat", {
        get: function () {
            return this.style.backgroundRepeat;
        },
        set: function (value) {
            this.style.backgroundRepeat = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "minWidth", {
        get: function () {
            return this.style.minWidth;
        },
        set: function (value) {
            this.style.minWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "minHeight", {
        get: function () {
            return this.style.minHeight;
        },
        set: function (value) {
            this.style.minHeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "width", {
        get: function () {
            return this.style.width;
        },
        set: function (value) {
            this.style.width = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "height", {
        get: function () {
            return this.style.height;
        },
        set: function (value) {
            this.style.height = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "margin", {
        get: function () {
            return this.style.margin;
        },
        set: function (value) {
            this.style.margin = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginLeft", {
        get: function () {
            return this.style.marginLeft;
        },
        set: function (value) {
            this.style.marginLeft = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginTop", {
        get: function () {
            return this.style.marginTop;
        },
        set: function (value) {
            this.style.marginTop = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginRight", {
        get: function () {
            return this.style.marginRight;
        },
        set: function (value) {
            this.style.marginRight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginBottom", {
        get: function () {
            return this.style.marginBottom;
        },
        set: function (value) {
            this.style.marginBottom = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "horizontalAlignment", {
        get: function () {
            return this.style.horizontalAlignment;
        },
        set: function (value) {
            this.style.horizontalAlignment = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "verticalAlignment", {
        get: function () {
            return this.style.verticalAlignment;
        },
        set: function (value) {
            this.style.verticalAlignment = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "visibility", {
        get: function () {
            return this.style.visibility;
        },
        set: function (value) {
            this.style.visibility = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "opacity", {
        get: function () {
            return this.style.opacity;
        },
        set: function (value) {
            this.style.opacity = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "rotate", {
        get: function () {
            return this.style.rotate;
        },
        set: function (value) {
            this.style.rotate = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "translateX", {
        get: function () {
            return this.style.translateX;
        },
        set: function (value) {
            this.style.translateX = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "translateY", {
        get: function () {
            return this.style.translateY;
        },
        set: function (value) {
            this.style.translateY = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "scaleX", {
        get: function () {
            return this.style.scaleX;
        },
        set: function (value) {
            this.style.scaleX = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "scaleY", {
        get: function () {
            return this.style.scaleY;
        },
        set: function (value) {
            this.style.scaleY = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "androidElevation", {
        get: function () {
            return this.style.androidElevation;
        },
        set: function (value) {
            this.style.androidElevation = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "androidDynamicElevationOffset", {
        get: function () {
            return this.style.androidDynamicElevationOffset;
        },
        set: function (value) {
            this.style.androidDynamicElevationOffset = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "isLayoutValid", {
        get: function () {
            return this._isLayoutValid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "cssType", {
        get: function () {
            if (!this._cssType) {
                this._cssType = this.typeName.toLowerCase();
            }
            return this._cssType;
        },
        set: function (type) {
            this._cssType = type.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "isLayoutRequired", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    ViewCommon.prototype.measure = function (widthMeasureSpec, heightMeasureSpec) {
        this._setCurrentMeasureSpecs(widthMeasureSpec, heightMeasureSpec);
    };
    ViewCommon.prototype.layout = function (left, top, right, bottom) {
        this._setCurrentLayoutBounds(left, top, right, bottom);
    };
    ViewCommon.prototype.getMeasuredWidth = function () {
        return this._measuredWidth & view_base_1.layout.MEASURED_SIZE_MASK || 0;
    };
    ViewCommon.prototype.getMeasuredHeight = function () {
        return this._measuredHeight & view_base_1.layout.MEASURED_SIZE_MASK || 0;
    };
    ViewCommon.prototype.getMeasuredState = function () {
        return (this._measuredWidth & view_base_1.layout.MEASURED_STATE_MASK)
            | ((this._measuredHeight >> view_base_1.layout.MEASURED_HEIGHT_STATE_SHIFT)
                & (view_base_1.layout.MEASURED_STATE_MASK >> view_base_1.layout.MEASURED_HEIGHT_STATE_SHIFT));
    };
    ViewCommon.prototype.setMeasuredDimension = function (measuredWidth, measuredHeight) {
        this._measuredWidth = measuredWidth;
        this._measuredHeight = measuredHeight;
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(this + " :setMeasuredDimension: " + measuredWidth + ", " + measuredHeight, view_base_1.traceCategories.Layout);
        }
    };
    ViewCommon.prototype.requestLayout = function () {
        this._isLayoutValid = false;
        _super.prototype.requestLayout.call(this);
    };
    ViewCommon.resolveSizeAndState = function (size, specSize, specMode, childMeasuredState) {
        var result = size;
        switch (specMode) {
            case view_base_1.layout.UNSPECIFIED:
                result = Math.ceil(size);
                break;
            case view_base_1.layout.AT_MOST:
                if (specSize < size) {
                    result = Math.ceil(specSize) | view_base_1.layout.MEASURED_STATE_TOO_SMALL;
                }
                break;
            case view_base_1.layout.EXACTLY:
                result = Math.ceil(specSize);
                break;
        }
        return result | (childMeasuredState & view_base_1.layout.MEASURED_STATE_MASK);
    };
    ViewCommon.combineMeasuredStates = function (curState, newState) {
        return curState | newState;
    };
    ViewCommon.layoutChild = function (parent, child, left, top, right, bottom, setFrame) {
        if (setFrame === void 0) { setFrame = true; }
        if (!child || child.isCollapsed) {
            return;
        }
        var childStyle = child.style;
        var childTop;
        var childLeft;
        var childWidth = child.getMeasuredWidth();
        var childHeight = child.getMeasuredHeight();
        var effectiveMarginTop = child.effectiveMarginTop;
        var effectiveMarginBottom = child.effectiveMarginBottom;
        var vAlignment;
        if (child.effectiveHeight >= 0 && childStyle.verticalAlignment === "stretch") {
            vAlignment = "middle";
        }
        else {
            vAlignment = childStyle.verticalAlignment;
        }
        switch (vAlignment) {
            case "top":
                childTop = top + effectiveMarginTop;
                break;
            case "middle":
                childTop = top + (bottom - top - childHeight + (effectiveMarginTop - effectiveMarginBottom)) / 2;
                break;
            case "bottom":
                childTop = bottom - childHeight - effectiveMarginBottom;
                break;
            case "stretch":
            default:
                childTop = top + effectiveMarginTop;
                childHeight = bottom - top - (effectiveMarginTop + effectiveMarginBottom);
                break;
        }
        var effectiveMarginLeft = child.effectiveMarginLeft;
        var effectiveMarginRight = child.effectiveMarginRight;
        var hAlignment;
        if (child.effectiveWidth >= 0 && childStyle.horizontalAlignment === "stretch") {
            hAlignment = "center";
        }
        else {
            hAlignment = childStyle.horizontalAlignment;
        }
        switch (hAlignment) {
            case "left":
                childLeft = left + effectiveMarginLeft;
                break;
            case "center":
                childLeft = left + (right - left - childWidth + (effectiveMarginLeft - effectiveMarginRight)) / 2;
                break;
            case "right":
                childLeft = right - childWidth - effectiveMarginRight;
                break;
            case "stretch":
            default:
                childLeft = left + effectiveMarginLeft;
                childWidth = right - left - (effectiveMarginLeft + effectiveMarginRight);
                break;
        }
        var childRight = Math.round(childLeft + childWidth);
        var childBottom = Math.round(childTop + childHeight);
        childLeft = Math.round(childLeft);
        childTop = Math.round(childTop);
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(child.parent + " :layoutChild: " + child + " " + childLeft + ", " + childTop + ", " + childRight + ", " + childBottom, view_base_1.traceCategories.Layout);
        }
        child.layout(childLeft, childTop, childRight, childBottom, setFrame);
    };
    ViewCommon.measureChild = function (parent, child, widthMeasureSpec, heightMeasureSpec) {
        var measureWidth = 0;
        var measureHeight = 0;
        if (child && !child.isCollapsed) {
            var widthSpec = parent ? parent._currentWidthMeasureSpec : widthMeasureSpec;
            var heightSpec = parent ? parent._currentHeightMeasureSpec : heightMeasureSpec;
            var width = view_base_1.layout.getMeasureSpecSize(widthSpec);
            var widthMode = view_base_1.layout.getMeasureSpecMode(widthSpec);
            var height = view_base_1.layout.getMeasureSpecSize(heightSpec);
            var heightMode = view_base_1.layout.getMeasureSpecMode(heightSpec);
            child._updateEffectiveLayoutValues(width, widthMode, height, heightMode);
            var style = child.style;
            var horizontalMargins = child.effectiveMarginLeft + child.effectiveMarginRight;
            var verticalMargins = child.effectiveMarginTop + child.effectiveMarginBottom;
            var childWidthMeasureSpec = ViewCommon.getMeasureSpec(widthMeasureSpec, horizontalMargins, child.effectiveWidth, style.horizontalAlignment === "stretch");
            var childHeightMeasureSpec = ViewCommon.getMeasureSpec(heightMeasureSpec, verticalMargins, child.effectiveHeight, style.verticalAlignment === "stretch");
            if (view_base_1.traceEnabled()) {
                view_base_1.traceWrite(child.parent + " :measureChild: " + child + " " + view_base_1.layout.measureSpecToString(childWidthMeasureSpec) + ", " + view_base_1.layout.measureSpecToString(childHeightMeasureSpec) + "}", view_base_1.traceCategories.Layout);
            }
            child.measure(childWidthMeasureSpec, childHeightMeasureSpec);
            measureWidth = Math.round(child.getMeasuredWidth() + horizontalMargins);
            measureHeight = Math.round(child.getMeasuredHeight() + verticalMargins);
        }
        return { measuredWidth: measureWidth, measuredHeight: measureHeight };
    };
    ViewCommon.getMeasureSpec = function (parentSpec, margins, childLength, stretched) {
        var parentLength = view_base_1.layout.getMeasureSpecSize(parentSpec);
        var parentSpecMode = view_base_1.layout.getMeasureSpecMode(parentSpec);
        var resultSize;
        var resultMode;
        if (childLength >= 0) {
            resultSize = parentSpecMode === view_base_1.layout.UNSPECIFIED ? childLength : Math.min(parentLength, childLength);
            resultMode = view_base_1.layout.EXACTLY;
        }
        else {
            switch (parentSpecMode) {
                case view_base_1.layout.EXACTLY:
                    resultSize = Math.max(0, parentLength - margins);
                    resultMode = stretched ? view_base_1.layout.EXACTLY : view_base_1.layout.AT_MOST;
                    break;
                case view_base_1.layout.AT_MOST:
                    resultSize = Math.max(0, parentLength - margins);
                    resultMode = view_base_1.layout.AT_MOST;
                    break;
                case view_base_1.layout.UNSPECIFIED:
                    resultSize = 0;
                    resultMode = view_base_1.layout.UNSPECIFIED;
                    break;
            }
        }
        return view_base_1.layout.makeMeasureSpec(resultSize, resultMode);
    };
    ViewCommon.prototype._setCurrentMeasureSpecs = function (widthMeasureSpec, heightMeasureSpec) {
        var changed = this._currentWidthMeasureSpec !== widthMeasureSpec || this._currentHeightMeasureSpec !== heightMeasureSpec;
        this._currentWidthMeasureSpec = widthMeasureSpec;
        this._currentHeightMeasureSpec = heightMeasureSpec;
        return changed;
    };
    ViewCommon.prototype._getCurrentLayoutBounds = function () {
        return { left: 0, top: 0, right: 0, bottom: 0 };
    };
    ViewCommon.prototype._setCurrentLayoutBounds = function (left, top, right, bottom) {
        this._isLayoutValid = true;
        var boundsChanged = this._oldLeft !== left || this._oldTop !== top || this._oldRight !== right || this._oldBottom !== bottom;
        var sizeChanged = (this._oldRight - this._oldLeft !== right - left) || (this._oldBottom - this._oldTop !== bottom - top);
        this._oldLeft = left;
        this._oldTop = top;
        this._oldRight = right;
        this._oldBottom = bottom;
        return { boundsChanged: boundsChanged, sizeChanged: sizeChanged };
    };
    ViewCommon.prototype.eachChild = function (callback) {
        this.eachChildView(callback);
    };
    ViewCommon.prototype.eachChildView = function (callback) {
    };
    ViewCommon.prototype._getNativeViewsCount = function () {
        return this._isAddedToNativeVisualTree ? 1 : 0;
    };
    ViewCommon.prototype._eachLayoutView = function (callback) {
        return callback(this);
    };
    ViewCommon.prototype.focus = function () {
        return undefined;
    };
    ViewCommon.prototype.getSafeAreaInsets = function () {
        return { left: 0, top: 0, right: 0, bottom: 0 };
    };
    ViewCommon.prototype.getLocationInWindow = function () {
        return undefined;
    };
    ViewCommon.prototype.getLocationOnScreen = function () {
        return undefined;
    };
    ViewCommon.prototype.getLocationRelativeTo = function (otherView) {
        return undefined;
    };
    ViewCommon.prototype.getActualSize = function () {
        var currentBounds = this._getCurrentLayoutBounds();
        if (!currentBounds) {
            return undefined;
        }
        return {
            width: view_base_1.layout.toDeviceIndependentPixels(currentBounds.right - currentBounds.left),
            height: view_base_1.layout.toDeviceIndependentPixels(currentBounds.bottom - currentBounds.top),
        };
    };
    ViewCommon.prototype.animate = function (animation) {
        return this.createAnimation(animation).play();
    };
    ViewCommon.prototype.createAnimation = function (animation) {
        ensureAnimationModule();
        if (!this._localAnimations) {
            this._localAnimations = new Set();
        }
        animation.target = this;
        var anim = new animationModule.Animation([animation]);
        this._localAnimations.add(anim);
        return anim;
    };
    ViewCommon.prototype._removeAnimation = function (animation) {
        var localAnimations = this._localAnimations;
        if (localAnimations && localAnimations.has(animation)) {
            localAnimations.delete(animation);
            if (animation.isPlaying) {
                animation.cancel();
            }
            return true;
        }
        return false;
    };
    ViewCommon.prototype.resetNativeView = function () {
        var _this = this;
        if (this._localAnimations) {
            this._localAnimations.forEach(function (a) { return _this._removeAnimation(a); });
        }
        _super.prototype.resetNativeView.call(this);
    };
    ViewCommon.prototype._setNativeViewFrame = function (nativeView, frame) {
    };
    ViewCommon.prototype._getValue = function () {
        throw new Error("The View._getValue is obsolete. There is a new property system.");
    };
    ViewCommon.prototype._setValue = function () {
        throw new Error("The View._setValue is obsolete. There is a new property system.");
    };
    ViewCommon.prototype._updateEffectiveLayoutValues = function (parentWidthMeasureSize, parentWidthMeasureMode, parentHeightMeasureSize, parentHeightMeasureMode) {
        var style = this.style;
        var availableWidth = parentWidthMeasureMode === view_base_1.layout.UNSPECIFIED ? -1 : parentWidthMeasureSize;
        this.effectiveWidth = style_properties_1.PercentLength.toDevicePixels(style.width, -2, availableWidth);
        this.effectiveMarginLeft = style_properties_1.PercentLength.toDevicePixels(style.marginLeft, 0, availableWidth);
        this.effectiveMarginRight = style_properties_1.PercentLength.toDevicePixels(style.marginRight, 0, availableWidth);
        var availableHeight = parentHeightMeasureMode === view_base_1.layout.UNSPECIFIED ? -1 : parentHeightMeasureSize;
        this.effectiveHeight = style_properties_1.PercentLength.toDevicePixels(style.height, -2, availableHeight);
        this.effectiveMarginTop = style_properties_1.PercentLength.toDevicePixels(style.marginTop, 0, availableHeight);
        this.effectiveMarginBottom = style_properties_1.PercentLength.toDevicePixels(style.marginBottom, 0, availableHeight);
    };
    ViewCommon.prototype._setNativeClipToBounds = function () {
    };
    ViewCommon.prototype._redrawNativeBackground = function (value) {
    };
    ViewCommon.prototype._onAttachedToWindow = function () {
    };
    ViewCommon.prototype._onDetachedFromWindow = function () {
    };
    ViewCommon.prototype._hasAncestorView = function (ancestorView) {
        var matcher = function (view) { return view === ancestorView; };
        for (var parent_2 = this.parent; parent_2 != null; parent_2 = parent_2.parent) {
            if (matcher(parent_2)) {
                return true;
            }
        }
        return false;
    };
    ViewCommon.layoutChangedEvent = "layoutChanged";
    ViewCommon.shownModallyEvent = "shownModally";
    ViewCommon.showingModallyEvent = "showingModally";
    return ViewCommon;
}(view_base_1.ViewBase));
exports.ViewCommon = ViewCommon;
exports.automationTextProperty = new view_base_1.Property({ name: "automationText" });
exports.automationTextProperty.register(ViewCommon);
exports.originXProperty = new view_base_1.Property({ name: "originX", defaultValue: 0.5, valueConverter: function (v) { return parseFloat(v); } });
exports.originXProperty.register(ViewCommon);
exports.originYProperty = new view_base_1.Property({ name: "originY", defaultValue: 0.5, valueConverter: function (v) { return parseFloat(v); } });
exports.originYProperty.register(ViewCommon);
exports.isEnabledProperty = new view_base_1.Property({
    name: "isEnabled",
    defaultValue: true,
    valueConverter: view_base_1.booleanConverter,
    valueChanged: function (target, oldValue, newValue) {
        target._goToVisualState(newValue ? "normal" : "disabled");
    }
});
exports.isEnabledProperty.register(ViewCommon);
exports.isUserInteractionEnabledProperty = new view_base_1.Property({ name: "isUserInteractionEnabled", defaultValue: true, valueConverter: view_base_1.booleanConverter });
exports.isUserInteractionEnabledProperty.register(ViewCommon);
exports.iosOverflowSafeAreaProperty = new view_base_1.Property({ name: "iosOverflowSafeArea", defaultValue: false, valueConverter: view_base_1.booleanConverter });
exports.iosOverflowSafeAreaProperty.register(ViewCommon);
exports.iosOverflowSafeAreaEnabledProperty = new view_base_1.InheritedProperty({ name: "iosOverflowSafeAreaEnabled", defaultValue: true, valueConverter: view_base_1.booleanConverter });
exports.iosOverflowSafeAreaEnabledProperty.register(ViewCommon);
//# sourceMappingURL=view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/view/view.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view-common.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var background_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/background.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var frame_stack_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-stack.js");
var application_1 = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view-common.js"));
var DOMID = "_domId";
var androidBackPressedEvent = "androidBackPressed";
var shortAnimTime = 17694720;
var statePressed = 16842919;
var stateEnabled = 16842910;
var sdkVersion = lazy_1.default(function () { return parseInt(platform_1.device.sdkVersion); });
var modalMap = new Map();
var TouchListener;
var DialogFragment;
function initializeTouchListener() {
    if (TouchListener) {
        return;
    }
    var TouchListenerImpl = (function (_super) {
        __extends(TouchListenerImpl, _super);
        function TouchListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = new WeakRef(owner);
            return global.__native(_this);
        }
        TouchListenerImpl.prototype.onTouch = function (view, event) {
            var owner = this.owner.get();
            if (!owner) {
                return;
            }
            owner.handleGestureTouch(event);
            var nativeView = owner.nativeViewProtected;
            if (!nativeView || !nativeView.onTouchEvent) {
                return false;
            }
            return nativeView.onTouchEvent(event);
        };
        TouchListenerImpl = __decorate([
            Interfaces([android.view.View.OnTouchListener])
        ], TouchListenerImpl);
        return TouchListenerImpl;
    }(java.lang.Object));
    TouchListener = TouchListenerImpl;
}
function initializeDialogFragment() {
    if (DialogFragment) {
        return;
    }
    var DialogImpl = (function (_super) {
        __extends(DialogImpl, _super);
        function DialogImpl(fragment, context, themeResId) {
            var _this = _super.call(this, context, themeResId) || this;
            _this.fragment = fragment;
            return global.__native(_this);
        }
        DialogImpl.prototype.onDetachedFromWindow = function () {
            _super.prototype.onDetachedFromWindow.call(this);
            this.fragment = null;
        };
        DialogImpl.prototype.onBackPressed = function () {
            var view = this.fragment.owner;
            var args = {
                eventName: "activityBackPressed",
                object: view,
                activity: view._context,
                cancel: false,
            };
            application_1.android.notify(args);
            if (args.cancel) {
                return;
            }
            view.notify(args);
            if (!args.cancel && !view.onBackPressed()) {
                _super.prototype.onBackPressed.call(this);
            }
        };
        return DialogImpl;
    }(android.app.Dialog));
    var DialogFragmentImpl = (function (_super) {
        __extends(DialogFragmentImpl, _super);
        function DialogFragmentImpl() {
            var _this = _super.call(this) || this;
            return global.__native(_this);
        }
        DialogFragmentImpl.prototype.onCreateDialog = function (savedInstanceState) {
            var ownerId = this.getArguments().getInt(DOMID);
            var options = getModalOptions(ownerId);
            this.owner = options.owner;
            this._fullscreen = options.fullscreen;
            this._animated = options.animated;
            this._cancelable = options.cancelable;
            this._stretched = options.stretched;
            this._dismissCallback = options.dismissCallback;
            this._shownCallback = options.shownCallback;
            this.setStyle(androidx.fragment.app.DialogFragment.STYLE_NO_TITLE, 0);
            var theme = this.getTheme();
            if (this._fullscreen) {
                theme = this.getActivity().getApplicationInfo().theme;
            }
            var dialog = new DialogImpl(this, this.getActivity(), theme);
            if (!this._fullscreen && !this._stretched) {
                this.owner.horizontalAlignment = "center";
                this.owner.verticalAlignment = "middle";
            }
            else {
                this.owner.horizontalAlignment = "stretch";
                this.owner.verticalAlignment = "stretch";
            }
            if (this._animated) {
                dialog
                    .getWindow()
                    .setWindowAnimations(android.R.style.Animation_Dialog);
            }
            dialog.setCanceledOnTouchOutside(this._cancelable);
            return dialog;
        };
        DialogFragmentImpl.prototype.onCreateView = function (inflater, container, savedInstanceState) {
            var owner = this.owner;
            owner._setupAsRootView(this.getActivity());
            owner._isAddedToNativeVisualTree = true;
            return owner.nativeViewProtected;
        };
        DialogFragmentImpl.prototype.onStart = function () {
            _super.prototype.onStart.call(this);
            if (this._fullscreen) {
                var window_1 = this.getDialog().getWindow();
                var length_1 = android.view.ViewGroup.LayoutParams.MATCH_PARENT;
                window_1.setLayout(length_1, length_1);
                window_1.setBackgroundDrawable(new android.graphics.drawable.ColorDrawable(android.graphics.Color.WHITE));
            }
            var owner = this.owner;
            if (owner && !owner.isLoaded) {
                owner.callLoaded();
            }
            this._shownCallback();
        };
        DialogFragmentImpl.prototype.onDismiss = function (dialog) {
            _super.prototype.onDismiss.call(this, dialog);
            var manager = this.getFragmentManager();
            if (manager) {
                removeModal(this.owner._domId);
                this._dismissCallback();
            }
            var owner = this.owner;
            if (owner && owner.isLoaded) {
                owner.callUnloaded();
            }
        };
        DialogFragmentImpl.prototype.onDestroy = function () {
            _super.prototype.onDestroy.call(this);
            var owner = this.owner;
            if (owner) {
                if (owner.isLoaded) {
                    owner.callUnloaded();
                }
                owner._isAddedToNativeVisualTree = false;
                owner._tearDownUI(true);
            }
        };
        return DialogFragmentImpl;
    }(androidx.fragment.app.DialogFragment));
    DialogFragment = DialogFragmentImpl;
}
function saveModal(options) {
    modalMap.set(options.owner._domId, options);
}
function removeModal(domId) {
    modalMap.delete(domId);
}
function getModalOptions(domId) {
    return modalMap.get(domId);
}
var View = (function (_super) {
    __extends(View, _super);
    function View() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    View.prototype._observe = function (type, callback, thisArg) {
        _super.prototype._observe.call(this, type, callback, thisArg);
        if (this.isLoaded && !this.touchListenerIsSet) {
            this.setOnTouchListener();
        }
    };
    View.prototype.on = function (eventNames, callback, thisArg) {
        _super.prototype.on.call(this, eventNames, callback, thisArg);
        var isLayoutEvent = typeof eventNames === "string" ? eventNames.indexOf(view_common_1.ViewCommon.layoutChangedEvent) !== -1 : false;
        if (this.isLoaded && !this.layoutChangeListenerIsSet && isLayoutEvent) {
            this.setOnLayoutChangeListener();
        }
    };
    View.prototype.off = function (eventNames, callback, thisArg) {
        _super.prototype.off.call(this, eventNames, callback, thisArg);
        var isLayoutEvent = typeof eventNames === "string" ? eventNames.indexOf(view_common_1.ViewCommon.layoutChangedEvent) !== -1 : false;
        if (this.isLoaded && this.layoutChangeListenerIsSet && isLayoutEvent && !this.hasListeners(view_common_1.ViewCommon.layoutChangedEvent)) {
            this.nativeViewProtected.removeOnLayoutChangeListener(this.layoutChangeListener);
            this.layoutChangeListenerIsSet = false;
        }
    };
    View.prototype._getChildFragmentManager = function () {
        return null;
    };
    View.prototype._getRootFragmentManager = function () {
        if (!this._rootManager && this._context) {
            this._rootManager = this._context.getSupportFragmentManager();
        }
        return this._rootManager;
    };
    View.prototype._getFragmentManager = function () {
        var manager = this._manager;
        if (!manager) {
            var view = this;
            var frameOrTabViewItemFound = false;
            while (view) {
                var dialogFragment = view._dialogFragment;
                if (dialogFragment) {
                    manager = dialogFragment.getChildFragmentManager();
                    break;
                }
                if (view._hasFragments) {
                    if (frameOrTabViewItemFound) {
                        manager = view._getChildFragmentManager();
                        break;
                    }
                    frameOrTabViewItemFound = true;
                }
                view = view.parent;
            }
            if (!manager) {
                manager = this._getRootFragmentManager();
            }
            this._manager = manager;
        }
        return manager;
    };
    View.prototype.onLoaded = function () {
        this._manager = null;
        this._rootManager = null;
        _super.prototype.onLoaded.call(this);
        this.setOnTouchListener();
    };
    View.prototype.onUnloaded = function () {
        if (this.touchListenerIsSet) {
            this.nativeViewProtected.setOnTouchListener(null);
            this.touchListenerIsSet = false;
            this.nativeViewProtected.setClickable(this._isClickable);
        }
        this._manager = null;
        this._rootManager = null;
        _super.prototype.onUnloaded.call(this);
    };
    View.prototype.onBackPressed = function () {
        var topmostFrame = frame_stack_1.topmost();
        if (topmostFrame && topmostFrame._hasAncestorView(this)) {
            return topmostFrame.onBackPressed();
        }
        return false;
    };
    View.prototype.handleGestureTouch = function (event) {
        for (var type in this._gestureObservers) {
            var list = this._gestureObservers[type];
            list.forEach(function (element) {
                element.androidOnTouchEvent(event);
            });
        }
        if (this.parent instanceof View) {
            this.parent.handleGestureTouch(event);
        }
    };
    View.prototype.hasGestureObservers = function () {
        return this._gestureObservers && Object.keys(this._gestureObservers).length > 0;
    };
    View.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._isClickable = this.nativeViewProtected.isClickable();
        if (this.hasListeners(view_common_1.ViewCommon.layoutChangedEvent)) {
            this.setOnLayoutChangeListener();
        }
    };
    View.prototype.disposeNativeView = function () {
        _super.prototype.disposeNativeView.call(this);
        if (this.layoutChangeListenerIsSet) {
            this.layoutChangeListenerIsSet = false;
            this.nativeViewProtected.removeOnLayoutChangeListener(this.layoutChangeListener);
        }
    };
    View.prototype.setOnTouchListener = function () {
        if (!this.nativeViewProtected || !this.hasGestureObservers()) {
            return;
        }
        initializeTouchListener();
        this.touchListener = this.touchListener || new TouchListener(this);
        this.nativeViewProtected.setOnTouchListener(this.touchListener);
        this.touchListenerIsSet = true;
        if (this.nativeViewProtected.setClickable) {
            this.nativeViewProtected.setClickable(this.isUserInteractionEnabled);
        }
    };
    View.prototype.setOnLayoutChangeListener = function () {
        if (this.nativeViewProtected) {
            var owner_1 = this;
            this.layoutChangeListenerIsSet = true;
            this.layoutChangeListener = this.layoutChangeListener || new android.view.View.OnLayoutChangeListener({
                onLayoutChange: function (v, left, top, right, bottom, oldLeft, oldTop, oldRight, oldBottom) {
                    if (left !== oldLeft || top !== oldTop || right !== oldRight || bottom !== oldBottom) {
                        owner_1._raiseLayoutChangedEvent();
                    }
                }
            });
            this.nativeViewProtected.addOnLayoutChangeListener(this.layoutChangeListener);
        }
    };
    Object.defineProperty(View.prototype, "isLayoutRequired", {
        get: function () {
            return !this.isLayoutValid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(View.prototype, "isLayoutValid", {
        get: function () {
            if (this.nativeViewProtected) {
                return !this.nativeViewProtected.isLayoutRequested();
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(View.prototype, "_hasFragments", {
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    View.prototype.layoutNativeView = function (left, top, right, bottom) {
        if (this.nativeViewProtected) {
            this.nativeViewProtected.layout(left, top, right, bottom);
        }
    };
    View.prototype.requestLayout = function () {
        _super.prototype.requestLayout.call(this);
        if (this.nativeViewProtected) {
            this.nativeViewProtected.requestLayout();
        }
    };
    View.prototype.measure = function (widthMeasureSpec, heightMeasureSpec) {
        _super.prototype.measure.call(this, widthMeasureSpec, heightMeasureSpec);
        this.onMeasure(widthMeasureSpec, heightMeasureSpec);
    };
    View.prototype.layout = function (left, top, right, bottom) {
        _super.prototype.layout.call(this, left, top, right, bottom);
        this.onLayout(left, top, right, bottom);
    };
    View.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var view = this.nativeViewProtected;
        if (view) {
            view.measure(widthMeasureSpec, heightMeasureSpec);
            this.setMeasuredDimension(view.getMeasuredWidth(), view.getMeasuredHeight());
        }
    };
    View.prototype.onLayout = function (left, top, right, bottom) {
        var view = this.nativeViewProtected;
        if (view) {
            this.layoutNativeView(left, top, right, bottom);
        }
    };
    View.prototype._getCurrentLayoutBounds = function () {
        if (this.nativeViewProtected && !this.isCollapsed) {
            return {
                left: this.nativeViewProtected.getLeft(),
                top: this.nativeViewProtected.getTop(),
                right: this.nativeViewProtected.getRight(),
                bottom: this.nativeViewProtected.getBottom()
            };
        }
        else {
            return { left: 0, top: 0, right: 0, bottom: 0 };
        }
    };
    View.prototype.getMeasuredWidth = function () {
        if (this.nativeViewProtected) {
            return this.nativeViewProtected.getMeasuredWidth();
        }
        return _super.prototype.getMeasuredWidth.call(this);
    };
    View.prototype.getMeasuredHeight = function () {
        if (this.nativeViewProtected) {
            return this.nativeViewProtected.getMeasuredHeight();
        }
        return _super.prototype.getMeasuredHeight.call(this);
    };
    View.prototype.focus = function () {
        if (this.nativeViewProtected) {
            return this.nativeViewProtected.requestFocus();
        }
        return false;
    };
    View.prototype.getLocationInWindow = function () {
        if (!this.nativeViewProtected || !this.nativeViewProtected.getWindowToken()) {
            return undefined;
        }
        var nativeArray = Array.create("int", 2);
        this.nativeViewProtected.getLocationInWindow(nativeArray);
        return {
            x: view_common_1.layout.toDeviceIndependentPixels(nativeArray[0]),
            y: view_common_1.layout.toDeviceIndependentPixels(nativeArray[1]),
        };
    };
    View.prototype.getLocationOnScreen = function () {
        if (!this.nativeViewProtected || !this.nativeViewProtected.getWindowToken()) {
            return undefined;
        }
        var nativeArray = Array.create("int", 2);
        this.nativeViewProtected.getLocationOnScreen(nativeArray);
        return {
            x: view_common_1.layout.toDeviceIndependentPixels(nativeArray[0]),
            y: view_common_1.layout.toDeviceIndependentPixels(nativeArray[1]),
        };
    };
    View.prototype.getLocationRelativeTo = function (otherView) {
        if (!this.nativeViewProtected || !this.nativeViewProtected.getWindowToken() ||
            !otherView || !otherView.nativeViewProtected || !otherView.nativeViewProtected.getWindowToken() ||
            this.nativeViewProtected.getWindowToken() !== otherView.nativeViewProtected.getWindowToken()) {
            return undefined;
        }
        var myArray = Array.create("int", 2);
        this.nativeViewProtected.getLocationOnScreen(myArray);
        var otherArray = Array.create("int", 2);
        otherView.nativeViewProtected.getLocationOnScreen(otherArray);
        return {
            x: view_common_1.layout.toDeviceIndependentPixels(myArray[0] - otherArray[0]),
            y: view_common_1.layout.toDeviceIndependentPixels(myArray[1] - otherArray[1]),
        };
    };
    View.resolveSizeAndState = function (size, specSize, specMode, childMeasuredState) {
        var result = size;
        switch (specMode) {
            case view_common_1.layout.UNSPECIFIED:
                result = size;
                break;
            case view_common_1.layout.AT_MOST:
                if (specSize < size) {
                    result = specSize | view_common_1.layout.MEASURED_STATE_TOO_SMALL;
                }
                break;
            case view_common_1.layout.EXACTLY:
                result = specSize;
                break;
        }
        return result | (childMeasuredState & view_common_1.layout.MEASURED_STATE_MASK);
    };
    View.prototype._showNativeModalView = function (parent, options) {
        var _this = this;
        _super.prototype._showNativeModalView.call(this, parent, options);
        initializeDialogFragment();
        var df = new DialogFragment();
        var args = new android.os.Bundle();
        args.putInt(DOMID, this._domId);
        df.setArguments(args);
        var dialogOptions = {
            owner: this,
            fullscreen: !!options.fullscreen,
            animated: !!options.animated,
            stretched: !!options.stretched,
            cancelable: options.android ? !!options.android.cancelable : true,
            shownCallback: function () { return _this._raiseShownModallyEvent(); },
            dismissCallback: function () { return _this.closeModal(); }
        };
        saveModal(dialogOptions);
        this._dialogFragment = df;
        this._raiseShowingModallyEvent();
        this._dialogFragment.show(parent._getRootFragmentManager(), this._domId.toString());
    };
    View.prototype._hideNativeModalView = function (parent, whenClosedCallback) {
        var manager = this._dialogFragment.getFragmentManager();
        if (manager) {
            this._dialogFragment.dismissAllowingStateLoss();
        }
        this._dialogFragment = null;
        whenClosedCallback();
    };
    View.prototype[view_common_1.isEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.setEnabled(value);
    };
    View.prototype[view_common_1.originXProperty.getDefault] = function () {
        return this.nativeViewProtected.getPivotX();
    };
    View.prototype[view_common_1.originXProperty.setNative] = function (value) {
        org.nativescript.widgets.OriginPoint.setX(this.nativeViewProtected, value);
    };
    View.prototype[view_common_1.originYProperty.getDefault] = function () {
        return this.nativeViewProtected.getPivotY();
    };
    View.prototype[view_common_1.originYProperty.setNative] = function (value) {
        org.nativescript.widgets.OriginPoint.setY(this.nativeViewProtected, value);
    };
    View.prototype[view_common_1.automationTextProperty.getDefault] = function () {
        return this.nativeViewProtected.getContentDescription();
    };
    View.prototype[view_common_1.automationTextProperty.setNative] = function (value) {
        this.nativeViewProtected.setContentDescription(value);
    };
    View.prototype[view_common_1.isUserInteractionEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.setClickable(value);
        this.nativeViewProtected.setFocusable(value);
    };
    View.prototype[style_properties_1.visibilityProperty.getDefault] = function () {
        var nativeVisibility = this.nativeViewProtected.getVisibility();
        switch (nativeVisibility) {
            case android.view.View.VISIBLE:
                return "visible";
            case android.view.View.INVISIBLE:
                return "hidden";
            case android.view.View.GONE:
                return "collapse";
            default:
                throw new Error("Unsupported android.view.View visibility: " + nativeVisibility + ". Currently supported values are android.view.View.VISIBLE, android.view.View.INVISIBLE, android.view.View.GONE.");
        }
    };
    View.prototype[style_properties_1.visibilityProperty.setNative] = function (value) {
        switch (value) {
            case "visible":
                this.nativeViewProtected.setVisibility(android.view.View.VISIBLE);
                break;
            case "hidden":
                this.nativeViewProtected.setVisibility(android.view.View.INVISIBLE);
                break;
            case "collapse":
                this.nativeViewProtected.setVisibility(android.view.View.GONE);
                break;
            default:
                throw new Error("Invalid visibility value: " + value + ". Valid values are: visible, hidden, collapse.");
        }
    };
    View.prototype[style_properties_1.opacityProperty.getDefault] = function () {
        return this.nativeViewProtected.getAlpha();
    };
    View.prototype[style_properties_1.opacityProperty.setNative] = function (value) {
        this.nativeViewProtected.setAlpha(float(value));
    };
    View.prototype[style_properties_1.androidElevationProperty.getDefault] = function () {
        return this.getDefaultElevation();
    };
    View.prototype[style_properties_1.androidElevationProperty.setNative] = function (value) {
        if (sdkVersion() < 21) {
            return;
        }
        this.refreshStateListAnimator();
    };
    View.prototype[style_properties_1.androidDynamicElevationOffsetProperty.getDefault] = function () {
        return this.getDefaultDynamicElevationOffset();
    };
    View.prototype[style_properties_1.androidDynamicElevationOffsetProperty.setNative] = function (value) {
        if (sdkVersion() < 21) {
            return;
        }
        this.refreshStateListAnimator();
    };
    View.prototype.getDefaultElevation = function () {
        if (sdkVersion() < 21) {
            return 0;
        }
        return view_common_1.layout.toDeviceIndependentPixels(this.nativeViewProtected.getElevation());
    };
    View.prototype.getDefaultDynamicElevationOffset = function () {
        return 0;
    };
    View.prototype.refreshStateListAnimator = function () {
        var nativeView = this.nativeViewProtected;
        var ObjectAnimator = android.animation.ObjectAnimator;
        var AnimatorSet = android.animation.AnimatorSet;
        var duration = nativeView.getContext().getResources().getInteger(shortAnimTime) / 2;
        var elevation = this.androidElevation;
        if (typeof elevation === "undefined" || elevation === null) {
            elevation = this.getDefaultElevation();
        }
        elevation = view_common_1.layout.toDevicePixels(elevation);
        var z = view_common_1.layout.toDevicePixels(0);
        var pressedZ = this.androidDynamicElevationOffset;
        if (typeof pressedZ === "undefined" || pressedZ === null) {
            pressedZ = this.getDefaultDynamicElevationOffset();
        }
        pressedZ = view_common_1.layout.toDevicePixels(pressedZ);
        var pressedSet = new AnimatorSet();
        pressedSet.playTogether(java.util.Arrays.asList([
            ObjectAnimator.ofFloat(nativeView, "translationZ", [pressedZ])
                .setDuration(duration),
            ObjectAnimator.ofFloat(nativeView, "elevation", [elevation])
                .setDuration(0),
        ]));
        var notPressedSet = new AnimatorSet();
        notPressedSet.playTogether(java.util.Arrays.asList([
            ObjectAnimator.ofFloat(nativeView, "translationZ", [z])
                .setDuration(duration),
            ObjectAnimator.ofFloat(nativeView, "elevation", [elevation])
                .setDuration(0),
        ]));
        var defaultSet = new AnimatorSet();
        defaultSet.playTogether(java.util.Arrays.asList([
            ObjectAnimator.ofFloat(nativeView, "translationZ", [0]).setDuration(0),
            ObjectAnimator.ofFloat(nativeView, "elevation", [0]).setDuration(0),
        ]));
        var stateListAnimator = new android.animation.StateListAnimator();
        stateListAnimator.addState([statePressed, stateEnabled], pressedSet);
        stateListAnimator.addState([stateEnabled], notPressedSet);
        stateListAnimator.addState([], defaultSet);
        nativeView.setStateListAnimator(stateListAnimator);
    };
    View.prototype[style_properties_1.horizontalAlignmentProperty.getDefault] = function () {
        return org.nativescript.widgets.ViewHelper.getHorizontalAlignment(this.nativeViewProtected);
    };
    View.prototype[style_properties_1.horizontalAlignmentProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        var lp = nativeView.getLayoutParams() || new org.nativescript.widgets.CommonLayoutParams();
        if (lp.gravity !== undefined) {
            switch (value) {
                case "left":
                    lp.gravity = android.view.Gravity.LEFT | (lp.gravity & android.view.Gravity.VERTICAL_GRAVITY_MASK);
                    if (lp.weight < 0) {
                        lp.weight = -2;
                    }
                    break;
                case "center":
                    lp.gravity = android.view.Gravity.CENTER_HORIZONTAL | (lp.gravity & android.view.Gravity.VERTICAL_GRAVITY_MASK);
                    if (lp.weight < 0) {
                        lp.weight = -2;
                    }
                    break;
                case "right":
                    lp.gravity = android.view.Gravity.RIGHT | (lp.gravity & android.view.Gravity.VERTICAL_GRAVITY_MASK);
                    if (lp.weight < 0) {
                        lp.weight = -2;
                    }
                    break;
                case "stretch":
                    lp.gravity = android.view.Gravity.FILL_HORIZONTAL | (lp.gravity & android.view.Gravity.VERTICAL_GRAVITY_MASK);
                    if (lp.weight < 0) {
                        lp.weight = -1;
                    }
                    break;
            }
            nativeView.setLayoutParams(lp);
        }
    };
    View.prototype[style_properties_1.verticalAlignmentProperty.getDefault] = function () {
        return org.nativescript.widgets.ViewHelper.getVerticalAlignment(this.nativeViewProtected);
    };
    View.prototype[style_properties_1.verticalAlignmentProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        var lp = nativeView.getLayoutParams() || new org.nativescript.widgets.CommonLayoutParams();
        if (lp.gravity !== undefined) {
            switch (value) {
                case "top":
                    lp.gravity = android.view.Gravity.TOP | (lp.gravity & android.view.Gravity.HORIZONTAL_GRAVITY_MASK);
                    if (lp.height < 0) {
                        lp.height = -2;
                    }
                    break;
                case "middle":
                    lp.gravity = android.view.Gravity.CENTER_VERTICAL | (lp.gravity & android.view.Gravity.HORIZONTAL_GRAVITY_MASK);
                    if (lp.height < 0) {
                        lp.height = -2;
                    }
                    break;
                case "bottom":
                    lp.gravity = android.view.Gravity.BOTTOM | (lp.gravity & android.view.Gravity.HORIZONTAL_GRAVITY_MASK);
                    if (lp.height < 0) {
                        lp.height = -2;
                    }
                    break;
                case "stretch":
                    lp.gravity = android.view.Gravity.FILL_VERTICAL | (lp.gravity & android.view.Gravity.HORIZONTAL_GRAVITY_MASK);
                    if (lp.height < 0) {
                        lp.height = -1;
                    }
                    break;
            }
            nativeView.setLayoutParams(lp);
        }
    };
    View.prototype[style_properties_1.rotateProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setRotate(this.nativeViewProtected, float(value));
    };
    View.prototype[style_properties_1.scaleXProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setScaleX(this.nativeViewProtected, float(value));
    };
    View.prototype[style_properties_1.scaleYProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setScaleY(this.nativeViewProtected, float(value));
    };
    View.prototype[style_properties_1.translateXProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setTranslateX(this.nativeViewProtected, view_common_1.layout.toDevicePixels(value));
    };
    View.prototype[style_properties_1.translateYProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setTranslateY(this.nativeViewProtected, view_common_1.layout.toDevicePixels(value));
    };
    View.prototype[style_properties_1.zIndexProperty.getDefault] = function () {
        return 0;
    };
    View.prototype[style_properties_1.zIndexProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setZIndex(this.nativeViewProtected, value);
    };
    View.prototype[style_properties_1.backgroundInternalProperty.getDefault] = function () {
        var nativeView = this.nativeViewProtected;
        var drawable = nativeView.getBackground();
        if (drawable) {
            var constantState = drawable.getConstantState();
            if (constantState) {
                try {
                    return constantState.newDrawable(nativeView.getResources());
                }
                catch (e) {
                    return drawable;
                }
            }
            else {
                return drawable;
            }
        }
        return null;
    };
    View.prototype[style_properties_1.backgroundInternalProperty.setNative] = function (value) {
        this._redrawNativeBackground(value);
    };
    View.prototype[style_properties_1.minWidthProperty.setNative] = function (value) {
        if (this.parent instanceof CustomLayoutView && this.parent.nativeViewProtected) {
            this.parent._setChildMinWidthNative(this);
        }
        else {
            this._setMinWidthNative(this.minWidth);
        }
    };
    View.prototype[style_properties_1.minHeightProperty.setNative] = function (value) {
        if (this.parent instanceof CustomLayoutView && this.parent.nativeViewProtected) {
            this.parent._setChildMinHeightNative(this);
        }
        else {
            this._setMinHeightNative(this.minHeight);
        }
    };
    View.prototype._redrawNativeBackground = function (value) {
        if (value instanceof background_1.Background) {
            background_1.ad.onBackgroundOrBorderPropertyChanged(this);
        }
        else {
            var nativeView = this.nativeViewProtected;
            nativeView.setBackground(value);
            var style = this.style;
            var paddingTop = view_common_1.paddingTopProperty.isSet(style) ? this.effectivePaddingTop : this._defaultPaddingTop;
            var paddingRight = view_common_1.paddingRightProperty.isSet(style) ? this.effectivePaddingRight : this._defaultPaddingRight;
            var paddingBottom = view_common_1.paddingBottomProperty.isSet(style) ? this.effectivePaddingBottom : this._defaultPaddingBottom;
            var paddingLeft = view_common_1.paddingLeftProperty.isSet(style) ? this.effectivePaddingLeft : this._defaultPaddingLeft;
            if (this._isPaddingRelative) {
                nativeView.setPaddingRelative(paddingLeft, paddingTop, paddingRight, paddingBottom);
            }
            else {
                nativeView.setPadding(paddingLeft, paddingTop, paddingRight, paddingBottom);
            }
            nativeView.background = undefined;
        }
    };
    View.androidBackPressedEvent = androidBackPressedEvent;
    __decorate([
        profiling_1.profile
    ], View.prototype, "onLoaded", null);
    __decorate([
        profiling_1.profile
    ], View.prototype, "onUnloaded", null);
    __decorate([
        profiling_1.profile
    ], View.prototype, "requestLayout", null);
    return View;
}(view_common_1.ViewCommon));
exports.View = View;
var ContainerView = (function (_super) {
    __extends(ContainerView, _super);
    function ContainerView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return ContainerView;
}(View));
exports.ContainerView = ContainerView;
var CustomLayoutView = (function (_super) {
    __extends(CustomLayoutView, _super);
    function CustomLayoutView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    CustomLayoutView.prototype.createNativeView = function () {
        return new org.nativescript.widgets.ContentLayout(this._context);
    };
    CustomLayoutView.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        if (atIndex === void 0) { atIndex = Number.MAX_SAFE_INTEGER; }
        _super.prototype._addViewToNativeVisualTree.call(this, child);
        if (this.nativeViewProtected && child.nativeViewProtected) {
            if (view_common_1.traceEnabled()) {
                view_common_1.traceWrite(this + ".nativeView.addView(" + child + ".nativeView, " + atIndex + ")", view_common_1.traceCategories.VisualTreeEvents);
            }
            this.nativeViewProtected.addView(child.nativeViewProtected, atIndex);
            if (child instanceof View) {
                this._updateNativeLayoutParams(child);
            }
            return true;
        }
        return false;
    };
    CustomLayoutView.prototype._updateNativeLayoutParams = function (child) {
        this._setChildMinWidthNative(child);
        this._setChildMinHeightNative(child);
    };
    CustomLayoutView.prototype._setChildMinWidthNative = function (child) {
        child._setMinWidthNative(child.minWidth);
    };
    CustomLayoutView.prototype._setChildMinHeightNative = function (child) {
        child._setMinHeightNative(child.minHeight);
    };
    CustomLayoutView.prototype._removeViewFromNativeVisualTree = function (child) {
        _super.prototype._removeViewFromNativeVisualTree.call(this, child);
        var nativeView = this.nativeViewProtected;
        var childView = child.nativeViewProtected;
        if (nativeView && childView) {
            nativeView.removeView(childView);
            if (view_common_1.traceEnabled()) {
                view_common_1.traceWrite(nativeView + ".removeView(" + childView + ")", view_common_1.traceCategories.VisualTreeEvents);
                view_common_1.traceNotifyEvent(child, "childInLayoutRemovedFromNativeVisualTree");
            }
        }
    };
    return CustomLayoutView;
}(ContainerView));
exports.CustomLayoutView = CustomLayoutView;
var percentNotSupported = function (view, value) { throw new Error("PercentLength is not supported."); };
function createNativePercentLengthProperty(options) {
    var getter = options.getter, setter = options.setter, _a = options.auto, auto = _a === void 0 ? 0 : _a;
    var setPixels, getPixels, setPercent;
    if (getter) {
        View.prototype[getter] = function () {
            if (options) {
                setPixels = options.setPixels;
                getPixels = options.getPixels;
                setPercent = options.setPercent || percentNotSupported;
                options = null;
            }
            var value = getPixels(this.nativeViewProtected);
            if (value == auto) {
                return "auto";
            }
            else {
                return { value: value, unit: "px" };
            }
        };
    }
    if (setter) {
        View.prototype[setter] = function (length) {
            if (options) {
                setPixels = options.setPixels;
                getPixels = options.getPixels;
                setPercent = options.setPercent || percentNotSupported;
                options = null;
            }
            if (length == "auto") {
                setPixels(this.nativeViewProtected, auto);
            }
            else if (typeof length === "number") {
                setPixels(this.nativeViewProtected, view_common_1.layout.round(view_common_1.layout.toDevicePixels(length)));
            }
            else if (length.unit == "dip") {
                setPixels(this.nativeViewProtected, view_common_1.layout.round(view_common_1.layout.toDevicePixels(length.value)));
            }
            else if (length.unit == "px") {
                setPixels(this.nativeViewProtected, view_common_1.layout.round(length.value));
            }
            else if (length.unit == "%") {
                setPercent(this.nativeViewProtected, length.value);
            }
            else {
                throw new Error("Unsupported PercentLength " + length);
            }
        };
    }
}
createNativePercentLengthProperty({
    setter: style_properties_1.marginTopProperty.setNative,
    get setPixels() { return org.nativescript.widgets.ViewHelper.setMarginTop; },
    get setPercent() { return org.nativescript.widgets.ViewHelper.setMarginTopPercent; }
});
createNativePercentLengthProperty({
    setter: style_properties_1.marginRightProperty.setNative,
    get setPixels() { return org.nativescript.widgets.ViewHelper.setMarginRight; },
    get setPercent() { return org.nativescript.widgets.ViewHelper.setMarginRightPercent; }
});
createNativePercentLengthProperty({
    setter: style_properties_1.marginBottomProperty.setNative,
    get setPixels() { return org.nativescript.widgets.ViewHelper.setMarginBottom; },
    get setPercent() { return org.nativescript.widgets.ViewHelper.setMarginBottomPercent; }
});
createNativePercentLengthProperty({
    setter: style_properties_1.marginLeftProperty.setNative,
    get setPixels() { return org.nativescript.widgets.ViewHelper.setMarginLeft; },
    get setPercent() { return org.nativescript.widgets.ViewHelper.setMarginLeftPercent; }
});
createNativePercentLengthProperty({
    setter: style_properties_1.widthProperty.setNative,
    auto: -1,
    get setPixels() { return org.nativescript.widgets.ViewHelper.setWidth; },
    get setPercent() { return org.nativescript.widgets.ViewHelper.setWidthPercent; }
});
createNativePercentLengthProperty({
    setter: style_properties_1.heightProperty.setNative,
    auto: -1,
    get setPixels() { return org.nativescript.widgets.ViewHelper.setHeight; },
    get setPercent() { return org.nativescript.widgets.ViewHelper.setHeightPercent; }
});
createNativePercentLengthProperty({
    setter: "_setMinWidthNative",
    get setPixels() { return org.nativescript.widgets.ViewHelper.setMinWidth; }
});
createNativePercentLengthProperty({
    setter: "_setMinHeightNative",
    get setPixels() { return org.nativescript.widgets.ViewHelper.setMinHeight; }
});
//# sourceMappingURL=view.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var handlersForEventName = new Map();
var sourcesMap = new WeakMap();
var TargetHandlerPair = (function () {
    function TargetHandlerPair(target, handler) {
        this.tagetRef = new WeakRef(target);
        this.handler = handler;
    }
    return TargetHandlerPair;
}());
function getHandlerForEventName(eventName) {
    var handler = handlersForEventName.get(eventName);
    if (!handler) {
        handler = function (eventData) {
            var source = eventData.object;
            var sourceEventMap = sourcesMap.get(source);
            if (!sourceEventMap) {
                source.removeEventListener(eventName, handlersForEventName.get(eventName));
                return;
            }
            var targetHandlerPairList = sourceEventMap.get(eventName);
            if (!targetHandlerPairList) {
                return;
            }
            var deadPairsIndexes = [];
            var pair;
            var target;
            for (var i = 0; i < targetHandlerPairList.length; i++) {
                pair = targetHandlerPairList[i];
                target = pair.tagetRef.get();
                if (target) {
                    pair.handler.call(target, eventData);
                }
                else {
                    deadPairsIndexes.push(i);
                }
            }
            if (deadPairsIndexes.length === targetHandlerPairList.length) {
                source.removeEventListener(eventName, handlersForEventName.get(eventName));
                sourceEventMap.delete(eventName);
            }
            else {
                for (var j = deadPairsIndexes.length - 1; j >= 0; j--) {
                    targetHandlerPairList.splice(deadPairsIndexes[j], 1);
                }
            }
        };
        handlersForEventName.set(eventName, handler);
    }
    return handler;
}
function validateArgs(source, eventName, handler, target) {
    if (!source) {
        throw new Error("source is null or undefined");
    }
    if (!target) {
        throw new Error("target is null or undefined");
    }
    if (typeof eventName !== "string") {
        throw new Error("eventName is not a string");
    }
    if (typeof handler !== "function") {
        throw new Error("handler is not a function");
    }
}
function addWeakEventListener(source, eventName, handler, target) {
    validateArgs(source, eventName, handler, target);
    var shouldAttach = false;
    var sourceEventMap = sourcesMap.get(source);
    if (!sourceEventMap) {
        sourceEventMap = new Map();
        sourcesMap.set(source, sourceEventMap);
        shouldAttach = true;
    }
    var pairList = sourceEventMap.get(eventName);
    if (!pairList) {
        pairList = new Array();
        sourceEventMap.set(eventName, pairList);
        shouldAttach = true;
    }
    pairList.push(new TargetHandlerPair(target, handler));
    if (shouldAttach) {
        source.addEventListener(eventName, getHandlerForEventName(eventName));
    }
}
exports.addWeakEventListener = addWeakEventListener;
function removeWeakEventListener(source, eventName, handler, target) {
    validateArgs(source, eventName, handler, target);
    var handlerForEventWithName = handlersForEventName.get(eventName);
    if (!handlerForEventWithName) {
        return;
    }
    var sourceEventMap = sourcesMap.get(source);
    if (!sourceEventMap) {
        return;
    }
    var targetHandlerPairList = sourceEventMap.get(eventName);
    if (!targetHandlerPairList) {
        return;
    }
    var targetHandlerPairsToRemove = [];
    var pair;
    var registeredTarget;
    for (var i = 0; i < targetHandlerPairList.length; i++) {
        pair = targetHandlerPairList[i];
        registeredTarget = pair.tagetRef.get();
        if (!registeredTarget || (registeredTarget === target && handler === pair.handler)) {
            targetHandlerPairsToRemove.push(i);
        }
    }
    if (targetHandlerPairsToRemove.length === targetHandlerPairList.length) {
        source.removeEventListener(eventName, handlerForEventWithName);
        sourceEventMap.delete(eventName);
    }
    else {
        for (var j = targetHandlerPairsToRemove.length - 1; j >= 0; j--) {
            targetHandlerPairList.splice(targetHandlerPairsToRemove[j], 1);
        }
    }
}
exports.removeWeakEventListener = removeWeakEventListener;
//# sourceMappingURL=weak-event-listener.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/date-picker/date-picker-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var defaultDate = new Date();
var dateComparer = function (x, y) { return (x <= y && x >= y); };
var DatePickerBase = (function (_super) {
    __extends(DatePickerBase, _super);
    function DatePickerBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DatePickerBase = __decorate([
        view_1.CSSType("DatePicker")
    ], DatePickerBase);
    return DatePickerBase;
}(view_1.View));
exports.DatePickerBase = DatePickerBase;
DatePickerBase.prototype.recycleNativeView = "auto";
exports.yearProperty = new view_1.Property({
    name: "year",
    defaultValue: defaultDate.getFullYear(),
    valueConverter: function (v) { return parseInt(v); },
});
exports.yearProperty.register(DatePickerBase);
exports.monthProperty = new view_1.Property({
    name: "month",
    defaultValue: defaultDate.getMonth() + 1,
    valueConverter: function (v) { return parseInt(v); },
});
exports.monthProperty.register(DatePickerBase);
exports.dayProperty = new view_1.Property({
    name: "day",
    defaultValue: defaultDate.getDate(),
    valueConverter: function (v) { return parseInt(v); },
});
exports.dayProperty.register(DatePickerBase);
exports.maxDateProperty = new view_1.Property({
    name: "maxDate",
    equalityComparer: dateComparer,
    valueConverter: function (v) { return new Date(v); },
});
exports.maxDateProperty.register(DatePickerBase);
exports.minDateProperty = new view_1.Property({
    name: "minDate",
    equalityComparer: dateComparer,
    valueConverter: function (v) { return new Date(v); },
});
exports.minDateProperty.register(DatePickerBase);
exports.dateProperty = new view_1.Property({
    name: "date",
    defaultValue: defaultDate,
    equalityComparer: dateComparer,
    valueConverter: function (v) { return new Date(v); },
});
exports.dateProperty.register(DatePickerBase);
//# sourceMappingURL=date-picker-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/date-picker/date-picker.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var date_picker_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/date-picker/date-picker-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/date-picker/date-picker-common.js"));
var DateChangedListener;
function initializeDateChangedListener() {
    if (DateChangedListener) {
        return;
    }
    var DateChangedListenerImpl = (function (_super) {
        __extends(DateChangedListenerImpl, _super);
        function DateChangedListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        DateChangedListenerImpl.prototype.onDateChanged = function (picker, year, month, day) {
            var owner = this.owner;
            var dateChanged = false;
            if (year !== owner.year) {
                date_picker_common_1.yearProperty.nativeValueChange(owner, year);
                dateChanged = true;
            }
            if (month !== (owner.month - 1)) {
                date_picker_common_1.monthProperty.nativeValueChange(owner, month + 1);
                dateChanged = true;
            }
            if (day !== owner.day) {
                date_picker_common_1.dayProperty.nativeValueChange(owner, day);
                dateChanged = true;
            }
            if (dateChanged) {
                date_picker_common_1.dateProperty.nativeValueChange(owner, new Date(year, month, day));
            }
        };
        DateChangedListenerImpl = __decorate([
            Interfaces([android.widget.DatePicker.OnDateChangedListener])
        ], DateChangedListenerImpl);
        return DateChangedListenerImpl;
    }(java.lang.Object));
    DateChangedListener = DateChangedListenerImpl;
}
var DatePicker = (function (_super) {
    __extends(DatePicker, _super);
    function DatePicker() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DatePicker.prototype.createNativeView = function () {
        var picker = new android.widget.DatePicker(this._context);
        picker.setCalendarViewShown(false);
        return picker;
    };
    DatePicker.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        initializeDateChangedListener();
        var nativeView = this.nativeViewProtected;
        var listener = new DateChangedListener(this);
        nativeView.init(this.year, this.month - 1, this.day, listener);
        nativeView.listener = listener;
    };
    DatePicker.prototype.disposeNativeView = function () {
        this.nativeViewProtected.listener.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    DatePicker.prototype.updateNativeDate = function () {
        var nativeView = this.nativeViewProtected;
        var year = typeof this.year === "number" ? this.year : nativeView.getYear();
        var month = typeof this.month === "number" ? this.month - 1 : nativeView.getMonth();
        var day = typeof this.day === "number" ? this.day : nativeView.getDayOfMonth();
        this.date = new Date(year, month, day);
    };
    DatePicker.prototype[date_picker_common_1.yearProperty.setNative] = function (value) {
        if (this.nativeViewProtected.getYear() !== value) {
            this.updateNativeDate();
        }
    };
    DatePicker.prototype[date_picker_common_1.monthProperty.setNative] = function (value) {
        if (this.nativeViewProtected.getMonth() !== (value - 1)) {
            this.updateNativeDate();
        }
    };
    DatePicker.prototype[date_picker_common_1.dayProperty.setNative] = function (value) {
        if (this.nativeViewProtected.getDayOfMonth() !== value) {
            this.updateNativeDate();
        }
    };
    DatePicker.prototype[date_picker_common_1.dateProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        if (nativeView.getDayOfMonth() !== value.getDate()
            || nativeView.getMonth() !== value.getMonth()
            || nativeView.getYear() !== value.getFullYear()) {
            nativeView.updateDate(value.getFullYear(), value.getMonth(), value.getDate());
        }
    };
    DatePicker.prototype[date_picker_common_1.maxDateProperty.getDefault] = function () {
        return this.nativeViewProtected.getMaxDate();
    };
    DatePicker.prototype[date_picker_common_1.maxDateProperty.setNative] = function (value) {
        var newValue = value instanceof Date ? value.getTime() : value;
        this.nativeViewProtected.setMaxDate(newValue);
    };
    DatePicker.prototype[date_picker_common_1.minDateProperty.getDefault] = function () {
        return this.nativeViewProtected.getMinDate();
    };
    DatePicker.prototype[date_picker_common_1.minDateProperty.setNative] = function (value) {
        var newValue = value instanceof Date ? value.getTime() : value;
        this.nativeViewProtected.setMinDate(newValue);
    };
    return DatePicker;
}(date_picker_common_1.DatePickerBase));
exports.DatePicker = DatePicker;
//# sourceMappingURL=date-picker.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/dialogs/dialogs-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
exports.STRING = "string";
exports.PROMPT = "Prompt";
exports.CONFIRM = "Confirm";
exports.ALERT = "Alert";
exports.LOGIN = "Login";
exports.OK = "OK";
exports.CANCEL = "Cancel";
var inputType;
(function (inputType) {
    inputType.text = "text";
    inputType.password = "password";
    inputType.email = "email";
    inputType.number = "number";
    inputType.decimal = "decimal";
    inputType.phone = "phone";
})(inputType = exports.inputType || (exports.inputType = {}));
var capitalizationType;
(function (capitalizationType) {
    capitalizationType.none = "none";
    capitalizationType.all = "all";
    capitalizationType.sentences = "sentences";
    capitalizationType.words = "words";
})(capitalizationType = exports.capitalizationType || (exports.capitalizationType = {}));
var frame;
function getCurrentPage() {
    if (!frame) {
        frame = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
    }
    var topmostFrame = frame.topmost();
    if (topmostFrame) {
        return topmostFrame.currentPage;
    }
    return undefined;
}
exports.getCurrentPage = getCurrentPage;
function applySelectors(view, callback) {
    var currentPage = getCurrentPage();
    if (currentPage) {
        var styleScope = currentPage._styleScope;
        if (styleScope) {
            view._inheritStyleScope(styleScope);
            view.onLoaded();
            callback(view);
            view.onUnloaded();
        }
    }
}
var button;
var label;
var textField;
function getButtonColors() {
    if (!button) {
        var Button = __webpack_require__("../node_modules/tns-core-modules/ui/button/button.js").Button;
        button = new Button;
        if (platform_1.isIOS) {
            button._setupUI({});
        }
    }
    var buttonColor;
    var buttonBackgroundColor;
    applySelectors(button, function (btn) {
        buttonColor = btn.color;
        buttonBackgroundColor = btn.backgroundColor;
    });
    return { color: buttonColor, backgroundColor: buttonBackgroundColor };
}
exports.getButtonColors = getButtonColors;
function getLabelColor() {
    if (!label) {
        var Label = __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js").Label;
        label = new Label;
        if (platform_1.isIOS) {
            label._setupUI({});
        }
    }
    var labelColor;
    applySelectors(label, function (lbl) {
        labelColor = lbl.color;
    });
    return labelColor;
}
exports.getLabelColor = getLabelColor;
function getTextFieldColor() {
    if (!textField) {
        var TextField = __webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field.js").TextField;
        textField = new TextField();
        if (platform_1.isIOS) {
            textField._setupUI({});
        }
    }
    var textFieldColor;
    applySelectors(textField, function (tf) {
        textFieldColor = tf.color;
    });
    return textFieldColor;
}
exports.getTextFieldColor = getTextFieldColor;
function isDialogOptions(arg) {
    return arg && (arg.message || arg.title);
}
exports.isDialogOptions = isDialogOptions;
function parseLoginOptions(args) {
    if (args.length === 1 && types_1.isObject(args[0])) {
        return args[0];
    }
    var options = { title: exports.LOGIN, okButtonText: exports.OK, cancelButtonText: exports.CANCEL };
    if (types_1.isString(args[0])) {
        options.message = args[0];
    }
    if (types_1.isString(args[1])) {
        options.userNameHint = args[1];
    }
    if (types_1.isString(args[2])) {
        options.passwordHint = args[2];
    }
    if (types_1.isString(args[3])) {
        options.userName = args[3];
    }
    if (types_1.isString(args[4])) {
        options.password = args[4];
    }
    return options;
}
exports.parseLoginOptions = parseLoginOptions;
//# sourceMappingURL=dialogs-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/dialogs/dialogs.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var dialogs_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs-common.js");
var application_1 = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs-common.js"));
function isString(value) {
    return typeof value === "string";
}
function createAlertDialog(options) {
    var alert = new android.app.AlertDialog.Builder(application_1.android.foregroundActivity);
    alert.setTitle(options && isString(options.title) ? options.title : "");
    alert.setMessage(options && isString(options.message) ? options.message : "");
    if (options && options.cancelable === false) {
        alert.setCancelable(false);
    }
    return alert;
}
function showDialog(builder) {
    var dlg = builder.show();
    var labelColor = dialogs_common_1.getLabelColor();
    if (labelColor) {
        var textViewId = dlg.getContext().getResources().getIdentifier("android:id/alertTitle", null, null);
        if (textViewId) {
            var tv = dlg.findViewById(textViewId);
            if (tv) {
                tv.setTextColor(labelColor.android);
            }
        }
        var messageTextViewId = dlg.getContext().getResources().getIdentifier("android:id/message", null, null);
        if (messageTextViewId) {
            var messageTextView = dlg.findViewById(messageTextViewId);
            if (messageTextView) {
                messageTextView.setTextColor(labelColor.android);
            }
        }
    }
    var _a = dialogs_common_1.getButtonColors(), color = _a.color, backgroundColor = _a.backgroundColor;
    if (color) {
        var buttons = [];
        for (var i = 0; i < 3; i++) {
            var id = dlg.getContext().getResources().getIdentifier("android:id/button" + i, null, null);
            buttons[i] = dlg.findViewById(id);
        }
        buttons.forEach(function (button) {
            if (button) {
                if (color) {
                    button.setTextColor(color.android);
                }
                if (backgroundColor) {
                    button.setBackgroundColor(backgroundColor.android);
                }
            }
        });
    }
}
function addButtonsToAlertDialog(alert, options, callback) {
    if (!options) {
        return;
    }
    if (options.okButtonText) {
        alert.setPositiveButton(options.okButtonText, new android.content.DialogInterface.OnClickListener({
            onClick: function (dialog, id) {
                dialog.cancel();
                callback(true);
            }
        }));
    }
    if (options.cancelButtonText) {
        alert.setNegativeButton(options.cancelButtonText, new android.content.DialogInterface.OnClickListener({
            onClick: function (dialog, id) {
                dialog.cancel();
                callback(false);
            }
        }));
    }
    if (options.neutralButtonText) {
        alert.setNeutralButton(options.neutralButtonText, new android.content.DialogInterface.OnClickListener({
            onClick: function (dialog, id) {
                dialog.cancel();
                callback(undefined);
            }
        }));
    }
    alert.setOnDismissListener(new android.content.DialogInterface.OnDismissListener({
        onDismiss: function () {
            callback(false);
        }
    }));
}
function alert(arg) {
    return new Promise(function (resolve, reject) {
        try {
            var options = !dialogs_common_1.isDialogOptions(arg) ? { title: dialogs_common_1.ALERT, okButtonText: dialogs_common_1.OK, message: arg + "" } : arg;
            var alert_1 = createAlertDialog(options);
            alert_1.setPositiveButton(options.okButtonText, new android.content.DialogInterface.OnClickListener({
                onClick: function (dialog, id) {
                    dialog.cancel();
                    resolve();
                }
            }));
            alert_1.setOnDismissListener(new android.content.DialogInterface.OnDismissListener({
                onDismiss: function () {
                    resolve();
                }
            }));
            showDialog(alert_1);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.alert = alert;
function confirm(arg) {
    return new Promise(function (resolve, reject) {
        try {
            var options = !dialogs_common_1.isDialogOptions(arg) ? { title: dialogs_common_1.CONFIRM, okButtonText: dialogs_common_1.OK, cancelButtonText: dialogs_common_1.CANCEL, message: arg + "" } : arg;
            var alert_2 = createAlertDialog(options);
            addButtonsToAlertDialog(alert_2, options, function (result) { resolve(result); });
            showDialog(alert_2);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.confirm = confirm;
function prompt(arg) {
    var options;
    var defaultOptions = {
        title: dialogs_common_1.PROMPT,
        okButtonText: dialogs_common_1.OK,
        cancelButtonText: dialogs_common_1.CANCEL,
        inputType: dialogs_common_1.inputType.text,
    };
    if (arguments.length === 1) {
        if (isString(arg)) {
            options = defaultOptions;
            options.message = arg;
        }
        else {
            options = arg;
        }
    }
    else if (arguments.length === 2) {
        if (isString(arguments[0]) && isString(arguments[1])) {
            options = defaultOptions;
            options.message = arguments[0];
            options.defaultText = arguments[1];
        }
    }
    return new Promise(function (resolve, reject) {
        try {
            var alert_3 = createAlertDialog(options);
            var input_1 = new android.widget.EditText(application_1.android.foregroundActivity);
            if (options) {
                if (options.inputType === dialogs_common_1.inputType.password) {
                    input_1.setInputType(android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_PASSWORD);
                }
                else if (options.inputType === dialogs_common_1.inputType.email) {
                    input_1.setInputType(android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_EMAIL_ADDRESS);
                }
                else if (options.inputType === dialogs_common_1.inputType.number) {
                    input_1.setInputType(android.text.InputType.TYPE_CLASS_NUMBER);
                }
                else if (options.inputType === dialogs_common_1.inputType.decimal) {
                    input_1.setInputType(android.text.InputType.TYPE_CLASS_NUMBER | android.text.InputType.TYPE_NUMBER_FLAG_DECIMAL);
                }
                else if (options.inputType === dialogs_common_1.inputType.phone) {
                    input_1.setInputType(android.text.InputType.TYPE_CLASS_PHONE);
                }
                switch (options.capitalizationType) {
                    case dialogs_common_1.capitalizationType.all: {
                        input_1.setInputType(input_1.getInputType() | android.text.InputType.TYPE_TEXT_FLAG_CAP_CHARACTERS);
                        break;
                    }
                    case dialogs_common_1.capitalizationType.sentences: {
                        input_1.setInputType(input_1.getInputType() | android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES);
                        break;
                    }
                    case dialogs_common_1.capitalizationType.words: {
                        input_1.setInputType(input_1.getInputType() | android.text.InputType.TYPE_TEXT_FLAG_CAP_WORDS);
                        break;
                    }
                }
            }
            input_1.setText(options && options.defaultText || "");
            alert_3.setView(input_1);
            var getText_1 = function () { return input_1.getText().toString(); };
            addButtonsToAlertDialog(alert_3, options, function (r) { resolve({ result: r, text: getText_1() }); });
            showDialog(alert_3);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.prompt = prompt;
function login() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    var options = dialogs_common_1.parseLoginOptions(args);
    return new Promise(function (resolve, reject) {
        try {
            var context_1 = application_1.android.foregroundActivity;
            var alert_4 = createAlertDialog(options);
            var userNameInput_1 = new android.widget.EditText(context_1);
            userNameInput_1.setHint(options.userNameHint ? options.userNameHint : "");
            userNameInput_1.setText(options.userName ? options.userName : "");
            var passwordInput_1 = new android.widget.EditText(context_1);
            passwordInput_1.setInputType(android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_PASSWORD);
            passwordInput_1.setTypeface(android.graphics.Typeface.DEFAULT);
            passwordInput_1.setHint(options.passwordHint ? options.passwordHint : "");
            passwordInput_1.setText(options.password ? options.password : "");
            var layout = new android.widget.LinearLayout(context_1);
            layout.setOrientation(1);
            layout.addView(userNameInput_1);
            layout.addView(passwordInput_1);
            alert_4.setView(layout);
            addButtonsToAlertDialog(alert_4, options, function (r) {
                resolve({
                    result: r,
                    userName: userNameInput_1.getText().toString(),
                    password: passwordInput_1.getText().toString()
                });
            });
            showDialog(alert_4);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.login = login;
function action(arg) {
    var options;
    var defaultOptions = { title: null, cancelButtonText: dialogs_common_1.CANCEL };
    if (arguments.length === 1) {
        if (isString(arguments[0])) {
            options = defaultOptions;
            options.message = arguments[0];
        }
        else {
            options = arguments[0];
        }
    }
    else if (arguments.length === 2) {
        if (isString(arguments[0]) && isString(arguments[1])) {
            options = defaultOptions;
            options.message = arguments[0];
            options.cancelButtonText = arguments[1];
        }
    }
    else if (arguments.length === 3) {
        if (isString(arguments[0]) && isString(arguments[1]) && typeof arguments[2] !== "undefined") {
            options = defaultOptions;
            options.message = arguments[0];
            options.cancelButtonText = arguments[1];
            options.actions = arguments[2];
        }
    }
    return new Promise(function (resolve, reject) {
        try {
            var activity = application_1.android.foregroundActivity || application_1.android.startActivity;
            var alert_5 = new android.app.AlertDialog.Builder(activity);
            var message = options && isString(options.message) ? options.message : "";
            var title = options && isString(options.title) ? options.title : "";
            if (options && options.cancelable === false) {
                alert_5.setCancelable(false);
            }
            if (title) {
                alert_5.setTitle(title);
                if (!options.actions) {
                    alert_5.setMessage(message);
                }
            }
            else {
                alert_5.setTitle(message);
            }
            if (options.actions) {
                alert_5.setItems(options.actions, new android.content.DialogInterface.OnClickListener({
                    onClick: function (dialog, which) {
                        resolve(options.actions[which]);
                    }
                }));
            }
            if (isString(options.cancelButtonText)) {
                alert_5.setNegativeButton(options.cancelButtonText, new android.content.DialogInterface.OnClickListener({
                    onClick: function (dialog, id) {
                        dialog.cancel();
                        resolve(options.cancelButtonText);
                    }
                }));
            }
            alert_5.setOnDismissListener(new android.content.DialogInterface.OnDismissListener({
                onDismiss: function () {
                    if (isString(options.cancelButtonText)) {
                        resolve(options.cancelButtonText);
                    }
                    else {
                        resolve("");
                    }
                }
            }));
            showDialog(alert_5);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.action = action;
//# sourceMappingURL=dialogs.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var EditableTextBase = (function (_super) {
    __extends(EditableTextBase, _super);
    function EditableTextBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._focusHandler = function () { return _this._goToVisualState("focus"); };
        _this._blurHandler = function () { return _this._goToVisualState("blur"); };
        return _this;
    }
    EditableTextBase.prototype._updateTextBaseFocusStateHandler = function (subscribe) {
        var method = subscribe ? "on" : "off";
        this[method]("focus", this._focusHandler);
        this[method]("blur", this._blurHandler);
    };
    EditableTextBase.blurEvent = "blur";
    EditableTextBase.focusEvent = "focus";
    EditableTextBase.textChangeEvent = "textChange";
    __decorate([
        text_base_1.PseudoClassHandler("focus", "blur")
    ], EditableTextBase.prototype, "_updateTextBaseFocusStateHandler", null);
    return EditableTextBase;
}(text_base_1.TextBase));
exports.EditableTextBase = EditableTextBase;
exports.placeholderColorProperty = new text_base_1.CssProperty({ name: "placeholderColor", cssName: "placeholder-color", equalityComparer: text_base_1.Color.equals, valueConverter: function (v) { return new text_base_1.Color(v); } });
exports.placeholderColorProperty.register(text_base_1.Style);
var keyboardTypeConverter = text_base_1.makeParser(text_base_1.makeValidator("datetime", "phone", "number", "url", "email"));
exports.keyboardTypeProperty = new text_base_1.Property({ name: "keyboardType", valueConverter: keyboardTypeConverter });
exports.keyboardTypeProperty.register(EditableTextBase);
var returnKeyTypeConverter = text_base_1.makeParser(text_base_1.makeValidator("done", "next", "go", "search", "send"));
exports.returnKeyTypeProperty = new text_base_1.Property({ name: "returnKeyType", valueConverter: returnKeyTypeConverter });
exports.returnKeyTypeProperty.register(EditableTextBase);
exports.editableProperty = new text_base_1.Property({ name: "editable", defaultValue: true, valueConverter: text_base_1.booleanConverter });
exports.editableProperty.register(EditableTextBase);
exports.updateTextTriggerProperty = new text_base_1.Property({ name: "updateTextTrigger", defaultValue: "textChanged" });
exports.updateTextTriggerProperty.register(EditableTextBase);
var autocapitalizationTypeConverter = text_base_1.makeParser(text_base_1.makeValidator("none", "words", "sentences", "allcharacters"));
exports.autocapitalizationTypeProperty = new text_base_1.Property({ name: "autocapitalizationType", defaultValue: "sentences", valueConverter: autocapitalizationTypeConverter });
exports.autocapitalizationTypeProperty.register(EditableTextBase);
exports.autocorrectProperty = new text_base_1.Property({ name: "autocorrect", valueConverter: text_base_1.booleanConverter });
exports.autocorrectProperty.register(EditableTextBase);
exports.hintProperty = new text_base_1.Property({ name: "hint", defaultValue: "" });
exports.hintProperty.register(EditableTextBase);
exports.maxLengthProperty = new text_base_1.Property({ name: "maxLength", defaultValue: Number.POSITIVE_INFINITY, valueConverter: parseInt });
exports.maxLengthProperty.register(EditableTextBase);
//# sourceMappingURL=editable-text-base-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var editable_text_base_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base-common.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base-common.js"));
var EditTextListeners;
function clearDismissTimer() {
    exports.dismissKeyboardOwner = null;
    if (exports.dismissKeyboardTimeoutId) {
        clearTimeout(exports.dismissKeyboardTimeoutId);
        exports.dismissKeyboardTimeoutId = null;
    }
}
function dismissSoftInput(owner) {
    clearDismissTimer();
    if (!exports.dismissKeyboardTimeoutId) {
        exports.dismissKeyboardTimeoutId = setTimeout(function () {
            var owner = exports.dismissKeyboardOwner && exports.dismissKeyboardOwner.get();
            var activity = (owner && owner._context);
            var nativeView = owner && owner.nativeViewProtected;
            exports.dismissKeyboardTimeoutId = null;
            exports.dismissKeyboardOwner = null;
            var focused = activity && activity.getCurrentFocus();
            if (!focused || !(focused instanceof android.widget.EditText)) {
                utils_1.ad.dismissSoftInput(nativeView);
            }
        }, 10);
    }
}
function initializeEditTextListeners() {
    if (EditTextListeners) {
        return;
    }
    var EditTextListenersImpl = (function (_super) {
        __extends(EditTextListenersImpl, _super);
        function EditTextListenersImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        EditTextListenersImpl.prototype.beforeTextChanged = function (text, start, count, after) {
        };
        EditTextListenersImpl.prototype.onTextChanged = function (text, start, before, count) {
        };
        EditTextListenersImpl.prototype.afterTextChanged = function (editable) {
            var owner = this.owner;
            if (!owner || owner._changeFromCode) {
                return;
            }
            switch (owner.updateTextTrigger) {
                case "focusLost":
                    owner._dirtyTextAccumulator = editable.toString();
                    break;
                case "textChanged":
                    editable_text_base_common_1.textProperty.nativeValueChange(owner, editable.toString());
                    break;
                default:
                    throw new Error("Invalid updateTextTrigger: " + owner.updateTextTrigger);
            }
        };
        EditTextListenersImpl.prototype.onFocusChange = function (view, hasFocus) {
            var owner = this.owner;
            if (!owner) {
                return;
            }
            if (hasFocus) {
                clearDismissTimer();
                owner.notify({ eventName: EditableTextBase.focusEvent, object: owner });
            }
            else {
                if (owner._dirtyTextAccumulator || owner._dirtyTextAccumulator === "") {
                    editable_text_base_common_1.textProperty.nativeValueChange(owner, owner._dirtyTextAccumulator);
                    owner._dirtyTextAccumulator = undefined;
                }
                owner.notify({ eventName: EditableTextBase.blurEvent, object: owner });
                dismissSoftInput(owner);
            }
        };
        EditTextListenersImpl.prototype.onEditorAction = function (textView, actionId, event) {
            var owner = this.owner;
            if (!owner) {
                return false;
            }
            if (actionId === android.view.inputmethod.EditorInfo.IME_ACTION_DONE ||
                actionId === android.view.inputmethod.EditorInfo.IME_ACTION_UNSPECIFIED ||
                (event && event.getKeyCode() === android.view.KeyEvent.KEYCODE_ENTER)) {
                if (textView.getMaxLines() === 1) {
                    owner.dismissSoftInput();
                }
                owner._onReturnPress();
            }
            else if (actionId === android.view.inputmethod.EditorInfo.IME_ACTION_NEXT ||
                actionId === android.view.inputmethod.EditorInfo.IME_ACTION_PREVIOUS) {
                owner._onReturnPress();
            }
            return false;
        };
        EditTextListenersImpl = __decorate([
            Interfaces([android.text.TextWatcher, android.view.View.OnFocusChangeListener, android.widget.TextView.OnEditorActionListener])
        ], EditTextListenersImpl);
        return EditTextListenersImpl;
    }(java.lang.Object));
    EditTextListeners = EditTextListenersImpl;
}
var EditableTextBase = (function (_super) {
    __extends(EditableTextBase, _super);
    function EditableTextBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    EditableTextBase.prototype._onReturnPress = function () {
    };
    EditableTextBase.prototype.createNativeView = function () {
        return new android.widget.EditText(this._context);
    };
    EditableTextBase.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var editText = this.nativeTextViewProtected;
        this._configureEditText(editText);
        initializeEditTextListeners();
        var listeners = new EditTextListeners(this);
        editText.addTextChangedListener(listeners);
        editText.setOnFocusChangeListener(listeners);
        editText.setOnEditorActionListener(listeners);
        editText.listener = listeners;
        this._inputType = editText.getInputType();
    };
    EditableTextBase.prototype.disposeNativeView = function () {
        this.nativeTextViewProtected.listener.owner = null;
        this._keyListenerCache = null;
        _super.prototype.disposeNativeView.call(this);
    };
    EditableTextBase.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        this.nativeTextViewProtected.setInputType(this._inputType);
    };
    EditableTextBase.prototype.onUnloaded = function () {
        this.dismissSoftInput();
        _super.prototype.onUnloaded.call(this);
    };
    EditableTextBase.prototype.dismissSoftInput = function () {
        var nativeView = this.nativeTextViewProtected;
        if (!nativeView) {
            return;
        }
        utils_1.ad.dismissSoftInput(nativeView);
    };
    EditableTextBase.prototype.focus = function () {
        var nativeView = this.nativeTextViewProtected;
        if (!nativeView) {
            return;
        }
        var result = _super.prototype.focus.call(this);
        if (result) {
            utils_1.ad.showSoftInput(this.nativeTextViewProtected);
        }
        return result;
    };
    EditableTextBase.prototype._setInputType = function (inputType) {
        var nativeView = this.nativeTextViewProtected;
        try {
            this._changeFromCode = true;
            nativeView.setInputType(inputType);
        }
        finally {
            this._changeFromCode = false;
        }
        var listener = nativeView.getKeyListener();
        if (listener) {
            this._keyListenerCache = listener;
        }
        if (!this.editable) {
            nativeView.setKeyListener(null);
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.textProperty.getDefault] = function () {
        return editable_text_base_common_1.resetSymbol;
    };
    EditableTextBase.prototype[editable_text_base_common_1.textProperty.setNative] = function (value) {
        try {
            this._changeFromCode = true;
            this._setNativeText(value === editable_text_base_common_1.resetSymbol);
        }
        finally {
            this._changeFromCode = false;
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.keyboardTypeProperty.getDefault] = function () {
        return this.nativeTextViewProtected.getInputType();
    };
    EditableTextBase.prototype[editable_text_base_common_1.keyboardTypeProperty.setNative] = function (value) {
        var newInputType;
        switch (value) {
            case "datetime":
                newInputType = android.text.InputType.TYPE_CLASS_DATETIME | android.text.InputType.TYPE_DATETIME_VARIATION_NORMAL;
                break;
            case "phone":
                newInputType = android.text.InputType.TYPE_CLASS_PHONE;
                break;
            case "number":
                newInputType = android.text.InputType.TYPE_CLASS_NUMBER | android.text.InputType.TYPE_NUMBER_VARIATION_NORMAL | android.text.InputType.TYPE_NUMBER_FLAG_SIGNED | android.text.InputType.TYPE_NUMBER_FLAG_DECIMAL;
                break;
            case "url":
                newInputType = android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_URI;
                break;
            case "email":
                newInputType = android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_EMAIL_ADDRESS;
                break;
            default:
                newInputType = value;
                break;
        }
        this._setInputType(newInputType);
    };
    EditableTextBase.prototype[editable_text_base_common_1.returnKeyTypeProperty.getDefault] = function () {
        var ime = this.nativeTextViewProtected.getImeOptions();
        switch (ime) {
            case android.view.inputmethod.EditorInfo.IME_ACTION_DONE:
                return "done";
            case android.view.inputmethod.EditorInfo.IME_ACTION_GO:
                return "go";
            case android.view.inputmethod.EditorInfo.IME_ACTION_NEXT:
                return "next";
            case android.view.inputmethod.EditorInfo.IME_ACTION_SEARCH:
                return "search";
            case android.view.inputmethod.EditorInfo.IME_ACTION_SEND:
                return "send";
            default:
                return ime.toString();
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.returnKeyTypeProperty.setNative] = function (value) {
        var newImeOptions;
        switch (value) {
            case "done":
                newImeOptions = android.view.inputmethod.EditorInfo.IME_ACTION_DONE;
                break;
            case "go":
                newImeOptions = android.view.inputmethod.EditorInfo.IME_ACTION_GO;
                break;
            case "next":
                newImeOptions = android.view.inputmethod.EditorInfo.IME_ACTION_NEXT;
                break;
            case "search":
                newImeOptions = android.view.inputmethod.EditorInfo.IME_ACTION_SEARCH;
                break;
            case "send":
                newImeOptions = android.view.inputmethod.EditorInfo.IME_ACTION_SEND;
                break;
            default:
                var ime = +value;
                if (!isNaN(ime)) {
                    newImeOptions = ime;
                }
                else {
                    newImeOptions = android.view.inputmethod.EditorInfo.IME_ACTION_UNSPECIFIED;
                }
                break;
        }
        this.nativeTextViewProtected.setImeOptions(newImeOptions);
    };
    EditableTextBase.prototype[editable_text_base_common_1.editableProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        if (value) {
            nativeView.setKeyListener(this._keyListenerCache);
        }
        else {
            if (!this._keyListenerCache) {
                this._keyListenerCache = nativeView.getKeyListener();
            }
            nativeView.setKeyListener(null);
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocapitalizationTypeProperty.getDefault] = function () {
        var inputType = this.nativeTextViewProtected.getInputType();
        if ((inputType & android.text.InputType.TYPE_TEXT_FLAG_CAP_WORDS) === android.text.InputType.TYPE_TEXT_FLAG_CAP_WORDS) {
            return "words";
        }
        else if ((inputType & android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES) === android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES) {
            return "sentences";
        }
        else if ((inputType & android.text.InputType.TYPE_TEXT_FLAG_CAP_CHARACTERS) === android.text.InputType.TYPE_TEXT_FLAG_CAP_CHARACTERS) {
            return "allcharacters";
        }
        else {
            return inputType.toString();
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocapitalizationTypeProperty.setNative] = function (value) {
        var inputType = this.nativeTextViewProtected.getInputType();
        inputType = inputType & ~28672;
        switch (value) {
            case "none":
                break;
            case "words":
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_WORDS;
                break;
            case "sentences":
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES;
                break;
            case "allcharacters":
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_CHARACTERS;
                break;
            default:
                var number = +value;
                if (!isNaN(number)) {
                    inputType = number;
                }
                else {
                    inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES;
                }
                break;
        }
        this._setInputType(inputType);
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocorrectProperty.getDefault] = function () {
        var autocorrect = this.nativeTextViewProtected.getInputType();
        if ((autocorrect & android.text.InputType.TYPE_TEXT_FLAG_AUTO_CORRECT) === android.text.InputType.TYPE_TEXT_FLAG_AUTO_CORRECT) {
            return true;
        }
        return false;
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocorrectProperty.setNative] = function (value) {
        var inputType = this.nativeTextViewProtected.getInputType();
        switch (value) {
            case true:
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_AUTO_COMPLETE;
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_AUTO_CORRECT;
                inputType = inputType & ~android.text.InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS;
                break;
            case false:
                inputType = inputType & ~android.text.InputType.TYPE_TEXT_FLAG_AUTO_COMPLETE;
                inputType = inputType & ~android.text.InputType.TYPE_TEXT_FLAG_AUTO_CORRECT;
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS;
                break;
            default:
                break;
        }
        this._setInputType(inputType);
    };
    EditableTextBase.prototype[editable_text_base_common_1.hintProperty.getDefault] = function () {
        return this.nativeTextViewProtected.getHint();
    };
    EditableTextBase.prototype[editable_text_base_common_1.hintProperty.setNative] = function (value) {
        var text = (value === null || value === undefined) ? null : value.toString();
        this.nativeTextViewProtected.setHint(text);
    };
    EditableTextBase.prototype[editable_text_base_common_1.placeholderColorProperty.getDefault] = function () {
        return this.nativeTextViewProtected.getHintTextColors();
    };
    EditableTextBase.prototype[editable_text_base_common_1.placeholderColorProperty.setNative] = function (value) {
        var color = value instanceof editable_text_base_common_1.Color ? value.android : value;
        this.nativeTextViewProtected.setHintTextColor(color);
    };
    EditableTextBase.prototype[editable_text_base_common_1.textTransformProperty.setNative] = function (value) {
    };
    EditableTextBase.prototype[editable_text_base_common_1.maxLengthProperty.setNative] = function (value) {
        if (value === Number.POSITIVE_INFINITY) {
            this.nativeTextViewProtected.setFilters([]);
        }
        else {
            var lengthFilter = new android.text.InputFilter.LengthFilter(value);
            var filters = this.nativeTextViewProtected.getFilters();
            var newFilters = [];
            for (var i = 0; i < filters.length; i++) {
                var filter = filters[i];
                if (!(filter instanceof android.text.InputFilter.LengthFilter)) {
                    newFilters.push(filter);
                }
            }
            newFilters.push(lengthFilter);
            this.nativeTextViewProtected.setFilters(newFilters);
        }
    };
    return EditableTextBase;
}(editable_text_base_common_1.EditableTextBase));
exports.EditableTextBase = EditableTextBase;
//# sourceMappingURL=editable-text-base.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/enums/enums.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var KeyboardType;
(function (KeyboardType) {
    KeyboardType.datetime = "datetime";
    KeyboardType.phone = "phone";
    KeyboardType.number = "number";
    KeyboardType.url = "url";
    KeyboardType.email = "email";
})(KeyboardType = exports.KeyboardType || (exports.KeyboardType = {}));
var ReturnKeyType;
(function (ReturnKeyType) {
    ReturnKeyType.done = "done";
    ReturnKeyType.next = "next";
    ReturnKeyType.go = "go";
    ReturnKeyType.search = "search";
    ReturnKeyType.send = "send";
})(ReturnKeyType = exports.ReturnKeyType || (exports.ReturnKeyType = {}));
var TextAlignment;
(function (TextAlignment) {
    TextAlignment.left = "left";
    TextAlignment.center = "center";
    TextAlignment.right = "right";
})(TextAlignment = exports.TextAlignment || (exports.TextAlignment = {}));
var TextDecoration;
(function (TextDecoration) {
    TextDecoration.none = "none";
    TextDecoration.underline = "underline";
    TextDecoration.lineThrough = "line-through";
})(TextDecoration = exports.TextDecoration || (exports.TextDecoration = {}));
var TextTransform;
(function (TextTransform) {
    TextTransform.none = "none";
    TextTransform.capitalize = "capitalize";
    TextTransform.uppercase = "uppercase";
    TextTransform.lowercase = "lowercase";
})(TextTransform = exports.TextTransform || (exports.TextTransform = {}));
var WhiteSpace;
(function (WhiteSpace) {
    WhiteSpace.normal = "normal";
    WhiteSpace.nowrap = "nowrap";
})(WhiteSpace = exports.WhiteSpace || (exports.WhiteSpace = {}));
var Orientation;
(function (Orientation) {
    Orientation.horizontal = "horizontal";
    Orientation.vertical = "vertical";
})(Orientation = exports.Orientation || (exports.Orientation = {}));
var DeviceOrientation;
(function (DeviceOrientation) {
    DeviceOrientation.portrait = "portrait";
    DeviceOrientation.landscape = "landscape";
    DeviceOrientation.unknown = "unknown";
})(DeviceOrientation = exports.DeviceOrientation || (exports.DeviceOrientation = {}));
var HorizontalAlignment;
(function (HorizontalAlignment) {
    HorizontalAlignment.left = "left";
    HorizontalAlignment.center = "center";
    HorizontalAlignment.right = "right";
    HorizontalAlignment.stretch = "stretch";
})(HorizontalAlignment = exports.HorizontalAlignment || (exports.HorizontalAlignment = {}));
var VerticalAlignment;
(function (VerticalAlignment) {
    VerticalAlignment.top = "top";
    VerticalAlignment.middle = "middle";
    VerticalAlignment.bottom = "bottom";
    VerticalAlignment.stretch = "stretch";
})(VerticalAlignment = exports.VerticalAlignment || (exports.VerticalAlignment = {}));
var Stretch;
(function (Stretch) {
    Stretch.none = "none";
    Stretch.aspectFill = "aspectFill";
    Stretch.aspectFit = "aspectFit";
    Stretch.fill = "fill";
})(Stretch = exports.Stretch || (exports.Stretch = {}));
var Visibility;
(function (Visibility) {
    Visibility.visible = "visible";
    Visibility.collapse = "collapse";
    Visibility.collapsed = "collapsed";
})(Visibility = exports.Visibility || (exports.Visibility = {}));
var FontAttributes;
(function (FontAttributes) {
    FontAttributes.Normal = 0;
    FontAttributes.Bold = 1;
    FontAttributes.Italic = 1 << 1;
})(FontAttributes = exports.FontAttributes || (exports.FontAttributes = {}));
var DeviceType;
(function (DeviceType) {
    DeviceType.Phone = "Phone";
    DeviceType.Tablet = "Tablet";
})(DeviceType = exports.DeviceType || (exports.DeviceType = {}));
var UpdateTextTrigger;
(function (UpdateTextTrigger) {
    UpdateTextTrigger.focusLost = "focusLost";
    UpdateTextTrigger.textChanged = "textChanged";
})(UpdateTextTrigger = exports.UpdateTextTrigger || (exports.UpdateTextTrigger = {}));
var Accuracy;
(function (Accuracy) {
    Accuracy.any = 300;
    Accuracy.high = 3;
})(Accuracy = exports.Accuracy || (exports.Accuracy = {}));
var Dock;
(function (Dock) {
    Dock.left = "left";
    Dock.top = "top";
    Dock.right = "right";
    Dock.bottom = "bottom";
})(Dock = exports.Dock || (exports.Dock = {}));
var AutocapitalizationType;
(function (AutocapitalizationType) {
    AutocapitalizationType.none = "none";
    AutocapitalizationType.words = "words";
    AutocapitalizationType.sentences = "sentences";
    AutocapitalizationType.allCharacters = "allcharacters";
})(AutocapitalizationType = exports.AutocapitalizationType || (exports.AutocapitalizationType = {}));
var NavigationBarVisibility;
(function (NavigationBarVisibility) {
    NavigationBarVisibility.auto = "auto";
    NavigationBarVisibility.never = "never";
    NavigationBarVisibility.always = "always";
})(NavigationBarVisibility = exports.NavigationBarVisibility || (exports.NavigationBarVisibility = {}));
var AndroidActionBarIconVisibility;
(function (AndroidActionBarIconVisibility) {
    AndroidActionBarIconVisibility.auto = "auto";
    AndroidActionBarIconVisibility.never = "never";
    AndroidActionBarIconVisibility.always = "always";
})(AndroidActionBarIconVisibility = exports.AndroidActionBarIconVisibility || (exports.AndroidActionBarIconVisibility = {}));
var AndroidActionItemPosition;
(function (AndroidActionItemPosition) {
    AndroidActionItemPosition.actionBar = "actionBar";
    AndroidActionItemPosition.actionBarIfRoom = "actionBarIfRoom";
    AndroidActionItemPosition.popup = "popup";
})(AndroidActionItemPosition = exports.AndroidActionItemPosition || (exports.AndroidActionItemPosition = {}));
var IOSActionItemPosition;
(function (IOSActionItemPosition) {
    IOSActionItemPosition.left = "left";
    IOSActionItemPosition.right = "right";
})(IOSActionItemPosition = exports.IOSActionItemPosition || (exports.IOSActionItemPosition = {}));
var ImageFormat;
(function (ImageFormat) {
    ImageFormat.png = "png";
    ImageFormat.jpeg = "jpeg";
    ImageFormat.jpg = "jpg";
})(ImageFormat = exports.ImageFormat || (exports.ImageFormat = {}));
var FontStyle;
(function (FontStyle) {
    FontStyle.normal = "normal";
    FontStyle.italic = "italic";
})(FontStyle = exports.FontStyle || (exports.FontStyle = {}));
var FontWeight;
(function (FontWeight) {
    FontWeight.thin = "100";
    FontWeight.extraLight = "200";
    FontWeight.light = "300";
    FontWeight.normal = "normal";
    FontWeight.medium = "500";
    FontWeight.semiBold = "600";
    FontWeight.bold = "bold";
    FontWeight.extraBold = "800";
    FontWeight.black = "900";
})(FontWeight = exports.FontWeight || (exports.FontWeight = {}));
var BackgroundRepeat;
(function (BackgroundRepeat) {
    BackgroundRepeat.repeat = "repeat";
    BackgroundRepeat.repeatX = "repeat-x";
    BackgroundRepeat.repeatY = "repeat-y";
    BackgroundRepeat.noRepeat = "no-repeat";
})(BackgroundRepeat = exports.BackgroundRepeat || (exports.BackgroundRepeat = {}));
var animation;
var AnimationCurve;
(function (AnimationCurve) {
    AnimationCurve.ease = "ease";
    AnimationCurve.easeIn = "easeIn";
    AnimationCurve.easeOut = "easeOut";
    AnimationCurve.easeInOut = "easeInOut";
    AnimationCurve.linear = "linear";
    AnimationCurve.spring = "spring";
    function cubicBezier(x1, y1, x2, y2) {
        animation = animation || __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
        return new animation.CubicBezierAnimationCurve(x1, y1, x2, y2);
    }
    AnimationCurve.cubicBezier = cubicBezier;
})(AnimationCurve = exports.AnimationCurve || (exports.AnimationCurve = {}));
var StatusBarStyle;
(function (StatusBarStyle) {
    StatusBarStyle.light = "light";
    StatusBarStyle.dark = "dark";
})(StatusBarStyle = exports.StatusBarStyle || (exports.StatusBarStyle = {}));
//# sourceMappingURL=enums.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/activity.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var globals = __webpack_require__("../node_modules/tns-core-modules/globals/globals.js");
var appModule = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
if (global.__snapshot) {
    globals.install();
}
var NativeScriptActivity = (function (_super) {
    __extends(NativeScriptActivity, _super);
    function NativeScriptActivity() {
        var _this = _super.call(this) || this;
        return global.__native(_this);
    }
    NativeScriptActivity.prototype.onCreate = function (savedInstanceState) {
        appModule.android.init(this.getApplication());
        this.isNativeScriptActivity = true;
        if (!this._callbacks) {
            frame_1.setActivityCallbacks(this);
        }
        this._callbacks.onCreate(this, savedInstanceState, this.getIntent(), _super.prototype.onCreate);
    };
    NativeScriptActivity.prototype.onNewIntent = function (intent) {
        this._callbacks.onNewIntent(this, intent, _super.prototype.setIntent, _super.prototype.onNewIntent);
    };
    NativeScriptActivity.prototype.onSaveInstanceState = function (outState) {
        this._callbacks.onSaveInstanceState(this, outState, _super.prototype.onSaveInstanceState);
    };
    NativeScriptActivity.prototype.onStart = function () {
        this._callbacks.onStart(this, _super.prototype.onStart);
    };
    NativeScriptActivity.prototype.onStop = function () {
        this._callbacks.onStop(this, _super.prototype.onStop);
    };
    NativeScriptActivity.prototype.onDestroy = function () {
        this._callbacks.onDestroy(this, _super.prototype.onDestroy);
    };
    NativeScriptActivity.prototype.onPostResume = function () {
        this._callbacks.onPostResume(this, _super.prototype.onPostResume);
    };
    NativeScriptActivity.prototype.onBackPressed = function () {
        this._callbacks.onBackPressed(this, _super.prototype.onBackPressed);
    };
    NativeScriptActivity.prototype.onRequestPermissionsResult = function (requestCode, permissions, grantResults) {
        this._callbacks.onRequestPermissionsResult(this, requestCode, permissions, grantResults, undefined);
    };
    NativeScriptActivity.prototype.onActivityResult = function (requestCode, resultCode, data) {
        this._callbacks.onActivityResult(this, requestCode, resultCode, data, _super.prototype.onActivityResult);
    };
    NativeScriptActivity = __decorate([
        JavaProxy("com.tns.NativeScriptActivity")
    ], NativeScriptActivity);
    return NativeScriptActivity;
}(androidx.appcompat.app.AppCompatActivity));
//# sourceMappingURL=activity.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/fragment.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var FragmentClass = (function (_super) {
    __extends(FragmentClass, _super);
    function FragmentClass() {
        var _this = _super.call(this) || this;
        return global.__native(_this);
    }
    FragmentClass.prototype.onHiddenChanged = function (hidden) {
        this._callbacks.onHiddenChanged(this, hidden, _super.prototype.onHiddenChanged);
    };
    FragmentClass.prototype.onCreateAnimator = function (transit, enter, nextAnim) {
        return this._callbacks.onCreateAnimator(this, transit, enter, nextAnim, _super.prototype.onCreateAnimator);
    };
    FragmentClass.prototype.onStop = function () {
        this._callbacks.onStop(this, _super.prototype.onStop);
    };
    FragmentClass.prototype.onCreate = function (savedInstanceState) {
        if (!this._callbacks) {
            frame_1.setFragmentCallbacks(this);
        }
        this.setHasOptionsMenu(true);
        this._callbacks.onCreate(this, savedInstanceState, _super.prototype.onCreate);
    };
    FragmentClass.prototype.onCreateView = function (inflater, container, savedInstanceState) {
        var result = this._callbacks.onCreateView(this, inflater, container, savedInstanceState, _super.prototype.onCreateView);
        return result;
    };
    FragmentClass.prototype.onSaveInstanceState = function (outState) {
        this._callbacks.onSaveInstanceState(this, outState, _super.prototype.onSaveInstanceState);
    };
    FragmentClass.prototype.onDestroyView = function () {
        this._callbacks.onDestroyView(this, _super.prototype.onDestroyView);
    };
    FragmentClass.prototype.onDestroy = function () {
        this._callbacks.onDestroy(this, _super.prototype.onDestroy);
    };
    FragmentClass.prototype.toString = function () {
        var callbacks = this._callbacks;
        if (callbacks) {
            return callbacks.toStringOverride(this, _super.prototype.toString);
        }
        else {
            _super.prototype.toString.call(this);
        }
    };
    FragmentClass = __decorate([
        JavaProxy("com.tns.FragmentClass")
    ], FragmentClass);
    return FragmentClass;
}(org.nativescript.widgets.FragmentBase));
frame_1.setFragmentClass(FragmentClass);
//# sourceMappingURL=fragment.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/fragment.transitions.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var frame_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-common.js");
var transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/transition.js");
var slide_transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/slide-transition.js");
var fade_transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/fade-transition.js");
var flip_transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/flip-transition.js");
var animation_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var sdkVersion = lazy_1.default(function () { return parseInt(platform_1.device.sdkVersion); });
var intEvaluator = lazy_1.default(function () { return new android.animation.IntEvaluator(); });
var defaultInterpolator = lazy_1.default(function () { return new android.view.animation.AccelerateDecelerateInterpolator(); });
exports.waitingQueue = new Map();
exports.completedEntries = new Map();
var TransitionListener;
var AnimationListener;
function _setAndroidFragmentTransitions(animated, navigationTransition, currentEntry, newEntry, fragmentTransaction, frameId) {
    var currentFragment = currentEntry ? currentEntry.fragment : null;
    var newFragment = newEntry.fragment;
    var entries = exports.waitingQueue.get(frameId);
    if (entries && entries.size > 0) {
        throw new Error("Calling navigation before previous navigation finish.");
    }
    if (sdkVersion() >= 21) {
        allowTransitionOverlap(currentFragment);
        allowTransitionOverlap(newFragment);
    }
    var name = "";
    var transition;
    if (navigationTransition) {
        transition = navigationTransition.instance;
        name = navigationTransition.name ? navigationTransition.name.toLowerCase() : "";
    }
    var useLollipopTransition = !!(name && (name.indexOf("slide") === 0 || name === "fade" || name === "explode") && sdkVersion() >= 21);
    if (currentFragment &&
        currentFragment.getChildFragmentManager() &&
        currentFragment.getChildFragmentManager().getFragments().toArray().length > 0) {
        useLollipopTransition = false;
    }
    newEntry.useLollipopTransition = useLollipopTransition;
    if (!animated) {
        name = "none";
    }
    else if (transition) {
        name = "custom";
        useLollipopTransition = false;
    }
    else if (!useLollipopTransition && name.indexOf("slide") !== 0 && name !== "fade" && name.indexOf("flip") !== 0) {
        name = "default";
    }
    var currentFragmentNeedsDifferentAnimation = false;
    if (currentEntry) {
        _updateTransitions(currentEntry);
        if (currentEntry.transitionName !== name ||
            currentEntry.transition !== transition ||
            !!currentEntry.useLollipopTransition !== useLollipopTransition ||
            !useLollipopTransition) {
            clearExitAndReenterTransitions(currentEntry, true);
            currentFragmentNeedsDifferentAnimation = true;
        }
    }
    if (name === "none") {
        transition = new NoTransition(0, null);
    }
    else if (name === "default") {
        transition = new fade_transition_1.FadeTransition(150, null);
    }
    else if (useLollipopTransition) {
        if (name.indexOf("slide") === 0) {
            setupNewFragmentSlideTransition(navigationTransition, newEntry, name);
            if (currentFragmentNeedsDifferentAnimation) {
                setupCurrentFragmentSlideTransition(navigationTransition, currentEntry, name);
            }
        }
        else if (name === "fade") {
            setupNewFragmentFadeTransition(navigationTransition, newEntry);
            if (currentFragmentNeedsDifferentAnimation) {
                setupCurrentFragmentFadeTransition(navigationTransition, currentEntry);
            }
        }
        else if (name === "explode") {
            setupNewFragmentExplodeTransition(navigationTransition, newEntry);
            if (currentFragmentNeedsDifferentAnimation) {
                setupCurrentFragmentExplodeTransition(navigationTransition, currentEntry);
            }
        }
    }
    else if (name.indexOf("slide") === 0) {
        var direction = name.substr("slide".length) || "left";
        transition = new slide_transition_1.SlideTransition(direction, navigationTransition.duration, navigationTransition.curve);
    }
    else if (name === "fade") {
        transition = new fade_transition_1.FadeTransition(navigationTransition.duration, navigationTransition.curve);
    }
    else if (name.indexOf("flip") === 0) {
        var direction = name.substr("flip".length) || "right";
        transition = new flip_transition_1.FlipTransition(direction, navigationTransition.duration, navigationTransition.curve);
    }
    newEntry.transitionName = name;
    if (name === "custom") {
        newEntry.transition = transition;
    }
    if (transition) {
        if (fragmentTransaction) {
            fragmentTransaction.setCustomAnimations(-10, -20);
        }
        setupAllAnimation(newEntry, transition);
        if (currentFragmentNeedsDifferentAnimation) {
            setupExitAndPopEnterAnimation(currentEntry, transition);
        }
    }
    if (currentEntry) {
        currentEntry.transitionName = name;
        if (name === "custom") {
            currentEntry.transition = transition;
        }
    }
    setupDefaultAnimations(newEntry, new fade_transition_1.FadeTransition(150, null));
    printTransitions(currentEntry);
    printTransitions(newEntry);
}
exports._setAndroidFragmentTransitions = _setAndroidFragmentTransitions;
function _onFragmentCreateAnimator(entry, fragment, nextAnim, enter) {
    var animator;
    switch (nextAnim) {
        case -10:
            animator = entry.enterAnimator || entry.defaultEnterAnimator;
            break;
        case -20:
            animator = entry.exitAnimator || entry.defaultExitAnimator;
            break;
        case -30:
            animator = entry.popEnterAnimator;
            break;
        case -40:
            animator = entry.popExitAnimator;
            break;
    }
    if (!animator && sdkVersion() >= 21) {
        var view = fragment.getView();
        var jsParent = entry.resolvedPage.parent;
        var parent_1 = view.getParent() || (jsParent && jsParent.nativeViewProtected);
        var animatedEntries = _getAnimatedEntries(entry.frameId);
        if (!animatedEntries || !animatedEntries.has(entry)) {
            if (parent_1 && !parent_1.isLaidOut()) {
                animator = enter ? entry.defaultEnterAnimator : entry.defaultExitAnimator;
            }
        }
    }
    return animator;
}
exports._onFragmentCreateAnimator = _onFragmentCreateAnimator;
function _getAnimatedEntries(frameId) {
    return exports.waitingQueue.get(frameId);
}
exports._getAnimatedEntries = _getAnimatedEntries;
function _updateTransitions(entry) {
    var fragment = entry.fragment;
    var enterTransitionListener = entry.enterTransitionListener;
    if (enterTransitionListener && fragment) {
        fragment.setEnterTransition(enterTransitionListener.transition);
    }
    var exitTransitionListener = entry.exitTransitionListener;
    if (exitTransitionListener && fragment) {
        fragment.setExitTransition(exitTransitionListener.transition);
    }
    var reenterTransitionListener = entry.reenterTransitionListener;
    if (reenterTransitionListener && fragment) {
        fragment.setReenterTransition(reenterTransitionListener.transition);
    }
    var returnTransitionListener = entry.returnTransitionListener;
    if (returnTransitionListener && fragment) {
        fragment.setReturnTransition(returnTransitionListener.transition);
    }
}
exports._updateTransitions = _updateTransitions;
function _reverseTransitions(previousEntry, currentEntry) {
    var previousFragment = previousEntry.fragment;
    var currentFragment = currentEntry.fragment;
    var transitionUsed = false;
    if (sdkVersion() >= 21) {
        var returnTransitionListener = currentEntry.returnTransitionListener;
        if (returnTransitionListener) {
            transitionUsed = true;
            currentFragment.setExitTransition(returnTransitionListener.transition);
        }
        else {
            currentFragment.setExitTransition(null);
        }
        var reenterTransitionListener = previousEntry.reenterTransitionListener;
        if (reenterTransitionListener) {
            transitionUsed = true;
            previousFragment.setEnterTransition(reenterTransitionListener.transition);
        }
        else {
            previousFragment.setEnterTransition(null);
        }
    }
    return transitionUsed;
}
exports._reverseTransitions = _reverseTransitions;
function getTransitionListener(entry, transition) {
    if (!TransitionListener) {
        var TransitionListenerImpl = (function (_super) {
            __extends(TransitionListenerImpl, _super);
            function TransitionListenerImpl(entry, transition) {
                var _this = _super.call(this) || this;
                _this.entry = entry;
                _this.transition = transition;
                return global.__native(_this);
            }
            TransitionListenerImpl.prototype.onTransitionStart = function (transition) {
                var entry = this.entry;
                addToWaitingQueue(entry);
                if (trace_1.isEnabled()) {
                    trace_1.write("START " + toShortString(transition) + " transition for " + entry.fragmentTag, trace_1.categories.Transition);
                }
            };
            TransitionListenerImpl.prototype.onTransitionEnd = function (transition) {
                var entry = this.entry;
                if (trace_1.isEnabled()) {
                    trace_1.write("END " + toShortString(transition) + " transition for " + entry.fragmentTag, trace_1.categories.Transition);
                }
                transitionOrAnimationCompleted(entry);
            };
            TransitionListenerImpl.prototype.onTransitionResume = function (transition) {
                if (trace_1.isEnabled()) {
                    var fragment = this.entry.fragmentTag;
                    trace_1.write("RESUME " + toShortString(transition) + " transition for " + fragment, trace_1.categories.Transition);
                }
            };
            TransitionListenerImpl.prototype.onTransitionPause = function (transition) {
                if (trace_1.isEnabled()) {
                    trace_1.write("PAUSE " + toShortString(transition) + " transition for " + this.entry.fragmentTag, trace_1.categories.Transition);
                }
            };
            TransitionListenerImpl.prototype.onTransitionCancel = function (transition) {
                if (trace_1.isEnabled()) {
                    trace_1.write("CANCEL " + toShortString(transition) + " transition for " + this.entry.fragmentTag, trace_1.categories.Transition);
                }
            };
            TransitionListenerImpl = __decorate([
                Interfaces([android.transition.Transition.TransitionListener])
            ], TransitionListenerImpl);
            return TransitionListenerImpl;
        }(java.lang.Object));
        TransitionListener = TransitionListenerImpl;
    }
    return new TransitionListener(entry, transition);
}
function getAnimationListener() {
    if (!AnimationListener) {
        var AnimationListenerImpl = (function (_super) {
            __extends(AnimationListenerImpl, _super);
            function AnimationListenerImpl() {
                var _this = _super.call(this) || this;
                return global.__native(_this);
            }
            AnimationListenerImpl.prototype.onAnimationStart = function (animator) {
                var entry = animator.entry;
                addToWaitingQueue(entry);
                if (trace_1.isEnabled()) {
                    trace_1.write("START " + animator.transitionType + " for " + entry.fragmentTag, trace_1.categories.Transition);
                }
            };
            AnimationListenerImpl.prototype.onAnimationRepeat = function (animator) {
                if (trace_1.isEnabled()) {
                    trace_1.write("REPEAT " + animator.transitionType + " for " + animator.entry.fragmentTag, trace_1.categories.Transition);
                }
            };
            AnimationListenerImpl.prototype.onAnimationEnd = function (animator) {
                if (trace_1.isEnabled()) {
                    trace_1.write("END " + animator.transitionType + " for " + animator.entry.fragmentTag, trace_1.categories.Transition);
                }
                transitionOrAnimationCompleted(animator.entry);
            };
            AnimationListenerImpl.prototype.onAnimationCancel = function (animator) {
                if (trace_1.isEnabled()) {
                    trace_1.write("CANCEL " + animator.transitionType + " for " + animator.entry.fragmentTag, trace_1.categories.Transition);
                }
            };
            AnimationListenerImpl = __decorate([
                Interfaces([android.animation.Animator.AnimatorListener])
            ], AnimationListenerImpl);
            return AnimationListenerImpl;
        }(java.lang.Object));
        AnimationListener = new AnimationListenerImpl();
    }
    return AnimationListener;
}
function addToWaitingQueue(entry) {
    var frameId = entry.frameId;
    var entries = exports.waitingQueue.get(frameId);
    if (!entries) {
        entries = new Set();
        exports.waitingQueue.set(frameId, entries);
    }
    entries.add(entry);
}
function clearAnimationListener(animator, listener) {
    if (!animator) {
        return;
    }
    animator.removeListener(listener);
    if (animator.entry && trace_1.isEnabled()) {
        var entry = animator.entry;
        trace_1.write("Clear " + animator.transitionType + " - " + entry.transition + " for " + entry.fragmentTag, trace_1.categories.Transition);
    }
    animator.entry = null;
}
function clearExitAndReenterTransitions(entry, removeListener) {
    if (sdkVersion() >= 21) {
        var fragment = entry.fragment;
        var exitListener = entry.exitTransitionListener;
        if (exitListener) {
            var exitTransition = fragment.getExitTransition();
            if (exitTransition) {
                if (removeListener) {
                    exitTransition.removeListener(exitListener);
                }
                fragment.setExitTransition(null);
                if (trace_1.isEnabled()) {
                    trace_1.write("Cleared Exit " + exitTransition.getClass().getSimpleName() + " transition for " + fragment, trace_1.categories.Transition);
                }
            }
            if (removeListener) {
                entry.exitTransitionListener = null;
            }
        }
        var reenterListener = entry.reenterTransitionListener;
        if (reenterListener) {
            var reenterTransition = fragment.getReenterTransition();
            if (reenterTransition) {
                if (removeListener) {
                    reenterTransition.removeListener(reenterListener);
                }
                fragment.setReenterTransition(null);
                if (trace_1.isEnabled()) {
                    trace_1.write("Cleared Reenter " + reenterTransition.getClass().getSimpleName() + " transition for " + fragment, trace_1.categories.Transition);
                }
            }
            if (removeListener) {
                entry.reenterTransitionListener = null;
            }
        }
    }
}
function _clearFragment(entry) {
    clearEntry(entry, false);
}
exports._clearFragment = _clearFragment;
function _clearEntry(entry) {
    clearEntry(entry, true);
}
exports._clearEntry = _clearEntry;
function clearEntry(entry, removeListener) {
    clearExitAndReenterTransitions(entry, removeListener);
    if (sdkVersion() >= 21) {
        var fragment = entry.fragment;
        var enterListener = entry.enterTransitionListener;
        if (enterListener) {
            var enterTransition = fragment.getEnterTransition();
            if (enterTransition) {
                if (removeListener) {
                    enterTransition.removeListener(enterListener);
                }
                fragment.setEnterTransition(null);
                if (trace_1.isEnabled()) {
                    trace_1.write("Cleared Enter " + enterTransition.getClass().getSimpleName() + " transition for " + fragment, trace_1.categories.Transition);
                }
            }
            if (removeListener) {
                entry.enterTransitionListener = null;
            }
        }
        var returnListener = entry.returnTransitionListener;
        if (returnListener) {
            var returnTransition = fragment.getReturnTransition();
            if (returnTransition) {
                if (removeListener) {
                    returnTransition.removeListener(returnListener);
                }
                fragment.setReturnTransition(null);
                if (trace_1.isEnabled()) {
                    trace_1.write("Cleared Return " + returnTransition.getClass().getSimpleName() + " transition for " + fragment, trace_1.categories.Transition);
                }
            }
            if (removeListener) {
                entry.returnTransitionListener = null;
            }
        }
    }
    if (removeListener) {
        var listener = getAnimationListener();
        clearAnimationListener(entry.enterAnimator, listener);
        clearAnimationListener(entry.exitAnimator, listener);
        clearAnimationListener(entry.popEnterAnimator, listener);
        clearAnimationListener(entry.popExitAnimator, listener);
        clearAnimationListener(entry.defaultEnterAnimator, listener);
        clearAnimationListener(entry.defaultExitAnimator, listener);
    }
}
function allowTransitionOverlap(fragment) {
    if (fragment) {
        fragment.setAllowEnterTransitionOverlap(true);
        fragment.setAllowReturnTransitionOverlap(true);
    }
}
function setEnterTransition(navigationTransition, entry, transition) {
    setUpNativeTransition(navigationTransition, transition);
    var listener = addNativeTransitionListener(entry, transition);
    entry.enterTransitionListener = listener;
    var fragment = entry.fragment;
    fragment.setEnterTransition(transition);
}
function setExitTransition(navigationTransition, entry, transition) {
    setUpNativeTransition(navigationTransition, transition);
    var listener = addNativeTransitionListener(entry, transition);
    entry.exitTransitionListener = listener;
    var fragment = entry.fragment;
    fragment.setExitTransition(transition);
}
function setReenterTransition(navigationTransition, entry, transition) {
    setUpNativeTransition(navigationTransition, transition);
    var listener = addNativeTransitionListener(entry, transition);
    entry.reenterTransitionListener = listener;
    var fragment = entry.fragment;
    fragment.setReenterTransition(transition);
}
function setReturnTransition(navigationTransition, entry, transition) {
    setUpNativeTransition(navigationTransition, transition);
    var listener = addNativeTransitionListener(entry, transition);
    entry.returnTransitionListener = listener;
    var fragment = entry.fragment;
    fragment.setReturnTransition(transition);
}
function setupNewFragmentSlideTransition(navTransition, entry, name) {
    setupCurrentFragmentSlideTransition(navTransition, entry, name);
    var direction = name.substr("slide".length) || "left";
    switch (direction) {
        case "left":
            setEnterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.RIGHT));
            setReturnTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.RIGHT));
            break;
        case "right":
            setEnterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.LEFT));
            setReturnTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.LEFT));
            break;
        case "top":
            setEnterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.BOTTOM));
            setReturnTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.BOTTOM));
            break;
        case "bottom":
            setEnterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.TOP));
            setReturnTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.TOP));
            break;
    }
}
function setupCurrentFragmentSlideTransition(navTransition, entry, name) {
    var direction = name.substr("slide".length) || "left";
    switch (direction) {
        case "left":
            setExitTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.LEFT));
            setReenterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.LEFT));
            break;
        case "right":
            setExitTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.RIGHT));
            setReenterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.RIGHT));
            break;
        case "top":
            setExitTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.TOP));
            setReenterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.TOP));
            break;
        case "bottom":
            setExitTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.BOTTOM));
            setReenterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.BOTTOM));
            break;
    }
}
function setupNewFragmentFadeTransition(navTransition, entry) {
    setupCurrentFragmentFadeTransition(navTransition, entry);
    var fadeInEnter = new android.transition.Fade(android.transition.Fade.IN);
    setEnterTransition(navTransition, entry, fadeInEnter);
    var fadeOutReturn = new android.transition.Fade(android.transition.Fade.OUT);
    setReturnTransition(navTransition, entry, fadeOutReturn);
}
function setupCurrentFragmentFadeTransition(navTransition, entry) {
    var fadeOutExit = new android.transition.Fade(android.transition.Fade.OUT);
    setExitTransition(navTransition, entry, fadeOutExit);
    var fadeInReenter = new android.transition.Fade(android.transition.Fade.IN);
    setReenterTransition(navTransition, entry, fadeInReenter);
}
function setupCurrentFragmentExplodeTransition(navTransition, entry) {
    setExitTransition(navTransition, entry, new android.transition.Explode());
    setReenterTransition(navTransition, entry, new android.transition.Explode());
}
function setupNewFragmentExplodeTransition(navTransition, entry) {
    setupCurrentFragmentExplodeTransition(navTransition, entry);
    setEnterTransition(navTransition, entry, new android.transition.Explode());
    setReturnTransition(navTransition, entry, new android.transition.Explode());
}
function setupExitAndPopEnterAnimation(entry, transition) {
    var listener = getAnimationListener();
    clearAnimationListener(entry.exitAnimator, listener);
    clearAnimationListener(entry.popEnterAnimator, listener);
    var exitAnimator = transition.createAndroidAnimator(transition_1.AndroidTransitionType.exit);
    exitAnimator.transitionType = transition_1.AndroidTransitionType.exit;
    exitAnimator.entry = entry;
    exitAnimator.addListener(listener);
    entry.exitAnimator = exitAnimator;
    var popEnterAnimator = transition.createAndroidAnimator(transition_1.AndroidTransitionType.popEnter);
    popEnterAnimator.transitionType = transition_1.AndroidTransitionType.popEnter;
    popEnterAnimator.entry = entry;
    popEnterAnimator.addListener(listener);
    entry.popEnterAnimator = popEnterAnimator;
}
function setupAllAnimation(entry, transition) {
    setupExitAndPopEnterAnimation(entry, transition);
    var listener = getAnimationListener();
    var enterAnimator = transition.createAndroidAnimator(transition_1.AndroidTransitionType.enter);
    enterAnimator.transitionType = transition_1.AndroidTransitionType.enter;
    enterAnimator.entry = entry;
    enterAnimator.addListener(listener);
    entry.enterAnimator = enterAnimator;
    var popExitAnimator = transition.createAndroidAnimator(transition_1.AndroidTransitionType.popExit);
    popExitAnimator.transitionType = transition_1.AndroidTransitionType.popExit;
    popExitAnimator.entry = entry;
    popExitAnimator.addListener(listener);
    entry.popExitAnimator = popExitAnimator;
}
function setupDefaultAnimations(entry, transition) {
    var listener = getAnimationListener();
    var enterAnimator = transition.createAndroidAnimator(transition_1.AndroidTransitionType.enter);
    enterAnimator.transitionType = transition_1.AndroidTransitionType.enter;
    enterAnimator.entry = entry;
    enterAnimator.addListener(listener);
    entry.defaultEnterAnimator = enterAnimator;
    var exitAnimator = transition.createAndroidAnimator(transition_1.AndroidTransitionType.exit);
    exitAnimator.transitionType = transition_1.AndroidTransitionType.exit;
    exitAnimator.entry = entry;
    exitAnimator.addListener(listener);
    entry.defaultExitAnimator = exitAnimator;
}
function setUpNativeTransition(navigationTransition, nativeTransition) {
    if (navigationTransition.duration) {
        nativeTransition.setDuration(navigationTransition.duration);
    }
    var interpolator = navigationTransition.curve ? animation_1._resolveAnimationCurve(navigationTransition.curve) : defaultInterpolator();
    nativeTransition.setInterpolator(interpolator);
}
function addNativeTransitionListener(entry, nativeTransition) {
    var listener = getTransitionListener(entry, nativeTransition);
    nativeTransition.addListener(listener);
    return listener;
}
function transitionOrAnimationCompleted(entry) {
    var frameId = entry.frameId;
    var entries = exports.waitingQueue.get(frameId);
    if (!entries) {
        return;
    }
    entries.delete(entry);
    if (entries.size === 0) {
        var frame_1 = entry.resolvedPage.frame;
        var previousCompletedAnimationEntry = exports.completedEntries.get(frameId);
        exports.completedEntries.delete(frameId);
        exports.waitingQueue.delete(frameId);
        var navigationContext_1 = frame_1._executingContext || { navigationType: frame_common_1.NavigationType.back };
        var current_1 = frame_1.isCurrent(entry) ? previousCompletedAnimationEntry : entry;
        current_1 = current_1 || entry;
        if (current_1) {
            setTimeout(function () { return frame_1.setCurrent(current_1, navigationContext_1.navigationType); });
        }
    }
    else {
        exports.completedEntries.set(frameId, entry);
    }
}
function toShortString(nativeTransition) {
    return nativeTransition.getClass().getSimpleName() + "@" + nativeTransition.hashCode().toString(16);
}
function printTransitions(entry) {
    if (entry && trace_1.isEnabled()) {
        var result = entry.fragmentTag + " Transitions:";
        if (entry.transitionName) {
            result += "transitionName=" + entry.transitionName + ", ";
        }
        if (entry.transition) {
            result += "enterAnimator=" + entry.enterAnimator + ", ";
            result += "exitAnimator=" + entry.exitAnimator + ", ";
            result += "popEnterAnimator=" + entry.popEnterAnimator + ", ";
            result += "popExitAnimator=" + entry.popExitAnimator + ", ";
        }
        if (sdkVersion() >= 21) {
            var fragment = entry.fragment;
            result += "" + (fragment.getEnterTransition() ? " enter=" + toShortString(fragment.getEnterTransition()) : "");
            result += "" + (fragment.getExitTransition() ? " exit=" + toShortString(fragment.getExitTransition()) : "");
            result += "" + (fragment.getReenterTransition() ? " popEnter=" + toShortString(fragment.getReenterTransition()) : "");
            result += "" + (fragment.getReturnTransition() ? " popExit=" + toShortString(fragment.getReturnTransition()) : "");
        }
        trace_1.write(result, trace_1.categories.Transition);
    }
}
function javaObjectArray() {
    var params = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        params[_i] = arguments[_i];
    }
    var nativeArray = Array.create(java.lang.Object, params.length);
    params.forEach(function (value, i) { return nativeArray[i] = value; });
    return nativeArray;
}
function createDummyZeroDurationAnimator() {
    var animator = android.animation.ValueAnimator.ofObject(intEvaluator(), javaObjectArray(java.lang.Integer.valueOf(0), java.lang.Integer.valueOf(1)));
    animator.setDuration(1);
    return animator;
}
var NoTransition = (function (_super) {
    __extends(NoTransition, _super);
    function NoTransition() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    NoTransition.prototype.createAndroidAnimator = function (transitionType) {
        return createDummyZeroDurationAnimator();
    };
    return NoTransition;
}(transition_1.Transition));
//# sourceMappingURL=fragment.transitions.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/frame-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view-common.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var frame_stack_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-stack.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var NavigationType;
(function (NavigationType) {
    NavigationType[NavigationType["back"] = 0] = "back";
    NavigationType[NavigationType["forward"] = 1] = "forward";
    NavigationType[NavigationType["replace"] = 2] = "replace";
})(NavigationType = exports.NavigationType || (exports.NavigationType = {}));
function buildEntryFromArgs(arg) {
    var entry;
    if (typeof arg === "string") {
        entry = {
            moduleName: arg
        };
    }
    else if (typeof arg === "function") {
        entry = {
            create: arg
        };
    }
    else {
        entry = arg;
    }
    return entry;
}
var FrameBase = (function (_super) {
    __extends(FrameBase, _super);
    function FrameBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._backStack = new Array();
        _this._navigationQueue = new Array();
        _this._isInFrameStack = false;
        return _this;
    }
    FrameBase_1 = FrameBase;
    FrameBase.prototype._addChildFromBuilder = function (name, value) {
        throw new Error("Frame should not have a view. Use 'defaultPage' property instead.");
    };
    FrameBase.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this._processNextNavigationEntry();
    };
    FrameBase.prototype.canGoBack = function () {
        var _this = this;
        var backstack = this._backStack.length;
        var previousForwardNotInBackstack = false;
        this._navigationQueue.forEach(function (item) {
            var entry = item.entry;
            var isBackNavigation = item.navigationType === NavigationType.back;
            if (isBackNavigation) {
                previousForwardNotInBackstack = false;
                if (!entry) {
                    backstack--;
                }
                else {
                    var backstackIndex = _this._backStack.indexOf(entry);
                    if (backstackIndex !== -1) {
                        backstack = backstackIndex;
                    }
                    else {
                        backstack--;
                    }
                }
            }
            else if (entry.entry.clearHistory) {
                previousForwardNotInBackstack = false;
                backstack = 0;
            }
            else {
                backstack++;
                if (previousForwardNotInBackstack) {
                    backstack--;
                }
                previousForwardNotInBackstack = entry.entry.backstackVisible === false;
            }
        });
        if (this._navigationQueue.length > 0 && !this._currentEntry) {
            backstack--;
        }
        return backstack > 0;
    };
    FrameBase.prototype.goBack = function (backstackEntry) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("GO BACK", view_1.traceCategories.Navigation);
        }
        if (!this.canGoBack()) {
            return;
        }
        if (backstackEntry) {
            var index_1 = this._backStack.indexOf(backstackEntry);
            if (index_1 < 0) {
                return;
            }
        }
        var navigationContext = {
            entry: backstackEntry,
            isBackNavigation: true,
            navigationType: NavigationType.back
        };
        this._navigationQueue.push(navigationContext);
        this._processNextNavigationEntry();
    };
    FrameBase.prototype._removeEntry = function (removed) {
        var page = removed.resolvedPage;
        var frame = page.frame;
        page._frame = null;
        if (frame) {
            frame._removeView(page);
        }
        else {
            page._tearDownUI(true);
        }
        removed.resolvedPage = null;
    };
    FrameBase.prototype.navigate = function (param) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("NAVIGATE", view_1.traceCategories.Navigation);
        }
        var entry = buildEntryFromArgs(param);
        var page = builder_1.createViewFromEntry(entry);
        this._pushInFrameStack();
        var backstackEntry = {
            entry: entry,
            resolvedPage: page,
            navDepth: undefined,
            fragmentTag: undefined
        };
        var navigationContext = {
            entry: backstackEntry,
            isBackNavigation: false,
            navigationType: NavigationType.forward
        };
        this._navigationQueue.push(navigationContext);
        this._processNextNavigationEntry();
    };
    FrameBase.prototype.isCurrent = function (entry) {
        return this._currentEntry === entry;
    };
    FrameBase.prototype.setCurrent = function (entry, navigationType) {
        var newPage = entry.resolvedPage;
        if (!newPage.frame) {
            this._addView(newPage);
            newPage._frame = this;
        }
        this._currentEntry = entry;
        var isBack = navigationType === NavigationType.back;
        if (isBack) {
            this._pushInFrameStack();
        }
        newPage.onNavigatedTo(isBack);
        this._executingContext = null;
    };
    FrameBase.prototype._updateBackstack = function (entry, navigationType) {
        var _this = this;
        var isBack = navigationType === NavigationType.back;
        var isReplace = navigationType === NavigationType.replace;
        this.raiseCurrentPageNavigatedEvents(isBack);
        var current = this._currentEntry;
        if (isBack) {
            var index_2 = this._backStack.indexOf(entry);
            this._backStack.splice(index_2 + 1).forEach(function (e) { return _this._removeEntry(e); });
            this._backStack.pop();
        }
        else if (!isReplace) {
            if (entry.entry.clearHistory) {
                this._backStack.forEach(function (e) { return _this._removeEntry(e); });
                this._backStack.length = 0;
            }
            else if (FrameBase_1._isEntryBackstackVisible(current)) {
                this._backStack.push(current);
            }
        }
        if (current && this._backStack.indexOf(current) < 0) {
            this._removeEntry(current);
        }
    };
    FrameBase.prototype.isNestedWithin = function (parentFrameCandidate) {
        var frameAncestor = this;
        while (frameAncestor) {
            frameAncestor = view_common_1.getAncestor(frameAncestor, FrameBase_1);
            if (frameAncestor === parentFrameCandidate) {
                return true;
            }
        }
        return false;
    };
    FrameBase.prototype.raiseCurrentPageNavigatedEvents = function (isBack) {
        var page = this.currentPage;
        if (page) {
            if (page.isLoaded) {
                page.callUnloaded();
            }
            page.onNavigatedFrom(isBack);
        }
    };
    FrameBase.prototype._processNavigationQueue = function (page) {
        if (this._navigationQueue.length === 0) {
            return;
        }
        var entry = this._navigationQueue[0].entry;
        var currentNavigationPage = entry.resolvedPage;
        if (page !== currentNavigationPage) {
            return;
        }
        this._navigationQueue.shift();
        this._processNextNavigationEntry();
        this._updateActionBar();
    };
    FrameBase.prototype._findEntryForTag = function (fragmentTag) {
        var entry;
        if (this._currentEntry && this._currentEntry.fragmentTag === fragmentTag) {
            entry = this._currentEntry;
        }
        else {
            entry = this._backStack.find(function (value) { return value.fragmentTag === fragmentTag; });
            if (!entry) {
                var navigationItem = this._navigationQueue.find(function (value) { return value.entry.fragmentTag === fragmentTag; });
                entry = navigationItem ? navigationItem.entry : undefined;
            }
        }
        return entry;
    };
    FrameBase.prototype.navigationQueueIsEmpty = function () {
        return this._navigationQueue.length === 0;
    };
    FrameBase._isEntryBackstackVisible = function (entry) {
        if (!entry) {
            return false;
        }
        var backstackVisibleValue = entry.entry.backstackVisible;
        var backstackHidden = backstackVisibleValue !== undefined && !backstackVisibleValue;
        return !backstackHidden;
    };
    FrameBase.prototype._updateActionBar = function (page, disableNavBarAnimation) {
    };
    FrameBase.prototype._processNextNavigationEntry = function () {
        if (!this.isLoaded || this._executingContext) {
            return;
        }
        if (this._navigationQueue.length > 0) {
            var navigationContext = this._navigationQueue[0];
            var isBackNavigation = navigationContext.navigationType === NavigationType.back;
            if (isBackNavigation) {
                this.performGoBack(navigationContext);
            }
            else {
                this.performNavigation(navigationContext);
            }
        }
    };
    FrameBase.prototype.performNavigation = function (navigationContext) {
        this._executingContext = navigationContext;
        var backstackEntry = navigationContext.entry;
        var isBackNavigation = navigationContext.navigationType === NavigationType.back;
        this._onNavigatingTo(backstackEntry, isBackNavigation);
        this._navigateCore(backstackEntry);
    };
    FrameBase.prototype.performGoBack = function (navigationContext) {
        var backstackEntry = navigationContext.entry;
        var backstack = this._backStack;
        if (!backstackEntry) {
            backstackEntry = backstack[backstack.length - 1];
            navigationContext.entry = backstackEntry;
        }
        this._executingContext = navigationContext;
        this._onNavigatingTo(backstackEntry, true);
        this._goBackCore(backstackEntry);
    };
    FrameBase.prototype._goBackCore = function (backstackEntry) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("GO BACK CORE(" + this._backstackEntryTrace(backstackEntry) + "); currentPage: " + this.currentPage, view_1.traceCategories.Navigation);
        }
    };
    FrameBase.prototype._navigateCore = function (backstackEntry) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("NAVIGATE CORE(" + this._backstackEntryTrace(backstackEntry) + "); currentPage: " + this.currentPage, view_1.traceCategories.Navigation);
        }
    };
    FrameBase.prototype._onNavigatingTo = function (backstackEntry, isBack) {
        if (this.currentPage) {
            this.currentPage.onNavigatingFrom(isBack);
        }
        backstackEntry.resolvedPage.onNavigatingTo(backstackEntry.entry.context, isBack, backstackEntry.entry.bindingContext);
    };
    Object.defineProperty(FrameBase.prototype, "animated", {
        get: function () {
            return this._animated;
        },
        set: function (value) {
            this._animated = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "transition", {
        get: function () {
            return this._transition;
        },
        set: function (value) {
            this._transition = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "backStack", {
        get: function () {
            return this._backStack.slice();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "currentPage", {
        get: function () {
            if (this._currentEntry) {
                return this._currentEntry.resolvedPage;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "currentEntry", {
        get: function () {
            if (this._currentEntry) {
                return this._currentEntry.entry;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    FrameBase.prototype._pushInFrameStackRecursive = function () {
        this._pushInFrameStack();
        var framesToPush = [];
        for (var _i = 0, frameStack_1 = frame_stack_1.frameStack; _i < frameStack_1.length; _i++) {
            var frame = frameStack_1[_i];
            if (frame.isNestedWithin(this)) {
                framesToPush.push(frame);
            }
        }
        for (var _a = 0, framesToPush_1 = framesToPush; _a < framesToPush_1.length; _a++) {
            var frame = framesToPush_1[_a];
            frame._pushInFrameStack();
        }
    };
    FrameBase.prototype._pushInFrameStack = function () {
        frame_stack_1._pushInFrameStack(this);
    };
    FrameBase.prototype._popFromFrameStack = function () {
        frame_stack_1._popFromFrameStack(this);
    };
    FrameBase.prototype._removeFromFrameStack = function () {
        frame_stack_1._removeFromFrameStack(this);
    };
    FrameBase.prototype._dialogClosed = function () {
        this._removeFromFrameStack();
    };
    FrameBase.prototype._onRootViewReset = function () {
        _super.prototype._onRootViewReset.call(this);
        this._removeFromFrameStack();
    };
    Object.defineProperty(FrameBase.prototype, "_childrenCount", {
        get: function () {
            if (this.currentPage) {
                return 1;
            }
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    FrameBase.prototype.eachChildView = function (callback) {
        var page = this.currentPage;
        if (page) {
            callback(page);
        }
    };
    FrameBase.prototype._getIsAnimatedNavigation = function (entry) {
        if (entry && entry.animated !== undefined) {
            return entry.animated;
        }
        if (this.animated !== undefined) {
            return this.animated;
        }
        return FrameBase_1.defaultAnimatedNavigation;
    };
    FrameBase.prototype._getNavigationTransition = function (entry) {
        if (entry) {
            if (view_1.isIOS && entry.transitioniOS !== undefined) {
                return entry.transitioniOS;
            }
            if (view_1.isAndroid && entry.transitionAndroid !== undefined) {
                return entry.transitionAndroid;
            }
            if (entry.transition !== undefined) {
                return entry.transition;
            }
        }
        if (this.transition !== undefined) {
            return this.transition;
        }
        return FrameBase_1.defaultTransition;
    };
    Object.defineProperty(FrameBase.prototype, "navigationBarHeight", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    FrameBase.prototype._getNavBarVisible = function (page) {
        throw new Error();
    };
    FrameBase.prototype._addViewToNativeVisualTree = function (child) {
        return true;
    };
    FrameBase.prototype._removeViewFromNativeVisualTree = function (child) {
        child._isAddedToNativeVisualTree = false;
    };
    FrameBase.prototype._printFrameBackStack = function () {
        var length = this.backStack.length;
        var i = length - 1;
        console.log("Frame Back Stack: ");
        while (i >= 0) {
            var backstackEntry = this.backStack[i--];
            console.log("\t" + backstackEntry.resolvedPage);
        }
    };
    FrameBase.prototype._backstackEntryTrace = function (b) {
        var result = "" + b.resolvedPage;
        var backstackVisible = FrameBase_1._isEntryBackstackVisible(b);
        if (!backstackVisible) {
            result += " | INVISIBLE";
        }
        if (b.entry.clearHistory) {
            result += " | CLEAR HISTORY";
        }
        var animated = this._getIsAnimatedNavigation(b.entry);
        if (!animated) {
            result += " | NOT ANIMATED";
        }
        var t = this._getNavigationTransition(b.entry);
        if (t) {
            result += " | Transition[" + JSON.stringify(t) + "]";
        }
        return result;
    };
    FrameBase.prototype._onLivesync = function (context) {
        if (_super.prototype._onLivesync.call(this, context)) {
            return true;
        }
        if (!context) {
            return this.legacyLivesync();
        }
        return false;
    };
    FrameBase.prototype._handleLivesync = function (context) {
        if (_super.prototype._handleLivesync.call(this, context)) {
            return true;
        }
        if (this.currentPage &&
            view_common_1.viewMatchesModuleContext(this.currentPage, context, ["markup", "script"])) {
            view_1.traceWrite("Change Handled: Replacing page " + context.path, view_1.traceCategories.Livesync);
            this.replacePage(context.path);
            return true;
        }
        return false;
    };
    FrameBase.prototype.legacyLivesync = function () {
        if (view_1.traceEnabled()) {
            view_1.traceWrite(this + "._onLivesync()", view_1.traceCategories.Livesync);
        }
        if (!this._currentEntry || !this._currentEntry.entry) {
            return false;
        }
        var currentEntry = this._currentEntry.entry;
        var newEntry = {
            animated: false,
            clearHistory: true,
            context: currentEntry.context,
            create: currentEntry.create,
            moduleName: currentEntry.moduleName,
            backstackVisible: currentEntry.backstackVisible
        };
        if (newEntry.create) {
            var page = newEntry.create();
            if (page === this.currentPage) {
                return false;
            }
        }
        this.navigate(newEntry);
        return true;
    };
    FrameBase.prototype.replacePage = function (pagePath) {
        var currentBackstackEntry = this._currentEntry;
        var contextModuleName = module_name_sanitizer_1.sanitizeModuleName(pagePath);
        var newPage = builder_1.createViewFromEntry({ moduleName: contextModuleName });
        var newBackstackEntry = {
            entry: currentBackstackEntry.entry,
            resolvedPage: newPage,
            navDepth: currentBackstackEntry.navDepth,
            fragmentTag: currentBackstackEntry.fragmentTag,
            frameId: currentBackstackEntry.frameId
        };
        var navigationContext = {
            entry: newBackstackEntry,
            isBackNavigation: false,
            navigationType: NavigationType.replace
        };
        this._navigationQueue.push(navigationContext);
        this._processNextNavigationEntry();
    };
    var FrameBase_1;
    FrameBase.androidOptionSelectedEvent = "optionSelected";
    FrameBase.defaultAnimatedNavigation = true;
    __decorate([
        profiling_1.profile
    ], FrameBase.prototype, "onLoaded", null);
    __decorate([
        profiling_1.profile
    ], FrameBase.prototype, "performNavigation", null);
    __decorate([
        profiling_1.profile
    ], FrameBase.prototype, "performGoBack", null);
    FrameBase = FrameBase_1 = __decorate([
        view_1.CSSType("Frame")
    ], FrameBase);
    return FrameBase;
}(view_1.CustomLayoutView));
exports.FrameBase = FrameBase;
function getFrameById(id) {
    return frame_stack_1.frameStack.find(function (frame) { return frame.id && frame.id === id; });
}
exports.getFrameById = getFrameById;
function topmost() {
    return frame_stack_1.topmost();
}
exports.topmost = topmost;
function goBack() {
    var top = topmost();
    if (top && top.canGoBack()) {
        top.goBack();
        return true;
    }
    else if (top) {
        var parentFrameCanGoBack = false;
        var parentFrame = view_common_1.getAncestor(top, "Frame");
        while (parentFrame && !parentFrameCanGoBack) {
            if (parentFrame && parentFrame.canGoBack()) {
                parentFrameCanGoBack = true;
            }
            else {
                parentFrame = view_common_1.getAncestor(parentFrame, "Frame");
            }
        }
        if (parentFrame && parentFrameCanGoBack) {
            parentFrame.goBack();
            return true;
        }
    }
    if (frame_stack_1.frameStack.length > 1) {
        top._popFromFrameStack();
    }
    return false;
}
exports.goBack = goBack;
function _stack() {
    return frame_stack_1.frameStack;
}
exports._stack = _stack;
exports.defaultPage = new view_1.Property({
    name: "defaultPage", valueChanged: function (frame, oldValue, newValue) {
        frame.navigate({ moduleName: newValue });
    }
});
exports.defaultPage.register(FrameBase);
exports.actionBarVisibilityProperty = new view_1.Property({ name: "actionBarVisibility", defaultValue: "auto", affectsLayout: view_1.isIOS });
exports.actionBarVisibilityProperty.register(FrameBase);
//# sourceMappingURL=frame-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/frame-stack.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
exports.frameStack = [];
function topmost() {
    if (exports.frameStack.length > 0) {
        return exports.frameStack[exports.frameStack.length - 1];
    }
    return undefined;
}
exports.topmost = topmost;
function _pushInFrameStack(frame) {
    if (frame._isInFrameStack && exports.frameStack[exports.frameStack.length - 1] === frame) {
        return;
    }
    if (frame._isInFrameStack) {
        var indexOfFrame = exports.frameStack.indexOf(frame);
        exports.frameStack.splice(indexOfFrame, 1);
    }
    exports.frameStack.push(frame);
    frame._isInFrameStack = true;
}
exports._pushInFrameStack = _pushInFrameStack;
function _popFromFrameStack(frame) {
    if (!frame._isInFrameStack) {
        return;
    }
    var top = topmost();
    if (top !== frame) {
        throw new Error("Cannot pop a Frame which is not at the top of the navigation stack.");
    }
    exports.frameStack.pop();
    frame._isInFrameStack = false;
}
exports._popFromFrameStack = _popFromFrameStack;
function _removeFromFrameStack(frame) {
    if (!frame._isInFrameStack) {
        return;
    }
    var index = exports.frameStack.indexOf(frame);
    exports.frameStack.splice(index, 1);
    frame._isInFrameStack = false;
}
exports._removeFromFrameStack = _removeFromFrameStack;
//# sourceMappingURL=frame-stack.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/frame.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var frame_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-common.js");
var fragment_transitions_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/fragment.transitions.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var system_classes_1 = __webpack_require__("../node_modules/tns-core-modules/css/system-classes.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-common.js"));
var ANDROID_PLATFORM = "android";
var INTENT_EXTRA = "com.tns.activity";
var ROOT_VIEW_ID_EXTRA = "com.tns.activity.rootViewId";
var FRAMEID = "_frameId";
var CALLBACKS = "_callbacks";
var HMR_REPLACE_TRANSITION = "fade";
var ownerSymbol = Symbol("_owner");
var activityRootViewsMap = new Map();
var navDepth = -1;
var fragmentId = -1;
if (global && global.__inspector) {
    var devtools = __webpack_require__("../node_modules/tns-core-modules/debugger/devtools-elements.js");
    devtools.attachDOMInspectorEventCallbacks(global.__inspector);
    devtools.attachDOMInspectorCommandCallbacks(global.__inspector);
}
function getAttachListener() {
    if (!exports.attachStateChangeListener) {
        var AttachListener = (function (_super) {
            __extends(AttachListener, _super);
            function AttachListener() {
                var _this = _super.call(this) || this;
                return global.__native(_this);
            }
            AttachListener.prototype.onViewAttachedToWindow = function (view) {
                var owner = view[ownerSymbol];
                if (owner) {
                    owner._onAttachedToWindow();
                }
            };
            AttachListener.prototype.onViewDetachedFromWindow = function (view) {
                var owner = view[ownerSymbol];
                if (owner) {
                    owner._onDetachedFromWindow();
                }
            };
            AttachListener = __decorate([
                Interfaces([android.view.View.OnAttachStateChangeListener])
            ], AttachListener);
            return AttachListener;
        }(java.lang.Object));
        exports.attachStateChangeListener = new AttachListener();
    }
    return exports.attachStateChangeListener;
}
function reloadPage(context) {
    var activity = application.android.foregroundActivity;
    var callbacks = activity[CALLBACKS];
    if (callbacks) {
        var rootView = callbacks.getRootView();
        var isAppRootModuleChanged = context && context.path && context.path.includes(application.getMainEntry().moduleName) && context.type !== "style";
        if (isAppRootModuleChanged || !rootView || !rootView._onLivesync(context)) {
            callbacks.resetActivityContent(activity);
        }
    }
    else {
        frame_common_1.traceError(activity + "[CALLBACKS] is null or undefined");
    }
}
exports.reloadPage = reloadPage;
global.__onLiveSyncCore = reloadPage;
var Frame = (function (_super) {
    __extends(Frame, _super);
    function Frame() {
        var _this = _super.call(this) || this;
        _this._containerViewId = -1;
        _this._tearDownPending = false;
        _this._attachedToWindow = false;
        _this._android = new AndroidFrame(_this);
        return _this;
    }
    Object.defineProperty(Frame, "defaultAnimatedNavigation", {
        get: function () {
            return frame_common_1.FrameBase.defaultAnimatedNavigation;
        },
        set: function (value) {
            frame_common_1.FrameBase.defaultAnimatedNavigation = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Frame, "defaultTransition", {
        get: function () {
            return frame_common_1.FrameBase.defaultTransition;
        },
        set: function (value) {
            frame_common_1.FrameBase.defaultTransition = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Frame.prototype, "containerViewId", {
        get: function () {
            return this._containerViewId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Frame.prototype, "android", {
        get: function () {
            return this._android;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Frame.prototype, "_hasFragments", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    Frame.prototype._onAttachedToWindow = function () {
        _super.prototype._onAttachedToWindow.call(this);
        this._attachedToWindow = true;
        this._processNextNavigationEntry();
    };
    Frame.prototype._onDetachedFromWindow = function () {
        _super.prototype._onDetachedFromWindow.call(this);
        this._attachedToWindow = false;
    };
    Frame.prototype._processNextNavigationEntry = function () {
        if (!this.isLoaded || this._executingContext || !this._attachedToWindow) {
            return;
        }
        var animatedEntries = fragment_transitions_1._getAnimatedEntries(this._android.frameId);
        if (animatedEntries) {
            if (animatedEntries.size > 0) {
                return;
            }
        }
        var manager = this._getFragmentManager();
        var entry = this._currentEntry;
        if (entry && manager && !manager.findFragmentByTag(entry.fragmentTag)) {
            this._cachedAnimatorState = getAnimatorState(this._currentEntry);
            this._currentEntry = null;
            this._navigateCore(entry);
            this._currentEntry = entry;
        }
        else {
            _super.prototype._processNextNavigationEntry.call(this);
        }
    };
    Frame.prototype._getChildFragmentManager = function () {
        var backstackEntry;
        if (this._executingContext && this._executingContext.entry) {
            backstackEntry = this._executingContext.entry;
        }
        else {
            backstackEntry = this._currentEntry;
        }
        if (backstackEntry && backstackEntry.fragment && backstackEntry.fragment.isAdded()) {
            return backstackEntry.fragment.getChildFragmentManager();
        }
        return null;
    };
    Frame.prototype._onRootViewReset = function () {
        _super.prototype._onRootViewReset.call(this);
        this.disposeCurrentFragment();
    };
    Frame.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        this.disposeCurrentFragment();
    };
    Frame.prototype.disposeCurrentFragment = function () {
        if (!this._currentEntry ||
            !this._currentEntry.fragment ||
            !this._currentEntry.fragment.isAdded()) {
            return;
        }
        var manager = this._getFragmentManager();
        var transaction = manager.beginTransaction();
        transaction.remove(this._currentEntry.fragment);
        transaction.commitNowAllowingStateLoss();
    };
    Frame.prototype.createFragment = function (backstackEntry, fragmentTag) {
        ensureFragmentClass();
        var newFragment = new fragmentClass();
        var args = new android.os.Bundle();
        args.putInt(FRAMEID, this._android.frameId);
        newFragment.setArguments(args);
        setFragmentCallbacks(newFragment);
        var callbacks = newFragment[CALLBACKS];
        callbacks.frame = this;
        callbacks.entry = backstackEntry;
        backstackEntry.fragment = newFragment;
        backstackEntry.fragmentTag = fragmentTag;
        backstackEntry.navDepth = navDepth;
        return newFragment;
    };
    Frame.prototype.setCurrent = function (entry, navigationType) {
        var current = this._currentEntry;
        var currentEntryChanged = current !== entry;
        if (currentEntryChanged) {
            this._updateBackstack(entry, navigationType);
            if (this._tearDownPending) {
                this._tearDownPending = false;
                if (!entry.recreated) {
                    clearEntry(entry);
                }
                if (current && !current.recreated) {
                    clearEntry(current);
                }
                var context_1 = this._context;
                if (context_1 && !entry.recreated) {
                    entry.fragment = this.createFragment(entry, entry.fragmentTag);
                    entry.resolvedPage._setupUI(context_1);
                }
                entry.recreated = false;
                if (current) {
                    current.recreated = false;
                }
            }
            _super.prototype.setCurrent.call(this, entry, navigationType);
            this._processNavigationQueue(entry.resolvedPage);
        }
        else {
            this._processNextNavigationEntry();
        }
        if (this._cachedAnimatorState) {
            restoreAnimatorState(this._currentEntry, this._cachedAnimatorState);
            this._cachedAnimatorState = null;
        }
        if (navigationType === frame_common_1.NavigationType.replace) {
            fragment_transitions_1._clearEntry(entry);
            var animated = this._getIsAnimatedNavigation(entry.entry);
            var navigationTransition = this._getNavigationTransition(entry.entry);
            var currentEntry = null;
            var newEntry = entry;
            var transaction = null;
            fragment_transitions_1._setAndroidFragmentTransitions(animated, navigationTransition, currentEntry, newEntry, transaction, this._android.frameId);
        }
    };
    Frame.prototype.onBackPressed = function () {
        if (this.canGoBack()) {
            this.goBack();
            return true;
        }
        if (!this.navigationQueueIsEmpty()) {
            var manager = this._getFragmentManager();
            if (manager) {
                manager.executePendingTransactions();
                return true;
            }
        }
        return false;
    };
    Frame.prototype._navigateCore = function (newEntry) {
        _super.prototype._navigateCore.call(this, newEntry);
        newEntry.frameId = this._android.frameId;
        var activity = this._android.activity;
        if (!activity) {
            var currentActivity = this._android.currentActivity;
            if (currentActivity) {
                startActivity(currentActivity, this._android.frameId);
            }
            return;
        }
        var manager = this._getFragmentManager();
        var clearHistory = newEntry.entry.clearHistory;
        var currentEntry = this._currentEntry;
        if (clearHistory) {
            navDepth = -1;
        }
        var isReplace = this._executingContext && this._executingContext.navigationType === frame_common_1.NavigationType.replace;
        if (!isReplace) {
            navDepth++;
        }
        fragmentId++;
        var newFragmentTag = "fragment" + fragmentId + "[" + navDepth + "]";
        var newFragment = this.createFragment(newEntry, newFragmentTag);
        var transaction = manager.beginTransaction();
        var animated = currentEntry ? this._getIsAnimatedNavigation(newEntry.entry) : false;
        var navigationTransition;
        if (isReplace) {
            animated = true;
            navigationTransition = { name: HMR_REPLACE_TRANSITION, duration: 100 };
        }
        else if (this._currentEntry) {
            navigationTransition = this._getNavigationTransition(newEntry.entry);
        }
        else {
            navigationTransition = null;
        }
        fragment_transitions_1._setAndroidFragmentTransitions(animated, navigationTransition, currentEntry, newEntry, transaction, this._android.frameId);
        if (currentEntry && animated && !navigationTransition) {
            transaction.setTransition(androidx.fragment.app.FragmentTransaction.TRANSIT_FRAGMENT_OPEN);
        }
        transaction.replace(this.containerViewId, newFragment, newFragmentTag);
        transaction.commitAllowingStateLoss();
    };
    Frame.prototype._goBackCore = function (backstackEntry) {
        _super.prototype._goBackCore.call(this, backstackEntry);
        navDepth = backstackEntry.navDepth;
        var manager = this._getFragmentManager();
        var transaction = manager.beginTransaction();
        if (!backstackEntry.fragment) {
            backstackEntry.fragment = this.createFragment(backstackEntry, backstackEntry.fragmentTag);
            fragment_transitions_1._updateTransitions(backstackEntry);
        }
        var transitionReversed = fragment_transitions_1._reverseTransitions(backstackEntry, this._currentEntry);
        if (!transitionReversed) {
            transaction.setCustomAnimations(-30, -40);
        }
        transaction.replace(this.containerViewId, backstackEntry.fragment, backstackEntry.fragmentTag);
        transaction.commitAllowingStateLoss();
    };
    Frame.prototype._removeEntry = function (removed) {
        _super.prototype._removeEntry.call(this, removed);
        if (removed.fragment) {
            fragment_transitions_1._clearEntry(removed);
        }
        removed.fragment = null;
        removed.viewSavedState = null;
    };
    Frame.prototype.createNativeView = function () {
        return new org.nativescript.widgets.ContentLayout(this._context);
    };
    Frame.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var listener = getAttachListener();
        this.nativeViewProtected.addOnAttachStateChangeListener(listener);
        this.nativeViewProtected[ownerSymbol] = this;
        this._android.rootViewGroup = this.nativeViewProtected;
        if (this._containerViewId < 0) {
            this._containerViewId = android.view.View.generateViewId();
        }
        this._android.rootViewGroup.setId(this._containerViewId);
    };
    Frame.prototype.disposeNativeView = function () {
        var listener = getAttachListener();
        this.nativeViewProtected.removeOnAttachStateChangeListener(listener);
        this.nativeViewProtected[ownerSymbol] = null;
        this._tearDownPending = !!this._executingContext;
        var current = this._currentEntry;
        var executingEntry = this._executingContext ? this._executingContext.entry : null;
        this.backStack.forEach(function (entry) {
            if (entry !== executingEntry) {
                clearEntry(entry);
            }
        });
        if (current && !executingEntry) {
            clearEntry(current);
        }
        this._android.rootViewGroup = null;
        this._removeFromFrameStack();
        _super.prototype.disposeNativeView.call(this);
    };
    Frame.prototype._popFromFrameStack = function () {
        if (!this._isInFrameStack) {
            return;
        }
        _super.prototype._popFromFrameStack.call(this);
    };
    Frame.prototype._getNavBarVisible = function (page) {
        switch (this.actionBarVisibility) {
            case "never":
                return false;
            case "always":
                return true;
            default:
                if (page.actionBarHidden !== undefined) {
                    return !page.actionBarHidden;
                }
                if (this._android && this._android.showActionBar !== undefined) {
                    return this._android.showActionBar;
                }
                return true;
        }
    };
    Frame.prototype._saveFragmentsState = function () {
        this.backStack.forEach(function (entry) {
            var view = entry.resolvedPage.nativeViewProtected;
            if (!entry.viewSavedState && view) {
                var viewState = new android.util.SparseArray();
                view.saveHierarchyState(viewState);
                entry.viewSavedState = viewState;
            }
        });
    };
    __decorate([
        profiling_1.profile
    ], Frame.prototype, "_navigateCore", null);
    return Frame;
}(frame_common_1.FrameBase));
exports.Frame = Frame;
function cloneExpandedAnimator(expandedAnimator) {
    if (!expandedAnimator) {
        return null;
    }
    var clone = expandedAnimator.clone();
    clone.entry = expandedAnimator.entry;
    clone.transitionType = expandedAnimator.transitionType;
    return clone;
}
function getAnimatorState(entry) {
    var expandedEntry = entry;
    var animatorState = {};
    animatorState.enterAnimator = cloneExpandedAnimator(expandedEntry.enterAnimator);
    animatorState.exitAnimator = cloneExpandedAnimator(expandedEntry.exitAnimator);
    animatorState.popEnterAnimator = cloneExpandedAnimator(expandedEntry.popEnterAnimator);
    animatorState.popExitAnimator = cloneExpandedAnimator(expandedEntry.popExitAnimator);
    animatorState.transitionName = expandedEntry.transitionName;
    return animatorState;
}
function restoreAnimatorState(entry, snapshot) {
    var expandedEntry = entry;
    if (snapshot.enterAnimator) {
        expandedEntry.enterAnimator = snapshot.enterAnimator;
    }
    if (snapshot.exitAnimator) {
        expandedEntry.exitAnimator = snapshot.exitAnimator;
    }
    if (snapshot.popEnterAnimator) {
        expandedEntry.popEnterAnimator = snapshot.popEnterAnimator;
    }
    if (snapshot.popExitAnimator) {
        expandedEntry.popExitAnimator = snapshot.popExitAnimator;
    }
    expandedEntry.transitionName = snapshot.transitionName;
}
function clearEntry(entry) {
    if (entry.fragment) {
        fragment_transitions_1._clearFragment(entry);
    }
    entry.recreated = false;
    entry.fragment = null;
    var page = entry.resolvedPage;
    if (page._context) {
        entry.resolvedPage._tearDownUI(true);
    }
}
var framesCounter = 0;
var framesCache = new Array();
var AndroidFrame = (function (_super) {
    __extends(AndroidFrame, _super);
    function AndroidFrame(owner) {
        var _this = _super.call(this) || this;
        _this._showActionBar = true;
        _this._owner = owner;
        _this.frameId = framesCounter++;
        framesCache.push(new WeakRef(_this));
        return _this;
    }
    Object.defineProperty(AndroidFrame.prototype, "showActionBar", {
        get: function () {
            return this._showActionBar;
        },
        set: function (value) {
            if (this._showActionBar !== value) {
                this._showActionBar = value;
                if (this.owner.currentPage) {
                    this.owner.currentPage.actionBar.update();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AndroidFrame.prototype, "activity", {
        get: function () {
            var activity = this.owner._context;
            if (activity) {
                return activity;
            }
            var currView = this._owner.parent;
            while (currView) {
                if (currView instanceof Frame) {
                    return currView.android.activity;
                }
                currView = currView.parent;
            }
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AndroidFrame.prototype, "actionBar", {
        get: function () {
            var activity = this.currentActivity;
            if (!activity) {
                return undefined;
            }
            var bar = activity.getActionBar();
            if (!bar) {
                return undefined;
            }
            return bar;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AndroidFrame.prototype, "currentActivity", {
        get: function () {
            var activity = this.activity;
            if (activity) {
                return activity;
            }
            var frames = frame_common_1._stack();
            for (var length_1 = frames.length, i = length_1 - 1; i >= 0; i--) {
                activity = frames[i].android.activity;
                if (activity) {
                    return activity;
                }
            }
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AndroidFrame.prototype, "owner", {
        get: function () {
            return this._owner;
        },
        enumerable: true,
        configurable: true
    });
    AndroidFrame.prototype.canGoBack = function () {
        if (!this.activity) {
            return false;
        }
        return this.activity.getIntent().getAction() !== android.content.Intent.ACTION_MAIN;
    };
    AndroidFrame.prototype.fragmentForPage = function (entry) {
        var tag = entry && entry.fragmentTag;
        if (tag) {
            return this.owner._getFragmentManager().findFragmentByTag(tag);
        }
        return undefined;
    };
    return AndroidFrame;
}(frame_common_1.Observable));
function findPageForFragment(fragment, frame) {
    var fragmentTag = fragment.getTag();
    if (frame_common_1.traceEnabled()) {
        frame_common_1.traceWrite("Finding page for " + fragmentTag + ".", frame_common_1.traceCategories.NativeLifecycle);
    }
    var entry;
    var current = frame._currentEntry;
    var executingContext = frame._executingContext;
    if (current && current.fragmentTag === fragmentTag) {
        entry = current;
    }
    else if (executingContext && executingContext.entry && executingContext.entry.fragmentTag === fragmentTag) {
        entry = executingContext.entry;
    }
    var page;
    if (entry) {
        entry.recreated = true;
        page = entry.resolvedPage;
    }
    if (page) {
        var callbacks = fragment[CALLBACKS];
        callbacks.frame = frame;
        callbacks.entry = entry;
        entry.fragment = fragment;
        fragment_transitions_1._updateTransitions(entry);
    }
    else {
        throw new Error("Could not find a page for " + fragmentTag + ".");
    }
}
function startActivity(activity, frameId) {
    var intent = new android.content.Intent(activity, activity.getClass());
    intent.setAction(android.content.Intent.ACTION_DEFAULT);
    intent.putExtra(INTENT_EXTRA, frameId);
    activity.startActivity(intent);
}
function getFrameByNumberId(frameId) {
    for (var i = 0; i < framesCache.length; i++) {
        var aliveFrame = framesCache[i].get();
        if (aliveFrame && aliveFrame.frameId === frameId) {
            return aliveFrame.owner;
        }
    }
    return null;
}
function ensureFragmentClass() {
    if (fragmentClass) {
        return;
    }
    __webpack_require__("../node_modules/tns-core-modules/ui/frame/fragment.js");
    if (!fragmentClass) {
        throw new Error("Failed to initialize the extended androidx.fragment.app.Fragment class");
    }
}
var fragmentClass;
function setFragmentClass(clazz) {
    if (fragmentClass) {
        throw new Error("Fragment class already initialized");
    }
    fragmentClass = clazz;
}
exports.setFragmentClass = setFragmentClass;
var FragmentCallbacksImplementation = (function () {
    function FragmentCallbacksImplementation() {
    }
    FragmentCallbacksImplementation.prototype.onHiddenChanged = function (fragment, hidden, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onHiddenChanged(" + hidden + ")", frame_common_1.traceCategories.NativeLifecycle);
        }
        superFunc.call(fragment, hidden);
    };
    FragmentCallbacksImplementation.prototype.onCreateAnimator = function (fragment, transit, enter, nextAnim, superFunc) {
        if (!enter && fragment.getRemovingParentFragment()) {
            return superFunc.call(fragment, transit, enter, nextAnim);
        }
        var nextAnimString;
        switch (nextAnim) {
            case -10:
                nextAnimString = "enter";
                break;
            case -20:
                nextAnimString = "exit";
                break;
            case -30:
                nextAnimString = "popEnter";
                break;
            case -40:
                nextAnimString = "popExit";
                break;
        }
        var animator = fragment_transitions_1._onFragmentCreateAnimator(this.entry, fragment, nextAnim, enter);
        if (!animator) {
            animator = superFunc.call(fragment, transit, enter, nextAnim);
        }
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onCreateAnimator(" + transit + ", " + (enter ? "enter" : "exit") + ", " + nextAnimString + "): " + (animator ? "animator" : "no animator"), frame_common_1.traceCategories.NativeLifecycle);
        }
        return animator;
    };
    FragmentCallbacksImplementation.prototype.onCreate = function (fragment, savedInstanceState, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onCreate(" + savedInstanceState + ")", frame_common_1.traceCategories.NativeLifecycle);
        }
        superFunc.call(fragment, savedInstanceState);
        if (!this.entry) {
            var args = fragment.getArguments();
            var frameId = args.getInt(FRAMEID);
            var frame = getFrameByNumberId(frameId);
            if (!frame) {
                throw new Error("Cannot find Frame for " + fragment);
            }
            findPageForFragment(fragment, frame);
        }
    };
    FragmentCallbacksImplementation.prototype.onCreateView = function (fragment, inflater, container, savedInstanceState, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onCreateView(inflater, container, " + savedInstanceState + ")", frame_common_1.traceCategories.NativeLifecycle);
        }
        var entry = this.entry;
        if (!entry) {
            frame_common_1.traceError(fragment + ".onCreateView: entry is null or undefined");
            return null;
        }
        var page = entry.resolvedPage;
        if (!page) {
            frame_common_1.traceError(fragment + ".onCreateView: entry has no resolvedPage");
            return null;
        }
        var frame = this.frame;
        if (!frame) {
            frame_common_1.traceError(fragment + ".onCreateView: this.frame is null or undefined");
            return null;
        }
        if (page.parent === frame) {
            if (!page._context) {
                var context_2 = container && container.getContext() || inflater && inflater.getContext();
                page._setupUI(context_2);
            }
        }
        else {
            if (!frame._styleScope) {
                page._updateStyleScope();
            }
            frame._addView(page);
        }
        if (frame.isLoaded && !page.isLoaded) {
            page.callLoaded();
        }
        var savedState = entry.viewSavedState;
        if (savedState) {
            page.nativeViewProtected.restoreHierarchyState(savedState);
            entry.viewSavedState = null;
        }
        var nativeView = page.nativeViewProtected;
        if (nativeView != null) {
            var parentView = nativeView.getParent();
            if (parentView instanceof android.view.ViewGroup) {
                if (parentView.getChildCount() === 0) {
                    parentView.addViewInLayout(nativeView, -1, new org.nativescript.widgets.CommonLayoutParams());
                }
                parentView.removeView(nativeView);
            }
        }
        return page.nativeViewProtected;
    };
    FragmentCallbacksImplementation.prototype.onSaveInstanceState = function (fragment, outState, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onSaveInstanceState(" + outState + ")", frame_common_1.traceCategories.NativeLifecycle);
        }
        superFunc.call(fragment, outState);
    };
    FragmentCallbacksImplementation.prototype.onDestroyView = function (fragment, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onDestroyView()", frame_common_1.traceCategories.NativeLifecycle);
        }
        superFunc.call(fragment);
    };
    FragmentCallbacksImplementation.prototype.onDestroy = function (fragment, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onDestroy()", frame_common_1.traceCategories.NativeLifecycle);
        }
        superFunc.call(fragment);
        var entry = this.entry;
        if (!entry) {
            frame_common_1.traceError(fragment + ".onDestroy: entry is null or undefined");
            return null;
        }
        entry.fragment = null;
        var page = entry.resolvedPage;
        if (!page) {
            frame_common_1.traceError(fragment + ".onDestroy: entry has no resolvedPage");
            return null;
        }
    };
    FragmentCallbacksImplementation.prototype.onStop = function (fragment, superFunc) {
        superFunc.call(fragment);
    };
    FragmentCallbacksImplementation.prototype.toStringOverride = function (fragment, superFunc) {
        var entry = this.entry;
        if (entry) {
            return entry.fragmentTag + "<" + entry.resolvedPage + ">";
        }
        else {
            return "NO ENTRY, " + superFunc.call(fragment);
        }
    };
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onHiddenChanged", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onCreateAnimator", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onCreate", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onCreateView", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onSaveInstanceState", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onDestroyView", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onDestroy", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onStop", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "toStringOverride", null);
    return FragmentCallbacksImplementation;
}());
var ActivityCallbacksImplementation = (function () {
    function ActivityCallbacksImplementation() {
    }
    ActivityCallbacksImplementation.prototype.getRootView = function () {
        return this._rootView;
    };
    ActivityCallbacksImplementation.prototype.onCreate = function (activity, savedInstanceState, intentOrSuperFunc, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("Activity.onCreate(" + savedInstanceState + ")", frame_common_1.traceCategories.NativeLifecycle);
        }
        var intent = superFunc ? intentOrSuperFunc : undefined;
        if (!superFunc) {
            console.log("AndroidActivityCallbacks.onCreate(activity: any, savedInstanceState: any, superFunc: Function) " +
                "is deprecated. Use AndroidActivityCallbacks.onCreate(activity: any, savedInstanceState: any, intent: any, superFunc: Function) instead.");
            superFunc = intentOrSuperFunc;
        }
        var isRestart = !!savedInstanceState && exports.moduleLoaded;
        superFunc.call(activity, isRestart ? savedInstanceState : null);
        if (savedInstanceState) {
            var rootViewId = savedInstanceState.getInt(ROOT_VIEW_ID_EXTRA, -1);
            if (rootViewId !== -1 && activityRootViewsMap.has(rootViewId)) {
                this._rootView = activityRootViewsMap.get(rootViewId).get();
            }
        }
        if (intent && intent.getAction()) {
            application.android.notify({
                eventName: application.AndroidApplication.activityNewIntentEvent,
                object: application.android,
                activity: activity,
                intent: intent
            });
        }
        this.setActivityContent(activity, savedInstanceState, true);
        exports.moduleLoaded = true;
    };
    ActivityCallbacksImplementation.prototype.onSaveInstanceState = function (activity, outState, superFunc) {
        superFunc.call(activity, outState);
        var rootView = this._rootView;
        if (rootView instanceof Frame) {
            outState.putInt(INTENT_EXTRA, rootView.android.frameId);
            rootView._saveFragmentsState();
        }
        outState.putInt(ROOT_VIEW_ID_EXTRA, rootView._domId);
    };
    ActivityCallbacksImplementation.prototype.onNewIntent = function (activity, intent, superSetIntentFunc, superFunc) {
        superFunc.call(activity, intent);
        superSetIntentFunc.call(activity, intent);
        application.android.notify({
            eventName: application.AndroidApplication.activityNewIntentEvent,
            object: application.android,
            activity: activity,
            intent: intent
        });
    };
    ActivityCallbacksImplementation.prototype.onStart = function (activity, superFunc) {
        superFunc.call(activity);
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onStart();", frame_common_1.traceCategories.NativeLifecycle);
        }
        var rootView = this._rootView;
        if (rootView && !rootView.isLoaded) {
            rootView.callLoaded();
        }
    };
    ActivityCallbacksImplementation.prototype.onStop = function (activity, superFunc) {
        superFunc.call(activity);
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onStop();", frame_common_1.traceCategories.NativeLifecycle);
        }
        var rootView = this._rootView;
        if (rootView && rootView.isLoaded) {
            rootView.callUnloaded();
        }
    };
    ActivityCallbacksImplementation.prototype.onPostResume = function (activity, superFunc) {
        superFunc.call(activity);
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onPostResume();", frame_common_1.traceCategories.NativeLifecycle);
        }
        if (activity.isNativeScriptActivity) {
            var args = {
                eventName: application.resumeEvent,
                object: application.android,
                android: activity
            };
            application.notify(args);
            application.android.paused = false;
        }
    };
    ActivityCallbacksImplementation.prototype.onDestroy = function (activity, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onDestroy();", frame_common_1.traceCategories.NativeLifecycle);
        }
        var rootView = this._rootView;
        if (rootView) {
            rootView._tearDownUI(true);
        }
        var exitArgs = { eventName: application.exitEvent, object: application.android, android: activity };
        application.notify(exitArgs);
        superFunc.call(activity);
    };
    ActivityCallbacksImplementation.prototype.onBackPressed = function (activity, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onBackPressed;", frame_common_1.traceCategories.NativeLifecycle);
        }
        var args = {
            eventName: "activityBackPressed",
            object: application.android,
            activity: activity,
            cancel: false,
        };
        application.android.notify(args);
        if (args.cancel) {
            return;
        }
        var view = this._rootView;
        var callSuper = false;
        if (view instanceof Frame) {
            callSuper = !frame_common_1.goBack();
        }
        else {
            var viewArgs = {
                eventName: "activityBackPressed",
                object: view,
                activity: activity,
                cancel: false,
            };
            view.notify(viewArgs);
            if (!viewArgs.cancel && !view.onBackPressed()) {
                callSuper = true;
            }
        }
        if (callSuper) {
            superFunc.call(activity);
        }
    };
    ActivityCallbacksImplementation.prototype.onRequestPermissionsResult = function (activity, requestCode, permissions, grantResults, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onRequestPermissionsResult;", frame_common_1.traceCategories.NativeLifecycle);
        }
        application.android.notify({
            eventName: "activityRequestPermissions",
            object: application.android,
            activity: activity,
            requestCode: requestCode,
            permissions: permissions,
            grantResults: grantResults
        });
    };
    ActivityCallbacksImplementation.prototype.onActivityResult = function (activity, requestCode, resultCode, data, superFunc) {
        superFunc.call(activity, requestCode, resultCode, data);
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onActivityResult(" + requestCode + ", " + resultCode + ", " + data + ")", frame_common_1.traceCategories.NativeLifecycle);
        }
        application.android.notify({
            eventName: "activityResult",
            object: application.android,
            activity: activity,
            requestCode: requestCode,
            resultCode: resultCode,
            intent: data
        });
    };
    ActivityCallbacksImplementation.prototype.resetActivityContent = function (activity) {
        if (this._rootView) {
            var manager = this._rootView._getFragmentManager();
            manager.executePendingTransactions();
            this._rootView._onRootViewReset();
        }
        this._rootView = null;
        this.setActivityContent(activity, null, false);
        this._rootView.callLoaded();
    };
    ActivityCallbacksImplementation.prototype.setActivityContent = function (activity, savedInstanceState, fireLaunchEvent) {
        var _this = this;
        var shouldCreateRootFrame = application._shouldCreateRootFrame();
        var rootView = this._rootView;
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("Frame.setActivityContent rootView: " + rootView + " shouldCreateRootFrame: " + shouldCreateRootFrame + " fireLaunchEvent: " + fireLaunchEvent, frame_common_1.traceCategories.NativeLifecycle);
        }
        if (!rootView) {
            var mainEntry = application.getMainEntry();
            var intent = activity.getIntent();
            if (fireLaunchEvent) {
                rootView = notifyLaunch(intent, savedInstanceState);
            }
            if (!rootView) {
                if (!mainEntry) {
                    throw new Error("Main entry is missing. App cannot be started. Verify app bootstrap.");
                }
                if (shouldCreateRootFrame) {
                    var extras = intent.getExtras();
                    var frameId = -1;
                    if (extras) {
                        frameId = extras.getInt(INTENT_EXTRA, -1);
                    }
                    if (savedInstanceState && frameId < 0) {
                        frameId = savedInstanceState.getInt(INTENT_EXTRA, -1);
                    }
                    if (!rootView) {
                        rootView = getFrameByNumberId(frameId) || new Frame();
                    }
                    if (rootView instanceof Frame) {
                        rootView.navigate(mainEntry);
                    }
                    else {
                        throw new Error("A Frame must be used to navigate to a Page.");
                    }
                }
                else {
                    rootView = builder_1.createViewFromEntry(mainEntry);
                }
            }
            this._rootView = rootView;
            activityRootViewsMap.set(rootView._domId, new WeakRef(rootView));
            var deviceType = platform_1.device.deviceType.toLowerCase();
            system_classes_1.pushToRootViewCssClasses("" + system_classes_1.CLASS_PREFIX + ANDROID_PLATFORM);
            system_classes_1.pushToRootViewCssClasses("" + system_classes_1.CLASS_PREFIX + deviceType);
            system_classes_1.pushToRootViewCssClasses("" + system_classes_1.CLASS_PREFIX + application.android.orientation);
            var rootViewCssClasses = system_classes_1.getRootViewCssClasses();
            rootViewCssClasses.forEach(function (c) { return _this._rootView.cssClasses.add(c); });
        }
        if (shouldCreateRootFrame) {
            rootView._setupUI(activity);
        }
        else {
            rootView._setupAsRootView(activity);
        }
        activity.setContentView(rootView.nativeViewProtected, new org.nativescript.widgets.CommonLayoutParams());
    };
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onCreate", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onSaveInstanceState", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onNewIntent", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onStart", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onStop", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onPostResume", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onDestroy", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onBackPressed", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onRequestPermissionsResult", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onActivityResult", null);
    return ActivityCallbacksImplementation;
}());
var notifyLaunch = profiling_1.profile("notifyLaunch", function notifyLaunch(intent, savedInstanceState) {
    var launchArgs = {
        eventName: application.launchEvent,
        object: application.android,
        android: intent, savedInstanceState: savedInstanceState
    };
    application.notify(launchArgs);
    application.notify({ eventName: "loadAppCss", object: this, cssFile: application.getCssFileName() });
    return launchArgs.root;
});
function setActivityCallbacks(activity) {
    activity[CALLBACKS] = new ActivityCallbacksImplementation();
}
exports.setActivityCallbacks = setActivityCallbacks;
function setFragmentCallbacks(fragment) {
    fragment[CALLBACKS] = new FragmentCallbacksImplementation();
}
exports.setFragmentCallbacks = setFragmentCallbacks;
//# sourceMappingURL=frame.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/gestures/gestures-common.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var GestureTypes;
(function (GestureTypes) {
    GestureTypes[GestureTypes["tap"] = 1] = "tap";
    GestureTypes[GestureTypes["doubleTap"] = 2] = "doubleTap";
    GestureTypes[GestureTypes["pinch"] = 4] = "pinch";
    GestureTypes[GestureTypes["pan"] = 8] = "pan";
    GestureTypes[GestureTypes["swipe"] = 16] = "swipe";
    GestureTypes[GestureTypes["rotation"] = 32] = "rotation";
    GestureTypes[GestureTypes["longPress"] = 64] = "longPress";
    GestureTypes[GestureTypes["touch"] = 128] = "touch";
})(GestureTypes = exports.GestureTypes || (exports.GestureTypes = {}));
var GestureStateTypes;
(function (GestureStateTypes) {
    GestureStateTypes[GestureStateTypes["cancelled"] = 0] = "cancelled";
    GestureStateTypes[GestureStateTypes["began"] = 1] = "began";
    GestureStateTypes[GestureStateTypes["changed"] = 2] = "changed";
    GestureStateTypes[GestureStateTypes["ended"] = 3] = "ended";
})(GestureStateTypes = exports.GestureStateTypes || (exports.GestureStateTypes = {}));
var SwipeDirection;
(function (SwipeDirection) {
    SwipeDirection[SwipeDirection["right"] = 1] = "right";
    SwipeDirection[SwipeDirection["left"] = 2] = "left";
    SwipeDirection[SwipeDirection["up"] = 4] = "up";
    SwipeDirection[SwipeDirection["down"] = 8] = "down";
})(SwipeDirection = exports.SwipeDirection || (exports.SwipeDirection = {}));
var TouchAction;
(function (TouchAction) {
    TouchAction.down = "down";
    TouchAction.up = "up";
    TouchAction.move = "move";
    TouchAction.cancel = "cancel";
})(TouchAction = exports.TouchAction || (exports.TouchAction = {}));
function toString(type, separator) {
    var types = new Array();
    if (type & GestureTypes.tap) {
        types.push("tap");
    }
    if (type & GestureTypes.doubleTap) {
        types.push("doubleTap");
    }
    if (type & GestureTypes.pinch) {
        types.push("pinch");
    }
    if (type & GestureTypes.pan) {
        types.push("pan");
    }
    if (type & GestureTypes.swipe) {
        types.push("swipe");
    }
    if (type & GestureTypes.rotation) {
        types.push("rotation");
    }
    if (type & GestureTypes.longPress) {
        types.push("longPress");
    }
    if (type & GestureTypes.touch) {
        types.push("touch");
    }
    return types.join(separator);
}
exports.toString = toString;
function fromString(type) {
    var t = type.trim().toLowerCase();
    if (t === "tap") {
        return GestureTypes.tap;
    }
    else if (t === "doubletap") {
        return GestureTypes.doubleTap;
    }
    else if (t === "pinch") {
        return GestureTypes.pinch;
    }
    else if (t === "pan") {
        return GestureTypes.pan;
    }
    else if (t === "swipe") {
        return GestureTypes.swipe;
    }
    else if (t === "rotation") {
        return GestureTypes.rotation;
    }
    else if (t === "longpress") {
        return GestureTypes.longPress;
    }
    else if (t === "touch") {
        return GestureTypes.touch;
    }
    return undefined;
}
exports.fromString = fromString;
var GesturesObserverBase = (function () {
    function GesturesObserverBase(target, callback, context) {
        this._target = target;
        this._callback = callback;
        this._context = context;
    }
    Object.defineProperty(GesturesObserverBase.prototype, "callback", {
        get: function () {
            return this._callback;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GesturesObserverBase.prototype, "target", {
        get: function () {
            return this._target;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GesturesObserverBase.prototype, "context", {
        get: function () {
            return this._context;
        },
        enumerable: true,
        configurable: true
    });
    GesturesObserverBase.prototype.disconnect = function () {
        if (this.target) {
            var list = this.target.getGestureObservers(this.type);
            if (list && list.length > 0) {
                for (var i = 0; i < list.length; i++) {
                    if (list[i].callback === this.callback) {
                        break;
                    }
                }
                list.length = 0;
                this.target._gestureObservers[this.type] = undefined;
                delete this.target._gestureObservers[this.type];
            }
        }
        this._target = null;
        this._callback = null;
        this._context = null;
    };
    return GesturesObserverBase;
}());
exports.GesturesObserverBase = GesturesObserverBase;
//# sourceMappingURL=gestures-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/gestures/gestures.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var gestures_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures-common.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var timer = __webpack_require__("../node_modules/tns-core-modules/timer/timer.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures-common.js"));
var TapAndDoubleTapGestureListener;
function initializeTapAndDoubleTapGestureListener() {
    if (TapAndDoubleTapGestureListener) {
        return;
    }
    var TapAndDoubleTapGestureListenerImpl = (function (_super) {
        __extends(TapAndDoubleTapGestureListenerImpl, _super);
        function TapAndDoubleTapGestureListenerImpl(observer, target, type) {
            var _this = _super.call(this) || this;
            _this._lastUpTime = 0;
            _this._observer = observer;
            _this._target = target;
            _this._type = type;
            return global.__native(_this);
        }
        TapAndDoubleTapGestureListenerImpl.prototype.onSingleTapUp = function (motionEvent) {
            this._handleSingleTap(motionEvent);
            this._lastUpTime = Date.now();
            return true;
        };
        TapAndDoubleTapGestureListenerImpl.prototype.onDown = function (motionEvent) {
            var tapTime = Date.now();
            if ((tapTime - this._lastUpTime) <= TapAndDoubleTapGestureListenerImpl.DoubleTapTimeout) {
                this._handleDoubleTap(motionEvent);
            }
            return true;
        };
        TapAndDoubleTapGestureListenerImpl.prototype.onLongPress = function (motionEvent) {
            if (this._type & gestures_common_1.GestureTypes.longPress) {
                var args = _getArgs(gestures_common_1.GestureTypes.longPress, this._target, motionEvent);
                _executeCallback(this._observer, args);
            }
        };
        TapAndDoubleTapGestureListenerImpl.prototype._handleSingleTap = function (motionEvent) {
            var _this = this;
            if (this._target.getGestureObservers(gestures_common_1.GestureTypes.doubleTap)) {
                this._tapTimeoutId = timer.setTimeout(function () {
                    if (_this._type & gestures_common_1.GestureTypes.tap) {
                        var args = _getArgs(gestures_common_1.GestureTypes.tap, _this._target, motionEvent);
                        _executeCallback(_this._observer, args);
                    }
                    timer.clearTimeout(_this._tapTimeoutId);
                }, TapAndDoubleTapGestureListenerImpl.DoubleTapTimeout);
            }
            else {
                if (this._type & gestures_common_1.GestureTypes.tap) {
                    var args = _getArgs(gestures_common_1.GestureTypes.tap, this._target, motionEvent);
                    _executeCallback(this._observer, args);
                }
            }
        };
        TapAndDoubleTapGestureListenerImpl.prototype._handleDoubleTap = function (motionEvent) {
            if (this._tapTimeoutId) {
                timer.clearTimeout(this._tapTimeoutId);
            }
            if (this._type & gestures_common_1.GestureTypes.doubleTap) {
                var args = _getArgs(gestures_common_1.GestureTypes.doubleTap, this._target, motionEvent);
                _executeCallback(this._observer, args);
            }
        };
        TapAndDoubleTapGestureListenerImpl.DoubleTapTimeout = android.view.ViewConfiguration.getDoubleTapTimeout();
        return TapAndDoubleTapGestureListenerImpl;
    }(android.view.GestureDetector.SimpleOnGestureListener));
    TapAndDoubleTapGestureListener = TapAndDoubleTapGestureListenerImpl;
}
var PinchGestureListener;
function initializePinchGestureListener() {
    if (PinchGestureListener) {
        return;
    }
    var PinchGestureListenerImpl = (function (_super) {
        __extends(PinchGestureListenerImpl, _super);
        function PinchGestureListenerImpl(observer, target) {
            var _this = _super.call(this) || this;
            _this._observer = observer;
            _this._target = target;
            return global.__native(_this);
        }
        PinchGestureListenerImpl.prototype.onScaleBegin = function (detector) {
            this._scale = detector.getScaleFactor();
            var args = new PinchGestureEventData(this._target, detector, this._scale, this._target, gestures_common_1.GestureStateTypes.began);
            _executeCallback(this._observer, args);
            return true;
        };
        PinchGestureListenerImpl.prototype.onScale = function (detector) {
            this._scale *= detector.getScaleFactor();
            var args = new PinchGestureEventData(this._target, detector, this._scale, this._target, gestures_common_1.GestureStateTypes.changed);
            _executeCallback(this._observer, args);
            return true;
        };
        PinchGestureListenerImpl.prototype.onScaleEnd = function (detector) {
            this._scale *= detector.getScaleFactor();
            var args = new PinchGestureEventData(this._target, detector, this._scale, this._target, gestures_common_1.GestureStateTypes.ended);
            _executeCallback(this._observer, args);
        };
        return PinchGestureListenerImpl;
    }(android.view.ScaleGestureDetector.SimpleOnScaleGestureListener));
    PinchGestureListener = PinchGestureListenerImpl;
}
var SwipeGestureListener;
function initializeSwipeGestureListener() {
    if (SwipeGestureListener) {
        return;
    }
    var SwipeGestureListenerImpl = (function (_super) {
        __extends(SwipeGestureListenerImpl, _super);
        function SwipeGestureListenerImpl(observer, target) {
            var _this = _super.call(this) || this;
            _this._observer = observer;
            _this._target = target;
            return global.__native(_this);
        }
        SwipeGestureListenerImpl.prototype.onDown = function (motionEvent) {
            return true;
        };
        SwipeGestureListenerImpl.prototype.onFling = function (initialEvent, currentEvent, velocityX, velocityY) {
            var result = false;
            var args;
            try {
                var deltaY = currentEvent.getY() - initialEvent.getY();
                var deltaX = currentEvent.getX() - initialEvent.getX();
                if (Math.abs(deltaX) > Math.abs(deltaY)) {
                    if (Math.abs(deltaX) > SWIPE_THRESHOLD
                        && Math.abs(velocityX) > SWIPE_VELOCITY_THRESHOLD) {
                        if (deltaX > 0) {
                            args = _getSwipeArgs(gestures_common_1.SwipeDirection.right, this._target, initialEvent, currentEvent);
                            _executeCallback(this._observer, args);
                            result = true;
                        }
                        else {
                            args = _getSwipeArgs(gestures_common_1.SwipeDirection.left, this._target, initialEvent, currentEvent);
                            _executeCallback(this._observer, args);
                            result = true;
                        }
                    }
                }
                else {
                    if (Math.abs(deltaY) > SWIPE_THRESHOLD
                        && Math.abs(velocityY) > SWIPE_VELOCITY_THRESHOLD) {
                        if (deltaY > 0) {
                            args = _getSwipeArgs(gestures_common_1.SwipeDirection.down, this._target, initialEvent, currentEvent);
                            _executeCallback(this._observer, args);
                            result = true;
                        }
                        else {
                            args = _getSwipeArgs(gestures_common_1.SwipeDirection.up, this._target, initialEvent, currentEvent);
                            _executeCallback(this._observer, args);
                            result = true;
                        }
                    }
                }
            }
            catch (ex) {
            }
            return result;
        };
        return SwipeGestureListenerImpl;
    }(android.view.GestureDetector.SimpleOnGestureListener));
    SwipeGestureListener = SwipeGestureListenerImpl;
}
var SWIPE_THRESHOLD = 100;
var SWIPE_VELOCITY_THRESHOLD = 100;
var INVALID_POINTER_ID = -1;
var TO_DEGREES = (180 / Math.PI);
function observe(target, type, callback, context) {
    var observer = new GesturesObserver(target, callback, context);
    observer.observe(type);
    return observer;
}
exports.observe = observe;
var GesturesObserver = (function (_super) {
    __extends(GesturesObserver, _super);
    function GesturesObserver() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    GesturesObserver.prototype.observe = function (type) {
        var _this = this;
        if (this.target) {
            this.type = type;
            this._onTargetLoaded = function (args) {
                _this._attach(_this.target, type);
            };
            this._onTargetUnloaded = function (args) {
                _this._detach();
            };
            this.target.on("loaded", this._onTargetLoaded);
            this.target.on("unloaded", this._onTargetUnloaded);
            if (this.target.isLoaded) {
                this._attach(this.target, type);
            }
        }
    };
    GesturesObserver.prototype.disconnect = function () {
        this._detach();
        if (this.target) {
            this.target.off("loaded", this._onTargetLoaded);
            this.target.off("unloaded", this._onTargetUnloaded);
            this._onTargetLoaded = null;
            this._onTargetUnloaded = null;
        }
        _super.prototype.disconnect.call(this);
    };
    GesturesObserver.prototype._detach = function () {
        this._notifyTouch = false;
        this._simpleGestureDetector = null;
        this._scaleGestureDetector = null;
        this._swipeGestureDetector = null;
        this._panGestureDetector = null;
        this._rotateGestureDetector = null;
        this._eventData = null;
    };
    GesturesObserver.prototype._attach = function (target, type) {
        this._detach();
        if ((type & gestures_common_1.GestureTypes.tap) || (type & gestures_common_1.GestureTypes.doubleTap) || (type & gestures_common_1.GestureTypes.longPress)) {
            initializeTapAndDoubleTapGestureListener();
            this._simpleGestureDetector = new androidx.core.view.GestureDetectorCompat(target._context, new TapAndDoubleTapGestureListener(this, this.target, type));
        }
        if (type & gestures_common_1.GestureTypes.pinch) {
            initializePinchGestureListener();
            this._scaleGestureDetector = new android.view.ScaleGestureDetector(target._context, new PinchGestureListener(this, this.target));
        }
        if (type & gestures_common_1.GestureTypes.swipe) {
            initializeSwipeGestureListener();
            this._swipeGestureDetector = new androidx.core.view.GestureDetectorCompat(target._context, new SwipeGestureListener(this, this.target));
        }
        if (type & gestures_common_1.GestureTypes.pan) {
            this._panGestureDetector = new CustomPanGestureDetector(this, this.target);
        }
        if (type & gestures_common_1.GestureTypes.rotation) {
            this._rotateGestureDetector = new CustomRotateGestureDetector(this, this.target);
        }
        if (type & gestures_common_1.GestureTypes.touch) {
            this._notifyTouch = true;
        }
    };
    GesturesObserver.prototype.androidOnTouchEvent = function (motionEvent) {
        if (this._notifyTouch) {
            if (!this._eventData) {
                this._eventData = new TouchGestureEventData();
            }
            this._eventData.prepare(this.target, motionEvent);
            _executeCallback(this, this._eventData);
        }
        if (this._simpleGestureDetector) {
            this._simpleGestureDetector.onTouchEvent(motionEvent);
        }
        if (this._scaleGestureDetector) {
            this._scaleGestureDetector.onTouchEvent(motionEvent);
        }
        if (this._swipeGestureDetector) {
            this._swipeGestureDetector.onTouchEvent(motionEvent);
        }
        if (this._panGestureDetector) {
            this._panGestureDetector.onTouchEvent(motionEvent);
        }
        if (this._rotateGestureDetector) {
            this._rotateGestureDetector.onTouchEvent(motionEvent);
        }
    };
    return GesturesObserver;
}(gestures_common_1.GesturesObserverBase));
exports.GesturesObserver = GesturesObserver;
function _getArgs(type, view, e) {
    return {
        type: type,
        view: view,
        android: e,
        ios: undefined,
        object: view,
        eventName: gestures_common_1.toString(type),
    };
}
function _getSwipeArgs(direction, view, initialEvent, currentEvent) {
    return {
        type: gestures_common_1.GestureTypes.swipe,
        view: view,
        android: { initial: initialEvent, current: currentEvent },
        direction: direction,
        ios: undefined,
        object: view,
        eventName: gestures_common_1.toString(gestures_common_1.GestureTypes.swipe),
    };
}
function _getPanArgs(deltaX, deltaY, view, state, initialEvent, currentEvent) {
    return {
        type: gestures_common_1.GestureTypes.pan,
        view: view,
        android: { initial: initialEvent, current: currentEvent },
        deltaX: deltaX,
        deltaY: deltaY,
        ios: undefined,
        object: view,
        eventName: gestures_common_1.toString(gestures_common_1.GestureTypes.pan),
        state: state
    };
}
function _executeCallback(observer, args) {
    if (observer && observer.callback) {
        observer.callback.call(observer._context, args);
    }
}
var PinchGestureEventData = (function () {
    function PinchGestureEventData(view, android, scale, object, state) {
        this.view = view;
        this.android = android;
        this.scale = scale;
        this.object = object;
        this.state = state;
        this.type = gestures_common_1.GestureTypes.pinch;
        this.eventName = gestures_common_1.toString(gestures_common_1.GestureTypes.pinch);
    }
    PinchGestureEventData.prototype.getFocusX = function () {
        return this.android.getFocusX() / utils_1.layout.getDisplayDensity();
    };
    PinchGestureEventData.prototype.getFocusY = function () {
        return this.android.getFocusY() / utils_1.layout.getDisplayDensity();
    };
    return PinchGestureEventData;
}());
var CustomPanGestureDetector = (function () {
    function CustomPanGestureDetector(observer, target) {
        this.observer = observer;
        this.target = target;
        this.isTracking = false;
        this.density = utils_1.layout.getDisplayDensity();
    }
    CustomPanGestureDetector.prototype.onTouchEvent = function (event) {
        switch (event.getActionMasked()) {
            case android.view.MotionEvent.ACTION_UP:
            case android.view.MotionEvent.ACTION_CANCEL:
                this.trackStop(event, false);
                break;
            case android.view.MotionEvent.ACTION_DOWN:
            case android.view.MotionEvent.ACTION_POINTER_DOWN:
            case android.view.MotionEvent.ACTION_POINTER_UP:
                this.trackStop(event, true);
                break;
            case android.view.MotionEvent.ACTION_MOVE:
                if (!this.isTracking) {
                    this.trackStart(event);
                }
                this.trackChange(event);
                break;
        }
        return true;
    };
    CustomPanGestureDetector.prototype.trackStop = function (currentEvent, cacheEvent) {
        if (this.isTracking) {
            var args = _getPanArgs(this.deltaX, this.deltaY, this.target, gestures_common_1.GestureStateTypes.ended, null, currentEvent);
            _executeCallback(this.observer, args);
            this.deltaX = undefined;
            this.deltaY = undefined;
            this.isTracking = false;
        }
        if (cacheEvent) {
            this.lastEventCache = currentEvent;
        }
        else {
            this.lastEventCache = undefined;
        }
    };
    CustomPanGestureDetector.prototype.trackStart = function (currentEvent) {
        var inital = this.getEventCoordinates(this.lastEventCache ? this.lastEventCache : currentEvent);
        this.initialX = inital.x;
        this.initialY = inital.y;
        this.isTracking = true;
        var args = _getPanArgs(0, 0, this.target, gestures_common_1.GestureStateTypes.began, null, currentEvent);
        _executeCallback(this.observer, args);
    };
    CustomPanGestureDetector.prototype.trackChange = function (currentEvent) {
        var current = this.getEventCoordinates(currentEvent);
        this.deltaX = current.x - this.initialX;
        this.deltaY = current.y - this.initialY;
        var args = _getPanArgs(this.deltaX, this.deltaY, this.target, gestures_common_1.GestureStateTypes.changed, null, currentEvent);
        _executeCallback(this.observer, args);
    };
    CustomPanGestureDetector.prototype.getEventCoordinates = function (event) {
        var count = event.getPointerCount();
        if (count === 1) {
            return {
                x: event.getRawX() / this.density,
                y: event.getRawY() / this.density
            };
        }
        else {
            var offX = event.getRawX() - event.getX();
            var offY = event.getRawY() - event.getY();
            var res = { x: 0, y: 0 };
            for (var i = 0; i < count; i++) {
                res.x += event.getX(i) + offX;
                res.y += event.getY(i) + offY;
            }
            res.x /= (count * this.density);
            res.y /= (count * this.density);
            return res;
        }
    };
    return CustomPanGestureDetector;
}());
var CustomRotateGestureDetector = (function () {
    function CustomRotateGestureDetector(observer, target) {
        this.observer = observer;
        this.target = target;
        this.trackedPtrId1 = INVALID_POINTER_ID;
        this.trackedPtrId2 = INVALID_POINTER_ID;
    }
    Object.defineProperty(CustomRotateGestureDetector.prototype, "isTracking", {
        get: function () {
            return this.trackedPtrId1 !== INVALID_POINTER_ID && this.trackedPtrId2 !== INVALID_POINTER_ID;
        },
        enumerable: true,
        configurable: true
    });
    CustomRotateGestureDetector.prototype.onTouchEvent = function (event) {
        var pointerID = event.getPointerId(event.getActionIndex());
        var wasTracking = this.isTracking;
        switch (event.getActionMasked()) {
            case android.view.MotionEvent.ACTION_DOWN:
            case android.view.MotionEvent.ACTION_POINTER_DOWN:
                var assigned = false;
                if (this.trackedPtrId1 === INVALID_POINTER_ID && pointerID !== this.trackedPtrId2) {
                    this.trackedPtrId1 = pointerID;
                    assigned = true;
                }
                else if (this.trackedPtrId2 === INVALID_POINTER_ID && pointerID !== this.trackedPtrId1) {
                    this.trackedPtrId2 = pointerID;
                    assigned = true;
                }
                if (assigned && this.isTracking) {
                    this.angle = 0;
                    this.initalPointersAngle = this.getPointersAngle(event);
                    this.executeCallback(event, gestures_common_1.GestureStateTypes.began);
                }
                break;
            case android.view.MotionEvent.ACTION_MOVE:
                if (this.isTracking) {
                    this.updateAngle(event);
                    this.executeCallback(event, gestures_common_1.GestureStateTypes.changed);
                }
                break;
            case android.view.MotionEvent.ACTION_UP:
            case android.view.MotionEvent.ACTION_POINTER_UP:
                if (pointerID === this.trackedPtrId1) {
                    this.trackedPtrId1 = INVALID_POINTER_ID;
                }
                else if (pointerID === this.trackedPtrId2) {
                    this.trackedPtrId2 = INVALID_POINTER_ID;
                }
                if (wasTracking && !this.isTracking) {
                    this.executeCallback(event, gestures_common_1.GestureStateTypes.ended);
                }
                break;
            case android.view.MotionEvent.ACTION_CANCEL:
                this.trackedPtrId1 = INVALID_POINTER_ID;
                this.trackedPtrId2 = INVALID_POINTER_ID;
                if (wasTracking) {
                    this.executeCallback(event, gestures_common_1.GestureStateTypes.cancelled);
                }
                break;
        }
        return true;
    };
    CustomRotateGestureDetector.prototype.executeCallback = function (event, state) {
        var args = {
            type: gestures_common_1.GestureTypes.rotation,
            view: this.target,
            android: event,
            rotation: this.angle,
            ios: undefined,
            object: this.target,
            eventName: gestures_common_1.toString(gestures_common_1.GestureTypes.rotation),
            state: state
        };
        _executeCallback(this.observer, args);
    };
    CustomRotateGestureDetector.prototype.updateAngle = function (event) {
        var newPointersAngle = this.getPointersAngle(event);
        var result = ((newPointersAngle - this.initalPointersAngle) * TO_DEGREES) % 360;
        if (result < -180) {
            result += 360;
        }
        if (result > 180) {
            result -= 360;
        }
        this.angle = result;
    };
    CustomRotateGestureDetector.prototype.getPointersAngle = function (event) {
        var firstX = event.getX(event.findPointerIndex(this.trackedPtrId1));
        var firstY = event.getY(event.findPointerIndex(this.trackedPtrId1));
        var secondX = event.getX(event.findPointerIndex(this.trackedPtrId2));
        var secondY = event.getY(event.findPointerIndex(this.trackedPtrId2));
        return Math.atan2((secondY - firstY), (secondX - firstX));
    };
    return CustomRotateGestureDetector;
}());
var Pointer = (function () {
    function Pointer(id, event) {
        this.event = event;
        this.ios = undefined;
        this.android = id;
    }
    Pointer.prototype.getX = function () {
        return this.event.getX(this.android) / utils_1.layout.getDisplayDensity();
    };
    Pointer.prototype.getY = function () {
        return this.event.getY(this.android) / utils_1.layout.getDisplayDensity();
    };
    return Pointer;
}());
var TouchGestureEventData = (function () {
    function TouchGestureEventData() {
        this.eventName = gestures_common_1.toString(gestures_common_1.GestureTypes.touch);
        this.type = gestures_common_1.GestureTypes.touch;
        this.ios = undefined;
    }
    TouchGestureEventData.prototype.prepare = function (view, e) {
        this.view = view;
        this.object = view;
        this.android = e;
        this.action = this.getActionType(e);
        this._activePointers = undefined;
        this._allPointers = undefined;
    };
    TouchGestureEventData.prototype.getPointerCount = function () {
        return this.android.getPointerCount();
    };
    TouchGestureEventData.prototype.getActivePointers = function () {
        if (!this._activePointers) {
            this._activePointers = [new Pointer(this.android.getActionIndex(), this.android)];
        }
        return this._activePointers;
    };
    TouchGestureEventData.prototype.getAllPointers = function () {
        if (!this._allPointers) {
            this._allPointers = [];
            for (var i = 0; i < this.getPointerCount(); i++) {
                this._allPointers.push(new Pointer(i, this.android));
            }
        }
        return this._allPointers;
    };
    TouchGestureEventData.prototype.getX = function () {
        return this.getActivePointers()[0].getX();
    };
    TouchGestureEventData.prototype.getY = function () {
        return this.getActivePointers()[0].getY();
    };
    TouchGestureEventData.prototype.getActionType = function (e) {
        switch (e.getActionMasked()) {
            case android.view.MotionEvent.ACTION_DOWN:
            case android.view.MotionEvent.ACTION_POINTER_DOWN:
                return gestures_common_1.TouchAction.down;
            case android.view.MotionEvent.ACTION_MOVE:
                return gestures_common_1.TouchAction.move;
            case android.view.MotionEvent.ACTION_UP:
            case android.view.MotionEvent.ACTION_POINTER_UP:
                return gestures_common_1.TouchAction.up;
            case android.view.MotionEvent.ACTION_CANCEL:
                return gestures_common_1.TouchAction.cancel;
        }
        return "";
    };
    return TouchGestureEventData;
}());
//# sourceMappingURL=gestures.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/html-view/html-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var HtmlViewBase = (function (_super) {
    __extends(HtmlViewBase, _super);
    function HtmlViewBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    HtmlViewBase = __decorate([
        view_1.CSSType("HtmlView")
    ], HtmlViewBase);
    return HtmlViewBase;
}(view_1.View));
exports.HtmlViewBase = HtmlViewBase;
HtmlViewBase.prototype.recycleNativeView = "auto";
exports.htmlProperty = new view_1.Property({ name: "html", defaultValue: "", affectsLayout: true });
exports.htmlProperty.register(HtmlViewBase);
//# sourceMappingURL=html-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/html-view/html-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var html_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/html-view/html-view-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/html-view/html-view-common.js"));
var HtmlView = (function (_super) {
    __extends(HtmlView, _super);
    function HtmlView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    HtmlView.prototype.createNativeView = function () {
        return new android.widget.TextView(this._context);
    };
    HtmlView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        nativeView.setLinksClickable(true);
        nativeView.setMovementMethod(android.text.method.LinkMovementMethod.getInstance());
    };
    HtmlView.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        this.nativeViewProtected.setAutoLinkMask(0);
    };
    HtmlView.prototype[html_view_common_1.htmlProperty.getDefault] = function () {
        return "";
    };
    HtmlView.prototype[html_view_common_1.htmlProperty.setNative] = function (value) {
        var mask = 15;
        if (value.search(/<a\s/i) >= 0) {
            mask = 0;
        }
        this.nativeViewProtected.setAutoLinkMask(mask);
        this.nativeViewProtected.setText(android.text.Html.fromHtml(value));
    };
    return HtmlView;
}(html_view_common_1.HtmlViewBase));
exports.HtmlView = HtmlView;
//# sourceMappingURL=html-view.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/image/image-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var image_asset_1 = __webpack_require__("../node_modules/tns-core-modules/image-asset/image-asset.js");
exports.ImageAsset = image_asset_1.ImageAsset;
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
exports.ImageSource = image_source_1.ImageSource;
exports.fromAsset = image_source_1.fromAsset;
exports.fromNativeSource = image_source_1.fromNativeSource;
exports.fromUrl = image_source_1.fromUrl;
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
exports.isDataURI = utils_1.isDataURI;
exports.isFontIconURI = utils_1.isFontIconURI;
exports.isFileOrResourcePath = utils_1.isFileOrResourcePath;
exports.RESOURCE_PREFIX = utils_1.RESOURCE_PREFIX;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ImageBase = (function (_super) {
    __extends(ImageBase, _super);
    function ImageBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ImageBase.prototype, "tintColor", {
        get: function () {
            return this.style.tintColor;
        },
        set: function (value) {
            this.style.tintColor = value;
        },
        enumerable: true,
        configurable: true
    });
    ImageBase.prototype._createImageSourceFromSrc = function (value) {
        var _this = this;
        var originalValue = value;
        var sync = this.loadMode === "sync";
        if (typeof value === "string" || value instanceof String) {
            value = value.trim();
            this.imageSource = null;
            this["_url"] = value;
            this.isLoading = true;
            var source_1 = new image_source_1.ImageSource();
            var imageLoaded = function () {
                var currentValue = _this.src;
                if (currentValue !== originalValue) {
                    return;
                }
                _this.imageSource = source_1;
                _this.isLoading = false;
            };
            if (utils_1.isFontIconURI(value)) {
                var fontIconCode = value.split("//")[1];
                if (fontIconCode !== undefined) {
                    var font = this.style.fontInternal;
                    var color = this.style.color;
                    source_1.loadFromFontIconCode(fontIconCode, font, color);
                    imageLoaded();
                }
            }
            else if (utils_1.isDataURI(value)) {
                var base64Data = value.split(",")[1];
                if (base64Data !== undefined) {
                    if (sync) {
                        source_1.loadFromBase64(base64Data);
                        imageLoaded();
                    }
                    else {
                        source_1.fromBase64(base64Data).then(imageLoaded);
                    }
                }
            }
            else if (utils_1.isFileOrResourcePath(value)) {
                if (value.indexOf(utils_1.RESOURCE_PREFIX) === 0) {
                    var resPath = value.substr(utils_1.RESOURCE_PREFIX.length);
                    if (sync) {
                        source_1.loadFromResource(resPath);
                        imageLoaded();
                    }
                    else {
                        this.imageSource = null;
                        source_1.fromResource(resPath).then(imageLoaded);
                    }
                }
                else {
                    if (sync) {
                        source_1.loadFromFile(value);
                        imageLoaded();
                    }
                    else {
                        this.imageSource = null;
                        source_1.fromFile(value).then(imageLoaded);
                    }
                }
            }
            else {
                this.imageSource = null;
                image_source_1.fromUrl(value).then(function (r) {
                    if (_this["_url"] === value) {
                        _this.imageSource = r;
                        _this.isLoading = false;
                    }
                }, function (err) {
                    _this.isLoading = false;
                    if (view_1.traceEnabled()) {
                        if (typeof err === "object" && err.message) {
                            err = err.message;
                        }
                        view_1.traceWrite(err, view_1.traceCategories.Debug);
                    }
                });
            }
        }
        else if (value instanceof image_source_1.ImageSource) {
            this.imageSource = value;
            this.isLoading = false;
        }
        else if (value instanceof image_asset_1.ImageAsset) {
            image_source_1.fromAsset(value).then(function (result) {
                _this.imageSource = result;
                _this.isLoading = false;
            });
        }
        else {
            this.imageSource = image_source_1.fromNativeSource(value);
            this.isLoading = false;
        }
    };
    ImageBase = __decorate([
        view_1.CSSType("Image")
    ], ImageBase);
    return ImageBase;
}(view_1.View));
exports.ImageBase = ImageBase;
ImageBase.prototype.recycleNativeView = "auto";
exports.imageSourceProperty = new view_1.Property({ name: "imageSource" });
exports.imageSourceProperty.register(ImageBase);
exports.srcProperty = new view_1.Property({ name: "src" });
exports.srcProperty.register(ImageBase);
exports.loadModeProperty = new view_1.Property({ name: "loadMode", defaultValue: "sync" });
exports.loadModeProperty.register(ImageBase);
exports.isLoadingProperty = new view_1.Property({ name: "isLoading", defaultValue: false, valueConverter: view_1.booleanConverter });
exports.isLoadingProperty.register(ImageBase);
exports.stretchProperty = new view_1.Property({ name: "stretch", defaultValue: "aspectFit", affectsLayout: view_1.isIOS });
exports.stretchProperty.register(ImageBase);
exports.tintColorProperty = new view_1.InheritedCssProperty({ name: "tintColor", cssName: "tint-color", equalityComparer: view_1.Color.equals, valueConverter: function (value) { return new view_1.Color(value); } });
exports.tintColorProperty.register(view_1.Style);
exports.decodeHeightProperty = new view_1.Property({ name: "decodeHeight", defaultValue: { value: 0, unit: "dip" }, valueConverter: view_1.Length.parse });
exports.decodeHeightProperty.register(ImageBase);
exports.decodeWidthProperty = new view_1.Property({ name: "decodeWidth", defaultValue: { value: 0, unit: "dip" }, valueConverter: view_1.Length.parse });
exports.decodeWidthProperty.register(ImageBase);
//# sourceMappingURL=image-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/image/image.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var image_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/image/image-common.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/image/image-common.js"));
var FILE_PREFIX = "file:///";
var ASYNC = "async";
var AndroidImageView;
var ImageLoadedListener;
function initializeImageLoadedListener() {
    if (ImageLoadedListener) {
        return;
    }
    var ImageLoadedListenerImpl = (function (_super) {
        __extends(ImageLoadedListenerImpl, _super);
        function ImageLoadedListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        ImageLoadedListenerImpl.prototype.onImageLoaded = function (success) {
            var owner = this.owner;
            if (owner) {
                owner.isLoading = false;
            }
        };
        ImageLoadedListenerImpl = __decorate([
            Interfaces([org.nativescript.widgets.image.Worker.OnImageLoadedListener])
        ], ImageLoadedListenerImpl);
        return ImageLoadedListenerImpl;
    }(java.lang.Object));
    ImageLoadedListener = ImageLoadedListenerImpl;
}
var Image = (function (_super) {
    __extends(Image, _super);
    function Image() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.useCache = true;
        return _this;
    }
    Image.prototype.createNativeView = function () {
        if (!AndroidImageView) {
            AndroidImageView = org.nativescript.widgets.ImageView;
        }
        return new AndroidImageView(this._context);
    };
    Image.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        initializeImageLoadedListener();
        var nativeView = this.nativeViewProtected;
        var listener = new ImageLoadedListener(this);
        nativeView.setImageLoadedListener(listener);
        nativeView.listener = listener;
    };
    Image.prototype.disposeNativeView = function () {
        this.nativeViewProtected.listener.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Image.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        this.nativeViewProtected.setImageMatrix(new android.graphics.Matrix());
    };
    Image.prototype._createImageSourceFromSrc = function (value) {
        var imageView = this.nativeViewProtected;
        if (!imageView) {
            return;
        }
        if (!value) {
            imageView.setUri(null, 0, 0, false, false, true);
            return;
        }
        var screen = platform.screen.mainScreen;
        var decodeWidth = Math.min(image_common_1.Length.toDevicePixels(this.decodeWidth, 0), screen.widthPixels);
        var decodeHeight = Math.min(image_common_1.Length.toDevicePixels(this.decodeHeight, 0), screen.heightPixels);
        var keepAspectRatio = this._calculateKeepAspectRatio();
        if (value instanceof image_common_1.ImageAsset) {
            if (value.options) {
                decodeWidth = value.options.width || decodeWidth;
                decodeHeight = value.options.height || decodeHeight;
                keepAspectRatio = !!value.options.keepAspectRatio;
            }
            value = value.android;
        }
        var async = this.loadMode === ASYNC;
        if (typeof value === "string" || value instanceof String) {
            value = value.trim();
            this.isLoading = true;
            if (image_common_1.isFontIconURI(value) || image_common_1.isDataURI(value)) {
                _super.prototype._createImageSourceFromSrc.call(this, value);
            }
            else if (image_common_1.isFileOrResourcePath(value)) {
                if (value.indexOf(image_common_1.RESOURCE_PREFIX) === 0) {
                    imageView.setUri(value, decodeWidth, decodeHeight, keepAspectRatio, this.useCache, async);
                }
                else {
                    var fileName = value;
                    if (fileName.indexOf("~/") === 0) {
                        fileName = file_system_1.knownFolders.currentApp().path + "/" + fileName.replace("~/", "");
                    }
                    imageView.setUri(FILE_PREFIX + fileName, decodeWidth, decodeHeight, keepAspectRatio, this.useCache, async);
                }
            }
            else {
                imageView.setUri(value, decodeWidth, decodeHeight, keepAspectRatio, this.useCache, true);
            }
        }
        else {
            _super.prototype._createImageSourceFromSrc.call(this, value);
        }
    };
    Image.prototype._calculateKeepAspectRatio = function () {
        return this.stretch === "fill" ? false : true;
    };
    Image.prototype[image_common_1.stretchProperty.getDefault] = function () {
        return "aspectFit";
    };
    Image.prototype[image_common_1.stretchProperty.setNative] = function (value) {
        switch (value) {
            case "aspectFit":
                this.nativeViewProtected.setScaleType(android.widget.ImageView.ScaleType.FIT_CENTER);
                break;
            case "aspectFill":
                this.nativeViewProtected.setScaleType(android.widget.ImageView.ScaleType.CENTER_CROP);
                break;
            case "fill":
                this.nativeViewProtected.setScaleType(android.widget.ImageView.ScaleType.FIT_XY);
                break;
            case "none":
            default:
                this.nativeViewProtected.setScaleType(android.widget.ImageView.ScaleType.MATRIX);
                break;
        }
    };
    Image.prototype[image_common_1.tintColorProperty.getDefault] = function () {
        return undefined;
    };
    Image.prototype[image_common_1.tintColorProperty.setNative] = function (value) {
        if (value === undefined) {
            this.nativeViewProtected.clearColorFilter();
        }
        else {
            this.nativeViewProtected.setColorFilter(value.android);
        }
    };
    Image.prototype[image_common_1.imageSourceProperty.getDefault] = function () {
        return undefined;
    };
    Image.prototype[image_common_1.imageSourceProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        if (value && value.android) {
            var rotation = value.rotationAngle ? value.rotationAngle : 0;
            nativeView.setRotationAngle(rotation);
            nativeView.setImageBitmap(value.android);
        }
        else {
            nativeView.setRotationAngle(0);
            nativeView.setImageBitmap(null);
        }
    };
    Image.prototype[image_common_1.srcProperty.getDefault] = function () {
        return undefined;
    };
    Image.prototype[image_common_1.srcProperty.setNative] = function (value) {
        this._createImageSourceFromSrc(value);
    };
    return Image;
}(image_common_1.ImageBase));
exports.Image = Image;
//# sourceMappingURL=image.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/label/label.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var TextView;
var Label = (function (_super) {
    __extends(Label, _super);
    function Label() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Label.prototype, "textWrap", {
        get: function () {
            return this.style.whiteSpace === "normal";
        },
        set: function (value) {
            if (typeof value === "string") {
                value = text_base_1.booleanConverter(value);
            }
            this.style.whiteSpace = value ? "normal" : "nowrap";
        },
        enumerable: true,
        configurable: true
    });
    Label.prototype.createNativeView = function () {
        if (!TextView) {
            TextView = android.widget.TextView;
        }
        return new TextView(this._context);
    };
    Label.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var textView = this.nativeTextViewProtected;
        textView.setSingleLine(true);
        textView.setEllipsize(android.text.TextUtils.TruncateAt.END);
    };
    Label.prototype[text_base_1.whiteSpaceProperty.setNative] = function (value) {
        var newValue = value === "initial" ? "nowrap" : value;
        _super.prototype[text_base_1.whiteSpaceProperty.setNative].call(this, newValue);
    };
    __decorate([
        profiling_1.profile
    ], Label.prototype, "createNativeView", null);
    Label = __decorate([
        text_base_1.CSSType("Label")
    ], Label);
    return Label;
}(text_base_1.TextBase));
exports.Label = Label;
Label.prototype._isSingleLine = true;
Label.prototype.recycleNativeView = "auto";
//# sourceMappingURL=label.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
layout_base_1.View.prototype.effectiveLeft = 0;
layout_base_1.View.prototype.effectiveTop = 0;
function validateArgs(element) {
    if (!element) {
        throw new Error("element cannot be null or undefinied.");
    }
    return element;
}
var AbsoluteLayoutBase = (function (_super) {
    __extends(AbsoluteLayoutBase, _super);
    function AbsoluteLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AbsoluteLayoutBase.getLeft = function (element) {
        return validateArgs(element).left;
    };
    AbsoluteLayoutBase.setLeft = function (element, value) {
        validateArgs(element).left = value;
    };
    AbsoluteLayoutBase.getTop = function (element) {
        return validateArgs(element).top;
    };
    AbsoluteLayoutBase.setTop = function (element, value) {
        validateArgs(element).top = value;
    };
    AbsoluteLayoutBase.prototype.onLeftChanged = function (view, oldValue, newValue) {
    };
    AbsoluteLayoutBase.prototype.onTopChanged = function (view, oldValue, newValue) {
    };
    AbsoluteLayoutBase = __decorate([
        layout_base_1.CSSType("AbsoluteLayout")
    ], AbsoluteLayoutBase);
    return AbsoluteLayoutBase;
}(layout_base_1.LayoutBase));
exports.AbsoluteLayoutBase = AbsoluteLayoutBase;
AbsoluteLayoutBase.prototype.recycleNativeView = "auto";
exports.leftProperty = new layout_base_1.Property({
    name: "left", defaultValue: layout_base_1.zeroLength,
    valueChanged: function (target, oldValue, newValue) {
        target.effectiveLeft = layout_base_1.Length.toDevicePixels(newValue, 0);
        var layout = target.parent;
        if (layout instanceof AbsoluteLayoutBase) {
            layout.onLeftChanged(target, oldValue, newValue);
        }
    }, valueConverter: function (v) { return layout_base_1.Length.parse(v); }
});
exports.leftProperty.register(layout_base_1.View);
exports.topProperty = new layout_base_1.Property({
    name: "top", defaultValue: layout_base_1.zeroLength,
    valueChanged: function (target, oldValue, newValue) {
        target.effectiveTop = layout_base_1.Length.toDevicePixels(newValue, 0);
        var layout = target.parent;
        if (layout instanceof AbsoluteLayoutBase) {
            layout.onTopChanged(target, oldValue, newValue);
        }
    }, valueConverter: function (v) { return layout_base_1.Length.parse(v); }
});
exports.topProperty.register(layout_base_1.View);
//# sourceMappingURL=absolute-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var absolute_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout-common.js"));
function makeNativeSetter(setter) {
    return function (value) {
        var nativeView = this.nativeViewProtected;
        var lp = nativeView.getLayoutParams() || new org.nativescript.widgets.CommonLayoutParams();
        if (lp instanceof org.nativescript.widgets.CommonLayoutParams) {
            setter.call(this, lp, value);
            nativeView.setLayoutParams(lp);
        }
    };
}
absolute_layout_common_1.View.prototype[absolute_layout_common_1.topProperty.setNative] = makeNativeSetter(function (lp, value) { lp.top = absolute_layout_common_1.Length.toDevicePixels(value, 0); });
absolute_layout_common_1.View.prototype[absolute_layout_common_1.leftProperty.setNative] = makeNativeSetter(function (lp, value) { lp.left = absolute_layout_common_1.Length.toDevicePixels(value, 0); });
var AbsoluteLayout = (function (_super) {
    __extends(AbsoluteLayout, _super);
    function AbsoluteLayout() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AbsoluteLayout.prototype.createNativeView = function () {
        return new org.nativescript.widgets.AbsoluteLayout(this._context);
    };
    return AbsoluteLayout;
}(absolute_layout_common_1.AbsoluteLayoutBase));
exports.AbsoluteLayout = AbsoluteLayout;
//# sourceMappingURL=absolute-layout.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
function validateArgs(element) {
    if (!element) {
        throw new Error("element cannot be null or undefinied.");
    }
    return element;
}
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
var DockLayoutBase = (function (_super) {
    __extends(DockLayoutBase, _super);
    function DockLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DockLayoutBase.getDock = function (element) {
        return validateArgs(element).dock;
    };
    DockLayoutBase.setDock = function (element, value) {
        validateArgs(element).dock = value;
    };
    DockLayoutBase.prototype.onDockChanged = function (view, oldValue, newValue) {
    };
    DockLayoutBase = __decorate([
        layout_base_1.CSSType("DockLayout")
    ], DockLayoutBase);
    return DockLayoutBase;
}(layout_base_1.LayoutBase));
exports.DockLayoutBase = DockLayoutBase;
DockLayoutBase.prototype.recycleNativeView = "auto";
var dockConverter = layout_base_1.makeParser(layout_base_1.makeValidator("left", "top", "right", "bottom"));
exports.dockProperty = new layout_base_1.Property({
    name: "dock", defaultValue: "left", valueChanged: function (target, oldValue, newValue) {
        if (target instanceof layout_base_1.View) {
            var layout = target.parent;
            if (layout instanceof DockLayoutBase) {
                layout.onDockChanged(target, oldValue, newValue);
            }
        }
    }, valueConverter: dockConverter
});
exports.dockProperty.register(layout_base_1.View);
exports.stretchLastChildProperty = new layout_base_1.Property({
    name: "stretchLastChild", defaultValue: true, affectsLayout: layout_base_1.isIOS, valueConverter: layout_base_1.booleanConverter
});
exports.stretchLastChildProperty.register(DockLayoutBase);
//# sourceMappingURL=dock-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var dock_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout-common.js"));
dock_layout_common_1.View.prototype[dock_layout_common_1.dockProperty.setNative] = function (value) {
    var nativeView = this.nativeViewProtected;
    var lp = nativeView.getLayoutParams() || new org.nativescript.widgets.CommonLayoutParams();
    if (lp instanceof org.nativescript.widgets.CommonLayoutParams) {
        switch (value) {
            case "left":
                lp.dock = org.nativescript.widgets.Dock.left;
                break;
            case "top":
                lp.dock = org.nativescript.widgets.Dock.top;
                break;
            case "right":
                lp.dock = org.nativescript.widgets.Dock.right;
                break;
            case "bottom":
                lp.dock = org.nativescript.widgets.Dock.bottom;
                break;
            default:
                throw new Error("Invalid value for dock property: " + value);
        }
        nativeView.setLayoutParams(lp);
    }
};
var DockLayout = (function (_super) {
    __extends(DockLayout, _super);
    function DockLayout() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DockLayout.prototype.createNativeView = function () {
        return new org.nativescript.widgets.DockLayout(this._context);
    };
    DockLayout.prototype[dock_layout_common_1.stretchLastChildProperty.getDefault] = function () {
        return true;
    };
    DockLayout.prototype[dock_layout_common_1.stretchLastChildProperty.setNative] = function (value) {
        this.nativeViewProtected.setStretchLastChild(value);
    };
    return DockLayout;
}(dock_layout_common_1.DockLayoutBase));
exports.DockLayout = DockLayout;
//# sourceMappingURL=dock-layout.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
exports.ORDER_DEFAULT = 1;
exports.FLEX_GROW_DEFAULT = 0.0;
exports.FLEX_SHRINK_DEFAULT = 1.0;
var FlexDirection;
(function (FlexDirection) {
    FlexDirection.ROW = "row";
    FlexDirection.ROW_REVERSE = "row-reverse";
    FlexDirection.COLUMN = "column";
    FlexDirection.COLUMN_REVERSE = "column-reverse";
    FlexDirection.isValid = layout_base_1.makeValidator(FlexDirection.ROW, FlexDirection.ROW_REVERSE, FlexDirection.COLUMN, FlexDirection.COLUMN_REVERSE);
    FlexDirection.parse = layout_base_1.makeParser(FlexDirection.isValid);
})(FlexDirection = exports.FlexDirection || (exports.FlexDirection = {}));
var FlexWrap;
(function (FlexWrap) {
    FlexWrap.NOWRAP = "nowrap";
    FlexWrap.WRAP = "wrap";
    FlexWrap.WRAP_REVERSE = "wrap-reverse";
    FlexWrap.isValid = layout_base_1.makeValidator(FlexWrap.NOWRAP, FlexWrap.WRAP, FlexWrap.WRAP_REVERSE);
    FlexWrap.parse = layout_base_1.makeParser(FlexWrap.isValid);
})(FlexWrap = exports.FlexWrap || (exports.FlexWrap = {}));
var JustifyContent;
(function (JustifyContent) {
    JustifyContent.FLEX_START = "flex-start";
    JustifyContent.FLEX_END = "flex-end";
    JustifyContent.CENTER = "center";
    JustifyContent.SPACE_BETWEEN = "space-between";
    JustifyContent.SPACE_AROUND = "space-around";
    JustifyContent.isValid = layout_base_1.makeValidator(JustifyContent.FLEX_START, JustifyContent.FLEX_END, JustifyContent.CENTER, JustifyContent.SPACE_BETWEEN, JustifyContent.SPACE_AROUND);
    JustifyContent.parse = layout_base_1.makeParser(JustifyContent.isValid);
})(JustifyContent = exports.JustifyContent || (exports.JustifyContent = {}));
var FlexBasisPercent;
(function (FlexBasisPercent) {
    FlexBasisPercent.DEFAULT = -1;
})(FlexBasisPercent = exports.FlexBasisPercent || (exports.FlexBasisPercent = {}));
var AlignItems;
(function (AlignItems) {
    AlignItems.FLEX_START = "flex-start";
    AlignItems.FLEX_END = "flex-end";
    AlignItems.CENTER = "center";
    AlignItems.BASELINE = "baseline";
    AlignItems.STRETCH = "stretch";
    AlignItems.isValid = layout_base_1.makeValidator(AlignItems.FLEX_START, AlignItems.FLEX_END, AlignItems.CENTER, AlignItems.BASELINE, AlignItems.STRETCH);
    AlignItems.parse = layout_base_1.makeParser(AlignItems.isValid);
})(AlignItems = exports.AlignItems || (exports.AlignItems = {}));
var AlignContent;
(function (AlignContent) {
    AlignContent.FLEX_START = "flex-start";
    AlignContent.FLEX_END = "flex-end";
    AlignContent.CENTER = "center";
    AlignContent.SPACE_BETWEEN = "space-between";
    AlignContent.SPACE_AROUND = "space-around";
    AlignContent.STRETCH = "stretch";
    AlignContent.isValid = layout_base_1.makeValidator(AlignContent.FLEX_START, AlignContent.FLEX_END, AlignContent.CENTER, AlignContent.SPACE_BETWEEN, AlignContent.SPACE_AROUND, AlignContent.STRETCH);
    AlignContent.parse = layout_base_1.makeParser(AlignContent.isValid);
})(AlignContent = exports.AlignContent || (exports.AlignContent = {}));
var Order;
(function (Order) {
    function isValid(value) {
        return isFinite(parseInt(value));
    }
    Order.isValid = isValid;
    Order.parse = parseInt;
})(Order = exports.Order || (exports.Order = {}));
var FlexGrow;
(function (FlexGrow) {
    function isValid(value) {
        var parsed = parseInt(value);
        return isFinite(parsed) && value >= 0;
    }
    FlexGrow.isValid = isValid;
    FlexGrow.parse = parseFloat;
})(FlexGrow = exports.FlexGrow || (exports.FlexGrow = {}));
var FlexShrink;
(function (FlexShrink) {
    function isValid(value) {
        var parsed = parseInt(value);
        return isFinite(parsed) && value >= 0;
    }
    FlexShrink.isValid = isValid;
    FlexShrink.parse = parseFloat;
})(FlexShrink = exports.FlexShrink || (exports.FlexShrink = {}));
var FlexWrapBefore;
(function (FlexWrapBefore) {
    function isValid(value) {
        if (typeof value === "boolean") {
            return true;
        }
        if (typeof value === "string") {
            var str = value.trim().toLowerCase();
            return str === "true" || str === "false";
        }
        return false;
    }
    FlexWrapBefore.isValid = isValid;
    function parse(value) {
        return value && value.toString().trim().toLowerCase() === "true";
    }
    FlexWrapBefore.parse = parse;
})(FlexWrapBefore = exports.FlexWrapBefore || (exports.FlexWrapBefore = {}));
var AlignSelf;
(function (AlignSelf) {
    AlignSelf.AUTO = "auto";
    AlignSelf.FLEX_START = "flex-start";
    AlignSelf.FLEX_END = "flex-end";
    AlignSelf.CENTER = "center";
    AlignSelf.BASELINE = "baseline";
    AlignSelf.STRETCH = "stretch";
    AlignSelf.isValid = layout_base_1.makeValidator(AlignSelf.AUTO, AlignSelf.FLEX_START, AlignSelf.FLEX_END, AlignSelf.CENTER, AlignSelf.BASELINE, AlignSelf.STRETCH);
    AlignSelf.parse = layout_base_1.makeParser(AlignSelf.isValid);
})(AlignSelf = exports.AlignSelf || (exports.AlignSelf = {}));
function validateArgs(element) {
    if (!element) {
        throw new Error("element cannot be null or undefinied.");
    }
    return element;
}
var FlexboxLayoutBase = (function (_super) {
    __extends(FlexboxLayoutBase, _super);
    function FlexboxLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(FlexboxLayoutBase.prototype, "flexDirection", {
        get: function () {
            return this.style.flexDirection;
        },
        set: function (value) {
            this.style.flexDirection = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexboxLayoutBase.prototype, "flexWrap", {
        get: function () {
            return this.style.flexWrap;
        },
        set: function (value) {
            this.style.flexWrap = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexboxLayoutBase.prototype, "justifyContent", {
        get: function () {
            return this.style.justifyContent;
        },
        set: function (value) {
            this.style.justifyContent = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexboxLayoutBase.prototype, "alignItems", {
        get: function () {
            return this.style.alignItems;
        },
        set: function (value) {
            this.style.alignItems = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexboxLayoutBase.prototype, "alignContent", {
        get: function () {
            return this.style.alignContent;
        },
        set: function (value) {
            this.style.alignContent = value;
        },
        enumerable: true,
        configurable: true
    });
    FlexboxLayoutBase.setOrder = function (view, order) {
        validateArgs(view).style.order = order;
    };
    FlexboxLayoutBase.getOrder = function (view) {
        return validateArgs(view).style.order;
    };
    FlexboxLayoutBase.setFlexGrow = function (view, grow) {
        validateArgs(view).style.flexGrow = grow;
    };
    FlexboxLayoutBase.getFlexGrow = function (view) {
        return validateArgs(view).style.flexGrow;
    };
    FlexboxLayoutBase.setFlexShrink = function (view, shrink) {
        validateArgs(view).style.flexShrink = shrink;
    };
    FlexboxLayoutBase.getFlexShrink = function (view) {
        return validateArgs(view).style.flexShrink;
    };
    FlexboxLayoutBase.setAlignSelf = function (view, align) {
        validateArgs(view).style.alignSelf = align;
    };
    FlexboxLayoutBase.getAlignSelf = function (view) {
        return validateArgs(view).style.alignSelf;
    };
    FlexboxLayoutBase.setFlexWrapBefore = function (view, wrap) {
        validateArgs(view).style.flexWrapBefore = wrap;
    };
    FlexboxLayoutBase.getFlexWrapBefore = function (view) {
        return validateArgs(view).style.flexWrapBefore;
    };
    FlexboxLayoutBase = __decorate([
        layout_base_1.CSSType("FlexboxLayout")
    ], FlexboxLayoutBase);
    return FlexboxLayoutBase;
}(layout_base_1.LayoutBase));
exports.FlexboxLayoutBase = FlexboxLayoutBase;
FlexboxLayoutBase.prototype.recycleNativeView = "auto";
exports.flexDirectionProperty = new layout_base_1.CssProperty({ name: "flexDirection", cssName: "flex-direction", defaultValue: FlexDirection.ROW, affectsLayout: layout_base_1.isIOS, valueConverter: FlexDirection.parse });
exports.flexDirectionProperty.register(layout_base_1.Style);
exports.flexWrapProperty = new layout_base_1.CssProperty({ name: "flexWrap", cssName: "flex-wrap", defaultValue: "nowrap", affectsLayout: layout_base_1.isIOS, valueConverter: FlexWrap.parse });
exports.flexWrapProperty.register(layout_base_1.Style);
exports.justifyContentProperty = new layout_base_1.CssProperty({ name: "justifyContent", cssName: "justify-content", defaultValue: JustifyContent.FLEX_START, affectsLayout: layout_base_1.isIOS, valueConverter: JustifyContent.parse });
exports.justifyContentProperty.register(layout_base_1.Style);
exports.alignItemsProperty = new layout_base_1.CssProperty({ name: "alignItems", cssName: "align-items", defaultValue: AlignItems.STRETCH, affectsLayout: layout_base_1.isIOS, valueConverter: AlignItems.parse });
exports.alignItemsProperty.register(layout_base_1.Style);
exports.alignContentProperty = new layout_base_1.CssProperty({ name: "alignContent", cssName: "align-content", defaultValue: AlignContent.STRETCH, affectsLayout: layout_base_1.isIOS, valueConverter: AlignContent.parse });
exports.alignContentProperty.register(layout_base_1.Style);
exports.orderProperty = new layout_base_1.CssProperty({ name: "order", cssName: "order", defaultValue: exports.ORDER_DEFAULT, valueConverter: Order.parse });
exports.orderProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "order", {
    get: function () {
        return this.style.order;
    },
    set: function (value) {
        this.style.order = value;
    },
    enumerable: true,
    configurable: true
});
exports.flexGrowProperty = new layout_base_1.CssProperty({ name: "flexGrow", cssName: "flex-grow", defaultValue: exports.FLEX_GROW_DEFAULT, valueConverter: FlexGrow.parse });
exports.flexGrowProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "flexGrow", {
    get: function () {
        return this.style.flexGrow;
    },
    set: function (value) {
        this.style.flexGrow = value;
    },
    enumerable: true,
    configurable: true
});
exports.flexShrinkProperty = new layout_base_1.CssProperty({ name: "flexShrink", cssName: "flex-shrink", defaultValue: exports.FLEX_SHRINK_DEFAULT, valueConverter: FlexShrink.parse });
exports.flexShrinkProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "flexShrink", {
    get: function () {
        return this.style.flexShrink;
    },
    set: function (value) {
        this.style.flexShrink = value;
    },
    enumerable: true,
    configurable: true
});
exports.flexWrapBeforeProperty = new layout_base_1.CssProperty({ name: "flexWrapBefore", cssName: "flex-wrap-before", defaultValue: false, valueConverter: FlexWrapBefore.parse });
exports.flexWrapBeforeProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "flexWrapBefore", {
    get: function () {
        return this.style.flexWrapBefore;
    },
    set: function (value) {
        this.style.flexWrapBefore = value;
    },
    enumerable: true,
    configurable: true
});
exports.alignSelfProperty = new layout_base_1.CssProperty({ name: "alignSelf", cssName: "align-self", defaultValue: AlignSelf.AUTO, valueConverter: AlignSelf.parse });
exports.alignSelfProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "alignSelf", {
    get: function () {
        return this.style.alignSelf;
    },
    set: function (value) {
        this.style.alignSelf = value;
    },
    enumerable: true,
    configurable: true
});
var flexFlowProperty = new layout_base_1.ShorthandProperty({
    name: "flexFlow", cssName: "flex-flow",
    getter: function () {
        return this.flexDirection + " " + this.flexWrap;
    },
    converter: function (value) {
        var properties = [];
        if (value === layout_base_1.unsetValue) {
            properties.push([exports.flexDirectionProperty, value]);
            properties.push([exports.flexWrapProperty, value]);
        }
        else {
            var trimmed = value && value.trim();
            if (trimmed) {
                var values = trimmed.split(/\s+/);
                if (values.length >= 1 && FlexDirection.isValid(values[0])) {
                    properties.push([exports.flexDirectionProperty, FlexDirection.parse(values[0])]);
                }
                if (value.length >= 2 && FlexWrap.isValid(values[1])) {
                    properties.push([exports.flexWrapProperty, FlexWrap.parse(values[1])]);
                }
            }
        }
        return properties;
    }
});
flexFlowProperty.register(layout_base_1.Style);
var flexProperty = new layout_base_1.ShorthandProperty({
    name: "flex", cssName: "flex",
    getter: function () {
        return this.flexGrow + " " + this.flexShrink;
    },
    converter: function (value) {
        var properties = [];
        if (value === layout_base_1.unsetValue) {
            properties.push([exports.flexGrowProperty, value]);
            properties.push([exports.flexShrinkProperty, value]);
        }
        else {
            var trimmed = value && value.trim();
            if (trimmed) {
                var values = trimmed.split(/\s+/);
                if (values.length === 1) {
                    switch (values[0]) {
                        case "inital":
                            properties.push([exports.flexGrowProperty, 0]);
                            properties.push([exports.flexShrinkProperty, 1]);
                            break;
                        case "auto":
                            properties.push([exports.flexGrowProperty, 1]);
                            properties.push([exports.flexShrinkProperty, 1]);
                            break;
                        case "none":
                            properties.push([exports.flexGrowProperty, 0]);
                            properties.push([exports.flexShrinkProperty, 0]);
                            break;
                        default:
                            if (FlexGrow.isValid(values[0])) {
                                properties.push([exports.flexGrowProperty, FlexGrow.parse(values[0])]);
                                properties.push([exports.flexShrinkProperty, 1]);
                            }
                    }
                }
                if (values.length >= 2) {
                    if (FlexGrow.isValid(values[0]) && FlexShrink.isValid(values[1])) {
                        properties.push([exports.flexGrowProperty, FlexGrow.parse(values[0])]);
                        properties.push([exports.flexShrinkProperty, FlexShrink.parse(values[1])]);
                    }
                }
            }
        }
        return properties;
    }
});
flexProperty.register(layout_base_1.Style);
//# sourceMappingURL=flexbox-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
var _a, _b, _c, _d, _e, _f;
Object.defineProperty(exports, "__esModule", { value: true });
var flexbox_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout-common.js"));
var widgetFlexboxLayout;
var widgetLayoutParams;
function makeNativeSetter(setter) {
    return function (value) {
        var nativeView = this.nativeViewProtected;
        var lp = nativeView.getLayoutParams() || new widgetLayoutParams();
        if (lp instanceof widgetLayoutParams) {
            setter(lp, value);
            nativeView.setLayoutParams(lp);
        }
    };
}
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.orderProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.order = value; });
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.flexGrowProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.flexGrow = value; });
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.flexShrinkProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.flexShrink = value; });
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.flexWrapBeforeProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.wrapBefore = value; });
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.alignSelfProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.alignSelf = alignSelfMap[value]; });
var flexDirectionMap = (_a = {},
    _a[flexbox_layout_common_1.FlexDirection.ROW] = 0,
    _a[flexbox_layout_common_1.FlexDirection.ROW_REVERSE] = 1,
    _a[flexbox_layout_common_1.FlexDirection.COLUMN] = 2,
    _a[flexbox_layout_common_1.FlexDirection.COLUMN_REVERSE] = 3,
    _a);
var flexWrapMap = (_b = {},
    _b[flexbox_layout_common_1.FlexWrap.NOWRAP] = 0,
    _b[flexbox_layout_common_1.FlexWrap.WRAP] = 1,
    _b[flexbox_layout_common_1.FlexWrap.WRAP_REVERSE] = 2,
    _b);
var justifyContentMap = (_c = {},
    _c[flexbox_layout_common_1.JustifyContent.FLEX_START] = 0,
    _c[flexbox_layout_common_1.JustifyContent.FLEX_END] = 1,
    _c[flexbox_layout_common_1.JustifyContent.CENTER] = 2,
    _c[flexbox_layout_common_1.JustifyContent.SPACE_BETWEEN] = 3,
    _c[flexbox_layout_common_1.JustifyContent.SPACE_AROUND] = 4,
    _c);
var alignItemsMap = (_d = {},
    _d[flexbox_layout_common_1.AlignItems.FLEX_START] = 0,
    _d[flexbox_layout_common_1.AlignItems.FLEX_END] = 1,
    _d[flexbox_layout_common_1.AlignItems.CENTER] = 2,
    _d[flexbox_layout_common_1.AlignItems.BASELINE] = 3,
    _d[flexbox_layout_common_1.AlignItems.STRETCH] = 4,
    _d);
var alignContentMap = (_e = {},
    _e[flexbox_layout_common_1.AlignContent.FLEX_START] = 0,
    _e[flexbox_layout_common_1.AlignContent.FLEX_END] = 1,
    _e[flexbox_layout_common_1.AlignContent.CENTER] = 2,
    _e[flexbox_layout_common_1.AlignContent.SPACE_BETWEEN] = 3,
    _e[flexbox_layout_common_1.AlignContent.SPACE_AROUND] = 4,
    _e[flexbox_layout_common_1.AlignContent.STRETCH] = 5,
    _e);
var alignSelfMap = (_f = {},
    _f[flexbox_layout_common_1.AlignSelf.AUTO] = -1,
    _f[flexbox_layout_common_1.AlignSelf.FLEX_START] = 0,
    _f[flexbox_layout_common_1.AlignSelf.FLEX_END] = 1,
    _f[flexbox_layout_common_1.AlignSelf.CENTER] = 2,
    _f[flexbox_layout_common_1.AlignSelf.BASELINE] = 3,
    _f[flexbox_layout_common_1.AlignSelf.STRETCH] = 4,
    _f);
var FlexboxLayout = (function (_super) {
    __extends(FlexboxLayout, _super);
    function FlexboxLayout() {
        var _this = _super.call(this) || this;
        if (!widgetFlexboxLayout) {
            widgetFlexboxLayout = org.nativescript.widgets.FlexboxLayout;
            widgetLayoutParams = widgetFlexboxLayout.LayoutParams;
        }
        return _this;
    }
    FlexboxLayout.prototype.createNativeView = function () {
        return new widgetFlexboxLayout(this._context);
    };
    FlexboxLayout.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        this.nativeViewProtected.invalidateOrdersCache();
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.flexDirectionProperty.getDefault] = function () {
        return flexbox_layout_common_1.flexDirectionProperty.defaultValue;
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.flexDirectionProperty.setNative] = function (flexDirection) {
        this.nativeViewProtected.setFlexDirection(flexDirectionMap[flexDirection]);
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.flexWrapProperty.getDefault] = function () {
        return flexbox_layout_common_1.flexWrapProperty.defaultValue;
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.flexWrapProperty.setNative] = function (flexWrap) {
        this.nativeViewProtected.setFlexWrap(flexWrapMap[flexWrap]);
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.justifyContentProperty.getDefault] = function () {
        return flexbox_layout_common_1.justifyContentProperty.defaultValue;
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.justifyContentProperty.setNative] = function (justifyContent) {
        this.nativeViewProtected.setJustifyContent(justifyContentMap[justifyContent]);
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.alignItemsProperty.getDefault] = function () {
        return flexbox_layout_common_1.alignItemsProperty.defaultValue;
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.alignItemsProperty.setNative] = function (alignItems) {
        this.nativeViewProtected.setAlignItems(alignItemsMap[alignItems]);
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.alignContentProperty.getDefault] = function () {
        return flexbox_layout_common_1.alignContentProperty.defaultValue;
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.alignContentProperty.setNative] = function (alignContent) {
        this.nativeViewProtected.setAlignContent(alignContentMap[alignContent]);
    };
    FlexboxLayout.prototype._updateNativeLayoutParams = function (child) {
        _super.prototype._updateNativeLayoutParams.call(this, child);
        var lp = child.nativeViewProtected.getLayoutParams();
        var style = child.style;
        lp.order = style.order;
        lp.flexGrow = style.flexGrow;
        lp.flexShrink = style.flexShrink;
        lp.wrapBefore = style.flexWrapBefore;
        lp.alignSelf = alignSelfMap[style.alignSelf];
        child.nativeViewProtected.setLayoutParams(lp);
    };
    FlexboxLayout.prototype._setChildMinWidthNative = function (child) {
        child._setMinWidthNative(0);
        var nativeView = child.nativeViewProtected;
        var lp = nativeView.getLayoutParams();
        if (lp instanceof widgetLayoutParams) {
            lp.minWidth = flexbox_layout_common_1.Length.toDevicePixels(child.style.minWidth, 0);
            nativeView.setLayoutParams(lp);
        }
    };
    FlexboxLayout.prototype._setChildMinHeightNative = function (child) {
        child._setMinHeightNative(0);
        var nativeView = child.nativeViewProtected;
        var lp = nativeView.getLayoutParams();
        if (lp instanceof widgetLayoutParams) {
            lp.minHeight = flexbox_layout_common_1.Length.toDevicePixels(child.style.minHeight, 0);
            nativeView.setLayoutParams(lp);
        }
    };
    return FlexboxLayout;
}(flexbox_layout_common_1.FlexboxLayoutBase));
exports.FlexboxLayout = FlexboxLayout;
//# sourceMappingURL=flexbox-layout.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
function validateArgs(element) {
    if (!element) {
        throw new Error("element cannot be null or undefined.");
    }
    return element;
}
layout_base_1.View.prototype.row = 0;
layout_base_1.View.prototype.col = 0;
layout_base_1.View.prototype.rowSpan = 1;
layout_base_1.View.prototype.colSpan = 1;
Object.defineProperty(layout_base_1.View.prototype, "column", {
    get: function () { return this.col; },
    set: function (value) { this.col = value; },
    enumerable: true,
    configurable: true
});
Object.defineProperty(layout_base_1.View.prototype, "columnSpan", {
    get: function () { return this.colSpan; },
    set: function (value) { this.colSpan = value; },
    enumerable: true,
    configurable: true
});
function validateItemSpec(itemSpec) {
    if (!itemSpec) {
        throw new Error("Value cannot be undefined.");
    }
    if (itemSpec.owner) {
        throw new Error("itemSpec is already added to GridLayout.");
    }
}
function convertGridLength(value) {
    if (value === GridUnitType.AUTO) {
        return ItemSpec.create(1, GridUnitType.AUTO);
    }
    else if (value.indexOf("*") !== -1) {
        var starCount = parseInt(value.replace("*", "") || "1");
        return ItemSpec.create(starCount, GridUnitType.STAR);
    }
    else if (!isNaN(parseInt(value))) {
        return ItemSpec.create(parseInt(value), GridUnitType.PIXEL);
    }
    else {
        throw new Error("Cannot parse item spec from string: " + value);
    }
}
function parseAndAddItemSpecs(value, func) {
    var arr = value.split(/[\s,]+/);
    for (var i = 0, length_1 = arr.length; i < length_1; i++) {
        var str = arr[i].trim();
        if (str.length > 0) {
            func(convertGridLength(arr[i].trim()));
        }
    }
}
var ItemSpec = (function (_super) {
    __extends(ItemSpec, _super);
    function ItemSpec() {
        var _this = _super.call(this) || this;
        _this._actualLength = 0;
        if (arguments.length === 0) {
            _this._value = 1;
            _this._unitType = GridUnitType.STAR;
        }
        else if (arguments.length === 2) {
            var value = arguments[0];
            var type = arguments[1];
            if (typeof value === "number" && typeof type === "string") {
                if (value < 0 || isNaN(value) || !isFinite(value)) {
                    throw new Error("Value should not be negative, NaN or Infinity: " + value);
                }
                _this._value = value;
                _this._unitType = GridUnitType.parse(type);
            }
            else {
                throw new Error("First argument should be number, second argument should be string.");
            }
        }
        else {
            throw new Error("ItemSpec expects 0 or 2 arguments");
        }
        _this.index = -1;
        return _this;
    }
    ItemSpec.create = function (value, type) {
        var spec = new ItemSpec();
        spec._value = value;
        spec._unitType = type;
        return spec;
    };
    Object.defineProperty(ItemSpec.prototype, "actualLength", {
        get: function () {
            return this._actualLength;
        },
        enumerable: true,
        configurable: true
    });
    ItemSpec.equals = function (value1, value2) {
        return (value1.gridUnitType === value2.gridUnitType) && (value1.value === value2.value) && (value1.owner === value2.owner) && (value1.index === value2.index);
    };
    Object.defineProperty(ItemSpec.prototype, "gridUnitType", {
        get: function () {
            return this._unitType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ItemSpec.prototype, "isAbsolute", {
        get: function () {
            return this._unitType === GridUnitType.PIXEL;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ItemSpec.prototype, "isAuto", {
        get: function () {
            return this._unitType === GridUnitType.AUTO;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ItemSpec.prototype, "isStar", {
        get: function () {
            return this._unitType === GridUnitType.STAR;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ItemSpec.prototype, "value", {
        get: function () {
            return this._value;
        },
        enumerable: true,
        configurable: true
    });
    return ItemSpec;
}(layout_base_1.Observable));
exports.ItemSpec = ItemSpec;
var GridLayoutBase = (function (_super) {
    __extends(GridLayoutBase, _super);
    function GridLayoutBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._rows = new Array();
        _this._cols = new Array();
        return _this;
    }
    GridLayoutBase_1 = GridLayoutBase;
    GridLayoutBase.getColumn = function (element) {
        return validateArgs(element).col;
    };
    GridLayoutBase.setColumn = function (element, value) {
        validateArgs(element).col = value;
    };
    GridLayoutBase.getColumnSpan = function (element) {
        return validateArgs(element).colSpan;
    };
    GridLayoutBase.setColumnSpan = function (element, value) {
        validateArgs(element).colSpan = value;
    };
    GridLayoutBase.getRow = function (element) {
        return validateArgs(element).row;
    };
    GridLayoutBase.setRow = function (element, value) {
        validateArgs(element).row = value;
    };
    GridLayoutBase.getRowSpan = function (element) {
        return validateArgs(element).rowSpan;
    };
    GridLayoutBase.setRowSpan = function (element, value) {
        validateArgs(element).rowSpan = value;
    };
    GridLayoutBase.prototype.addRow = function (itemSpec) {
        validateItemSpec(itemSpec);
        itemSpec.owner = this;
        this._rows.push(itemSpec);
        this._onRowAdded(itemSpec);
        this.invalidate();
    };
    GridLayoutBase.prototype.addColumn = function (itemSpec) {
        validateItemSpec(itemSpec);
        itemSpec.owner = this;
        this._cols.push(itemSpec);
        this._onColumnAdded(itemSpec);
        this.invalidate();
    };
    GridLayoutBase.prototype.addChildAtCell = function (view, row, column, rowSpan, columnSpan) {
        this.addChild(view);
        GridLayoutBase_1.setRow(view, row);
        GridLayoutBase_1.setColumn(view, column);
        if (rowSpan) {
            GridLayoutBase_1.setRowSpan(view, rowSpan);
        }
        if (columnSpan) {
            GridLayoutBase_1.setColumnSpan(view, columnSpan);
        }
    };
    GridLayoutBase.prototype.removeRow = function (itemSpec) {
        if (!itemSpec) {
            throw new Error("Value is null.");
        }
        var index = this._rows.indexOf(itemSpec);
        if (itemSpec.owner !== this || index < 0) {
            throw new Error("Row is not child of this GridLayout");
        }
        itemSpec.index = -1;
        this._rows.splice(index, 1);
        this._onRowRemoved(itemSpec, index);
        this.invalidate();
    };
    GridLayoutBase.prototype.removeColumn = function (itemSpec) {
        if (!itemSpec) {
            throw new Error("Value is null.");
        }
        var index = this._cols.indexOf(itemSpec);
        if (itemSpec.owner !== this || index < 0) {
            throw new Error("Column is not child of this GridLayout");
        }
        itemSpec.index = -1;
        this._cols.splice(index, 1);
        this._onColumnRemoved(itemSpec, index);
        this.invalidate();
    };
    GridLayoutBase.prototype.removeColumns = function () {
        for (var i = this._cols.length - 1; i >= 0; i--) {
            var colSpec = this._cols[i];
            this._onColumnRemoved(colSpec, i);
            colSpec.index = -1;
        }
        this._cols.length = 0;
        this.invalidate();
    };
    GridLayoutBase.prototype.removeRows = function () {
        for (var i = this._rows.length - 1; i >= 0; i--) {
            var rowSpec = this._rows[i];
            this._onRowRemoved(rowSpec, i);
            rowSpec.index = -1;
        }
        this._rows.length = 0;
        this.invalidate();
    };
    GridLayoutBase.prototype.onRowChanged = function (element, oldValue, newValue) {
        this.invalidate();
    };
    GridLayoutBase.prototype.onRowSpanChanged = function (element, oldValue, newValue) {
        this.invalidate();
    };
    GridLayoutBase.prototype.onColumnChanged = function (element, oldValue, newValue) {
        this.invalidate();
    };
    GridLayoutBase.prototype.onColumnSpanChanged = function (element, oldValue, newValue) {
        this.invalidate();
    };
    GridLayoutBase.prototype._onRowAdded = function (itemSpec) {
    };
    GridLayoutBase.prototype._onColumnAdded = function (itemSpec) {
    };
    GridLayoutBase.prototype._onRowRemoved = function (itemSpec, index) {
    };
    GridLayoutBase.prototype._onColumnRemoved = function (itemSpec, index) {
    };
    GridLayoutBase.prototype.getColumns = function () {
        return this._cols.slice();
    };
    GridLayoutBase.prototype.getRows = function () {
        return this._rows.slice();
    };
    Object.defineProperty(GridLayoutBase.prototype, "columnsInternal", {
        get: function () {
            return this._cols;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GridLayoutBase.prototype, "rowsInternal", {
        get: function () {
            return this._rows;
        },
        enumerable: true,
        configurable: true
    });
    GridLayoutBase.prototype.invalidate = function () {
    };
    Object.defineProperty(GridLayoutBase.prototype, "rows", {
        set: function (value) {
            var _this = this;
            this.removeRows();
            parseAndAddItemSpecs(value, function (spec) { return _this.addRow(spec); });
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GridLayoutBase.prototype, "columns", {
        set: function (value) {
            var _this = this;
            this.removeColumns();
            parseAndAddItemSpecs(value, function (spec) { return _this.addColumn(spec); });
        },
        enumerable: true,
        configurable: true
    });
    var GridLayoutBase_1;
    GridLayoutBase = GridLayoutBase_1 = __decorate([
        layout_base_1.CSSType("GridLayout")
    ], GridLayoutBase);
    return GridLayoutBase;
}(layout_base_1.LayoutBase));
exports.GridLayoutBase = GridLayoutBase;
GridLayoutBase.prototype.recycleNativeView = "auto";
exports.columnProperty = new layout_base_1.Property({
    name: "col", defaultValue: 0,
    valueChanged: function (target, oldValue, newValue) {
        var grid = target.parent;
        if (grid instanceof GridLayoutBase) {
            grid.onColumnChanged(target, oldValue, newValue);
        }
    },
    valueConverter: function (v) { return Math.max(0, parseInt(v)); }
});
exports.columnProperty.register(layout_base_1.View);
exports.columnSpanProperty = new layout_base_1.Property({
    name: "colSpan", defaultValue: 1,
    valueChanged: function (target, oldValue, newValue) {
        var grid = target.parent;
        if (grid instanceof GridLayoutBase) {
            grid.onColumnSpanChanged(target, oldValue, newValue);
        }
    },
    valueConverter: function (v) { return Math.max(1, parseInt(v)); }
});
exports.columnSpanProperty.register(layout_base_1.View);
exports.rowProperty = new layout_base_1.Property({
    name: "row", defaultValue: 0,
    valueChanged: function (target, oldValue, newValue) {
        var grid = target.parent;
        if (grid instanceof GridLayoutBase) {
            grid.onRowChanged(target, oldValue, newValue);
        }
    },
    valueConverter: function (v) { return Math.max(0, parseInt(v)); }
});
exports.rowProperty.register(layout_base_1.View);
exports.rowSpanProperty = new layout_base_1.Property({
    name: "rowSpan", defaultValue: 1,
    valueChanged: function (target, oldValue, newValue) {
        var grid = target.parent;
        if (grid instanceof GridLayoutBase) {
            grid.onRowSpanChanged(target, oldValue, newValue);
        }
    },
    valueConverter: function (v) { return Math.max(1, parseInt(v)); }
});
exports.rowSpanProperty.register(layout_base_1.View);
var GridUnitType;
(function (GridUnitType) {
    GridUnitType.PIXEL = "pixel";
    GridUnitType.STAR = "star";
    GridUnitType.AUTO = "auto";
    GridUnitType.isValid = layout_base_1.makeValidator(GridUnitType.PIXEL, GridUnitType.STAR, GridUnitType.AUTO);
    GridUnitType.parse = layout_base_1.makeParser(GridUnitType.isValid);
})(GridUnitType = exports.GridUnitType || (exports.GridUnitType = {}));
//# sourceMappingURL=grid-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var grid_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout-common.js"));
function makeNativeSetter(setter) {
    return function (value) {
        var nativeView = this.nativeViewProtected;
        var lp = nativeView.getLayoutParams() || new org.nativescript.widgets.CommonLayoutParams();
        if (lp instanceof org.nativescript.widgets.CommonLayoutParams) {
            setter(lp, value);
            nativeView.setLayoutParams(lp);
        }
    };
}
grid_layout_common_1.View.prototype[grid_layout_common_1.rowProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.row = value; });
grid_layout_common_1.View.prototype[grid_layout_common_1.columnProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.column = value; });
grid_layout_common_1.View.prototype[grid_layout_common_1.rowSpanProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.rowSpan = value; });
grid_layout_common_1.View.prototype[grid_layout_common_1.columnSpanProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.columnSpan = value; });
function createNativeSpec(itemSpec) {
    switch (itemSpec.gridUnitType) {
        case grid_layout_common_1.GridUnitType.AUTO:
            return new org.nativescript.widgets.ItemSpec(itemSpec.value, org.nativescript.widgets.GridUnitType.auto);
        case grid_layout_common_1.GridUnitType.STAR:
            return new org.nativescript.widgets.ItemSpec(itemSpec.value, org.nativescript.widgets.GridUnitType.star);
        case grid_layout_common_1.GridUnitType.PIXEL:
            return new org.nativescript.widgets.ItemSpec(itemSpec.value * grid_layout_common_1.layout.getDisplayDensity(), org.nativescript.widgets.GridUnitType.pixel);
        default:
            throw new Error("Invalid gridUnitType: " + itemSpec.gridUnitType);
    }
}
var ItemSpec = (function (_super) {
    __extends(ItemSpec, _super);
    function ItemSpec() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ItemSpec.prototype, "actualLength", {
        get: function () {
            if (this.nativeSpec) {
                return Math.round(this.nativeSpec.getActualLength() / grid_layout_common_1.layout.getDisplayDensity());
            }
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    return ItemSpec;
}(grid_layout_common_1.ItemSpec));
exports.ItemSpec = ItemSpec;
var GridLayout = (function (_super) {
    __extends(GridLayout, _super);
    function GridLayout() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    GridLayout.prototype.createNativeView = function () {
        return new org.nativescript.widgets.GridLayout(this._context);
    };
    GridLayout.prototype.initNativeView = function () {
        var _this = this;
        _super.prototype.initNativeView.call(this);
        this.rowsInternal.forEach(function (itemSpec, index, rows) { _this._onRowAdded(itemSpec); }, this);
        this.columnsInternal.forEach(function (itemSpec, index, rows) { _this._onColumnAdded(itemSpec); }, this);
    };
    GridLayout.prototype.resetNativeView = function () {
        for (var i = this.rowsInternal.length; i--; i >= 0) {
            var itemSpec = this.rowsInternal[i];
            this._onRowRemoved(itemSpec, i);
        }
        for (var i = this.columnsInternal.length; i--; i >= 0) {
            var itemSpec = this.columnsInternal[i];
            this._onColumnRemoved(itemSpec, i);
        }
        _super.prototype.resetNativeView.call(this);
    };
    GridLayout.prototype._onRowAdded = function (itemSpec) {
        if (this.nativeViewProtected) {
            var nativeSpec = createNativeSpec(itemSpec);
            itemSpec.nativeSpec = nativeSpec;
            this.nativeViewProtected.addRow(nativeSpec);
        }
    };
    GridLayout.prototype._onColumnAdded = function (itemSpec) {
        if (this.nativeViewProtected) {
            var nativeSpec = createNativeSpec(itemSpec);
            itemSpec.nativeSpec = nativeSpec;
            this.nativeViewProtected.addColumn(nativeSpec);
        }
    };
    GridLayout.prototype._onRowRemoved = function (itemSpec, index) {
        itemSpec.nativeSpec = null;
        if (this.nativeViewProtected) {
            this.nativeViewProtected.removeRowAt(index);
        }
    };
    GridLayout.prototype._onColumnRemoved = function (itemSpec, index) {
        itemSpec.nativeSpec = null;
        if (this.nativeViewProtected) {
            this.nativeViewProtected.removeColumnAt(index);
        }
    };
    GridLayout.prototype.invalidate = function () {
    };
    return GridLayout;
}(grid_layout_common_1.GridLayoutBase));
exports.GridLayout = GridLayout;
//# sourceMappingURL=grid-layout.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/layout-base-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var LayoutBaseCommon = (function (_super) {
    __extends(LayoutBaseCommon, _super);
    function LayoutBaseCommon() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._subViews = new Array();
        return _this;
    }
    LayoutBaseCommon.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof view_1.View) {
            this.addChild(value);
        }
    };
    LayoutBaseCommon.prototype.getChildrenCount = function () {
        return this._subViews.length;
    };
    Object.defineProperty(LayoutBaseCommon.prototype, "_childrenCount", {
        get: function () {
            return this._subViews.length;
        },
        enumerable: true,
        configurable: true
    });
    LayoutBaseCommon.prototype.getChildAt = function (index) {
        return this._subViews[index];
    };
    LayoutBaseCommon.prototype.getChildIndex = function (child) {
        return this._subViews.indexOf(child);
    };
    LayoutBaseCommon.prototype.getChildById = function (id) {
        return view_1.getViewById(this, id);
    };
    LayoutBaseCommon.prototype._registerLayoutChild = function (child) {
    };
    LayoutBaseCommon.prototype._unregisterLayoutChild = function (child) {
    };
    LayoutBaseCommon.prototype.addChild = function (child) {
        this._subViews.push(child);
        this._addView(child);
        this._registerLayoutChild(child);
    };
    LayoutBaseCommon.prototype.insertChild = function (child, atIndex) {
        this._subViews.splice(atIndex, 0, child);
        this._addView(child, atIndex);
        this._registerLayoutChild(child);
    };
    LayoutBaseCommon.prototype.removeChild = function (child) {
        this._removeView(child);
        var index = this._subViews.indexOf(child);
        this._subViews.splice(index, 1);
        this._unregisterLayoutChild(child);
    };
    LayoutBaseCommon.prototype.removeChildren = function () {
        while (this.getChildrenCount() !== 0) {
            this.removeChild(this._subViews[this.getChildrenCount() - 1]);
        }
    };
    Object.defineProperty(LayoutBaseCommon.prototype, "padding", {
        get: function () {
            return this.style.padding;
        },
        set: function (value) {
            this.style.padding = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutBaseCommon.prototype, "paddingTop", {
        get: function () {
            return this.style.paddingTop;
        },
        set: function (value) {
            this.style.paddingTop = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutBaseCommon.prototype, "paddingRight", {
        get: function () {
            return this.style.paddingRight;
        },
        set: function (value) {
            this.style.paddingRight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutBaseCommon.prototype, "paddingBottom", {
        get: function () {
            return this.style.paddingBottom;
        },
        set: function (value) {
            this.style.paddingBottom = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutBaseCommon.prototype, "paddingLeft", {
        get: function () {
            return this.style.paddingLeft;
        },
        set: function (value) {
            this.style.paddingLeft = value;
        },
        enumerable: true,
        configurable: true
    });
    LayoutBaseCommon.prototype._childIndexToNativeChildIndex = function (index) {
        if (index === undefined) {
            return undefined;
        }
        var result = 0;
        for (var i = 0; i < index && i < this._subViews.length; i++) {
            result += this._subViews[i]._getNativeViewsCount();
        }
        return result;
    };
    LayoutBaseCommon.prototype.eachChildView = function (callback) {
        for (var i = 0, length_1 = this._subViews.length; i < length_1; i++) {
            var retVal = callback(this._subViews[i]);
            if (retVal === false) {
                break;
            }
        }
    };
    LayoutBaseCommon.prototype.eachLayoutChild = function (callback) {
        var lastChild = null;
        this.eachChildView(function (cv) {
            cv._eachLayoutView(function (lv) {
                if (lastChild && !lastChild.isCollapsed) {
                    callback(lastChild, false);
                }
                lastChild = lv;
            });
            return true;
        });
        if (lastChild && !lastChild.isCollapsed) {
            callback(lastChild, true);
        }
    };
    return LayoutBaseCommon;
}(view_1.CustomLayoutView));
exports.LayoutBaseCommon = LayoutBaseCommon;
exports.clipToBoundsProperty = new view_1.Property({ name: "clipToBounds", defaultValue: true, valueConverter: view_1.booleanConverter });
exports.clipToBoundsProperty.register(LayoutBaseCommon);
exports.isPassThroughParentEnabledProperty = new view_1.Property({ name: "isPassThroughParentEnabled", defaultValue: false, valueConverter: view_1.booleanConverter });
exports.isPassThroughParentEnabledProperty.register(LayoutBaseCommon);
//# sourceMappingURL=layout-base-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/layout-base.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base-common.js"));
var LayoutBase = (function (_super) {
    __extends(LayoutBase, _super);
    function LayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LayoutBase.prototype[layout_base_common_1.clipToBoundsProperty.getDefault] = function () {
        return true;
    };
    LayoutBase.prototype[layout_base_common_1.clipToBoundsProperty.setNative] = function (value) {
        console.warn("clipToBounds with value false is not supported on Android. You can use this.android.getParent().setClipChildren(false) as an alternative");
    };
    LayoutBase.prototype[layout_base_common_1.isPassThroughParentEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.setPassThroughParent(value);
    };
    LayoutBase.prototype[layout_base_common_1.paddingTopProperty.getDefault] = function () {
        return { value: this._defaultPaddingTop, unit: "px" };
    };
    LayoutBase.prototype[layout_base_common_1.paddingTopProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingTop(this.nativeViewProtected, layout_base_common_1.Length.toDevicePixels(value, 0) + layout_base_common_1.Length.toDevicePixels(this.style.borderTopWidth, 0));
    };
    LayoutBase.prototype[layout_base_common_1.paddingRightProperty.getDefault] = function () {
        return { value: this._defaultPaddingRight, unit: "px" };
    };
    LayoutBase.prototype[layout_base_common_1.paddingRightProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingRight(this.nativeViewProtected, layout_base_common_1.Length.toDevicePixels(value, 0) + layout_base_common_1.Length.toDevicePixels(this.style.borderRightWidth, 0));
    };
    LayoutBase.prototype[layout_base_common_1.paddingBottomProperty.getDefault] = function () {
        return { value: this._defaultPaddingBottom, unit: "px" };
    };
    LayoutBase.prototype[layout_base_common_1.paddingBottomProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingBottom(this.nativeViewProtected, layout_base_common_1.Length.toDevicePixels(value, 0) + layout_base_common_1.Length.toDevicePixels(this.style.borderBottomWidth, 0));
    };
    LayoutBase.prototype[layout_base_common_1.paddingLeftProperty.getDefault] = function () {
        return { value: this._defaultPaddingLeft, unit: "px" };
    };
    LayoutBase.prototype[layout_base_common_1.paddingLeftProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingLeft(this.nativeViewProtected, layout_base_common_1.Length.toDevicePixels(value, 0) + layout_base_common_1.Length.toDevicePixels(this.style.borderLeftWidth, 0));
    };
    return LayoutBase;
}(layout_base_common_1.LayoutBaseCommon));
exports.LayoutBase = LayoutBase;
//# sourceMappingURL=layout-base.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
var StackLayoutBase = (function (_super) {
    __extends(StackLayoutBase, _super);
    function StackLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    StackLayoutBase = __decorate([
        layout_base_1.CSSType("StackLayout")
    ], StackLayoutBase);
    return StackLayoutBase;
}(layout_base_1.LayoutBase));
exports.StackLayoutBase = StackLayoutBase;
StackLayoutBase.prototype.recycleNativeView = "auto";
var converter = layout_base_1.makeParser(layout_base_1.makeValidator("horizontal", "vertical"));
exports.orientationProperty = new layout_base_1.Property({ name: "orientation", defaultValue: "vertical", affectsLayout: layout_base_1.isIOS, valueConverter: converter });
exports.orientationProperty.register(StackLayoutBase);
//# sourceMappingURL=stack-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var stack_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout-common.js"));
var StackLayout = (function (_super) {
    __extends(StackLayout, _super);
    function StackLayout() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    StackLayout.prototype.createNativeView = function () {
        return new org.nativescript.widgets.StackLayout(this._context);
    };
    StackLayout.prototype[stack_layout_common_1.orientationProperty.setNative] = function (value) {
        this.nativeViewProtected.setOrientation(value === "vertical" ? org.nativescript.widgets.Orientation.vertical : org.nativescript.widgets.Orientation.horizontal);
    };
    return StackLayout;
}(stack_layout_common_1.StackLayoutBase));
exports.StackLayout = StackLayout;
//# sourceMappingURL=stack-layout.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
var WrapLayoutBase = (function (_super) {
    __extends(WrapLayoutBase, _super);
    function WrapLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WrapLayoutBase = __decorate([
        layout_base_1.CSSType("WrapLayout")
    ], WrapLayoutBase);
    return WrapLayoutBase;
}(layout_base_1.LayoutBase));
exports.WrapLayoutBase = WrapLayoutBase;
WrapLayoutBase.prototype.recycleNativeView = "auto";
exports.itemWidthProperty = new layout_base_1.Property({
    name: "itemWidth", defaultValue: "auto", affectsLayout: layout_base_1.isIOS, valueConverter: function (v) { return layout_base_1.Length.parse(v); },
    valueChanged: function (target, oldValue, newValue) { return target.effectiveItemWidth = layout_base_1.Length.toDevicePixels(newValue, -1); }
});
exports.itemWidthProperty.register(WrapLayoutBase);
exports.itemHeightProperty = new layout_base_1.Property({
    name: "itemHeight", defaultValue: "auto", affectsLayout: layout_base_1.isIOS, valueConverter: function (v) { return layout_base_1.Length.parse(v); },
    valueChanged: function (target, oldValue, newValue) { return target.effectiveItemHeight = layout_base_1.Length.toDevicePixels(newValue, -1); }
});
exports.itemHeightProperty.register(WrapLayoutBase);
var converter = layout_base_1.makeParser(layout_base_1.makeValidator("horizontal", "vertical"));
exports.orientationProperty = new layout_base_1.Property({ name: "orientation", defaultValue: "horizontal", affectsLayout: layout_base_1.isIOS, valueConverter: converter });
exports.orientationProperty.register(WrapLayoutBase);
//# sourceMappingURL=wrap-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var wrap_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout-common.js"));
var WrapLayout = (function (_super) {
    __extends(WrapLayout, _super);
    function WrapLayout() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WrapLayout.prototype.createNativeView = function () {
        return new org.nativescript.widgets.WrapLayout(this._context);
    };
    WrapLayout.prototype[wrap_layout_common_1.orientationProperty.setNative] = function (value) {
        this.nativeViewProtected.setOrientation(value === "vertical" ? org.nativescript.widgets.Orientation.vertical : org.nativescript.widgets.Orientation.horizontal);
    };
    WrapLayout.prototype[wrap_layout_common_1.itemWidthProperty.setNative] = function (value) {
        this.nativeViewProtected.setItemWidth(wrap_layout_common_1.Length.toDevicePixels(value, -1));
    };
    WrapLayout.prototype[wrap_layout_common_1.itemHeightProperty.setNative] = function (value) {
        this.nativeViewProtected.setItemHeight(wrap_layout_common_1.Length.toDevicePixels(value, -1));
    };
    return WrapLayout;
}(wrap_layout_common_1.WrapLayoutBase));
exports.WrapLayout = WrapLayout;
//# sourceMappingURL=wrap-layout.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/list-picker/list-picker-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ListPickerBase = (function (_super) {
    __extends(ListPickerBase, _super);
    function ListPickerBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListPickerBase.prototype._getItemAsString = function (index) {
        var items = this.items;
        if (!items) {
            return " ";
        }
        var item = this.isItemsSource ? this.items.getItem(index) : this.items[index];
        return (item === undefined || item === null) ? index + "" : this.parseItem(item);
    };
    ListPickerBase.prototype.parseItem = function (item) {
        return this.textField ? item[this.textField] + "" : item + "";
    };
    ListPickerBase.prototype.updateSelectedValue = function (index) {
        var newVal = null;
        if (index >= 0) {
            var item = this.items[index];
            newVal = this.valueField ? item[this.valueField] : item;
        }
        if (this.selectedValue !== newVal) {
            this.set("selectedValue", newVal);
        }
    };
    ListPickerBase = __decorate([
        view_1.CSSType("ListPicker")
    ], ListPickerBase);
    return ListPickerBase;
}(view_1.View));
exports.ListPickerBase = ListPickerBase;
ListPickerBase.prototype.recycleNativeView = "auto";
exports.selectedIndexProperty = new view_1.CoercibleProperty({
    name: "selectedIndex", defaultValue: -1,
    valueConverter: function (v) { return parseInt(v); },
    coerceValue: function (target, value) {
        var items = target.items;
        if (items) {
            var max = items.length - 1;
            if (value < 0) {
                value = 0;
            }
            if (value > max) {
                value = max;
            }
        }
        else {
            value = -1;
        }
        target.updateSelectedValue(value);
        return value;
    }
});
exports.selectedIndexProperty.register(ListPickerBase);
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        var getItem = newValue && newValue.getItem;
        target.isItemsSource = typeof getItem === "function";
    }
});
exports.itemsProperty.register(ListPickerBase);
exports.textFieldProperty = new view_1.Property({
    name: "textField",
    defaultValue: ""
});
exports.textFieldProperty.register(ListPickerBase);
exports.valueFieldProperty = new view_1.Property({
    name: "valueField",
    defaultValue: ""
});
exports.valueFieldProperty.register(ListPickerBase);
exports.selectedValueProperty = new view_1.Property({
    name: "selectedValue",
    defaultValue: null
});
exports.selectedValueProperty.register(ListPickerBase);
//# sourceMappingURL=list-picker-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/list-picker/list-picker.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var list_picker_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/list-picker/list-picker-common.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/list-picker/list-picker-common.js"));
var sdkVersion = lazy_1.default(function () { return parseInt(platform_1.device.sdkVersion); });
var Formatter;
var ValueChangeListener;
function initializeNativeClasses() {
    if (Formatter) {
        return;
    }
    var FormatterImpl = (function (_super) {
        __extends(FormatterImpl, _super);
        function FormatterImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        FormatterImpl.prototype.format = function (index) {
            return this.owner._getItemAsString(index);
        };
        FormatterImpl = __decorate([
            Interfaces([android.widget.NumberPicker.Formatter])
        ], FormatterImpl);
        return FormatterImpl;
    }(java.lang.Object));
    var ValueChangeListenerImpl = (function (_super) {
        __extends(ValueChangeListenerImpl, _super);
        function ValueChangeListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        ValueChangeListenerImpl.prototype.onValueChange = function (picker, oldValue, newValue) {
            list_picker_common_1.selectedIndexProperty.nativeValueChange(this.owner, newValue);
            this.owner.updateSelectedValue(newValue);
        };
        ValueChangeListenerImpl = __decorate([
            Interfaces([android.widget.NumberPicker.OnValueChangeListener])
        ], ValueChangeListenerImpl);
        return ValueChangeListenerImpl;
    }(java.lang.Object));
    Formatter = FormatterImpl;
    ValueChangeListener = ValueChangeListenerImpl;
}
function getEditText(picker) {
    for (var i = 0, count = picker.getChildCount(); i < count; i++) {
        var child = picker.getChildAt(i);
        if (child instanceof android.widget.EditText) {
            return child;
        }
    }
    return null;
}
var selectorWheelPaintField;
function getSelectorWheelPaint(picker) {
    if (!selectorWheelPaintField) {
        selectorWheelPaintField = picker.getClass().getDeclaredField("mSelectorWheelPaint");
        selectorWheelPaintField.setAccessible(true);
    }
    return selectorWheelPaintField.get(picker);
}
var ListPicker = (function (_super) {
    __extends(ListPicker, _super);
    function ListPicker() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListPicker.prototype.createNativeView = function () {
        var picker = new android.widget.NumberPicker(this._context);
        picker.setDescendantFocusability(android.widget.NumberPicker.FOCUS_BLOCK_DESCENDANTS);
        picker.setMinValue(0);
        picker.setMaxValue(0);
        picker.setValue(0);
        picker.setWrapSelectorWheel(false);
        return picker;
    };
    ListPicker.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        initializeNativeClasses();
        var nativeView = this.nativeViewProtected;
        if (sdkVersion() < 29) {
            this._selectorWheelPaint = getSelectorWheelPaint(nativeView);
        }
        var formatter = new Formatter(this);
        nativeView.setFormatter(formatter);
        nativeView.formatter = formatter;
        var valueChangedListener = new ValueChangeListener(this);
        nativeView.setOnValueChangedListener(valueChangedListener);
        nativeView.valueChangedListener = valueChangedListener;
        var editText = getEditText(nativeView);
        if (editText) {
            nativeView.editText = editText;
            editText.setFilters([]);
            editText.setText(" ", android.widget.TextView.BufferType.NORMAL);
        }
    };
    ListPicker.prototype.disposeNativeView = function () {
        var nativeView = this.nativeViewProtected;
        nativeView.formatter.owner = null;
        nativeView.valueChangedListener.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    ListPicker.prototype._fixNumberPickerRendering = function () {
        var nativeView = this.nativeViewProtected;
        nativeView.setFormatter(null);
        nativeView.setFormatter(nativeView.formatter);
        var editText = nativeView.editText;
        if (editText) {
            editText.setFilters([]);
            editText.invalidate();
        }
        nativeView.invalidate();
    };
    ListPicker.prototype[list_picker_common_1.selectedIndexProperty.getDefault] = function () {
        return -1;
    };
    ListPicker.prototype[list_picker_common_1.selectedIndexProperty.setNative] = function (value) {
        if (value >= 0) {
            this.nativeViewProtected.setValue(value);
        }
    };
    ListPicker.prototype[list_picker_common_1.itemsProperty.getDefault] = function () {
        return null;
    };
    ListPicker.prototype[list_picker_common_1.itemsProperty.setNative] = function (value) {
        var maxValue = value && value.length > 0 ? value.length - 1 : 0;
        this.nativeViewProtected.setMaxValue(maxValue);
        this._fixNumberPickerRendering();
        list_picker_common_1.selectedIndexProperty.coerce(this);
    };
    ListPicker.prototype[list_picker_common_1.colorProperty.getDefault] = function () {
        if (this._selectorWheelPaint) {
            return this._selectorWheelPaint.getColor();
        }
        return this.nativeView.getTextColor();
    };
    ListPicker.prototype[list_picker_common_1.colorProperty.setNative] = function (value) {
        var color = value instanceof list_picker_common_1.Color ? value.android : value;
        if (this._selectorWheelPaint) {
            this._selectorWheelPaint.setColor(color);
            var editText = this.nativeViewProtected.editText;
            if (editText) {
                editText.setTextColor(color);
            }
        }
        else {
            this.nativeView.setTextColor(color);
        }
    };
    return ListPicker;
}(list_picker_common_1.ListPickerBase));
exports.ListPicker = ListPicker;
//# sourceMappingURL=list-picker.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/list-view/list-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var label_1 = __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js");
var observable_array_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable-array/observable-array.js");
var weak_event_listener_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var knownTemplates;
(function (knownTemplates) {
    knownTemplates.itemTemplate = "itemTemplate";
})(knownTemplates = exports.knownTemplates || (exports.knownTemplates = {}));
var knownMultiTemplates;
(function (knownMultiTemplates) {
    knownMultiTemplates.itemTemplates = "itemTemplates";
})(knownMultiTemplates = exports.knownMultiTemplates || (exports.knownMultiTemplates = {}));
var autoEffectiveRowHeight = -1;
var ListViewBase = (function (_super) {
    __extends(ListViewBase, _super);
    function ListViewBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._itemIdGenerator = function (_item, index) { return index; };
        _this._itemTemplateSelectorBindable = new label_1.Label();
        _this._defaultTemplate = {
            key: "default",
            createView: function () {
                if (_this.itemTemplate) {
                    return builder_1.parse(_this.itemTemplate, _this);
                }
                return undefined;
            }
        };
        _this._itemTemplatesInternal = new Array(_this._defaultTemplate);
        _this._effectiveRowHeight = autoEffectiveRowHeight;
        return _this;
    }
    Object.defineProperty(ListViewBase.prototype, "separatorColor", {
        get: function () {
            return this.style.separatorColor;
        },
        set: function (value) {
            this.style.separatorColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ListViewBase.prototype, "itemTemplateSelector", {
        get: function () {
            return this._itemTemplateSelector;
        },
        set: function (value) {
            var _this = this;
            if (typeof value === "string") {
                this._itemTemplateSelectorBindable.bind({
                    sourceProperty: null,
                    targetProperty: "templateKey",
                    expression: value
                });
                this._itemTemplateSelector = function (item, index, items) {
                    item["$index"] = index;
                    if (_this._itemTemplateSelectorBindable.bindingContext === item) {
                        _this._itemTemplateSelectorBindable.bindingContext = null;
                    }
                    _this._itemTemplateSelectorBindable.bindingContext = item;
                    return _this._itemTemplateSelectorBindable.get("templateKey");
                };
            }
            else if (typeof value === "function") {
                this._itemTemplateSelector = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ListViewBase.prototype, "itemIdGenerator", {
        get: function () {
            return this._itemIdGenerator;
        },
        set: function (generatorFn) {
            this._itemIdGenerator = generatorFn;
        },
        enumerable: true,
        configurable: true
    });
    ListViewBase.prototype.refresh = function () {
    };
    ListViewBase.prototype.scrollToIndex = function (index) {
    };
    ListViewBase.prototype.scrollToIndexAnimated = function (index) {
    };
    ListViewBase.prototype._getItemTemplate = function (index) {
        var templateKey = "default";
        if (this.itemTemplateSelector) {
            var dataItem = this._getDataItem(index);
            templateKey = this._itemTemplateSelector(dataItem, index, this.items);
        }
        for (var i = 0, length_1 = this._itemTemplatesInternal.length; i < length_1; i++) {
            if (this._itemTemplatesInternal[i].key === templateKey) {
                return this._itemTemplatesInternal[i];
            }
        }
        return this._itemTemplatesInternal[0];
    };
    ListViewBase.prototype._prepareItem = function (item, index) {
        if (item) {
            item.bindingContext = this._getDataItem(index);
        }
    };
    ListViewBase.prototype._getDataItem = function (index) {
        var thisItems = this.items;
        return thisItems.getItem ? thisItems.getItem(index) : thisItems[index];
    };
    ListViewBase.prototype._getDefaultItemContent = function (index) {
        var lbl = new label_1.Label();
        lbl.bind({
            targetProperty: "text",
            sourceProperty: "$value"
        });
        return lbl;
    };
    ListViewBase.prototype._onItemsChanged = function (args) {
        this.refresh();
    };
    ListViewBase.prototype._onRowHeightPropertyChanged = function (oldValue, newValue) {
        this.refresh();
    };
    ListViewBase.prototype.isItemAtIndexVisible = function (index) {
        return false;
    };
    ListViewBase.prototype.updateEffectiveRowHeight = function () {
        exports.rowHeightProperty.coerce(this);
    };
    ListViewBase.itemLoadingEvent = "itemLoading";
    ListViewBase.itemTapEvent = "itemTap";
    ListViewBase.loadMoreItemsEvent = "loadMoreItems";
    ListViewBase.knownFunctions = ["itemTemplateSelector", "itemIdGenerator"];
    ListViewBase = __decorate([
        view_1.CSSType("ListView")
    ], ListViewBase);
    return ListViewBase;
}(view_1.ContainerView));
exports.ListViewBase = ListViewBase;
ListViewBase.prototype.recycleNativeView = "auto";
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        if (oldValue instanceof view_1.Observable) {
            weak_event_listener_1.removeWeakEventListener(oldValue, observable_array_1.ObservableArray.changeEvent, target._onItemsChanged, target);
        }
        if (newValue instanceof view_1.Observable) {
            weak_event_listener_1.addWeakEventListener(newValue, observable_array_1.ObservableArray.changeEvent, target._onItemsChanged, target);
        }
        target.refresh();
    }
});
exports.itemsProperty.register(ListViewBase);
exports.itemTemplateProperty = new view_1.Property({
    name: "itemTemplate", valueChanged: function (target) {
        target.refresh();
    }
});
exports.itemTemplateProperty.register(ListViewBase);
exports.itemTemplatesProperty = new view_1.Property({
    name: "itemTemplates", valueConverter: function (value) {
        if (typeof value === "string") {
            return builder_1.parseMultipleTemplates(value);
        }
        return value;
    }
});
exports.itemTemplatesProperty.register(ListViewBase);
var defaultRowHeight = "auto";
exports.rowHeightProperty = new view_1.CoercibleProperty({
    name: "rowHeight", defaultValue: defaultRowHeight, equalityComparer: view_1.Length.equals,
    coerceValue: function (target, value) {
        return target.nativeViewProtected ? value : defaultRowHeight;
    },
    valueChanged: function (target, oldValue, newValue) {
        target._effectiveRowHeight = view_1.Length.toDevicePixels(newValue, autoEffectiveRowHeight);
        target._onRowHeightPropertyChanged(oldValue, newValue);
    }, valueConverter: view_1.Length.parse
});
exports.rowHeightProperty.register(ListViewBase);
exports.iosEstimatedRowHeightProperty = new view_1.Property({
    name: "iosEstimatedRowHeight", valueConverter: function (v) { return view_1.Length.parse(v); }
});
exports.iosEstimatedRowHeightProperty.register(ListViewBase);
exports.separatorColorProperty = new view_1.CssProperty({ name: "separatorColor", cssName: "separator-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.separatorColorProperty.register(view_1.Style);
//# sourceMappingURL=list-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/list-view/list-view.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var list_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/list-view/list-view-common.js");
var stack_layout_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout.js");
var proxy_view_container_1 = __webpack_require__("../node_modules/tns-core-modules/ui/proxy-view-container/proxy-view-container.js");
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/list-view/list-view-common.js"));
var ITEMLOADING = list_view_common_1.ListViewBase.itemLoadingEvent;
var LOADMOREITEMS = list_view_common_1.ListViewBase.loadMoreItemsEvent;
var ITEMTAP = list_view_common_1.ListViewBase.itemTapEvent;
var ItemClickListener;
function initializeItemClickListener() {
    if (ItemClickListener) {
        return;
    }
    var ItemClickListenerImpl = (function (_super) {
        __extends(ItemClickListenerImpl, _super);
        function ItemClickListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        ItemClickListenerImpl.prototype.onItemClick = function (parent, convertView, index, id) {
            var owner = this.owner;
            var view = owner._realizedTemplates.get(owner._getItemTemplate(index).key).get(convertView);
            owner.notify({ eventName: ITEMTAP, object: owner, index: index, view: view });
        };
        ItemClickListenerImpl = __decorate([
            Interfaces([android.widget.AdapterView.OnItemClickListener])
        ], ItemClickListenerImpl);
        return ItemClickListenerImpl;
    }(java.lang.Object));
    ItemClickListener = ItemClickListenerImpl;
}
var ListView = (function (_super) {
    __extends(ListView, _super);
    function ListView() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._androidViewId = -1;
        _this._realizedItems = new Map();
        _this._realizedTemplates = new Map();
        return _this;
    }
    ListView.prototype.createNativeView = function () {
        var listView = new android.widget.ListView(this._context);
        listView.setDescendantFocusability(android.view.ViewGroup.FOCUS_AFTER_DESCENDANTS);
        listView.setCacheColorHint(android.graphics.Color.TRANSPARENT);
        return listView;
    };
    ListView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this.updateEffectiveRowHeight();
        var nativeView = this.nativeViewProtected;
        initializeItemClickListener();
        ensureListViewAdapterClass();
        var adapter = new ListViewAdapterClass(this);
        nativeView.setAdapter(adapter);
        nativeView.adapter = adapter;
        var itemClickListener = new ItemClickListener(this);
        nativeView.setOnItemClickListener(itemClickListener);
        nativeView.itemClickListener = itemClickListener;
        if (this._androidViewId < 0) {
            this._androidViewId = android.view.View.generateViewId();
        }
        nativeView.setId(this._androidViewId);
    };
    ListView.prototype.disposeNativeView = function () {
        var nativeView = this.nativeViewProtected;
        nativeView.setAdapter(null);
        nativeView.itemClickListener.owner = null;
        nativeView.adapter.owner = null;
        this.clearRealizedCells();
        _super.prototype.disposeNativeView.call(this);
    };
    ListView.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.requestLayout();
    };
    ListView.prototype.refresh = function () {
        var nativeView = this.nativeViewProtected;
        if (!nativeView || !nativeView.getAdapter()) {
            return;
        }
        this._realizedItems.forEach(function (view, nativeView) {
            if (!(view.bindingContext instanceof list_view_common_1.Observable)) {
                view.bindingContext = null;
            }
        });
        nativeView.getAdapter().notifyDataSetChanged();
    };
    ListView.prototype.scrollToIndex = function (index) {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            nativeView.setSelection(index);
        }
    };
    ListView.prototype.scrollToIndexAnimated = function (index) {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            nativeView.smoothScrollToPosition(index);
        }
    };
    Object.defineProperty(ListView.prototype, "_childrenCount", {
        get: function () {
            return this._realizedItems.size;
        },
        enumerable: true,
        configurable: true
    });
    ListView.prototype.eachChildView = function (callback) {
        this._realizedItems.forEach(function (view, nativeView) {
            if (view.parent instanceof ListView) {
                callback(view);
            }
            else {
                if (view.parent) {
                    callback(view.parent);
                }
            }
        });
    };
    ListView.prototype._dumpRealizedTemplates = function () {
        console.log("Realized Templates:");
        this._realizedTemplates.forEach(function (value, index) {
            console.log("\t" + index + ":");
            value.forEach(function (value, index) {
                console.log("\t\t" + index.hashCode() + ": " + value);
            });
        });
        console.log("Realized Items Size: " + this._realizedItems.size);
    };
    ListView.prototype.clearRealizedCells = function () {
        var _this = this;
        this._realizedItems.forEach(function (view, nativeView) {
            if (view.parent) {
                if (!(view.parent instanceof ListView)) {
                    _this._removeView(view.parent);
                }
                view.parent._removeView(view);
            }
        });
        this._realizedItems.clear();
        this._realizedTemplates.clear();
    };
    ListView.prototype.isItemAtIndexVisible = function (index) {
        var nativeView = this.nativeViewProtected;
        var start = nativeView.getFirstVisiblePosition();
        var end = nativeView.getLastVisiblePosition();
        return (index >= start && index <= end);
    };
    ListView.prototype[list_view_common_1.separatorColorProperty.getDefault] = function () {
        var nativeView = this.nativeViewProtected;
        return {
            dividerHeight: nativeView.getDividerHeight(),
            divider: nativeView.getDivider()
        };
    };
    ListView.prototype[list_view_common_1.separatorColorProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        if (value instanceof list_view_common_1.Color) {
            nativeView.setDivider(new android.graphics.drawable.ColorDrawable(value.android));
            nativeView.setDividerHeight(1);
        }
        else {
            nativeView.setDivider(value.divider);
            nativeView.setDividerHeight(value.dividerHeight);
        }
    };
    ListView.prototype[list_view_common_1.itemTemplatesProperty.getDefault] = function () {
        return null;
    };
    ListView.prototype[list_view_common_1.itemTemplatesProperty.setNative] = function (value) {
        this._itemTemplatesInternal = new Array(this._defaultTemplate);
        if (value) {
            this._itemTemplatesInternal = this._itemTemplatesInternal.concat(value);
        }
        this.nativeViewProtected.setAdapter(new ListViewAdapterClass(this));
        this.refresh();
    };
    __decorate([
        profiling_1.profile
    ], ListView.prototype, "createNativeView", null);
    return ListView;
}(list_view_common_1.ListViewBase));
exports.ListView = ListView;
var ListViewAdapterClass;
function ensureListViewAdapterClass() {
    if (ListViewAdapterClass) {
        return;
    }
    var ListViewAdapter = (function (_super) {
        __extends(ListViewAdapter, _super);
        function ListViewAdapter(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        ListViewAdapter.prototype.getCount = function () {
            return this.owner && this.owner.items && this.owner.items.length ? this.owner.items.length : 0;
        };
        ListViewAdapter.prototype.getItem = function (i) {
            if (this.owner && this.owner.items && i < this.owner.items.length) {
                var getItem = this.owner.items.getItem;
                return getItem ? getItem.call(this.owner.items, i) : this.owner.items[i];
            }
            return null;
        };
        ListViewAdapter.prototype.getItemId = function (i) {
            var item = this.getItem(i);
            var id = i;
            if (this.owner && item && this.owner.items) {
                id = this.owner.itemIdGenerator(item, i, this.owner.items);
            }
            return long(id);
        };
        ListViewAdapter.prototype.hasStableIds = function () {
            return true;
        };
        ListViewAdapter.prototype.getViewTypeCount = function () {
            return this.owner._itemTemplatesInternal.length;
        };
        ListViewAdapter.prototype.getItemViewType = function (index) {
            var template = this.owner._getItemTemplate(index);
            var itemViewType = this.owner._itemTemplatesInternal.indexOf(template);
            return itemViewType;
        };
        ListViewAdapter.prototype.getView = function (index, convertView, parent) {
            if (!this.owner) {
                return null;
            }
            var totalItemCount = this.owner.items ? this.owner.items.length : 0;
            if (index === (totalItemCount - 1)) {
                this.owner.notify({ eventName: LOADMOREITEMS, object: this.owner });
            }
            var template = this.owner._getItemTemplate(index);
            var view;
            if (convertView) {
                view = this.owner._realizedTemplates.get(template.key).get(convertView);
                if (!view) {
                    throw new Error("There is no entry with key '" + convertView + "' in the realized views cache for template with key'" + template.key + "'.");
                }
            }
            else {
                view = template.createView();
            }
            var args = {
                eventName: ITEMLOADING, object: this.owner, index: index, view: view,
                android: parent,
                ios: undefined
            };
            this.owner.notify(args);
            if (!args.view) {
                args.view = this.owner._getDefaultItemContent(index);
            }
            if (args.view) {
                if (this.owner._effectiveRowHeight > -1) {
                    args.view.height = this.owner.rowHeight;
                }
                else {
                    args.view.height = list_view_common_1.unsetValue;
                }
                this.owner._prepareItem(args.view, index);
                if (!args.view.parent) {
                    if (args.view instanceof layout_base_1.LayoutBase &&
                        !(args.view instanceof proxy_view_container_1.ProxyViewContainer)) {
                        this.owner._addView(args.view);
                        convertView = args.view.nativeViewProtected;
                    }
                    else {
                        var sp = new stack_layout_1.StackLayout();
                        sp.addChild(args.view);
                        this.owner._addView(sp);
                        convertView = sp.nativeViewProtected;
                    }
                }
                var realizedItemsForTemplateKey = this.owner._realizedTemplates.get(template.key);
                if (!realizedItemsForTemplateKey) {
                    realizedItemsForTemplateKey = new Map();
                    this.owner._realizedTemplates.set(template.key, realizedItemsForTemplateKey);
                }
                realizedItemsForTemplateKey.set(convertView, args.view);
                this.owner._realizedItems.set(convertView, args.view);
            }
            return convertView;
        };
        __decorate([
            profiling_1.profile
        ], ListViewAdapter.prototype, "getView", null);
        return ListViewAdapter;
    }(android.widget.BaseAdapter));
    ListViewAdapterClass = ListViewAdapter;
}
//# sourceMappingURL=list-view.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/page/page-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var content_view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var action_bar_1 = __webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js"));
var PageBase = (function (_super) {
    __extends(PageBase, _super);
    function PageBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    PageBase_1 = PageBase;
    Object.defineProperty(PageBase.prototype, "navigationContext", {
        get: function () {
            return this._navigationContext;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageBase.prototype, "actionBar", {
        get: function () {
            if (!this._actionBar) {
                this.hasActionBar = true;
                this._actionBar = new action_bar_1.ActionBar();
                this._addView(this._actionBar);
            }
            return this._actionBar;
        },
        set: function (value) {
            if (!value) {
                throw new Error("ActionBar cannot be null or undefined.");
            }
            if (this._actionBar !== value) {
                if (this._actionBar) {
                    this._removeView(this._actionBar);
                }
                this.hasActionBar = true;
                this._actionBar = value;
                this._addView(this._actionBar);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageBase.prototype, "statusBarStyle", {
        get: function () {
            return this.style.statusBarStyle;
        },
        set: function (value) {
            this.style.statusBarStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageBase.prototype, "androidStatusBarBackground", {
        get: function () {
            return this.style.androidStatusBarBackground;
        },
        set: function (value) {
            this.style.androidStatusBarBackground = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageBase.prototype, "page", {
        get: function () {
            return this;
        },
        enumerable: true,
        configurable: true
    });
    PageBase.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof action_bar_1.ActionBar) {
            this.actionBar = value;
        }
        else {
            _super.prototype._addChildFromBuilder.call(this, name, value);
        }
    };
    PageBase.prototype.getKeyframeAnimationWithName = function (animationName) {
        return this._styleScope.getKeyframeAnimationWithName(animationName);
    };
    Object.defineProperty(PageBase.prototype, "frame", {
        get: function () {
            var frame = this.parent;
            return frame instanceof frame_1.Frame ? frame : undefined;
        },
        enumerable: true,
        configurable: true
    });
    PageBase.prototype.createNavigatedData = function (eventName, isBackNavigation) {
        return {
            eventName: eventName,
            object: this,
            context: this.navigationContext,
            isBackNavigation: isBackNavigation
        };
    };
    PageBase.prototype.onNavigatingTo = function (context, isBackNavigation, bindingContext) {
        this._navigationContext = context;
        if (isBackNavigation && this._styleScope) {
            this._styleScope.ensureSelectors();
            if (!this._cssState.isSelectorsLatestVersionApplied()) {
                this._onCssStateChange();
            }
        }
        if (!isBackNavigation && bindingContext !== undefined && bindingContext !== null) {
            this.bindingContext = bindingContext;
        }
        this.notify(this.createNavigatedData(PageBase_1.navigatingToEvent, isBackNavigation));
    };
    PageBase.prototype.onNavigatedTo = function (isBackNavigation) {
        this.notify(this.createNavigatedData(PageBase_1.navigatedToEvent, isBackNavigation));
    };
    PageBase.prototype.onNavigatingFrom = function (isBackNavigation) {
        this.notify(this.createNavigatedData(PageBase_1.navigatingFromEvent, isBackNavigation));
    };
    PageBase.prototype.onNavigatedFrom = function (isBackNavigation) {
        this.notify(this.createNavigatedData(PageBase_1.navigatedFromEvent, isBackNavigation));
        this._navigationContext = undefined;
    };
    PageBase.prototype.eachChildView = function (callback) {
        _super.prototype.eachChildView.call(this, callback);
        if (this.actionBar) {
            callback(this.actionBar);
        }
    };
    Object.defineProperty(PageBase.prototype, "_childrenCount", {
        get: function () {
            return (this.content ? 1 : 0) + (this._actionBar ? 1 : 0);
        },
        enumerable: true,
        configurable: true
    });
    var PageBase_1;
    PageBase.navigatingToEvent = "navigatingTo";
    PageBase.navigatedToEvent = "navigatedTo";
    PageBase.navigatingFromEvent = "navigatingFrom";
    PageBase.navigatedFromEvent = "navigatedFrom";
    __decorate([
        profiling_1.profile
    ], PageBase.prototype, "onNavigatingTo", null);
    __decorate([
        profiling_1.profile
    ], PageBase.prototype, "onNavigatedTo", null);
    __decorate([
        profiling_1.profile
    ], PageBase.prototype, "onNavigatingFrom", null);
    __decorate([
        profiling_1.profile
    ], PageBase.prototype, "onNavigatedFrom", null);
    PageBase = PageBase_1 = __decorate([
        content_view_1.CSSType("Page")
    ], PageBase);
    return PageBase;
}(content_view_1.ContentView));
exports.PageBase = PageBase;
PageBase.prototype.recycleNativeView = "never";
exports.actionBarHiddenProperty = new content_view_1.Property({ name: "actionBarHidden", affectsLayout: content_view_1.isIOS, valueConverter: content_view_1.booleanConverter });
exports.actionBarHiddenProperty.register(PageBase);
exports.backgroundSpanUnderStatusBarProperty = new content_view_1.Property({ name: "backgroundSpanUnderStatusBar", defaultValue: false, affectsLayout: content_view_1.isIOS, valueConverter: content_view_1.booleanConverter });
exports.backgroundSpanUnderStatusBarProperty.register(PageBase);
exports.enableSwipeBackNavigationProperty = new content_view_1.Property({ name: "enableSwipeBackNavigation", defaultValue: true, valueConverter: content_view_1.booleanConverter });
exports.enableSwipeBackNavigationProperty.register(PageBase);
exports.statusBarStyleProperty = new content_view_1.CssProperty({ name: "statusBarStyle", cssName: "status-bar-style" });
exports.statusBarStyleProperty.register(content_view_1.Style);
exports.androidStatusBarBackgroundProperty = new content_view_1.CssProperty({
    name: "androidStatusBarBackground", cssName: "android-status-bar-background",
    equalityComparer: content_view_1.Color.equals, valueConverter: function (v) { return new content_view_1.Color(v); }
});
exports.androidStatusBarBackgroundProperty.register(content_view_1.Style);
//# sourceMappingURL=page-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/page/page.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var page_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/page/page-common.js");
var action_bar_1 = __webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar.js");
var grid_layout_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/page/page-common.js"));
var SYSTEM_UI_FLAG_LIGHT_STATUS_BAR = 0x00002000;
var STATUS_BAR_LIGHT_BCKG = -657931;
var STATUS_BAR_DARK_BCKG = 1711276032;
var Page = (function (_super) {
    __extends(Page, _super);
    function Page() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Page.prototype.createNativeView = function () {
        var layout = new org.nativescript.widgets.GridLayout(this._context);
        layout.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.auto));
        layout.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
        return layout;
    };
    Page.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this.nativeViewProtected.setBackgroundColor(-1);
    };
    Page.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        if (this.nativeViewProtected && child.nativeViewProtected) {
            if (child instanceof action_bar_1.ActionBar) {
                grid_layout_1.GridLayout.setRow(child, 0);
                child.horizontalAlignment = "stretch";
                child.verticalAlignment = "top";
            }
            else {
                grid_layout_1.GridLayout.setRow(child, 1);
            }
        }
        return _super.prototype._addViewToNativeVisualTree.call(this, child, atIndex);
    };
    Page.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        if (this.actionBarHidden !== undefined) {
            this.updateActionBar();
        }
    };
    Page.prototype.updateActionBar = function () {
        this.actionBar.update();
    };
    Page.prototype[page_common_1.actionBarHiddenProperty.setNative] = function (value) {
        this.updateActionBar();
    };
    Page.prototype[page_common_1.statusBarStyleProperty.getDefault] = function () {
        if (platform_1.device.sdkVersion >= "21") {
            var window_1 = this._context.getWindow();
            var decorView = window_1.getDecorView();
            return {
                color: window_1.getStatusBarColor(),
                systemUiVisibility: decorView.getSystemUiVisibility()
            };
        }
        return null;
    };
    Page.prototype[page_common_1.statusBarStyleProperty.setNative] = function (value) {
        if (platform_1.device.sdkVersion >= "21") {
            var window_2 = this._context.getWindow();
            var decorView = window_2.getDecorView();
            if (value === "light") {
                window_2.setStatusBarColor(STATUS_BAR_LIGHT_BCKG);
                decorView.setSystemUiVisibility(SYSTEM_UI_FLAG_LIGHT_STATUS_BAR);
            }
            else if (value === "dark") {
                window_2.setStatusBarColor(STATUS_BAR_DARK_BCKG);
                decorView.setSystemUiVisibility(0);
            }
            else {
                window_2.setStatusBarColor(value.color);
                decorView.setSystemUiVisibility(value.systemUiVisibility);
            }
        }
    };
    Page.prototype[page_common_1.androidStatusBarBackgroundProperty.getDefault] = function () {
        if (platform_1.device.sdkVersion >= "21") {
            var window_3 = this._context.getWindow();
            return window_3.getStatusBarColor();
        }
        return null;
    };
    Page.prototype[page_common_1.androidStatusBarBackgroundProperty.setNative] = function (value) {
        if (platform_1.device.sdkVersion >= "21") {
            var window_4 = this._context.getWindow();
            var color = value instanceof page_common_1.Color ? value.android : value;
            window_4.setStatusBarColor(color);
        }
    };
    __decorate([
        profiling_1.profile
    ], Page.prototype, "onLoaded", null);
    return Page;
}(page_common_1.PageBase));
exports.Page = Page;
//# sourceMappingURL=page.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/placeholder/placeholder.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var Placeholder = (function (_super) {
    __extends(Placeholder, _super);
    function Placeholder() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Placeholder_1 = Placeholder;
    Placeholder.prototype.createNativeView = function () {
        var args = { eventName: Placeholder_1.creatingViewEvent, object: this, view: undefined, context: this._context };
        this.notify(args);
        return args.view;
    };
    var Placeholder_1;
    Placeholder.creatingViewEvent = "creatingView";
    Placeholder = Placeholder_1 = __decorate([
        view_1.CSSType("Placeholder")
    ], Placeholder);
    return Placeholder;
}(view_1.View));
exports.Placeholder = Placeholder;
//# sourceMappingURL=placeholder.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/progress/progress-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ProgressBase = (function (_super) {
    __extends(ProgressBase, _super);
    function ProgressBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ProgressBase = __decorate([
        view_1.CSSType("Progress")
    ], ProgressBase);
    return ProgressBase;
}(view_1.View));
exports.ProgressBase = ProgressBase;
ProgressBase.prototype.recycleNativeView = "auto";
exports.valueProperty = new view_1.CoercibleProperty({
    name: "value",
    defaultValue: 0,
    coerceValue: function (t, v) {
        return v < 0 ? 0 : Math.min(v, t.maxValue);
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.valueProperty.register(ProgressBase);
exports.maxValueProperty = new view_1.Property({
    name: "maxValue",
    defaultValue: 100,
    valueChanged: function (target, oldValue, newValue) {
        exports.valueProperty.coerce(target);
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.maxValueProperty.register(ProgressBase);
//# sourceMappingURL=progress-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/progress/progress.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var progress_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/progress/progress-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/progress/progress-common.js"));
var R_ATTR_PROGRESS_BAR_STYLE_HORIZONTAL = 0x01010078;
var Progress = (function (_super) {
    __extends(Progress, _super);
    function Progress() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Progress.prototype.createNativeView = function () {
        return new android.widget.ProgressBar(this._context, null, R_ATTR_PROGRESS_BAR_STYLE_HORIZONTAL);
    };
    Progress.prototype[progress_common_1.valueProperty.getDefault] = function () {
        return 0;
    };
    Progress.prototype[progress_common_1.valueProperty.setNative] = function (value) {
        this.nativeViewProtected.setProgress(value);
    };
    Progress.prototype[progress_common_1.maxValueProperty.getDefault] = function () {
        return 100;
    };
    Progress.prototype[progress_common_1.maxValueProperty.setNative] = function (value) {
        this.nativeViewProtected.setMax(value);
    };
    Progress.prototype[progress_common_1.colorProperty.getDefault] = function () {
        return null;
    };
    Progress.prototype[progress_common_1.colorProperty.setNative] = function (value) {
        var progressDrawable = this.nativeViewProtected.getProgressDrawable();
        if (!progressDrawable) {
            return;
        }
        if (value instanceof progress_common_1.Color) {
            progressDrawable.setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
        }
        else {
            progressDrawable.clearColorFilter();
        }
    };
    Progress.prototype[progress_common_1.backgroundColorProperty.getDefault] = function () {
        return null;
    };
    Progress.prototype[progress_common_1.backgroundColorProperty.setNative] = function (value) {
        var progressDrawable = this.nativeViewProtected.getProgressDrawable();
        if (!progressDrawable) {
            return;
        }
        if (progressDrawable instanceof android.graphics.drawable.LayerDrawable && progressDrawable.getNumberOfLayers() > 0) {
            var backgroundDrawable = progressDrawable.getDrawable(0);
            if (backgroundDrawable) {
                if (value instanceof progress_common_1.Color) {
                    backgroundDrawable.setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
                }
                else {
                    backgroundDrawable.clearColorFilter();
                }
            }
        }
    };
    Progress.prototype[progress_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    Progress.prototype[progress_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    return Progress;
}(progress_common_1.ProgressBase));
exports.Progress = Progress;
//# sourceMappingURL=progress.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/proxy-view-container/proxy-view-container.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
var ProxyViewContainer = (function (_super) {
    __extends(ProxyViewContainer, _super);
    function ProxyViewContainer() {
        var _this = _super.call(this) || this;
        _this.nativeViewProtected = undefined;
        return _this;
    }
    Object.defineProperty(ProxyViewContainer.prototype, "ios", {
        get: function () {
            return null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ProxyViewContainer.prototype, "android", {
        get: function () {
            return null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ProxyViewContainer.prototype, "isLayoutRequested", {
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    ProxyViewContainer.prototype.createNativeView = function () {
        return undefined;
    };
    ProxyViewContainer.prototype._getNativeViewsCount = function () {
        var result = 0;
        this.eachChildView(function (cv) {
            result += cv._getNativeViewsCount();
            return true;
        });
        return result;
    };
    ProxyViewContainer.prototype._eachLayoutView = function (callback) {
        this.eachChildView(function (cv) {
            if (!cv.isCollapsed) {
                cv._eachLayoutView(callback);
            }
            return true;
        });
    };
    ProxyViewContainer.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        if (layout_base_1.traceEnabled()) {
            layout_base_1.traceWrite("ViewContainer._addViewToNativeVisualTree for a child " + child + " ViewContainer.parent: " + this.parent, layout_base_1.traceCategories.ViewHierarchy);
        }
        _super.prototype._addViewToNativeVisualTree.call(this, child);
        var parent = this.parent;
        if (parent instanceof layout_base_1.View) {
            var baseIndex = 0;
            var insideIndex = 0;
            if (parent instanceof layout_base_1.LayoutBase) {
                baseIndex = parent._childIndexToNativeChildIndex(parent.getChildIndex(this));
            }
            if (atIndex !== undefined) {
                insideIndex = this._childIndexToNativeChildIndex(atIndex);
            }
            else {
                insideIndex = this._getNativeViewsCount();
            }
            if (layout_base_1.traceEnabled()) {
                layout_base_1.traceWrite("ProxyViewContainer._addViewToNativeVisualTree at: " + atIndex + " base: " + baseIndex + " additional: " + insideIndex, layout_base_1.traceCategories.ViewHierarchy);
            }
            return parent._addViewToNativeVisualTree(child, baseIndex + insideIndex);
        }
        return false;
    };
    ProxyViewContainer.prototype._removeViewFromNativeVisualTree = function (child) {
        if (layout_base_1.traceEnabled()) {
            layout_base_1.traceWrite("ProxyViewContainer._removeViewFromNativeVisualTree for a child " + child + " ViewContainer.parent: " + this.parent, layout_base_1.traceCategories.ViewHierarchy);
        }
        _super.prototype._removeViewFromNativeVisualTree.call(this, child);
        var parent = this.parent;
        if (parent instanceof layout_base_1.View) {
            return parent._removeViewFromNativeVisualTree(child);
        }
    };
    ProxyViewContainer.prototype._registerLayoutChild = function (child) {
        var parent = this.parent;
        if (parent instanceof layout_base_1.LayoutBase) {
            parent._registerLayoutChild(child);
        }
    };
    ProxyViewContainer.prototype._unregisterLayoutChild = function (child) {
        var parent = this.parent;
        if (parent instanceof layout_base_1.LayoutBase) {
            parent._unregisterLayoutChild(child);
        }
    };
    ProxyViewContainer.prototype._parentChanged = function (oldParent) {
        _super.prototype._parentChanged.call(this, oldParent);
        var addingToParent = this.parent && !oldParent;
        var newLayout = this.parent;
        var oldLayout = oldParent;
        if (addingToParent && newLayout instanceof layout_base_1.LayoutBase) {
            this.eachLayoutChild(function (child) {
                newLayout._registerLayoutChild(child);
                return true;
            });
        }
        else if (oldLayout instanceof layout_base_1.LayoutBase) {
            this.eachLayoutChild(function (child) {
                oldLayout._unregisterLayoutChild(child);
                return true;
            });
        }
    };
    ProxyViewContainer = __decorate([
        layout_base_1.CSSType("ProxyViewContainer")
    ], ProxyViewContainer);
    return ProxyViewContainer;
}(layout_base_1.LayoutBase));
exports.ProxyViewContainer = ProxyViewContainer;
//# sourceMappingURL=proxy-view-container.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/repeater/repeater.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var label_1 = __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js");
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
var stack_layout_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout.js");
var observable_array_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable-array/observable-array.js");
var weak_event_listener_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
var knownTemplates;
(function (knownTemplates) {
    knownTemplates.itemTemplate = "itemTemplate";
})(knownTemplates = exports.knownTemplates || (exports.knownTemplates = {}));
var Repeater = (function (_super) {
    __extends(Repeater, _super);
    function Repeater() {
        var _this = _super.call(this) || this;
        _this._isDirty = false;
        _this.itemsLayout = new stack_layout_1.StackLayout();
        return _this;
    }
    Repeater.prototype.onLoaded = function () {
        if (this._isDirty) {
            this.refresh();
        }
        _super.prototype.onLoaded.call(this);
    };
    Repeater.prototype._requestRefresh = function () {
        this._isDirty = true;
        if (this.isLoaded) {
            this.refresh();
        }
    };
    Repeater.prototype.refresh = function () {
        if (this.itemsLayout) {
            this.itemsLayout.removeChildren();
        }
        if (!this.items) {
            return;
        }
        var length = this.items.length;
        for (var i = 0; i < length; i++) {
            var viewToAdd = this.itemTemplate ? builder_1.parse(this.itemTemplate, this) : this._getDefaultItemContent(i);
            var dataItem = this._getDataItem(i);
            viewToAdd.bindingContext = dataItem;
            this.itemsLayout.addChild(viewToAdd);
        }
        this._isDirty = false;
    };
    Repeater.prototype._onItemsChanged = function (data) {
        this._requestRefresh();
    };
    Repeater.prototype._getDefaultItemContent = function (index) {
        var lbl = new label_1.Label();
        lbl.bind({
            targetProperty: "text",
            sourceProperty: "$value"
        });
        return lbl;
    };
    Repeater.prototype._getDataItem = function (index) {
        var items = this.items;
        return items.getItem ? items.getItem(index) : this.items[index];
    };
    Object.defineProperty(Repeater.prototype, "_childrenCount", {
        get: function () {
            return this.itemsLayout ? 1 : 0;
        },
        enumerable: true,
        configurable: true
    });
    Repeater.prototype.eachChildView = function (callback) {
        if (this.itemsLayout) {
            callback(this.itemsLayout);
        }
    };
    Repeater.prototype.onLayout = function (left, top, right, bottom) {
        var insets = this.getSafeAreaInsets();
        var paddingLeft = this.effectiveBorderLeftWidth + this.effectivePaddingLeft + insets.left;
        var paddingTop = this.effectiveBorderTopWidth + this.effectivePaddingTop + insets.top;
        var paddingRight = this.effectiveBorderRightWidth + this.effectivePaddingRight + insets.right;
        var paddingBottom = this.effectiveBorderBottomWidth + this.effectivePaddingBottom + insets.bottom;
        var childLeft = paddingLeft;
        var childTop = paddingTop;
        var childRight = right - left - paddingRight;
        var childBottom = bottom - top - paddingBottom;
        layout_base_1.View.layoutChild(this, this.itemsLayout, childLeft, childTop, childRight, childBottom);
    };
    Repeater.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var result = layout_base_1.View.measureChild(this, this.itemsLayout, widthMeasureSpec, heightMeasureSpec);
        var width = layout_base_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = layout_base_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = layout_base_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = layout_base_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var widthAndState = layout_base_1.View.resolveSizeAndState(result.measuredWidth, width, widthMode, 0);
        var heightAndState = layout_base_1.View.resolveSizeAndState(result.measuredHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    __decorate([
        profiling_1.profile
    ], Repeater.prototype, "onLoaded", null);
    Repeater = __decorate([
        layout_base_1.CSSType("Repeater")
    ], Repeater);
    return Repeater;
}(layout_base_1.CustomLayoutView));
exports.Repeater = Repeater;
Repeater.prototype.recycleNativeView = "auto";
exports.itemTemplateProperty = new layout_base_1.Property({
    name: "itemTemplate", affectsLayout: true, valueChanged: function (target) {
        target._requestRefresh();
    }
});
exports.itemTemplateProperty.register(Repeater);
exports.itemsProperty = new layout_base_1.Property({
    name: "items", affectsLayout: true, valueChanged: function (target, oldValue, newValue) {
        if (oldValue instanceof observable_array_1.ObservableArray) {
            weak_event_listener_1.removeWeakEventListener(oldValue, observable_array_1.ObservableArray.changeEvent, target._onItemsChanged, target);
        }
        if (newValue instanceof observable_array_1.ObservableArray) {
            weak_event_listener_1.addWeakEventListener(newValue, observable_array_1.ObservableArray.changeEvent, target._onItemsChanged, target);
        }
        target._requestRefresh();
    }
});
exports.itemsProperty.register(Repeater);
exports.itemsLayoutProperty = new layout_base_1.Property({
    name: "itemsLayout", affectsLayout: true, valueChanged: function (target, oldValue, newValue) {
        if (oldValue) {
            target._removeView(oldValue);
            oldValue.removeChildren();
        }
        if (newValue) {
            target._addView(newValue);
        }
        target._requestRefresh();
    }
});
exports.itemsLayoutProperty.register(Repeater);
//# sourceMappingURL=repeater.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/scroll-view/scroll-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var content_view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js"));
var ScrollViewBase = (function (_super) {
    __extends(ScrollViewBase, _super);
    function ScrollViewBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._scrollChangeCount = 0;
        return _this;
    }
    ScrollViewBase_1 = ScrollViewBase;
    ScrollViewBase.prototype.addEventListener = function (arg, callback, thisArg) {
        _super.prototype.addEventListener.call(this, arg, callback, thisArg);
        if (arg === ScrollViewBase_1.scrollEvent) {
            this._scrollChangeCount++;
            this.attach();
        }
    };
    ScrollViewBase.prototype.removeEventListener = function (arg, callback, thisArg) {
        _super.prototype.removeEventListener.call(this, arg, callback, thisArg);
        if (arg === ScrollViewBase_1.scrollEvent) {
            this._scrollChangeCount--;
            this.dettach();
        }
    };
    ScrollViewBase.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.attach();
    };
    ScrollViewBase.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        this.dettach();
    };
    ScrollViewBase.prototype.attach = function () {
        if (this._scrollChangeCount > 0 && this.isLoaded) {
            this.attachNative();
        }
    };
    ScrollViewBase.prototype.dettach = function () {
        if (this._scrollChangeCount === 0 && this.isLoaded) {
            this.dettachNative();
        }
    };
    ScrollViewBase.prototype.attachNative = function () {
    };
    ScrollViewBase.prototype.dettachNative = function () {
    };
    Object.defineProperty(ScrollViewBase.prototype, "horizontalOffset", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollViewBase.prototype, "verticalOffset", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollViewBase.prototype, "scrollableWidth", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollViewBase.prototype, "scrollableHeight", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    var ScrollViewBase_1;
    ScrollViewBase.scrollEvent = "scroll";
    __decorate([
        profiling_1.profile
    ], ScrollViewBase.prototype, "onLoaded", null);
    ScrollViewBase = ScrollViewBase_1 = __decorate([
        content_view_1.CSSType("ScrollView")
    ], ScrollViewBase);
    return ScrollViewBase;
}(content_view_1.ContentView));
exports.ScrollViewBase = ScrollViewBase;
var converter = content_view_1.makeParser(content_view_1.makeValidator("horizontal", "vertical"));
exports.orientationProperty = new content_view_1.Property({
    name: "orientation", defaultValue: "vertical", affectsLayout: true,
    valueChanged: function (target, oldValue, newValue) {
        target._onOrientationChanged();
    },
    valueConverter: converter
});
exports.orientationProperty.register(ScrollViewBase);
exports.scrollBarIndicatorVisibleProperty = new content_view_1.Property({
    name: "scrollBarIndicatorVisible", defaultValue: true,
    valueConverter: content_view_1.booleanConverter
});
exports.scrollBarIndicatorVisibleProperty.register(ScrollViewBase);
exports.isScrollEnabledProperty = new content_view_1.Property({
    name: "isScrollEnabled", defaultValue: true,
    valueConverter: content_view_1.booleanConverter
});
exports.isScrollEnabledProperty.register(ScrollViewBase);
//# sourceMappingURL=scroll-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/scroll-view/scroll-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var scroll_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/scroll-view/scroll-view-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/scroll-view/scroll-view-common.js"));
var ScrollView = (function (_super) {
    __extends(ScrollView, _super);
    function ScrollView() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._androidViewId = -1;
        _this._lastScrollX = -1;
        _this._lastScrollY = -1;
        return _this;
    }
    Object.defineProperty(ScrollView.prototype, "horizontalOffset", {
        get: function () {
            var nativeView = this.nativeViewProtected;
            if (!nativeView) {
                return 0;
            }
            return nativeView.getScrollX() / scroll_view_common_1.layout.getDisplayDensity();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollView.prototype, "verticalOffset", {
        get: function () {
            var nativeView = this.nativeViewProtected;
            if (!nativeView) {
                return 0;
            }
            return nativeView.getScrollY() / scroll_view_common_1.layout.getDisplayDensity();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollView.prototype, "scrollableWidth", {
        get: function () {
            var nativeView = this.nativeViewProtected;
            if (!nativeView || this.orientation !== "horizontal") {
                return 0;
            }
            return nativeView.getScrollableLength() / scroll_view_common_1.layout.getDisplayDensity();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollView.prototype, "scrollableHeight", {
        get: function () {
            var nativeView = this.nativeViewProtected;
            if (!nativeView || this.orientation !== "vertical") {
                return 0;
            }
            return nativeView.getScrollableLength() / scroll_view_common_1.layout.getDisplayDensity();
        },
        enumerable: true,
        configurable: true
    });
    ScrollView.prototype[scroll_view_common_1.isUserInteractionEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.setClickable(value);
        this.nativeViewProtected.setFocusable(value);
        this.nativeViewProtected.setScrollEnabled(value);
    };
    ScrollView.prototype[scroll_view_common_1.isScrollEnabledProperty.getDefault] = function () {
        return this.nativeViewProtected.getScrollEnabled();
    };
    ScrollView.prototype[scroll_view_common_1.isScrollEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.setScrollEnabled(value);
    };
    ScrollView.prototype[scroll_view_common_1.scrollBarIndicatorVisibleProperty.getDefault] = function () {
        return true;
    };
    ScrollView.prototype[scroll_view_common_1.scrollBarIndicatorVisibleProperty.setNative] = function (value) {
        if (this.orientation === "horizontal") {
            this.nativeViewProtected.setHorizontalScrollBarEnabled(value);
        }
        else {
            this.nativeViewProtected.setVerticalScrollBarEnabled(value);
        }
    };
    ScrollView.prototype.scrollToVerticalOffset = function (value, animated) {
        var nativeView = this.nativeViewProtected;
        if (nativeView && this.orientation === "vertical" && this.isScrollEnabled) {
            value *= scroll_view_common_1.layout.getDisplayDensity();
            if (animated) {
                nativeView.smoothScrollTo(0, value);
            }
            else {
                nativeView.scrollTo(0, value);
            }
        }
    };
    ScrollView.prototype.scrollToHorizontalOffset = function (value, animated) {
        var nativeView = this.nativeViewProtected;
        if (nativeView && this.orientation === "horizontal" && this.isScrollEnabled) {
            value *= scroll_view_common_1.layout.getDisplayDensity();
            if (animated) {
                nativeView.smoothScrollTo(value, 0);
            }
            else {
                nativeView.scrollTo(value, 0);
            }
        }
    };
    ScrollView.prototype.createNativeView = function () {
        return this.orientation === "horizontal" ? new org.nativescript.widgets.HorizontalScrollView(this._context) : new org.nativescript.widgets.VerticalScrollView(this._context);
    };
    ScrollView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        if (this._androidViewId < 0) {
            this._androidViewId = android.view.View.generateViewId();
        }
        this.nativeViewProtected.setId(this._androidViewId);
    };
    ScrollView.prototype._onOrientationChanged = function () {
        if (this.nativeViewProtected) {
            var parent_1 = this.parent;
            if (parent_1) {
                parent_1._removeView(this);
                parent_1._addView(this);
            }
        }
    };
    ScrollView.prototype.attachNative = function () {
        var that = new WeakRef(this);
        this.handler = new android.view.ViewTreeObserver.OnScrollChangedListener({
            onScrollChanged: function () {
                var owner = that.get();
                if (owner) {
                    owner._onScrollChanged();
                }
            }
        });
        this.nativeViewProtected.getViewTreeObserver().addOnScrollChangedListener(this.handler);
    };
    ScrollView.prototype._onScrollChanged = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            var newScrollX = nativeView.getScrollX();
            var newScrollY = nativeView.getScrollY();
            if (newScrollX !== this._lastScrollX || newScrollY !== this._lastScrollY) {
                this.notify({
                    object: this,
                    eventName: ScrollView.scrollEvent,
                    scrollX: newScrollX / scroll_view_common_1.layout.getDisplayDensity(),
                    scrollY: newScrollY / scroll_view_common_1.layout.getDisplayDensity()
                });
                this._lastScrollX = newScrollX;
                this._lastScrollY = newScrollY;
            }
        }
    };
    ScrollView.prototype.dettachNative = function () {
        this.nativeViewProtected.getViewTreeObserver().removeOnScrollChangedListener(this.handler);
        this.handler = null;
    };
    return ScrollView;
}(scroll_view_common_1.ScrollViewBase));
exports.ScrollView = ScrollView;
ScrollView.prototype.recycleNativeView = "never";
//# sourceMappingURL=scroll-view.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/search-bar/search-bar-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var SearchBarBase = (function (_super) {
    __extends(SearchBarBase, _super);
    function SearchBarBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SearchBarBase.submitEvent = "submit";
    SearchBarBase.clearEvent = "clear";
    SearchBarBase = __decorate([
        view_1.CSSType("SearchBar")
    ], SearchBarBase);
    return SearchBarBase;
}(view_1.View));
exports.SearchBarBase = SearchBarBase;
SearchBarBase.prototype.recycleNativeView = "auto";
exports.textProperty = new view_1.Property({ name: "text", defaultValue: "", affectsLayout: view_1.isIOS });
exports.textProperty.register(SearchBarBase);
exports.hintProperty = new view_1.Property({ name: "hint", defaultValue: "" });
exports.hintProperty.register(SearchBarBase);
exports.textFieldHintColorProperty = new view_1.Property({ name: "textFieldHintColor", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.textFieldHintColorProperty.register(SearchBarBase);
exports.textFieldBackgroundColorProperty = new view_1.Property({ name: "textFieldBackgroundColor", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.textFieldBackgroundColorProperty.register(SearchBarBase);
//# sourceMappingURL=search-bar-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/search-bar/search-bar.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var search_bar_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/search-bar/search-bar-common.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/search-bar/search-bar-common.js"));
var SEARCHTEXT = Symbol("searchText");
var QUERY = Symbol("query");
var QueryTextListener;
var CloseListener;
function initializeNativeClasses() {
    if (QueryTextListener) {
        return;
    }
    var CompatQueryTextListenerImpl = (function (_super) {
        __extends(CompatQueryTextListenerImpl, _super);
        function CompatQueryTextListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        CompatQueryTextListenerImpl.prototype.onQueryTextChange = function (newText) {
            var owner = this.owner;
            search_bar_common_1.textProperty.nativeValueChange(owner, newText);
            if (newText === "" && this[SEARCHTEXT] !== newText) {
                owner._emit(search_bar_common_1.SearchBarBase.clearEvent);
            }
            this[SEARCHTEXT] = newText;
            this[QUERY] = undefined;
            return true;
        };
        CompatQueryTextListenerImpl.prototype.onQueryTextSubmit = function (query) {
            var owner = this.owner;
            if (query !== "" && this[QUERY] !== query) {
                owner._emit(search_bar_common_1.SearchBarBase.submitEvent);
            }
            this[QUERY] = query;
            return true;
        };
        CompatQueryTextListenerImpl = __decorate([
            Interfaces([androidx.appcompat.widget.SearchView.OnQueryTextListener])
        ], CompatQueryTextListenerImpl);
        return CompatQueryTextListenerImpl;
    }(java.lang.Object));
    var CompatCloseListenerImpl = (function (_super) {
        __extends(CompatCloseListenerImpl, _super);
        function CompatCloseListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        CompatCloseListenerImpl.prototype.onClose = function () {
            this.owner._emit(search_bar_common_1.SearchBarBase.clearEvent);
            return true;
        };
        CompatCloseListenerImpl = __decorate([
            Interfaces([androidx.appcompat.widget.SearchView.OnCloseListener])
        ], CompatCloseListenerImpl);
        return CompatCloseListenerImpl;
    }(java.lang.Object));
    QueryTextListener = CompatQueryTextListenerImpl;
    CloseListener = CompatCloseListenerImpl;
}
function enableSearchView(nativeView, value) {
    nativeView.setEnabled(value);
    if (!(nativeView instanceof android.view.ViewGroup)) {
        return;
    }
    for (var i = 0; i < nativeView.getChildCount(); i++) {
        var child = nativeView.getChildAt(i);
        enableSearchView(child, value);
    }
}
function enableUserInteractionSearchView(nativeView, value) {
    nativeView.setClickable(value);
    nativeView.setFocusable(value);
    if (!(nativeView instanceof android.view.ViewGroup)) {
        return;
    }
    for (var i = 0; i < nativeView.getChildCount(); i++) {
        var child = nativeView.getChildAt(i);
        enableUserInteractionSearchView(child, value);
    }
}
var SearchBar = (function (_super) {
    __extends(SearchBar, _super);
    function SearchBar() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SearchBar.prototype.dismissSoftInput = function () {
        utils_1.ad.dismissSoftInput(this.nativeViewProtected);
    };
    SearchBar.prototype.focus = function () {
        var result = _super.prototype.focus.call(this);
        if (result) {
            utils_1.ad.showSoftInput(this.nativeViewProtected);
        }
        return result;
    };
    SearchBar.prototype.createNativeView = function () {
        var nativeView = new androidx.appcompat.widget.SearchView(this._context);
        nativeView.setIconified(false);
        return nativeView;
    };
    SearchBar.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        initializeNativeClasses();
        var queryTextListener = new QueryTextListener(this);
        nativeView.setOnQueryTextListener(queryTextListener);
        nativeView.queryTextListener = queryTextListener;
        var closeListener = new CloseListener(this);
        nativeView.setOnCloseListener(closeListener);
        nativeView.closeListener = closeListener;
    };
    SearchBar.prototype.disposeNativeView = function () {
        var nativeView = this.nativeViewProtected;
        nativeView.closeListener.owner = null;
        nativeView.queryTextListener.owner = null;
        this._searchPlate = null;
        this._searchTextView = null;
        _super.prototype.disposeNativeView.call(this);
    };
    SearchBar.prototype[search_bar_common_1.isEnabledProperty.setNative] = function (value) {
        enableSearchView(this.nativeViewProtected, value);
    };
    SearchBar.prototype[search_bar_common_1.isUserInteractionEnabledProperty.setNative] = function (value) {
        enableUserInteractionSearchView(this.nativeViewProtected, value);
    };
    SearchBar.prototype[search_bar_common_1.backgroundColorProperty.getDefault] = function () {
        var result = this.nativeViewProtected.getDrawingCacheBackgroundColor();
        return result;
    };
    SearchBar.prototype[search_bar_common_1.backgroundColorProperty.setNative] = function (value) {
        var color;
        if (typeof value === "number") {
            color = value;
        }
        else {
            color = value.android;
        }
        this.nativeViewProtected.setBackgroundColor(color);
        var searchPlate = this._getSearchPlate();
        searchPlate.setBackgroundColor(color);
    };
    SearchBar.prototype[search_bar_common_1.colorProperty.getDefault] = function () {
        var textView = this._getTextView();
        return textView.getCurrentTextColor();
    };
    SearchBar.prototype[search_bar_common_1.colorProperty.setNative] = function (value) {
        var color = (typeof value === "number") ? value : value.android;
        var textView = this._getTextView();
        textView.setTextColor(color);
    };
    SearchBar.prototype[search_bar_common_1.fontSizeProperty.getDefault] = function () {
        return { nativeSize: this._getTextView().getTextSize() };
    };
    SearchBar.prototype[search_bar_common_1.fontSizeProperty.setNative] = function (value) {
        if (typeof value === "number") {
            this._getTextView().setTextSize(value);
        }
        else {
            this._getTextView().setTextSize(android.util.TypedValue.COMPLEX_UNIT_PX, value.nativeSize);
        }
    };
    SearchBar.prototype[search_bar_common_1.fontInternalProperty.getDefault] = function () {
        return this._getTextView().getTypeface();
    };
    SearchBar.prototype[search_bar_common_1.fontInternalProperty.setNative] = function (value) {
        this._getTextView().setTypeface(value instanceof font_1.Font ? value.getAndroidTypeface() : value);
    };
    SearchBar.prototype[search_bar_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    SearchBar.prototype[search_bar_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    SearchBar.prototype[search_bar_common_1.textProperty.getDefault] = function () {
        return "";
    };
    SearchBar.prototype[search_bar_common_1.textProperty.setNative] = function (value) {
        var text = (value === null || value === undefined) ? "" : value.toString();
        this.nativeViewProtected.setQuery(text, false);
    };
    SearchBar.prototype[search_bar_common_1.hintProperty.getDefault] = function () {
        return null;
    };
    SearchBar.prototype[search_bar_common_1.hintProperty.setNative] = function (value) {
        if (value === null || value === undefined) {
            this.nativeViewProtected.setQueryHint(null);
        }
        else {
            this.nativeViewProtected.setQueryHint(value.toString());
        }
    };
    SearchBar.prototype[search_bar_common_1.textFieldBackgroundColorProperty.getDefault] = function () {
        var textView = this._getTextView();
        return textView.getBackground();
    };
    SearchBar.prototype[search_bar_common_1.textFieldBackgroundColorProperty.setNative] = function (value) {
        var textView = this._getTextView();
        if (value instanceof search_bar_common_1.Color) {
            textView.setBackgroundColor(value.android);
        }
        else {
            textView.setBackground(value);
        }
    };
    SearchBar.prototype[search_bar_common_1.textFieldHintColorProperty.getDefault] = function () {
        var textView = this._getTextView();
        return textView.getCurrentTextColor();
    };
    SearchBar.prototype[search_bar_common_1.textFieldHintColorProperty.setNative] = function (value) {
        var textView = this._getTextView();
        var color = value instanceof search_bar_common_1.Color ? value.android : value;
        textView.setHintTextColor(color);
    };
    SearchBar.prototype._getTextView = function () {
        if (!this._searchTextView) {
            var pkgName = this.nativeViewProtected.getContext().getPackageName();
            var id = this.nativeViewProtected.getContext().getResources().getIdentifier("search_src_text", "id", pkgName);
            this._searchTextView = this.nativeViewProtected.findViewById(id);
        }
        return this._searchTextView;
    };
    SearchBar.prototype._getSearchPlate = function () {
        if (!this._searchPlate) {
            var pkgName = this.nativeViewProtected.getContext().getPackageName();
            var id = this.nativeViewProtected.getContext().getResources().getIdentifier("search_plate", "id", pkgName);
            this._searchPlate = this.nativeViewProtected.findViewById(id);
        }
        return this._searchPlate;
    };
    return SearchBar;
}(search_bar_common_1.SearchBarBase));
exports.SearchBar = SearchBar;
//# sourceMappingURL=search-bar.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var knownCollections;
(function (knownCollections) {
    knownCollections.items = "items";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var SegmentedBarItemBase = (function (_super) {
    __extends(SegmentedBarItemBase, _super);
    function SegmentedBarItemBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._title = "";
        return _this;
    }
    Object.defineProperty(SegmentedBarItemBase.prototype, "title", {
        get: function () {
            return this._title;
        },
        set: function (value) {
            var strValue = (value !== null && value !== undefined) ? value.toString() : "";
            if (this._title !== strValue) {
                this._title = strValue;
                this._update();
            }
        },
        enumerable: true,
        configurable: true
    });
    SegmentedBarItemBase = __decorate([
        view_1.CSSType("SegmentedBarItem")
    ], SegmentedBarItemBase);
    return SegmentedBarItemBase;
}(view_1.ViewBase));
exports.SegmentedBarItemBase = SegmentedBarItemBase;
var SegmentedBarBase = (function (_super) {
    __extends(SegmentedBarBase, _super);
    function SegmentedBarBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(SegmentedBarBase.prototype, "selectedBackgroundColor", {
        get: function () {
            return this.style.selectedBackgroundColor;
        },
        set: function (value) {
            this.style.selectedBackgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    SegmentedBarBase.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "items") {
            this.items = value;
        }
    };
    SegmentedBarBase.prototype._addChildFromBuilder = function (name, value) {
        if (name === "SegmentedBarItem") {
            var item = value;
            var items = this.items;
            if (!items) {
                items = new Array();
                items.push(item);
                this.items = items;
            }
            else {
                items.push(item);
                this._addView(item);
            }
            if (this.nativeViewProtected) {
                this[exports.itemsProperty.setNative](items);
            }
        }
    };
    SegmentedBarBase.prototype.onItemsChanged = function (oldItems, newItems) {
        if (oldItems) {
            for (var i = 0, count = oldItems.length; i < count; i++) {
                this._removeView(oldItems[i]);
            }
        }
        if (newItems) {
            for (var i = 0, count = newItems.length; i < count; i++) {
                this._addView(newItems[i]);
            }
        }
    };
    SegmentedBarBase.prototype.eachChild = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item);
            });
        }
    };
    SegmentedBarBase.selectedIndexChangedEvent = "selectedIndexChanged";
    SegmentedBarBase = __decorate([
        view_1.CSSType("SegmentedBar")
    ], SegmentedBarBase);
    return SegmentedBarBase;
}(view_1.View));
exports.SegmentedBarBase = SegmentedBarBase;
SegmentedBarBase.prototype.recycleNativeView = "auto";
exports.selectedIndexProperty = new view_1.CoercibleProperty({
    name: "selectedIndex", defaultValue: -1,
    valueChanged: function (target, oldValue, newValue) {
        target.notify({ eventName: SegmentedBarBase.selectedIndexChangedEvent, object: target, oldIndex: oldValue, newIndex: newValue });
    },
    coerceValue: function (target, value) {
        var items = target.items;
        if (items) {
            var max = items.length - 1;
            if (value < 0) {
                value = 0;
            }
            if (value > max) {
                value = max;
            }
        }
        else {
            value = -1;
        }
        return value;
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.selectedIndexProperty.register(SegmentedBarBase);
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        target.onItemsChanged(oldValue, newValue);
    }
});
exports.itemsProperty.register(SegmentedBarBase);
exports.selectedBackgroundColorProperty = new view_1.InheritedCssProperty({ name: "selectedBackgroundColor", cssName: "selected-background-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.selectedBackgroundColorProperty.register(view_1.Style);
//# sourceMappingURL=segmented-bar-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var segmented_bar_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar-common.js"));
var R_ID_TABS = 0x01020013;
var R_ID_TABCONTENT = 0x01020011;
var R_ATTR_STATE_SELECTED = 0x010100a1;
var TITLE_TEXT_VIEW_ID = 16908310;
var apiLevel;
var selectedIndicatorThickness;
var TabHost;
var TabChangeListener;
var TabContentFactory;
function initializeNativeClasses() {
    if (TabChangeListener) {
        return;
    }
    apiLevel = android.os.Build.VERSION.SDK_INT;
    selectedIndicatorThickness = segmented_bar_common_1.layout.toDevicePixels(apiLevel >= 21 ? 2 : 5);
    var TabChangeListenerImpl = (function (_super) {
        __extends(TabChangeListenerImpl, _super);
        function TabChangeListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        TabChangeListenerImpl.prototype.onTabChanged = function (id) {
            var owner = this.owner;
            if (owner.shouldChangeSelectedIndex()) {
                owner.selectedIndex = parseInt(id);
            }
        };
        TabChangeListenerImpl = __decorate([
            Interfaces([android.widget.TabHost.OnTabChangeListener])
        ], TabChangeListenerImpl);
        return TabChangeListenerImpl;
    }(java.lang.Object));
    var TabContentFactoryImpl = (function (_super) {
        __extends(TabContentFactoryImpl, _super);
        function TabContentFactoryImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        TabContentFactoryImpl.prototype.createTabContent = function (tag) {
            var tv = new android.widget.TextView(this.owner._context);
            tv.setVisibility(android.view.View.GONE);
            tv.setMaxLines(1);
            tv.setEllipsize(android.text.TextUtils.TruncateAt.END);
            return tv;
        };
        TabContentFactoryImpl = __decorate([
            Interfaces([android.widget.TabHost.TabContentFactory])
        ], TabContentFactoryImpl);
        return TabContentFactoryImpl;
    }(java.lang.Object));
    var TabHostImpl = (function (_super) {
        __extends(TabHostImpl, _super);
        function TabHostImpl(context, attrs) {
            var _this = _super.call(this, context, attrs) || this;
            return global.__native(_this);
        }
        TabHostImpl.prototype.onAttachedToWindow = function () {
        };
        return TabHostImpl;
    }(android.widget.TabHost));
    TabHost = TabHostImpl;
    TabChangeListener = TabChangeListenerImpl;
    TabContentFactory = TabContentFactoryImpl;
}
var SegmentedBarItem = (function (_super) {
    __extends(SegmentedBarItem, _super);
    function SegmentedBarItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SegmentedBarItem.prototype.setupNativeView = function (tabIndex) {
        var titleTextView = this.parent.nativeViewProtected.getTabWidget().getChildAt(tabIndex).findViewById(TITLE_TEXT_VIEW_ID);
        this.setNativeView(titleTextView);
        if (titleTextView) {
            if (this.titleDirty) {
                this._update();
            }
        }
    };
    SegmentedBarItem.prototype._update = function () {
        var tv = this.nativeViewProtected;
        if (tv) {
            var title = this.title;
            title = (title === null || title === undefined) ? "" : title;
            tv.setText(title);
            this.titleDirty = false;
        }
        else {
            this.titleDirty = true;
        }
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.colorProperty.getDefault] = function () {
        return this.nativeViewProtected.getCurrentTextColor();
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.colorProperty.setNative] = function (value) {
        var color = value instanceof segmented_bar_common_1.Color ? value.android : value;
        this.nativeViewProtected.setTextColor(color);
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.fontSizeProperty.getDefault] = function () {
        return { nativeSize: this.nativeViewProtected.getTextSize() };
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.fontSizeProperty.setNative] = function (value) {
        if (typeof value === "number") {
            this.nativeViewProtected.setTextSize(value);
        }
        else {
            this.nativeViewProtected.setTextSize(android.util.TypedValue.COMPLEX_UNIT_PX, value.nativeSize);
        }
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.fontInternalProperty.getDefault] = function () {
        return this.nativeViewProtected.getTypeface();
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.fontInternalProperty.setNative] = function (value) {
        this.nativeViewProtected.setTypeface(value instanceof font_1.Font ? value.getAndroidTypeface() : value);
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.selectedBackgroundColorProperty.getDefault] = function () {
        var viewGroup = this.nativeViewProtected.getParent();
        return viewGroup.getBackground();
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.selectedBackgroundColorProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        var viewGroup = nativeView.getParent();
        if (value instanceof segmented_bar_common_1.Color) {
            var color = value.android;
            var backgroundDrawable = viewGroup.getBackground();
            if (apiLevel > 21 && backgroundDrawable) {
                var newDrawable = tryCloneDrawable(backgroundDrawable, nativeView.getResources());
                newDrawable.setColorFilter(color, android.graphics.PorterDuff.Mode.SRC_IN);
                viewGroup.setBackground(newDrawable);
            }
            else {
                var stateDrawable = new android.graphics.drawable.StateListDrawable();
                var colorDrawable = new org.nativescript.widgets.SegmentedBarColorDrawable(color, selectedIndicatorThickness);
                var arr = Array.create("int", 1);
                arr[0] = R_ATTR_STATE_SELECTED;
                stateDrawable.addState(arr, colorDrawable);
                stateDrawable.setBounds(0, 15, viewGroup.getRight(), viewGroup.getBottom());
                viewGroup.setBackground(stateDrawable);
            }
        }
        else {
            var backgroundDrawable = tryCloneDrawable(value, nativeView.getResources());
            viewGroup.setBackground(backgroundDrawable);
        }
    };
    return SegmentedBarItem;
}(segmented_bar_common_1.SegmentedBarItemBase));
exports.SegmentedBarItem = SegmentedBarItem;
function tryCloneDrawable(value, resources) {
    if (value) {
        var constantState = value.getConstantState();
        if (constantState) {
            return constantState.newDrawable(resources);
        }
    }
    return value;
}
var SegmentedBar = (function (_super) {
    __extends(SegmentedBar, _super);
    function SegmentedBar() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SegmentedBar.prototype.shouldChangeSelectedIndex = function () {
        return !this._addingTab;
    };
    SegmentedBar.prototype.createNativeView = function () {
        initializeNativeClasses();
        var context = this._context;
        var nativeView = new TabHost(context, null);
        var tabHostLayout = new android.widget.LinearLayout(context);
        tabHostLayout.setOrientation(android.widget.LinearLayout.VERTICAL);
        var tabWidget = new android.widget.TabWidget(context);
        tabWidget.setId(R_ID_TABS);
        tabHostLayout.addView(tabWidget);
        var frame = new android.widget.FrameLayout(context);
        frame.setId(R_ID_TABCONTENT);
        frame.setVisibility(android.view.View.GONE);
        tabHostLayout.addView(frame);
        nativeView.addView(tabHostLayout);
        return nativeView;
    };
    SegmentedBar.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        var listener = new TabChangeListener(this);
        nativeView.setOnTabChangedListener(listener);
        nativeView.listener = listener;
        nativeView.setup();
        this._tabContentFactory = this._tabContentFactory || new TabContentFactory(this);
    };
    SegmentedBar.prototype.disposeNativeView = function () {
        var nativeView = this.nativeViewProtected;
        nativeView.listener.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    SegmentedBar.prototype.insertTab = function (tabItem, index) {
        var tabHost = this.nativeViewProtected;
        var tab = tabHost.newTabSpec(index + "");
        tab.setIndicator(tabItem.title + "");
        tab.setContent(this._tabContentFactory);
        this._addingTab = true;
        tabHost.addTab(tab);
        tabItem.setupNativeView(index);
        this._addingTab = false;
    };
    SegmentedBar.prototype[segmented_bar_common_1.selectedIndexProperty.getDefault] = function () {
        return -1;
    };
    SegmentedBar.prototype[segmented_bar_common_1.selectedIndexProperty.setNative] = function (value) {
        this.nativeViewProtected.setCurrentTab(value);
    };
    SegmentedBar.prototype[segmented_bar_common_1.itemsProperty.getDefault] = function () {
        return null;
    };
    SegmentedBar.prototype[segmented_bar_common_1.itemsProperty.setNative] = function (value) {
        var _this = this;
        this.nativeViewProtected.clearAllTabs();
        var newItems = value;
        if (newItems) {
            newItems.forEach(function (item, i, arr) { return _this.insertTab(item, i); });
        }
        segmented_bar_common_1.selectedIndexProperty.coerce(this);
    };
    return SegmentedBar;
}(segmented_bar_common_1.SegmentedBarBase));
exports.SegmentedBar = SegmentedBar;
//# sourceMappingURL=segmented-bar.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/slider/slider-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var SliderBase = (function (_super) {
    __extends(SliderBase, _super);
    function SliderBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SliderBase = __decorate([
        view_1.CSSType("Slider")
    ], SliderBase);
    return SliderBase;
}(view_1.View));
exports.SliderBase = SliderBase;
SliderBase.prototype.recycleNativeView = "auto";
exports.valueProperty = new view_1.CoercibleProperty({
    name: "value", defaultValue: 0, coerceValue: function (target, value) {
        value = Math.max(value, target.minValue);
        value = Math.min(value, target.maxValue);
        return value;
    }, valueConverter: function (v) { return view_1.isIOS ? parseFloat(v) : parseInt(v); }
});
exports.valueProperty.register(SliderBase);
exports.minValueProperty = new view_1.Property({
    name: "minValue", defaultValue: 0, valueChanged: function (target, oldValue, newValue) {
        exports.maxValueProperty.coerce(target);
        exports.valueProperty.coerce(target);
    }, valueConverter: function (v) { return view_1.isIOS ? parseFloat(v) : parseInt(v); }
});
exports.minValueProperty.register(SliderBase);
exports.maxValueProperty = new view_1.CoercibleProperty({
    name: "maxValue", defaultValue: 100, coerceValue: function (target, value) {
        var minValue = target.minValue;
        if (value < minValue) {
            value = minValue;
        }
        return value;
    },
    valueChanged: function (target, oldValue, newValue) { return exports.valueProperty.coerce(target); },
    valueConverter: function (v) { return view_1.isIOS ? parseFloat(v) : parseInt(v); }
});
exports.maxValueProperty.register(SliderBase);
//# sourceMappingURL=slider-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/slider/slider.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var slider_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/slider/slider-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/slider/slider-common.js"));
var SeekBar;
var SeekBarChangeListener;
function initializeListenerClass() {
    if (!SeekBarChangeListener) {
        var SeekBarChangeListenerImpl = (function (_super) {
            __extends(SeekBarChangeListenerImpl, _super);
            function SeekBarChangeListenerImpl() {
                var _this = _super.call(this) || this;
                return global.__native(_this);
            }
            SeekBarChangeListenerImpl.prototype.onProgressChanged = function (seekBar, progress, fromUser) {
                var owner = seekBar.owner;
                if (owner && !owner._supressNativeValue) {
                    var newValue = progress + owner.minValue;
                    slider_common_1.valueProperty.nativeValueChange(owner, newValue);
                }
            };
            SeekBarChangeListenerImpl.prototype.onStartTrackingTouch = function (seekBar) {
            };
            SeekBarChangeListenerImpl.prototype.onStopTrackingTouch = function (seekBar) {
            };
            SeekBarChangeListenerImpl = __decorate([
                Interfaces([android.widget.SeekBar.OnSeekBarChangeListener])
            ], SeekBarChangeListenerImpl);
            return SeekBarChangeListenerImpl;
        }(java.lang.Object));
        SeekBarChangeListener = new SeekBarChangeListenerImpl();
    }
}
function getListener() {
    return SeekBarChangeListener;
}
var Slider = (function (_super) {
    __extends(Slider, _super);
    function Slider() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Slider.prototype.createNativeView = function () {
        if (!SeekBar) {
            SeekBar = android.widget.SeekBar;
        }
        return new SeekBar(this._context);
    };
    Slider.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        nativeView.owner = this;
        initializeListenerClass();
        var listener = getListener();
        nativeView.setOnSeekBarChangeListener(listener);
    };
    Slider.prototype.disposeNativeView = function () {
        this.nativeViewProtected.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Slider.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        nativeView.setMax(100);
        nativeView.setProgress(0);
        nativeView.setKeyProgressIncrement(1);
    };
    Slider.prototype.setNativeValuesSilently = function () {
        this._supressNativeValue = true;
        var nativeView = this.nativeViewProtected;
        try {
            nativeView.setMax(this.maxValue - this.minValue);
            nativeView.setProgress(this.value - this.minValue);
        }
        finally {
            this._supressNativeValue = false;
        }
    };
    Slider.prototype[slider_common_1.valueProperty.setNative] = function (value) {
        this.setNativeValuesSilently();
    };
    Slider.prototype[slider_common_1.minValueProperty.setNative] = function (value) {
        this.setNativeValuesSilently();
    };
    Slider.prototype[slider_common_1.maxValueProperty.getDefault] = function () {
        return 100;
    };
    Slider.prototype[slider_common_1.maxValueProperty.setNative] = function (value) {
        this.setNativeValuesSilently();
    };
    Slider.prototype[slider_common_1.colorProperty.getDefault] = function () {
        return -1;
    };
    Slider.prototype[slider_common_1.colorProperty.setNative] = function (value) {
        if (value instanceof slider_common_1.Color) {
            this.nativeViewProtected.getThumb().setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
        }
        else {
            this.nativeViewProtected.getThumb().clearColorFilter();
        }
    };
    Slider.prototype[slider_common_1.backgroundColorProperty.getDefault] = function () {
        return -1;
    };
    Slider.prototype[slider_common_1.backgroundColorProperty.setNative] = function (value) {
        if (value instanceof slider_common_1.Color) {
            this.nativeViewProtected.getProgressDrawable().setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
        }
        else {
            this.nativeViewProtected.getProgressDrawable().clearColorFilter();
        }
    };
    Slider.prototype[slider_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    Slider.prototype[slider_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    return Slider;
}(slider_common_1.SliderBase));
exports.Slider = Slider;
//# sourceMappingURL=slider.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/background-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var Background = (function () {
    function Background() {
        this.borderTopWidth = 0;
        this.borderRightWidth = 0;
        this.borderBottomWidth = 0;
        this.borderLeftWidth = 0;
        this.borderTopLeftRadius = 0;
        this.borderTopRightRadius = 0;
        this.borderBottomLeftRadius = 0;
        this.borderBottomRightRadius = 0;
    }
    Background.prototype.clone = function () {
        var clone = new Background();
        clone.color = this.color;
        clone.image = this.image;
        clone.repeat = this.repeat;
        clone.position = this.position;
        clone.size = this.size;
        clone.borderTopColor = this.borderTopColor;
        clone.borderRightColor = this.borderRightColor;
        clone.borderBottomColor = this.borderBottomColor;
        clone.borderLeftColor = this.borderLeftColor;
        clone.borderTopWidth = this.borderTopWidth;
        clone.borderRightWidth = this.borderRightWidth;
        clone.borderBottomWidth = this.borderBottomWidth;
        clone.borderLeftWidth = this.borderLeftWidth;
        clone.borderTopLeftRadius = this.borderTopLeftRadius;
        clone.borderTopRightRadius = this.borderTopRightRadius;
        clone.borderBottomRightRadius = this.borderBottomRightRadius;
        clone.borderBottomLeftRadius = this.borderBottomLeftRadius;
        clone.clipPath = this.clipPath;
        return clone;
    };
    Background.prototype.withColor = function (value) {
        var clone = this.clone();
        clone.color = value;
        return clone;
    };
    Background.prototype.withImage = function (value) {
        var clone = this.clone();
        clone.image = value;
        return clone;
    };
    Background.prototype.withRepeat = function (value) {
        var clone = this.clone();
        clone.repeat = value;
        return clone;
    };
    Background.prototype.withPosition = function (value) {
        var clone = this.clone();
        clone.position = value;
        return clone;
    };
    Background.prototype.withSize = function (value) {
        var clone = this.clone();
        clone.size = value;
        return clone;
    };
    Background.prototype.withBorderTopColor = function (value) {
        var clone = this.clone();
        clone.borderTopColor = value;
        return clone;
    };
    Background.prototype.withBorderRightColor = function (value) {
        var clone = this.clone();
        clone.borderRightColor = value;
        return clone;
    };
    Background.prototype.withBorderBottomColor = function (value) {
        var clone = this.clone();
        clone.borderBottomColor = value;
        return clone;
    };
    Background.prototype.withBorderLeftColor = function (value) {
        var clone = this.clone();
        clone.borderLeftColor = value;
        return clone;
    };
    Background.prototype.withBorderTopWidth = function (value) {
        var clone = this.clone();
        clone.borderTopWidth = value;
        return clone;
    };
    Background.prototype.withBorderRightWidth = function (value) {
        var clone = this.clone();
        clone.borderRightWidth = value;
        return clone;
    };
    Background.prototype.withBorderBottomWidth = function (value) {
        var clone = this.clone();
        clone.borderBottomWidth = value;
        return clone;
    };
    Background.prototype.withBorderLeftWidth = function (value) {
        var clone = this.clone();
        clone.borderLeftWidth = value;
        return clone;
    };
    Background.prototype.withBorderTopLeftRadius = function (value) {
        var clone = this.clone();
        clone.borderTopLeftRadius = value;
        return clone;
    };
    Background.prototype.withBorderTopRightRadius = function (value) {
        var clone = this.clone();
        clone.borderTopRightRadius = value;
        return clone;
    };
    Background.prototype.withBorderBottomRightRadius = function (value) {
        var clone = this.clone();
        clone.borderBottomRightRadius = value;
        return clone;
    };
    Background.prototype.withBorderBottomLeftRadius = function (value) {
        var clone = this.clone();
        clone.borderBottomLeftRadius = value;
        return clone;
    };
    Background.prototype.withClipPath = function (value) {
        var clone = this.clone();
        clone.clipPath = value;
        return clone;
    };
    Background.prototype.isEmpty = function () {
        return !this.color
            && !this.image
            && !this.hasBorderWidth()
            && !this.hasBorderRadius()
            && !this.clipPath;
    };
    Background.equals = function (value1, value2) {
        if (!value1 && !value2) {
            return true;
        }
        if (!value1 || !value2) {
            return false;
        }
        var imagesEqual = false;
        if (value1 instanceof linear_gradient_1.LinearGradient && value2 instanceof linear_gradient_1.LinearGradient) {
            imagesEqual = linear_gradient_1.LinearGradient.equals(value1, value2);
        }
        else {
            imagesEqual = value1.image === value2.image;
        }
        return color_1.Color.equals(value1.color, value2.color)
            && imagesEqual
            && value1.position === value2.position
            && value1.repeat === value2.repeat
            && value1.size === value2.size
            && color_1.Color.equals(value1.borderTopColor, value2.borderTopColor)
            && color_1.Color.equals(value1.borderRightColor, value2.borderRightColor)
            && color_1.Color.equals(value1.borderBottomColor, value2.borderBottomColor)
            && color_1.Color.equals(value1.borderLeftColor, value2.borderLeftColor)
            && value1.borderTopWidth === value2.borderTopWidth
            && value1.borderRightWidth === value2.borderRightWidth
            && value1.borderBottomWidth === value2.borderBottomWidth
            && value1.borderLeftWidth === value2.borderLeftWidth
            && value1.borderTopLeftRadius === value2.borderTopLeftRadius
            && value1.borderTopRightRadius === value2.borderTopRightRadius
            && value1.borderBottomRightRadius === value2.borderBottomRightRadius
            && value1.borderBottomLeftRadius === value2.borderBottomLeftRadius
            && value1.clipPath === value2.clipPath;
    };
    Background.prototype.hasBorderColor = function () {
        return !!this.borderTopColor || !!this.borderRightColor || !!this.borderBottomColor || !!this.borderLeftColor;
    };
    Background.prototype.hasBorderWidth = function () {
        return this.borderTopWidth > 0
            || this.borderRightWidth > 0
            || this.borderBottomWidth > 0
            || this.borderLeftWidth > 0;
    };
    Background.prototype.hasBorderRadius = function () {
        return this.borderTopLeftRadius > 0
            || this.borderTopRightRadius > 0
            || this.borderBottomRightRadius > 0
            || this.borderBottomLeftRadius > 0;
    };
    Background.prototype.hasUniformBorderColor = function () {
        return color_1.Color.equals(this.borderTopColor, this.borderRightColor)
            && color_1.Color.equals(this.borderTopColor, this.borderBottomColor)
            && color_1.Color.equals(this.borderTopColor, this.borderLeftColor);
    };
    Background.prototype.hasUniformBorderWidth = function () {
        return this.borderTopWidth === this.borderRightWidth
            && this.borderTopWidth === this.borderBottomWidth
            && this.borderTopWidth === this.borderLeftWidth;
    };
    Background.prototype.hasUniformBorderRadius = function () {
        return this.borderTopLeftRadius === this.borderTopRightRadius
            && this.borderTopLeftRadius === this.borderBottomRightRadius
            && this.borderTopLeftRadius === this.borderBottomLeftRadius;
    };
    Background.prototype.hasUniformBorder = function () {
        return this.hasUniformBorderColor()
            && this.hasUniformBorderWidth()
            && this.hasUniformBorderRadius();
    };
    Background.prototype.getUniformBorderColor = function () {
        if (this.hasUniformBorderColor()) {
            return this.borderTopColor;
        }
        return undefined;
    };
    Background.prototype.getUniformBorderWidth = function () {
        if (this.hasUniformBorderWidth()) {
            return this.borderTopWidth;
        }
        return 0;
    };
    Background.prototype.getUniformBorderRadius = function () {
        if (this.hasUniformBorderRadius()) {
            return this.borderTopLeftRadius;
        }
        return 0;
    };
    Background.prototype.toString = function () {
        return "isEmpty: " + this.isEmpty() + "; color: " + this.color + "; image: " + this.image + "; repeat: " + this.repeat + "; position: " + this.position + "; size: " + this.size + "; borderTopColor: " + this.borderTopColor + "; borderRightColor: " + this.borderRightColor + "; borderBottomColor: " + this.borderBottomColor + "; borderLeftColor: " + this.borderLeftColor + "; borderTopWidth: " + this.borderTopWidth + "; borderRightWidth: " + this.borderRightWidth + "; borderBottomWidth: " + this.borderBottomWidth + "; borderLeftWidth: " + this.borderLeftWidth + "; borderTopLeftRadius: " + this.borderTopLeftRadius + "; borderTopRightRadius: " + this.borderTopRightRadius + "; borderBottomRightRadius: " + this.borderBottomRightRadius + "; borderBottomLeftRadius: " + this.borderBottomLeftRadius + "; clipPath: " + this.clipPath + ";";
    };
    Background.default = new Background();
    return Background;
}());
exports.Background = Background;
//# sourceMappingURL=background-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/background.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var css_value_1 = __webpack_require__("../node_modules/tns-core-modules/css-value/index.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/styling/background-common.js"));
var ad;
(function (ad) {
    var SDK;
    function getSDK() {
        if (!SDK) {
            SDK = android.os.Build.VERSION.SDK_INT;
        }
        return SDK;
    }
    function isSetColorFilterOnlyWidget(nativeView) {
        return (nativeView instanceof android.widget.Button ||
            (nativeView instanceof androidx.appcompat.widget.Toolbar
                && getSDK() >= 21));
    }
    function onBackgroundOrBorderPropertyChanged(view) {
        var nativeView = view.nativeViewProtected;
        if (!nativeView) {
            return;
        }
        var background = view.style.backgroundInternal;
        var drawable = nativeView.getBackground();
        var androidView = view;
        if (androidView._cachedDrawable === undefined && drawable) {
            var constantState = drawable.getConstantState();
            androidView._cachedDrawable = constantState || drawable;
        }
        if (isSetColorFilterOnlyWidget(nativeView)
            && drawable
            && !(drawable instanceof org.nativescript.widgets.BorderDrawable)
            && !background.hasBorderWidth()
            && !background.hasBorderRadius()
            && !background.clipPath
            && !background.image
            && background.color) {
            var backgroundColor = drawable.backgroundColor = background.color.android;
            drawable.mutate();
            drawable.setColorFilter(backgroundColor, android.graphics.PorterDuff.Mode.SRC_IN);
            drawable.invalidateSelf();
            drawable.backgroundColor = backgroundColor;
        }
        else if (!background.isEmpty()) {
            var backgroundDrawable = drawable;
            if (!(drawable instanceof org.nativescript.widgets.BorderDrawable)) {
                backgroundDrawable = new org.nativescript.widgets.BorderDrawable(utils_1.layout.getDisplayDensity(), view.toString());
                refreshBorderDrawable(view, backgroundDrawable);
                nativeView.setBackground(backgroundDrawable);
            }
            else {
                refreshBorderDrawable(view, backgroundDrawable);
            }
        }
        else {
            var cachedDrawable = androidView._cachedDrawable;
            var defaultDrawable = void 0;
            if (cachedDrawable instanceof android.graphics.drawable.Drawable.ConstantState) {
                defaultDrawable = cachedDrawable.newDrawable(nativeView.getResources());
            }
            else if (cachedDrawable instanceof android.graphics.drawable.Drawable) {
                defaultDrawable = cachedDrawable;
            }
            else {
                defaultDrawable = null;
            }
            nativeView.setBackground(defaultDrawable);
            androidView._cachedDrawable = undefined;
        }
        var leftPadding = Math.ceil(view.effectiveBorderLeftWidth + view.effectivePaddingLeft);
        var topPadding = Math.ceil(view.effectiveBorderTopWidth + view.effectivePaddingTop);
        var rightPadding = Math.ceil(view.effectiveBorderRightWidth + view.effectivePaddingRight);
        var bottomPadding = Math.ceil(view.effectiveBorderBottomWidth + view.effectivePaddingBottom);
        nativeView.setPadding(leftPadding, topPadding, rightPadding, bottomPadding);
    }
    ad.onBackgroundOrBorderPropertyChanged = onBackgroundOrBorderPropertyChanged;
})(ad = exports.ad || (exports.ad = {}));
function fromBase64(source) {
    var bytes = android.util.Base64.decode(source, android.util.Base64.DEFAULT);
    return android.graphics.BitmapFactory.decodeByteArray(bytes, 0, bytes.length);
}
function fromGradient(gradient) {
    var colors = Array.create("int", gradient.colorStops.length);
    var stops = Array.create("float", gradient.colorStops.length);
    var hasStops = false;
    gradient.colorStops.forEach(function (stop, index) {
        colors[index] = stop.color.android;
        if (stop.offset) {
            stops[index] = stop.offset.value;
            hasStops = true;
        }
    });
    var alpha = gradient.angle / (Math.PI * 2);
    var startX = Math.pow(Math.sin(Math.PI * (alpha + 0.75)), 2);
    var startY = Math.pow(Math.sin(Math.PI * (alpha + 0.5)), 2);
    var endX = Math.pow(Math.sin(Math.PI * (alpha + 0.25)), 2);
    var endY = Math.pow(Math.sin(Math.PI * alpha), 2);
    return new org.nativescript.widgets.LinearGradientDefinition(startX, startY, endX, endY, colors, hasStops ? stops : null);
}
var pattern = /url\(('|")(.*?)\1\)/;
function refreshBorderDrawable(view, borderDrawable) {
    var nativeView = view.nativeViewProtected;
    var context = nativeView.getContext();
    var background = view.style.backgroundInternal;
    if (background) {
        var backgroundPositionParsedCSSValues = createNativeCSSValueArray(background.position);
        var backgroundSizeParsedCSSValues = createNativeCSSValueArray(background.size);
        var blackColor = -16777216;
        var imageUri = void 0;
        if (background.image && typeof background.image === "string") {
            imageUri = background.image;
            var match = imageUri.match(pattern);
            if (match && match[2]) {
                imageUri = match[2];
            }
        }
        var bitmap = null;
        if (utils_1.isDataURI(imageUri)) {
            var base64Data = imageUri.split(",")[1];
            if (base64Data !== undefined) {
                bitmap = fromBase64(base64Data);
                imageUri = null;
            }
        }
        else if (utils_1.isFileOrResourcePath(imageUri)) {
            if (imageUri.indexOf(utils_1.RESOURCE_PREFIX) !== 0) {
                var fileName = imageUri;
                if (fileName.indexOf("~/") === 0) {
                    fileName = file_system_1.path.join(file_system_1.knownFolders.currentApp().path, fileName.replace("~/", ""));
                }
                imageUri = utils_1.FILE_PREFIX + fileName;
            }
        }
        var gradient = null;
        if (background.image && background.image instanceof linear_gradient_1.LinearGradient) {
            gradient = fromGradient(background.image);
        }
        borderDrawable.refresh(background.borderTopColor ? background.borderTopColor.android : blackColor, background.borderRightColor ? background.borderRightColor.android : blackColor, background.borderBottomColor ? background.borderBottomColor.android : blackColor, background.borderLeftColor ? background.borderLeftColor.android : blackColor, background.borderTopWidth, background.borderRightWidth, background.borderBottomWidth, background.borderLeftWidth, background.borderTopLeftRadius, background.borderTopRightRadius, background.borderBottomRightRadius, background.borderBottomLeftRadius, background.clipPath, background.color ? background.color.android : 0, imageUri, bitmap, gradient, context, background.repeat, background.position, backgroundPositionParsedCSSValues, background.size, backgroundSizeParsedCSSValues);
    }
}
function createNativeCSSValueArray(css) {
    if (!css) {
        return null;
    }
    var cssValues = css_value_1.parse(css);
    var nativeArray = Array.create(org.nativescript.widgets.CSSValue, cssValues.length);
    for (var i = 0, length_1 = cssValues.length; i < length_1; i++) {
        nativeArray[i] = new org.nativescript.widgets.CSSValue(cssValues[i].type, cssValues[i].string, cssValues[i].unit, cssValues[i].value);
    }
    return nativeArray;
}
var CacheMode;
(function (CacheMode) {
    CacheMode[CacheMode["none"] = 0] = "none";
    CacheMode[CacheMode["memory"] = 1] = "memory";
    CacheMode[CacheMode["diskAndMemory"] = 2] = "diskAndMemory";
})(CacheMode = exports.CacheMode || (exports.CacheMode = {}));
var currentCacheMode;
var imageFetcher;
function initImageCache(context, mode, memoryCacheSize, diskCacheSize) {
    if (mode === void 0) { mode = CacheMode.diskAndMemory; }
    if (memoryCacheSize === void 0) { memoryCacheSize = 0.25; }
    if (diskCacheSize === void 0) { diskCacheSize = 10 * 1024 * 1024; }
    if (currentCacheMode === mode) {
        return;
    }
    currentCacheMode = mode;
    if (!imageFetcher) {
        imageFetcher = org.nativescript.widgets.image.Fetcher.getInstance(context);
    }
    else {
        imageFetcher.clearCache();
    }
    var params = new org.nativescript.widgets.image.Cache.CacheParams();
    params.memoryCacheEnabled = mode !== CacheMode.none;
    params.setMemCacheSizePercent(memoryCacheSize);
    params.diskCacheEnabled = mode === CacheMode.diskAndMemory;
    params.diskCacheSize = diskCacheSize;
    var imageCache = org.nativescript.widgets.image.Cache.getInstance(params);
    imageFetcher.addImageCache(imageCache);
    imageFetcher.initCache();
}
exports.initImageCache = initImageCache;
function onLivesync(args) {
    if (imageFetcher) {
        imageFetcher.clearCache();
    }
}
application.on("livesync", onLivesync);
application.android.on("activityStarted", profiling_1.profile("initImageCache", function (args) {
    if (!imageFetcher) {
        initImageCache(args.activity);
    }
    else {
        imageFetcher.initCache();
    }
}));
application.android.on("activityStopped", profiling_1.profile("closeImageCache", function (args) {
    if (imageFetcher) {
        imageFetcher.closeCache();
    }
}));
//# sourceMappingURL=background.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/converters.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var enums_1 = __webpack_require__("../node_modules/tns-core-modules/ui/enums/enums.js");
var STYLE_CURVE_MAP = Object.freeze({
    "ease": enums_1.AnimationCurve.ease,
    "linear": enums_1.AnimationCurve.linear,
    "ease-in": enums_1.AnimationCurve.easeIn,
    "ease-out": enums_1.AnimationCurve.easeOut,
    "ease-in-out": enums_1.AnimationCurve.easeInOut,
    "spring": enums_1.AnimationCurve.spring,
});
function timeConverter(value) {
    var result = parseFloat(value);
    if (value.indexOf("ms") === -1) {
        result = result * 1000;
    }
    return Math.max(0.0, result);
}
exports.timeConverter = timeConverter;
function animationTimingFunctionConverter(value) {
    return value ?
        STYLE_CURVE_MAP[value] || parseCubicBezierCurve(value) :
        enums_1.AnimationCurve.ease;
}
exports.animationTimingFunctionConverter = animationTimingFunctionConverter;
function parseCubicBezierCurve(value) {
    var coordsString = /\((.*?)\)/.exec(value);
    var coords = coordsString && coordsString[1]
        .split(",")
        .map(stringToBezieCoords);
    if (value.startsWith("cubic-bezier") &&
        coordsString &&
        coords.length === 4) {
        var _a = __spreadArrays(coords), x1 = _a[0], x2 = _a[1], y1_1 = _a[2], y2 = _a[3];
        return enums_1.AnimationCurve.cubicBezier(x1, x2, y1_1, y2);
    }
    else {
        throw new Error("Invalid value for animation: " + value);
    }
}
function stringToBezieCoords(value) {
    var result = parseFloat(value);
    if (result < 0) {
        return 0;
    }
    else if (result > 1) {
        return 1;
    }
    return result;
}
//# sourceMappingURL=converters.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/css-animation-parser.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var keyframe_animation_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/keyframe-animation.js");
var converters_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/converters.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var ANIMATION_PROPERTY_HANDLERS = Object.freeze({
    "animation-name": function (info, value) { return info.name = value; },
    "animation-duration": function (info, value) { return info.duration = converters_1.timeConverter(value); },
    "animation-delay": function (info, value) { return info.delay = converters_1.timeConverter(value); },
    "animation-timing-function": function (info, value) { return info.curve = converters_1.animationTimingFunctionConverter(value); },
    "animation-iteration-count": function (info, value) { return info.iterations = value === "infinite" ? Number.MAX_VALUE : parseFloat(value); },
    "animation-direction": function (info, value) { return info.isReverse = value === "reverse"; },
    "animation-fill-mode": function (info, value) { return info.isForwards = value === "forwards"; }
});
var CssAnimationParser = (function () {
    function CssAnimationParser() {
    }
    CssAnimationParser.keyframeAnimationsFromCSSDeclarations = function (declarations) {
        if (declarations === null || declarations === undefined) {
            return undefined;
        }
        var animations = new Array();
        var animationInfo = undefined;
        declarations.forEach(function (_a) {
            var property = _a.property, value = _a.value;
            if (property === "animation") {
                keyframeAnimationsFromCSSProperty(value, animations);
            }
            else {
                var propertyHandler = ANIMATION_PROPERTY_HANDLERS[property];
                if (propertyHandler) {
                    if (animationInfo === undefined) {
                        animationInfo = new keyframe_animation_1.KeyframeAnimationInfo();
                        animations.push(animationInfo);
                    }
                    propertyHandler(animationInfo, value);
                }
            }
        });
        return animations.length === 0 ? undefined : animations;
    };
    CssAnimationParser.keyframesArrayFromCSS = function (keyframes) {
        var parsedKeyframes = new Array();
        for (var _i = 0, keyframes_1 = keyframes; _i < keyframes_1.length; _i++) {
            var keyframe = keyframes_1[_i];
            var declarations = parseKeyframeDeclarations(keyframe.declarations);
            for (var _a = 0, _b = keyframe.values; _a < _b.length; _a++) {
                var time_1 = _b[_a];
                if (time_1 === "from") {
                    time_1 = 0;
                }
                else if (time_1 === "to") {
                    time_1 = 1;
                }
                else {
                    time_1 = parseFloat(time_1) / 100;
                    if (time_1 < 0) {
                        time_1 = 0;
                    }
                    if (time_1 > 100) {
                        time_1 = 100;
                    }
                }
                var current = parsedKeyframes[time_1];
                if (current === undefined) {
                    current = {};
                    current.duration = time_1;
                    parsedKeyframes[time_1] = current;
                }
                for (var _c = 0, _d = keyframe.declarations; _c < _d.length; _c++) {
                    var declaration = _d[_c];
                    if (declaration.property === "animation-timing-function") {
                        current.curve = converters_1.animationTimingFunctionConverter(declaration.value);
                    }
                }
                current.declarations = declarations;
            }
        }
        var array = new Array();
        for (var parsedKeyframe in parsedKeyframes) {
            array.push(parsedKeyframes[parsedKeyframe]);
        }
        array.sort(function (a, b) { return a.duration - b.duration; });
        return array;
    };
    return CssAnimationParser;
}());
exports.CssAnimationParser = CssAnimationParser;
function keyframeAnimationsFromCSSProperty(value, animations) {
    if (typeof value === "string") {
        var values = value.split(/[,]+/);
        for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {
            var parsedValue = values_1[_i];
            var animationInfo = new keyframe_animation_1.KeyframeAnimationInfo();
            var arr = parsedValue.trim().split(/[ ]+/);
            if (arr.length > 0) {
                animationInfo.name = arr[0];
            }
            if (arr.length > 1) {
                animationInfo.duration = converters_1.timeConverter(arr[1]);
            }
            if (arr.length > 2) {
                animationInfo.curve = converters_1.animationTimingFunctionConverter(arr[2]);
            }
            if (arr.length > 3) {
                animationInfo.delay = converters_1.timeConverter(arr[3]);
            }
            if (arr.length > 4) {
                animationInfo.iterations = parseInt(arr[4]);
            }
            if (arr.length > 5) {
                animationInfo.isReverse = arr[4] === "reverse";
            }
            if (arr.length > 6) {
                animationInfo.isForwards = arr[5] === "forwards";
            }
            if (arr.length > 7) {
                throw new Error("Invalid value for animation: " + value);
            }
            animations.push(animationInfo);
        }
    }
}
function parseKeyframeDeclarations(unparsedKeyframeDeclarations) {
    var declarations = unparsedKeyframeDeclarations
        .reduce(function (declarations, _a) {
        var unparsedProperty = _a.property, unparsedValue = _a.value;
        var property = properties_1.CssAnimationProperty._getByCssName(unparsedProperty);
        if (typeof unparsedProperty === "string" && property && property._valueConverter) {
            declarations[property.name] = property._valueConverter(unparsedValue);
        }
        else if (typeof unparsedValue === "string" && unparsedProperty === "transform") {
            var transformations = style_properties_1.transformConverter(unparsedValue);
            Object.assign(declarations, transformations);
        }
        return declarations;
    }, {});
    return Object.keys(declarations).map(function (property) { return ({ property: property, value: declarations[property] }); });
}
exports.parseKeyframeDeclarations = parseKeyframeDeclarations;
//# sourceMappingURL=css-animation-parser.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/css-selector/css-selector.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var utils_common_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils-common.js");
var parser = __webpack_require__("../node_modules/tns-core-modules/css/parser.js");
var Match;
(function (Match) {
    Match.Dynamic = true;
    Match.Static = false;
})(Match || (Match = {}));
function getNodeDirectSibling(node) {
    if (!node.parent || !node.parent.getChildIndex || !node.parent.getChildAt) {
        return null;
    }
    var nodeIndex = node.parent.getChildIndex(node);
    if (nodeIndex === 0) {
        return null;
    }
    return node.parent.getChildAt(nodeIndex - 1);
}
function SelectorProperties(specificity, rarity, dynamic) {
    if (dynamic === void 0) { dynamic = false; }
    return function (cls) {
        cls.prototype.specificity = specificity;
        cls.prototype.rarity = rarity;
        cls.prototype.combinator = undefined;
        cls.prototype.dynamic = dynamic;
        return cls;
    };
}
var SelectorCore = (function () {
    function SelectorCore() {
    }
    SelectorCore.prototype.lookupSort = function (sorter, base) { sorter.sortAsUniversal(base || this); };
    SelectorCore = __decorate([
        SelectorProperties(0, 0, Match.Static)
    ], SelectorCore);
    return SelectorCore;
}());
exports.SelectorCore = SelectorCore;
var SimpleSelector = (function (_super) {
    __extends(SimpleSelector, _super);
    function SimpleSelector() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SimpleSelector.prototype.accumulateChanges = function (node, map) {
        if (!this.dynamic) {
            return this.match(node);
        }
        else if (this.mayMatch(node)) {
            this.trackChanges(node, map);
            return true;
        }
        return false;
    };
    SimpleSelector.prototype.mayMatch = function (node) { return this.match(node); };
    SimpleSelector.prototype.trackChanges = function (node, map) {
    };
    return SimpleSelector;
}(SelectorCore));
exports.SimpleSelector = SimpleSelector;
function wrap(text) {
    return text ? " " + text + " " : "";
}
var InvalidSelector = (function (_super) {
    __extends(InvalidSelector, _super);
    function InvalidSelector(e) {
        var _this = _super.call(this) || this;
        _this.e = e;
        return _this;
    }
    InvalidSelector.prototype.toString = function () { return "<error: " + this.e + ">"; };
    InvalidSelector.prototype.match = function (node) { return false; };
    InvalidSelector.prototype.lookupSort = function (sorter, base) {
    };
    InvalidSelector = __decorate([
        SelectorProperties(0, 4, Match.Static)
    ], InvalidSelector);
    return InvalidSelector;
}(SimpleSelector));
exports.InvalidSelector = InvalidSelector;
var UniversalSelector = (function (_super) {
    __extends(UniversalSelector, _super);
    function UniversalSelector() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UniversalSelector.prototype.toString = function () { return "*" + wrap(this.combinator); };
    UniversalSelector.prototype.match = function (node) { return true; };
    UniversalSelector = __decorate([
        SelectorProperties(0, 0, Match.Static)
    ], UniversalSelector);
    return UniversalSelector;
}(SimpleSelector));
exports.UniversalSelector = UniversalSelector;
var IdSelector = (function (_super) {
    __extends(IdSelector, _super);
    function IdSelector(id) {
        var _this = _super.call(this) || this;
        _this.id = id;
        return _this;
    }
    IdSelector.prototype.toString = function () { return "#" + this.id + wrap(this.combinator); };
    IdSelector.prototype.match = function (node) { return node.id === this.id; };
    IdSelector.prototype.lookupSort = function (sorter, base) { sorter.sortById(this.id, base || this); };
    IdSelector = __decorate([
        SelectorProperties(65536, 3, Match.Static)
    ], IdSelector);
    return IdSelector;
}(SimpleSelector));
exports.IdSelector = IdSelector;
var TypeSelector = (function (_super) {
    __extends(TypeSelector, _super);
    function TypeSelector(cssType) {
        var _this = _super.call(this) || this;
        _this.cssType = cssType;
        return _this;
    }
    TypeSelector.prototype.toString = function () { return "" + this.cssType + wrap(this.combinator); };
    TypeSelector.prototype.match = function (node) { return node.cssType === this.cssType; };
    TypeSelector.prototype.lookupSort = function (sorter, base) { sorter.sortByType(this.cssType, base || this); };
    TypeSelector = __decorate([
        SelectorProperties(1, 1, Match.Static)
    ], TypeSelector);
    return TypeSelector;
}(SimpleSelector));
exports.TypeSelector = TypeSelector;
var ClassSelector = (function (_super) {
    __extends(ClassSelector, _super);
    function ClassSelector(cssClass) {
        var _this = _super.call(this) || this;
        _this.cssClass = cssClass;
        return _this;
    }
    ClassSelector.prototype.toString = function () { return "." + this.cssClass + wrap(this.combinator); };
    ClassSelector.prototype.match = function (node) { return node.cssClasses && node.cssClasses.has(this.cssClass); };
    ClassSelector.prototype.lookupSort = function (sorter, base) { sorter.sortByClass(this.cssClass, base || this); };
    ClassSelector = __decorate([
        SelectorProperties(256, 2, Match.Static)
    ], ClassSelector);
    return ClassSelector;
}(SimpleSelector));
exports.ClassSelector = ClassSelector;
var AttributeSelector = (function (_super) {
    __extends(AttributeSelector, _super);
    function AttributeSelector(attribute, test, value) {
        var _this = _super.call(this) || this;
        _this.attribute = attribute;
        _this.test = test;
        _this.value = value;
        if (!test) {
            _this.match = function (node) { return !types_1.isNullOrUndefined(node[attribute]); };
            return _this;
        }
        if (!value) {
            _this.match = function (node) { return false; };
        }
        var escapedValue = utils_common_1.escapeRegexSymbols(value);
        var regexp = null;
        switch (test) {
            case "^=":
                regexp = new RegExp("^" + escapedValue);
                break;
            case "$=":
                regexp = new RegExp(escapedValue + "$");
                break;
            case "*=":
                regexp = new RegExp(escapedValue);
                break;
            case "=":
                regexp = new RegExp("^" + escapedValue + "$");
                break;
            case "~=":
                if (/\s/.test(value)) {
                    _this.match = function (node) { return false; };
                    return _this;
                }
                regexp = new RegExp("(^|\\s)" + escapedValue + "(\\s|$)");
                break;
            case "|=":
                regexp = new RegExp("^" + escapedValue + "(-|$)");
                break;
        }
        if (regexp) {
            _this.match = function (node) { return regexp.test(node[attribute] + ""); };
            return _this;
        }
        else {
            _this.match = function (node) { return false; };
            return _this;
        }
    }
    AttributeSelector.prototype.toString = function () { return "[" + this.attribute + wrap(this.test) + ((this.test && this.value) || "") + "]" + wrap(this.combinator); };
    AttributeSelector.prototype.match = function (node) { return false; };
    AttributeSelector.prototype.mayMatch = function (node) { return true; };
    AttributeSelector.prototype.trackChanges = function (node, map) { map.addAttribute(node, this.attribute); };
    AttributeSelector = __decorate([
        SelectorProperties(256, 0, Match.Dynamic)
    ], AttributeSelector);
    return AttributeSelector;
}(SimpleSelector));
exports.AttributeSelector = AttributeSelector;
var PseudoClassSelector = (function (_super) {
    __extends(PseudoClassSelector, _super);
    function PseudoClassSelector(cssPseudoClass) {
        var _this = _super.call(this) || this;
        _this.cssPseudoClass = cssPseudoClass;
        return _this;
    }
    PseudoClassSelector.prototype.toString = function () { return ":" + this.cssPseudoClass + wrap(this.combinator); };
    PseudoClassSelector.prototype.match = function (node) { return node.cssPseudoClasses && node.cssPseudoClasses.has(this.cssPseudoClass); };
    PseudoClassSelector.prototype.mayMatch = function (node) { return true; };
    PseudoClassSelector.prototype.trackChanges = function (node, map) { map.addPseudoClass(node, this.cssPseudoClass); };
    PseudoClassSelector = __decorate([
        SelectorProperties(256, 0, Match.Dynamic)
    ], PseudoClassSelector);
    return PseudoClassSelector;
}(SimpleSelector));
exports.PseudoClassSelector = PseudoClassSelector;
var SimpleSelectorSequence = (function (_super) {
    __extends(SimpleSelectorSequence, _super);
    function SimpleSelectorSequence(selectors) {
        var _this = _super.call(this) || this;
        _this.selectors = selectors;
        _this.specificity = selectors.reduce(function (sum, sel) { return sel.specificity + sum; }, 0);
        _this.head = _this.selectors.reduce(function (prev, curr) { return !prev || (curr.rarity > prev.rarity) ? curr : prev; }, null);
        _this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        return _this;
    }
    SimpleSelectorSequence.prototype.toString = function () { return "" + this.selectors.join("") + wrap(this.combinator); };
    SimpleSelectorSequence.prototype.match = function (node) { return this.selectors.every(function (sel) { return sel.match(node); }); };
    SimpleSelectorSequence.prototype.mayMatch = function (node) {
        return this.selectors.every(function (sel) { return sel.mayMatch(node); });
    };
    SimpleSelectorSequence.prototype.trackChanges = function (node, map) {
        this.selectors.forEach(function (sel) { return sel.trackChanges(node, map); });
    };
    SimpleSelectorSequence.prototype.lookupSort = function (sorter, base) {
        this.head.lookupSort(sorter, base || this);
    };
    return SimpleSelectorSequence;
}(SimpleSelector));
exports.SimpleSelectorSequence = SimpleSelectorSequence;
var Selector = (function (_super) {
    __extends(Selector, _super);
    function Selector(selectors) {
        var _this = _super.call(this) || this;
        _this.selectors = selectors;
        var supportedCombinator = [undefined, " ", ">", "+"];
        var siblingGroup;
        var lastGroup;
        var groups = [];
        selectors.reverse().forEach(function (sel) {
            if (supportedCombinator.indexOf(sel.combinator) === -1) {
                throw new Error("Unsupported combinator \"" + sel.combinator + "\".");
            }
            if (sel.combinator === undefined || sel.combinator === " ") {
                groups.push(lastGroup = [siblingGroup = []]);
            }
            if (sel.combinator === ">") {
                lastGroup.push(siblingGroup = []);
            }
            siblingGroup.push(sel);
        });
        _this.groups = groups.map(function (g) {
            return new Selector.ChildGroup(g.map(function (sg) {
                return new Selector.SiblingGroup(sg);
            }));
        });
        _this.last = selectors[0];
        _this.specificity = selectors.reduce(function (sum, sel) { return sel.specificity + sum; }, 0);
        _this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        return _this;
    }
    Selector.prototype.toString = function () { return this.selectors.join(""); };
    Selector.prototype.match = function (node) {
        return this.groups.every(function (group, i) {
            if (i === 0) {
                node = group.match(node);
                return !!node;
            }
            else {
                var ancestor = node;
                while (ancestor = ancestor.parent) {
                    if (node = group.match(ancestor)) {
                        return true;
                    }
                }
                return false;
            }
        });
    };
    Selector.prototype.lookupSort = function (sorter, base) {
        this.last.lookupSort(sorter, this);
    };
    Selector.prototype.accumulateChanges = function (node, map) {
        if (!this.dynamic) {
            return this.match(node);
        }
        var bounds = [];
        var mayMatch = this.groups.every(function (group, i) {
            if (i === 0) {
                var nextNode = group.mayMatch(node);
                bounds.push({ left: node, right: node });
                node = nextNode;
                return !!node;
            }
            else {
                var ancestor = node;
                while (ancestor = ancestor.parent) {
                    var nextNode = group.mayMatch(ancestor);
                    if (nextNode) {
                        bounds.push({ left: ancestor, right: null });
                        node = nextNode;
                        return true;
                    }
                }
                return false;
            }
        });
        if (!mayMatch) {
            return false;
        }
        if (!map) {
            return mayMatch;
        }
        for (var i = 0; i < this.groups.length; i++) {
            var group_1 = this.groups[i];
            if (!group_1.dynamic) {
                continue;
            }
            var bound = bounds[i];
            var node_1 = bound.left;
            do {
                if (group_1.mayMatch(node_1)) {
                    group_1.trackChanges(node_1, map);
                }
            } while ((node_1 !== bound.right) && (node_1 = node_1.parent));
        }
        return mayMatch;
    };
    return Selector;
}(SelectorCore));
exports.Selector = Selector;
(function (Selector) {
    var ChildGroup = (function () {
        function ChildGroup(selectors) {
            this.selectors = selectors;
            this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        }
        ChildGroup.prototype.match = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = node.parent) && !!sel.match(node); }) ? node : null;
        };
        ChildGroup.prototype.mayMatch = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = node.parent) && !!sel.mayMatch(node); }) ? node : null;
        };
        ChildGroup.prototype.trackChanges = function (node, map) {
            this.selectors.forEach(function (sel, i) { return (i === 0 ? node : node = node.parent) && sel.trackChanges(node, map); });
        };
        return ChildGroup;
    }());
    Selector.ChildGroup = ChildGroup;
    var SiblingGroup = (function () {
        function SiblingGroup(selectors) {
            this.selectors = selectors;
            this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        }
        SiblingGroup.prototype.match = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = getNodeDirectSibling(node)) && sel.match(node); }) ? node : null;
        };
        SiblingGroup.prototype.mayMatch = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = getNodeDirectSibling(node)) && sel.mayMatch(node); }) ? node : null;
        };
        SiblingGroup.prototype.trackChanges = function (node, map) {
            this.selectors.forEach(function (sel, i) { return (i === 0 ? node : node = getNodeDirectSibling(node)) && sel.trackChanges(node, map); });
        };
        return SiblingGroup;
    }());
    Selector.SiblingGroup = SiblingGroup;
})(Selector = exports.Selector || (exports.Selector = {}));
exports.Selector = Selector;
var RuleSet = (function () {
    function RuleSet(selectors, declarations) {
        var _this = this;
        this.selectors = selectors;
        this.declarations = declarations;
        this.selectors.forEach(function (sel) { return sel.ruleset = _this; });
    }
    RuleSet.prototype.toString = function () { return this.selectors.join(", ") + " {" + this.declarations.map(function (d, i) { return "" + (i === 0 ? " " : "") + d.property + ": " + d.value; }).join("; ") + " }"; };
    RuleSet.prototype.lookupSort = function (sorter) { this.selectors.forEach(function (sel) { return sel.lookupSort(sorter); }); };
    return RuleSet;
}());
exports.RuleSet = RuleSet;
function fromAstNodes(astRules) {
    return astRules.filter(isRule).map(function (rule) {
        var declarations = rule.declarations.filter(isDeclaration).map(createDeclaration);
        var selectors = rule.selectors.map(createSelector);
        var ruleset = new RuleSet(selectors, declarations);
        return ruleset;
    });
}
exports.fromAstNodes = fromAstNodes;
function createDeclaration(decl) {
    return { property: decl.property.toLowerCase(), value: decl.value };
}
function createSimpleSelectorFromAst(ast) {
    switch (ast.type) {
        case "*": return new UniversalSelector();
        case "#": return new IdSelector(ast.identifier);
        case "": return new TypeSelector(ast.identifier.replace(/-/, "").toLowerCase());
        case ".": return new ClassSelector(ast.identifier);
        case ":": return new PseudoClassSelector(ast.identifier);
        case "[]": return ast.test ? new AttributeSelector(ast.property, ast.test, ast.value) : new AttributeSelector(ast.property);
    }
}
function createSimpleSelectorSequenceFromAst(ast) {
    if (ast.length === 0) {
        return new InvalidSelector(new Error("Empty simple selector sequence."));
    }
    else if (ast.length === 1) {
        return createSimpleSelectorFromAst(ast[0]);
    }
    else {
        return new SimpleSelectorSequence(ast.map(createSimpleSelectorFromAst));
    }
}
function createSelectorFromAst(ast) {
    if (ast.length === 0) {
        return new InvalidSelector(new Error("Empty selector."));
    }
    else if (ast.length === 1) {
        return createSimpleSelectorSequenceFromAst(ast[0][0]);
    }
    else {
        var simpleSelectorSequences = [];
        var simpleSelectorSequence = void 0;
        var combinator = void 0;
        for (var i = 0; i < ast.length; i++) {
            simpleSelectorSequence = createSimpleSelectorSequenceFromAst(ast[i][0]);
            combinator = ast[i][1];
            if (combinator) {
                simpleSelectorSequence.combinator = combinator;
            }
            simpleSelectorSequences.push(simpleSelectorSequence);
        }
        return new Selector(simpleSelectorSequences);
    }
}
function createSelector(sel) {
    try {
        var parsedSelector = parser.parseSelector(sel);
        if (!parsedSelector) {
            return new InvalidSelector(new Error("Empty selector"));
        }
        return createSelectorFromAst(parsedSelector.value);
    }
    catch (e) {
        return new InvalidSelector(e);
    }
}
exports.createSelector = createSelector;
function isRule(node) {
    return node.type === "rule";
}
function isDeclaration(node) {
    return node.type === "declaration";
}
var SelectorsMap = (function () {
    function SelectorsMap(rulesets) {
        var _this = this;
        this.id = {};
        this.class = {};
        this.type = {};
        this.universal = [];
        this.position = 0;
        rulesets.forEach(function (rule) { return rule.lookupSort(_this); });
    }
    SelectorsMap.prototype.query = function (node) {
        var _this = this;
        var selectorClasses = [
            this.universal,
            this.id[node.id],
            this.type[node.cssType]
        ];
        if (node.cssClasses) {
            node.cssClasses.forEach(function (c) { return selectorClasses.push(_this.class[c]); });
        }
        var selectors = selectorClasses
            .filter(function (arr) { return !!arr; })
            .reduce(function (cur, next) { return cur.concat(next); }, []);
        var selectorsMatch = new SelectorsMatch();
        selectorsMatch.selectors = selectors
            .filter(function (sel) { return sel.sel.accumulateChanges(node, selectorsMatch); })
            .sort(function (a, b) { return a.sel.specificity - b.sel.specificity || a.pos - b.pos; })
            .map(function (docSel) { return docSel.sel; });
        return selectorsMatch;
    };
    SelectorsMap.prototype.sortById = function (id, sel) { this.addToMap(this.id, id, sel); };
    SelectorsMap.prototype.sortByClass = function (cssClass, sel) {
        this.addToMap(this.class, cssClass, sel);
    };
    SelectorsMap.prototype.sortByType = function (cssType, sel) {
        this.addToMap(this.type, cssType, sel);
    };
    SelectorsMap.prototype.sortAsUniversal = function (sel) { this.universal.push(this.makeDocSelector(sel)); };
    SelectorsMap.prototype.addToMap = function (map, head, sel) {
        this.position++;
        var list = map[head];
        if (list) {
            list.push(this.makeDocSelector(sel));
        }
        else {
            map[head] = [this.makeDocSelector(sel)];
        }
    };
    SelectorsMap.prototype.makeDocSelector = function (sel) {
        return { sel: sel, pos: this.position++ };
    };
    return SelectorsMap;
}());
exports.SelectorsMap = SelectorsMap;
var SelectorsMatch = (function () {
    function SelectorsMatch() {
        this.changeMap = new Map();
    }
    SelectorsMatch.prototype.addAttribute = function (node, attribute) {
        var deps = this.properties(node);
        if (!deps.attributes) {
            deps.attributes = new Set();
        }
        deps.attributes.add(attribute);
    };
    SelectorsMatch.prototype.addPseudoClass = function (node, pseudoClass) {
        var deps = this.properties(node);
        if (!deps.pseudoClasses) {
            deps.pseudoClasses = new Set();
        }
        deps.pseudoClasses.add(pseudoClass);
    };
    SelectorsMatch.prototype.properties = function (node) {
        var set = this.changeMap.get(node);
        if (!set) {
            this.changeMap.set(node, set = {});
        }
        return set;
    };
    return SelectorsMatch;
}());
exports.SelectorsMatch = SelectorsMatch;
//# sourceMappingURL=css-selector.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/font-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var Font = (function () {
    function Font(fontFamily, fontSize, fontStyle, fontWeight) {
        this.fontFamily = fontFamily;
        this.fontSize = fontSize;
        this.fontStyle = fontStyle;
        this.fontWeight = fontWeight;
    }
    Object.defineProperty(Font.prototype, "isItalic", {
        get: function () {
            return this.fontStyle === FontStyle.ITALIC;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Font.prototype, "isBold", {
        get: function () {
            return this.fontWeight === FontWeight.SEMI_BOLD ||
                this.fontWeight === FontWeight.BOLD ||
                this.fontWeight === "700" ||
                this.fontWeight === FontWeight.EXTRA_BOLD ||
                this.fontWeight === FontWeight.BLACK;
        },
        enumerable: true,
        configurable: true
    });
    Font.equals = function (value1, value2) {
        if (!value1 && !value2) {
            return true;
        }
        if (!value1 || !value2) {
            return false;
        }
        return value1.fontFamily === value2.fontFamily &&
            value1.fontSize === value2.fontSize &&
            value1.fontStyle === value2.fontStyle &&
            value1.fontWeight === value2.fontWeight;
    };
    Font.default = undefined;
    return Font;
}());
exports.Font = Font;
var FontStyle;
(function (FontStyle) {
    FontStyle.NORMAL = "normal";
    FontStyle.ITALIC = "italic";
    FontStyle.isValid = properties_1.makeValidator(FontStyle.NORMAL, FontStyle.ITALIC);
    FontStyle.parse = properties_1.makeParser(FontStyle.isValid);
})(FontStyle = exports.FontStyle || (exports.FontStyle = {}));
var FontWeight;
(function (FontWeight) {
    FontWeight.THIN = "100";
    FontWeight.EXTRA_LIGHT = "200";
    FontWeight.LIGHT = "300";
    FontWeight.NORMAL = "normal";
    FontWeight.MEDIUM = "500";
    FontWeight.SEMI_BOLD = "600";
    FontWeight.BOLD = "bold";
    FontWeight.EXTRA_BOLD = "800";
    FontWeight.BLACK = "900";
    FontWeight.isValid = properties_1.makeValidator(FontWeight.THIN, FontWeight.EXTRA_LIGHT, FontWeight.LIGHT, FontWeight.NORMAL, "400", FontWeight.MEDIUM, FontWeight.SEMI_BOLD, FontWeight.BOLD, "700", FontWeight.EXTRA_BOLD, FontWeight.BLACK);
    FontWeight.parse = properties_1.makeParser(FontWeight.isValid);
})(FontWeight = exports.FontWeight || (exports.FontWeight = {}));
function parseFontFamily(value) {
    var result = new Array();
    if (!value) {
        return result;
    }
    var split = value.split(",");
    for (var i = 0; i < split.length; i++) {
        var str = split[i].trim().replace(/['"]+/g, "");
        if (str) {
            result.push(str);
        }
    }
    return result;
}
exports.parseFontFamily = parseFontFamily;
var genericFontFamilies;
(function (genericFontFamilies) {
    genericFontFamilies.serif = "serif";
    genericFontFamilies.sansSerif = "sans-serif";
    genericFontFamilies.monospace = "monospace";
    genericFontFamilies.system = "system";
})(genericFontFamilies = exports.genericFontFamilies || (exports.genericFontFamilies = {}));
var styles = new Set();
[
    FontStyle.NORMAL,
    FontStyle.ITALIC
].forEach(function (val, i, a) { return styles.add(val); });
var weights = new Set();
[
    FontWeight.THIN,
    FontWeight.EXTRA_LIGHT,
    FontWeight.LIGHT,
    FontWeight.NORMAL,
    "400",
    FontWeight.MEDIUM,
    FontWeight.SEMI_BOLD,
    FontWeight.BOLD,
    "700",
    FontWeight.EXTRA_BOLD,
    FontWeight.BLACK
].forEach(function (val, i, a) { return weights.add(val); });
function parseFont(fontValue) {
    var result = {
        fontStyle: "normal",
        fontVariant: "normal",
        fontWeight: "normal"
    };
    var parts = fontValue.split(/\s+/);
    var part;
    while (part = parts.shift()) {
        if (part === "normal") {
        }
        else if (part === "small-caps") {
            result.fontVariant = part;
        }
        else if (styles.has(part)) {
            result.fontStyle = part;
        }
        else if (weights.has(part)) {
            result.fontWeight = part;
        }
        else if (!result.fontSize) {
            var sizes = part.split("/");
            result.fontSize = sizes[0];
            result.lineHeight = sizes.length > 1 ? sizes[1] : undefined;
        }
        else {
            result.fontFamily = part;
            if (parts.length) {
                result.fontFamily += " " + parts.join(" ");
            }
            break;
        }
    }
    return result;
}
exports.parseFont = parseFont;
//# sourceMappingURL=font-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/font.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font-common.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/styling/font-common.js"));
var FONTS_BASE_PATH = "/fonts/";
var typefaceCache = new Map();
var appAssets;
var Font = (function (_super) {
    __extends(Font, _super);
    function Font(family, size, style, weight) {
        return _super.call(this, family, size, style, weight) || this;
    }
    Font.prototype.withFontFamily = function (family) {
        return new Font(family, this.fontSize, this.fontStyle, this.fontWeight);
    };
    Font.prototype.withFontStyle = function (style) {
        return new Font(this.fontFamily, this.fontSize, style, this.fontWeight);
    };
    Font.prototype.withFontWeight = function (weight) {
        return new Font(this.fontFamily, this.fontSize, this.fontStyle, weight);
    };
    Font.prototype.withFontSize = function (size) {
        return new Font(this.fontFamily, size, this.fontStyle, this.fontWeight);
    };
    Font.prototype.getAndroidTypeface = function () {
        if (!this._typeface) {
            this._typeface = createTypeface(this);
        }
        return this._typeface;
    };
    Font.prototype.getUIFont = function (defaultFont) {
        return undefined;
    };
    Font.default = new Font(undefined, undefined, "normal", "normal");
    return Font;
}(font_common_1.Font));
exports.Font = Font;
function loadFontFromFile(fontFamily) {
    appAssets = appAssets || application.android.context.getAssets();
    if (!appAssets) {
        return null;
    }
    var result = typefaceCache.get(fontFamily);
    if (result === undefined) {
        result = null;
        var fontAssetPath = void 0;
        var basePath = fs.path.join(fs.knownFolders.currentApp().path, "fonts", fontFamily);
        if (fs.File.exists(basePath + ".ttf")) {
            fontAssetPath = FONTS_BASE_PATH + fontFamily + ".ttf";
        }
        else if (fs.File.exists(basePath + ".otf")) {
            fontAssetPath = FONTS_BASE_PATH + fontFamily + ".otf";
        }
        else {
            if (trace_1.isEnabled()) {
                trace_1.write("Could not find font file for " + fontFamily, trace_1.categories.Error, trace_1.messageType.error);
            }
        }
        if (fontAssetPath) {
            try {
                fontAssetPath = fs.path.join(fs.knownFolders.currentApp().path, fontAssetPath);
                result = android.graphics.Typeface.createFromFile(fontAssetPath);
            }
            catch (e) {
                if (trace_1.isEnabled()) {
                    trace_1.write("Error loading font asset: " + fontAssetPath, trace_1.categories.Error, trace_1.messageType.error);
                }
            }
        }
        typefaceCache.set(fontFamily, result);
    }
    return result;
}
function createTypeface(font) {
    var fontStyle = 0;
    if (font.isBold) {
        fontStyle |= android.graphics.Typeface.BOLD;
    }
    if (font.isItalic) {
        fontStyle |= android.graphics.Typeface.ITALIC;
    }
    var fonts = font_common_1.parseFontFamily(font.fontFamily);
    var result = null;
    for (var i = 0; i < fonts.length; i++) {
        switch (fonts[i].toLowerCase()) {
            case font_common_1.genericFontFamilies.serif:
                result = android.graphics.Typeface.create("serif" + getFontWeightSuffix(font.fontWeight), fontStyle);
                break;
            case font_common_1.genericFontFamilies.sansSerif:
            case font_common_1.genericFontFamilies.system:
                result = android.graphics.Typeface.create("sans-serif" + getFontWeightSuffix(font.fontWeight), fontStyle);
                break;
            case font_common_1.genericFontFamilies.monospace:
                result = android.graphics.Typeface.create("monospace" + getFontWeightSuffix(font.fontWeight), fontStyle);
                break;
            default:
                result = loadFontFromFile(fonts[i]);
                if (result && fontStyle) {
                    result = android.graphics.Typeface.create(result, fontStyle);
                }
                break;
        }
        if (result) {
            break;
        }
    }
    if (!result) {
        result = android.graphics.Typeface.create("sans-serif" + getFontWeightSuffix(font.fontWeight), fontStyle);
    }
    return result;
}
function getFontWeightSuffix(fontWeight) {
    switch (fontWeight) {
        case font_common_1.FontWeight.THIN:
            return android.os.Build.VERSION.SDK_INT >= 16 ? "-thin" : "";
        case font_common_1.FontWeight.EXTRA_LIGHT:
        case font_common_1.FontWeight.LIGHT:
            return android.os.Build.VERSION.SDK_INT >= 16 ? "-light" : "";
        case font_common_1.FontWeight.NORMAL:
        case "400":
        case undefined:
        case null:
            return "";
        case font_common_1.FontWeight.MEDIUM:
        case font_common_1.FontWeight.SEMI_BOLD:
            return android.os.Build.VERSION.SDK_INT >= 21 ? "-medium" : "";
        case font_common_1.FontWeight.BOLD:
        case "700":
        case font_common_1.FontWeight.EXTRA_BOLD:
            return "";
        case font_common_1.FontWeight.BLACK:
            return android.os.Build.VERSION.SDK_INT >= 21 ? "-black" : "";
        default:
            throw new Error("Invalid font weight: \"" + fontWeight + "\"");
    }
}
//# sourceMappingURL=font.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/linear-gradient.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var LinearGradient = (function () {
    function LinearGradient() {
    }
    LinearGradient.parse = function (value) {
        var result = new LinearGradient();
        result.angle = value.angle;
        result.colorStops = value.colors.map(function (color) {
            var offset = color.offset || null;
            var offsetUnit;
            if (offset && offset.unit === "%") {
                offsetUnit = {
                    unit: "%",
                    value: offset.value
                };
            }
            return {
                color: new color_1.Color(color.argb),
                offset: offsetUnit
            };
        });
        return result;
    };
    LinearGradient.equals = function (first, second) {
        if (!first && !second) {
            return true;
        }
        else if (!first || !second) {
            return false;
        }
        if (first.angle !== second.angle) {
            return false;
        }
        if (first.colorStops.length !== second.colorStops.length) {
            return false;
        }
        for (var i = 0; i < first.colorStops.length; i++) {
            var firstStop = first.colorStops[i];
            var secondStop = second.colorStops[i];
            if (firstStop.offset !== secondStop.offset) {
                return false;
            }
            if (!color_1.Color.equals(firstStop.color, secondStop.color)) {
                return false;
            }
        }
        return true;
    };
    return LinearGradient;
}());
exports.LinearGradient = LinearGradient;
//# sourceMappingURL=linear-gradient.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/style-properties.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var background_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/background.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var number_utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/number-utils.js");
var matrix_1 = __webpack_require__("../node_modules/tns-core-modules/matrix/matrix.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var parser = __webpack_require__("../node_modules/tns-core-modules/css/parser.js");
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
function equalsCommon(a, b) {
    if (a == "auto") {
        return b == "auto";
    }
    if (typeof a === "number") {
        if (b == "auto") {
            return false;
        }
        if (typeof b === "number") {
            return a == b;
        }
        if (!b) {
            return false;
        }
        return b.unit == "dip" && a == b.value;
    }
    if (b == "auto") {
        return false;
    }
    if (typeof b === "number") {
        return a ? (a.unit == "dip" && a.value == b) : false;
    }
    if (!a || !b) {
        return false;
    }
    return a.value == b.value && a.unit == b.unit;
}
function convertToStringCommon(length) {
    if (length == "auto") {
        return "auto";
    }
    if (typeof length === "number") {
        return length.toString();
    }
    var val = length.value;
    if (length.unit === "%") {
        val *= 100;
    }
    return val + length.unit;
}
function toDevicePixelsCommon(length, auto, parentAvailableWidth) {
    if (auto === void 0) { auto = Number.NaN; }
    if (parentAvailableWidth === void 0) { parentAvailableWidth = Number.NaN; }
    if (length == "auto") {
        return auto;
    }
    if (typeof length === "number") {
        return utils_1.layout.round(utils_1.layout.toDevicePixels(length));
    }
    if (!length) {
        return auto;
    }
    switch (length.unit) {
        case "px":
            return utils_1.layout.round(length.value);
        case "%":
            return utils_1.layout.round(parentAvailableWidth * length.value);
        case "dip":
        default:
            return utils_1.layout.round(utils_1.layout.toDevicePixels(length.value));
    }
}
var PercentLength;
(function (PercentLength) {
    function parse(fromValue) {
        if (fromValue == "auto") {
            return "auto";
        }
        if (typeof fromValue === "string") {
            var stringValue = fromValue.trim();
            var percentIndex = stringValue.indexOf("%");
            if (percentIndex !== -1) {
                var value = void 0;
                if (percentIndex !== (stringValue.length - 1) || percentIndex === 0) {
                    value = Number.NaN;
                }
                else {
                    value = parseFloat(stringValue.substring(0, stringValue.length - 1).trim()) / 100;
                }
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + fromValue);
                }
                return { unit: "%", value: value };
            }
            else if (stringValue.indexOf("px") !== -1) {
                stringValue = stringValue.replace("px", "").trim();
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + fromValue);
                }
                return { unit: "px", value: value };
            }
            else {
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + fromValue);
                }
                return value;
            }
        }
        else {
            return fromValue;
        }
    }
    PercentLength.parse = parse;
    PercentLength.equals = equalsCommon;
    PercentLength.toDevicePixels = toDevicePixelsCommon;
    PercentLength.convertToString = convertToStringCommon;
})(PercentLength = exports.PercentLength || (exports.PercentLength = {}));
var Length;
(function (Length) {
    function parse(fromValue) {
        if (fromValue == "auto") {
            return "auto";
        }
        if (typeof fromValue === "string") {
            var stringValue = fromValue.trim();
            if (stringValue.indexOf("px") !== -1) {
                stringValue = stringValue.replace("px", "").trim();
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + stringValue);
                }
                return { unit: "px", value: value };
            }
            else {
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + stringValue);
                }
                return value;
            }
        }
        else {
            return fromValue;
        }
    }
    Length.parse = parse;
    Length.equals = equalsCommon;
    Length.toDevicePixels = toDevicePixelsCommon;
    Length.convertToString = convertToStringCommon;
})(Length = exports.Length || (exports.Length = {}));
exports.zeroLength = { value: 0, unit: "px" };
exports.minWidthProperty = new properties_1.CssProperty({
    name: "minWidth", cssName: "min-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectiveMinWidth = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.minWidthProperty.register(properties_1.Style);
exports.minHeightProperty = new properties_1.CssProperty({
    name: "minHeight", cssName: "min-height", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectiveMinHeight = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.minHeightProperty.register(properties_1.Style);
exports.widthProperty = new properties_1.CssAnimationProperty({
    name: "width", cssName: "width", defaultValue: "auto", equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        if (platform_1.isIOS) {
            var view = target.viewRef.get();
            if (view) {
                view.requestLayout();
            }
        }
    }, valueConverter: PercentLength.parse
});
exports.widthProperty.register(properties_1.Style);
exports.heightProperty = new properties_1.CssAnimationProperty({
    name: "height", cssName: "height", defaultValue: "auto", equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        if (platform_1.isIOS) {
            var view = target.viewRef.get();
            if (view) {
                view.requestLayout();
            }
        }
    }, valueConverter: PercentLength.parse,
});
exports.heightProperty.register(properties_1.Style);
var marginProperty = new properties_1.ShorthandProperty({
    name: "margin", cssName: "margin",
    getter: function () {
        if (PercentLength.equals(this.marginTop, this.marginRight) &&
            PercentLength.equals(this.marginTop, this.marginBottom) &&
            PercentLength.equals(this.marginTop, this.marginLeft)) {
            return this.marginTop;
        }
        return PercentLength.convertToString(this.marginTop) + " " + PercentLength.convertToString(this.marginRight) + " " + PercentLength.convertToString(this.marginBottom) + " " + PercentLength.convertToString(this.marginLeft);
    },
    converter: convertToMargins
});
marginProperty.register(properties_1.Style);
exports.marginLeftProperty = new properties_1.CssProperty({ name: "marginLeft", cssName: "margin-left", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginLeftProperty.register(properties_1.Style);
exports.marginRightProperty = new properties_1.CssProperty({ name: "marginRight", cssName: "margin-right", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginRightProperty.register(properties_1.Style);
exports.marginTopProperty = new properties_1.CssProperty({ name: "marginTop", cssName: "margin-top", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginTopProperty.register(properties_1.Style);
exports.marginBottomProperty = new properties_1.CssProperty({ name: "marginBottom", cssName: "margin-bottom", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginBottomProperty.register(properties_1.Style);
var paddingProperty = new properties_1.ShorthandProperty({
    name: "padding", cssName: "padding",
    getter: function () {
        if (Length.equals(this.paddingTop, this.paddingRight) &&
            Length.equals(this.paddingTop, this.paddingBottom) &&
            Length.equals(this.paddingTop, this.paddingLeft)) {
            return this.paddingTop;
        }
        return Length.convertToString(this.paddingTop) + " " + Length.convertToString(this.paddingRight) + " " + Length.convertToString(this.paddingBottom) + " " + Length.convertToString(this.paddingLeft);
    },
    converter: convertToPaddings
});
paddingProperty.register(properties_1.Style);
exports.paddingLeftProperty = new properties_1.CssProperty({
    name: "paddingLeft", cssName: "padding-left", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingLeft = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingLeftProperty.register(properties_1.Style);
exports.paddingRightProperty = new properties_1.CssProperty({
    name: "paddingRight", cssName: "padding-right", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingRight = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingRightProperty.register(properties_1.Style);
exports.paddingTopProperty = new properties_1.CssProperty({
    name: "paddingTop", cssName: "padding-top", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingTop = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingTopProperty.register(properties_1.Style);
exports.paddingBottomProperty = new properties_1.CssProperty({
    name: "paddingBottom", cssName: "padding-bottom", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingBottom = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingBottomProperty.register(properties_1.Style);
var HorizontalAlignment;
(function (HorizontalAlignment) {
    HorizontalAlignment.LEFT = "left";
    HorizontalAlignment.CENTER = "center";
    HorizontalAlignment.RIGHT = "right";
    HorizontalAlignment.STRETCH = "stretch";
    HorizontalAlignment.isValid = properties_1.makeValidator(HorizontalAlignment.LEFT, HorizontalAlignment.CENTER, HorizontalAlignment.RIGHT, HorizontalAlignment.STRETCH);
    HorizontalAlignment.parse = properties_1.makeParser(HorizontalAlignment.isValid);
})(HorizontalAlignment = exports.HorizontalAlignment || (exports.HorizontalAlignment = {}));
exports.horizontalAlignmentProperty = new properties_1.CssProperty({ name: "horizontalAlignment", cssName: "horizontal-align", defaultValue: HorizontalAlignment.STRETCH, affectsLayout: platform_1.isIOS, valueConverter: HorizontalAlignment.parse });
exports.horizontalAlignmentProperty.register(properties_1.Style);
var VerticalAlignment;
(function (VerticalAlignment) {
    VerticalAlignment.TOP = "top";
    VerticalAlignment.MIDDLE = "middle";
    VerticalAlignment.BOTTOM = "bottom";
    VerticalAlignment.STRETCH = "stretch";
    VerticalAlignment.isValid = properties_1.makeValidator(VerticalAlignment.TOP, VerticalAlignment.MIDDLE, VerticalAlignment.BOTTOM, VerticalAlignment.STRETCH);
    VerticalAlignment.parse = function (value) { return value.toLowerCase() === "center" ? VerticalAlignment.MIDDLE : parseStrict(value); };
    var parseStrict = properties_1.makeParser(VerticalAlignment.isValid);
})(VerticalAlignment = exports.VerticalAlignment || (exports.VerticalAlignment = {}));
exports.verticalAlignmentProperty = new properties_1.CssProperty({ name: "verticalAlignment", cssName: "vertical-align", defaultValue: VerticalAlignment.STRETCH, affectsLayout: platform_1.isIOS, valueConverter: VerticalAlignment.parse });
exports.verticalAlignmentProperty.register(properties_1.Style);
function parseThickness(value) {
    if (typeof value === "string") {
        var arr = value.split(/[ ,]+/);
        var top_1;
        var right = void 0;
        var bottom = void 0;
        var left = void 0;
        if (arr.length === 1) {
            top_1 = arr[0];
            right = arr[0];
            bottom = arr[0];
            left = arr[0];
        }
        else if (arr.length === 2) {
            top_1 = arr[0];
            bottom = arr[0];
            right = arr[1];
            left = arr[1];
        }
        else if (arr.length === 3) {
            top_1 = arr[0];
            right = arr[1];
            left = arr[1];
            bottom = arr[2];
        }
        else if (arr.length === 4) {
            top_1 = arr[0];
            right = arr[1];
            bottom = arr[2];
            left = arr[3];
        }
        else {
            throw new Error("Expected 1, 2, 3 or 4 parameters. Actual: " + value);
        }
        return {
            top: top_1,
            right: right,
            bottom: bottom,
            left: left
        };
    }
    else {
        return value;
    }
}
function convertToMargins(value) {
    if (typeof value === "string" && value !== "auto") {
        var thickness = parseThickness(value);
        return [
            [exports.marginTopProperty, PercentLength.parse(thickness.top)],
            [exports.marginRightProperty, PercentLength.parse(thickness.right)],
            [exports.marginBottomProperty, PercentLength.parse(thickness.bottom)],
            [exports.marginLeftProperty, PercentLength.parse(thickness.left)]
        ];
    }
    else {
        return [
            [exports.marginTopProperty, value],
            [exports.marginRightProperty, value],
            [exports.marginBottomProperty, value],
            [exports.marginLeftProperty, value]
        ];
    }
}
function convertToPaddings(value) {
    if (typeof value === "string" && value !== "auto") {
        var thickness = parseThickness(value);
        return [
            [exports.paddingTopProperty, Length.parse(thickness.top)],
            [exports.paddingRightProperty, Length.parse(thickness.right)],
            [exports.paddingBottomProperty, Length.parse(thickness.bottom)],
            [exports.paddingLeftProperty, Length.parse(thickness.left)]
        ];
    }
    else {
        return [
            [exports.paddingTopProperty, value],
            [exports.paddingRightProperty, value],
            [exports.paddingBottomProperty, value],
            [exports.paddingLeftProperty, value]
        ];
    }
}
exports.rotateProperty = new properties_1.CssAnimationProperty({ name: "rotate", cssName: "rotate", defaultValue: 0, valueConverter: parseFloat });
exports.rotateProperty.register(properties_1.Style);
exports.scaleXProperty = new properties_1.CssAnimationProperty({ name: "scaleX", cssName: "scaleX", defaultValue: 1, valueConverter: parseFloat });
exports.scaleXProperty.register(properties_1.Style);
exports.scaleYProperty = new properties_1.CssAnimationProperty({ name: "scaleY", cssName: "scaleY", defaultValue: 1, valueConverter: parseFloat });
exports.scaleYProperty.register(properties_1.Style);
function parseDIPs(value) {
    if (value.indexOf("px") !== -1) {
        return utils_1.layout.toDeviceIndependentPixels(parseFloat(value.replace("px", "").trim()));
    }
    else {
        return parseFloat(value.replace("dip", "").trim());
    }
}
exports.translateXProperty = new properties_1.CssAnimationProperty({ name: "translateX", cssName: "translateX", defaultValue: 0, valueConverter: parseDIPs });
exports.translateXProperty.register(properties_1.Style);
exports.translateYProperty = new properties_1.CssAnimationProperty({ name: "translateY", cssName: "translateY", defaultValue: 0, valueConverter: parseDIPs });
exports.translateYProperty.register(properties_1.Style);
var transformProperty = new properties_1.ShorthandProperty({
    name: "transform", cssName: "transform",
    getter: function () {
        var scaleX = this.scaleX;
        var scaleY = this.scaleY;
        var translateX = this.translateX;
        var translateY = this.translateY;
        var rotate = this.rotate;
        var result = "";
        if (translateX !== 0 || translateY !== 0) {
            result += "translate(" + translateX + ", " + translateY + ") ";
        }
        if (scaleX !== 1 || scaleY !== 1) {
            result += "scale(" + scaleX + ", " + scaleY + ") ";
        }
        if (rotate !== 0) {
            result += "rotate (" + rotate + ")";
        }
        return result.trim();
    },
    converter: convertToTransform
});
transformProperty.register(properties_1.Style);
var IDENTITY_TRANSFORMATION = {
    translate: { x: 0, y: 0 },
    rotate: 0,
    scale: { x: 1, y: 1 },
};
var TRANSFORM_SPLITTER = new RegExp(/\s*(.+?)\((.*?)\)/g);
var TRANSFORMATIONS = Object.freeze([
    "rotate",
    "translate",
    "translate3d",
    "translateX",
    "translateY",
    "scale",
    "scale3d",
    "scaleX",
    "scaleY",
]);
var STYLE_TRANSFORMATION_MAP = Object.freeze({
    "scale": function (value) { return ({ property: "scale", value: value }); },
    "scale3d": function (value) { return ({ property: "scale", value: value }); },
    "scaleX": function (_a) {
        var x = _a.x;
        return ({ property: "scale", value: { x: x, y: IDENTITY_TRANSFORMATION.scale.y } });
    },
    "scaleY": function (_a) {
        var y = _a.y;
        return ({ property: "scale", value: { y: y, x: IDENTITY_TRANSFORMATION.scale.x } });
    },
    "translate": function (value) { return ({ property: "translate", value: value }); },
    "translate3d": function (value) { return ({ property: "translate", value: value }); },
    "translateX": function (_a) {
        var x = _a.x;
        return ({ property: "translate", value: { x: x, y: IDENTITY_TRANSFORMATION.translate.y } });
    },
    "translateY": function (_a) {
        var y = _a.y;
        return ({ property: "translate", value: { y: y, x: IDENTITY_TRANSFORMATION.translate.x } });
    },
    "rotate": function (value) { return ({ property: "rotate", value: value }); },
});
function convertToTransform(value) {
    if (value === properties_1.unsetValue) {
        value = "none";
    }
    var _a = transformConverter(value), translate = _a.translate, rotate = _a.rotate, scale = _a.scale;
    return [
        [exports.translateXProperty, translate.x],
        [exports.translateYProperty, translate.y],
        [exports.scaleXProperty, scale.x],
        [exports.scaleYProperty, scale.y],
        [exports.rotateProperty, rotate],
    ];
}
function transformConverter(text) {
    var transformations = parseTransformString(text);
    if (text === "none" || text === "" || !transformations.length) {
        return IDENTITY_TRANSFORMATION;
    }
    var usedTransforms = transformations.map(function (t) { return t.property; });
    if (!utils_1.hasDuplicates(usedTransforms)) {
        var fullTransformations_1 = __assign({}, IDENTITY_TRANSFORMATION);
        transformations.forEach(function (transform) {
            fullTransformations_1[transform.property] = transform.value;
        });
        return fullTransformations_1;
    }
    var affineMatrix = transformations
        .map(matrix_1.getTransformMatrix)
        .reduce(matrix_1.multiplyAffine2d);
    var cssMatrix = matrix_1.matrixArrayToCssMatrix(affineMatrix);
    return matrix_1.decompose2DTransformMatrix(cssMatrix);
}
exports.transformConverter = transformConverter;
function parseTransformString(text) {
    var matches = [];
    var match;
    while ((match = TRANSFORM_SPLITTER.exec(text)) !== null) {
        var property = match[1];
        var value = convertTransformValue(property, match[2]);
        if (TRANSFORMATIONS.indexOf(property) !== -1) {
            matches.push(normalizeTransformation({ property: property, value: value }));
        }
    }
    return matches;
}
function normalizeTransformation(_a) {
    var property = _a.property, value = _a.value;
    return STYLE_TRANSFORMATION_MAP[property](value);
}
function convertTransformValue(property, stringValue) {
    var _a = stringValue.split(",").map(parseFloat), x = _a[0], _b = _a[1], y = _b === void 0 ? x : _b;
    if (property === "rotate") {
        return stringValue.slice(-3) === "rad" ? number_utils_1.radiansToDegrees(x) : x;
    }
    return { x: x, y: y };
}
var backgroundProperty = new properties_1.ShorthandProperty({
    name: "background", cssName: "background",
    getter: function () {
        return this.backgroundColor + " " + this.backgroundImage + " " + this.backgroundRepeat + " " + this.backgroundPosition;
    },
    converter: convertToBackgrounds
});
backgroundProperty.register(properties_1.Style);
exports.backgroundInternalProperty = new properties_1.CssProperty({
    name: "backgroundInternal",
    cssName: "_backgroundInternal",
    defaultValue: background_1.Background.default
});
exports.backgroundInternalProperty.register(properties_1.Style);
exports.backgroundImageProperty = new properties_1.CssProperty({
    name: "backgroundImage", cssName: "background-image", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withImage(newValue);
        target.backgroundInternal = background;
    },
    equalityComparer: function (value1, value2) {
        if (value1 instanceof linear_gradient_1.LinearGradient && value2 instanceof linear_gradient_1.LinearGradient) {
            return linear_gradient_1.LinearGradient.equals(value1, value2);
        }
        else {
            return value1 === value2;
        }
    },
    valueConverter: function (value) {
        if (typeof value === "string") {
            var parsed = parser.parseBackground(value);
            if (parsed) {
                var background = parsed.value;
                value = (typeof background.image === "object") ? linear_gradient_1.LinearGradient.parse(background.image) : value;
            }
        }
        return value;
    }
});
exports.backgroundImageProperty.register(properties_1.Style);
exports.backgroundColorProperty = new properties_1.CssAnimationProperty({
    name: "backgroundColor", cssName: "background-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.backgroundColorProperty.register(properties_1.Style);
var BackgroundRepeat;
(function (BackgroundRepeat) {
    BackgroundRepeat.REPEAT = "repeat";
    BackgroundRepeat.REPEAT_X = "repeat-x";
    BackgroundRepeat.REPEAT_Y = "repeat-y";
    BackgroundRepeat.NO_REPEAT = "no-repeat";
    BackgroundRepeat.isValid = properties_1.makeValidator(BackgroundRepeat.REPEAT, BackgroundRepeat.REPEAT_X, BackgroundRepeat.REPEAT_Y, BackgroundRepeat.NO_REPEAT);
    BackgroundRepeat.parse = properties_1.makeParser(BackgroundRepeat.isValid);
})(BackgroundRepeat = exports.BackgroundRepeat || (exports.BackgroundRepeat = {}));
exports.backgroundRepeatProperty = new properties_1.CssProperty({
    name: "backgroundRepeat", cssName: "background-repeat", valueConverter: BackgroundRepeat.parse,
    valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withRepeat(newValue);
        target.backgroundInternal = background;
    }
});
exports.backgroundRepeatProperty.register(properties_1.Style);
exports.backgroundSizeProperty = new properties_1.CssProperty({
    name: "backgroundSize", cssName: "background-size", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withSize(newValue);
        target.backgroundInternal = background;
    }
});
exports.backgroundSizeProperty.register(properties_1.Style);
exports.backgroundPositionProperty = new properties_1.CssProperty({
    name: "backgroundPosition", cssName: "background-position", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withPosition(newValue);
        target.backgroundInternal = background;
    }
});
exports.backgroundPositionProperty.register(properties_1.Style);
function convertToBackgrounds(value) {
    if (typeof value === "string") {
        var backgrounds = parser.parseBackground(value).value;
        var backgroundColor = backgrounds.color ? new color_1.Color(backgrounds.color) : properties_1.unsetValue;
        var backgroundImage = void 0;
        if (typeof backgrounds.image === "object" && backgrounds.image) {
            backgroundImage = linear_gradient_1.LinearGradient.parse(backgrounds.image);
        }
        else {
            backgroundImage = backgrounds.image || properties_1.unsetValue;
        }
        var backgroundRepeat = backgrounds.repeat || properties_1.unsetValue;
        var backgroundPosition = backgrounds.position ? backgrounds.position.text : properties_1.unsetValue;
        return [
            [exports.backgroundColorProperty, backgroundColor],
            [exports.backgroundImageProperty, backgroundImage],
            [exports.backgroundRepeatProperty, backgroundRepeat],
            [exports.backgroundPositionProperty, backgroundPosition]
        ];
    }
    else {
        return [
            [exports.backgroundColorProperty, properties_1.unsetValue],
            [exports.backgroundImageProperty, properties_1.unsetValue],
            [exports.backgroundRepeatProperty, properties_1.unsetValue],
            [exports.backgroundPositionProperty, properties_1.unsetValue]
        ];
    }
}
function parseBorderColor(value) {
    var result = { top: undefined, right: undefined, bottom: undefined, left: undefined };
    if (value.indexOf("rgb") === 0) {
        result.top = result.right = result.bottom = result.left = new color_1.Color(value);
        return result;
    }
    var arr = value.split(/[ ,]+/);
    if (arr.length === 1) {
        var arr0 = new color_1.Color(arr[0]);
        result.top = arr0;
        result.right = arr0;
        result.bottom = arr0;
        result.left = arr0;
    }
    else if (arr.length === 2) {
        var arr0 = new color_1.Color(arr[0]);
        var arr1 = new color_1.Color(arr[1]);
        result.top = arr0;
        result.right = arr1;
        result.bottom = arr0;
        result.left = arr1;
    }
    else if (arr.length === 3) {
        var arr0 = new color_1.Color(arr[0]);
        var arr1 = new color_1.Color(arr[1]);
        var arr2 = new color_1.Color(arr[2]);
        result.top = arr0;
        result.right = arr1;
        result.bottom = arr2;
        result.left = arr1;
    }
    else if (arr.length === 4) {
        var arr0 = new color_1.Color(arr[0]);
        var arr1 = new color_1.Color(arr[1]);
        var arr2 = new color_1.Color(arr[2]);
        var arr3 = new color_1.Color(arr[3]);
        result.top = arr0;
        result.right = arr1;
        result.bottom = arr2;
        result.left = arr3;
    }
    else {
        throw new Error("Expected 1, 2, 3 or 4 parameters. Actual: " + value);
    }
    return result;
}
var borderColorProperty = new properties_1.ShorthandProperty({
    name: "borderColor", cssName: "border-color",
    getter: function () {
        if (color_1.Color.equals(this.borderTopColor, this.borderRightColor) &&
            color_1.Color.equals(this.borderTopColor, this.borderBottomColor) &&
            color_1.Color.equals(this.borderTopColor, this.borderLeftColor)) {
            return this.borderTopColor;
        }
        else {
            return this.borderTopColor + " " + this.borderRightColor + " " + this.borderBottomColor + " " + this.borderLeftColor;
        }
    },
    converter: function (value) {
        if (typeof value === "string") {
            var fourColors = parseBorderColor(value);
            return [
                [exports.borderTopColorProperty, fourColors.top],
                [exports.borderRightColorProperty, fourColors.right],
                [exports.borderBottomColorProperty, fourColors.bottom],
                [exports.borderLeftColorProperty, fourColors.left]
            ];
        }
        else {
            return [
                [exports.borderTopColorProperty, value],
                [exports.borderRightColorProperty, value],
                [exports.borderBottomColorProperty, value],
                [exports.borderLeftColorProperty, value]
            ];
        }
    }
});
borderColorProperty.register(properties_1.Style);
exports.borderTopColorProperty = new properties_1.CssProperty({
    name: "borderTopColor", cssName: "border-top-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderTopColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderTopColorProperty.register(properties_1.Style);
exports.borderRightColorProperty = new properties_1.CssProperty({
    name: "borderRightColor", cssName: "border-right-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderRightColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderRightColorProperty.register(properties_1.Style);
exports.borderBottomColorProperty = new properties_1.CssProperty({
    name: "borderBottomColor", cssName: "border-bottom-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderBottomColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderBottomColorProperty.register(properties_1.Style);
exports.borderLeftColorProperty = new properties_1.CssProperty({
    name: "borderLeftColor", cssName: "border-left-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderLeftColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderLeftColorProperty.register(properties_1.Style);
var borderWidthProperty = new properties_1.ShorthandProperty({
    name: "borderWidth", cssName: "border-width",
    getter: function () {
        if (Length.equals(this.borderTopWidth, this.borderRightWidth) &&
            Length.equals(this.borderTopWidth, this.borderBottomWidth) &&
            Length.equals(this.borderTopWidth, this.borderLeftWidth)) {
            return this.borderTopWidth;
        }
        else {
            return Length.convertToString(this.borderTopWidth) + " " + Length.convertToString(this.borderRightWidth) + " " + Length.convertToString(this.borderBottomWidth) + " " + Length.convertToString(this.borderLeftWidth);
        }
    },
    converter: function (value) {
        if (typeof value === "string" && value !== "auto") {
            var borderWidths = parseThickness(value);
            return [
                [exports.borderTopWidthProperty, borderWidths.top],
                [exports.borderRightWidthProperty, borderWidths.right],
                [exports.borderBottomWidthProperty, borderWidths.bottom],
                [exports.borderLeftWidthProperty, borderWidths.left]
            ];
        }
        else {
            return [
                [exports.borderTopWidthProperty, value],
                [exports.borderRightWidthProperty, value],
                [exports.borderBottomWidthProperty, value],
                [exports.borderLeftWidthProperty, value]
            ];
        }
    }
});
borderWidthProperty.register(properties_1.Style);
exports.borderTopWidthProperty = new properties_1.CssProperty({
    name: "borderTopWidth", cssName: "border-top-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-top-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderTopWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderTopWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderTopWidthProperty.register(properties_1.Style);
exports.borderRightWidthProperty = new properties_1.CssProperty({
    name: "borderRightWidth", cssName: "border-right-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-right-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderRightWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderRightWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderRightWidthProperty.register(properties_1.Style);
exports.borderBottomWidthProperty = new properties_1.CssProperty({
    name: "borderBottomWidth", cssName: "border-bottom-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-bottom-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderBottomWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderBottomWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderBottomWidthProperty.register(properties_1.Style);
exports.borderLeftWidthProperty = new properties_1.CssProperty({
    name: "borderLeftWidth", cssName: "border-left-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-left-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderLeftWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderLeftWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderLeftWidthProperty.register(properties_1.Style);
var borderRadiusProperty = new properties_1.ShorthandProperty({
    name: "borderRadius", cssName: "border-radius",
    getter: function () {
        if (Length.equals(this.borderTopLeftRadius, this.borderTopRightRadius) &&
            Length.equals(this.borderTopLeftRadius, this.borderBottomRightRadius) &&
            Length.equals(this.borderTopLeftRadius, this.borderBottomLeftRadius)) {
            return this.borderTopLeftRadius;
        }
        return Length.convertToString(this.borderTopLeftRadius) + " " + Length.convertToString(this.borderTopRightRadius) + " " + Length.convertToString(this.borderBottomRightRadius) + " " + Length.convertToString(this.borderBottomLeftRadius);
    },
    converter: function (value) {
        if (typeof value === "string") {
            var borderRadius = parseThickness(value);
            return [
                [exports.borderTopLeftRadiusProperty, borderRadius.top],
                [exports.borderTopRightRadiusProperty, borderRadius.right],
                [exports.borderBottomRightRadiusProperty, borderRadius.bottom],
                [exports.borderBottomLeftRadiusProperty, borderRadius.left]
            ];
        }
        else {
            return [
                [exports.borderTopLeftRadiusProperty, value],
                [exports.borderTopRightRadiusProperty, value],
                [exports.borderBottomRightRadiusProperty, value],
                [exports.borderBottomLeftRadiusProperty, value]
            ];
        }
    }
});
borderRadiusProperty.register(properties_1.Style);
exports.borderTopLeftRadiusProperty = new properties_1.CssProperty({
    name: "borderTopLeftRadius", cssName: "border-top-left-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-top-left-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderTopLeftRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderTopLeftRadiusProperty.register(properties_1.Style);
exports.borderTopRightRadiusProperty = new properties_1.CssProperty({
    name: "borderTopRightRadius", cssName: "border-top-right-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-top-right-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderTopRightRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderTopRightRadiusProperty.register(properties_1.Style);
exports.borderBottomRightRadiusProperty = new properties_1.CssProperty({
    name: "borderBottomRightRadius", cssName: "border-bottom-right-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-bottom-right-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderBottomRightRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderBottomRightRadiusProperty.register(properties_1.Style);
exports.borderBottomLeftRadiusProperty = new properties_1.CssProperty({
    name: "borderBottomLeftRadius", cssName: "border-bottom-left-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-bottom-left-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderBottomLeftRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderBottomLeftRadiusProperty.register(properties_1.Style);
function isNonNegativeFiniteNumber(value) {
    return isFinite(value) && !isNaN(value) && value >= 0;
}
var supportedPaths = ["rect", "circle", "ellipse", "polygon", "inset"];
function isClipPathValid(value) {
    if (!value) {
        return true;
    }
    var functionName = value.substring(0, value.indexOf("(")).trim();
    return supportedPaths.indexOf(functionName) !== -1;
}
exports.clipPathProperty = new properties_1.CssProperty({
    name: "clipPath", cssName: "clip-path", valueChanged: function (target, oldValue, newValue) {
        if (!isClipPathValid(newValue)) {
            throw new Error("clip-path is not valid.");
        }
        var background = target.backgroundInternal.withClipPath(newValue);
        target.backgroundInternal = background;
    }
});
exports.clipPathProperty.register(properties_1.Style);
function isFloatValueConverter(value) {
    var newValue = parseFloat(value);
    if (isNaN(newValue)) {
        throw new Error("Invalid value: " + newValue);
    }
    return newValue;
}
exports.zIndexProperty = new properties_1.CssProperty({ name: "zIndex", cssName: "z-index", valueConverter: isFloatValueConverter });
exports.zIndexProperty.register(properties_1.Style);
function opacityConverter(value) {
    var newValue = parseFloat(value);
    if (!isNaN(newValue) && 0 <= newValue && newValue <= 1) {
        return newValue;
    }
    throw new Error("Opacity should be between [0, 1]. Value: " + newValue);
}
exports.opacityProperty = new properties_1.CssAnimationProperty({ name: "opacity", cssName: "opacity", defaultValue: 1, valueConverter: opacityConverter });
exports.opacityProperty.register(properties_1.Style);
exports.colorProperty = new properties_1.InheritedCssProperty({ name: "color", cssName: "color", equalityComparer: color_1.Color.equals, valueConverter: function (v) { return new color_1.Color(v); } });
exports.colorProperty.register(properties_1.Style);
exports.fontInternalProperty = new properties_1.CssProperty({ name: "fontInternal", cssName: "_fontInternal", defaultValue: font_1.Font.default });
exports.fontInternalProperty.register(properties_1.Style);
exports.fontFamilyProperty = new properties_1.InheritedCssProperty({
    name: "fontFamily", cssName: "font-family", affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontFamily !== newValue) {
            var newFont = currentFont.withFontFamily(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    }
});
exports.fontFamilyProperty.register(properties_1.Style);
exports.fontSizeProperty = new properties_1.InheritedCssProperty({
    name: "fontSize", cssName: "font-size", affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontSize !== newValue) {
            var newFont = currentFont.withFontSize(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    },
    valueConverter: function (v) { return parseFloat(v); }
});
exports.fontSizeProperty.register(properties_1.Style);
exports.fontStyleProperty = new properties_1.InheritedCssProperty({
    name: "fontStyle", cssName: "font-style", affectsLayout: platform_1.isIOS, defaultValue: font_1.FontStyle.NORMAL, valueConverter: font_1.FontStyle.parse, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontStyle !== newValue) {
            var newFont = currentFont.withFontStyle(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    }
});
exports.fontStyleProperty.register(properties_1.Style);
exports.fontWeightProperty = new properties_1.InheritedCssProperty({
    name: "fontWeight", cssName: "font-weight", affectsLayout: platform_1.isIOS, defaultValue: font_1.FontWeight.NORMAL, valueConverter: font_1.FontWeight.parse, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontWeight !== newValue) {
            var newFont = currentFont.withFontWeight(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    }
});
exports.fontWeightProperty.register(properties_1.Style);
var fontProperty = new properties_1.ShorthandProperty({
    name: "font", cssName: "font",
    getter: function () {
        return this.fontStyle + " " + this.fontWeight + " " + this.fontSize + " " + this.fontFamily;
    },
    converter: function (value) {
        if (value === properties_1.unsetValue) {
            return [
                [exports.fontStyleProperty, properties_1.unsetValue],
                [exports.fontWeightProperty, properties_1.unsetValue],
                [exports.fontSizeProperty, properties_1.unsetValue],
                [exports.fontFamilyProperty, properties_1.unsetValue]
            ];
        }
        else {
            var font = font_1.parseFont(value);
            var fontSize = parseFloat(font.fontSize);
            return [
                [exports.fontStyleProperty, font.fontStyle],
                [exports.fontWeightProperty, font.fontWeight],
                [exports.fontSizeProperty, fontSize],
                [exports.fontFamilyProperty, font.fontFamily]
            ];
        }
    }
});
fontProperty.register(properties_1.Style);
var Visibility;
(function (Visibility) {
    Visibility.VISIBLE = "visible";
    Visibility.HIDDEN = "hidden";
    Visibility.COLLAPSE = "collapse";
    Visibility.isValid = properties_1.makeValidator(Visibility.VISIBLE, Visibility.HIDDEN, Visibility.COLLAPSE);
    Visibility.parse = function (value) { return value.toLowerCase() === "collapsed" ? Visibility.COLLAPSE : parseStrict(value); };
    var parseStrict = properties_1.makeParser(Visibility.isValid);
})(Visibility = exports.Visibility || (exports.Visibility = {}));
exports.visibilityProperty = new properties_1.CssProperty({
    name: "visibility", cssName: "visibility", defaultValue: Visibility.VISIBLE, affectsLayout: platform_1.isIOS, valueConverter: Visibility.parse, valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.isCollapsed = (newValue === Visibility.COLLAPSE);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }
});
exports.visibilityProperty.register(properties_1.Style);
exports.androidElevationProperty = new properties_1.CssProperty({ name: "androidElevation", cssName: "android-elevation", valueConverter: parseFloat });
exports.androidElevationProperty.register(properties_1.Style);
exports.androidDynamicElevationOffsetProperty = new properties_1.CssProperty({ name: "androidDynamicElevationOffset", cssName: "android-dynamic-elevation-offset", valueConverter: parseFloat });
exports.androidDynamicElevationOffsetProperty.register(properties_1.Style);
//# sourceMappingURL=style-properties.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/style-scope.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var css_1 = __webpack_require__("../node_modules/tns-core-modules/css/index.js");
var parser_1 = __webpack_require__("../node_modules/tns-core-modules/css/parser.js");
var css_selector_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/css-selector/css-selector.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var applicationCommon = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var keyframeAnimationModule;
function ensureKeyframeAnimationModule() {
    if (!keyframeAnimationModule) {
        keyframeAnimationModule = __webpack_require__("../node_modules/tns-core-modules/ui/animation/keyframe-animation.js");
    }
}
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var module_name_resolver_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js");
var cssAnimationParserModule;
function ensureCssAnimationParserModule() {
    if (!cssAnimationParserModule) {
        cssAnimationParserModule = __webpack_require__("../node_modules/tns-core-modules/ui/styling/css-animation-parser.js");
    }
}
var parser = "rework";
try {
    var appConfig = __webpack_require__("./package.json");
    if (appConfig && appConfig.cssParser === "nativescript") {
        parser = "nativescript";
    }
}
catch (e) {
}
function evaluateCssExpressions(view, property, value) {
    var newValue = properties_1._evaluateCssVariableExpression(view, property, value);
    if (newValue === "unset") {
        return properties_1.unsetValue;
    }
    value = newValue;
    try {
        value = properties_1._evaluateCssCalcExpression(value);
    }
    catch (e) {
        trace_1.write("Failed to evaluate css-calc for property [" + property + "] for expression [" + value + "] to " + view + ". " + e.stack, trace_1.categories.Error, trace_1.messageType.error);
        return properties_1.unsetValue;
    }
    return value;
}
function mergeCssSelectors() {
    applicationCssSelectors = applicationSelectors.slice();
    applicationCssSelectors.push.apply(applicationCssSelectors, applicationAdditionalSelectors);
    applicationCssSelectorVersion++;
}
exports.mergeCssSelectors = mergeCssSelectors;
var applicationCssSelectors = [];
var applicationCssSelectorVersion = 0;
var applicationSelectors = [];
var applicationAdditionalSelectors = [];
var applicationKeyframes = {};
var animationsSymbol = Symbol("animations");
var pattern = /('|")(.*?)\1/;
var CSSSource = (function () {
    function CSSSource(_ast, _url, _file, _keyframes, _source) {
        this._ast = _ast;
        this._url = _url;
        this._file = _file;
        this._keyframes = _keyframes;
        this._source = _source;
        this._selectors = [];
        this.parse();
    }
    CSSSource.fromURI = function (uri, keyframes) {
        var appRelativeUri = CSSSource.pathRelativeToApp(uri);
        var sanitizedModuleName = module_name_sanitizer_1.sanitizeModuleName(appRelativeUri);
        var resolvedModuleName = module_name_resolver_1.resolveModuleName(sanitizedModuleName, "css");
        try {
            var cssOrAst = global.loadModule(resolvedModuleName, true);
            if (cssOrAst) {
                if (typeof cssOrAst === "string") {
                    return CSSSource.fromSource(cssOrAst, keyframes, resolvedModuleName);
                }
                else if (typeof cssOrAst === "object" && cssOrAst.type === "stylesheet" && cssOrAst.stylesheet && cssOrAst.stylesheet.rules) {
                    return CSSSource.fromAST(cssOrAst, keyframes, resolvedModuleName);
                }
                else {
                    return CSSSource.fromSource(cssOrAst.toString(), keyframes, resolvedModuleName);
                }
            }
        }
        catch (e) {
            trace_1.write("Could not load CSS from " + uri + ": " + e, trace_1.categories.Error, trace_1.messageType.error);
        }
        return CSSSource.fromFile(appRelativeUri, keyframes);
    };
    CSSSource.pathRelativeToApp = function (uri) {
        if (!uri.startsWith("/")) {
            return uri;
        }
        var appPath = file_system_1.knownFolders.currentApp().path;
        if (!uri.startsWith(appPath)) {
            trace_1.write(uri + " does not start with " + appPath, trace_1.categories.Error, trace_1.messageType.error);
            return uri;
        }
        var relativeUri = "." + uri.substr(appPath.length);
        return relativeUri;
    };
    CSSSource.fromFile = function (url, keyframes) {
        var cssFileUrl = url.replace(/\..\w+$/, ".css");
        if (cssFileUrl !== url) {
            var cssFile = CSSSource.resolveCSSPathFromURL(cssFileUrl);
            if (cssFile) {
                return new CSSSource(undefined, url, cssFile, keyframes, undefined);
            }
        }
        var file = CSSSource.resolveCSSPathFromURL(url);
        return new CSSSource(undefined, url, file, keyframes, undefined);
    };
    CSSSource.fromFileImport = function (url, keyframes, importSource) {
        var file = CSSSource.resolveCSSPathFromURL(url, importSource);
        return new CSSSource(undefined, url, file, keyframes, undefined);
    };
    CSSSource.resolveCSSPathFromURL = function (url, importSource) {
        var app = file_system_1.knownFolders.currentApp().path;
        var file = resolveFileNameFromUrl(url, app, file_system_1.File.exists, importSource);
        return file;
    };
    CSSSource.fromSource = function (source, keyframes, url) {
        return new CSSSource(undefined, url, undefined, keyframes, source);
    };
    CSSSource.fromAST = function (ast, keyframes, url) {
        return new CSSSource(ast, url, undefined, keyframes, undefined);
    };
    Object.defineProperty(CSSSource.prototype, "selectors", {
        get: function () { return this._selectors; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CSSSource.prototype, "source", {
        get: function () { return this._source; },
        enumerable: true,
        configurable: true
    });
    CSSSource.prototype.load = function () {
        var file = file_system_1.File.fromPath(this._file);
        this._source = file.readTextSync();
    };
    CSSSource.prototype.parse = function () {
        try {
            if (!this._ast) {
                if (!this._source && this._file) {
                    this.load();
                }
                if (this._source && this.source !== "[object Object]") {
                    this.parseCSSAst();
                }
            }
            if (this._ast) {
                this.createSelectors();
            }
            else {
                this._selectors = [];
            }
        }
        catch (e) {
            trace_1.write("Css styling failed: " + e, trace_1.categories.Error, trace_1.messageType.error);
            this._selectors = [];
        }
    };
    CSSSource.prototype.parseCSSAst = function () {
        if (this._source) {
            switch (parser) {
                case "nativescript":
                    var cssparser = new parser_1.CSS3Parser(this._source);
                    var stylesheet = cssparser.parseAStylesheet();
                    var cssNS = new parser_1.CSSNativeScript();
                    this._ast = cssNS.parseStylesheet(stylesheet);
                    return;
                case "rework":
                    this._ast = css_1.parse(this._source, { source: this._file });
                    return;
            }
        }
    };
    CSSSource.prototype.createSelectors = function () {
        if (this._ast) {
            this._selectors = __spreadArrays(this.createSelectorsFromImports(), this.createSelectorsFromSyntaxTree());
        }
    };
    CSSSource.prototype.createSelectorsFromImports = function () {
        var _this = this;
        var imports = this._ast["stylesheet"]["rules"].filter(function (r) { return r.type === "import"; });
        var urlFromImportObject = function (importObject) {
            var importItem = importObject["import"];
            var urlMatch = importItem && importItem.match(pattern);
            return urlMatch && urlMatch[2];
        };
        var sourceFromImportObject = function (importObject) {
            return importObject["position"] && importObject["position"]["source"];
        };
        var toUrlSourcePair = function (importObject) { return ({
            url: urlFromImportObject(importObject),
            source: sourceFromImportObject(importObject),
        }); };
        var getCssFile = function (_a) {
            var url = _a.url, source = _a.source;
            return source ?
                CSSSource.fromFileImport(url, _this._keyframes, source) :
                CSSSource.fromURI(url, _this._keyframes);
        };
        var cssFiles = imports
            .map(toUrlSourcePair)
            .filter(function (_a) {
            var url = _a.url;
            return !!url;
        })
            .map(getCssFile);
        var selectors = cssFiles.map(function (file) { return (file && file.selectors) || []; });
        return selectors.reduce(function (acc, val) { return acc.concat(val); }, []);
    };
    CSSSource.prototype.createSelectorsFromSyntaxTree = function () {
        var _this = this;
        var nodes = this._ast.stylesheet.rules;
        nodes.filter(isKeyframe).forEach(function (node) { return _this._keyframes[node.name] = node; });
        var rulesets = css_selector_1.fromAstNodes(nodes);
        if (rulesets && rulesets.length) {
            ensureCssAnimationParserModule();
            rulesets.forEach(function (rule) {
                rule[animationsSymbol] = cssAnimationParserModule.CssAnimationParser
                    .keyframeAnimationsFromCSSDeclarations(rule.declarations);
            });
        }
        return rulesets;
    };
    CSSSource.prototype.toString = function () {
        return this._file || this._url || "(in-memory)";
    };
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "load", null);
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "parse", null);
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "parseCSSAst", null);
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "createSelectors", null);
    __decorate([
        profiling_1.profile
    ], CSSSource, "resolveCSSPathFromURL", null);
    return CSSSource;
}());
function removeTaggedAdditionalCSS(tag) {
    var changed = false;
    for (var i = 0; i < applicationAdditionalSelectors.length; i++) {
        if (applicationAdditionalSelectors[i].tag === tag) {
            applicationAdditionalSelectors.splice(i, 1);
            i--;
            changed = true;
        }
    }
    if (changed) {
        mergeCssSelectors();
    }
    return changed;
}
exports.removeTaggedAdditionalCSS = removeTaggedAdditionalCSS;
function addTaggedAdditionalCSS(cssText, tag) {
    var parsed = CSSSource.fromSource(cssText, applicationKeyframes, undefined).selectors;
    var changed = false;
    if (parsed && parsed.length) {
        changed = true;
        if (tag != null) {
            for (var i = 0; i < parsed.length; i++) {
                parsed[i].tag = tag;
            }
        }
        applicationAdditionalSelectors.push.apply(applicationAdditionalSelectors, parsed);
        mergeCssSelectors();
    }
    return changed;
}
exports.addTaggedAdditionalCSS = addTaggedAdditionalCSS;
var onCssChanged = profiling_1.profile("\"style-scope\".onCssChanged", function (args) {
    if (args.cssText) {
        var parsed = CSSSource.fromSource(args.cssText, applicationKeyframes, args.cssFile).selectors;
        if (parsed) {
            applicationAdditionalSelectors.push.apply(applicationAdditionalSelectors, parsed);
            mergeCssSelectors();
        }
    }
    else if (args.cssFile) {
        loadCss(args.cssFile);
    }
});
function onLiveSync(args) {
    loadCss(applicationCommon.getCssFileName());
}
var loadCss = profiling_1.profile("\"style-scope\".loadCss", function (cssModule) {
    if (!cssModule) {
        return undefined;
    }
    if (cssModule.startsWith("./")) {
        cssModule = cssModule.substr(2);
    }
    var result = CSSSource.fromURI(cssModule, applicationKeyframes).selectors;
    if (result.length > 0) {
        applicationSelectors = result;
        mergeCssSelectors();
    }
});
applicationCommon.on("cssChanged", onCssChanged);
applicationCommon.on("livesync", onLiveSync);
exports.loadAppCSS = profiling_1.profile("\"style-scope\".loadAppCSS", function (args) {
    loadCss(args.cssFile);
    applicationCommon.off("loadAppCss", exports.loadAppCSS);
});
if (applicationCommon.hasLaunched()) {
    exports.loadAppCSS({ eventName: "loadAppCss", object: applicationCommon, cssFile: applicationCommon.getCssFileName() });
}
else {
    applicationCommon.on("loadAppCss", exports.loadAppCSS);
}
var CssState = (function () {
    function CssState(viewRef) {
        var _this = this;
        this.viewRef = viewRef;
        this._onDynamicStateChangeHandler = function () { return _this.updateDynamicState(); };
    }
    CssState.prototype.onChange = function () {
        var view = this.viewRef.get();
        if (view && view.isLoaded) {
            this.unsubscribeFromDynamicUpdates();
            this.updateMatch();
            this.subscribeForDynamicUpdates();
            this.updateDynamicState();
        }
        else {
            this._matchInvalid = true;
        }
    };
    CssState.prototype.isSelectorsLatestVersionApplied = function () {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("isSelectorsLatestVersionApplied returns default value \"false\" because \"this.viewRef\" cleared.", trace_1.categories.Style, trace_1.messageType.warn);
            return false;
        }
        return this.viewRef.get()._styleScope._getSelectorsVersion() === this._appliedSelectorsVersion;
    };
    CssState.prototype.onLoaded = function () {
        if (this._matchInvalid) {
            this.updateMatch();
        }
        this.subscribeForDynamicUpdates();
        this.updateDynamicState();
    };
    CssState.prototype.onUnloaded = function () {
        this.unsubscribeFromDynamicUpdates();
    };
    CssState.prototype.updateMatch = function () {
        var view = this.viewRef.get();
        if (view && view._styleScope) {
            this._match = view._styleScope.matchSelectors(view);
            this._appliedSelectorsVersion = view._styleScope._getSelectorsVersion();
        }
        else {
            this._match = CssState.emptyMatch;
        }
        this._matchInvalid = false;
    };
    CssState.prototype.updateDynamicState = function () {
        var _this = this;
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("updateDynamicState not executed to view because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
            return;
        }
        var matchingSelectors = this._match.selectors.filter(function (sel) { return sel.dynamic ? sel.match(view) : true; });
        view._batchUpdate(function () {
            _this.stopKeyframeAnimations();
            _this.setPropertyValues(matchingSelectors);
            _this.playKeyframeAnimations(matchingSelectors);
        });
    };
    CssState.prototype.playKeyframeAnimations = function (matchingSelectors) {
        var animations = [];
        matchingSelectors.forEach(function (selector) {
            var ruleAnimations = selector.ruleset[animationsSymbol];
            if (ruleAnimations) {
                ensureKeyframeAnimationModule();
                for (var _i = 0, ruleAnimations_1 = ruleAnimations; _i < ruleAnimations_1.length; _i++) {
                    var animationInfo = ruleAnimations_1[_i];
                    var animation = keyframeAnimationModule.KeyframeAnimation.keyframeAnimationFromInfo(animationInfo);
                    if (animation) {
                        animations.push(animation);
                    }
                }
            }
        });
        if (this._playsKeyframeAnimations = animations.length > 0) {
            var view_1 = this.viewRef.get();
            if (!view_1) {
                trace_1.write("KeyframeAnimations cannot play because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                return;
            }
            animations.map(function (animation) { return animation.play(view_1); });
            Object.freeze(animations);
            this._appliedAnimations = animations;
        }
    };
    CssState.prototype.stopKeyframeAnimations = function () {
        if (!this._playsKeyframeAnimations) {
            return;
        }
        this._appliedAnimations
            .filter(function (animation) { return animation.isPlaying; })
            .forEach(function (animation) { return animation.cancel(); });
        this._appliedAnimations = CssState.emptyAnimationArray;
        var view = this.viewRef.get();
        if (view) {
            view.style["keyframe:rotate"] = properties_1.unsetValue;
            view.style["keyframe:scaleX"] = properties_1.unsetValue;
            view.style["keyframe:scaleY"] = properties_1.unsetValue;
            view.style["keyframe:translateX"] = properties_1.unsetValue;
            view.style["keyframe:translateY"] = properties_1.unsetValue;
            view.style["keyframe:backgroundColor"] = properties_1.unsetValue;
            view.style["keyframe:opacity"] = properties_1.unsetValue;
        }
        else {
            trace_1.write("KeyframeAnimations cannot be stopped because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
        }
        this._playsKeyframeAnimations = false;
    };
    CssState.prototype.setPropertyValues = function (matchingSelectors) {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write(matchingSelectors + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
            return;
        }
        var newPropertyValues = new view.style.PropertyBag();
        matchingSelectors.forEach(function (selector) {
            return selector.ruleset.declarations.forEach(function (declaration) {
                return newPropertyValues[declaration.property] = declaration.value;
            });
        });
        var oldProperties = this._appliedPropertyValues;
        var isCssExpressionInUse = false;
        view.style.resetScopedCssVariables();
        for (var property in newPropertyValues) {
            var value = newPropertyValues[property];
            if (properties_1.isCssVariable(property)) {
                view.style.setScopedCssVariable(property, value);
                delete newPropertyValues[property];
                continue;
            }
            isCssExpressionInUse = isCssExpressionInUse || properties_1.isCssVariableExpression(value) || properties_1.isCssCalcExpression(value);
        }
        if (isCssExpressionInUse) {
            for (var property in newPropertyValues) {
                var value = evaluateCssExpressions(view, property, newPropertyValues[property]);
                if (value === properties_1.unsetValue) {
                    delete newPropertyValues[property];
                    continue;
                }
                newPropertyValues[property] = value;
            }
        }
        Object.freeze(newPropertyValues);
        for (var property in oldProperties) {
            if (!(property in newPropertyValues)) {
                if (property in view.style) {
                    view.style["css:" + property] = properties_1.unsetValue;
                }
                else {
                }
            }
        }
        for (var property in newPropertyValues) {
            if (oldProperties && property in oldProperties && oldProperties[property] === newPropertyValues[property]) {
                continue;
            }
            var value = newPropertyValues[property];
            try {
                if (property in view.style) {
                    view.style["css:" + property] = value;
                }
                else {
                    var camelCasedProperty = property.replace(/-([a-z])/g, function (g) { return g[1].toUpperCase(); });
                    view[camelCasedProperty] = value;
                }
            }
            catch (e) {
                trace_1.write("Failed to apply property [" + property + "] with value [" + value + "] to " + view + ". " + e.stack, trace_1.categories.Error, trace_1.messageType.error);
            }
        }
        this._appliedPropertyValues = newPropertyValues;
    };
    CssState.prototype.subscribeForDynamicUpdates = function () {
        var _this = this;
        var changeMap = this._match.changeMap;
        changeMap.forEach(function (changes, view) {
            if (changes.attributes) {
                changes.attributes.forEach(function (attribute) {
                    view.addEventListener(attribute + "Change", _this._onDynamicStateChangeHandler);
                });
            }
            if (changes.pseudoClasses) {
                changes.pseudoClasses.forEach(function (pseudoClass) {
                    var eventName = ":" + pseudoClass;
                    view.addEventListener(":" + pseudoClass, _this._onDynamicStateChangeHandler);
                    if (view[eventName]) {
                        view[eventName](+1);
                    }
                });
            }
        });
        this._appliedChangeMap = changeMap;
    };
    CssState.prototype.unsubscribeFromDynamicUpdates = function () {
        var _this = this;
        this._appliedChangeMap.forEach(function (changes, view) {
            if (changes.attributes) {
                changes.attributes.forEach(function (attribute) {
                    view.removeEventListener(attribute + "Change", _this._onDynamicStateChangeHandler);
                });
            }
            if (changes.pseudoClasses) {
                changes.pseudoClasses.forEach(function (pseudoClass) {
                    var eventName = ":" + pseudoClass;
                    view.removeEventListener(eventName, _this._onDynamicStateChangeHandler);
                    if (view[eventName]) {
                        view[eventName](-1);
                    }
                });
            }
        });
        this._appliedChangeMap = CssState.emptyChangeMap;
    };
    CssState.prototype.toString = function () {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("toString() of CssState cannot execute correctly because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
            return "";
        }
        return view + "._cssState";
    };
    CssState.emptyChangeMap = Object.freeze(new Map());
    CssState.emptyPropertyBag = Object.freeze({});
    CssState.emptyAnimationArray = Object.freeze([]);
    CssState.emptyMatch = { selectors: [], changeMap: new Map() };
    __decorate([
        profiling_1.profile
    ], CssState.prototype, "updateMatch", null);
    __decorate([
        profiling_1.profile
    ], CssState.prototype, "updateDynamicState", null);
    return CssState;
}());
exports.CssState = CssState;
CssState.prototype._appliedChangeMap = CssState.emptyChangeMap;
CssState.prototype._appliedPropertyValues = CssState.emptyPropertyBag;
CssState.prototype._appliedAnimations = CssState.emptyAnimationArray;
CssState.prototype._matchInvalid = true;
var StyleScope = (function () {
    function StyleScope() {
        this._css = "";
        this._localCssSelectors = [];
        this._localCssSelectorVersion = 0;
        this._localCssSelectorsAppliedVersion = 0;
        this._applicationCssSelectorsAppliedVersion = 0;
        this._keyframes = new Map();
    }
    Object.defineProperty(StyleScope.prototype, "css", {
        get: function () {
            return this._css;
        },
        set: function (value) {
            this.setCss(value);
        },
        enumerable: true,
        configurable: true
    });
    StyleScope.prototype.addCss = function (cssString, cssFileName) {
        this.appendCss(cssString, cssFileName);
    };
    StyleScope.prototype.addCssFile = function (cssFileName) {
        this.appendCss(null, cssFileName);
    };
    StyleScope.prototype.changeCssFile = function (cssFileName) {
        if (!cssFileName) {
            return;
        }
        var cssSelectors = CSSSource.fromURI(cssFileName, this._keyframes);
        this._css = cssSelectors.source;
        this._localCssSelectors = cssSelectors.selectors;
        this._localCssSelectorVersion++;
        this.ensureSelectors();
    };
    StyleScope.prototype.setCss = function (cssString, cssFileName) {
        this._css = cssString;
        var cssFile = CSSSource.fromSource(cssString, this._keyframes, cssFileName);
        this._localCssSelectors = cssFile.selectors;
        this._localCssSelectorVersion++;
        this.ensureSelectors();
    };
    StyleScope.prototype.appendCss = function (cssString, cssFileName) {
        if (!cssString && !cssFileName) {
            return;
        }
        var parsedCssSelectors = cssString ? CSSSource.fromSource(cssString, this._keyframes, cssFileName) : CSSSource.fromURI(cssFileName, this._keyframes);
        this._css = this._css + parsedCssSelectors.source;
        this._localCssSelectors.push.apply(this._localCssSelectors, parsedCssSelectors.selectors);
        this._localCssSelectorVersion++;
        this.ensureSelectors();
    };
    StyleScope.prototype.getKeyframeAnimationWithName = function (animationName) {
        var cssKeyframes = this._keyframes[animationName];
        if (!cssKeyframes) {
            return;
        }
        ensureKeyframeAnimationModule();
        var animation = new keyframeAnimationModule.KeyframeAnimationInfo();
        ensureCssAnimationParserModule();
        animation.keyframes = cssAnimationParserModule
            .CssAnimationParser.keyframesArrayFromCSS(cssKeyframes.keyframes);
        return animation;
    };
    StyleScope.prototype.ensureSelectors = function () {
        if (!this.isApplicationCssSelectorsLatestVersionApplied() ||
            !this.isLocalCssSelectorsLatestVersionApplied() ||
            !this._mergedCssSelectors) {
            this._createSelectors();
        }
        return this._getSelectorsVersion();
    };
    StyleScope.prototype.isApplicationCssSelectorsLatestVersionApplied = function () {
        return this._applicationCssSelectorsAppliedVersion === applicationCssSelectorVersion;
    };
    StyleScope.prototype.isLocalCssSelectorsLatestVersionApplied = function () {
        return this._localCssSelectorsAppliedVersion === this._localCssSelectorVersion;
    };
    StyleScope.prototype._createSelectors = function () {
        var toMerge = [];
        toMerge.push(applicationCssSelectors);
        this._applicationCssSelectorsAppliedVersion = applicationCssSelectorVersion;
        toMerge.push(this._localCssSelectors);
        this._localCssSelectorsAppliedVersion = this._localCssSelectorVersion;
        for (var keyframe in applicationKeyframes) {
            this._keyframes[keyframe] = applicationKeyframes[keyframe];
        }
        if (toMerge.length > 0) {
            this._mergedCssSelectors = toMerge.filter(function (m) { return !!m; }).reduce(function (merged, next) { return merged.concat(next); }, []);
            this._applyKeyframesOnSelectors();
            this._selectors = new css_selector_1.SelectorsMap(this._mergedCssSelectors);
        }
    };
    StyleScope.prototype.matchSelectors = function (view) {
        this.ensureSelectors();
        return this._selectors.query(view);
    };
    StyleScope.prototype.query = function (node) {
        this.ensureSelectors();
        return this._selectors.query(node).selectors;
    };
    StyleScope.prototype._getSelectorsVersion = function () {
        return 100000 * this._applicationCssSelectorsAppliedVersion + this._localCssSelectorsAppliedVersion;
    };
    StyleScope.prototype._applyKeyframesOnSelectors = function () {
        for (var i = this._mergedCssSelectors.length - 1; i >= 0; i--) {
            var ruleset = this._mergedCssSelectors[i];
            var animations = ruleset[animationsSymbol];
            if (animations !== undefined && animations.length) {
                ensureCssAnimationParserModule();
                for (var _i = 0, animations_1 = animations; _i < animations_1.length; _i++) {
                    var animation = animations_1[_i];
                    var cssKeyframe = this._keyframes[animation.name];
                    if (cssKeyframe !== undefined) {
                        animation.keyframes = cssAnimationParserModule
                            .CssAnimationParser.keyframesArrayFromCSS(cssKeyframe.keyframes);
                    }
                }
            }
        }
    };
    StyleScope.prototype.getAnimations = function (ruleset) {
        return ruleset[animationsSymbol];
    };
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "setCss", null);
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "appendCss", null);
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "_createSelectors", null);
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "matchSelectors", null);
    return StyleScope;
}());
exports.StyleScope = StyleScope;
function resolveFileNameFromUrl(url, appDirectory, fileExists, importSource) {
    var fileName = typeof url === "string" ? url.trim() : "";
    if (fileName.indexOf("~/") === 0) {
        fileName = fileName.replace("~/", "");
    }
    var isAbsolutePath = fileName.indexOf("/") === 0;
    var absolutePath = isAbsolutePath ? fileName : file_system_1.path.join(appDirectory, fileName);
    if (fileExists(absolutePath)) {
        return absolutePath;
    }
    if (!isAbsolutePath) {
        if (fileName[0] === "~" && fileName[1] !== "/" && fileName[1] !== "\"") {
            fileName = fileName.substr(1);
        }
        if (importSource) {
            var importFile = resolveFilePathFromImport(importSource, fileName);
            if (fileExists(importFile)) {
                return importFile;
            }
        }
        var external_1 = file_system_1.path.join(appDirectory, "tns_modules", fileName);
        if (fileExists(external_1)) {
            return external_1;
        }
    }
    return null;
}
exports.resolveFileNameFromUrl = resolveFileNameFromUrl;
function resolveFilePathFromImport(importSource, fileName) {
    var importSourceParts = importSource.split(file_system_1.path.separator);
    var fileNameParts = fileName.split(file_system_1.path.separator)
        .filter(function (p) { return !isCurrentDirectory(p); });
    importSourceParts.pop();
    fileNameParts.forEach(function (p) { return isParentDirectory(p) ? importSourceParts.pop() : importSourceParts.push(p); });
    return importSourceParts.join(file_system_1.path.separator);
}
exports.applyInlineStyle = profiling_1.profile(function applyInlineStyle(view, styleStr) {
    var localStyle = "local { " + styleStr + " }";
    var inlineRuleSet = CSSSource.fromSource(localStyle, new Map()).selectors;
    view.style.resetUnscopedCssVariables();
    inlineRuleSet[0].declarations.forEach(function (d) {
        var property = d.property;
        if (properties_1.isCssVariable(property)) {
            view.style.setUnscopedCssVariable(property, d.value);
        }
    });
    inlineRuleSet[0].declarations.forEach(function (d) {
        var property = d.property;
        try {
            if (properties_1.isCssVariable(property)) {
                return;
            }
            var value = evaluateCssExpressions(view, property, d.value);
            if (property in view.style) {
                view.style[property] = value;
            }
            else {
                view[property] = value;
            }
        }
        catch (e) {
            trace_1.write("Failed to apply property [" + d.property + "] with value [" + d.value + "] to " + view + ". " + e, trace_1.categories.Error, trace_1.messageType.error);
        }
    });
    view._onCssStateChange();
});
function isCurrentDirectory(uriPart) {
    return uriPart === ".";
}
function isParentDirectory(uriPart) {
    return uriPart === "..";
}
function isKeyframe(node) {
    return node.type === "keyframes";
}
//# sourceMappingURL=style-scope.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/style/style.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var Style = (function (_super) {
    __extends(Style, _super);
    function Style(ownerView) {
        var _this = _super.call(this) || this;
        _this.unscopedCssVariables = new Map();
        _this.scopedCssVariables = new Map();
        if (ownerView.constructor.toString().indexOf("[native code]") !== -1) {
            _this.viewRef = ownerView;
        }
        else {
            _this.viewRef = new WeakRef(ownerView);
        }
        return _this;
    }
    Style.prototype.setScopedCssVariable = function (varName, value) {
        this.scopedCssVariables.set(varName, value);
    };
    Style.prototype.setUnscopedCssVariable = function (varName, value) {
        this.unscopedCssVariables.set(varName, value);
    };
    Style.prototype.getCssVariable = function (varName) {
        var view = this.view;
        if (!view) {
            return null;
        }
        if (this.unscopedCssVariables.has(varName)) {
            return this.unscopedCssVariables.get(varName);
        }
        if (this.scopedCssVariables.has(varName)) {
            return this.scopedCssVariables.get(varName);
        }
        if (!view.parent || !view.parent.style) {
            return null;
        }
        return view.parent.style.getCssVariable(varName);
    };
    Style.prototype.resetScopedCssVariables = function () {
        this.scopedCssVariables.clear();
    };
    Style.prototype.resetUnscopedCssVariables = function () {
        this.unscopedCssVariables.clear();
    };
    Style.prototype.toString = function () {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("toString() of Style cannot execute correctly because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
            return "";
        }
        return view + ".style";
    };
    Object.defineProperty(Style.prototype, "view", {
        get: function () {
            if (this.viewRef) {
                return this.viewRef.get();
            }
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    return Style;
}(observable_1.Observable));
exports.Style = Style;
Style.prototype.PropertyBag = (function () {
    function class_1() {
    }
    return class_1;
}());
//# sourceMappingURL=style.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/switch/switch-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var SwitchBase = (function (_super) {
    __extends(SwitchBase, _super);
    function SwitchBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SwitchBase.prototype._onCheckedPropertyChanged = function (newValue) {
    };
    SwitchBase.checkedChangeEvent = "checkedChange";
    SwitchBase = __decorate([
        view_1.CSSType("Switch")
    ], SwitchBase);
    return SwitchBase;
}(view_1.View));
exports.SwitchBase = SwitchBase;
SwitchBase.prototype.recycleNativeView = "auto";
function onCheckedPropertyChanged(switchBase, oldValue, newValue) {
    switchBase._onCheckedPropertyChanged(newValue);
}
exports.checkedProperty = new view_1.Property({ name: "checked", defaultValue: false, valueConverter: view_1.booleanConverter, valueChanged: onCheckedPropertyChanged });
exports.checkedProperty.register(SwitchBase);
exports.offBackgroundColorProperty = new view_1.Property({ name: "offBackgroundColor", equalityComparer: color_1.Color.equals, valueConverter: function (v) { return new color_1.Color(v); } });
exports.offBackgroundColorProperty.register(SwitchBase);
//# sourceMappingURL=switch-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/switch/switch.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var switch_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/switch/switch-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/switch/switch-common.js"));
var CheckedChangeListener;
function initializeCheckedChangeListener() {
    if (CheckedChangeListener) {
        return;
    }
    var CheckedChangeListenerImpl = (function (_super) {
        __extends(CheckedChangeListenerImpl, _super);
        function CheckedChangeListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        CheckedChangeListenerImpl.prototype.onCheckedChanged = function (buttonView, isChecked) {
            var owner = this.owner;
            switch_common_1.checkedProperty.nativeValueChange(owner, isChecked);
        };
        CheckedChangeListenerImpl = __decorate([
            Interfaces([android.widget.CompoundButton.OnCheckedChangeListener])
        ], CheckedChangeListenerImpl);
        return CheckedChangeListenerImpl;
    }(java.lang.Object));
    CheckedChangeListener = CheckedChangeListenerImpl;
}
var Switch = (function (_super) {
    __extends(Switch, _super);
    function Switch() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Switch.prototype.createNativeView = function () {
        return new android.widget.Switch(this._context);
    };
    Switch.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        initializeCheckedChangeListener();
        var listener = new CheckedChangeListener(this);
        nativeView.setOnCheckedChangeListener(listener);
        nativeView.listener = listener;
    };
    Switch.prototype.disposeNativeView = function () {
        var nativeView = this.nativeViewProtected;
        nativeView.listener.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Switch.prototype.setNativeBackgroundColor = function (value) {
        if (value instanceof switch_common_1.Color) {
            this.nativeViewProtected.getTrackDrawable().setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
        }
        else {
            this.nativeViewProtected.getTrackDrawable().clearColorFilter();
        }
    };
    Switch.prototype._onCheckedPropertyChanged = function (newValue) {
        if (this.offBackgroundColor) {
            if (!newValue) {
                this.setNativeBackgroundColor(this.offBackgroundColor);
            }
            else {
                this.setNativeBackgroundColor(this.backgroundColor);
            }
        }
    };
    Switch.prototype[switch_common_1.checkedProperty.getDefault] = function () {
        return false;
    };
    Switch.prototype[switch_common_1.checkedProperty.setNative] = function (value) {
        this.nativeViewProtected.setChecked(value);
    };
    Switch.prototype[switch_common_1.colorProperty.getDefault] = function () {
        return -1;
    };
    Switch.prototype[switch_common_1.colorProperty.setNative] = function (value) {
        if (value instanceof switch_common_1.Color) {
            this.nativeViewProtected.getThumbDrawable().setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
        }
        else {
            this.nativeViewProtected.getThumbDrawable().clearColorFilter();
        }
    };
    Switch.prototype[switch_common_1.backgroundColorProperty.getDefault] = function () {
        return -1;
    };
    Switch.prototype[switch_common_1.backgroundColorProperty.setNative] = function (value) {
        if (!this.offBackgroundColor || this.checked) {
            this.setNativeBackgroundColor(value);
        }
    };
    Switch.prototype[switch_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    Switch.prototype[switch_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    Switch.prototype[switch_common_1.offBackgroundColorProperty.getDefault] = function () {
        return -1;
    };
    Switch.prototype[switch_common_1.offBackgroundColorProperty.setNative] = function (value) {
        if (!this.checked) {
            this.setNativeBackgroundColor(value);
        }
    };
    return Switch;
}(switch_common_1.SwitchBase));
exports.Switch = Switch;
//# sourceMappingURL=switch.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var content_view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js");
exports.traceCategory = "TabView";
var TabContentItemBase = (function (_super) {
    __extends(TabContentItemBase, _super);
    function TabContentItemBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabContentItemBase.prototype.eachChild = function (callback) {
        if (this.content) {
            callback(this.content);
        }
    };
    TabContentItemBase.prototype.loadView = function (view) {
        var tabView = this.parent;
        if (tabView && tabView.items) {
            if (this.canBeLoaded) {
                _super.prototype.loadView.call(this, view);
            }
        }
    };
    TabContentItemBase = __decorate([
        view_1.CSSType("TabContentItem")
    ], TabContentItemBase);
    return TabContentItemBase;
}(content_view_1.ContentView));
exports.TabContentItemBase = TabContentItemBase;
//# sourceMappingURL=tab-content-item-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var grid_layout_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout.js");
var tab_content_item_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item-common.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item-common.js"));
var TabContentItem = (function (_super) {
    __extends(TabContentItem, _super);
    function TabContentItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(TabContentItem.prototype, "_hasFragments", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    TabContentItem.prototype.createNativeView = function () {
        var layout = new org.nativescript.widgets.GridLayout(this._context);
        layout.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
        return layout;
    };
    TabContentItem.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
    };
    TabContentItem.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        if (this.nativeViewProtected && child.nativeViewProtected) {
            grid_layout_1.GridLayout.setRow(child, 0);
        }
        return _super.prototype._addViewToNativeVisualTree.call(this, child, atIndex);
    };
    TabContentItem.prototype.disposeNativeView = function () {
        _super.prototype.disposeNativeView.call(this);
        this.canBeLoaded = false;
    };
    TabContentItem.prototype._getChildFragmentManager = function () {
        var tabView = this.parent;
        var tabFragment = null;
        var fragmentManager = tabView._getFragmentManager();
        if (typeof this.index === "undefined") {
            view_1.traceWrite("Current TabContentItem index is not set", tab_content_item_common_1.traceCategory, view_1.traceMessageType.error);
        }
        for (var _i = 0, _a = fragmentManager.getFragments().toArray(); _i < _a.length; _i++) {
            var fragment = _a[_i];
            if (fragment.index === this.index) {
                tabFragment = fragment;
                break;
            }
        }
        if (!tabFragment) {
            return tabView._getRootFragmentManager();
        }
        return tabFragment.getChildFragmentManager();
    };
    return TabContentItem;
}(tab_content_item_common_1.TabContentItemBase));
exports.TabContentItem = TabContentItem;
//# sourceMappingURL=tab-content-item.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var knownCollections;
(function (knownCollections) {
    knownCollections.items = "items";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var TabNavigationBase = (function (_super) {
    __extends(TabNavigationBase, _super);
    function TabNavigationBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabNavigationBase.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "items") {
            this.items = value;
        }
    };
    TabNavigationBase.prototype._addChildFromBuilder = function (name, value) {
        if (name === "TabContentItem") {
            if (!this.items) {
                this.items = new Array();
            }
            this.items.push(value);
            this._addView(value);
        }
        else if (name === "TabStrip") {
            this.tabStrip = value;
        }
    };
    Object.defineProperty(TabNavigationBase.prototype, "_selectedView", {
        get: function () {
            var selectedIndex = this.selectedIndex;
            return selectedIndex > -1 ? this.items[selectedIndex].content : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabNavigationBase.prototype, "_childrenCount", {
        get: function () {
            var items = this.items;
            return items ? items.length : 0;
        },
        enumerable: true,
        configurable: true
    });
    TabNavigationBase.prototype.eachChild = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item);
            });
        }
        var tabStrip = this.tabStrip;
        if (tabStrip) {
            callback(tabStrip);
        }
    };
    TabNavigationBase.prototype.eachChildView = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item.content);
            });
        }
    };
    TabNavigationBase.prototype.onItemsChanged = function (oldItems, newItems) {
        var _this = this;
        if (oldItems) {
            oldItems.forEach(function (item) { return _this._removeView(item); });
        }
        if (newItems) {
            newItems.forEach(function (item) {
                if (!item.content) {
                    throw new Error("TabContentItem must have a content (view).");
                }
                _this._addView(item);
            });
        }
    };
    TabNavigationBase.prototype.onTabStripChanged = function (oldTabStrip, newTabStrip) {
        if (oldTabStrip && oldTabStrip.parent) {
            this._removeView(oldTabStrip);
        }
        if (newTabStrip) {
            this._addView(newTabStrip);
        }
    };
    TabNavigationBase.prototype.onSelectedIndexChanged = function (oldIndex, newIndex) {
        this.notify({ eventName: TabNavigationBase.selectedIndexChangedEvent, object: this, oldIndex: oldIndex, newIndex: newIndex });
    };
    TabNavigationBase.prototype.getTabBarBackgroundColor = function () {
        return null;
    };
    TabNavigationBase.prototype.setTabBarBackgroundColor = function (value) {
    };
    TabNavigationBase.prototype.getTabBarFontInternal = function () {
        return null;
    };
    TabNavigationBase.prototype.setTabBarFontInternal = function (value) {
    };
    TabNavigationBase.prototype.getTabBarTextTransform = function () {
        return null;
    };
    TabNavigationBase.prototype.setTabBarTextTransform = function (value) {
    };
    TabNavigationBase.prototype.getTabBarHighlightColor = function () {
    };
    TabNavigationBase.prototype.setTabBarHighlightColor = function (value) {
    };
    TabNavigationBase.prototype.getTabBarColor = function () {
        return null;
    };
    TabNavigationBase.prototype.setTabBarColor = function (value) {
    };
    TabNavigationBase.prototype.setTabBarItemTitle = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemBackgroundColor = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemBackgroundColor = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemColor = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemColor = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.setTabBarIconColor = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemFontSize = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemFontSize = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemFontInternal = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemFontInternal = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemTextTransform = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemTextTransform = function (tabStripItem, value) {
    };
    TabNavigationBase.selectedIndexChangedEvent = "selectedIndexChanged";
    return TabNavigationBase;
}(view_1.View));
exports.TabNavigationBase = TabNavigationBase;
var MIN_ICON_SIZE = 24;
var MAX_ICON_WIDTH = 31;
var MAX_ICON_HEIGHT = 28;
function getIconSpecSize(size) {
    var inWidth = size.width;
    var inHeight = size.height;
    var outWidth = 0;
    var outHeight = 0;
    if (inWidth < inHeight) {
        outWidth = MIN_ICON_SIZE;
        outHeight = (inHeight * MIN_ICON_SIZE) / inWidth;
        if (outHeight > MAX_ICON_HEIGHT) {
            outHeight = MAX_ICON_HEIGHT;
            outWidth = (inWidth * MAX_ICON_HEIGHT) / inHeight;
        }
    }
    else {
        outHeight = MIN_ICON_SIZE;
        outWidth = (inWidth * MIN_ICON_SIZE) / inHeight;
        if (outWidth > MAX_ICON_WIDTH) {
            outWidth = MAX_ICON_WIDTH;
            outHeight = (inHeight * MAX_ICON_WIDTH) / inWidth;
        }
    }
    return { width: outWidth, height: outHeight };
}
exports.getIconSpecSize = getIconSpecSize;
exports.selectedIndexProperty = new view_1.CoercibleProperty({
    name: "selectedIndex", defaultValue: -1, affectsLayout: view_1.isIOS,
    valueChanged: function (target, oldValue, newValue) {
        target.onSelectedIndexChanged(oldValue, newValue);
    },
    coerceValue: function (target, value) {
        var items = target.items;
        if (items) {
            var max = items.length - 1;
            if (value < 0) {
                value = 0;
            }
            if (value > max) {
                value = max;
            }
        }
        else {
            value = -1;
        }
        return value;
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.selectedIndexProperty.register(TabNavigationBase);
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        target.onItemsChanged(oldValue, newValue);
    }
});
exports.itemsProperty.register(TabNavigationBase);
exports.tabStripProperty = new view_1.Property({
    name: "tabStrip", valueChanged: function (target, oldValue, newValue) {
        target.onTabStripChanged(oldValue, newValue);
    }
});
exports.tabStripProperty.register(TabNavigationBase);
//# sourceMappingURL=tab-navigation-base.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var image_1 = __webpack_require__("../node_modules/tns-core-modules/ui/image/image.js");
var label_1 = __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var tabs_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tabs/tabs.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
exports.traceCategory = "TabView";
var TabStripItem = (function (_super) {
    __extends(TabStripItem, _super);
    function TabStripItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabStripItem_1 = TabStripItem;
    Object.defineProperty(TabStripItem.prototype, "title", {
        get: function () {
            if (this.isLoaded) {
                return this.label.text;
            }
            return this._title;
        },
        set: function (value) {
            this._title = value;
            if (this.isLoaded) {
                this.label.text = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabStripItem.prototype, "iconSource", {
        get: function () {
            if (this.isLoaded) {
                return this.image.src;
            }
            return this._iconSource;
        },
        set: function (value) {
            this._iconSource = value;
            if (this.isLoaded) {
                this.image.src = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    TabStripItem.prototype.onLoaded = function () {
        var _this = this;
        if (!this.image) {
            var image = new image_1.Image();
            image.src = this.iconSource;
            this.image = image;
            this._addView(this.image);
        }
        if (!this.label) {
            var label = new label_1.Label();
            label.text = this.title;
            this.label = label;
            this._addView(this.label);
        }
        _super.prototype.onLoaded.call(this);
        this._labelColorHandler = this._labelColorHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarItemColor(_this, args.value);
        });
        this.label.style.on("colorChange", this._labelColorHandler);
        this._labelFontHandler = this._labelFontHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarItemFontInternal(_this, args.value);
        });
        this.label.style.on("fontInternalChange", this._labelFontHandler);
        this._labelTextTransformHandler = this._labelTextTransformHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarItemTextTransform(_this, args.value);
        });
        this.label.style.on("textTransformChange", this._labelTextTransformHandler);
        this._labelTextHandler = this._labelTextHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarItemTitle(_this, args.value);
        });
        this.label.on("textChange", this._labelTextHandler);
        this._imageColorHandler = this._imageColorHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarIconColor(_this, args.value);
        });
        this.image.style.on("colorChange", this._imageColorHandler);
        this._imageFontHandler = this._imageFontHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarIconColor(_this, args.value);
        });
        this.image.style.on("fontInternalChange", this._imageFontHandler);
        this._imageSrcHandler = this._imageSrcHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarIconColor(_this, args.value);
        });
        this.image.on("srcChange", this._imageSrcHandler);
    };
    TabStripItem.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        this.label.style.off("colorChange", this._labelColorHandler);
        this.label.style.off("fontInternalChange", this._labelFontHandler);
        this.label.style.off("textTransformChange", this._labelTextTransformHandler);
        this.label.style.off("textChange", this._labelTextHandler);
        this.image.style.off("colorChange", this._imageColorHandler);
        this.image.style.off("fontInternalChange", this._imageFontHandler);
        this.image.style.off("srcChange", this._imageSrcHandler);
    };
    TabStripItem.prototype.eachChild = function (callback) {
        if (this.label) {
            callback(this.label);
        }
        if (this.image) {
            callback(this.image);
        }
    };
    TabStripItem.prototype._addChildFromBuilder = function (name, value) {
        if (name === "Image") {
            this.image = value;
            this.iconSource = value.src;
            this._addView(value);
        }
        if (name === "Label") {
            this.label = value;
            this.title = value.text;
            this._addView(value);
        }
    };
    TabStripItem.prototype.requestLayout = function () {
        var parent = this.parent;
        if (parent) {
            parent.requestLayout();
        }
    };
    TabStripItem.prototype._updateTabStateChangeHandler = function (subscribe) {
        var _this = this;
        if (subscribe) {
            this._highlightedHandler = this._highlightedHandler || (function () {
                _this._goToVisualState("highlighted");
            });
            this._normalHandler = this._normalHandler || (function () {
                _this._goToVisualState("normal");
            });
            this.on(TabStripItem_1.selectEvent, this._highlightedHandler);
            this.on(TabStripItem_1.unselectEvent, this._normalHandler);
            var parent_1 = this.parent;
            var tabStripParent = parent_1 && parent_1.parent;
            if (this.index === tabStripParent.selectedIndex &&
                !(platform_1.isIOS && tabStripParent instanceof tabs_1.Tabs)) {
                this._goToVisualState("highlighted");
            }
        }
        else {
            this.off(TabStripItem_1.selectEvent, this._highlightedHandler);
            this.off(TabStripItem_1.unselectEvent, this._normalHandler);
        }
    };
    TabStripItem.prototype[view_1.backgroundColorProperty.getDefault] = function () {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.getTabBarBackgroundColor();
    };
    TabStripItem.prototype[view_1.backgroundColorProperty.setNative] = function (value) {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.setTabBarItemBackgroundColor(this, value);
    };
    TabStripItem.prototype[view_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    TabStripItem.prototype[view_1.backgroundInternalProperty.setNative] = function (value) {
    };
    var TabStripItem_1;
    TabStripItem.tapEvent = "tap";
    TabStripItem.selectEvent = "select";
    TabStripItem.unselectEvent = "unselect";
    __decorate([
        view_1.PseudoClassHandler("normal", "highlighted", "pressed", "active")
    ], TabStripItem.prototype, "_updateTabStateChangeHandler", null);
    TabStripItem = TabStripItem_1 = __decorate([
        view_1.CSSType("TabStripItem")
    ], TabStripItem);
    return TabStripItem;
}(view_1.View));
exports.TabStripItem = TabStripItem;
//# sourceMappingURL=tab-strip-item.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
exports.traceCategory = "TabView";
exports.highlightColorProperty = new view_1.Property({ name: "highlightColor", equalityComparer: color_1.Color.equals, valueConverter: function (v) { return new color_1.Color(v); } });
var TabStrip = (function (_super) {
    __extends(TabStrip, _super);
    function TabStrip() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabStrip.prototype.eachChild = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item);
            });
        }
    };
    TabStrip.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "items") {
            this.items = value;
        }
    };
    TabStrip.prototype._addChildFromBuilder = function (name, value) {
        if (name === "TabStripItem") {
            if (!this.items) {
                this.items = new Array();
            }
            this.items.push(value);
            this._addView(value);
        }
    };
    TabStrip.prototype.onItemsChanged = function (oldItems, newItems) {
        var _this = this;
        if (oldItems) {
            oldItems.forEach(function (item) { return _this._removeView(item); });
        }
        if (newItems) {
            newItems.forEach(function (item) {
                _this._addView(item);
            });
        }
    };
    TabStrip.prototype[view_1.backgroundColorProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarBackgroundColor();
    };
    TabStrip.prototype[view_1.backgroundColorProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarBackgroundColor(value);
    };
    TabStrip.prototype[view_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    TabStrip.prototype[view_1.backgroundInternalProperty.setNative] = function (value) {
    };
    TabStrip.prototype[view_1.colorProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarColor();
    };
    TabStrip.prototype[view_1.colorProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarColor(value);
    };
    TabStrip.prototype[view_1.fontInternalProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarFontInternal();
    };
    TabStrip.prototype[view_1.fontInternalProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarFontInternal(value);
    };
    TabStrip.prototype[text_base_1.textTransformProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarTextTransform();
    };
    TabStrip.prototype[text_base_1.textTransformProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarTextTransform(value);
    };
    TabStrip.prototype[exports.highlightColorProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarHighlightColor();
    };
    TabStrip.prototype[exports.highlightColorProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarHighlightColor(value);
    };
    TabStrip.itemTapEvent = "itemTap";
    TabStrip = __decorate([
        view_1.CSSType("TabStrip")
    ], TabStrip);
    return TabStrip;
}(view_1.View));
exports.TabStrip = TabStrip;
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        target.onItemsChanged(oldValue, newValue);
    }
});
exports.itemsProperty.register(TabStrip);
exports.iosIconRenderingModeProperty = new view_1.Property({ name: "iosIconRenderingMode", defaultValue: "automatic" });
exports.iosIconRenderingModeProperty.register(TabStrip);
exports.isIconSizeFixedProperty = new view_1.Property({
    name: "isIconSizeFixed", defaultValue: true, valueConverter: view_1.booleanConverter
});
exports.isIconSizeFixedProperty.register(TabStrip);
exports.highlightColorProperty.register(TabStrip);
//# sourceMappingURL=tab-strip.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-view/tab-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
exports.traceCategory = "TabView";
var TabViewItemBase = (function (_super) {
    __extends(TabViewItemBase, _super);
    function TabViewItemBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._title = "";
        return _this;
    }
    Object.defineProperty(TabViewItemBase.prototype, "textTransform", {
        get: function () {
            return this.style.textTransform;
        },
        set: function (value) {
            this.style.textTransform = value;
        },
        enumerable: true,
        configurable: true
    });
    TabViewItemBase.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof view_1.View) {
            this.view = value;
        }
    };
    Object.defineProperty(TabViewItemBase.prototype, "title", {
        get: function () {
            return this._title;
        },
        set: function (value) {
            if (this._title !== value) {
                this._title = value;
                this._update();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewItemBase.prototype, "view", {
        get: function () {
            return this._view;
        },
        set: function (value) {
            if (this._view !== value) {
                if (this._view) {
                    throw new Error("Changing the view of an already loaded TabViewItem is not currently supported.");
                }
                this._view = value;
                this._addView(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewItemBase.prototype, "iconSource", {
        get: function () {
            return this._iconSource;
        },
        set: function (value) {
            if (this._iconSource !== value) {
                this._iconSource = value;
                this._update();
            }
        },
        enumerable: true,
        configurable: true
    });
    TabViewItemBase.prototype.eachChild = function (callback) {
        var view = this._view;
        if (view) {
            callback(view);
        }
    };
    TabViewItemBase.prototype.loadView = function (view) {
        var tabView = this.parent;
        if (tabView && tabView.items) {
            if (this.canBeLoaded) {
                _super.prototype.loadView.call(this, view);
            }
        }
    };
    TabViewItemBase = __decorate([
        view_1.CSSType("TabViewItem")
    ], TabViewItemBase);
    return TabViewItemBase;
}(view_1.ViewBase));
exports.TabViewItemBase = TabViewItemBase;
var knownCollections;
(function (knownCollections) {
    knownCollections.items = "items";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var TabViewBase = (function (_super) {
    __extends(TabViewBase, _super);
    function TabViewBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabViewBase_1 = TabViewBase;
    Object.defineProperty(TabViewBase.prototype, "androidSelectedTabHighlightColor", {
        get: function () {
            return this.style.androidSelectedTabHighlightColor;
        },
        set: function (value) {
            this.style.androidSelectedTabHighlightColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "tabTextFontSize", {
        get: function () {
            return this.style.tabTextFontSize;
        },
        set: function (value) {
            this.style.tabTextFontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "tabTextColor", {
        get: function () {
            return this.style.tabTextColor;
        },
        set: function (value) {
            this.style.tabTextColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "tabBackgroundColor", {
        get: function () {
            return this.style.tabBackgroundColor;
        },
        set: function (value) {
            this.style.tabBackgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "selectedTabTextColor", {
        get: function () {
            return this.style.selectedTabTextColor;
        },
        set: function (value) {
            this.style.selectedTabTextColor = value;
        },
        enumerable: true,
        configurable: true
    });
    TabViewBase.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "items") {
            this.items = value;
        }
    };
    TabViewBase.prototype._addChildFromBuilder = function (name, value) {
        if (name === "TabViewItem") {
            if (!this.items) {
                this.items = new Array();
            }
            this.items.push(value);
            this._addView(value);
            exports.selectedIndexProperty.coerce(this);
        }
    };
    Object.defineProperty(TabViewBase.prototype, "_selectedView", {
        get: function () {
            var selectedIndex = this.selectedIndex;
            return selectedIndex > -1 ? this.items[selectedIndex].view : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "_childrenCount", {
        get: function () {
            var items = this.items;
            return items ? items.length : 0;
        },
        enumerable: true,
        configurable: true
    });
    TabViewBase.prototype.eachChild = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item);
            });
        }
    };
    TabViewBase.prototype.eachChildView = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item.view);
            });
        }
    };
    TabViewBase.prototype.onItemsChanged = function (oldItems, newItems) {
        var _this = this;
        if (oldItems) {
            oldItems.forEach(function (item) { return _this._removeView(item); });
        }
        if (newItems) {
            newItems.forEach(function (item) {
                if (!item.view) {
                    throw new Error("TabViewItem must have a view.");
                }
                _this._addView(item);
            });
        }
    };
    TabViewBase.prototype.onSelectedIndexChanged = function (oldIndex, newIndex) {
        this.notify({ eventName: TabViewBase_1.selectedIndexChangedEvent, object: this, oldIndex: oldIndex, newIndex: newIndex });
    };
    var TabViewBase_1;
    TabViewBase.selectedIndexChangedEvent = "selectedIndexChanged";
    TabViewBase = TabViewBase_1 = __decorate([
        view_1.CSSType("TabView")
    ], TabViewBase);
    return TabViewBase;
}(view_1.View));
exports.TabViewBase = TabViewBase;
function traceMissingIcon(icon) {
    view_1.traceWrite("Could not load tab bar icon: " + icon, view_1.traceCategories.Error, view_1.traceMessageType.error);
}
exports.traceMissingIcon = traceMissingIcon;
exports.selectedIndexProperty = new view_1.CoercibleProperty({
    name: "selectedIndex", defaultValue: -1, affectsLayout: view_1.isIOS,
    valueChanged: function (target, oldValue, newValue) {
        target.onSelectedIndexChanged(oldValue, newValue);
    },
    coerceValue: function (target, value) {
        var items = target.items;
        if (items) {
            var max = items.length - 1;
            if (value < 0) {
                value = 0;
            }
            if (value > max) {
                value = max;
            }
        }
        else {
            value = -1;
        }
        return value;
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.selectedIndexProperty.register(TabViewBase);
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        target.onItemsChanged(oldValue, newValue);
    }
});
exports.itemsProperty.register(TabViewBase);
exports.iosIconRenderingModeProperty = new view_1.Property({ name: "iosIconRenderingMode", defaultValue: "automatic" });
exports.iosIconRenderingModeProperty.register(TabViewBase);
exports.androidOffscreenTabLimitProperty = new view_1.Property({
    name: "androidOffscreenTabLimit", defaultValue: 1, affectsLayout: view_1.isIOS,
    valueConverter: function (v) { return parseInt(v); }
});
exports.androidOffscreenTabLimitProperty.register(TabViewBase);
exports.androidTabsPositionProperty = new view_1.Property({ name: "androidTabsPosition", defaultValue: "top" });
exports.androidTabsPositionProperty.register(TabViewBase);
exports.androidSwipeEnabledProperty = new view_1.Property({ name: "androidSwipeEnabled", defaultValue: true, valueConverter: view_1.booleanConverter });
exports.androidSwipeEnabledProperty.register(TabViewBase);
exports.tabTextFontSizeProperty = new view_1.CssProperty({ name: "tabTextFontSize", cssName: "tab-text-font-size", valueConverter: function (v) { return parseFloat(v); } });
exports.tabTextFontSizeProperty.register(view_1.Style);
exports.tabTextColorProperty = new view_1.CssProperty({ name: "tabTextColor", cssName: "tab-text-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.tabTextColorProperty.register(view_1.Style);
exports.tabBackgroundColorProperty = new view_1.CssProperty({ name: "tabBackgroundColor", cssName: "tab-background-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.tabBackgroundColorProperty.register(view_1.Style);
exports.selectedTabTextColorProperty = new view_1.CssProperty({ name: "selectedTabTextColor", cssName: "selected-tab-text-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.selectedTabTextColorProperty.register(view_1.Style);
exports.androidSelectedTabHighlightColorProperty = new view_1.CssProperty({ name: "androidSelectedTabHighlightColor", cssName: "android-selected-tab-highlight-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.androidSelectedTabHighlightColorProperty.register(view_1.Style);
//# sourceMappingURL=tab-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-view/tab-view.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var tab_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-view/tab-view-common.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-view/tab-view-common.js"));
var ACCENT_COLOR = "colorAccent";
var PRIMARY_COLOR = "colorPrimary";
var DEFAULT_ELEVATION = 4;
var TABID = "_tabId";
var INDEX = "_index";
var PagerAdapter;
function makeFragmentName(viewId, id) {
    return "android:viewpager:" + viewId + ":" + id;
}
function getTabById(id) {
    var ref = exports.tabs.find(function (ref) {
        var tab = ref.get();
        return tab && tab._domId === id;
    });
    return ref && ref.get();
}
function initializeNativeClasses() {
    if (PagerAdapter) {
        return;
    }
    var TabFragmentImplementation = (function (_super) {
        __extends(TabFragmentImplementation, _super);
        function TabFragmentImplementation() {
            var _this = _super.call(this) || this;
            return global.__native(_this);
        }
        TabFragmentImplementation.newInstance = function (tabId, index) {
            var args = new android.os.Bundle();
            args.putInt(TABID, tabId);
            args.putInt(INDEX, index);
            var fragment = new TabFragmentImplementation();
            fragment.setArguments(args);
            return fragment;
        };
        TabFragmentImplementation.prototype.onCreate = function (savedInstanceState) {
            _super.prototype.onCreate.call(this, savedInstanceState);
            var args = this.getArguments();
            this.tab = getTabById(args.getInt(TABID));
            this.index = args.getInt(INDEX);
            if (!this.tab) {
                throw new Error("Cannot find TabView");
            }
        };
        TabFragmentImplementation.prototype.onCreateView = function (inflater, container, savedInstanceState) {
            var tabItem = this.tab.items[this.index];
            return tabItem.view.nativeViewProtected;
        };
        return TabFragmentImplementation;
    }(org.nativescript.widgets.FragmentBase));
    var POSITION_UNCHANGED = -1;
    var POSITION_NONE = -2;
    var FragmentPagerAdapter = (function (_super) {
        __extends(FragmentPagerAdapter, _super);
        function FragmentPagerAdapter(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        FragmentPagerAdapter.prototype.getCount = function () {
            var items = this.items;
            return items ? items.length : 0;
        };
        FragmentPagerAdapter.prototype.getPageTitle = function (index) {
            var items = this.items;
            if (index < 0 || index >= items.length) {
                return "";
            }
            return items[index].title;
        };
        FragmentPagerAdapter.prototype.startUpdate = function (container) {
            if (container.getId() === android.view.View.NO_ID) {
                throw new Error("ViewPager with adapter " + this + " requires a view containerId");
            }
        };
        FragmentPagerAdapter.prototype.instantiateItem = function (container, position) {
            var fragmentManager = this.owner._getFragmentManager();
            if (!this.mCurTransaction) {
                this.mCurTransaction = fragmentManager.beginTransaction();
            }
            var itemId = this.getItemId(position);
            var name = makeFragmentName(container.getId(), itemId);
            var fragment = fragmentManager.findFragmentByTag(name);
            if (fragment != null) {
                this.mCurTransaction.attach(fragment);
            }
            else {
                fragment = TabFragmentImplementation.newInstance(this.owner._domId, position);
                this.mCurTransaction.add(container.getId(), fragment, name);
            }
            if (fragment !== this.mCurrentPrimaryItem) {
                fragment.setMenuVisibility(false);
                fragment.setUserVisibleHint(false);
            }
            var tabItems = this.owner.items;
            var tabItem = tabItems ? tabItems[position] : null;
            if (tabItem) {
                tabItem.canBeLoaded = true;
            }
            return fragment;
        };
        FragmentPagerAdapter.prototype.getItemPosition = function (object) {
            return this.items ? POSITION_UNCHANGED : POSITION_NONE;
        };
        FragmentPagerAdapter.prototype.destroyItem = function (container, position, object) {
            if (!this.mCurTransaction) {
                var fragmentManager = this.owner._getFragmentManager();
                this.mCurTransaction = fragmentManager.beginTransaction();
            }
            var fragment = object;
            this.mCurTransaction.detach(fragment);
            if (this.mCurrentPrimaryItem === fragment) {
                this.mCurrentPrimaryItem = null;
            }
            var tabItems = this.owner.items;
            var tabItem = tabItems ? tabItems[position] : null;
            if (tabItem) {
                tabItem.canBeLoaded = false;
            }
        };
        FragmentPagerAdapter.prototype.setPrimaryItem = function (container, position, object) {
            var fragment = object;
            if (fragment !== this.mCurrentPrimaryItem) {
                if (this.mCurrentPrimaryItem != null) {
                    this.mCurrentPrimaryItem.setMenuVisibility(false);
                    this.mCurrentPrimaryItem.setUserVisibleHint(false);
                }
                if (fragment != null) {
                    fragment.setMenuVisibility(true);
                    fragment.setUserVisibleHint(true);
                }
                this.mCurrentPrimaryItem = fragment;
                this.owner.selectedIndex = position;
                var tab = this.owner;
                var tabItems = tab.items;
                var newTabItem = tabItems ? tabItems[position] : null;
                if (newTabItem) {
                    tab._loadUnloadTabItems(tab.selectedIndex);
                }
            }
        };
        FragmentPagerAdapter.prototype.finishUpdate = function (container) {
            this._commitCurrentTransaction();
        };
        FragmentPagerAdapter.prototype.isViewFromObject = function (view, object) {
            return object.getView() === view;
        };
        FragmentPagerAdapter.prototype.saveState = function () {
            this._commitCurrentTransaction();
            return null;
        };
        FragmentPagerAdapter.prototype.restoreState = function (state, loader) {
        };
        FragmentPagerAdapter.prototype.getItemId = function (position) {
            return position;
        };
        FragmentPagerAdapter.prototype._commitCurrentTransaction = function () {
            if (this.mCurTransaction != null) {
                this.mCurTransaction.commitNowAllowingStateLoss();
                this.mCurTransaction = null;
            }
        };
        return FragmentPagerAdapter;
    }(androidx.viewpager.widget.PagerAdapter));
    PagerAdapter = FragmentPagerAdapter;
}
function createTabItemSpec(item) {
    var result = new org.nativescript.widgets.TabItemSpec();
    result.title = item.title;
    if (item.iconSource) {
        if (item.iconSource.indexOf(utils_1.RESOURCE_PREFIX) === 0) {
            result.iconId = utils_1.ad.resources.getDrawableId(item.iconSource.substr(utils_1.RESOURCE_PREFIX.length));
            if (result.iconId === 0) {
                tab_view_common_1.traceMissingIcon(item.iconSource);
            }
        }
        else {
            var is = image_source_1.fromFileOrResource(item.iconSource);
            if (is) {
                result.iconDrawable = new android.graphics.drawable.BitmapDrawable(application.android.context.getResources(), is.android);
            }
            else {
                tab_view_common_1.traceMissingIcon(item.iconSource);
            }
        }
    }
    return result;
}
var defaultAccentColor = undefined;
function getDefaultAccentColor(context) {
    if (defaultAccentColor === undefined) {
        defaultAccentColor = utils_1.ad.resources.getPaletteColor(ACCENT_COLOR, context) || 0xFF33B5E5;
    }
    return defaultAccentColor;
}
var TabViewItem = (function (_super) {
    __extends(TabViewItem, _super);
    function TabViewItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(TabViewItem.prototype, "_hasFragments", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    TabViewItem.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        if (this.nativeViewProtected) {
            this._defaultTransformationMethod = this.nativeViewProtected.getTransformationMethod();
        }
    };
    TabViewItem.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
    };
    TabViewItem.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        if (this.nativeViewProtected) {
            this.nativeViewProtected.setTransformationMethod(this._defaultTransformationMethod);
        }
    };
    TabViewItem.prototype.disposeNativeView = function () {
        _super.prototype.disposeNativeView.call(this);
        this.canBeLoaded = false;
    };
    TabViewItem.prototype.createNativeView = function () {
        return this.nativeViewProtected;
    };
    TabViewItem.prototype._update = function () {
        var tv = this.nativeViewProtected;
        var tabView = this.parent;
        if (tv && tabView) {
            this.tabItemSpec = createTabItemSpec(this);
            tabView.updateAndroidItemAt(this.index, this.tabItemSpec);
        }
    };
    TabViewItem.prototype._getChildFragmentManager = function () {
        var tabView = this.parent;
        var tabFragment = null;
        var fragmentManager = tabView._getFragmentManager();
        for (var _i = 0, _a = fragmentManager.getFragments().toArray(); _i < _a.length; _i++) {
            var fragment = _a[_i];
            if (fragment.index === this.index) {
                tabFragment = fragment;
                break;
            }
        }
        if (!tabFragment) {
            if (tab_view_common_1.traceEnabled()) {
                tab_view_common_1.traceWrite("Could not get child fragment manager for tab item with index " + this.index, tab_view_common_1.traceCategory);
            }
            return tabView._getRootFragmentManager();
        }
        return tabFragment.getChildFragmentManager();
    };
    TabViewItem.prototype[tab_view_common_1.fontSizeProperty.getDefault] = function () {
        return { nativeSize: this.nativeViewProtected.getTextSize() };
    };
    TabViewItem.prototype[tab_view_common_1.fontSizeProperty.setNative] = function (value) {
        if (typeof value === "number") {
            this.nativeViewProtected.setTextSize(value);
        }
        else {
            this.nativeViewProtected.setTextSize(android.util.TypedValue.COMPLEX_UNIT_PX, value.nativeSize);
        }
    };
    TabViewItem.prototype[tab_view_common_1.fontInternalProperty.getDefault] = function () {
        return this.nativeViewProtected.getTypeface();
    };
    TabViewItem.prototype[tab_view_common_1.fontInternalProperty.setNative] = function (value) {
        this.nativeViewProtected.setTypeface(value instanceof font_1.Font ? value.getAndroidTypeface() : value);
    };
    TabViewItem.prototype[text_base_1.textTransformProperty.getDefault] = function () {
        return "default";
    };
    TabViewItem.prototype[text_base_1.textTransformProperty.setNative] = function (value) {
        var tv = this.nativeViewProtected;
        if (value === "default") {
            tv.setTransformationMethod(this._defaultTransformationMethod);
            tv.setText(this.title);
        }
        else {
            var result = text_base_1.getTransformedText(this.title, value);
            tv.setText(result);
            tv.setTransformationMethod(null);
        }
    };
    return TabViewItem;
}(tab_view_common_1.TabViewItemBase));
exports.TabViewItem = TabViewItem;
function setElevation(grid, tabLayout) {
    var compat = androidx.core.view.ViewCompat;
    if (compat.setElevation) {
        var val = DEFAULT_ELEVATION * tab_view_common_1.layout.getDisplayDensity();
        compat.setElevation(grid, val);
        compat.setElevation(tabLayout, val);
    }
}
exports.tabs = new Array();
function iterateIndexRange(index, eps, lastIndex, callback) {
    var rangeStart = Math.max(0, index - eps);
    var rangeEnd = Math.min(index + eps, lastIndex);
    for (var i = rangeStart; i <= rangeEnd; i++) {
        callback(i);
    }
}
var TabView = (function (_super) {
    __extends(TabView, _super);
    function TabView() {
        var _this = _super.call(this) || this;
        _this._androidViewId = -1;
        exports.tabs.push(new WeakRef(_this));
        return _this;
    }
    Object.defineProperty(TabView.prototype, "_hasFragments", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    TabView.prototype.onItemsChanged = function (oldItems, newItems) {
        _super.prototype.onItemsChanged.call(this, oldItems, newItems);
        if (oldItems) {
            oldItems.forEach(function (item, i, arr) {
                item.index = 0;
                item.tabItemSpec = null;
                item.setNativeView(null);
            });
        }
    };
    TabView.prototype.createNativeView = function () {
        initializeNativeClasses();
        if (tab_view_common_1.traceEnabled()) {
            tab_view_common_1.traceWrite("TabView._createUI(" + this + ");", tab_view_common_1.traceCategory);
        }
        var context = this._context;
        var nativeView = new org.nativescript.widgets.GridLayout(context);
        var viewPager = new org.nativescript.widgets.TabViewPager(context);
        var tabLayout = new org.nativescript.widgets.TabLayout(context);
        var lp = new org.nativescript.widgets.CommonLayoutParams();
        var primaryColor = utils_1.ad.resources.getPaletteColor(PRIMARY_COLOR, context);
        var accentColor = getDefaultAccentColor(context);
        lp.row = 1;
        if (this.androidTabsPosition === "top") {
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.auto));
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
            viewPager.setLayoutParams(lp);
            if (!this.androidSwipeEnabled) {
                viewPager.setSwipePageEnabled(false);
            }
        }
        else {
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.auto));
            tabLayout.setLayoutParams(lp);
            viewPager.setSwipePageEnabled(false);
            accentColor = 0x00FFFFFF;
        }
        nativeView.addView(viewPager);
        nativeView.viewPager = viewPager;
        var adapter = new PagerAdapter(this);
        viewPager.setAdapter(adapter);
        viewPager.adapter = adapter;
        nativeView.addView(tabLayout);
        nativeView.tabLayout = tabLayout;
        setElevation(nativeView, tabLayout);
        if (accentColor) {
            tabLayout.setSelectedIndicatorColors([accentColor]);
        }
        if (primaryColor) {
            tabLayout.setBackgroundColor(primaryColor);
        }
        return nativeView;
    };
    TabView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        if (this._androidViewId < 0) {
            this._androidViewId = android.view.View.generateViewId();
        }
        var nativeView = this.nativeViewProtected;
        this._tabLayout = nativeView.tabLayout;
        var viewPager = nativeView.viewPager;
        viewPager.setId(this._androidViewId);
        this._viewPager = viewPager;
        this._pagerAdapter = viewPager.adapter;
        this._pagerAdapter.owner = this;
    };
    TabView.prototype._loadUnloadTabItems = function (newIndex) {
        var _this = this;
        var items = this.items;
        var lastIndex = this.items.length - 1;
        var offsideItems = this.androidTabsPosition === "top" ? this.androidOffscreenTabLimit : 1;
        var toUnload = [];
        var toLoad = [];
        iterateIndexRange(newIndex, offsideItems, lastIndex, function (i) { return toLoad.push(i); });
        items.forEach(function (item, i) {
            var indexOfI = toLoad.indexOf(i);
            if (indexOfI < 0) {
                toUnload.push(i);
            }
        });
        toUnload.forEach(function (index) {
            var item = items[index];
            if (items[index]) {
                item.unloadView(item.view);
            }
        });
        var newItem = items[newIndex];
        var selectedView = newItem && newItem.view;
        if (selectedView instanceof frame_1.Frame) {
            selectedView._pushInFrameStackRecursive();
        }
        toLoad.forEach(function (index) {
            var item = items[index];
            if (_this.isLoaded && items[index]) {
                item.loadView(item.view);
            }
        });
    };
    TabView.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.setAdapterItems(this.items);
    };
    TabView.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        this.setAdapterItems(null);
    };
    TabView.prototype.disposeNativeView = function () {
        this._tabLayout.setItems(null, null);
        this._pagerAdapter.owner = null;
        this._pagerAdapter = null;
        this._tabLayout = null;
        this._viewPager = null;
        _super.prototype.disposeNativeView.call(this);
    };
    TabView.prototype._onRootViewReset = function () {
        _super.prototype._onRootViewReset.call(this);
        this.disposeCurrentFragments();
    };
    TabView.prototype.disposeCurrentFragments = function () {
        var fragmentManager = this._getFragmentManager();
        var transaction = fragmentManager.beginTransaction();
        for (var _i = 0, _a = fragmentManager.getFragments().toArray(); _i < _a.length; _i++) {
            var fragment = _a[_i];
            transaction.remove(fragment);
        }
        transaction.commitNowAllowingStateLoss();
    };
    TabView.prototype.shouldUpdateAdapter = function (items) {
        if (!this._pagerAdapter) {
            return false;
        }
        var currentPagerAdapterItems = this._pagerAdapter.items;
        if (!items && !currentPagerAdapterItems) {
            return false;
        }
        if (!items || !currentPagerAdapterItems) {
            return true;
        }
        if (items.length !== currentPagerAdapterItems.length) {
            return true;
        }
        var matchingItems = currentPagerAdapterItems.filter(function (currentItem) {
            return !!items.filter(function (item) {
                return item._domId === currentItem._domId;
            })[0];
        });
        if (matchingItems.length !== items.length) {
            return true;
        }
        return false;
    };
    TabView.prototype.setAdapterItems = function (items) {
        if (this.shouldUpdateAdapter(items)) {
            this._pagerAdapter.items = items;
            var length_1 = items ? items.length : 0;
            if (length_1 === 0) {
                this._tabLayout.setItems(null, null);
                this._pagerAdapter.notifyDataSetChanged();
                return;
            }
            var tabItems_1 = new Array();
            items.forEach(function (item, i, arr) {
                var tabItemSpec = createTabItemSpec(item);
                item.index = i;
                item.tabItemSpec = tabItemSpec;
                tabItems_1.push(tabItemSpec);
            });
            var tabLayout_1 = this._tabLayout;
            tabLayout_1.setItems(tabItems_1, this._viewPager);
            items.forEach(function (item, i, arr) {
                var tv = tabLayout_1.getTextViewForItemAt(i);
                item.setNativeView(tv);
            });
            this._pagerAdapter.notifyDataSetChanged();
        }
    };
    TabView.prototype.updateAndroidItemAt = function (index, spec) {
        this._tabLayout.updateItemAt(index, spec);
    };
    TabView.prototype[tab_view_common_1.androidOffscreenTabLimitProperty.getDefault] = function () {
        return this._viewPager.getOffscreenPageLimit();
    };
    TabView.prototype[tab_view_common_1.androidOffscreenTabLimitProperty.setNative] = function (value) {
        this._viewPager.setOffscreenPageLimit(value);
    };
    TabView.prototype[tab_view_common_1.selectedIndexProperty.setNative] = function (value) {
        var smoothScroll = this.androidTabsPosition === "top";
        if (tab_view_common_1.traceEnabled()) {
            tab_view_common_1.traceWrite("TabView this._viewPager.setCurrentItem(" + value + ", " + smoothScroll + ");", tab_view_common_1.traceCategory);
        }
        this._viewPager.setCurrentItem(value, smoothScroll);
    };
    TabView.prototype[tab_view_common_1.itemsProperty.getDefault] = function () {
        return null;
    };
    TabView.prototype[tab_view_common_1.itemsProperty.setNative] = function (value) {
        this.setAdapterItems(value);
        tab_view_common_1.selectedIndexProperty.coerce(this);
    };
    TabView.prototype[tab_view_common_1.tabBackgroundColorProperty.getDefault] = function () {
        return this._tabLayout.getBackground();
    };
    TabView.prototype[tab_view_common_1.tabBackgroundColorProperty.setNative] = function (value) {
        if (value instanceof tab_view_common_1.Color) {
            this._tabLayout.setBackgroundColor(value.android);
        }
        else {
            this._tabLayout.setBackground(tryCloneDrawable(value, this.nativeViewProtected.getResources));
        }
    };
    TabView.prototype[tab_view_common_1.tabTextFontSizeProperty.getDefault] = function () {
        return this._tabLayout.getTabTextFontSize();
    };
    TabView.prototype[tab_view_common_1.tabTextFontSizeProperty.setNative] = function (value) {
        if (typeof value === "number") {
            this._tabLayout.setTabTextFontSize(value);
        }
        else {
            this._tabLayout.setTabTextFontSize(value.nativeSize);
        }
    };
    TabView.prototype[tab_view_common_1.tabTextColorProperty.getDefault] = function () {
        return this._tabLayout.getTabTextColor();
    };
    TabView.prototype[tab_view_common_1.tabTextColorProperty.setNative] = function (value) {
        var color = value instanceof tab_view_common_1.Color ? value.android : value;
        this._tabLayout.setTabTextColor(color);
    };
    TabView.prototype[tab_view_common_1.selectedTabTextColorProperty.getDefault] = function () {
        return this._tabLayout.getSelectedTabTextColor();
    };
    TabView.prototype[tab_view_common_1.selectedTabTextColorProperty.setNative] = function (value) {
        var color = value instanceof tab_view_common_1.Color ? value.android : value;
        this._tabLayout.setSelectedTabTextColor(color);
    };
    TabView.prototype[tab_view_common_1.androidSelectedTabHighlightColorProperty.getDefault] = function () {
        return getDefaultAccentColor(this._context);
    };
    TabView.prototype[tab_view_common_1.androidSelectedTabHighlightColorProperty.setNative] = function (value) {
        var tabLayout = this._tabLayout;
        var color = value instanceof tab_view_common_1.Color ? value.android : value;
        tabLayout.setSelectedIndicatorColors([color]);
    };
    return TabView;
}(tab_view_common_1.TabViewBase));
exports.TabView = TabView;
function tryCloneDrawable(value, resources) {
    if (value) {
        var constantState = value.getConstantState();
        if (constantState) {
            return constantState.newDrawable(resources);
        }
    }
    return value;
}
//# sourceMappingURL=tab-view.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tabs/tabs-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var tab_navigation_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js"));
exports.traceCategory = "TabView";
var knownCollections;
(function (knownCollections) {
    knownCollections.items = "items";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var TabsBase = (function (_super) {
    __extends(TabsBase, _super);
    function TabsBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabsBase = __decorate([
        view_1.CSSType("Tabs")
    ], TabsBase);
    return TabsBase;
}(tab_navigation_base_1.TabNavigationBase));
exports.TabsBase = TabsBase;
exports.swipeEnabledProperty = new properties_1.Property({
    name: "swipeEnabled", defaultValue: true, valueConverter: view_1.booleanConverter
});
exports.swipeEnabledProperty.register(TabsBase);
exports.offscreenTabLimitProperty = new properties_1.Property({
    name: "offscreenTabLimit", defaultValue: 1, valueConverter: function (v) { return parseInt(v); }
});
exports.offscreenTabLimitProperty.register(TabsBase);
exports.tabsPositionProperty = new properties_1.Property({ name: "tabsPosition", defaultValue: "top" });
exports.tabsPositionProperty.register(TabsBase);
//# sourceMappingURL=tabs-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tabs/tabs.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var tab_strip_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js");
var tab_strip_item_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js");
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var tab_navigation_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
var tabs_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tabs/tabs-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tabs/tabs-common.js"));
var ACCENT_COLOR = "colorAccent";
var PRIMARY_COLOR = "colorPrimary";
var DEFAULT_ELEVATION = 4;
var TABID = "_tabId";
var INDEX = "_index";
var PagerAdapter;
var TabsBar;
function makeFragmentName(viewId, id) {
    return "android:viewpager:" + viewId + ":" + id;
}
function getTabById(id) {
    var ref = exports.tabs.find(function (ref) {
        var tab = ref.get();
        return tab && tab._domId === id;
    });
    return ref && ref.get();
}
function initializeNativeClasses() {
    if (PagerAdapter) {
        return;
    }
    var TabFragmentImplementation = (function (_super) {
        __extends(TabFragmentImplementation, _super);
        function TabFragmentImplementation() {
            var _this = _super.call(this) || this;
            return global.__native(_this);
        }
        TabFragmentImplementation.newInstance = function (tabId, index) {
            var args = new android.os.Bundle();
            args.putInt(TABID, tabId);
            args.putInt(INDEX, index);
            var fragment = new TabFragmentImplementation();
            fragment.setArguments(args);
            return fragment;
        };
        TabFragmentImplementation.prototype.onCreate = function (savedInstanceState) {
            _super.prototype.onCreate.call(this, savedInstanceState);
            var args = this.getArguments();
            this.tab = getTabById(args.getInt(TABID));
            this.index = args.getInt(INDEX);
            if (!this.tab) {
                throw new Error("Cannot find TabView");
            }
        };
        TabFragmentImplementation.prototype.onCreateView = function (inflater, container, savedInstanceState) {
            var tabItem = this.tab.items[this.index];
            return tabItem.nativeViewProtected;
        };
        return TabFragmentImplementation;
    }(org.nativescript.widgets.FragmentBase));
    var POSITION_UNCHANGED = -1;
    var POSITION_NONE = -2;
    var FragmentPagerAdapter = (function (_super) {
        __extends(FragmentPagerAdapter, _super);
        function FragmentPagerAdapter(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        FragmentPagerAdapter.prototype.getCount = function () {
            var items = this.items;
            return items ? items.length : 0;
        };
        FragmentPagerAdapter.prototype.getPageTitle = function (index) {
            var items = this.items;
            if (index < 0 || index >= items.length) {
                return "";
            }
            return "";
        };
        FragmentPagerAdapter.prototype.startUpdate = function (container) {
            if (container.getId() === android.view.View.NO_ID) {
                throw new Error("ViewPager with adapter " + this + " requires a view containerId");
            }
        };
        FragmentPagerAdapter.prototype.instantiateItem = function (container, position) {
            var fragmentManager = this.owner._getFragmentManager();
            if (!this.mCurTransaction) {
                this.mCurTransaction = fragmentManager.beginTransaction();
            }
            var itemId = this.getItemId(position);
            var name = makeFragmentName(container.getId(), itemId);
            var fragment = fragmentManager.findFragmentByTag(name);
            if (fragment != null) {
                this.mCurTransaction.attach(fragment);
            }
            else {
                fragment = TabFragmentImplementation.newInstance(this.owner._domId, position);
                this.mCurTransaction.add(container.getId(), fragment, name);
            }
            if (fragment !== this.mCurrentPrimaryItem) {
                fragment.setMenuVisibility(false);
                fragment.setUserVisibleHint(false);
            }
            var tabItems = this.owner.items;
            var tabItem = tabItems ? tabItems[position] : null;
            if (tabItem) {
                tabItem.canBeLoaded = true;
            }
            return fragment;
        };
        FragmentPagerAdapter.prototype.getItemPosition = function (object) {
            return this.items ? POSITION_UNCHANGED : POSITION_NONE;
        };
        FragmentPagerAdapter.prototype.destroyItem = function (container, position, object) {
            if (!this.mCurTransaction) {
                var fragmentManager = this.owner._getFragmentManager();
                this.mCurTransaction = fragmentManager.beginTransaction();
            }
            var fragment = object;
            this.mCurTransaction.detach(fragment);
            if (this.mCurrentPrimaryItem === fragment) {
                this.mCurrentPrimaryItem = null;
            }
            var tabItems = this.owner.items;
            var tabItem = tabItems ? tabItems[position] : null;
            if (tabItem) {
                tabItem.canBeLoaded = false;
            }
        };
        FragmentPagerAdapter.prototype.setPrimaryItem = function (container, position, object) {
            var fragment = object;
            if (fragment !== this.mCurrentPrimaryItem) {
                if (this.mCurrentPrimaryItem != null) {
                    this.mCurrentPrimaryItem.setMenuVisibility(false);
                    this.mCurrentPrimaryItem.setUserVisibleHint(false);
                }
                if (fragment != null) {
                    fragment.setMenuVisibility(true);
                    fragment.setUserVisibleHint(true);
                }
                this.mCurrentPrimaryItem = fragment;
                this.owner.selectedIndex = position;
                var tab = this.owner;
                var tabItems = tab.items;
                var newTabItem = tabItems ? tabItems[position] : null;
                if (newTabItem) {
                    tab._loadUnloadTabItems(tab.selectedIndex);
                }
            }
        };
        FragmentPagerAdapter.prototype.finishUpdate = function (container) {
            this._commitCurrentTransaction();
        };
        FragmentPagerAdapter.prototype.isViewFromObject = function (view, object) {
            return object.getView() === view;
        };
        FragmentPagerAdapter.prototype.saveState = function () {
            this._commitCurrentTransaction();
            return null;
        };
        FragmentPagerAdapter.prototype.restoreState = function (state, loader) {
        };
        FragmentPagerAdapter.prototype.getItemId = function (position) {
            return position;
        };
        FragmentPagerAdapter.prototype._commitCurrentTransaction = function () {
            if (this.mCurTransaction != null) {
                this.mCurTransaction.commitNowAllowingStateLoss();
                this.mCurTransaction = null;
            }
        };
        return FragmentPagerAdapter;
    }(androidx.viewpager.widget.PagerAdapter));
    var TabsBarImplementation = (function (_super) {
        __extends(TabsBarImplementation, _super);
        function TabsBarImplementation(context, owner) {
            var _this = _super.call(this, context) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        TabsBarImplementation.prototype.onSelectedPositionChange = function (position, prevPosition) {
            var owner = this.owner;
            if (!owner) {
                return;
            }
            var tabStripItems = owner.tabStrip && owner.tabStrip.items;
            if (position >= 0 && tabStripItems && tabStripItems[position]) {
                tabStripItems[position]._emit(tab_strip_item_1.TabStripItem.selectEvent);
            }
            if (prevPosition >= 0 && tabStripItems && tabStripItems[prevPosition]) {
                tabStripItems[prevPosition]._emit(tab_strip_item_1.TabStripItem.unselectEvent);
            }
        };
        TabsBarImplementation.prototype.onTap = function (position) {
            var owner = this.owner;
            if (!owner) {
                return false;
            }
            var tabStrip = owner.tabStrip;
            var tabStripItems = tabStrip && tabStrip.items;
            if (position >= 0 && tabStripItems[position]) {
                tabStripItems[position]._emit(tab_strip_item_1.TabStripItem.tapEvent);
                tabStrip.notify({ eventName: tab_strip_1.TabStrip.itemTapEvent, object: tabStrip, index: position });
            }
            if (!owner.items[position]) {
                return false;
            }
            return true;
        };
        return TabsBarImplementation;
    }(org.nativescript.widgets.TabsBar));
    PagerAdapter = FragmentPagerAdapter;
    TabsBar = TabsBarImplementation;
}
var defaultAccentColor = undefined;
function getDefaultAccentColor(context) {
    if (defaultAccentColor === undefined) {
        defaultAccentColor = utils_1.ad.resources.getPaletteColor(ACCENT_COLOR, context) || 0xFF33B5E5;
    }
    return defaultAccentColor;
}
function setElevation(grid, tabsBar, tabsPosition) {
    var compat = androidx.core.view.ViewCompat;
    if (compat.setElevation) {
        var val = DEFAULT_ELEVATION * utils_1.layout.getDisplayDensity();
        if (tabsPosition === "top") {
            compat.setElevation(grid, val);
        }
        compat.setElevation(tabsBar, val);
    }
}
exports.tabs = new Array();
function iterateIndexRange(index, eps, lastIndex, callback) {
    var rangeStart = Math.max(0, index - eps);
    var rangeEnd = Math.min(index + eps, lastIndex);
    for (var i = rangeStart; i <= rangeEnd; i++) {
        callback(i);
    }
}
var Tabs = (function (_super) {
    __extends(Tabs, _super);
    function Tabs() {
        var _this = _super.call(this) || this;
        _this._androidViewId = -1;
        exports.tabs.push(new WeakRef(_this));
        return _this;
    }
    Object.defineProperty(Tabs.prototype, "_hasFragments", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    Tabs.prototype.onItemsChanged = function (oldItems, newItems) {
        _super.prototype.onItemsChanged.call(this, oldItems, newItems);
        if (oldItems) {
            oldItems.forEach(function (item, i, arr) {
                item.index = 0;
                item.tabItemSpec = null;
                item.setNativeView(null);
            });
        }
    };
    Tabs.prototype.createNativeView = function () {
        initializeNativeClasses();
        var context = this._context;
        var nativeView = new org.nativescript.widgets.GridLayout(context);
        var viewPager = new org.nativescript.widgets.TabViewPager(context);
        var tabsBar = new TabsBar(context, this);
        var lp = new org.nativescript.widgets.CommonLayoutParams();
        var primaryColor = utils_1.ad.resources.getPaletteColor(PRIMARY_COLOR, context);
        var accentColor = getDefaultAccentColor(context);
        lp.row = 1;
        if (this.tabsPosition === "top") {
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.auto));
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
            viewPager.setLayoutParams(lp);
        }
        else {
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.auto));
            tabsBar.setLayoutParams(lp);
        }
        nativeView.addView(viewPager);
        nativeView.viewPager = viewPager;
        var adapter = new PagerAdapter(this);
        viewPager.setAdapter(adapter);
        viewPager.adapter = adapter;
        nativeView.addView(tabsBar);
        nativeView.tabsBar = tabsBar;
        setElevation(nativeView, tabsBar, this.tabsPosition);
        if (accentColor) {
            tabsBar.setSelectedIndicatorColors([accentColor]);
        }
        if (primaryColor) {
            tabsBar.setBackgroundColor(primaryColor);
        }
        return nativeView;
    };
    Tabs.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        if (this._androidViewId < 0) {
            this._androidViewId = android.view.View.generateViewId();
        }
        var nativeView = this.nativeViewProtected;
        this._tabsBar = nativeView.tabsBar;
        var viewPager = nativeView.viewPager;
        viewPager.setId(this._androidViewId);
        this._viewPager = viewPager;
        this._pagerAdapter = viewPager.adapter;
        this._pagerAdapter.owner = this;
    };
    Tabs.prototype._loadUnloadTabItems = function (newIndex) {
        var _this = this;
        var items = this.items;
        var lastIndex = this.items.length - 1;
        var offsideItems = this.offscreenTabLimit;
        var toUnload = [];
        var toLoad = [];
        iterateIndexRange(newIndex, offsideItems, lastIndex, function (i) { return toLoad.push(i); });
        items.forEach(function (item, i) {
            var indexOfI = toLoad.indexOf(i);
            if (indexOfI < 0) {
                toUnload.push(i);
            }
        });
        toUnload.forEach(function (index) {
            var item = items[index];
            if (items[index]) {
                item.unloadView(item.content);
            }
        });
        var newItem = items[newIndex];
        var selectedView = newItem && newItem.content;
        if (selectedView instanceof frame_1.Frame) {
            selectedView._pushInFrameStackRecursive();
        }
        toLoad.forEach(function (index) {
            var item = items[index];
            if (_this.isLoaded && items[index]) {
                item.loadView(item.content);
            }
        });
    };
    Tabs.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.setItems(this.items);
        if (this.tabStrip) {
            this.setTabStripItems(this.tabStrip.items);
        }
    };
    Tabs.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        this.setItems(null);
        this.setTabStripItems(null);
    };
    Tabs.prototype.disposeNativeView = function () {
        this._tabsBar.setItems(null, null);
        this._pagerAdapter.owner = null;
        this._pagerAdapter = null;
        this._tabsBar = null;
        this._viewPager = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Tabs.prototype._onRootViewReset = function () {
        _super.prototype._onRootViewReset.call(this);
        this.disposeCurrentFragments();
    };
    Tabs.prototype.disposeCurrentFragments = function () {
        var fragmentManager = this._getFragmentManager();
        var transaction = fragmentManager.beginTransaction();
        for (var _i = 0, _a = fragmentManager.getFragments().toArray(); _i < _a.length; _i++) {
            var fragment = _a[_i];
            transaction.remove(fragment);
        }
        transaction.commitNowAllowingStateLoss();
    };
    Tabs.prototype.shouldUpdateAdapter = function (items) {
        if (!this._pagerAdapter) {
            return false;
        }
        var currentPagerAdapterItems = this._pagerAdapter.items;
        if (!items && !currentPagerAdapterItems) {
            return false;
        }
        if (!items || !currentPagerAdapterItems) {
            return true;
        }
        if (items.length !== currentPagerAdapterItems.length) {
            return true;
        }
        var matchingItems = currentPagerAdapterItems.filter(function (currentItem) {
            return !!items.filter(function (item) {
                return item._domId === currentItem._domId;
            })[0];
        });
        if (matchingItems.length !== items.length) {
            return true;
        }
        return false;
    };
    Tabs.prototype.setItems = function (items) {
        if (this.shouldUpdateAdapter(items)) {
            this._pagerAdapter.items = items;
            if (items && items.length) {
                items.forEach(function (item, i) {
                    item.index = i;
                });
            }
            this._pagerAdapter.notifyDataSetChanged();
        }
    };
    Tabs.prototype.setTabStripItems = function (items) {
        var _this = this;
        var length = items ? items.length : 0;
        if (length === 0) {
            this._tabsBar.setItems(null, null);
            return;
        }
        var tabItems = new Array();
        items.forEach(function (item, i, arr) {
            item.index = i;
            var tabItemSpec = _this.createTabItemSpec(item);
            item.tabItemSpec = tabItemSpec;
            tabItems.push(tabItemSpec);
        });
        var tabsBar = this._tabsBar;
        tabsBar.setItems(tabItems, this._viewPager);
        this.tabStrip.setNativeView(tabsBar);
        items.forEach(function (item, i, arr) {
            var tv = tabsBar.getTextViewForItemAt(i);
            item.setNativeView(tv);
        });
    };
    Tabs.prototype.createTabItemSpec = function (tabStripItem) {
        var tabItemSpec = new org.nativescript.widgets.TabItemSpec();
        if (tabStripItem.isLoaded) {
            var nestedLabel = tabStripItem.label;
            var title = nestedLabel.text;
            var textTransform = nestedLabel.style.textTransform;
            if (textTransform) {
                title = text_base_1.getTransformedText(title, textTransform);
            }
            tabItemSpec.title = title;
            var backgroundColor = tabStripItem.style.backgroundColor;
            if (backgroundColor) {
                tabItemSpec.backgroundColor = backgroundColor.android;
            }
            var color = nestedLabel.style.color;
            if (color) {
                tabItemSpec.color = color.android;
            }
            var fontInternal = nestedLabel.style.fontInternal;
            if (fontInternal) {
                tabItemSpec.fontSize = fontInternal.fontSize;
                tabItemSpec.typeFace = fontInternal.getAndroidTypeface();
            }
            var iconSource = tabStripItem.image && tabStripItem.image.src;
            if (iconSource) {
                var icon = this.getIcon(tabStripItem);
                if (icon) {
                    tabItemSpec.iconDrawable = icon;
                }
                else {
                }
            }
        }
        return tabItemSpec;
    };
    Tabs.prototype.getIcon = function (tabStripItem) {
        var iconSource = tabStripItem.image && tabStripItem.image.src;
        var is;
        if (utils_1.isFontIconURI(iconSource)) {
            var fontIconCode = iconSource.split("//")[1];
            var target = tabStripItem.image ? tabStripItem.image : tabStripItem;
            var font = target.style.fontInternal;
            var color = target.style.color;
            is = image_source_1.fromFontIconCode(fontIconCode, font, color);
        }
        else {
            is = image_source_1.fromFileOrResource(iconSource);
        }
        var imageDrawable;
        if (is && is.android) {
            var image = is.android;
            if (this.tabStrip && this.tabStrip.isIconSizeFixed) {
                image = this.getFixedSizeIcon(image);
            }
            imageDrawable = new android.graphics.drawable.BitmapDrawable(application.android.context.getResources(), image);
        }
        else {
        }
        return imageDrawable;
    };
    Tabs.prototype.getFixedSizeIcon = function (image) {
        var inWidth = image.getWidth();
        var inHeight = image.getHeight();
        var iconSpecSize = tab_navigation_base_1.getIconSpecSize({ width: inWidth, height: inHeight });
        var widthPixels = iconSpecSize.width * utils_1.layout.getDisplayDensity();
        var heightPixels = iconSpecSize.height * utils_1.layout.getDisplayDensity();
        var scaledImage = android.graphics.Bitmap.createScaledBitmap(image, widthPixels, heightPixels, true);
        return scaledImage;
    };
    Tabs.prototype.updateAndroidItemAt = function (index, spec) {
        this._tabsBar.updateItemAt(index, spec);
    };
    Tabs.prototype.getTabBarBackgroundColor = function () {
        return this._tabsBar.getBackground();
    };
    Tabs.prototype.setTabBarBackgroundColor = function (value) {
        if (value instanceof view_1.Color) {
            this._tabsBar.setBackgroundColor(value.android);
        }
        else {
            this._tabsBar.setBackground(tryCloneDrawable(value, this.nativeViewProtected.getResources));
        }
    };
    Tabs.prototype.getTabBarHighlightColor = function () {
        return getDefaultAccentColor(this._context);
    };
    Tabs.prototype.setTabBarHighlightColor = function (value) {
        var color = value instanceof view_1.Color ? value.android : value;
        this._tabsBar.setSelectedIndicatorColors([color]);
    };
    Tabs.prototype.setTabBarItemTitle = function (tabStripItem, value) {
        var tabStripItemIndex = this.tabStrip.items.indexOf(tabStripItem);
        var tabItemSpec = this.createTabItemSpec(tabStripItem);
        this.updateAndroidItemAt(tabStripItemIndex, tabItemSpec);
    };
    Tabs.prototype.setTabBarItemBackgroundColor = function (tabStripItem, value) {
        var tabStripItemIndex = this.tabStrip.items.indexOf(tabStripItem);
        var tabItemSpec = this.createTabItemSpec(tabStripItem);
        this.updateAndroidItemAt(tabStripItemIndex, tabItemSpec);
    };
    Tabs.prototype.setTabBarItemColor = function (tabStripItem, value) {
        if (typeof value === "number") {
            tabStripItem.nativeViewProtected.setTextColor(value);
        }
        else {
            tabStripItem.nativeViewProtected.setTextColor(value.android);
        }
    };
    Tabs.prototype.setTabBarIconColor = function (tabStripItem, value) {
        var index = tabStripItem.index;
        var tabBarItem = this._tabsBar.getViewForItemAt(index);
        var imgView = tabBarItem.getChildAt(0);
        var drawable = this.getIcon(tabStripItem);
        imgView.setImageDrawable(drawable);
    };
    Tabs.prototype.setTabBarItemFontInternal = function (tabStripItem, value) {
        tabStripItem.nativeViewProtected.setTextSize(value.fontSize);
        tabStripItem.nativeViewProtected.setTypeface(value.getAndroidTypeface());
    };
    Tabs.prototype.setTabBarItemTextTransform = function (tabStripItem, value) {
        var nestedLabel = tabStripItem.label;
        var title = text_base_1.getTransformedText(nestedLabel.text, value);
        tabStripItem.nativeViewProtected.setText(title);
    };
    Tabs.prototype[tab_navigation_base_1.selectedIndexProperty.setNative] = function (value) {
        var smoothScroll = true;
        this._viewPager.setCurrentItem(value, smoothScroll);
    };
    Tabs.prototype[tab_navigation_base_1.itemsProperty.getDefault] = function () {
        return null;
    };
    Tabs.prototype[tab_navigation_base_1.itemsProperty.setNative] = function (value) {
        this.setItems(value);
        tab_navigation_base_1.selectedIndexProperty.coerce(this);
    };
    Tabs.prototype[tab_navigation_base_1.tabStripProperty.getDefault] = function () {
        return null;
    };
    Tabs.prototype[tab_navigation_base_1.tabStripProperty.setNative] = function (value) {
        this.setTabStripItems(value.items);
    };
    Tabs.prototype[tabs_common_1.swipeEnabledProperty.getDefault] = function () {
        return true;
    };
    Tabs.prototype[tabs_common_1.swipeEnabledProperty.setNative] = function (value) {
        this._viewPager.setSwipePageEnabled(value);
    };
    Tabs.prototype[tabs_common_1.offscreenTabLimitProperty.getDefault] = function () {
        return this._viewPager.getOffscreenPageLimit();
    };
    Tabs.prototype[tabs_common_1.offscreenTabLimitProperty.setNative] = function (value) {
        this._viewPager.setOffscreenPageLimit(value);
    };
    return Tabs;
}(tabs_common_1.TabsBase));
exports.Tabs = Tabs;
function tryCloneDrawable(value, resources) {
    if (value) {
        var constantState = value.getConstantState();
        if (constantState) {
            return constantState.newDrawable(resources);
        }
    }
    return value;
}
//# sourceMappingURL=tabs.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-base/text-base-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var formatted_string_1 = __webpack_require__("../node_modules/tns-core-modules/text/formatted-string.js");
exports.FormattedString = formatted_string_1.FormattedString;
exports.Span = formatted_string_1.Span;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var CHILD_SPAN = "Span";
var CHILD_FORMATTED_TEXT = "formattedText";
var CHILD_FORMATTED_STRING = "FormattedString";
var TextBaseCommon = (function (_super) {
    __extends(TextBaseCommon, _super);
    function TextBaseCommon() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(TextBaseCommon.prototype, "nativeTextViewProtected", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontFamily", {
        get: function () {
            return this.style.fontFamily;
        },
        set: function (value) {
            this.style.fontFamily = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontSize", {
        get: function () {
            return this.style.fontSize;
        },
        set: function (value) {
            this.style.fontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontStyle", {
        get: function () {
            return this.style.fontStyle;
        },
        set: function (value) {
            this.style.fontStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontWeight", {
        get: function () {
            return this.style.fontWeight;
        },
        set: function (value) {
            this.style.fontWeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "letterSpacing", {
        get: function () {
            return this.style.letterSpacing;
        },
        set: function (value) {
            this.style.letterSpacing = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "lineHeight", {
        get: function () {
            return this.style.lineHeight;
        },
        set: function (value) {
            this.style.lineHeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "textAlignment", {
        get: function () {
            return this.style.textAlignment;
        },
        set: function (value) {
            this.style.textAlignment = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "textDecoration", {
        get: function () {
            return this.style.textDecoration;
        },
        set: function (value) {
            this.style.textDecoration = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "textTransform", {
        get: function () {
            return this.style.textTransform;
        },
        set: function (value) {
            this.style.textTransform = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "whiteSpace", {
        get: function () {
            return this.style.whiteSpace;
        },
        set: function (value) {
            this.style.whiteSpace = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "padding", {
        get: function () {
            return this.style.padding;
        },
        set: function (value) {
            this.style.padding = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingTop", {
        get: function () {
            return this.style.paddingTop;
        },
        set: function (value) {
            this.style.paddingTop = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingRight", {
        get: function () {
            return this.style.paddingRight;
        },
        set: function (value) {
            this.style.paddingRight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingBottom", {
        get: function () {
            return this.style.paddingBottom;
        },
        set: function (value) {
            this.style.paddingBottom = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingLeft", {
        get: function () {
            return this.style.paddingLeft;
        },
        set: function (value) {
            this.style.paddingLeft = value;
        },
        enumerable: true,
        configurable: true
    });
    TextBaseCommon.prototype._onFormattedTextContentsChanged = function (data) {
        if (this.nativeViewProtected) {
            this[exports.formattedTextProperty.setNative](data.value);
        }
    };
    TextBaseCommon.prototype._addChildFromBuilder = function (name, value) {
        if (name === CHILD_SPAN) {
            if (!this.formattedText) {
                var formattedText = new formatted_string_1.FormattedString();
                formattedText.spans.push(value);
                this.formattedText = formattedText;
            }
            else {
                this.formattedText.spans.push(value);
            }
        }
        else if (name === CHILD_FORMATTED_TEXT || name === CHILD_FORMATTED_STRING) {
            this.formattedText = value;
        }
    };
    TextBaseCommon.prototype._requestLayoutOnTextChanged = function () {
        this.requestLayout();
    };
    TextBaseCommon.prototype.eachChild = function (callback) {
        var text = this.formattedText;
        if (text) {
            callback(text);
        }
    };
    TextBaseCommon.prototype._setNativeText = function (reset) {
        if (reset === void 0) { reset = false; }
    };
    return TextBaseCommon;
}(view_1.View));
exports.TextBaseCommon = TextBaseCommon;
TextBaseCommon.prototype._isSingleLine = false;
function isBold(fontWeight) {
    return fontWeight === "bold" || fontWeight === "700" || fontWeight === "800" || fontWeight === "900";
}
exports.isBold = isBold;
exports.textProperty = new view_1.Property({ name: "text", defaultValue: "", affectsLayout: view_1.isAndroid });
exports.textProperty.register(TextBaseCommon);
exports.formattedTextProperty = new view_1.Property({ name: "formattedText", affectsLayout: true, valueChanged: onFormattedTextPropertyChanged });
exports.formattedTextProperty.register(TextBaseCommon);
function onFormattedTextPropertyChanged(textBase, oldValue, newValue) {
    if (oldValue) {
        oldValue.off(view_1.Observable.propertyChangeEvent, textBase._onFormattedTextContentsChanged, textBase);
        textBase._removeView(oldValue);
    }
    if (newValue) {
        var oldParent = newValue.parent;
        if (oldParent) {
            oldParent._removeView(newValue);
        }
        textBase._addView(newValue);
        newValue.on(view_1.Observable.propertyChangeEvent, textBase._onFormattedTextContentsChanged, textBase);
    }
}
var textAlignmentConverter = view_1.makeParser(view_1.makeValidator("initial", "left", "center", "right"));
exports.textAlignmentProperty = new view_1.InheritedCssProperty({ name: "textAlignment", cssName: "text-align", defaultValue: "initial", valueConverter: textAlignmentConverter });
exports.textAlignmentProperty.register(view_1.Style);
var textTransformConverter = view_1.makeParser(view_1.makeValidator("initial", "none", "capitalize", "uppercase", "lowercase"));
exports.textTransformProperty = new view_1.CssProperty({ name: "textTransform", cssName: "text-transform", defaultValue: "initial", valueConverter: textTransformConverter });
exports.textTransformProperty.register(view_1.Style);
var whiteSpaceConverter = view_1.makeParser(view_1.makeValidator("initial", "normal", "nowrap"));
exports.whiteSpaceProperty = new view_1.CssProperty({ name: "whiteSpace", cssName: "white-space", defaultValue: "initial", affectsLayout: view_1.isIOS, valueConverter: whiteSpaceConverter });
exports.whiteSpaceProperty.register(view_1.Style);
var textDecorationConverter = view_1.makeParser(view_1.makeValidator("none", "underline", "line-through", "underline line-through"));
exports.textDecorationProperty = new view_1.CssProperty({ name: "textDecoration", cssName: "text-decoration", defaultValue: "none", valueConverter: textDecorationConverter });
exports.textDecorationProperty.register(view_1.Style);
exports.letterSpacingProperty = new view_1.CssProperty({ name: "letterSpacing", cssName: "letter-spacing", defaultValue: 0, affectsLayout: view_1.isIOS, valueConverter: function (v) { return parseFloat(v); } });
exports.letterSpacingProperty.register(view_1.Style);
exports.lineHeightProperty = new view_1.CssProperty({ name: "lineHeight", cssName: "line-height", affectsLayout: view_1.isIOS, valueConverter: function (v) { return parseFloat(v); } });
exports.lineHeightProperty.register(view_1.Style);
exports.resetSymbol = Symbol("textPropertyDefault");
//# sourceMappingURL=text-base-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-base/text-base.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var text_base_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base-common.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base-common.js"));
var TextTransformation;
function initializeTextTransformation() {
    if (TextTransformation) {
        return;
    }
    var TextTransformationImpl = (function (_super) {
        __extends(TextTransformationImpl, _super);
        function TextTransformationImpl(textBase) {
            var _this = _super.call(this) || this;
            _this.textBase = textBase;
            return global.__native(_this);
        }
        TextTransformationImpl.prototype.getTransformation = function (charSeq, view) {
            var formattedText = this.textBase.formattedText;
            if (formattedText) {
                return createSpannableStringBuilder(formattedText);
            }
            else {
                var text = this.textBase.text;
                var stringValue = (text === null || text === undefined) ? "" : text.toString();
                return getTransformedText(stringValue, this.textBase.textTransform);
            }
        };
        TextTransformationImpl.prototype.onFocusChanged = function (view, sourceText, focused, direction, previouslyFocusedRect) {
        };
        TextTransformationImpl = __decorate([
            Interfaces([android.text.method.TransformationMethod])
        ], TextTransformationImpl);
        return TextTransformationImpl;
    }(java.lang.Object));
    TextTransformation = TextTransformationImpl;
}
var TextBase = (function (_super) {
    __extends(TextBase, _super);
    function TextBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextBase.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        initializeTextTransformation();
        var nativeView = this.nativeTextViewProtected;
        this._defaultTransformationMethod = nativeView.getTransformationMethod();
        this._minHeight = nativeView.getMinHeight();
        this._maxHeight = nativeView.getMaxHeight();
        this._minLines = nativeView.getMinLines();
        this._maxLines = nativeView.getMaxLines();
    };
    TextBase.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        var nativeView = this.nativeTextViewProtected;
        nativeView.setSingleLine(this._isSingleLine);
        nativeView.setTransformationMethod(this._defaultTransformationMethod);
        this._defaultTransformationMethod = null;
        if (this._paintFlags !== undefined) {
            nativeView.setPaintFlags(this._paintFlags);
            this._paintFlags = undefined;
        }
        if (this._minLines !== -1) {
            nativeView.setMinLines(this._minLines);
        }
        else {
            nativeView.setMinHeight(this._minHeight);
        }
        this._minHeight = this._minLines = undefined;
        if (this._maxLines !== -1) {
            nativeView.setMaxLines(this._maxLines);
        }
        else {
            nativeView.setMaxHeight(this._maxHeight);
        }
        this._maxHeight = this._maxLines = undefined;
    };
    TextBase.prototype[text_base_common_1.textProperty.getDefault] = function () {
        return text_base_common_1.resetSymbol;
    };
    TextBase.prototype[text_base_common_1.textProperty.setNative] = function (value) {
        var reset = value === text_base_common_1.resetSymbol;
        if (!reset && this.formattedText) {
            return;
        }
        this._setNativeText(reset);
    };
    TextBase.prototype[text_base_common_1.formattedTextProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        if (!value) {
            if (nativeView instanceof android.widget.Button &&
                nativeView.getTransformationMethod() instanceof TextTransformation) {
                nativeView.setTransformationMethod(this._defaultTransformationMethod);
            }
        }
        if (this.secure) {
            return;
        }
        var spannableStringBuilder = createSpannableStringBuilder(value);
        nativeView.setText(spannableStringBuilder);
        text_base_common_1.textProperty.nativeValueChange(this, (value === null || value === undefined) ? "" : value.toString());
        if (spannableStringBuilder && nativeView instanceof android.widget.Button &&
            !(nativeView.getTransformationMethod() instanceof TextTransformation)) {
            nativeView.setTransformationMethod(new TextTransformation(this));
        }
    };
    TextBase.prototype[text_base_common_1.textTransformProperty.setNative] = function (value) {
        if (value === "initial") {
            this.nativeTextViewProtected.setTransformationMethod(this._defaultTransformationMethod);
            return;
        }
        if (this.secure) {
            return;
        }
        this.nativeTextViewProtected.setTransformationMethod(new TextTransformation(this));
    };
    TextBase.prototype[text_base_common_1.textAlignmentProperty.getDefault] = function () {
        return "initial";
    };
    TextBase.prototype[text_base_common_1.textAlignmentProperty.setNative] = function (value) {
        var verticalGravity = this.nativeTextViewProtected.getGravity() & android.view.Gravity.VERTICAL_GRAVITY_MASK;
        switch (value) {
            case "initial":
            case "left":
                this.nativeTextViewProtected.setGravity(android.view.Gravity.START | verticalGravity);
                break;
            case "center":
                this.nativeTextViewProtected.setGravity(android.view.Gravity.CENTER_HORIZONTAL | verticalGravity);
                break;
            case "right":
                this.nativeTextViewProtected.setGravity(android.view.Gravity.END | verticalGravity);
                break;
        }
    };
    TextBase.prototype[text_base_common_1.whiteSpaceProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        switch (value) {
            case "initial":
            case "normal":
                nativeView.setSingleLine(false);
                nativeView.setEllipsize(null);
                break;
            case "nowrap":
                nativeView.setSingleLine(true);
                nativeView.setEllipsize(android.text.TextUtils.TruncateAt.END);
                break;
        }
    };
    TextBase.prototype[text_base_common_1.colorProperty.getDefault] = function () {
        return this.nativeTextViewProtected.getTextColors();
    };
    TextBase.prototype[text_base_common_1.colorProperty.setNative] = function (value) {
        if (!this.formattedText || !(value instanceof text_base_common_1.Color)) {
            if (value instanceof text_base_common_1.Color) {
                this.nativeTextViewProtected.setTextColor(value.android);
            }
            else {
                this.nativeTextViewProtected.setTextColor(value);
            }
        }
    };
    TextBase.prototype[text_base_common_1.fontSizeProperty.getDefault] = function () {
        return { nativeSize: this.nativeTextViewProtected.getTextSize() };
    };
    TextBase.prototype[text_base_common_1.fontSizeProperty.setNative] = function (value) {
        if (!this.formattedText || (typeof value !== "number")) {
            if (typeof value === "number") {
                this.nativeTextViewProtected.setTextSize(value);
            }
            else {
                this.nativeTextViewProtected.setTextSize(android.util.TypedValue.COMPLEX_UNIT_PX, value.nativeSize);
            }
        }
    };
    TextBase.prototype[text_base_common_1.lineHeightProperty.getDefault] = function () {
        return this.nativeTextViewProtected.getLineSpacingExtra() / text_base_common_1.layout.getDisplayDensity();
    };
    TextBase.prototype[text_base_common_1.lineHeightProperty.setNative] = function (value) {
        this.nativeTextViewProtected.setLineSpacing(value * text_base_common_1.layout.getDisplayDensity(), 1);
    };
    TextBase.prototype[text_base_common_1.fontInternalProperty.getDefault] = function () {
        return this.nativeTextViewProtected.getTypeface();
    };
    TextBase.prototype[text_base_common_1.fontInternalProperty.setNative] = function (value) {
        if (!this.formattedText || !(value instanceof font_1.Font)) {
            this.nativeTextViewProtected.setTypeface(value instanceof font_1.Font ? value.getAndroidTypeface() : value);
        }
    };
    TextBase.prototype[text_base_common_1.textDecorationProperty.getDefault] = function (value) {
        return this._paintFlags = this.nativeTextViewProtected.getPaintFlags();
    };
    TextBase.prototype[text_base_common_1.textDecorationProperty.setNative] = function (value) {
        switch (value) {
            case "none":
                this.nativeTextViewProtected.setPaintFlags(0);
                break;
            case "underline":
                this.nativeTextViewProtected.setPaintFlags(android.graphics.Paint.UNDERLINE_TEXT_FLAG);
                break;
            case "line-through":
                this.nativeTextViewProtected.setPaintFlags(android.graphics.Paint.STRIKE_THRU_TEXT_FLAG);
                break;
            case "underline line-through":
                this.nativeTextViewProtected.setPaintFlags(android.graphics.Paint.UNDERLINE_TEXT_FLAG | android.graphics.Paint.STRIKE_THRU_TEXT_FLAG);
                break;
            default:
                this.nativeTextViewProtected.setPaintFlags(value);
                break;
        }
    };
    TextBase.prototype[text_base_common_1.letterSpacingProperty.getDefault] = function () {
        return org.nativescript.widgets.ViewHelper.getLetterspacing(this.nativeTextViewProtected);
    };
    TextBase.prototype[text_base_common_1.letterSpacingProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setLetterspacing(this.nativeTextViewProtected, value);
    };
    TextBase.prototype[text_base_common_1.paddingTopProperty.getDefault] = function () {
        return { value: this._defaultPaddingTop, unit: "px" };
    };
    TextBase.prototype[text_base_common_1.paddingTopProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingTop(this.nativeTextViewProtected, text_base_common_1.Length.toDevicePixels(value, 0) + text_base_common_1.Length.toDevicePixels(this.style.borderTopWidth, 0));
    };
    TextBase.prototype[text_base_common_1.paddingRightProperty.getDefault] = function () {
        return { value: this._defaultPaddingRight, unit: "px" };
    };
    TextBase.prototype[text_base_common_1.paddingRightProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingRight(this.nativeTextViewProtected, text_base_common_1.Length.toDevicePixels(value, 0) + text_base_common_1.Length.toDevicePixels(this.style.borderRightWidth, 0));
    };
    TextBase.prototype[text_base_common_1.paddingBottomProperty.getDefault] = function () {
        return { value: this._defaultPaddingBottom, unit: "px" };
    };
    TextBase.prototype[text_base_common_1.paddingBottomProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingBottom(this.nativeTextViewProtected, text_base_common_1.Length.toDevicePixels(value, 0) + text_base_common_1.Length.toDevicePixels(this.style.borderBottomWidth, 0));
    };
    TextBase.prototype[text_base_common_1.paddingLeftProperty.getDefault] = function () {
        return { value: this._defaultPaddingLeft, unit: "px" };
    };
    TextBase.prototype[text_base_common_1.paddingLeftProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingLeft(this.nativeTextViewProtected, text_base_common_1.Length.toDevicePixels(value, 0) + text_base_common_1.Length.toDevicePixels(this.style.borderLeftWidth, 0));
    };
    TextBase.prototype._setNativeText = function (reset) {
        if (reset === void 0) { reset = false; }
        if (reset) {
            this.nativeTextViewProtected.setText(null);
            return;
        }
        var transformedText;
        if (this.formattedText) {
            transformedText = createSpannableStringBuilder(this.formattedText);
        }
        else {
            var text = this.text;
            var stringValue = (text === null || text === undefined) ? "" : text.toString();
            transformedText = getTransformedText(stringValue, this.textTransform);
        }
        this.nativeTextViewProtected.setText(transformedText);
    };
    return TextBase;
}(text_base_common_1.TextBaseCommon));
exports.TextBase = TextBase;
function getCapitalizedString(str) {
    var words = str.split(" ");
    var newWords = [];
    for (var i = 0, length_1 = words.length; i < length_1; i++) {
        var word = words[i].toLowerCase();
        newWords.push(word.substr(0, 1).toUpperCase() + word.substring(1));
    }
    return newWords.join(" ");
}
function getTransformedText(text, textTransform) {
    if (!text || !types_1.isString(text)) {
        return "";
    }
    switch (textTransform) {
        case "uppercase":
            return text.toUpperCase();
        case "lowercase":
            return text.toLowerCase();
        case "capitalize":
            return getCapitalizedString(text);
        case "none":
        default:
            return text;
    }
}
exports.getTransformedText = getTransformedText;
function createSpannableStringBuilder(formattedString) {
    if (!formattedString || !formattedString.parent) {
        return null;
    }
    var ssb = new android.text.SpannableStringBuilder();
    for (var i = 0, spanStart = 0, spanLength = 0, length_2 = formattedString.spans.length; i < length_2; i++) {
        var span = formattedString.spans.getItem(i);
        var text = span.text;
        var textTransform = formattedString.parent.textTransform;
        var spanText = (text === null || text === undefined) ? "" : text.toString();
        if (textTransform && textTransform !== "none") {
            spanText = getTransformedText(spanText, textTransform);
        }
        spanLength = spanText.length;
        if (spanLength > 0) {
            ssb.insert(spanStart, spanText);
            setSpanModifiers(ssb, span, spanStart, spanStart + spanLength);
            spanStart += spanLength;
        }
    }
    return ssb;
}
function setSpanModifiers(ssb, span, start, end) {
    var spanStyle = span.style;
    var bold = text_base_common_1.isBold(spanStyle.fontWeight);
    var italic = spanStyle.fontStyle === "italic";
    if (bold && italic) {
        ssb.setSpan(new android.text.style.StyleSpan(android.graphics.Typeface.BOLD_ITALIC), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    else if (bold) {
        ssb.setSpan(new android.text.style.StyleSpan(android.graphics.Typeface.BOLD), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    else if (italic) {
        ssb.setSpan(new android.text.style.StyleSpan(android.graphics.Typeface.ITALIC), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    var fontFamily = span.fontFamily;
    if (fontFamily) {
        var font = new font_1.Font(fontFamily, 0, (italic) ? "italic" : "normal", (bold) ? "bold" : "normal");
        var typeface = font.getAndroidTypeface() || android.graphics.Typeface.create(fontFamily, 0);
        var typefaceSpan = new org.nativescript.widgets.CustomTypefaceSpan(fontFamily, typeface);
        ssb.setSpan(typefaceSpan, start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    var realFontSize = span.fontSize;
    if (realFontSize) {
        ssb.setSpan(new android.text.style.AbsoluteSizeSpan(realFontSize * text_base_common_1.layout.getDisplayDensity()), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    var color = span.color;
    if (color) {
        ssb.setSpan(new android.text.style.ForegroundColorSpan(color.android), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    var backgroundColor;
    if (style_properties_1.backgroundColorProperty.isSet(spanStyle)) {
        backgroundColor = spanStyle.backgroundColor;
    }
    else if (style_properties_1.backgroundColorProperty.isSet(span.parent.style)) {
        backgroundColor = span.parent.style.backgroundColor;
    }
    else if (style_properties_1.backgroundColorProperty.isSet(span.parent.parent.style)) {
        backgroundColor = span.parent.parent.style.backgroundColor;
    }
    if (backgroundColor) {
        ssb.setSpan(new android.text.style.BackgroundColorSpan(backgroundColor.android), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    var valueSource;
    if (text_base_common_1.textDecorationProperty.isSet(spanStyle)) {
        valueSource = spanStyle;
    }
    else if (text_base_common_1.textDecorationProperty.isSet(span.parent.style)) {
        valueSource = span.parent.style;
    }
    else if (text_base_common_1.textDecorationProperty.isSet(span.parent.parent.style)) {
        valueSource = span.parent.parent.style;
    }
    if (valueSource) {
        var textDecorations = valueSource.textDecoration;
        var underline_1 = textDecorations.indexOf("underline") !== -1;
        if (underline_1) {
            ssb.setSpan(new android.text.style.UnderlineSpan(), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
        }
        var strikethrough = textDecorations.indexOf("line-through") !== -1;
        if (strikethrough) {
            ssb.setSpan(new android.text.style.StrikethroughSpan(), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
        }
    }
}
//# sourceMappingURL=text-base.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-field/text-field-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var editable_text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js"));
var TextFieldBase = (function (_super) {
    __extends(TextFieldBase, _super);
    function TextFieldBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextFieldBase.returnPressEvent = "returnPress";
    TextFieldBase = __decorate([
        editable_text_base_1.CSSType("TextField")
    ], TextFieldBase);
    return TextFieldBase;
}(editable_text_base_1.EditableTextBase));
exports.TextFieldBase = TextFieldBase;
TextFieldBase.prototype.recycleNativeView = "auto";
exports.secureProperty = new editable_text_base_1.Property({ name: "secure", defaultValue: false, valueConverter: editable_text_base_1.booleanConverter });
exports.secureProperty.register(TextFieldBase);
//# sourceMappingURL=text-field-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-field/text-field.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_field_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field-common.js"));
var TextField = (function (_super) {
    __extends(TextField, _super);
    function TextField() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextField.prototype._configureEditText = function (editText) {
        editText.setInputType(android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_NORMAL | android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES | android.text.InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS);
        editText.setLines(1);
        editText.setMaxLines(1);
        editText.setHorizontallyScrolling(true);
    };
    TextField.prototype._onReturnPress = function () {
        this.notify({ eventName: TextField.returnPressEvent, object: this });
    };
    TextField.prototype[text_field_common_1.secureProperty.setNative] = function () {
        this.setSecureAndKeyboardType();
    };
    TextField.prototype[text_field_common_1.keyboardTypeProperty.setNative] = function () {
        this.setSecureAndKeyboardType();
    };
    TextField.prototype.setSecureAndKeyboardType = function () {
        var inputType;
        if (this.secure) {
            if (this.keyboardType === "number") {
                inputType = android.text.InputType.TYPE_CLASS_NUMBER | android.text.InputType.TYPE_NUMBER_VARIATION_PASSWORD;
            }
            else {
                inputType = android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_PASSWORD;
            }
        }
        else {
            inputType = android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_NORMAL;
            if (this.autocorrect) {
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_AUTO_COMPLETE;
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_AUTO_CORRECT;
                inputType = inputType & ~android.text.InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS;
            }
            switch (this.autocapitalizationType) {
                case "words":
                    inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_WORDS;
                    break;
                case "sentences":
                    inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES;
                    break;
                case "allcharacters":
                    inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_CHARACTERS;
                    break;
                default:
                    break;
            }
            switch (this.keyboardType) {
                case "datetime":
                    inputType = android.text.InputType.TYPE_CLASS_DATETIME | android.text.InputType.TYPE_DATETIME_VARIATION_NORMAL;
                    break;
                case "phone":
                    inputType = android.text.InputType.TYPE_CLASS_PHONE;
                    break;
                case "number":
                    inputType = android.text.InputType.TYPE_CLASS_NUMBER | android.text.InputType.TYPE_NUMBER_VARIATION_NORMAL | android.text.InputType.TYPE_NUMBER_FLAG_SIGNED | android.text.InputType.TYPE_NUMBER_FLAG_DECIMAL;
                    break;
                case "url":
                    inputType = android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_URI;
                    break;
                case "email":
                    inputType = android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_EMAIL_ADDRESS;
                    break;
                default:
                    break;
            }
        }
        this._setInputType(inputType);
    };
    TextField.prototype[text_field_common_1.whiteSpaceProperty.getDefault] = function () {
        return "nowrap";
    };
    TextField.prototype[text_field_common_1.whiteSpaceProperty.setNative] = function (value) {
    };
    return TextField;
}(text_field_common_1.TextFieldBase));
exports.TextField = TextField;
TextField.prototype._isSingleLine = true;
//# sourceMappingURL=text-field.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-view/text-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var editable_text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var TextView = (function (_super) {
    __extends(TextView, _super);
    function TextView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextView.prototype._configureEditText = function (editText) {
        editText.setInputType(android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_NORMAL | android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES | android.text.InputType.TYPE_TEXT_FLAG_MULTI_LINE | android.text.InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS);
        editText.setGravity(android.view.Gravity.TOP | android.view.Gravity.START);
    };
    TextView.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        this.nativeTextViewProtected.setGravity(android.view.Gravity.TOP | android.view.Gravity.START);
    };
    TextView = __decorate([
        editable_text_base_1.CSSType("TextView")
    ], TextView);
    return TextView;
}(editable_text_base_1.EditableTextBase));
exports.TextView = TextView;
TextView.prototype.recycleNativeView = "auto";
//# sourceMappingURL=text-view.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/time-picker/time-picker-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var dateComparer = function (x, y) { return (x <= y && x >= y); };
function getValidTime(picker, hour, minute) {
    if (picker.minuteInterval > 1) {
        var minuteFloor = minute - (minute % picker.minuteInterval);
        minute = minuteFloor + (minute === minuteFloor + 1 ? picker.minuteInterval : 0);
        if (minute === 60) {
            hour++;
            minute = 0;
        }
    }
    var time = { hour: hour, minute: minute };
    if (!isLessThanMaxTime(picker, hour, minute)) {
        time = { hour: picker.maxHour, minute: picker.maxMinute };
    }
    if (!isGreaterThanMinTime(picker, hour, minute)) {
        time = { hour: picker.minHour, minute: picker.minMinute };
    }
    return time;
}
exports.getValidTime = getValidTime;
function isValidTime(picker) {
    return isGreaterThanMinTime(picker) && isLessThanMaxTime(picker);
}
function isHourValid(value) {
    return typeof value === "number" && value >= 0 && value <= 23;
}
function isMinuteValid(value) {
    return typeof value === "number" && value >= 0 && value <= 59;
}
function isMinuteIntervalValid(value) {
    return typeof value === "number" && value >= 1 && value <= 30 && 60 % value === 0;
}
function getMinutes(hour) {
    return hour * 60;
}
function isDefined(value) {
    return value !== undefined;
}
exports.isDefined = isDefined;
function isGreaterThanMinTime(picker, hour, minute) {
    if (picker.minHour === undefined || picker.minMinute === undefined) {
        return true;
    }
    return getMinutes(hour !== undefined ? hour : picker.hour) + (minute !== undefined ? minute : picker.minute) >= getMinutes(picker.minHour) + picker.minMinute;
}
function isLessThanMaxTime(picker, hour, minute) {
    if (!isDefined(picker.maxHour) || !isDefined(picker.maxMinute)) {
        return true;
    }
    return getMinutes(isDefined(hour) ? hour : picker.hour) + (isDefined(minute) ? minute : picker.minute) <= getMinutes(picker.maxHour) + picker.maxMinute;
}
function toString(value) {
    if (value instanceof Date) {
        return value + "";
    }
    return value < 10 ? "0" + value : "" + value;
}
function getMinMaxTimeErrorMessage(picker) {
    return "Min time: (" + toString(picker.minHour) + ":" + toString(picker.minMinute) + "), max time: (" + toString(picker.maxHour) + ":" + toString(picker.maxMinute) + ")";
}
function getErrorMessage(picker, propertyName, newValue) {
    return propertyName + " property value (" + toString(newValue) + ":" + toString(picker.minute) + ") is not valid. " + getMinMaxTimeErrorMessage(picker) + ".";
}
var TimePickerBase = (function (_super) {
    __extends(TimePickerBase, _super);
    function TimePickerBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TimePickerBase = __decorate([
        view_1.CSSType("TimePicker")
    ], TimePickerBase);
    return TimePickerBase;
}(view_1.View));
exports.TimePickerBase = TimePickerBase;
TimePickerBase.prototype.recycleNativeView = "auto";
exports.minHourProperty = new view_1.Property({
    name: "minHour", defaultValue: 0, valueChanged: function (picker, oldValue, newValue) {
        if (!isHourValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "minHour", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.minHourProperty.register(TimePickerBase);
exports.maxHourProperty = new view_1.Property({
    name: "maxHour", defaultValue: 23, valueChanged: function (picker, oldValue, newValue) {
        if (!isHourValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "maxHour", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.maxHourProperty.register(TimePickerBase);
exports.minMinuteProperty = new view_1.Property({
    name: "minMinute", defaultValue: 0, valueChanged: function (picker, oldValue, newValue) {
        if (!isMinuteValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "minMinute", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.minMinuteProperty.register(TimePickerBase);
exports.maxMinuteProperty = new view_1.Property({
    name: "maxMinute", defaultValue: 59, valueChanged: function (picker, oldValue, newValue) {
        if (!isMinuteValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "maxMinute", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.maxMinuteProperty.register(TimePickerBase);
exports.minuteIntervalProperty = new view_1.Property({
    name: "minuteInterval", defaultValue: 1, valueChanged: function (picker, oldValue, newValue) {
        if (!isMinuteIntervalValid(newValue)) {
            throw new Error(getErrorMessage(picker, "minuteInterval", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.minuteIntervalProperty.register(TimePickerBase);
exports.minuteProperty = new view_1.Property({
    name: "minute", defaultValue: 0, valueChanged: function (picker, oldValue, newValue) {
        if (!isMinuteValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "minute", newValue));
        }
        picker.time = new Date(0, 0, 0, picker.hour, picker.minute);
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.minuteProperty.register(TimePickerBase);
exports.hourProperty = new view_1.Property({
    name: "hour", defaultValue: 0, valueChanged: function (picker, oldValue, newValue) {
        if (!isHourValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "Hour", newValue));
        }
        picker.time = new Date(0, 0, 0, picker.hour, picker.minute);
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.hourProperty.register(TimePickerBase);
exports.timeProperty = new view_1.Property({
    name: "time", defaultValue: new Date(), equalityComparer: dateComparer,
    valueChanged: function (picker, oldValue, newValue) {
        if (!isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "time", newValue));
        }
        picker.hour = newValue.getHours();
        picker.minute = newValue.getMinutes();
    }
});
exports.timeProperty.register(TimePickerBase);
//# sourceMappingURL=time-picker-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/time-picker/time-picker.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var time_picker_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/time-picker/time-picker-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/time-picker/time-picker-common.js"));
var TimeChangedListener;
function initializeTimeChangedListener() {
    if (TimeChangedListener) {
        return;
    }
    apiLevel = android.os.Build.VERSION.SDK_INT;
    var TimeChangedListenerImpl = (function (_super) {
        __extends(TimeChangedListenerImpl, _super);
        function TimeChangedListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        TimeChangedListenerImpl.prototype.onTimeChanged = function (picker, hour, minute) {
            var timePicker = this.owner;
            if (timePicker.updatingNativeValue) {
                return;
            }
            var validTime = time_picker_common_1.getValidTime(timePicker, hour, minute);
            time_picker_common_1.timeProperty.nativeValueChange(timePicker, new Date(0, 0, 0, validTime.hour, validTime.minute));
        };
        TimeChangedListenerImpl = __decorate([
            Interfaces([android.widget.TimePicker.OnTimeChangedListener])
        ], TimeChangedListenerImpl);
        return TimeChangedListenerImpl;
    }(java.lang.Object));
    TimeChangedListener = TimeChangedListenerImpl;
}
var apiLevel;
var TimePicker = (function (_super) {
    __extends(TimePicker, _super);
    function TimePicker() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TimePicker.prototype.createNativeView = function () {
        return new android.widget.TimePicker(this._context);
    };
    TimePicker.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        initializeTimeChangedListener();
        var listener = new TimeChangedListener(this);
        nativeView.setOnTimeChangedListener(listener);
        nativeView.listener = listener;
        var calendar = nativeView.calendar = java.util.Calendar.getInstance();
        var hour = time_picker_common_1.hourProperty.isSet(this) ? this.hour : calendar.get(java.util.Calendar.HOUR_OF_DAY);
        var minute = time_picker_common_1.minuteProperty.isSet(this) ? this.minute : calendar.get(java.util.Calendar.MINUTE);
        var validTime = time_picker_common_1.getValidTime(this, hour, minute);
        if (!time_picker_common_1.timeProperty.isSet(this)) {
            this.time = new Date(0, 0, 0, validTime.hour, validTime.minute);
        }
    };
    TimePicker.prototype[time_picker_common_1.minuteProperty.setNative] = function (value) {
        this.updatingNativeValue = true;
        try {
            if (apiLevel >= 23) {
                this.nativeViewProtected.setMinute(value);
            }
            else {
                this.nativeViewProtected.setCurrentMinute(new java.lang.Integer(value));
            }
        }
        finally {
            this.updatingNativeValue = false;
        }
    };
    TimePicker.prototype[time_picker_common_1.hourProperty.setNative] = function (value) {
        this.updatingNativeValue = true;
        try {
            if (apiLevel >= 23) {
                this.nativeViewProtected.setHour(value);
            }
            else {
                this.nativeViewProtected.setCurrentHour(new java.lang.Integer(value));
            }
        }
        finally {
            this.updatingNativeValue = false;
        }
    };
    return TimePicker;
}(time_picker_common_1.TimePickerBase));
exports.TimePicker = TimePicker;
//# sourceMappingURL=time-picker.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/fade-transition.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/transition.js");
var FadeTransition = (function (_super) {
    __extends(FadeTransition, _super);
    function FadeTransition() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    FadeTransition.prototype.createAndroidAnimator = function (transitionType) {
        var alphaValues = Array.create("float", 2);
        switch (transitionType) {
            case transition_1.AndroidTransitionType.enter:
            case transition_1.AndroidTransitionType.popEnter:
                alphaValues[0] = 0;
                alphaValues[1] = 1;
                break;
            case transition_1.AndroidTransitionType.exit:
            case transition_1.AndroidTransitionType.popExit:
                alphaValues[0] = 1;
                alphaValues[1] = 0;
                break;
        }
        var animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", alphaValues);
        var duration = this.getDuration();
        if (duration !== undefined) {
            animator.setDuration(duration);
        }
        animator.setInterpolator(this.getCurve());
        return animator;
    };
    return FadeTransition;
}(transition_1.Transition));
exports.FadeTransition = FadeTransition;
//# sourceMappingURL=fade-transition.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/flip-transition.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/transition.js");
var FlipTransition = (function (_super) {
    __extends(FlipTransition, _super);
    function FlipTransition(direction, duration, curve) {
        var _this = _super.call(this, duration, curve) || this;
        _this._direction = direction;
        return _this;
    }
    FlipTransition.prototype.createAndroidAnimator = function (transitionType) {
        var objectAnimators;
        var values;
        var animator;
        var animatorSet = new android.animation.AnimatorSet();
        var fullDuration = this.getDuration() || 300;
        var interpolator = this.getCurve();
        var rotationY = this._direction === "right" ? 180 : -180;
        switch (transitionType) {
            case transition_1.AndroidTransitionType.enter:
                objectAnimators = Array.create(android.animation.Animator, 3);
                values = Array.create("float", 2);
                values[0] = 1.0;
                values[1] = 0.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", values);
                animator.setDuration(0);
                objectAnimators[0] = animator;
                values = Array.create("float", 2);
                values[0] = rotationY;
                values[1] = 0.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "rotationY", values);
                animator.setInterpolator(interpolator);
                animator.setDuration(fullDuration);
                objectAnimators[1] = animator;
                values = Array.create("float", 2);
                values[0] = 0.0;
                values[1] = 1.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", values);
                animator.setStartDelay(fullDuration / 2);
                animator.setDuration(1);
                objectAnimators[2] = animator;
                break;
            case transition_1.AndroidTransitionType.exit:
                objectAnimators = Array.create(android.animation.Animator, 2);
                values = Array.create("float", 2);
                values[0] = 0.0;
                values[1] = -rotationY;
                animator = android.animation.ObjectAnimator.ofFloat(null, "rotationY", values);
                animator.setInterpolator(interpolator);
                animator.setDuration(fullDuration);
                objectAnimators[0] = animator;
                values = Array.create("float", 2);
                values[0] = 1.0;
                values[1] = 0.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", values);
                animator.setStartDelay(fullDuration / 2);
                animator.setDuration(1);
                objectAnimators[1] = animator;
                break;
            case transition_1.AndroidTransitionType.popEnter:
                objectAnimators = Array.create(android.animation.Animator, 3);
                values = Array.create("float", 2);
                values[0] = 1.0;
                values[1] = 0.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", values);
                animator.setDuration(0);
                objectAnimators[0] = animator;
                values = Array.create("float", 2);
                values[0] = -rotationY;
                values[1] = 0.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "rotationY", values);
                animator.setInterpolator(interpolator);
                animator.setDuration(fullDuration);
                objectAnimators[1] = animator;
                values = Array.create("float", 2);
                values[0] = 0.0;
                values[1] = 1.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", values);
                animator.setStartDelay(fullDuration / 2);
                animator.setDuration(1);
                objectAnimators[2] = animator;
                break;
            case transition_1.AndroidTransitionType.popExit:
                objectAnimators = Array.create(android.animation.Animator, 2);
                values = Array.create("float", 2);
                values[0] = 0.0;
                values[1] = rotationY;
                animator = android.animation.ObjectAnimator.ofFloat(null, "rotationY", values);
                animator.setInterpolator(interpolator);
                animator.setDuration(fullDuration);
                objectAnimators[0] = animator;
                values = Array.create("float", 2);
                values[0] = 1.0;
                values[1] = 0.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", values);
                animator.setStartDelay(fullDuration / 2);
                animator.setDuration(1);
                objectAnimators[1] = animator;
                break;
        }
        animatorSet.playTogether(objectAnimators);
        return animatorSet;
    };
    return FlipTransition;
}(transition_1.Transition));
exports.FlipTransition = FlipTransition;
//# sourceMappingURL=flip-transition.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/slide-transition.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var transition = __webpack_require__("../node_modules/tns-core-modules/ui/transition/transition.js");
var platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
var screenWidth = lazy_1.default(function () { return platform.screen.mainScreen.widthPixels; });
var screenHeight = lazy_1.default(function () { return platform.screen.mainScreen.heightPixels; });
var SlideTransition = (function (_super) {
    __extends(SlideTransition, _super);
    function SlideTransition(direction, duration, curve) {
        var _this = _super.call(this, duration, curve) || this;
        _this._direction = direction;
        return _this;
    }
    SlideTransition.prototype.createAndroidAnimator = function (transitionType) {
        var translationValues = Array.create("float", 2);
        switch (this._direction) {
            case "left":
                switch (transitionType) {
                    case transition.AndroidTransitionType.enter:
                        translationValues[0] = screenWidth();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.exit:
                        translationValues[0] = 0;
                        translationValues[1] = -screenWidth();
                        break;
                    case transition.AndroidTransitionType.popEnter:
                        translationValues[0] = -screenWidth();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.popExit:
                        translationValues[0] = 0;
                        translationValues[1] = screenWidth();
                        break;
                }
                break;
            case "right":
                switch (transitionType) {
                    case transition.AndroidTransitionType.enter:
                        translationValues[0] = -screenWidth();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.exit:
                        translationValues[0] = 0;
                        translationValues[1] = screenWidth();
                        break;
                    case transition.AndroidTransitionType.popEnter:
                        translationValues[0] = screenWidth();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.popExit:
                        translationValues[0] = 0;
                        translationValues[1] = -screenWidth();
                        break;
                }
                break;
            case "top":
                switch (transitionType) {
                    case transition.AndroidTransitionType.enter:
                        translationValues[0] = screenHeight();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.exit:
                        translationValues[0] = 0;
                        translationValues[1] = -screenHeight();
                        break;
                    case transition.AndroidTransitionType.popEnter:
                        translationValues[0] = -screenHeight();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.popExit:
                        translationValues[0] = 0;
                        translationValues[1] = screenHeight();
                        break;
                }
                break;
            case "bottom":
                switch (transitionType) {
                    case transition.AndroidTransitionType.enter:
                        translationValues[0] = -screenHeight();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.exit:
                        translationValues[0] = 0;
                        translationValues[1] = screenHeight();
                        break;
                    case transition.AndroidTransitionType.popEnter:
                        translationValues[0] = screenHeight();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.popExit:
                        translationValues[0] = 0;
                        translationValues[1] = -screenHeight();
                        break;
                }
                break;
        }
        var prop;
        if (this._direction === "left" || this._direction === "right") {
            prop = "translationX";
        }
        else {
            prop = "translationY";
        }
        var animator = android.animation.ObjectAnimator.ofFloat(null, prop, translationValues);
        var duration = this.getDuration();
        if (duration !== undefined) {
            animator.setDuration(duration);
        }
        animator.setInterpolator(this.getCurve());
        return animator;
    };
    SlideTransition.prototype.toString = function () {
        return _super.prototype.toString.call(this) + " " + this._direction;
    };
    return SlideTransition;
}(transition.Transition));
exports.SlideTransition = SlideTransition;
//# sourceMappingURL=slide-transition.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/transition.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var animation_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
var _defaultInterpolator = lazy_1.default(function () { return new android.view.animation.AccelerateDecelerateInterpolator(); });
var AndroidTransitionType;
(function (AndroidTransitionType) {
    AndroidTransitionType.enter = "enter";
    AndroidTransitionType.exit = "exit";
    AndroidTransitionType.popEnter = "popEnter";
    AndroidTransitionType.popExit = "popExit";
})(AndroidTransitionType = exports.AndroidTransitionType || (exports.AndroidTransitionType = {}));
var transitionId = 0;
var Transition = (function () {
    function Transition(duration, curve) {
        this._duration = duration;
        this._interpolator = curve ? animation_1._resolveAnimationCurve(curve) : _defaultInterpolator();
        this._id = transitionId++;
    }
    Transition.prototype.getDuration = function () {
        return this._duration;
    };
    Transition.prototype.getCurve = function () {
        return this._interpolator;
    };
    Transition.prototype.animateIOSTransition = function (containerView, fromView, toView, operation, completion) {
        throw new Error("Abstract method call");
    };
    Transition.prototype.createAndroidAnimator = function (transitionType) {
        throw new Error("Abstract method call");
    };
    Transition.prototype.toString = function () {
        return "Transition@" + this._id;
    };
    return Transition;
}());
exports.Transition = Transition;
//# sourceMappingURL=transition.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/web-view/web-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
exports.File = file_system_1.File;
exports.knownFolders = file_system_1.knownFolders;
exports.path = file_system_1.path;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
exports.srcProperty = new view_1.Property({ name: "src" });
var WebViewBase = (function (_super) {
    __extends(WebViewBase, _super);
    function WebViewBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WebViewBase_1 = WebViewBase;
    WebViewBase.prototype._onLoadFinished = function (url, error) {
        var args = {
            eventName: WebViewBase_1.loadFinishedEvent,
            object: this,
            url: url,
            navigationType: undefined,
            error: error
        };
        this.notify(args);
    };
    WebViewBase.prototype._onLoadStarted = function (url, navigationType) {
        var args = {
            eventName: WebViewBase_1.loadStartedEvent,
            object: this,
            url: url,
            navigationType: navigationType,
            error: undefined
        };
        this.notify(args);
    };
    Object.defineProperty(WebViewBase.prototype, "canGoBack", {
        get: function () {
            throw new Error("This member is abstract.");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebViewBase.prototype, "canGoForward", {
        get: function () {
            throw new Error("This member is abstract.");
        },
        enumerable: true,
        configurable: true
    });
    WebViewBase.prototype[exports.srcProperty.getDefault] = function () {
        return "";
    };
    WebViewBase.prototype[exports.srcProperty.setNative] = function (src) {
        this.stopLoading();
        if (src.indexOf("~/") === 0) {
            src = "file:///" + file_system_1.knownFolders.currentApp().path + "/" + src.substr(2);
        }
        else if (src.indexOf("/") === 0) {
            src = "file://" + src;
        }
        if (src.toLowerCase().indexOf("file:///") === 0) {
            src = encodeURI(src);
        }
        if (src.toLowerCase().indexOf("http://") === 0 ||
            src.toLowerCase().indexOf("https://") === 0 ||
            src.toLowerCase().indexOf("file:///") === 0) {
            this._loadUrl(src);
        }
        else {
            this._loadData(src);
        }
    };
    var WebViewBase_1;
    WebViewBase.loadStartedEvent = "loadStarted";
    WebViewBase.loadFinishedEvent = "loadFinished";
    WebViewBase = WebViewBase_1 = __decorate([
        view_1.CSSType("WebView")
    ], WebViewBase);
    return WebViewBase;
}(view_1.ContainerView));
exports.WebViewBase = WebViewBase;
exports.srcProperty.register(WebViewBase);
//# sourceMappingURL=web-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/web-view/web-view.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var web_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/web-view/web-view-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/web-view/web-view-common.js"));
var WebViewClient;
function initializeWebViewClient() {
    if (WebViewClient) {
        return;
    }
    var WebViewClientImpl = (function (_super) {
        __extends(WebViewClientImpl, _super);
        function WebViewClientImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        WebViewClientImpl.prototype.shouldOverrideUrlLoading = function (view, url) {
            if (web_view_common_1.traceEnabled()) {
                web_view_common_1.traceWrite("WebViewClientClass.shouldOverrideUrlLoading(" + url + ")", web_view_common_1.traceCategories.Debug);
            }
            return false;
        };
        WebViewClientImpl.prototype.onPageStarted = function (view, url, favicon) {
            _super.prototype.onPageStarted.call(this, view, url, favicon);
            var owner = this.owner;
            if (owner) {
                if (web_view_common_1.traceEnabled()) {
                    web_view_common_1.traceWrite("WebViewClientClass.onPageStarted(" + url + ", " + favicon + ")", web_view_common_1.traceCategories.Debug);
                }
                owner._onLoadStarted(url, undefined);
            }
        };
        WebViewClientImpl.prototype.onPageFinished = function (view, url) {
            _super.prototype.onPageFinished.call(this, view, url);
            var owner = this.owner;
            if (owner) {
                if (web_view_common_1.traceEnabled()) {
                    web_view_common_1.traceWrite("WebViewClientClass.onPageFinished(" + url + ")", web_view_common_1.traceCategories.Debug);
                }
                owner._onLoadFinished(url, undefined);
            }
        };
        WebViewClientImpl.prototype.onReceivedError = function () {
            var view = arguments[0];
            if (arguments.length === 4) {
                var errorCode = arguments[1];
                var description = arguments[2];
                var failingUrl = arguments[3];
                _super.prototype.onReceivedError.call(this, view, errorCode, description, failingUrl);
                var owner = this.owner;
                if (owner) {
                    if (web_view_common_1.traceEnabled()) {
                        web_view_common_1.traceWrite("WebViewClientClass.onReceivedError(" + errorCode + ", " + description + ", " + failingUrl + ")", web_view_common_1.traceCategories.Debug);
                    }
                    owner._onLoadFinished(failingUrl, description + "(" + errorCode + ")");
                }
            }
            else {
                var request = arguments[1];
                var error = arguments[2];
                _super.prototype.onReceivedError.call(this, view, request, error);
                var owner = this.owner;
                if (owner) {
                    if (web_view_common_1.traceEnabled()) {
                        web_view_common_1.traceWrite("WebViewClientClass.onReceivedError(" + error.getErrorCode() + ", " + error.getDescription() + ", " + (error.getUrl && error.getUrl()) + ")", web_view_common_1.traceCategories.Debug);
                    }
                    owner._onLoadFinished(error.getUrl && error.getUrl(), error.getDescription() + "(" + error.getErrorCode() + ")");
                }
            }
        };
        return WebViewClientImpl;
    }(android.webkit.WebViewClient));
    WebViewClient = WebViewClientImpl;
}
var WebView = (function (_super) {
    __extends(WebView, _super);
    function WebView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WebView.prototype.createNativeView = function () {
        var nativeView = new android.webkit.WebView(this._context);
        nativeView.getSettings().setJavaScriptEnabled(true);
        nativeView.getSettings().setBuiltInZoomControls(true);
        return nativeView;
    };
    WebView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        initializeWebViewClient();
        var nativeView = this.nativeViewProtected;
        var client = new WebViewClient(this);
        nativeView.setWebViewClient(client);
        nativeView.client = client;
    };
    WebView.prototype.disposeNativeView = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            nativeView.destroy();
        }
        nativeView.client.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    WebView.prototype._loadUrl = function (src) {
        var nativeView = this.nativeViewProtected;
        if (!nativeView) {
            return;
        }
        nativeView.loadUrl(src);
    };
    WebView.prototype._loadData = function (src) {
        var nativeView = this.nativeViewProtected;
        if (!nativeView) {
            return;
        }
        var baseUrl = "file:///" + web_view_common_1.knownFolders.currentApp().path + "/";
        nativeView.loadDataWithBaseURL(baseUrl, src, "text/html", "utf-8", null);
    };
    Object.defineProperty(WebView.prototype, "canGoBack", {
        get: function () {
            return this.nativeViewProtected.canGoBack();
        },
        enumerable: true,
        configurable: true
    });
    WebView.prototype.stopLoading = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            nativeView.stopLoading();
        }
    };
    Object.defineProperty(WebView.prototype, "canGoForward", {
        get: function () {
            var nativeView = this.nativeViewProtected;
            if (nativeView) {
                return nativeView.canGoForward();
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    WebView.prototype.goBack = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            return nativeView.goBack();
        }
    };
    WebView.prototype.goForward = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            return nativeView.goForward();
        }
    };
    WebView.prototype.reload = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            return nativeView.reload();
        }
    };
    return WebView;
}(web_view_common_1.WebViewBase));
exports.WebView = WebView;
//# sourceMappingURL=web-view.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/debug.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
exports.debug = true;
var applicationRootPath;
function ensureAppRootPath() {
    if (!applicationRootPath) {
        applicationRootPath = file_system_1.knownFolders.currentApp().path;
        applicationRootPath = applicationRootPath.substr(0, applicationRootPath.length - "app/".length);
    }
}
var Source = (function () {
    function Source(uri, line, column) {
        ensureAppRootPath();
        if (uri.length > applicationRootPath.length && uri.substr(0, applicationRootPath.length) === applicationRootPath) {
            this._uri = "file://" + uri.substr(applicationRootPath.length);
        }
        else {
            this._uri = uri;
        }
        this._line = line;
        this._column = column;
    }
    Object.defineProperty(Source.prototype, "uri", {
        get: function () { return this._uri; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Source.prototype, "line", {
        get: function () { return this._line; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Source.prototype, "column", {
        get: function () { return this._column; },
        enumerable: true,
        configurable: true
    });
    Source.prototype.toString = function () {
        return this._uri + ":" + this._line + ":" + this._column;
    };
    Source.get = function (object) {
        return object[Source._source];
    };
    Source.set = function (object, src) {
        object[Source._source] = src;
    };
    Source._source = Symbol("source");
    return Source;
}());
exports.Source = Source;
var ScopeError = (function (_super) {
    __extends(ScopeError, _super);
    function ScopeError(inner, message) {
        var _this = this;
        var formattedMessage;
        if (message && inner.message) {
            formattedMessage = message + "\n > " + inner.message.replace("\n", "\n  ");
        }
        else {
            formattedMessage = message || inner.message || undefined;
        }
        _this = _super.call(this, formattedMessage) || this;
        _this.stack = platform_1.isAndroid ? "Error: " + _this.message + "\n" + inner.stack.substr(inner.stack.indexOf("\n") + 1) : inner.stack;
        _this.message = formattedMessage;
        return _this;
    }
    return ScopeError;
}(Error));
exports.ScopeError = ScopeError;
var SourceError = (function (_super) {
    __extends(SourceError, _super);
    function SourceError(child, source, message) {
        return _super.call(this, child, message ? message + " @" + source + "" : source + "") || this;
    }
    return SourceError;
}(ScopeError));
exports.SourceError = SourceError;
//# sourceMappingURL=debug.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/lazy.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function lazy(action) {
    var _value;
    return function () { return _value || (_value = action()); };
}
exports.default = lazy;
//# sourceMappingURL=lazy.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/mainthread-helper.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function dispatchToMainThread(func) {
    new android.os.Handler(android.os.Looper.getMainLooper())
        .post(new java.lang.Runnable({
        run: func
    }));
}
exports.dispatchToMainThread = dispatchToMainThread;
function isMainThread() {
    return android.os.Looper.myLooper() === android.os.Looper.getMainLooper();
}
exports.isMainThread = isMainThread;
//# sourceMappingURL=mainthread-helper.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/number-utils.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var epsilon = 1E-05;
function areClose(value1, value2) {
    return (Math.abs(value1 - value2) < epsilon);
}
exports.areClose = areClose;
function greaterThanOrClose(value1, value2) {
    return (value1 > value2) || areClose(value1, value2);
}
exports.greaterThanOrClose = greaterThanOrClose;
function greaterThan(value1, value2) {
    return (value1 > value2) && !areClose(value1, value2);
}
exports.greaterThan = greaterThan;
function lessThan(value1, value2) {
    return (value1 < value2) && !areClose(value1, value2);
}
exports.lessThan = lessThan;
function isZero(value) {
    return (Math.abs(value) < epsilon);
}
exports.isZero = isZero;
function greaterThanZero(value) {
    return value > 0;
}
exports.greaterThanZero = greaterThanZero;
function notNegative(value) {
    return value >= 0;
}
exports.notNegative = notNegative;
exports.radiansToDegrees = function (a) { return a * (180 / Math.PI); };
exports.degreesToRadians = function (a) { return a * (Math.PI / 180); };
//# sourceMappingURL=number-utils.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/types.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function isString(value) {
    return typeof value === "string" || value instanceof String;
}
exports.isString = isString;
function isNumber(value) {
    return typeof value === "number" || value instanceof Number;
}
exports.isNumber = isNumber;
function isBoolean(value) {
    return typeof value === "boolean" || value instanceof Boolean;
}
exports.isBoolean = isBoolean;
function isFunction(value) {
    if (!value) {
        return false;
    }
    return typeof value === "function";
}
exports.isFunction = isFunction;
function isObject(value) {
    if (!value) {
        return false;
    }
    return typeof value === "object";
}
exports.isObject = isObject;
function isUndefined(value) {
    return value === undefined;
}
exports.isUndefined = isUndefined;
function isDefined(value) {
    return typeof value !== "undefined";
}
exports.isDefined = isDefined;
function isNullOrUndefined(value) {
    return value === undefined || value === null;
}
exports.isNullOrUndefined = isNullOrUndefined;
function verifyCallback(value) {
    if (value && !isFunction(value)) {
        throw new TypeError("Callback must be a valid function.");
    }
}
exports.verifyCallback = verifyCallback;
var classInfosMap = new Map();
var funcNameRegex = /function ([_a-zA-Z0-9]{1,})\(/;
function getClass(object) {
    return getClassInfo(object).name;
}
exports.getClass = getClass;
function getClassInfo(object) {
    var constructor = object.constructor;
    var result = classInfosMap.get(constructor);
    if (!result) {
        result = new ClassInfo(constructor);
        classInfosMap.set(constructor, result);
    }
    return result;
}
exports.getClassInfo = getClassInfo;
function getBaseClasses(object) {
    var result = [];
    var info = getClassInfo(object);
    while (info) {
        result.push(info.name);
        info = info.baseClassInfo;
    }
    return result;
}
exports.getBaseClasses = getBaseClasses;
var ClassInfo = (function () {
    function ClassInfo(typeCosntructor) {
        this._typeCosntructor = typeCosntructor;
    }
    Object.defineProperty(ClassInfo.prototype, "name", {
        get: function () {
            if (!this._name) {
                var results = (funcNameRegex).exec(this._typeCosntructor.toString());
                this._name = (results && results.length > 1) ? results[1] : "";
            }
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ClassInfo.prototype, "baseClassInfo", {
        get: function () {
            if (isUndefined(this._baseClassInfo)) {
                this._baseClassInfo = ClassInfo._getBase(this);
                if (this._baseClassInfo && this._baseClassInfo.name === this.name) {
                    this._baseClassInfo = ClassInfo._getBase(this._baseClassInfo);
                }
            }
            return this._baseClassInfo;
        },
        enumerable: true,
        configurable: true
    });
    ClassInfo._getBase = function (info) {
        var result = null;
        var constructorProto = info._typeCosntructor.prototype;
        if (constructorProto.__proto__) {
            result = getClassInfo(constructorProto.__proto__);
        }
        return result;
    };
    return ClassInfo;
}());
exports.ClassInfo = ClassInfo;
function toUIString(obj) {
    return isNullOrUndefined(obj) ? "" : obj + "";
}
exports.toUIString = toUIString;
//# sourceMappingURL=types.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/utils-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var mainthread_helper_1 = __webpack_require__("../node_modules/tns-core-modules/utils/mainthread-helper.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
__export(__webpack_require__("../node_modules/tns-core-modules/utils/mainthread-helper.js"));
exports.RESOURCE_PREFIX = "res://";
exports.FILE_PREFIX = "file:///";
function escapeRegexSymbols(source) {
    var escapeRegex = /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;
    return source.replace(escapeRegex, "\\$&");
}
exports.escapeRegexSymbols = escapeRegexSymbols;
function convertString(value) {
    var result;
    if (!types.isString(value) || value.trim() === "") {
        result = value;
    }
    else {
        var valueAsNumber = +value;
        if (!isNaN(valueAsNumber)) {
            result = valueAsNumber;
        }
        else if (value && (value.toLowerCase() === "true" || value.toLowerCase() === "false")) {
            result = value.toLowerCase() === "true" ? true : false;
        }
        else {
            result = value;
        }
    }
    return result;
}
exports.convertString = convertString;
function getModuleName(path) {
    var moduleName = path.replace("./", "");
    return module_name_sanitizer_1.sanitizeModuleName(moduleName);
}
exports.getModuleName = getModuleName;
var layoutCommon;
(function (layoutCommon) {
    var MODE_SHIFT = 30;
    var MODE_MASK = 0x3 << MODE_SHIFT;
    layoutCommon.UNSPECIFIED = 0 << MODE_SHIFT;
    layoutCommon.EXACTLY = 1 << MODE_SHIFT;
    layoutCommon.AT_MOST = 2 << MODE_SHIFT;
    layoutCommon.MEASURED_HEIGHT_STATE_SHIFT = 0x00000010;
    layoutCommon.MEASURED_STATE_TOO_SMALL = 0x01000000;
    layoutCommon.MEASURED_STATE_MASK = 0xff000000;
    layoutCommon.MEASURED_SIZE_MASK = 0x00ffffff;
    function getMode(mode) {
        switch (mode) {
            case layoutCommon.EXACTLY:
                return "Exact";
            case layoutCommon.AT_MOST:
                return "AtMost";
            default:
                return "Unspecified";
        }
    }
    layoutCommon.getMode = getMode;
    function getMeasureSpecMode(spec) {
        return (spec & MODE_MASK);
    }
    layoutCommon.getMeasureSpecMode = getMeasureSpecMode;
    function getMeasureSpecSize(spec) {
        return (spec & ~MODE_MASK);
    }
    layoutCommon.getMeasureSpecSize = getMeasureSpecSize;
    function measureSpecToString(measureSpec) {
        var mode = getMeasureSpecMode(measureSpec);
        var size = getMeasureSpecSize(measureSpec);
        var text = "MeasureSpec: ";
        if (mode === layoutCommon.UNSPECIFIED) {
            text += "UNSPECIFIED ";
        }
        else if (mode === layoutCommon.EXACTLY) {
            text += "EXACTLY ";
        }
        else if (mode === layoutCommon.AT_MOST) {
            text += "AT_MOST ";
        }
        text += size;
        return text;
    }
    layoutCommon.measureSpecToString = measureSpecToString;
    function round(value) {
        var res = Math.floor(value + 0.5);
        if (res !== 0) {
            return res;
        }
        else if (value === 0) {
            return 0;
        }
        else if (value > 0) {
            return 1;
        }
        return -1;
    }
    layoutCommon.round = round;
})(layoutCommon = exports.layoutCommon || (exports.layoutCommon = {}));
function isFileOrResourcePath(path) {
    if (!types.isString(path)) {
        return false;
    }
    return path.indexOf("~/") === 0 ||
        path.indexOf("/") === 0 ||
        path.indexOf(exports.RESOURCE_PREFIX) === 0;
}
exports.isFileOrResourcePath = isFileOrResourcePath;
function isFontIconURI(uri) {
    if (!types.isString(uri)) {
        return false;
    }
    var firstSegment = uri.trim().split("//")[0];
    return firstSegment && firstSegment.indexOf("font:") === 0;
}
exports.isFontIconURI = isFontIconURI;
function isDataURI(uri) {
    if (!types.isString(uri)) {
        return false;
    }
    var firstSegment = uri.trim().split(",")[0];
    return firstSegment && firstSegment.indexOf("data:") === 0 && firstSegment.indexOf("base64") >= 0;
}
exports.isDataURI = isDataURI;
function mergeSort(arr, compareFunc) {
    if (arr.length < 2) {
        return arr;
    }
    var middle = arr.length / 2;
    var left = arr.slice(0, middle);
    var right = arr.slice(middle, arr.length);
    return merge(mergeSort(left, compareFunc), mergeSort(right, compareFunc), compareFunc);
}
exports.mergeSort = mergeSort;
function merge(left, right, compareFunc) {
    var result = [];
    while (left.length && right.length) {
        if (compareFunc(left[0], right[0]) <= 0) {
            result.push(left.shift());
        }
        else {
            result.push(right.shift());
        }
    }
    while (left.length) {
        result.push(left.shift());
    }
    while (right.length) {
        result.push(right.shift());
    }
    return result;
}
exports.merge = merge;
function hasDuplicates(arr) {
    return arr.length !== eliminateDuplicates(arr).length;
}
exports.hasDuplicates = hasDuplicates;
function eliminateDuplicates(arr) {
    return Array.from(new Set(arr));
}
exports.eliminateDuplicates = eliminateDuplicates;
function executeOnMainThread(func) {
    if (mainthread_helper_1.isMainThread()) {
        return func();
    }
    else {
        mainthread_helper_1.dispatchToMainThread(func);
    }
}
exports.executeOnMainThread = executeOnMainThread;
function mainThreadify(func) {
    return function () {
        var _this = this;
        var argsToPass = arguments;
        executeOnMainThread(function () { return func.apply(_this, argsToPass); });
    };
}
exports.mainThreadify = mainThreadify;
//# sourceMappingURL=utils-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/utils.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var utils_common_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/utils/utils-common.js"));
var application_1 = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var file_system_access_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system-access.js");
var MIN_URI_SHARE_RESTRICTED_APK_VERSION = 24;
var layout;
(function (layout) {
    var density;
    var MODE_SHIFT = 30;
    var MODE_MASK = 0x3 << MODE_SHIFT;
    var sdkVersion;
    var useOldMeasureSpec = false;
    function makeMeasureSpec(size, mode) {
        if (sdkVersion === undefined) {
            sdkVersion = ad.getApplicationContext().getApplicationInfo().targetSdkVersion;
            useOldMeasureSpec = sdkVersion <= android.os.Build.VERSION_CODES.JELLY_BEAN_MR1;
        }
        if (useOldMeasureSpec) {
            return size + mode;
        }
        return (size & ~MODE_MASK) | (mode & MODE_MASK);
    }
    layout.makeMeasureSpec = makeMeasureSpec;
    function getDisplayDensity() {
        if (density === undefined) {
            density = ad.getResources().getDisplayMetrics().density;
        }
        return density;
    }
    layout.getDisplayDensity = getDisplayDensity;
    function toDevicePixels(value) {
        return value * getDisplayDensity();
    }
    layout.toDevicePixels = toDevicePixels;
    function toDeviceIndependentPixels(value) {
        return value / getDisplayDensity();
    }
    layout.toDeviceIndependentPixels = toDeviceIndependentPixels;
    function measureNativeView(nativeView, width, widthMode, height, heightMode) {
        var view = nativeView;
        view.measure(makeMeasureSpec(width, widthMode), makeMeasureSpec(height, heightMode));
        return {
            width: view.getMeasuredWidth(),
            height: view.getMeasuredHeight()
        };
    }
    layout.measureNativeView = measureNativeView;
})(layout = exports.layout || (exports.layout = {}));
Object.assign(layout, utils_common_1.layoutCommon);
var ad;
(function (ad) {
    var application;
    var applicationContext;
    var contextResources;
    var packageName;
    function getApplicationContext() {
        if (!applicationContext) {
            applicationContext = getApplication().getApplicationContext();
        }
        return applicationContext;
    }
    ad.getApplicationContext = getApplicationContext;
    function getApplication() {
        if (!application) {
            application = application_1.getNativeApplication();
        }
        return application;
    }
    ad.getApplication = getApplication;
    function getResources() {
        if (!contextResources) {
            contextResources = getApplication().getResources();
        }
        return contextResources;
    }
    ad.getResources = getResources;
    function getPackageName() {
        if (!packageName) {
            packageName = getApplicationContext().getPackageName();
        }
        return packageName;
    }
    var inputMethodManager;
    function getInputMethodManager() {
        if (!inputMethodManager) {
            inputMethodManager = getApplicationContext().getSystemService(android.content.Context.INPUT_METHOD_SERVICE);
        }
        return inputMethodManager;
    }
    ad.getInputMethodManager = getInputMethodManager;
    function showSoftInput(nativeView) {
        var inputManager = getInputMethodManager();
        if (inputManager && nativeView instanceof android.view.View) {
            inputManager.showSoftInput(nativeView, android.view.inputmethod.InputMethodManager.SHOW_IMPLICIT);
        }
    }
    ad.showSoftInput = showSoftInput;
    function dismissSoftInput(nativeView) {
        var inputManager = getInputMethodManager();
        var windowToken;
        if (nativeView instanceof android.view.View) {
            windowToken = nativeView.getWindowToken();
        }
        else if (application_1.android.foregroundActivity instanceof androidx.appcompat.app.AppCompatActivity) {
            var decorView = application_1.android.foregroundActivity.getWindow().getDecorView();
            windowToken = decorView ? decorView.getWindowToken() : null;
        }
        if (inputManager && windowToken) {
            inputManager.hideSoftInputFromWindow(windowToken, 0);
        }
    }
    ad.dismissSoftInput = dismissSoftInput;
    var collections;
    (function (collections) {
        function stringArrayToStringSet(str) {
            var hashSet = new java.util.HashSet();
            if (str !== undefined) {
                for (var element in str) {
                    hashSet.add("" + str[element]);
                }
            }
            return hashSet;
        }
        collections.stringArrayToStringSet = stringArrayToStringSet;
        function stringSetToStringArray(stringSet) {
            var arr = [];
            if (stringSet !== undefined) {
                var it_1 = stringSet.iterator();
                while (it_1.hasNext()) {
                    var element = "" + it_1.next();
                    arr.push(element);
                }
            }
            return arr;
        }
        collections.stringSetToStringArray = stringSetToStringArray;
    })(collections = ad.collections || (ad.collections = {}));
    var resources;
    (function (resources_1) {
        var attr;
        var attrCache = new Map();
        function getDrawableId(name) {
            return getId(":drawable/" + name);
        }
        resources_1.getDrawableId = getDrawableId;
        function getStringId(name) {
            return getId(":string/" + name);
        }
        resources_1.getStringId = getStringId;
        function getId(name) {
            var resources = getResources();
            var packageName = getPackageName();
            var uri = packageName + name;
            return resources.getIdentifier(uri, null, null);
        }
        resources_1.getId = getId;
        function getPalleteColor(name, context) {
            return getPaletteColor(name, context);
        }
        resources_1.getPalleteColor = getPalleteColor;
        function getPaletteColor(name, context) {
            if (attrCache.has(name)) {
                return attrCache.get(name);
            }
            var result = 0;
            try {
                if (!attr) {
                    attr = java.lang.Class.forName("androidx.appcompat.R$attr");
                }
                var colorID = 0;
                var field = attr.getField(name);
                if (field) {
                    colorID = field.getInt(null);
                }
                if (colorID) {
                    var typedValue = new android.util.TypedValue();
                    context.getTheme().resolveAttribute(colorID, typedValue, true);
                    result = typedValue.data;
                }
            }
            catch (ex) {
                trace_1.write("Cannot get pallete color: " + name, trace_1.categories.Error, trace_1.messageType.error);
            }
            attrCache.set(name, result);
            return result;
        }
        resources_1.getPaletteColor = getPaletteColor;
    })(resources = ad.resources || (ad.resources = {}));
})(ad = exports.ad || (exports.ad = {}));
function GC() {
    gc();
}
exports.GC = GC;
function releaseNativeObject(object) {
    __releaseNativeCounterpart(object);
}
exports.releaseNativeObject = releaseNativeObject;
function openUrl(location) {
    var context = ad.getApplicationContext();
    try {
        var intent = new android.content.Intent(android.content.Intent.ACTION_VIEW, android.net.Uri.parse(location.trim()));
        intent.addFlags(android.content.Intent.FLAG_ACTIVITY_NEW_TASK);
        context.startActivity(intent);
    }
    catch (e) {
        trace_1.write("Error in OpenURL", trace_1.categories.Error, trace_1.messageType.error);
        return false;
    }
    return true;
}
exports.openUrl = openUrl;
function isExternalStorageReadOnly() {
    var extStorageState = android.os.Environment.getExternalStorageState();
    if (android.os.Environment.MEDIA_MOUNTED_READ_ONLY === extStorageState) {
        return true;
    }
    return false;
}
function isExternalStorageAvailable() {
    var extStorageState = android.os.Environment.getExternalStorageState();
    if (android.os.Environment.MEDIA_MOUNTED === extStorageState) {
        return true;
    }
    return false;
}
function getMimeTypeNameFromExtension(filePath) {
    var mimeTypeMap = android.webkit.MimeTypeMap.getSingleton();
    var extension = new file_system_access_1.FileSystemAccess()
        .getFileExtension(filePath)
        .replace(".", "")
        .toLowerCase();
    return mimeTypeMap.getMimeTypeFromExtension(extension);
}
function openFile(filePath) {
    var context = ad.getApplicationContext();
    try {
        if (!isExternalStorageAvailable()) {
            trace_1.write("\nExternal storage is unavailable (please check app permissions).\nApplications cannot access internal storage of other application on Android (see: https://developer.android.com/guide/topics/data/data-storage).\n", trace_1.categories.Error, trace_1.messageType.error);
            return false;
        }
        if (isExternalStorageReadOnly()) {
            trace_1.write("External storage is read only", trace_1.categories.Error, trace_1.messageType.error);
            return false;
        }
        var mimeType = getMimeTypeNameFromExtension(filePath);
        var intent = new android.content.Intent(android.content.Intent.ACTION_VIEW);
        var chooserIntent = android.content.Intent.createChooser(intent, "Open File...");
        intent.addFlags(android.content.Intent.FLAG_ACTIVITY_NEW_TASK);
        chooserIntent.addFlags(android.content.Intent.FLAG_ACTIVITY_NEW_TASK);
        var sdkVersion = parseInt(platform_1.device.sdkVersion, 10);
        if (sdkVersion && sdkVersion < MIN_URI_SHARE_RESTRICTED_APK_VERSION) {
            trace_1.write("detected sdk version " + sdkVersion + " (< " + MIN_URI_SHARE_RESTRICTED_APK_VERSION + "), using simple openFile", trace_1.categories.Debug);
            intent.setDataAndType(android.net.Uri.fromFile(new java.io.File(filePath)), mimeType);
            context.startActivity(chooserIntent);
            return true;
        }
        trace_1.write("detected sdk version " + sdkVersion + " (>= " + MIN_URI_SHARE_RESTRICTED_APK_VERSION + "), using URI openFile", trace_1.categories.Debug);
        var providerName = context.getPackageName() + ".provider";
        trace_1.write("fully-qualified provider name [" + providerName + "]", trace_1.categories.Debug);
        var apkURI = androidx.core.content.FileProvider.getUriForFile(context, providerName, new java.io.File(filePath));
        intent.addFlags(android.content.Intent.FLAG_GRANT_READ_URI_PERMISSION);
        chooserIntent.addFlags(android.content.Intent.FLAG_GRANT_READ_URI_PERMISSION);
        intent.setDataAndType(apkURI, mimeType);
        context.startActivity(chooserIntent);
        return true;
    }
    catch (err) {
        var msg_1 = err.message ? ": " + err.message : "";
        trace_1.write("Error in openFile" + msg_1, trace_1.categories.Error, trace_1.messageType.error);
        if (msg_1 &&
            msg_1.includes("Attempt to invoke virtual method") &&
            msg_1.includes("android.content.pm.ProviderInfo.loadXmlMetaData") &&
            msg_1.includes("on a null object reference")) {
            trace_1.write("\nPlease ensure you have your manifest correctly configured with the FileProvider.\n(see: https://developer.android.com/reference/android/support/v4/content/FileProvider#ProviderDefinition)\n", trace_1.categories.Error);
        }
        return false;
    }
}
exports.openFile = openFile;
//# sourceMappingURL=utils.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/xml/xml.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var easysax = __webpack_require__("../node_modules/tns-core-modules/js-libs/easysax/easysax.js");
var ParserEventType = (function () {
    function ParserEventType() {
    }
    ParserEventType.StartElement = "StartElement";
    ParserEventType.EndElement = "EndElement";
    ParserEventType.Text = "Text";
    ParserEventType.CDATA = "CDATA";
    ParserEventType.Comment = "Comment";
    return ParserEventType;
}());
exports.ParserEventType = ParserEventType;
var ParserEvent = (function () {
    function ParserEvent(eventType, position, prefix, namespace, elementName, attributes, data) {
        this._eventType = eventType;
        this._position = position;
        this._prefix = prefix;
        this._namespace = namespace;
        this._elementName = elementName;
        this._attributes = attributes;
        this._data = data;
    }
    ParserEvent.prototype.toString = function () {
        return JSON.stringify({
            eventType: this.eventType,
            position: this.position,
            prefix: this.prefix,
            namespace: this.namespace,
            elementName: this.elementName,
            attributes: this.attributes,
            data: this.data
        });
    };
    Object.defineProperty(ParserEvent.prototype, "eventType", {
        get: function () {
            return this._eventType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "position", {
        get: function () {
            return this._position;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "prefix", {
        get: function () {
            return this._prefix;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "namespace", {
        get: function () {
            return this._namespace;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "elementName", {
        get: function () {
            return this._elementName;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "attributes", {
        get: function () {
            return this._attributes;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "data", {
        get: function () {
            return this._data;
        },
        enumerable: true,
        configurable: true
    });
    return ParserEvent;
}());
exports.ParserEvent = ParserEvent;
var _ampCodes;
var _entitySearchRegEx = /&#(\d+);|&#x([0123456789abcdef]+);|&(\w+);/ig;
function _generateAmpMap() {
    var objCodes = { Tab: 9, NewLine: 10, excl: 33, quot: 34, QUOT: 34, num: 35, dollar: 36, percent: 37, amp: 38, AMP: 38, apos: 39, lpar: 40, rpar: 41, ast: 42, midast: 42, plus: 43, comma: 44, period: 46, sol: 47, colon: 58, semi: 59, lt: 60, LT: 60, equals: 61, gt: 62, GT: 62, quest: 63, commat: 64, lsqb: 91, lbrack: 91, bsol: 92, rsqb: 92, rbrack: 92, Hat: 94, lowbar: 95, grave: 96, DiacriticalGrave: 96, lcub: 123, lbrace: 123, verbar: 124, vert: 124, VerticalLine: 124, rcub: 125, rbrace: 125, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, brkbar: 166, sect: 167, uml: 168, copy: 169, ordf: 170, laquo: 171, not: 172, shy: 173, reg: 174, macr: 175, hibar: 175, deg: 176, plusmn: 177, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, sup1: 185, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, Agrave: 192, Aacute: 193, Acirc: 194, Atilde: 195, Auml: 196, Aring: 197, AElig: 198, Ccedil: 199, Egrave: 200, Eacute: 201, Ecirc: 202, Euml: 203, Igrave: 204, Iacute: 205, Icirc: 206, Iuml: 207, ETH: 208, Dstrok: 208, Ntilde: 209, Ograve: 210, Oacute: 211, Ocirc: 212, Otilde: 213, Ouml: 214, times: 215, Oslash: 216, Ugrave: 217, Uacute: 218, Ucirc: 219, Uuml: 220, Yacute: 221, THORN: 222, szlig: 223, agrave: 224, aacute: 225, acirc: 226, atilde: 227, auml: 228, aring: 229, aelig: 230, ccedil: 231, egrave: 232, eacute: 233, ecirc: 234, euml: 235, igrave: 236, iacute: 237, icirc: 238, iuml: 239, eth: 240, ntilde: 241, ograve: 242, oacute: 243, ocirc: 244, otilde: 245, ouml: 246, divide: 247, oslash: 248, ugrave: 249, uacute: 250, ucirc: 251, uuml: 252, yacute: 253, thorn: 254, yuml: 255, fnof: 402, imped: 437, gacute: 501, jmath: 567, circ: 710, caron: 711, Hacek: 711, breve: 728, Breve: 728, dot: 729, DiacriticalDot: 729, ring: 730, ogon: 731, tilde: 732, DiacriticalTilde: 732, dblac: 733, DiacriticalDoubleAcute: 733, DownBreve: 785, UnderBar: 818, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, epsiv: 949, varepsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigmav: 962, varsigma: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetav: 977, vartheta: 977, thetasym: 977, Upsi: 978, upsih: 978, straightphi: 981, piv: 982, varpi: 982, Gammad: 988, gammad: 989, digamma: 989, kappav: 1008, varkappa: 1008, rhov: 1009, varrho: 1009, epsi: 1013, straightepsilon: 1013, bepsi: 1014, backepsilon: 1014, euro: 8364, trade: 8482, TRADE: 8482, forall: 8704, part: 8706, larr: 8592, rarr: 8593, hyphen: 8208, dash: 8208, ndash: 8211, mdash: 8212, horbar: 8213, Vert: 8214, Verbar: 8214, lsquo: 8216, OpenCurlyQuote: 8216, rsquo: 8217, rsquor: 8217, CloseCurlyQuote: 8217, lsquor: 8218, sbquo: 8218, ldquo: 8220, OpenCurlyDoubleQuote: 8220, rdquo: 8221, rdquor: 8221, CloseCurlyDoubleQuote: 8221, ldquor: 8222, bdquo: 8222, dagger: 8224, Dagger: 8225, ddagger: 8225, bull: 8226, bullet: 8226, nldr: 8229, hellip: 8230, mldr: 8230, hybull: 8259, tdot: 8411, TripleDot: 8411, DotDot: 8412, star: 9734, phone: 9742, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830, female: 9792, male: 9794, check: 10003, checkmark: 10003, cross: 10007, VerticalSeparator: 10072, EmptySmallSquare: 9723, FilledSmallSquare: 9724, starf: 9733, bigstar: 9733, square: 9633, squ: 9633, Square: 9633 };
    var ampCodes = new Map();
    for (var key in objCodes) {
        if (objCodes.hasOwnProperty(key)) {
            ampCodes.set(key, objCodes[key]);
        }
    }
    return ampCodes;
}
if (global.__snapshot) {
    _ampCodes = _generateAmpMap();
}
function _HandleAmpEntities(found, decimalValue, hexValue, wordValue) {
    if (wordValue) {
        if (!_ampCodes) {
            _ampCodes = _generateAmpMap();
        }
        var res = _ampCodes.get(wordValue);
        if (res) {
            return String.fromCodePoint(res);
        }
        return found;
    }
    if (decimalValue) {
        return String.fromCodePoint(parseInt(decimalValue, 10));
    }
    return String.fromCodePoint(parseInt(hexValue, 16));
}
var XmlParser = (function () {
    function XmlParser(onEvent, onError, processNamespaces) {
        this._processNamespaces = processNamespaces;
        this._parser = new easysax.EasySAXParser();
        var that = this;
        this._parser.on("startNode", function (elem, attr, uq, tagend, str, pos) {
            var attributes = attr();
            if (attributes === true) {
                attributes = undefined;
            }
            if (attributes) {
                for (var key in attributes) {
                    if (attributes.hasOwnProperty(key)) {
                        attributes[key] = XmlParser._dereferenceEntities(attributes[key]);
                    }
                }
            }
            var prefix = undefined;
            var namespace = undefined;
            var name = elem;
            if (that._processNamespaces) {
                var stackEntry = XmlParser._getNamespacesStackEntry(attributes);
                that._namespaceStack.push(stackEntry);
                var resolved = that._resolveNamespace(name);
                prefix = resolved.prefix;
                namespace = resolved.namespace;
                name = resolved.name;
            }
            onEvent(new ParserEvent(ParserEventType.StartElement, pos(), prefix, namespace, name, attributes, undefined));
        });
        this._parser.on("textNode", function (text, uq, pos) {
            var data = uq(XmlParser._dereferenceEntities(text));
            onEvent(new ParserEvent(ParserEventType.Text, pos(), undefined, undefined, undefined, undefined, data));
        });
        this._parser.on("endNode", function (elem, uq, tagstart, str, pos) {
            var prefix = undefined;
            var namespace = undefined;
            var name = elem;
            if (that._processNamespaces) {
                var resolved = that._resolveNamespace(name);
                prefix = resolved.prefix;
                namespace = resolved.namespace;
                name = resolved.name;
            }
            onEvent(new ParserEvent(ParserEventType.EndElement, pos(), prefix, namespace, name, undefined, undefined));
            if (that._processNamespaces) {
                that._namespaceStack.pop();
            }
        });
        this._parser.on("cdata", function (data, res, pos) {
            onEvent(new ParserEvent(ParserEventType.CDATA, pos(), undefined, undefined, undefined, undefined, data));
        });
        this._parser.on("comment", function (text, uq, pos) {
            onEvent(new ParserEvent(ParserEventType.Comment, pos(), undefined, undefined, undefined, undefined, text));
        });
        if (onError) {
            this._parser.on("error", function (msg, pos) {
                onError(new Error(msg), pos());
            });
        }
    }
    Object.defineProperty(XmlParser.prototype, "angularSyntax", {
        get: function () {
            return this._parser.angularSyntax;
        },
        set: function (value) {
            this._parser.angularSyntax = value;
        },
        enumerable: true,
        configurable: true
    });
    XmlParser.prototype.parse = function (xmlString) {
        if (this._processNamespaces) {
            this._namespaceStack = [];
        }
        this._parser.parse(xmlString);
    };
    XmlParser._getNamespacesStackEntry = function (attributes) {
        var stackEntry = {};
        if (!attributes) {
            return stackEntry;
        }
        var attributeName;
        var namespacePrefix;
        for (var key in attributes) {
            if (!attributes.hasOwnProperty(key)) {
                continue;
            }
            attributeName = key;
            if (attributeName.indexOf("xmlns") !== 0) {
                continue;
            }
            namespacePrefix = "";
            if (attributeName.indexOf(":") !== -1) {
                namespacePrefix = attributeName.split(":")[1];
            }
            stackEntry[namespacePrefix] = attributes[key];
        }
        return stackEntry;
    };
    XmlParser.prototype._resolveNamespace = function (fullName) {
        var result = { prefix: undefined, namespace: undefined, name: undefined };
        result.prefix = "";
        if (fullName.indexOf(":") !== -1) {
            var split = fullName.split(":");
            result.prefix = split[0];
            result.name = split[1];
        }
        else {
            result.name = fullName;
        }
        var stackEntry;
        for (var i = this._namespaceStack.length - 1; i >= 0; i--) {
            stackEntry = this._namespaceStack[i];
            for (var key in stackEntry) {
                if (!stackEntry.hasOwnProperty(key)) {
                    continue;
                }
                if (result.prefix === key) {
                    result.namespace = stackEntry[key];
                    return result;
                }
            }
        }
        return result;
    };
    XmlParser._dereferenceEntities = function (s) {
        s = String(s);
        if (s.length > 3 && s.indexOf("&") !== -1) {
            s = s.replace(_entitySearchRegEx, _HandleAmpEntities);
        }
        return s;
    };
    return XmlParser;
}());
exports.XmlParser = XmlParser;
//# sourceMappingURL=xml.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tslib/tslib.es6.js":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__extends", function() { return __extends; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__assign", function() { return __assign; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__rest", function() { return __rest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__decorate", function() { return __decorate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__param", function() { return __param; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__metadata", function() { return __metadata; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__awaiter", function() { return __awaiter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__generator", function() { return __generator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__exportStar", function() { return __exportStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__values", function() { return __values; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__read", function() { return __read; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spread", function() { return __spread; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spreadArrays", function() { return __spreadArrays; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__await", function() { return __await; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncGenerator", function() { return __asyncGenerator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncDelegator", function() { return __asyncDelegator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncValues", function() { return __asyncValues; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__makeTemplateObject", function() { return __makeTemplateObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importStar", function() { return __importStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importDefault", function() { return __importDefault; });
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __spreadArrays() {
    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
    for (var r = Array(s), k = 0, i = 0; i < il; i++)
        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
            r[k] = a[j];
    return r;
};

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}


/***/ }),

/***/ "../node_modules/webpack/buildin/global.js":
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),

/***/ "../node_modules/webpack/buildin/module.js":
/***/ (function(module, exports) {

module.exports = function(module) {
	if (!module.webpackPolyfill) {
		module.deprecate = function() {};
		module.paths = [];
		// module.parent = undefined by default
		if (!module.children) module.children = [];
		Object.defineProperty(module, "loaded", {
			enumerable: true,
			get: function() {
				return module.l;
			}
		});
		Object.defineProperty(module, "id", {
			enumerable: true,
			get: function() {
				return module.i;
			}
		});
		module.webpackPolyfill = 1;
	}
	return module;
};


/***/ }),

/***/ "../node_modules/xhr/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var window = __webpack_require__("../node_modules/global/window.js")
var isFunction = __webpack_require__("../node_modules/is-function/index.js")
var parseHeaders = __webpack_require__("../node_modules/parse-headers/parse-headers.js")
var xtend = __webpack_require__("../node_modules/xtend/immutable.js")

module.exports = createXHR
// Allow use of default import syntax in TypeScript
module.exports.default = createXHR;
createXHR.XMLHttpRequest = window.XMLHttpRequest || noop
createXHR.XDomainRequest = "withCredentials" in (new createXHR.XMLHttpRequest()) ? createXHR.XMLHttpRequest : window.XDomainRequest

forEachArray(["get", "put", "post", "patch", "head", "delete"], function(method) {
    createXHR[method === "delete" ? "del" : method] = function(uri, options, callback) {
        options = initParams(uri, options, callback)
        options.method = method.toUpperCase()
        return _createXHR(options)
    }
})

function forEachArray(array, iterator) {
    for (var i = 0; i < array.length; i++) {
        iterator(array[i])
    }
}

function isEmpty(obj){
    for(var i in obj){
        if(obj.hasOwnProperty(i)) return false
    }
    return true
}

function initParams(uri, options, callback) {
    var params = uri

    if (isFunction(options)) {
        callback = options
        if (typeof uri === "string") {
            params = {uri:uri}
        }
    } else {
        params = xtend(options, {uri: uri})
    }

    params.callback = callback
    return params
}

function createXHR(uri, options, callback) {
    options = initParams(uri, options, callback)
    return _createXHR(options)
}

function _createXHR(options) {
    if(typeof options.callback === "undefined"){
        throw new Error("callback argument missing")
    }

    var called = false
    var callback = function cbOnce(err, response, body){
        if(!called){
            called = true
            options.callback(err, response, body)
        }
    }

    function readystatechange() {
        if (xhr.readyState === 4) {
            setTimeout(loadFunc, 0)
        }
    }

    function getBody() {
        // Chrome with requestType=blob throws errors arround when even testing access to responseText
        var body = undefined

        if (xhr.response) {
            body = xhr.response
        } else {
            body = xhr.responseText || getXml(xhr)
        }

        if (isJson) {
            try {
                body = JSON.parse(body)
            } catch (e) {}
        }

        return body
    }

    function errorFunc(evt) {
        clearTimeout(timeoutTimer)
        if(!(evt instanceof Error)){
            evt = new Error("" + (evt || "Unknown XMLHttpRequest Error") )
        }
        evt.statusCode = 0
        return callback(evt, failureResponse)
    }

    // will load the data & process the response in a special response object
    function loadFunc() {
        if (aborted) return
        var status
        clearTimeout(timeoutTimer)
        if(options.useXDR && xhr.status===undefined) {
            //IE8 CORS GET successful response doesn't have a status field, but body is fine
            status = 200
        } else {
            status = (xhr.status === 1223 ? 204 : xhr.status)
        }
        var response = failureResponse
        var err = null

        if (status !== 0){
            response = {
                body: getBody(),
                statusCode: status,
                method: method,
                headers: {},
                url: uri,
                rawRequest: xhr
            }
            if(xhr.getAllResponseHeaders){ //remember xhr can in fact be XDR for CORS in IE
                response.headers = parseHeaders(xhr.getAllResponseHeaders())
            }
        } else {
            err = new Error("Internal XMLHttpRequest Error")
        }
        return callback(err, response, response.body)
    }

    var xhr = options.xhr || null

    if (!xhr) {
        if (options.cors || options.useXDR) {
            xhr = new createXHR.XDomainRequest()
        }else{
            xhr = new createXHR.XMLHttpRequest()
        }
    }

    var key
    var aborted
    var uri = xhr.url = options.uri || options.url
    var method = xhr.method = options.method || "GET"
    var body = options.body || options.data
    var headers = xhr.headers = options.headers || {}
    var sync = !!options.sync
    var isJson = false
    var timeoutTimer
    var failureResponse = {
        body: undefined,
        headers: {},
        statusCode: 0,
        method: method,
        url: uri,
        rawRequest: xhr
    }

    if ("json" in options && options.json !== false) {
        isJson = true
        headers["accept"] || headers["Accept"] || (headers["Accept"] = "application/json") //Don't override existing accept header declared by user
        if (method !== "GET" && method !== "HEAD") {
            headers["content-type"] || headers["Content-Type"] || (headers["Content-Type"] = "application/json") //Don't override existing accept header declared by user
            body = JSON.stringify(options.json === true ? body : options.json)
        }
    }

    xhr.onreadystatechange = readystatechange
    xhr.onload = loadFunc
    xhr.onerror = errorFunc
    // IE9 must have onprogress be set to a unique function.
    xhr.onprogress = function () {
        // IE must die
    }
    xhr.onabort = function(){
        aborted = true;
    }
    xhr.ontimeout = errorFunc
    xhr.open(method, uri, !sync, options.username, options.password)
    //has to be after open
    if(!sync) {
        xhr.withCredentials = !!options.withCredentials
    }
    // Cannot set timeout with sync request
    // not setting timeout on the xhr object, because of old webkits etc. not handling that correctly
    // both npm's request and jquery 1.x use this kind of timeout, so this is being consistent
    if (!sync && options.timeout > 0 ) {
        timeoutTimer = setTimeout(function(){
            if (aborted) return
            aborted = true//IE9 may still call readystatechange
            xhr.abort("timeout")
            var e = new Error("XMLHttpRequest timeout")
            e.code = "ETIMEDOUT"
            errorFunc(e)
        }, options.timeout )
    }

    if (xhr.setRequestHeader) {
        for(key in headers){
            if(headers.hasOwnProperty(key)){
                xhr.setRequestHeader(key, headers[key])
            }
        }
    } else if (options.headers && !isEmpty(options.headers)) {
        throw new Error("Headers cannot be set on an XDomainRequest object")
    }

    if ("responseType" in options) {
        xhr.responseType = options.responseType
    }

    if ("beforeSend" in options &&
        typeof options.beforeSend === "function"
    ) {
        options.beforeSend(xhr)
    }

    // Microsoft Edge browser sends "undefined" when send is called with undefined value.
    // XMLHttpRequest spec says to pass null as body to indicate no body
    // See https://github.com/naugtur/xhr/issues/100.
    xhr.send(body || null)

    return xhr


}

function getXml(xhr) {
    // xhr.responseXML will throw Exception "InvalidStateError" or "DOMException"
    // See https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseXML.
    try {
        if (xhr.responseType === "document") {
            return xhr.responseXML
        }
        var firefoxBugTakenEffect = xhr.responseXML && xhr.responseXML.documentElement.nodeName === "parsererror"
        if (xhr.responseType === "" && !firefoxBugTakenEffect) {
            return xhr.responseXML
        }
    } catch (e) {}

    return null
}

function noop() {}


/***/ }),

/***/ "../node_modules/xtend/immutable.js":
/***/ (function(module, exports) {

module.exports = extend

var hasOwnProperty = Object.prototype.hasOwnProperty;

function extend() {
    var target = {}

    for (var i = 0; i < arguments.length; i++) {
        var source = arguments[i]

        for (var key in source) {
            if (hasOwnProperty.call(source, key)) {
                target[key] = source[key]
            }
        }
    }

    return target
}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL25hdGl2ZXNjcmlwdC10aGVtZS1jb3JlL2Nzcy9jb3JlLmxpZ2h0LmNzcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2Nzcy11bml0LWNvbnZlcnRlci9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2RlZmluZS1wcm9wZXJ0aWVzL2luZGV4LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvZXMtYWJzdHJhY3QvR2V0SW50cmluc2ljLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvZXMtYWJzdHJhY3QvZXM1LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvZXMtYWJzdHJhY3QvaGVscGVycy9hc3NlcnRSZWNvcmQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9lcy1hYnN0cmFjdC9oZWxwZXJzL2NhbGxCaW5kLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvZXMtYWJzdHJhY3QvaGVscGVycy9jYWxsQm91bmQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9lcy1hYnN0cmFjdC9oZWxwZXJzL2lzRmluaXRlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvZXMtYWJzdHJhY3QvaGVscGVycy9pc05hTi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2VzLWFic3RyYWN0L2hlbHBlcnMvaXNQcmVmaXhPZi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2VzLWFic3RyYWN0L2hlbHBlcnMvaXNQcm9wZXJ0eURlc2NyaXB0b3IuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9lcy1hYnN0cmFjdC9oZWxwZXJzL21vZC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2VzLWFic3RyYWN0L2hlbHBlcnMvc2lnbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2VzLXRvLXByaW1pdGl2ZS9lczUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9lcy10by1wcmltaXRpdmUvaGVscGVycy9pc1ByaW1pdGl2ZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2Zvci1lYWNoL2luZGV4LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvZnVuY3Rpb24tYmluZC9pbXBsZW1lbnRhdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2Z1bmN0aW9uLWJpbmQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9nbG9iYWwvd2luZG93LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvaGFzLXN5bWJvbHMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9oYXMtc3ltYm9scy9zaGFtcy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2hhcy9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9pcy1jYWxsYWJsZS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2lzLWZ1bmN0aW9uL2luZGV4LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvbmF0aXZlc2NyaXB0LWRldi13ZWJwYWNrL2htci9obXItdXBkYXRlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvbmF0aXZlc2NyaXB0LWRldi13ZWJwYWNrL2htci9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL25hdGl2ZXNjcmlwdC1kZXYtd2VicGFjay9ob3QuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9uYXRpdmVzY3JpcHQtZGV2LXdlYnBhY2svbG9hZC1hcHBsaWNhdGlvbi1jc3MtYW5ndWxhci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL25hdGl2ZXNjcmlwdC1kZXYtd2VicGFjay9sb2FkLWFwcGxpY2F0aW9uLWNzcy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL29iamVjdC1rZXlzL2ltcGxlbWVudGF0aW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvb2JqZWN0LWtleXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9vYmplY3Qta2V5cy9pc0FyZ3VtZW50cy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3BhcnNlLWhlYWRlcnMvcGFyc2UtaGVhZGVycy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3BhdGgtYnJvd3NlcmlmeS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtdmFsdWUtcGFyc2VyL2xpYi9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtdmFsdWUtcGFyc2VyL2xpYi9wYXJzZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtdmFsdWUtcGFyc2VyL2xpYi9zdHJpbmdpZnkuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLXZhbHVlLXBhcnNlci9saWIvdW5pdC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Bvc3Rjc3MtdmFsdWUtcGFyc2VyL2xpYi93YWxrLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvcmVkdWNlLWNzcy1jYWxjL2Rpc3QvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9yZWR1Y2UtY3NzLWNhbGMvZGlzdC9saWIvY29udmVydC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3JlZHVjZS1jc3MtY2FsYy9kaXN0L2xpYi9yZWR1Y2VyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvcmVkdWNlLWNzcy1jYWxjL2Rpc3QvbGliL3N0cmluZ2lmaWVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvcmVkdWNlLWNzcy1jYWxjL2Rpc3QvcGFyc2VyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvc3RyaW5nLnByb3RvdHlwZS50cmltL2ltcGxlbWVudGF0aW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvc3RyaW5nLnByb3RvdHlwZS50cmltL2luZGV4LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvc3RyaW5nLnByb3RvdHlwZS50cmltL3BvbHlmaWxsLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvc3RyaW5nLnByb3RvdHlwZS50cmltL3NoaW0uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2FwcGxpY2F0aW9uL2FwcGxpY2F0aW9uLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvYXBwbGljYXRpb24vYXBwbGljYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2J1bmRsZS1lbnRyeS1wb2ludHMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2NvbG9yL2NvbG9yLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY29sb3IvY29sb3IuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2NvbG9yL2tub3duLWNvbG9ycy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY3NzLXZhbHVlL2luZGV4LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9jc3MvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2Nzcy9saWIvcGFyc2UvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2Nzcy9wYXJzZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2Nzcy9zeXN0ZW0tY2xhc3Nlcy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZGF0YS9vYnNlcnZhYmxlLWFycmF5L29ic2VydmFibGUtYXJyYXkuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2RhdGEvb2JzZXJ2YWJsZS9vYnNlcnZhYmxlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9kZWJ1Z2dlci9kZWJ1Z2dlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZGVidWdnZXIvZGV2dG9vbHMtZWxlbWVudHMuY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9kZWJ1Z2dlci9kZXZ0b29scy1lbGVtZW50cy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZGVidWdnZXIvZG9tLW5vZGUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2ZldGNoL2ZldGNoLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9maWxlLXN5c3RlbS9maWxlLXN5c3RlbS1hY2Nlc3MuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2ZpbGUtc3lzdGVtL2ZpbGUtc3lzdGVtLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9nbG9iYWxzL2NvcmUvZ2xvYmFscy1jb3JlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9nbG9iYWxzL2RlY29yYXRvcnMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2dsb2JhbHMvZ2xvYmFscy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZ2xvYmFscy9wb2x5ZmlsbHMvZGlhbG9ncy9kaWFsb2dzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9nbG9iYWxzL3BvbHlmaWxscy9mZXRjaC9mZXRjaC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZ2xvYmFscy9wb2x5ZmlsbHMvcG9seWZpbGwtaGVscGVycy9wb2x5ZmlsbC1oZWxwZXJzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9nbG9iYWxzL3BvbHlmaWxscy90aW1lcnMvdGltZXJzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9nbG9iYWxzL3BvbHlmaWxscy94aHIveGhyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9nbG9iYWxzL3JlZ2lzdGVyLW1vZHVsZS1oZWxwZXJzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9nbG9iYWxzL3RzLWhlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2h0dHAvaHR0cC1yZXF1ZXN0L2h0dHAtcmVxdWVzdC1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2h0dHAvaHR0cC1yZXF1ZXN0L2h0dHAtcmVxdWVzdC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvaHR0cC9odHRwLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9pbWFnZS1hc3NldC9pbWFnZS1hc3NldC1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2ltYWdlLWFzc2V0L2ltYWdlLWFzc2V0LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9pbWFnZS1zb3VyY2UvaW1hZ2Utc291cmNlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9qcy1saWJzL2Vhc3lzYXgvZWFzeXNheC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvanMtbGlicy9lc3ByaW1hL2VzcHJpbWEuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2pzLWxpYnMvcG9seW1lci1leHByZXNzaW9ucy9wYXRoLXBhcnNlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvanMtbGlicy9wb2x5bWVyLWV4cHJlc3Npb25zL3BvbHltZXItZXhwcmVzc2lvbnMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL21hdHJpeC9tYXRyaXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL21vZHVsZS1uYW1lLXJlc29sdmVyL21vZHVsZS1uYW1lLXJlc29sdmVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9tb2R1bGUtbmFtZS1yZXNvbHZlci9ub24tYnVuZGxlLXdvcmtmbG93LWNvbXBhdC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvbW9kdWxlLW5hbWUtcmVzb2x2ZXIvcXVhbGlmaWVyLW1hdGNoZXIvcXVhbGlmaWVyLW1hdGNoZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3BsYXRmb3JtL3BsYXRmb3JtLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9wcm9maWxpbmcvcHJvZmlsaW5nLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy90ZXh0L2Zvcm1hdHRlZC1zdHJpbmcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3RleHQvc3Bhbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdGV4dC90ZXh0LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy90aW1lci90aW1lci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdHJhY2UvdHJhY2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2FjdGlvbi1iYXIvYWN0aW9uLWJhci1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2FjdGlvbi1iYXIvYWN0aW9uLWJhci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYWN0aXZpdHktaW5kaWNhdG9yL2FjdGl2aXR5LWluZGljYXRvci1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2FjdGl2aXR5LWluZGljYXRvci9hY3Rpdml0eS1pbmRpY2F0b3IuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2FuaW1hdGlvbi9hbmltYXRpb24tY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9hbmltYXRpb24vYW5pbWF0aW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9hbmltYXRpb24va2V5ZnJhbWUtYW5pbWF0aW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9ib3JkZXIvYm9yZGVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9ib3R0b20tbmF2aWdhdGlvbi9ib3R0b20tbmF2aWdhdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYnVpbGRlci9iaW5kaW5nLWJ1aWxkZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2J1aWxkZXIvYnVpbGRlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYnVpbGRlci9jb21wb25lbnQtYnVpbGRlci9jb21wb25lbnQtYnVpbGRlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYnVpbGRlci9tb2R1bGUtbmFtZS1zYW5pdGl6ZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2J1dHRvbi9idXR0b24tY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9idXR0b24vYnV0dG9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9jb250ZW50LXZpZXcvY29udGVudC12aWV3LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9jb3JlL2JpbmRhYmxlL2JpbmRhYmxlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9jb3JlL3Byb3BlcnRpZXMvcHJvcGVydGllcy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvY29yZS92aWV3LWJhc2Uvdmlldy1iYXNlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9jb3JlL3ZpZXcvdmlldy1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvcmUvdmlldy92aWV3LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9jb3JlL3dlYWstZXZlbnQtbGlzdGVuZXIvd2Vhay1ldmVudC1saXN0ZW5lci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZGF0ZS1waWNrZXIvZGF0ZS1waWNrZXItY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9kYXRlLXBpY2tlci9kYXRlLXBpY2tlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZGlhbG9ncy9kaWFsb2dzLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZGlhbG9ncy9kaWFsb2dzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9lZGl0YWJsZS10ZXh0LWJhc2UvZWRpdGFibGUtdGV4dC1iYXNlLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZWRpdGFibGUtdGV4dC1iYXNlL2VkaXRhYmxlLXRleHQtYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZW51bXMvZW51bXMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2ZyYW1lL2FjdGl2aXR5LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9mcmFtZS9mcmFnbWVudC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZnJhbWUvZnJhZ21lbnQudHJhbnNpdGlvbnMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2ZyYW1lL2ZyYW1lLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZnJhbWUvZnJhbWUtc3RhY2suanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2ZyYW1lL2ZyYW1lLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9nZXN0dXJlcy9nZXN0dXJlcy1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2dlc3R1cmVzL2dlc3R1cmVzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9odG1sLXZpZXcvaHRtbC12aWV3LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvaHRtbC12aWV3L2h0bWwtdmlldy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvaW1hZ2UvaW1hZ2UtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9pbWFnZS9pbWFnZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGFiZWwvbGFiZWwuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvYWJzb2x1dGUtbGF5b3V0L2Fic29sdXRlLWxheW91dC1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvYWJzb2x1dGUtbGF5b3V0L2Fic29sdXRlLWxheW91dC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9kb2NrLWxheW91dC9kb2NrLWxheW91dC1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvZG9jay1sYXlvdXQvZG9jay1sYXlvdXQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvZmxleGJveC1sYXlvdXQvZmxleGJveC1sYXlvdXQtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9sYXlvdXRzL2ZsZXhib3gtbGF5b3V0L2ZsZXhib3gtbGF5b3V0LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9sYXlvdXRzL2dyaWQtbGF5b3V0L2dyaWQtbGF5b3V0LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9ncmlkLWxheW91dC9ncmlkLWxheW91dC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9sYXlvdXQtYmFzZS1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvbGF5b3V0LWJhc2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvc3RhY2stbGF5b3V0L3N0YWNrLWxheW91dC1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvc3RhY2stbGF5b3V0L3N0YWNrLWxheW91dC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy93cmFwLWxheW91dC93cmFwLWxheW91dC1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvd3JhcC1sYXlvdXQvd3JhcC1sYXlvdXQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xpc3QtcGlja2VyL2xpc3QtcGlja2VyLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGlzdC1waWNrZXIvbGlzdC1waWNrZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xpc3Qtdmlldy9saXN0LXZpZXctY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9saXN0LXZpZXcvbGlzdC12aWV3LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9wYWdlL3BhZ2UtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9wYWdlL3BhZ2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3BsYWNlaG9sZGVyL3BsYWNlaG9sZGVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9wcm9ncmVzcy9wcm9ncmVzcy1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3Byb2dyZXNzL3Byb2dyZXNzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9wcm94eS12aWV3LWNvbnRhaW5lci9wcm94eS12aWV3LWNvbnRhaW5lci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvcmVwZWF0ZXIvcmVwZWF0ZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3Njcm9sbC12aWV3L3Njcm9sbC12aWV3LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc2Nyb2xsLXZpZXcvc2Nyb2xsLXZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3NlYXJjaC1iYXIvc2VhcmNoLWJhci1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3NlYXJjaC1iYXIvc2VhcmNoLWJhci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc2VnbWVudGVkLWJhci9zZWdtZW50ZWQtYmFyLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc2VnbWVudGVkLWJhci9zZWdtZW50ZWQtYmFyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zbGlkZXIvc2xpZGVyLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc2xpZGVyL3NsaWRlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9iYWNrZ3JvdW5kLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9iYWNrZ3JvdW5kLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL2NvbnZlcnRlcnMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvY3NzLWFuaW1hdGlvbi1wYXJzZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvY3NzLXNlbGVjdG9yL2Nzcy1zZWxlY3Rvci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9mb250LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9mb250LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL2xpbmVhci1ncmFkaWVudC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL3N0eWxlLXNjb3BlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL3N0eWxlL3N0eWxlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zd2l0Y2gvc3dpdGNoLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3dpdGNoL3N3aXRjaC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItY29udGVudC1pdGVtL3RhYi1jb250ZW50LWl0ZW0tY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1jb250ZW50LWl0ZW0vdGFiLWNvbnRlbnQtaXRlbS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1uYXZpZ2F0aW9uLWJhc2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwLWl0ZW0vdGFiLXN0cmlwLWl0ZW0uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwL3RhYi1zdHJpcC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGFiLXZpZXcvdGFiLXZpZXctY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90YWItdmlldy90YWItdmlldy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGFicy90YWJzLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGFicy90YWJzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90ZXh0LWJhc2UvdGV4dC1iYXNlLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGV4dC1iYXNlL3RleHQtYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGV4dC1maWVsZC90ZXh0LWZpZWxkLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGV4dC1maWVsZC90ZXh0LWZpZWxkLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90ZXh0LXZpZXcvdGV4dC12aWV3LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90aW1lLXBpY2tlci90aW1lLXBpY2tlci1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RpbWUtcGlja2VyL3RpbWUtcGlja2VyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90cmFuc2l0aW9uL2ZhZGUtdHJhbnNpdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdHJhbnNpdGlvbi9mbGlwLXRyYW5zaXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RyYW5zaXRpb24vc2xpZGUtdHJhbnNpdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdHJhbnNpdGlvbi90cmFuc2l0aW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS93ZWItdmlldy93ZWItdmlldy1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3dlYi12aWV3L3dlYi12aWV3LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91dGlscy9kZWJ1Zy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdXRpbHMvbGF6eS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdXRpbHMvbWFpbnRocmVhZC1oZWxwZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3V0aWxzL251bWJlci11dGlscy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdXRpbHMvdHlwZXMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3V0aWxzL3V0aWxzLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdXRpbHMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3htbC94bWwuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy93ZWJwYWNrL2J1aWxkaW4vZ2xvYmFsLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvd2VicGFjay9idWlsZGluL21vZHVsZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3hoci9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3h0ZW5kL2ltbXV0YWJsZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLDJCQUEyQixtQkFBTyxDQUFDLGdEQUFzQztBQUN6RTtBQUNBLGNBQWMsUUFBUyxvUEFBb1AsV0FBVyxZQUFZLHNCQUFzQixTQUFTLFdBQVcsWUFBWSxzQkFBc0IsUUFBUSxjQUFjLFdBQVcseUJBQXlCLFFBQVEsY0FBYyxXQUFXLHlCQUF5QixZQUFZLGNBQWMsZUFBZSx5QkFBeUIsU0FBUyxjQUFjLFlBQVkseUJBQXlCLFVBQVUsY0FBYyxhQUFhLHlCQUF5QixRQUFRLGNBQWMsV0FBVyx5QkFBeUIsY0FBYyxjQUFjLGlCQUFpQix5QkFBeUIsYUFBYSxjQUFjLGdCQUFnQix5QkFBeUIsVUFBVSxjQUFjLGFBQWEseUJBQXlCLFNBQVMsY0FBYyxZQUFZLHlCQUF5QixRQUFRLGNBQWMsV0FBVyx5QkFBeUIsVUFBVSxjQUFjLGFBQWEseUJBQXlCLFFBQVEsY0FBYyxXQUFXLHlCQUF5QixPQUFPLGNBQWMsVUFBVSx5QkFBeUIsUUFBUSxXQUFXLE9BQU8sVUFBVSxRQUFRLFlBQVksT0FBTyxXQUFXLEtBQUssU0FBUyxPQUFPLGFBQWEsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLE9BQU8sY0FBYyxPQUFPLGVBQWUsY0FBYyxPQUFPLGFBQWEsZ0JBQWdCLEtBQUssU0FBUyxPQUFPLGFBQWEsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLE9BQU8sY0FBYyxPQUFPLGVBQWUsY0FBYyxPQUFPLGFBQWEsZ0JBQWdCLEtBQUssU0FBUyxPQUFPLGFBQWEsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLE9BQU8sY0FBYyxPQUFPLGVBQWUsY0FBYyxPQUFPLGFBQWEsZ0JBQWdCLEtBQUssU0FBUyxPQUFPLGFBQWEsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLE9BQU8sY0FBYyxPQUFPLGVBQWUsY0FBYyxPQUFPLGFBQWEsZ0JBQWdCLEtBQUssU0FBUyxPQUFPLGFBQWEsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLE9BQU8sY0FBYyxPQUFPLGVBQWUsY0FBYyxPQUFPLGFBQWEsZ0JBQWdCLE1BQU0sVUFBVSxRQUFRLGNBQWMsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsUUFBUSxlQUFlLFFBQVEsZ0JBQWdCLGVBQWUsUUFBUSxjQUFjLGlCQUFpQixNQUFNLFVBQVUsUUFBUSxjQUFjLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLFFBQVEsZUFBZSxRQUFRLGdCQUFnQixlQUFlLFFBQVEsY0FBYyxpQkFBaUIsTUFBTSxVQUFVLFFBQVEsY0FBYyxRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixRQUFRLGVBQWUsUUFBUSxnQkFBZ0IsZUFBZSxRQUFRLGNBQWMsaUJBQWlCLE1BQU0sVUFBVSxRQUFRLGNBQWMsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsUUFBUSxlQUFlLFFBQVEsZ0JBQWdCLGVBQWUsUUFBUSxjQUFjLGlCQUFpQixNQUFNLFVBQVUsUUFBUSxjQUFjLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLFFBQVEsZUFBZSxRQUFRLGdCQUFnQixlQUFlLFFBQVEsY0FBYyxpQkFBaUIsTUFBTSxVQUFVLFFBQVEsY0FBYyxRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixRQUFRLGVBQWUsUUFBUSxnQkFBZ0IsZUFBZSxRQUFRLGNBQWMsaUJBQWlCLE1BQU0sVUFBVSxRQUFRLGNBQWMsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsUUFBUSxlQUFlLFFBQVEsZ0JBQWdCLGVBQWUsUUFBUSxjQUFjLGlCQUFpQixNQUFNLFVBQVUsUUFBUSxjQUFjLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLFFBQVEsZUFBZSxRQUFRLGdCQUFnQixlQUFlLFFBQVEsY0FBYyxpQkFBaUIsTUFBTSxVQUFVLFFBQVEsY0FBYyxRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixRQUFRLGVBQWUsUUFBUSxnQkFBZ0IsZUFBZSxRQUFRLGNBQWMsaUJBQWlCLEtBQUssVUFBVSxPQUFPLGNBQWMsT0FBTyxnQkFBZ0IsT0FBTyxpQkFBaUIsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLGVBQWUsT0FBTyxjQUFjLGlCQUFpQixLQUFLLFVBQVUsT0FBTyxjQUFjLE9BQU8sZ0JBQWdCLE9BQU8saUJBQWlCLE9BQU8sZUFBZSxPQUFPLGdCQUFnQixlQUFlLE9BQU8sY0FBYyxpQkFBaUIsS0FBSyxVQUFVLE9BQU8sY0FBYyxPQUFPLGdCQUFnQixPQUFPLGlCQUFpQixPQUFPLGVBQWUsT0FBTyxnQkFBZ0IsZUFBZSxPQUFPLGNBQWMsaUJBQWlCLEtBQUssVUFBVSxPQUFPLGNBQWMsT0FBTyxnQkFBZ0IsT0FBTyxpQkFBaUIsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLGVBQWUsT0FBTyxjQUFjLGlCQUFpQixLQUFLLFVBQVUsT0FBTyxjQUFjLE9BQU8sZ0JBQWdCLE9BQU8saUJBQWlCLE9BQU8sZUFBZSxPQUFPLGdCQUFnQixlQUFlLE9BQU8sY0FBYyxpQkFBaUIsTUFBTSxXQUFXLFFBQVEsZUFBZSxRQUFRLGlCQUFpQixRQUFRLGtCQUFrQixRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixnQkFBZ0IsUUFBUSxlQUFlLGtCQUFrQixNQUFNLFdBQVcsUUFBUSxlQUFlLFFBQVEsaUJBQWlCLFFBQVEsa0JBQWtCLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLGdCQUFnQixRQUFRLGVBQWUsa0JBQWtCLE1BQU0sV0FBVyxRQUFRLGVBQWUsUUFBUSxpQkFBaUIsUUFBUSxrQkFBa0IsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsZ0JBQWdCLFFBQVEsZUFBZSxrQkFBa0IsTUFBTSxXQUFXLFFBQVEsZUFBZSxRQUFRLGlCQUFpQixRQUFRLGtCQUFrQixRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixnQkFBZ0IsUUFBUSxlQUFlLGtCQUFrQixNQUFNLFdBQVcsUUFBUSxlQUFlLFFBQVEsaUJBQWlCLFFBQVEsa0JBQWtCLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLGdCQUFnQixRQUFRLGVBQWUsa0JBQWtCLE1BQU0sV0FBVyxRQUFRLGVBQWUsUUFBUSxpQkFBaUIsUUFBUSxrQkFBa0IsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsZ0JBQWdCLFFBQVEsZUFBZSxrQkFBa0IsTUFBTSxXQUFXLFFBQVEsZUFBZSxRQUFRLGlCQUFpQixRQUFRLGtCQUFrQixRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixnQkFBZ0IsUUFBUSxlQUFlLGtCQUFrQixNQUFNLFdBQVcsUUFBUSxlQUFlLFFBQVEsaUJBQWlCLFFBQVEsa0JBQWtCLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLGdCQUFnQixRQUFRLGVBQWUsa0JBQWtCLE1BQU0sV0FBVyxRQUFRLGVBQWUsUUFBUSxpQkFBaUIsUUFBUSxrQkFBa0IsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsZ0JBQWdCLFFBQVEsZUFBZSxrQkFBa0IsVUFBVSxTQUFTLHlCQUF5QixXQUFXLFNBQVMsU0FBUyx5QkFBeUIsV0FBVyxXQUFXLGdCQUFnQixZQUFZLGlCQUFpQixhQUFhLGtCQUFrQixnQkFBZ0IseUJBQXlCLGdCQUFnQix5QkFBeUIsaUJBQWlCLDBCQUEwQixvQkFBb0IsbUJBQW1CLGtCQUFrQixpQkFBaUIsYUFBYSxrQkFBa0IsTUFBTSxhQUFhLE1BQU0sYUFBYSxNQUFNLGFBQWEsTUFBTSxhQUFhLE1BQU0sYUFBYSxNQUFNLGFBQWEsTUFBTSxhQUFhLE1BQU0sYUFBYSxNQUFNLGFBQWEsTUFBTSxhQUFhLE1BQU0sYUFBYSxhQUFhLGdCQUFnQixZQUFZLGlCQUFpQixlQUFlLGdCQUFnQixXQUFXLG9CQUFvQixXQUFXLHNCQUFzQixZQUFZLHVCQUF1QixVQUFVLHdCQUF3QixVQUFVLHNCQUFzQixjQUFjLGNBQWMsYUFBYSxjQUFjLFlBQVksY0FBYyxZQUFZLHlCQUF5QixXQUFXLFdBQVcseUJBQXlCLFdBQVcsWUFBWSx5QkFBeUIsY0FBYyw4QkFBOEIsaUJBQWlCLGFBQWEsc0JBQXNCLHlCQUF5QixtQkFBbUIsb0JBQW9CLGNBQWMsU0FBUyxVQUFVLEtBQUssY0FBYyw2QkFBNkIsY0FBYyxhQUFhLG9CQUFvQixhQUFhLGlCQUFpQiw0QkFBNEIsV0FBVyx5QkFBeUIsYUFBYSx5QkFBeUIscUJBQXFCLFdBQVcsb0NBQW9DLHlCQUF5QixxQkFBcUIsc0JBQXNCLHlCQUF5QixzQkFBc0IseUJBQXlCLHVCQUF1Qix5QkFBeUIsd0JBQXdCLHlCQUF5QixzQkFBc0IseUJBQXlCLHVCQUF1Qix5QkFBeUIsV0FBVyxzQkFBc0IseUJBQXlCLFdBQVcsd0JBQXdCLHlCQUF5Qix3QkFBd0IseUJBQXlCLHNCQUFzQix5QkFBeUIscUJBQXFCLHlCQUF5QixhQUFhLDZCQUE2QixxQkFBcUIsY0FBYyxvQ0FBb0MseUJBQXlCLHNCQUFzQixjQUFjLHlCQUF5QixxQkFBcUIsSUFBSSw2Q0FBNkMsYUFBYSxrQkFBa0IsNkJBQTZCLDBCQUEwQixlQUFlLHFCQUFxQixnQkFBZ0IsV0FBVywyQkFBMkIsZUFBZSxxQkFBcUIsaUJBQWlCLFdBQVcsZ0NBQWdDLHlCQUF5QixtQkFBbUIsU0FBUywwQkFBMEIsYUFBYSxjQUFjLDBCQUEwQixVQUFVLGVBQWUsdUVBQXVFLHlCQUF5QixzQ0FBc0MsYUFBYSxlQUFlLHdCQUF3QixnQkFBZ0IsbUJBQW1CLGNBQWMsdUJBQXVCLG1CQUFtQixjQUFjLElBQUksYUFBYSxJQUFJLGFBQWEsSUFBSSxhQUFhLElBQUksYUFBYSxJQUFJLGFBQWEsSUFBSSxhQUFhLE1BQU0sYUFBYSxPQUFPLGFBQWEsVUFBVSxhQUFhLDZCQUE2QixjQUFjLGFBQWEsU0FBUyxXQUFXLG1DQUFtQyxzQkFBc0Isb0NBQW9DLGFBQWEsU0FBUyxVQUFVLGdCQUFnQixvQ0FBb0MseUJBQXlCLG1EQUFtRCxjQUFjLGFBQWEsTUFBTSxzQkFBc0IsVUFBVSxjQUFjLHlCQUF5QixlQUFlLGFBQWEsc0JBQXNCLGNBQWMsa0NBQWtDLG9DQUFvQyx5QkFBeUIsbUJBQW1CLHlCQUF5QixXQUFXLFdBQVcsb0NBQW9DLG1CQUFtQixzQ0FBc0MsbUJBQW1CLHlCQUF5Qix5QkFBeUIsMENBQTBDLFVBQVUsU0FBUyxpQkFBaUIsc0JBQXNCLGlCQUFpQiw0Q0FBNEMsVUFBVSxTQUFTLGlCQUFpQix3QkFBd0IsaUJBQWlCLHlCQUF5QixjQUFjLDBDQUEwQyxzQkFBc0IsYUFBYSw0Q0FBNEMsd0JBQXdCLGFBQWEsc0JBQXNCLFVBQVUsc0JBQXNCLFdBQVcsdUJBQXVCLGlEQUFpRCxTQUFTLGtCQUFrQixhQUFhLFVBQVUsc0JBQXNCLDZCQUE2QixXQUFXLHlCQUF5Qix3REFBd0QsV0FBVyw0Q0FBNEMsaUJBQWlCLDhDQUE4QyxnQkFBZ0IsMkJBQTJCLHNCQUFzQixnQkFBZ0IsYUFBYSw2QkFBNkIsaUJBQWlCLFVBQVUsc0JBQXNCLDRDQUE0QyxnQkFBZ0IsOENBQThDLGdCQUFnQixRQUFRLHlCQUF5Qix5QkFBeUIseUJBQXlCLGNBQWMsc0JBQXNCLHlCQUF5QixjQUFjLHVDQUF1Qyx5QkFBeUIsV0FBVyx5QkFBeUIseUJBQXlCLGNBQWMsVUFBVSx1QkFBdUIsMkJBQTJCLHlCQUF5QixzQkFBc0IsMkJBQTJCLGtCQUFrQixlQUFlLHNCQUFzQiwyQkFBMkIsWUFBWSxhQUFhLFdBQVcsaUJBQWlCLGFBQWEsdUJBQXVCLGtCQUFrQixhQUFhLGlCQUFpQixpQkFBaUIsVUFBVSxjQUFjLFdBQVcsMkJBQTJCLGNBQWMsV0FBVyxrQkFBa0IsZUFBZSxXQUFXLHNCQUFzQixnQkFBZ0IseUJBQXlCLGNBQWMsZ0JBQWdCLFNBQVMsYUFBYSxrQkFBa0IsY0FBYyxjQUFjLDhCQUE4QixnQkFBZ0IsYUFBYSx5QkFBeUIsb0JBQW9CLGlDQUFpQyw2QkFBNkIsZUFBZSxLQUFLLDRCQUE0QixhQUFhLGFBQWEsNkJBQTZCLGFBQWEsb0JBQW9CLGlDQUFpQyxlQUFlLHFCQUFxQixVQUFVLFVBQVUsZ0JBQWdCLGdCQUFnQixVQUFVLFVBQVUsZ0JBQWdCLGlCQUFpQixVQUFVLFVBQVUsTUFBTSw2QkFBNkIsYUFBYSxhQUFhLElBQUksYUFBYSxJQUFJLGFBQWEsSUFBSSxhQUFhLElBQUksYUFBYSxpQkFBaUIsT0FBTyxhQUFhLGdCQUFnQiwyQkFBMkIsaUJBQWlCLGVBQWUsaURBQWlELGNBQWMsc0JBQXNCLDRCQUE0QixhQUFhLFFBQVEsY0FBYyxhQUFhLFFBQVEsYUFBYSxjQUFjLHlCQUF5QixzQkFBc0IsY0FBYzs7Ozs7Ozs7OztBQ0Z0K2E7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCOztBQUVoQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx1Q0FBdUMsZ0JBQWdCO0FBQ3ZELE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUk7OztBQUdKO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLG1CQUFtQixpQkFBaUI7QUFDcEM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsZUFBZSxvQkFBb0I7QUFDbkMsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBLENBQUM7OztBQUdEO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxjQUFjO0FBQ25FO0FBQ0EsQzs7Ozs7OztBQ3BGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7Ozs7Ozs7QUN4SGE7O0FBRWIsV0FBVyxtQkFBTyxDQUFDLHNDQUFhO0FBQ2hDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLGdDQUFnQztBQUNoRTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQSxFQUFFLFlBQVk7QUFDZDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixrQkFBa0I7QUFDbEM7QUFDQTtBQUNBOztBQUVBOztBQUVBOzs7Ozs7Ozs7QUN6RGE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsY0FBYzs7QUFFZDs7QUFFQTtBQUNBLGlCQUFpQixpRUFBaUUsRUFBRTtBQUNwRixnQkFBZ0Isd0JBQXdCOztBQUV4QyxpQkFBaUIsbUJBQU8sQ0FBQyxzQ0FBYTs7QUFFdEMsc0RBQXNELG9CQUFvQixHQUFHOztBQUU3RSxjQUFjO0FBQ2Q7QUFDQSxZQUFZO0FBQ1o7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsV0FBVyxtQkFBTyxDQUFDLHdDQUFlO0FBQ2xDOztBQUVBO0FBQ0E7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxnQkFBZ0Isa0JBQWtCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7O0FDNUxhOztBQUViLG1CQUFtQixtQkFBTyxDQUFDLDZDQUFnQjs7QUFFM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLG1CQUFtQixtQkFBTyxDQUFDLHFEQUF3QjtBQUNuRCwyQkFBMkIsbUJBQU8sQ0FBQyw2REFBZ0M7QUFDbkUsYUFBYSxtQkFBTyxDQUFDLDhDQUFpQjtBQUN0QyxnQkFBZ0IsbUJBQU8sQ0FBQyxpREFBb0I7QUFDNUMsV0FBVyxtQkFBTyxDQUFDLDZDQUFnQjtBQUNuQyxVQUFVLG1CQUFPLENBQUMsNENBQWU7QUFDakMsaUJBQWlCLG1CQUFPLENBQUMsbURBQXNCO0FBQy9DLGdCQUFnQixtQkFBTyxDQUFDLGtEQUFxQjs7QUFFN0MsaUJBQWlCLG1CQUFPLENBQUMsc0NBQWE7QUFDdEMsa0JBQWtCLG1CQUFPLENBQUMsd0NBQXFCOztBQUUvQyxVQUFVLG1CQUFPLENBQUMsa0NBQUs7O0FBRXZCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0EsZ0JBQWdCO0FBQ2hCLEVBQUU7QUFDRjtBQUNBO0FBQ0EsdUJBQXVCLFVBQVU7QUFDakMsMkNBQTJDLGVBQWU7QUFDMUQ7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSw2REFBNkQsVUFBVTtBQUN2RTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCLGlCQUFpQix3QkFBd0I7QUFDekM7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FB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T0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0RBQStEO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDOzs7Ozs7OztBQ2pLQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7Ozs7OztBQ2hIQSxnQkFBZ0IsbUJBQU8sQ0FBQyx5REFBYTs7Ozs7Ozs7QUNBckM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG9CQUFvQjtBQUNwQjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLHNFQUFzRTs7QUFFdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0EsY0FBYzs7QUFFZDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLHlDQUF5QztBQUN6Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDBDQUEwQztBQUMxQztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsb0RBQW9EOztBQUVwRDtBQUNBO0FB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dEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsV0FBVztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFD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QUFDQSx1RUFBdUUsSUFBSSwrQ0FBK0MsSUFBSTtBQUM5SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkIsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxPQUFPO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsT0FBTztBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLFFBQVE7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDRDOzs7Ozs7O0FDaE1BLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixtREFBbUQ7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLE9BQU87QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxPQUFPO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxRQUFRO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxPQUFPO0FBQ2pEO0FBQ0EseUJBQXlCLG1DQUFtQztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGlCQUFpQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSwrQkFBK0IsbUJBQW1CO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQzs7Ozs7OztBQzVOQSw0RkFBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLG1FQUFtRTtBQUNwRSxvQzs7Ozs7Ozs7QUMzSEEsOENBQThDLGNBQWM7QUFDNUQsaUJBQWlCLG1CQUFPLENBQUMsdURBQVk7QUFDckMsY0FBYyxtQkFBTyxDQUFDLGlEQUFnQjtBQUN0Qyxn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OztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQSxDQUFDLEk7Ozs7Ozs7O0FDL1VELDhDQUE4QyxjQUFjO0FBQzVELGlCQUFpQixtQkFBTyxDQUFDLCtDQUFTO0FBQ2xDLG9CQUFvQixtQkFBTyxDQUFDLDZEQUFnQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLDJEQUEyRDtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLGtDQUFrQztBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLDZEQUE2RDtBQUMxRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIscUNBQXFDO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsNkRBQTZEO0FBQzFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsc0JBQXNCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGNBQWM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsa0JBQWtCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxzRDs7Ozs7OztBQzdYQSw4Q0FBOEMsY0FBYztBQUM1RCwyQkFBMkIsbUJBQU8sQ0FBQyxvRUFBc0I7QUFDekQsa0JBQWtCLG1CQUFPLENBQUMseURBQWM7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsbUJBQU8sQ0FBQyx1REFBYTtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIseUNBQXlDO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsc0JBQXNCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxrREFBa0Q7QUFDdkQsQ0FBQyxtRUFBbUU7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDJDQUEyQztBQUM1Qyx1Qzs7Ozs7OztBQy9s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QTtBQUNBO0FBQ0EsYUFBYSxtQkFBTyxDQUFDLDZEQUFtQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixjQUFjO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0EsMkJBQTJCO0FBQzNCLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxQkFBcUI7QUFDckI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFD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OztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCx5QkFBeUI7QUFDekIsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7QUFHQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxrQjs7Ozs7Ozs7QUNqaENEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhDQUE4QztBQUM5QztBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxxQ0FBcUM7QUFDckMsa0JBQWtCLFlBQVksRUFBRTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG1CQUFtQjs7QUFFbkI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsV0FBVztBQUNYOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsbUJBQW1CLGtCQUFrQjtBQUNyQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUF1QixpQkFBaUI7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7O0FBRUw7QUFDQSx1QkFBdUIsaUJBQWlCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0EsdUJBQXVCLGlCQUFpQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsd0JBQXdCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSw0Q0FBNEMsMkJBQTJCO0FBQ3ZFO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUEsdUJBQXVCLHFCQUFxQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBLG1FQUFtRTs7QUFFbkU7Ozs7Ozs7O0FDeFlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxjQUFjLG1CQUFPLENBQUMsNkRBQWlCO0FBQ3ZDLFdBQVcsbUJBQU8sQ0FBQyw2RUFBeUM7O0FBRTVEO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGlCQUFpQjtBQUN4QztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDJCQUEyQixzQkFBc0I7QUFDakQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsK0JBQStCLGdDQUFnQzs7QUFFL0Q7QUFDQSwyQkFBMkIsV0FBVyxFQUFFO0FBQ3hDLDJCQUEyQixXQUFXLEVBQUU7QUFDeEMsMkJBQTJCLFdBQVc7QUFDdEM7O0FBRUE7QUFDQSw4QkFBOEIsY0FBYyxFQUFFO0FBQzlDLDhCQUE4QixjQUFjLEVBQUU7QUFDOUMsOEJBQThCLGNBQWMsRUFBRTtBQUM5Qyw4QkFBOEIsY0FBYyxFQUFFO0FBQzlDLDhCQUE4QixjQUFjLEVBQUU7QUFDOUMsOEJBQThCLGNBQWMsRUFBRTtBQUM5Qyw4QkFBOEIsY0FBYyxFQUFFO0FBQzlDLCtCQUErQixlQUFlLEVBQUU7QUFDaEQsK0JBQStCLGVBQWUsRUFBRTtBQUNoRCwrQkFBK0IsZUFBZSxFQUFFO0FBQ2hELCtCQUErQixlQUFlLEVBQUU7QUFDaEQsZ0NBQWdDLGdCQUFnQixFQUFFO0FBQ2xELGdDQUFnQyxnQkFBZ0IsRUFBRTtBQUNsRCwrQkFBK0IsZUFBZSxFQUFFO0FBQ2hELCtCQUErQixlQUFlLEVBQUU7QUFDaEQ7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBLDJCQUEyQixxQkFBcUI7QUFDaEQ7O0FBRUE7QUFDQTtBQUNBLCtCQUErQixxQkFBcUI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBLDJCQUEyQix1QkFBdUI7QUFDbEQ7O0FBRUE7QUFDQTtBQUNBLCtCQUErQix1QkFBdUI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSwrQkFBK0I7O0FBRS9CO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIseUJBQXlCO0FBQ3BEO0FBQ0E7O0FBRUE7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsbUNBQW1DOztBQUVuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQyxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsOENBQThDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLGVBQWUsbURBQW1EO0FBQ2xFO0FBQ0EsZUFBZSx1REFBdUQ7QUFDdEU7QUFDQSxlQUFlLHlEQUF5RDtBQUN4RTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxDQUFDLGtCOzs7Ozs7O0FDemhCRCw4Q0FBOEMsY0FBYztBQUM1RCxxQkFBcUIsbUJBQU8sQ0FBQyx3REFBdUI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsK0NBQStDO0FBQy9DO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0M7Ozs7Ozs7QUN6RUEsNEZBQThDLGNBQWM7QUFDNUQsaUJBQWlCLG1CQUFPLENBQUMsdURBQXNCO0FBQy9DLHNCQUFzQixtQkFBTyxDQUFDLG9FQUFtQztBQUNqRSwwQkFBMEIsbUJBQU8sQ0FBQyw4RkFBcUI7QUFDdkQsbUNBQW1DLG1CQUFPLENBQUMscUZBQThCO0FBQ3pFLGNBQWMsbUJBQU8sQ0FBQyxpREFBVTtBQUNoQztBQUNBO0FBQ0EsNENBQTRDLGtEQUFrRDtBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksS0FBbUIsRUFBRSxFQUV4QjtBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQywwRUFBMEUsRUFBRTtBQUN2SDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxxQkFBcUIsRUFBRTtBQUN2RTtBQUNBO0FBQ0EsQ0FBQztBQUNELGdEOzs7Ozs7OztBQ3JGQSw0RkFBOEMsY0FBYztBQUM1RCxTQUFTLG1CQUFPLENBQUMsNkRBQTRCO0FBQzdDLHNCQUFzQixtQkFBTyxDQUFDLG9FQUFtQztBQUNqRSxjQUFjLG1CQUFPLENBQUMsaURBQVU7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyw0QkFBNEI7QUFDL0Q7QUFDQTtBQUNBO0FBQ0EseURBQXlELGtDQUFrQyxFQUFFO0FBQzdGLDZDQUE2QyxrQ0FBa0MsRUFBRTtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxzQ0FBc0MsRUFBRTtBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxzQkFBc0IsRUFBRTtBQUNoRjtBQUNBO0FBQ0E7QUFDQSxzRDs7Ozs7Ozs7QUNuR0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix1QkFBdUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGdDQUFnQztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix1QkFBdUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkM7Ozs7Ozs7QUMxSEEsOENBQThDLGNBQWM7QUFDNUQsZ0JBQWdCLG1CQUFPLENBQUMsNkRBQWdCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHNFQUFzRTtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxD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QTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtCQUFrQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxzREFBc0Q7QUFDbkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQsK0RBQStEO0FBQzNIO0FBQ0EsNENBQTRDLDhEQUE4RDtBQUMxRztBQUNBLDRDQUE0Qyw0Q0FBNEM7QUFDeEY7QUFDQSxrREFBa0QsaUZBQWlGO0FBQ25JO0FBQ0EsNENBQTRDLDZFQUE2RTtBQUN6SDtBQUNBLDZDOzs7Ozs7O0FDdlRBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELDBCQUEwQixtQkFBTyxDQUFDLHFFQUFxQjtBQUN2RCxjQUFjLG1CQUFPLENBQUMsaURBQW1CO0FBQ3pDLHFCQUFxQixtQkFBTyxDQUFDLCtEQUFvQjtBQUNqRCxrQkFBa0IsbUJBQU8sQ0FBQyw2REFBbUI7QUFDN0MsU0FBUyxtQkFBTyxDQUFDLHFFQUFxQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtCQUFrQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixrQkFBa0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsNEJBQTRCO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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LHlDQUF5Qyx3REFBd0QsRUFBRTtBQUNuRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUVBQW1FLGNBQWM7QUFDakY7QUFDQTtBQUNBO0FBQ0EsMERBQTBELGNBQWM7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTRELFlBQVksRUFBRTtBQUMxRTtBQUNBO0FBQ0E7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QUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsZUFBZTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLHVCQUF1QixFQUFFO0FBQ3BHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFLGdCQUFnQjtBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRUFBa0UsbUNBQW1DO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEOzs7Ozs7OztBQzNpQkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywrRUFBK0U7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixtQkFBbUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsMEJBQTBCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGtCQUFrQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkM7Ozs7Ozs7QUNuTEEsNEZBQThDLGNBQWM7QUFDNUQsY0FBYyxtQkFBTyxDQUFDLGlEQUFtQjtBQUN6QyxVQUFVLG1CQUFPLENBQUMsNkNBQVc7QUFDN0IsY0FBYyxtQkFBTyxDQUFDLGlEQUFtQjtBQUN6QywwQkFBMEIsbUJBQU8sQ0FBQyxvRkFBcUI7QUFDdkQsaUJBQWlCLG1CQUFPLENBQUMsdURBQWdCO0FBQ3pDLGtCQUFrQixtQkFBTyxDQUFDLHlEQUFpQjtBQUMzQyw4QkFBOEIsbUJBQU8sQ0FBQyxzRUFBeUI7QUFDL0QsNkJBQTZCLG1CQUFPLENBQUMsK0VBQTRCO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyx3QkFBd0I7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsNEJBQTRCO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLG9CQUFvQixFQUFFO0FBQ3BEO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQywrQkFBK0I7QUFDbEU7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FB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Q0E7QUFDQTtBQUNBLGlEQUFpRCxrQkFBa0I7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELHNCQUFzQjtBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLDhDQUE4QztBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0RBQStELGNBQWM7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isc0JBQXNCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxpQkFBaUI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsMEJBQTBCO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHlCQUF5QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLG9DOzs7Ozs7OztBQ25mQSw4Q0FBOEMsY0FBYztBQUM1RCxvQkFBb0IsbUJBQU8sQ0FBQywrQ0FBaUI7QUFDN0MsbUJBQW1CLG1CQUFPLENBQUMsZ0VBQTBCO0FBQ3JELGNBQWMsbUJBQU8sQ0FBQyxpREFBZ0I7QUFDdEMsY0FBYyxtQkFBTyxDQUFDLDREQUFxQjtBQUMzQztBQUNBLGtCQUFrQixtQkFBTyxDQUFDLHlEQUFvQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLHVCQUF1QjtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsZ0NBQWdDLEVBQUU7QUFDbkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxtR0FBbUc7QUFDcEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxvR0FBb0c7QUFDdEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxtR0FBbUc7QUFDcEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsbUdBQW1HO0FBQ3BJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG1HQUFtRztBQUNwSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsNEJBQTRCLEVBQUUsZ0JBQWdCLHFCQUFxQixFQUFFO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsbUdBQW1HO0FBQ3hJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsbUdBQW1HO0FBQ3BJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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Q0FBa0M7QUFDckU7QUFDQSxvQ0FBb0Msa0JBQWtCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxzQkFBc0I7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGtDQUFrQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsa0NBQWtDO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLHlCQUF5QixFQUFFO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSwyQkFBMkIsRUFBRTtBQUMxRztBQUNBO0FBQ0EscUJBQXFCLDZDQUE2QztBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDBDQUEwQztBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsK0JBQStCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0U7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFD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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELGtEQUFrRDtBQUN0RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxtQkFBbUI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsbUJBQW1CO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsNEJBQTRCO0FBQzdGLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsdUJBQXVCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsc0JBQXNCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxpQkFBaUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbU9BQW1PO0FBQ25PO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxrQ0FBa0MsRUFBRTtBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1Qyw4QkFBOEI7QUFDckUsd0NBQXdDLGtCQUFrQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDJEQUEyRCx5QkFBeUI7QUFDcEY7QUFDQSxvREFBb0QsbUVBQW1FLHNCQUFzQixFQUFFLEVBQUU7QUFDako7QUFDQSxvREFBb0QsbUVBQW1FLHNCQUFzQixFQUFFLEVBQUU7QUFDako7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLHFFQUFxRSxxR0FBcUc7QUFDMUs7QUFDQSxnRUFBZ0UsaUdBQWlHO0FBQ2pLO0FBQ0EsZ0ZBQWdGLHVHQUF1RztBQUN2TDtBQUNBLHVDOzs7Ozs7O0FDbG5DQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RCxvQkFBb0IsbUJBQU8sQ0FBQyw4REFBZTtBQUMzQyx5QkFBeUIsbUJBQU8sQ0FBQyxpRUFBZ0M7QUFDakUsbUJBQW1CLG1CQUFPLENBQUMsMkRBQTBCO0FBQ3JELGtCQUFrQixtQkFBTyxDQUFDLHlEQUFvQjtBQUM5QyxvQkFBb0IsbUJBQU8sQ0FBQywwREFBeUI7QUFDckQsb0JBQW9CLG1CQUFPLENBQUMsNkRBQXNCO0FBQ2xELGlCQUFpQixtQkFBTyxDQUFDLHVEQUFtQjtBQUM1QyxhQUFhLG1CQUFPLENBQUMsZ0RBQXFCO0FBQzFDLFNBQVMsbUJBQU8sQ0FBQyw4REFBZTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLCtDQUErQyxFQUFFO0FBQzlGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msd0NBQXdDLEVBQUU7QUFDbEYsMENBQTBDLDJCQUEyQjtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxtQ0FBbUM7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0Esa0RBQWtELG9EQUFvRDtBQUN0RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLDBCQUEwQjtBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELDRCQUE0QjtBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRSxRQUFRO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsd0JBQXdCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLG1CQUFPLENBQUMsdURBQVk7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRTtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUU7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBFQUEwRTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVGQUF1RjtBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLCtDQUErQztBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiwrQ0FBK0M7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkIsMkJBQTJCLFdBQVc7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSx5Qzs7Ozs7Ozs7QUMzS0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQsa0JBQWtCLG1CQUFPLENBQUMsNERBQWM7QUFDeEMsa0JBQWtCLG1CQUFPLENBQUMseURBQWlCO0FBQzNDLFNBQVMsbUJBQU8sQ0FBQyw0REFBYztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUNBLENBQUMsNkRBQTZEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxtRUFBbUU7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDhDQUE4QztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyx1REFBdUQ7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNkRBQTZEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHlFQUF5RTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsMERBQTBEO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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VDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsUUFBUTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLFFBQVE7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLCtDQUErQztBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDRDOzs7Ozs7O0FDdEVBLDhDQUE4QyxjQUFjO0FBQzVELG9CQUFvQixtQkFBTyxDQUFDLDREQUF3QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDhDOzs7Ozs7O0FDN0dBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELDJCQUEyQixtQkFBTyxDQUFDLHVFQUFzQjtBQUN6RCxTQUFTLG1CQUFPLENBQUMsdUVBQXNCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsK0M7Ozs7Ozs7QUNqS0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQsYUFBYSxtQkFBTyxDQUFDLHVEQUFjO0FBQ25DLFNBQVMsbUJBQU8sQ0FBQyx1REFBYztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSw0Q0FBNEMsOERBQThEO0FBQzFHO0FBQ0EsNENBQTRDLGlDQUFpQztBQUM3RTtBQUNBLDBEQUEwRCxrR0FBa0csNEJBQTRCLEVBQUUsRUFBRTtBQUM1TDtBQUNBLGdFQUFnRSx3R0FBd0csNEJBQTRCLEVBQUUsRUFBRTtBQUN4TTtBQUNBLDZDOzs7Ozs7O0FDNUJBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELGFBQWEsbUJBQU8sQ0FBQyxxREFBaUI7QUFDdEMsMEJBQTBCLG1CQUFPLENBQUMscUVBQXFCO0FBQ3ZELGNBQWMsbUJBQU8sQ0FBQyxpREFBbUI7QUFDekMsU0FBUyxtQkFBTyxDQUFDLHFFQUFxQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixnQ0FBZ0M7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsZ0NBQWdDO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsOEM7Ozs7Ozs7O0FDN09BO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFj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O0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDBDOzs7Ozs7OztBQ3pIQSw4Q0FBOEMsY0FBYztBQUM1RCx3QkFBd0IsbUJBQU8sQ0FBQyxnRUFBbUI7QUFDbkQsY0FBYyxtQkFBTyxDQUFDLGlEQUFhO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELDJCQUEyQiwyQkFBMkIsNkJBQTZCLGlD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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsa0JBQWtCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0M7Ozs7Ozs7QUM3SUEsOENBQThDLGNBQWM7QUFDNUQsY0FBYyxtQkFBTyxDQUFDLGlEQUFhO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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RUFBRTtBQUNoRjtBQUNBLCtDQUErQztBQUMvQztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELG1DQUFtQztBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyw0RUFBNEUsaUNBQWlDO0FBQ2xILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLCtFQUErRTtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyw0RUFBNEUsaUNBQWlDO0FBQ2xILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyw0RUFBNEUsaUNBQWlDO0FBQ2xILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyw0RUFBNEUsaUNBQWlDO0FBQ2xILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyw0RUFBNEUsaUNBQWlDO0FBQ2xILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsNEVBQTRFO0FBQ25JO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUseUZBQXlGO0FBQzFKO0FBQ0EsK0RBQStELHdHQUF3Ryw2QkFBNkIsRUFBRSxFQUFFO0FBQ3hNO0FBQ0EsNkRBQTZELG9GQUFvRjtBQUNqSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQ0FBa0Msc0JBQXNCO0FBQ3hELENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5Qyx1RkFBdUY7QUFDaEk7QUFDQSxDQUFDLDZEQUE2RDtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLGlFQUFpRSxxRkFBcUY7QUFDdEo7QUFDQSw4RUFBOEUsaUhBQWlIO0FBQy9MO0FBQ0EsNEM7Ozs7Ozs7QUMzaUNBLDRGQUE4QyxjQUFjO0FBQzVELG1CQUFtQixtQkFBTyxDQUFDLG1FQUFvQjtBQUMvQyxZQUFZLG1CQUFPLENBQUMsK0NBQVc7QUFDL0IsZUFBZSxtQkFBTyxDQUFDLGdEQUFrQjtBQUN6QyxxQkFBcUIsbUJBQU8sQ0FBQywwRUFBZ0I7QUFDN0MsY0FBYyxtQkFBTyxDQUFDLGlEQUFhO0FBQ25DLG9CQUFvQixtQkFBTyxDQUFDLDZEQUFtQjtBQUMvQyx3QkFBd0IsbUJBQU8sQ0FBQyxvRUFBc0M7QUFDdEUsa0JBQWtCLG1CQUFPLENBQUMseURBQWlCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxtQkFBTyxDQUFDLHFFQUFpQztBQUMzRTtBQUNBO0FBQ0EsOEJBQThCLG1CQUFPLENBQUMsc0VBQWtDO0FBQ3hFLDZCQUE2QixtQkFBTyxDQUFDLCtFQUE0QjtBQUNqRTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsbUJBQU8sQ0FBQyxxRUFBd0I7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsbUJBQU8sQ0FBQyxnQkFBZ0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsd0JBQXdCLEVBQUU7QUFDcEQ7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDBCQUEwQixxQkFBcUIsRUFBRTtBQUNqRDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxxQkFBcUI7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRFQUE0RSw0QkFBNEIsRUFBRTtBQUMxRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVEO0FBQ3ZEO0FBQ0E7QUFDQSxTQUFTLEVBQUU7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0Esc0RBQXNELHVDQUF1QyxFQUFFO0FBQy9GLHFEQUFxRCx3QkFBd0IsRUFBRTtBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCwyQ0FBMkMsRUFBRTtBQUN2RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLG1CQUFtQiwyQ0FBMkM7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLG1CQUFtQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0Esd0JBQXdCLGtHQUFrRztBQUMxSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlELG1DQUFtQztBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSw2Q0FBNkMsRUFBRTtBQUM1SDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRSw4QkFBOEI7QUFDakc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELCtCQUErQixFQUFFO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyw0QkFBNEIsRUFBRTtBQUN4RSwyQ0FBMkMsMkJBQTJCLEVBQUU7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUZBQXlGLDJCQUEyQixFQUFFO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Q7QUFDaEQ7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0VBQW9FLFlBQVksRUFBRSxrQ0FBa0MsNEJBQTRCLEVBQUU7QUFDbEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsUUFBUTtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCwwQkFBMEI7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLCtCQUErQixFQUFFO0FBQy9EO0FBQ0Esd0NBQXdDLG1GQUFtRixFQUFFO0FBQzdIO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixtQkFBbUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Qzs7Ozs7Ozs7QUN6d0JBLDhDQUE4QyxjQUFjO0FBQzVELG1CQUFtQixtQkFBTyxDQUFDLGdFQUEwQjtBQUNyRCxjQUFjLG1CQUFPLENBQUMsaURBQWdCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELGlDOzs7Ozs7O0FDdkVBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELGFBQWEsbUJBQU8sQ0FBQyx1REFBYztBQUNuQyxjQUFjLG1CQUFPLENBQUMsaURBQWE7QUFDbkMsU0FBUyxtQkFBTyxDQUFDLHVEQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLHdIQUF3SDtBQUN2SztBQUNBLDBEQUEwRCxtR0FBbUcsNkJBQTZCLEVBQUUsRUFBRTtBQUM5TDtBQUNBLHlDOzs7Ozs7O0FDN0JBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELHNCQUFzQixtQkFBTyxDQUFDLDZEQUFpQjtBQUMvQyxTQUFTLG1CQUFPLENBQUMsNkRBQWlCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDBDOzs7Ozs7OztBQzdHQSw4Q0FBOEMsY0FBYztBQUM1RCxhQUFhLG1CQUFPLENBQUMsdURBQWlCO0FBQ3RDLHFCQUFxQixtQkFBTyxDQUFDLGtFQUFvQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsbUQ7Ozs7Ozs7QUM1QkE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQsb0JBQW9CLG1CQUFPLENBQUMsd0VBQTJCO0FBQ3ZELGdDQUFnQyxtQkFBTyxDQUFDLHFHQUEyQjtBQUNuRSxhQUFhLG1CQUFPLENBQUMsdURBQWlCO0FBQ3RDLFNBQVMsbUJBQU8sQ0FBQyxxR0FBMkI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFLGdCQUFnQjtBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxvRDs7Ozs7OztBQzVEQSw4Q0FBOEMsY0FBYztBQUM1RCxhQUFhLG1CQUFPLENBQUMsdURBQWlCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLENBQUMsK0VBQStFO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGdDQUFnQyxFQUFFO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsK0dBQStHO0FBQ3BJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQ0FBa0Msb0JBQW9CO0FBQ3RELENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwrQzs7Ozs7OztBQ2pOQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RCxjQUFjLG1CQUFPLENBQUMsb0RBQW1CO0FBQ3pDLGNBQWMsbUJBQU8sQ0FBQyxvREFBbUI7QUFDekMsYUFBYSxtQkFBTyxDQUFDLHVEQUFpQjtBQUN0QyxhQUFhLG1CQUFPLENBQUMsa0RBQVk7QUFDakMsaUJBQWlCLG1CQUFPLENBQUMsdURBQW1CO0FBQzVDLFNBQVMsbUJBQU8sQ0FBQyx1REFBaUI7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDBDOzs7Ozs7O0FDbE1BLDhDQUE4QyxjQUFjO0FBQzVELGNBQWMsbUJBQU8sQ0FBQyxpREFBZ0I7QUFDdEMsYUFBYSxtQkFBTyxDQUFDLHVEQUFpQjtBQUN0QyxrQkFBa0IsbUJBQU8sQ0FBQyw0REFBaUI7QUFDM0M7QUFDQSxzREFBc0QsK0ZBQStGLDZCQUE2QixFQUFFLEVBQUU7QUFDdEw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsZ0NBQWdDLEVBQUU7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDREQUE0RCwwREFBMEQ7QUFDdEg7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxxQzs7Ozs7OztBQzdHQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RCxhQUFhLG1CQUFPLENBQUMsdURBQWM7QUFDbkMsU0FBUyxtQkFBTyxDQUFDLHVEQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLCtFQUErRTtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxnQ0FBZ0MsRUFBRTtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsMkdBQTJHO0FBQ2hJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsa0NBQWtDLG9CQUFvQjtBQUN0RCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDREQUE0RCwwREFBMEQ7QUFDdEg7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLG9CQUFvQjtBQUN0RCxDQUFDO0FBQ0Q7QUFDQSwyREFBMkQsbURBQW1EO0FBQzlHO0FBQ0EsMkRBQTJELDJGQUEyRjtBQUN0SjtBQUNBLDBEQUEwRCx1RkFBdUYsc0JBQXNCLEVBQUUsRUFBRTtBQUMzSztBQUNBLHVEQUF1RCx1SEFBdUgsNEJBQTRCLEVBQUUsRUFBRTtBQUM5TTtBQUNBLDZEQUE2RCxtSUFBbUksNEJBQTRCLEVBQUUsRUFBRTtBQUNoTztBQUNBLCtEQUErRCx3SUFBd0ksNEJBQTRCLEVBQUUsRUFBRTtBQUN2TztBQUNBLDJFQUEyRSxpS0FBaUssNEJBQTRCLEVBQUUsRUFBRTtBQUM1UTtBQUNBLDJDOzs7Ozs7O0FDdFJBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELGFBQWEsbUJBQU8sQ0FBQyxxREFBaUI7QUFDdEMsd0JBQXdCLG1CQUFPLENBQUMsaUVBQW1CO0FBQ25ELGtCQUFrQixtQkFBTyxDQUFDLDREQUFjO0FBQ3hDLHFCQUFxQixtQkFBTyxDQUFDLCtEQUFvQjtBQUNqRCxjQUFjLG1CQUFPLENBQUMsaURBQW1CO0FBQ3pDLGNBQWMsbUJBQU8sQ0FBQyxvREFBVTtBQUNoQyxrQkFBa0IsbUJBQU8sQ0FBQyw2REFBbUI7QUFDN0MsU0FBUyxtQkFBTyxDQUFDLGlFQUFtQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFLGdCQUFnQjtBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsZUFBZTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBFQUEwRTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyRUFBMkUsdUJBQXVCLEVBQUU7QUFDcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsa0ZBQWtGO0FBQ25IO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixlQUFlO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJFQUEyRSx1QkFBdUIsRUFBRTtBQUNwRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1RUFBdUUsZ0JBQWdCO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFLG1DQUFtQztBQUNyRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Qzs7Ozs7Ozs7QUM5bEJBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELGFBQWEsbUJBQU8sQ0FBQyx1REFBYztBQUNuQyx5QkFBeUIsbUJBQU8sQ0FBQywyREFBNkI7QUFDOUQ7QUFDQTtBQUNBLFNBQVMsbUJBQU8sQ0FBQyx1REFBYztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixlQUFlO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLGNBQWM7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsK0M7Ozs7Ozs7O0FDekZBLDhDQUE4QyxjQUFjO0FBQzVELG1CQUFtQixtQkFBTyxDQUFDLDhEQUFjO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsbUQ7Ozs7Ozs7QUNoQ0EsOENBQThDLGNBQWM7QUFDNUQsbUJBQW1CLG1CQUFPLENBQUMsOERBQWM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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LGtDQUFrQyxFQUFFO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLG1FQUFtRTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsc0NBQXNDLEVBQUU7QUFDakY7QUFDQTtBQUNBO0FBQ0Esd0M7Ozs7Ozs7QUNyTEE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQsY0FBYyxtQkFBTyxDQUFDLGlEQUFVO0FBQ2hDLHFCQUFxQixtQkFBTyxDQUFDLHdEQUFnQjtBQUM3QyxTQUFTLG1CQUFPLENBQUMsd0RBQWdCO0FBQ2pDLG9CQUFvQixtQkFBTyxDQUFDLDZEQUFnQjtBQUM1QyxpQkFBaUIsbUJBQU8sQ0FBQyx1REFBYTtBQUN0QywyQkFBMkIsbUJBQU8sQ0FBQyxvRUFBbUM7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGlEQUFpRDtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssc0RBQXNEO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLGdEQUFnRDtBQUNyRCxDQUFDLHFDQUFxQztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Qzs7Ozs7OztBQzdSQSw0RkFBOEMsY0FBYztBQUM1RCxjQUFjLG1CQUFPLENBQUMsNkRBQW9CO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLGtDQUFrQywwQkFBMEIsUUFBUTtBQUNwRTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFD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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTs7Ozs7Ozs7QUN0UEE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSxtQkFBbUIsc0JBQXNCO0FBQ3pDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBIiwiZmlsZSI6InZlbmRvci5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuLi8uLi9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIikoZmFsc2UpO1xuLy8gTW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCIvKiFcXHJcXG4gKiBOYXRpdmVTY3JpcHQgVGhlbWUgdjEuMC42IChodHRwczovL25hdGl2ZXNjcmlwdC5vcmcpXFxyXFxuICogQ29weXJpZ2h0IDIwMTYtMjAxNiBUaGUgVGhlbWUgQXV0aG9yc1xcclxcbiAqIENvcHlyaWdodCAyMDE2LTIwMTYgVGVsZXJpa1xcclxcbiAqIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL05hdGl2ZVNjcmlwdC90aGVtZS9ibG9iL21hc3Rlci9MSUNFTlNFKVxcclxcbiAqLy5jLXdoaXRle2NvbG9yOiNmZmZ9LmMtYmctd2hpdGV7YmFja2dyb3VuZC1jb2xvcjojZmZmfS5jLWJsYWNre2NvbG9yOiMwMDB9LmMtYmctYmxhY2t7YmFja2dyb3VuZC1jb2xvcjojMDAwfS5jLWFxdWF7Y29sb3I6IzAwY2FhYn0uYy1iZy1hcXVhe2JhY2tncm91bmQtY29sb3I6IzAwY2FhYn0uYy1ibHVle2NvbG9yOiMzZDVhZmV9LmMtYmctYmx1ZXtiYWNrZ3JvdW5kLWNvbG9yOiMzZDVhZmV9LmMtY2hhcmNvYWx7Y29sb3I6IzMwMzAzMH0uYy1iZy1jaGFyY29hbHtiYWNrZ3JvdW5kLWNvbG9yOiMzMDMwMzB9LmMtYnJvd257Y29sb3I6Izc5NTU0OH0uYy1iZy1icm93bntiYWNrZ3JvdW5kLWNvbG9yOiM3OTU1NDh9LmMtZm9yZXN0e2NvbG9yOiMwMDY5Njh9LmMtYmctZm9yZXN0e2JhY2tncm91bmQtY29sb3I6IzAwNjk2OH0uYy1ncmV5e2NvbG9yOiNlMGUwZTB9LmMtYmctZ3JleXtiYWNrZ3JvdW5kLWNvbG9yOiNlMGUwZTB9LmMtZ3JleS1saWdodHtjb2xvcjojYmFiYWJhfS5jLWJnLWdyZXktbGlnaHR7YmFja2dyb3VuZC1jb2xvcjojYmFiYWJhfS5jLWdyZXktZGFya3tjb2xvcjojNWM2ODdjfS5jLWJnLWdyZXktZGFya3tiYWNrZ3JvdW5kLWNvbG9yOiM1YzY4N2N9LmMtcHVycGxle2NvbG9yOiM4MTMwZmZ9LmMtYmctcHVycGxle2JhY2tncm91bmQtY29sb3I6IzgxMzBmZn0uYy1sZW1vbntjb2xvcjojZmZlYTAwfS5jLWJnLWxlbW9ue2JhY2tncm91bmQtY29sb3I6I2ZmZWEwMH0uYy1saW1le2NvbG9yOiNhZWU0MDZ9LmMtYmctbGltZXtiYWNrZ3JvdW5kLWNvbG9yOiNhZWU0MDZ9LmMtb3Jhbmdle2NvbG9yOiNmNTdjMDB9LmMtYmctb3Jhbmdle2JhY2tncm91bmQtY29sb3I6I2Y1N2MwMH0uYy1ydWJ5e2NvbG9yOiNmZjE3NDR9LmMtYmctcnVieXtiYWNrZ3JvdW5kLWNvbG9yOiNmZjE3NDR9LmMtc2t5e2NvbG9yOiMzMGJjZmZ9LmMtYmctc2t5e2JhY2tncm91bmQtY29sb3I6IzMwYmNmZn0udy1mdWxse3dpZHRoOjEwMCV9LnctMTAwe3dpZHRoOjEwMH0uaC1mdWxse2hlaWdodDoxMDAlfS5oLTEwMHtoZWlnaHQ6MTAwfS5tLTB7bWFyZ2luOjB9Lm0tdC0we21hcmdpbi10b3A6MH0ubS1yLTB7bWFyZ2luLXJpZ2h0OjB9Lm0tYi0we21hcmdpbi1ib3R0b206MH0ubS1sLTB7bWFyZ2luLWxlZnQ6MH0ubS14LTB7bWFyZ2luLXJpZ2h0OjA7bWFyZ2luLWxlZnQ6MH0ubS15LTB7bWFyZ2luLXRvcDowO21hcmdpbi1ib3R0b206MH0ubS0ye21hcmdpbjoyfS5tLXQtMnttYXJnaW4tdG9wOjJ9Lm0tci0ye21hcmdpbi1yaWdodDoyfS5tLWItMnttYXJnaW4tYm90dG9tOjJ9Lm0tbC0ye21hcmdpbi1sZWZ0OjJ9Lm0teC0ye21hcmdpbi1yaWdodDoyO21hcmdpbi1sZWZ0OjJ9Lm0teS0ye21hcmdpbi10b3A6MjttYXJnaW4tYm90dG9tOjJ9Lm0tNHttYXJnaW46NH0ubS10LTR7bWFyZ2luLXRvcDo0fS5tLXItNHttYXJnaW4tcmlnaHQ6NH0ubS1iLTR7bWFyZ2luLWJvdHRvbTo0fS5tLWwtNHttYXJnaW4tbGVmdDo0fS5tLXgtNHttYXJnaW4tcmlnaHQ6NDttYXJnaW4tbGVmdDo0fS5tLXktNHttYXJnaW4tdG9wOjQ7bWFyZ2luLWJvdHRvbTo0fS5tLTV7bWFyZ2luOjV9Lm0tdC01e21hcmdpbi10b3A6NX0ubS1yLTV7bWFyZ2luLXJpZ2h0OjV9Lm0tYi01e21hcmdpbi1ib3R0b206NX0ubS1sLTV7bWFyZ2luLWxlZnQ6NX0ubS14LTV7bWFyZ2luLXJpZ2h0OjU7bWFyZ2luLWxlZnQ6NX0ubS15LTV7bWFyZ2luLXRvcDo1O21hcmdpbi1ib3R0b206NX0ubS04e21hcmdpbjo4fS5tLXQtOHttYXJnaW4tdG9wOjh9Lm0tci04e21hcmdpbi1yaWdodDo4fS5tLWItOHttYXJnaW4tYm90dG9tOjh9Lm0tbC04e21hcmdpbi1sZWZ0Ojh9Lm0teC04e21hcmdpbi1yaWdodDo4O21hcmdpbi1sZWZ0Ojh9Lm0teS04e21hcmdpbi10b3A6ODttYXJnaW4tYm90dG9tOjh9Lm0tMTB7bWFyZ2luOjEwfS5tLXQtMTB7bWFyZ2luLXRvcDoxMH0ubS1yLTEwe21hcmdpbi1yaWdodDoxMH0ubS1iLTEwe21hcmdpbi1ib3R0b206MTB9Lm0tbC0xMHttYXJnaW4tbGVmdDoxMH0ubS14LTEwe21hcmdpbi1yaWdodDoxMDttYXJnaW4tbGVmdDoxMH0ubS15LTEwe21hcmdpbi10b3A6MTA7bWFyZ2luLWJvdHRvbToxMH0ubS0xMnttYXJnaW46MTJ9Lm0tdC0xMnttYXJnaW4tdG9wOjEyfS5tLXItMTJ7bWFyZ2luLXJpZ2h0OjEyfS5tLWItMTJ7bWFyZ2luLWJvdHRvbToxMn0ubS1sLTEye21hcmdpbi1sZWZ0OjEyfS5tLXgtMTJ7bWFyZ2luLXJpZ2h0OjEyO21hcmdpbi1sZWZ0OjEyfS5tLXktMTJ7bWFyZ2luLXRvcDoxMjttYXJnaW4tYm90dG9tOjEyfS5tLTE1e21hcmdpbjoxNX0ubS10LTE1e21hcmdpbi10b3A6MTV9Lm0tci0xNXttYXJnaW4tcmlnaHQ6MTV9Lm0tYi0xNXttYXJnaW4tYm90dG9tOjE1fS5tLWwtMTV7bWFyZ2luLWxlZnQ6MTV9Lm0teC0xNXttYXJnaW4tcmlnaHQ6MTU7bWFyZ2luLWxlZnQ6MTV9Lm0teS0xNXttYXJnaW4tdG9wOjE1O21hcmdpbi1ib3R0b206MTV9Lm0tMTZ7bWFyZ2luOjE2fS5tLXQtMTZ7bWFyZ2luLXRvcDoxNn0ubS1yLTE2e21hcmdpbi1yaWdodDoxNn0ubS1iLTE2e21hcmdpbi1ib3R0b206MTZ9Lm0tbC0xNnttYXJnaW4tbGVmdDoxNn0ubS14LTE2e21hcmdpbi1yaWdodDoxNjttYXJnaW4tbGVmdDoxNn0ubS15LTE2e21hcmdpbi10b3A6MTY7bWFyZ2luLWJvdHRvbToxNn0ubS0yMHttYXJnaW46MjB9Lm0tdC0yMHttYXJnaW4tdG9wOjIwfS5tLXItMjB7bWFyZ2luLXJpZ2h0OjIwfS5tLWItMjB7bWFyZ2luLWJvdHRvbToyMH0ubS1sLTIwe21hcmdpbi1sZWZ0OjIwfS5tLXgtMjB7bWFyZ2luLXJpZ2h0OjIwO21hcmdpbi1sZWZ0OjIwfS5tLXktMjB7bWFyZ2luLXRvcDoyMDttYXJnaW4tYm90dG9tOjIwfS5tLTI0e21hcmdpbjoyNH0ubS10LTI0e21hcmdpbi10b3A6MjR9Lm0tci0yNHttYXJnaW4tcmlnaHQ6MjR9Lm0tYi0yNHttYXJnaW4tYm90dG9tOjI0fS5tLWwtMjR7bWFyZ2luLWxlZnQ6MjR9Lm0teC0yNHttYXJnaW4tcmlnaHQ6MjQ7bWFyZ2luLWxlZnQ6MjR9Lm0teS0yNHttYXJnaW4tdG9wOjI0O21hcmdpbi1ib3R0b206MjR9Lm0tMjV7bWFyZ2luOjI1fS5tLXQtMjV7bWFyZ2luLXRvcDoyNX0ubS1yLTI1e21hcmdpbi1yaWdodDoyNX0ubS1iLTI1e21hcmdpbi1ib3R0b206MjV9Lm0tbC0yNXttYXJnaW4tbGVmdDoyNX0ubS14LTI1e21hcmdpbi1yaWdodDoyNTttYXJnaW4tbGVmdDoyNX0ubS15LTI1e21hcmdpbi10b3A6MjU7bWFyZ2luLWJvdHRvbToyNX0ubS0yOHttYXJnaW46Mjh9Lm0tdC0yOHttYXJnaW4tdG9wOjI4fS5tLXItMjh7bWFyZ2luLXJpZ2h0OjI4fS5tLWItMjh7bWFyZ2luLWJvdHRvbToyOH0ubS1sLTI4e21hcmdpbi1sZWZ0OjI4fS5tLXgtMjh7bWFyZ2luLXJpZ2h0OjI4O21hcmdpbi1sZWZ0OjI4fS5tLXktMjh7bWFyZ2luLXRvcDoyODttYXJnaW4tYm90dG9tOjI4fS5tLTMwe21hcmdpbjozMH0ubS10LTMwe21hcmdpbi10b3A6MzB9Lm0tci0zMHttYXJnaW4tcmlnaHQ6MzB9Lm0tYi0zMHttYXJnaW4tYm90dG9tOjMwfS5tLWwtMzB7bWFyZ2luLWxlZnQ6MzB9Lm0teC0zMHttYXJnaW4tcmlnaHQ6MzA7bWFyZ2luLWxlZnQ6MzB9Lm0teS0zMHttYXJnaW4tdG9wOjMwO21hcmdpbi1ib3R0b206MzB9LnAtMHtwYWRkaW5nOjB9LnAtdC0we3BhZGRpbmctdG9wOjB9LnAtci0we3BhZGRpbmctcmlnaHQ6MH0ucC1iLTB7cGFkZGluZy1ib3R0b206MH0ucC1sLTB7cGFkZGluZy1sZWZ0OjB9LnAteC0we3BhZGRpbmctcmlnaHQ6MDtwYWRkaW5nLWxlZnQ6MH0ucC15LTB7cGFkZGluZy10b3A6MDtwYWRkaW5nLWJvdHRvbTowfS5wLTJ7cGFkZGluZzoyfS5wLXQtMntwYWRkaW5nLXRvcDoyfS5wLXItMntwYWRkaW5nLXJpZ2h0OjJ9LnAtYi0ye3BhZGRpbmctYm90dG9tOjJ9LnAtbC0ye3BhZGRpbmctbGVmdDoyfS5wLXgtMntwYWRkaW5nLXJpZ2h0OjI7cGFkZGluZy1sZWZ0OjJ9LnAteS0ye3BhZGRpbmctdG9wOjI7cGFkZGluZy1ib3R0b206Mn0ucC00e3BhZGRpbmc6NH0ucC10LTR7cGFkZGluZy10b3A6NH0ucC1yLTR7cGFkZGluZy1yaWdodDo0fS5wLWItNHtwYWRkaW5nLWJvdHRvbTo0fS5wLWwtNHtwYWRkaW5nLWxlZnQ6NH0ucC14LTR7cGFkZGluZy1yaWdodDo0O3BhZGRpbmctbGVmdDo0fS5wLXktNHtwYWRkaW5nLXRvcDo0O3BhZGRpbmctYm90dG9tOjR9LnAtNXtwYWRkaW5nOjV9LnAtdC01e3BhZGRpbmctdG9wOjV9LnAtci01e3BhZGRpbmctcmlnaHQ6NX0ucC1iLTV7cGFkZGluZy1ib3R0b206NX0ucC1sLTV7cGFkZGluZy1sZWZ0OjV9LnAteC01e3BhZGRpbmctcmlnaHQ6NTtwYWRkaW5nLWxlZnQ6NX0ucC15LTV7cGFkZGluZy10b3A6NTtwYWRkaW5nLWJvdHRvbTo1fS5wLTh7cGFkZGluZzo4fS5wLXQtOHtwYWRkaW5nLXRvcDo4fS5wLXItOHtwYWRkaW5nLXJpZ2h0Ojh9LnAtYi04e3BhZGRpbmctYm90dG9tOjh9LnAtbC04e3BhZGRpbmctbGVmdDo4fS5wLXgtOHtwYWRkaW5nLXJpZ2h0Ojg7cGFkZGluZy1sZWZ0Ojh9LnAteS04e3BhZGRpbmctdG9wOjg7cGFkZGluZy1ib3R0b206OH0ucC0xMHtwYWRkaW5nOjEwfS5wLXQtMTB7cGFkZGluZy10b3A6MTB9LnAtci0xMHtwYWRkaW5nLXJpZ2h0OjEwfS5wLWItMTB7cGFkZGluZy1ib3R0b206MTB9LnAtbC0xMHtwYWRkaW5nLWxlZnQ6MTB9LnAteC0xMHtwYWRkaW5nLXJpZ2h0OjEwO3BhZGRpbmctbGVmdDoxMH0ucC15LTEwe3BhZGRpbmctdG9wOjEwO3BhZGRpbmctYm90dG9tOjEwfS5wLTEye3BhZGRpbmc6MTJ9LnAtdC0xMntwYWRkaW5nLXRvcDoxMn0ucC1yLTEye3BhZGRpbmctcmlnaHQ6MTJ9LnAtYi0xMntwYWRkaW5nLWJvdHRvbToxMn0ucC1sLTEye3BhZGRpbmctbGVmdDoxMn0ucC14LTEye3BhZGRpbmctcmlnaHQ6MTI7cGFkZGluZy1sZWZ0OjEyfS5wLXktMTJ7cGFkZGluZy10b3A6MTI7cGFkZGluZy1ib3R0b206MTJ9LnAtMTV7cGFkZGluZzoxNX0ucC10LTE1e3BhZGRpbmctdG9wOjE1fS5wLXItMTV7cGFkZGluZy1yaWdodDoxNX0ucC1iLTE1e3BhZGRpbmctYm90dG9tOjE1fS5wLWwtMTV7cGFkZGluZy1sZWZ0OjE1fS5wLXgtMTV7cGFkZGluZy1yaWdodDoxNTtwYWRkaW5nLWxlZnQ6MTV9LnAteS0xNXtwYWRkaW5nLXRvcDoxNTtwYWRkaW5nLWJvdHRvbToxNX0ucC0xNntwYWRkaW5nOjE2fS5wLXQtMTZ7cGFkZGluZy10b3A6MTZ9LnAtci0xNntwYWRkaW5nLXJpZ2h0OjE2fS5wLWItMTZ7cGFkZGluZy1ib3R0b206MTZ9LnAtbC0xNntwYWRkaW5nLWxlZnQ6MTZ9LnAteC0xNntwYWRkaW5nLXJpZ2h0OjE2O3BhZGRpbmctbGVmdDoxNn0ucC15LTE2e3BhZGRpbmctdG9wOjE2O3BhZGRpbmctYm90dG9tOjE2fS5wLTIwe3BhZGRpbmc6MjB9LnAtdC0yMHtwYWRkaW5nLXRvcDoyMH0ucC1yLTIwe3BhZGRpbmctcmlnaHQ6MjB9LnAtYi0yMHtwYWRkaW5nLWJvdHRvbToyMH0ucC1sLTIwe3BhZGRpbmctbGVmdDoyMH0ucC14LTIwe3BhZGRpbmctcmlnaHQ6MjA7cGFkZGluZy1sZWZ0OjIwfS5wLXktMjB7cGFkZGluZy10b3A6MjA7cGFkZGluZy1ib3R0b206MjB9LnAtMjR7cGFkZGluZzoyNH0ucC10LTI0e3BhZGRpbmctdG9wOjI0fS5wLXItMjR7cGFkZGluZy1yaWdodDoyNH0ucC1iLTI0e3BhZGRpbmctYm90dG9tOjI0fS5wLWwtMjR7cGFkZGluZy1sZWZ0OjI0fS5wLXgtMjR7cGFkZGluZy1yaWdodDoyNDtwYWRkaW5nLWxlZnQ6MjR9LnAteS0yNHtwYWRkaW5nLXRvcDoyNDtwYWRkaW5nLWJvdHRvbToyNH0ucC0yNXtwYWRkaW5nOjI1fS5wLXQtMjV7cGFkZGluZy10b3A6MjV9LnAtci0yNXtwYWRkaW5nLXJpZ2h0OjI1fS5wLWItMjV7cGFkZGluZy1ib3R0b206MjV9LnAtbC0yNXtwYWRkaW5nLWxlZnQ6MjV9LnAteC0yNXtwYWRkaW5nLXJpZ2h0OjI1O3BhZGRpbmctbGVmdDoyNX0ucC15LTI1e3BhZGRpbmctdG9wOjI1O3BhZGRpbmctYm90dG9tOjI1fS5wLTI4e3BhZGRpbmc6Mjh9LnAtdC0yOHtwYWRkaW5nLXRvcDoyOH0ucC1yLTI4e3BhZGRpbmctcmlnaHQ6Mjh9LnAtYi0yOHtwYWRkaW5nLWJvdHRvbToyOH0ucC1sLTI4e3BhZGRpbmctbGVmdDoyOH0ucC14LTI4e3BhZGRpbmctcmlnaHQ6Mjg7cGFkZGluZy1sZWZ0OjI4fS5wLXktMjh7cGFkZGluZy10b3A6Mjg7cGFkZGluZy1ib3R0b206Mjh9LnAtMzB7cGFkZGluZzozMH0ucC10LTMwe3BhZGRpbmctdG9wOjMwfS5wLXItMzB7cGFkZGluZy1yaWdodDozMH0ucC1iLTMwe3BhZGRpbmctYm90dG9tOjMwfS5wLWwtMzB7cGFkZGluZy1sZWZ0OjMwfS5wLXgtMzB7cGFkZGluZy1yaWdodDozMDtwYWRkaW5nLWxlZnQ6MzB9LnAteS0zMHtwYWRkaW5nLXRvcDozMDtwYWRkaW5nLWJvdHRvbTozMH0uaHItbGlnaHR7aGVpZ2h0OjE7YmFja2dyb3VuZC1jb2xvcjojZTBlMGUwO3dpZHRoOjEwMCV9LmhyLWRhcmt7aGVpZ2h0OjE7YmFja2dyb3VuZC1jb2xvcjojMzAzMDMwO3dpZHRoOjEwMCV9LnRleHQtbGVmdHt0ZXh0LWFsaWduOmxlZnR9LnRleHQtcmlnaHR7dGV4dC1hbGlnbjpyaWdodH0udGV4dC1jZW50ZXJ7dGV4dC1hbGlnbjpjZW50ZXJ9LnRleHQtbG93ZXJjYXNle3RleHQtdHJhbnNmb3JtOmxvd2VyY2FzZX0udGV4dC11cHBlcmNhc2V7dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlfS50ZXh0LWNhcGl0YWxpemV7dGV4dC10cmFuc2Zvcm06Y2FwaXRhbGl6ZX0uZm9udC13ZWlnaHQtbm9ybWFse2ZvbnQtd2VpZ2h0Om5vcm1hbH0uZm9udC13ZWlnaHQtYm9sZHtmb250LXdlaWdodDpib2xkfS5mb250LWl0YWxpY3tmb250LXN0eWxlOml0YWxpY30udC0xMHtmb250LXNpemU6MTB9LnQtMTJ7Zm9udC1zaXplOjEyfS50LTE0e2ZvbnQtc2l6ZToxNH0udC0xNXtmb250LXNpemU6MTV9LnQtMTZ7Zm9udC1zaXplOjE2fS50LTE3e2ZvbnQtc2l6ZToxN30udC0xOHtmb250LXNpemU6MTh9LnQtMTl7Zm9udC1zaXplOjE5fS50LTIwe2ZvbnQtc2l6ZToyMH0udC0yNXtmb250LXNpemU6MjV9LnQtMzB7Zm9udC1zaXplOjMwfS5pbWctcm91bmRlZHtib3JkZXItcmFkaXVzOjV9LmltZy1jaXJjbGV7Ym9yZGVyLXJhZGl1czoyMH0uaW1nLXRodW1ibmFpbHtib3JkZXItcmFkaXVzOjB9LmludmlzaWJsZXt2aXNpYmlsaXR5OmNvbGxhcHNlfS5wdWxsLWxlZnR7aG9yaXpvbnRhbC1hbGlnbjpsZWZ0fS5wdWxsLXJpZ2h0e2hvcml6b250YWwtYWxpZ246cmlnaHR9Lm0teC1hdXRve2hvcml6b250YWwtYWxpZ246Y2VudGVyfS5tLXktYXV0b3t2ZXJ0aWNhbC1hbGlnbjpjZW50ZXJ9LnRleHQtcHJpbWFyeXtjb2xvcjojMzBiY2ZmfS50ZXh0LWRhbmdlcntjb2xvcjojZDUwMDAwfS50ZXh0LW11dGVke2NvbG9yOiM5ZTllOWV9LmJnLXByaW1hcnl7YmFja2dyb3VuZC1jb2xvcjojMzBiY2ZmO2NvbG9yOiNmZmZ9LmJnLWRhbmdlcntiYWNrZ3JvdW5kLWNvbG9yOiNkNTAwMDA7Y29sb3I6I2ZmZn0uYWN0aW9uLWJhcntiYWNrZ3JvdW5kLWNvbG9yOiNGOEY4Rjg7Y29sb3I6IzIxMjEyMX0uYWN0aW9uLWJhciAuYWN0aW9uLWJhci10aXRsZXtmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToxNzt2ZXJ0aWNhbC1hbGlnbjpjZW50ZXJ9LmFjdGlvbi1iYXIgLmFjdGlvbi1pdGVte2ZvbnQtd2VpZ2h0Om5vcm1hbH0uYWN0aXZpdHktaW5kaWNhdG9ye2NvbG9yOiMzMGJjZmY7d2lkdGg6MzA7aGVpZ2h0OjMwfS5idG57Y29sb3I6IzMwYmNmZjtiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50O21pbi1oZWlnaHQ6MzY7bWluLXdpZHRoOjY0O3BhZGRpbmc6MTAgMTAgMTAgMTA7Zm9udC1zaXplOjE4O21hcmdpbjo4IDE2IDggMTZ9LmJ0bi5idG4tYWN0aXZlOmhpZ2hsaWdodGVke2NvbG9yOiNmZmY7YmFja2dyb3VuZC1jb2xvcjojYzBlYmZmfS5idG4tcHJpbWFyeXtiYWNrZ3JvdW5kLWNvbG9yOiMzMGJjZmY7Ym9yZGVyLWNvbG9yOiMzMGJjZmY7Y29sb3I6I2ZmZn0uYnRuLXByaW1hcnkuYnRuLWFjdGl2ZTpoaWdobGlnaHRlZHtiYWNrZ3JvdW5kLWNvbG9yOiMwMWEwZWM7Ym9yZGVyLWNvbG9yOiMwMWEwZWN9LmJ0bi1wcmltYXJ5LmJ0bi1hcXVhe2JhY2tncm91bmQtY29sb3I6IzAwY2FhYn0uYnRuLXByaW1hcnkuYnRuLWJsdWV7YmFja2dyb3VuZC1jb2xvcjojM2Q1YWZlfS5idG4tcHJpbWFyeS5idG4tYnJvd257YmFja2dyb3VuZC1jb2xvcjojNzk1NTQ4fS5idG4tcHJpbWFyeS5idG4tZm9yZXN0e2JhY2tncm91bmQtY29sb3I6IzAwNjk2OH0uYnRuLXByaW1hcnkuYnRuLWdyZXl7YmFja2dyb3VuZC1jb2xvcjojNWM2ODdjfS5idG4tcHJpbWFyeS5idG4tbGVtb257YmFja2dyb3VuZC1jb2xvcjojZmZlYTAwO2NvbG9yOiMwMDB9LmJ0bi1wcmltYXJ5LmJ0bi1saW1le2JhY2tncm91bmQtY29sb3I6I2FlZTQwNjtjb2xvcjojMDAwfS5idG4tcHJpbWFyeS5idG4tb3Jhbmdle2JhY2tncm91bmQtY29sb3I6I2Y1N2MwMH0uYnRuLXByaW1hcnkuYnRuLXB1cnBsZXtiYWNrZ3JvdW5kLWNvbG9yOiM4MTMwZmZ9LmJ0bi1wcmltYXJ5LmJ0bi1ydWJ5e2JhY2tncm91bmQtY29sb3I6I2ZmMTc0NH0uYnRuLXByaW1hcnkuYnRuLXNreXtiYWNrZ3JvdW5kLWNvbG9yOiMzMGJjZmZ9LmJ0bi1vdXRsaW5le2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyLWNvbG9yOiMzMGJjZmY7Y29sb3I6IzMwYmNmZn0uYnRuLW91dGxpbmUuYnRuLWFjdGl2ZTpoaWdobGlnaHRlZHtiYWNrZ3JvdW5kLWNvbG9yOiNjMGViZmZ9LmJ0bltpc0VuYWJsZWQ9ZmFsc2Vde2NvbG9yOiNhNGE0YTQ7YmFja2dyb3VuZC1jb2xvcjojZTBlMGUwO2JvcmRlci1jb2xvcjojZTBlMGUwfS5mYXtmb250LWZhbWlseTpGb250QXdlc29tZSwgZm9udGF3ZXNvbWUtd2ViZm9udH0uZm9ybSAuaW5wdXR7cGFkZGluZzoxNiA4IDE2IDg7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudH0uZm9ybSAuaW5wdXQuaW5wdXQtYm9yZGVye2JvcmRlci13aWR0aDoxO2JvcmRlci1jb2xvcjojZTBlMGUwO2JvcmRlci1yYWRpdXM6MjtwYWRkaW5nOjE2fS5mb3JtIC5pbnB1dC5pbnB1dC1yb3VuZGVke2JvcmRlci13aWR0aDoxO2JvcmRlci1jb2xvcjojZTBlMGUwO2JvcmRlci1yYWRpdXM6Mjg7cGFkZGluZzoxNn0uZm9ybSAuaW5wdXRbaXNFbmFibGVkPSdmYWxzZSdde2JhY2tncm91bmQtY29sb3I6I2ZhZmFmYX0uZm9ybSAuaW5wdXQtZmllbGR7bWFyZ2luOjh9LmZvcm0gLmlucHV0LWZpZWxkIC5sYWJlbHtmb250LXNpemU6MTI7Y29sb3I6I2JhYmFiYX0uZm9ybSAuaW5wdXQtZmllbGQgLmlucHV0e3BhZGRpbmc6MDttYXJnaW46MCAwIDggMH0uZm9ybSAuaW5wdXQtZmllbGQgLmhyLWxpZ2h0LmFjdGl2ZSwuZm9ybSAuaW5wdXQtZmllbGQgLmhyLWRhcmsuYWN0aXZle2JhY2tncm91bmQtY29sb3I6IzMwYmNmZn0uZm9ybSAuaW5wdXQtZmllbGQuaW5wdXQtc2lkZXMgLmxhYmVse2ZvbnQtc2l6ZToxODttYXJnaW46MCAwIDggMH0uaDEsLmgyLC5oMywuaDQsLmg1LC5oNnttYXJnaW4tYm90dG9tOjQ7Zm9udC13ZWlnaHQ6bm9ybWFsO2NvbG9yOiMyMTIxMjF9LmJvZHksLmJvZHkyLC5mb290bm90ZXtmb250LXdlaWdodDpub3JtYWw7Y29sb3I6Izc1NzU3NX0uaDF7Zm9udC1zaXplOjMyfS5oMntmb250LXNpemU6MjJ9Lmgze2ZvbnQtc2l6ZToxNX0uaDR7Zm9udC1zaXplOjEyfS5oNXtmb250LXNpemU6MTF9Lmg2e2ZvbnQtc2l6ZToxMH0uYm9keXtmb250LXNpemU6MTR9LmJvZHkye2ZvbnQtc2l6ZToxN30uZm9vdG5vdGV7Zm9udC1zaXplOjEzfS5saXN0LWdyb3VwIC5saXN0LWdyb3VwLWl0ZW17Y29sb3I6IzIxMjEyMTtmb250LXNpemU6MTY7bWFyZ2luOjA7cGFkZGluZzoxNn0ubGlzdC1ncm91cCAubGlzdC1ncm91cC1pdGVtIExhYmVse3ZlcnRpY2FsLWFsaWduOmNlbnRlcn0ubGlzdC1ncm91cCAubGlzdC1ncm91cC1pdGVtIC50aHVtYntzdHJldGNoOmZpbGw7d2lkdGg6NDA7aGVpZ2h0OjQwO21hcmdpbi1yaWdodDoxNn0ubGlzdC1ncm91cCAubGlzdC1ncm91cC1pdGVtLmFjdGl2ZXtiYWNrZ3JvdW5kLWNvbG9yOiNlMGUwZTB9Lmxpc3QtZ3JvdXAgLmxpc3QtZ3JvdXAtaXRlbSAubGlzdC1ncm91cC1pdGVtLXRleHR7Y29sb3I6Izc1NzU3NTtmb250LXNpemU6MTR9LnBhZ2V7YmFja2dyb3VuZC1jb2xvcjojZmZmfS5wcm9ncmVzc3tjb2xvcjojMzBiY2ZmO2JhY2tncm91bmQtY29sb3I6I2JhYmFiYX0uc2VnbWVudGVkLWJhcntmb250LXNpemU6MTM7YmFja2dyb3VuZC1jb2xvcjojZmZmO2NvbG9yOiMyMTIxMjE7c2VsZWN0ZWQtYmFja2dyb3VuZC1jb2xvcjojMzBiY2ZmfS5zaWRlZHJhd2VyLWxlZnQsLnNpZGVkcmF3ZXItY2VudGVye2JhY2tncm91bmQtY29sb3I6I2ZhZmFmYX0uc2lkZWRyYXdlci1oZWFkZXJ7YmFja2dyb3VuZC1jb2xvcjojZmFmYWZhO2hlaWdodDoxNDg7d2lkdGg6MTAwJX0uc2lkZWRyYXdlci1sZWZ0IC5zaWRlZHJhd2VyLWhlYWRlcntwYWRkaW5nOjE2IDE2IDAgMTZ9LnNpZGVkcmF3ZXItY2VudGVyIC5zaWRlZHJhd2VyLWhlYWRlcntwYWRkaW5nOjIwIDE1IDAgMTV9LnNpZGVkcmF3ZXItaGVhZGVyLWltYWdle2JhY2tncm91bmQtY29sb3I6I2UwZTBlMH0uc2lkZWRyYXdlci1sZWZ0IC5zaWRlZHJhd2VyLWhlYWRlci1pbWFnZXtoZWlnaHQ6NjQ7d2lkdGg6NjQ7Ym9yZGVyLXJhZGl1czozMjtob3Jpem9udGFsLWFsaWduOmxlZnQ7bWFyZ2luLWJvdHRvbTozNn0uc2lkZWRyYXdlci1jZW50ZXIgLnNpZGVkcmF3ZXItaGVhZGVyLWltYWdle2hlaWdodDo3NDt3aWR0aDo3NDtib3JkZXItcmFkaXVzOjM3O2hvcml6b250YWwtYWxpZ246Y2VudGVyO21hcmdpbi1ib3R0b206MjR9LnNpZGVkcmF3ZXItaGVhZGVyLWJyYW5ke2NvbG9yOiM3MzczNzN9LnNpZGVkcmF3ZXItbGVmdCAuc2lkZWRyYXdlci1oZWFkZXItYnJhbmR7aG9yaXpvbnRhbC1hbGlnbjpsZWZ0O2ZvbnQtc2l6ZToxNH0uc2lkZWRyYXdlci1jZW50ZXIgLnNpZGVkcmF3ZXItaGVhZGVyLWJyYW5ke2hvcml6b250YWwtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToxNX0uc2lkZWRyYXdlci1saXN0LWl0ZW17aGVpZ2h0OjQ4O2hvcml6b250YWwtYWxpZ246bGVmdDt3aWR0aDoxMDAlO29yaWVudGF0aW9uOmhvcml6b250YWx9LnNpZGVkcmF3ZXItbGlzdC1pdGVtIC5zaWRlZHJhd2VyLWxpc3QtaXRlbS1pY29ue3dpZHRoOjI0O3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToyMDtoZWlnaHQ6NDg7dmVydGljYWwtYWxpZ246Y2VudGVyfS5zaWRlZHJhd2VyLWxpc3QtaXRlbS5hY3RpdmV7Y29sb3I6I2ZmZjtiYWNrZ3JvdW5kLWNvbG9yOiMzMGJjZmZ9LnNpZGVkcmF3ZXItbGlzdC1pdGVtLmFjdGl2ZSAuc2lkZWRyYXdlci1saXN0LWl0ZW0taWNvbntjb2xvcjojZmZmfS5zaWRlZHJhd2VyLWxlZnQgLnNpZGVkcmF3ZXItbGlzdC1pdGVtLWljb257bWFyZ2luOjAgMTYgMCAxNn0uc2lkZWRyYXdlci1jZW50ZXIgLnNpZGVkcmF3ZXItbGlzdC1pdGVtLWljb257bWFyZ2luOjAgMCAwIDE1fS5zaWRlZHJhd2VyLWxpc3QtaXRlbS10ZXh0e2hvcml6b250YWwtYWxpZ246bGVmdDt0ZXh0LWFsaWduOmxlZnQ7Zm9udC1zaXplOjE1O2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyLXdpZHRoOjAuMTt3aWR0aDo4MCU7dmVydGljYWwtYWxpZ246Y2VudGVyfS5zaWRlZHJhd2VyLWxlZnQgLnNpZGVkcmF3ZXItbGlzdC1pdGVtLXRleHR7cGFkZGluZy1sZWZ0OjE2fS5zaWRlZHJhd2VyLWNlbnRlciAuc2lkZWRyYXdlci1saXN0LWl0ZW0tdGV4dHtwYWRkaW5nLWxlZnQ6MTV9LnNsaWRlcntiYWNrZ3JvdW5kLWNvbG9yOiMzMGJjZmZ9LnNsaWRlcltpc0VuYWJsZWQ9ZmFsc2Vde2JhY2tncm91bmQtY29sb3I6I2UwZTBlMDtjb2xvcjojZTBlMGUwfS5zd2l0Y2hbY2hlY2tlZD10cnVlXXtiYWNrZ3JvdW5kLWNvbG9yOiMzMGJjZmY7Y29sb3I6IzMwYmNmZn0uc3dpdGNoW2NoZWNrZWQ9dHJ1ZV1baXNFbmFibGVkPWZhbHNlXXtiYWNrZ3JvdW5kLWNvbG9yOiNlMGUwZTA7Y29sb3I6I2ZmZn0uc3dpdGNoW2lzRW5hYmxlZD1mYWxzZV17YmFja2dyb3VuZC1jb2xvcjojZTBlMGUwO2NvbG9yOiNlMGUwZTB9LnRhYi12aWV3e3NlbGVjdGVkLWNvbG9yOiMzMGJjZmY7dGFicy1iYWNrZ3JvdW5kLWNvbG9yOiNmZmZ9LnRhYi12aWV3IC50YWItdmlldy1pdGVte2JhY2tncm91bmQtY29sb3I6I2ZmZjt0YWJzLWJhY2tncm91bmQtY29sb3I6I2ZmZn0jbG9naW4tYmFja2dyb3VuZHttYXJnaW4tdG9wOi0yMDtiYWNrZ3JvdW5kLXNpemU6Y292ZXI7YmFja2dyb3VuZC1wb3NpdGlvbjpjZW50ZXJ9LmxvZ2luLXdyYXB7cGFkZGluZzowIDQwfS5sb2dvLXdyYXB7bWFyZ2luOjYwIDAgMTAgMDtwYWRkaW5nOjIwIDB9LmxvZ28td3JhcCAubG9naW4tbG9nb3t0ZXh0LWFsaWduOmNlbnRlcjtmb250LXNpemU6MzA7Zm9udC13ZWlnaHQ6Ym9sZDttYXJnaW4tYm90dG9tOjEwO29wYWNpdHk6MTtjb2xvcjojMjEyMTIxO29wYWNpdHk6Ljl9LmxvZ28td3JhcCAubG9naW4tbG9nby1zdWJ7Y29sb3I6IzIxMjEyMTtvcGFjaXR5Oi44O3RleHQtYWxpZ246Y2VudGVyfS5sb2dpbi13cmFwcGVye3BhZGRpbmc6MjA7YmFja2dyb3VuZC1jb2xvcjojZmZmO2JvcmRlci1yYWRpdXM6M30ubG9naW4td3JhcHBlciBUZXh0RmllbGR7cGFkZGluZzoxMCAxMDttYXJnaW46MTAgMCAwIDB9LmdvLWJhY2t7Zm9udC1zaXplOjE0O3RleHQtYWxpZ246Y2VudGVyO2NvbG9yOiMyMTIxMjE7bWFyZ2luLXRvcDoxMH0uYWN0aW9uLWJhciAuYWN0aW9uLWJhci10aXRsZXtmb250LXdlaWdodDo1MDA7Zm9udC1zaXplOjIwfS5hY3Rpb24tYmFyIC5hY3Rpb24taXRlbXthbmRyb2lkLWVsZXZhdGlvbjowO2JhY2tncm91bmQtY29sb3I6cmdiYSgyNTUsMCwwLDApO2JvcmRlci1jb2xvcjpyZ2JhKDI1NSwwLDAsMCk7Ym9yZGVyLXdpZHRoOjF9LmJ0bntmb250LWZhbWlseTonUm9ib3RvIE1lZGl1bSc7Zm9udC1zaXplOjE0fS5idG4tcHJpbWFyeXtib3JkZXItY29sb3I6cmdiYSgyNTUsMCwwLDApfS5idG4tb3V0bGluZXthbmRyb2lkLWVsZXZhdGlvbjowO2JhY2tncm91bmQtY29sb3I6cmdiYSgyNTUsMCwwLDApO2JvcmRlci13aWR0aDoxO2JvcmRlci1jb2xvcjojMzBiY2ZmO2hlaWdodDozNjtwYWRkaW5nOjB9LmJ0bi1yb3VuZGVkLXNte2JvcmRlci1yYWRpdXM6MjtoZWlnaHQ6MzY7cGFkZGluZzowfS5idG4tcm91bmRlZC1sZ3tib3JkZXItcmFkaXVzOjQwO2hlaWdodDozNjtwYWRkaW5nOjB9LmZvcm17Zm9udC1mYW1pbHk6J1JvYm90byBSZWd1bGFyJ30uZm9ybSAuaW5wdXR7Zm9udC1zaXplOjE2fS5oMXtmb250LXNpemU6MzR9Lmgye2ZvbnQtc2l6ZToyNH0uaDN7Zm9udC1zaXplOjE2fS5oNXtmb250LXNpemU6MTE7Zm9udC13ZWlnaHQ6Ym9sZH0uYm9keTJ7Zm9udC1zaXplOjE0O2ZvbnQtd2VpZ2h0OjUwMH0uc2lkZWRyYXdlci1saXN0LWl0ZW0taWNvbnttYXJnaW46MCAxNiAwIDE2O3BhZGRpbmctdG9wOjE0fS5zaWRlZHJhd2VyLWxpc3QtaXRlbS1pY29uLC5zaWRlZHJhd2VyLWxpc3QtaXRlbXtjb2xvcjojNzM3MzczfS5zaWRlZHJhd2VyLWxpc3QtaXRlbXtmb250LWZhbWlseTonUm9ib3RvIE1lZGl1bSc7Zm9udC1zaXplOjE0fS5zbGlkZXJ7Y29sb3I6IzMwYmNmZjttYXJnaW46MjAgMTZ9LnN3aXRjaHttYXJnaW46MTQgMTY7Y29sb3I6I2UwZTBlMDtiYWNrZ3JvdW5kLWNvbG9yOiNlMGUwZTB9LnN3aXRjaFtjaGVja2VkPXRydWVde2NvbG9yOiMzMGJjZmZ9XFxuXCIsIFwiXCJdKTtcblxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qXG4gIE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXG4gIEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcbiovXG4vLyBjc3MgYmFzZSBjb2RlLCBpbmplY3RlZCBieSB0aGUgY3NzLWxvYWRlclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodXNlU291cmNlTWFwKSB7XG4gIHZhciBsaXN0ID0gW107IC8vIHJldHVybiB0aGUgbGlzdCBvZiBtb2R1bGVzIGFzIGNzcyBzdHJpbmdcblxuICBsaXN0LnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICB2YXIgY29udGVudCA9IGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcoaXRlbSwgdXNlU291cmNlTWFwKTtcblxuICAgICAgaWYgKGl0ZW1bMl0pIHtcbiAgICAgICAgcmV0dXJuICdAbWVkaWEgJyArIGl0ZW1bMl0gKyAneycgKyBjb250ZW50ICsgJ30nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgICB9XG4gICAgfSkuam9pbignJyk7XG4gIH07IC8vIGltcG9ydCBhIGxpc3Qgb2YgbW9kdWxlcyBpbnRvIHRoZSBsaXN0XG5cblxuICBsaXN0LmkgPSBmdW5jdGlvbiAobW9kdWxlcywgbWVkaWFRdWVyeSkge1xuICAgIGlmICh0eXBlb2YgbW9kdWxlcyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIG1vZHVsZXMgPSBbW251bGwsIG1vZHVsZXMsICcnXV07XG4gICAgfVxuXG4gICAgdmFyIGFscmVhZHlJbXBvcnRlZE1vZHVsZXMgPSB7fTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGlkID0gdGhpc1tpXVswXTtcblxuICAgICAgaWYgKGlkICE9IG51bGwpIHtcbiAgICAgICAgYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpZF0gPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgaXRlbSA9IG1vZHVsZXNbaV07IC8vIHNraXAgYWxyZWFkeSBpbXBvcnRlZCBtb2R1bGVcbiAgICAgIC8vIHRoaXMgaW1wbGVtZW50YXRpb24gaXMgbm90IDEwMCUgcGVyZmVjdCBmb3Igd2VpcmQgbWVkaWEgcXVlcnkgY29tYmluYXRpb25zXG4gICAgICAvLyB3aGVuIGEgbW9kdWxlIGlzIGltcG9ydGVkIG11bHRpcGxlIHRpbWVzIHdpdGggZGlmZmVyZW50IG1lZGlhIHF1ZXJpZXMuXG4gICAgICAvLyBJIGhvcGUgdGhpcyB3aWxsIG5ldmVyIG9jY3VyIChIZXkgdGhpcyB3YXkgd2UgaGF2ZSBzbWFsbGVyIGJ1bmRsZXMpXG5cbiAgICAgIGlmIChpdGVtWzBdID09IG51bGwgfHwgIWFscmVhZHlJbXBvcnRlZE1vZHVsZXNbaXRlbVswXV0pIHtcbiAgICAgICAgaWYgKG1lZGlhUXVlcnkgJiYgIWl0ZW1bMl0pIHtcbiAgICAgICAgICBpdGVtWzJdID0gbWVkaWFRdWVyeTtcbiAgICAgICAgfSBlbHNlIGlmIChtZWRpYVF1ZXJ5KSB7XG4gICAgICAgICAgaXRlbVsyXSA9ICcoJyArIGl0ZW1bMl0gKyAnKSBhbmQgKCcgKyBtZWRpYVF1ZXJ5ICsgJyknO1xuICAgICAgICB9XG5cbiAgICAgICAgbGlzdC5wdXNoKGl0ZW0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZXR1cm4gbGlzdDtcbn07XG5cbmZ1bmN0aW9uIGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcoaXRlbSwgdXNlU291cmNlTWFwKSB7XG4gIHZhciBjb250ZW50ID0gaXRlbVsxXSB8fCAnJztcbiAgdmFyIGNzc01hcHBpbmcgPSBpdGVtWzNdO1xuXG4gIGlmICghY3NzTWFwcGluZykge1xuICAgIHJldHVybiBjb250ZW50O1xuICB9XG5cbiAgaWYgKHVzZVNvdXJjZU1hcCAmJiB0eXBlb2YgYnRvYSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHZhciBzb3VyY2VNYXBwaW5nID0gdG9Db21tZW50KGNzc01hcHBpbmcpO1xuICAgIHZhciBzb3VyY2VVUkxzID0gY3NzTWFwcGluZy5zb3VyY2VzLm1hcChmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICByZXR1cm4gJy8qIyBzb3VyY2VVUkw9JyArIGNzc01hcHBpbmcuc291cmNlUm9vdCArIHNvdXJjZSArICcgKi8nO1xuICAgIH0pO1xuICAgIHJldHVybiBbY29udGVudF0uY29uY2F0KHNvdXJjZVVSTHMpLmNvbmNhdChbc291cmNlTWFwcGluZ10pLmpvaW4oJ1xcbicpO1xuICB9XG5cbiAgcmV0dXJuIFtjb250ZW50XS5qb2luKCdcXG4nKTtcbn0gLy8gQWRhcHRlZCBmcm9tIGNvbnZlcnQtc291cmNlLW1hcCAoTUlUKVxuXG5cbmZ1bmN0aW9uIHRvQ29tbWVudChzb3VyY2VNYXApIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gIHZhciBiYXNlNjQgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShzb3VyY2VNYXApKSkpO1xuICB2YXIgZGF0YSA9ICdzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04O2Jhc2U2NCwnICsgYmFzZTY0O1xuICByZXR1cm4gJy8qIyAnICsgZGF0YSArICcgKi8nO1xufSIsInZhciBjb252ZXJzaW9ucyA9IHtcclxuICAgIC8vIGxlbmd0aFxyXG4gICAgJ3B4Jzoge1xyXG4gICAgICAgICdweCc6IDEsXHJcbiAgICAgICAgJ2NtJzogOTYuMC8yLjU0LFxyXG4gICAgICAgICdtbSc6IDk2LjAvMjUuNCxcclxuICAgICAgICAnaW4nOiA5NixcclxuICAgICAgICAncHQnOiA5Ni4wLzcyLjAsXHJcbiAgICAgICAgJ3BjJzogMTZcclxuICAgIH0sXHJcbiAgICAnY20nOiB7XHJcbiAgICAgICAgJ3B4JzogMi41NC85Ni4wLFxyXG4gICAgICAgICdjbSc6IDEsXHJcbiAgICAgICAgJ21tJzogMC4xLFxyXG4gICAgICAgICdpbic6IDIuNTQsXHJcbiAgICAgICAgJ3B0JzogMi41NC83Mi4wLFxyXG4gICAgICAgICdwYyc6IDIuNTQvNi4wXHJcbiAgICB9LFxyXG4gICAgJ21tJzoge1xyXG4gICAgICAgICdweCc6IDI1LjQvOTYuMCxcclxuICAgICAgICAnY20nOiAxMCxcclxuICAgICAgICAnbW0nOiAxLFxyXG4gICAgICAgICdpbic6IDI1LjQsXHJcbiAgICAgICAgJ3B0JzogMjUuNC83Mi4wLFxyXG4gICAgICAgICdwYyc6IDI1LjQvNi4wXHJcbiAgICB9LFxyXG4gICAgJ2luJzoge1xyXG4gICAgICAgICdweCc6IDEuMC85Ni4wLFxyXG4gICAgICAgICdjbSc6IDEuMC8yLjU0LFxyXG4gICAgICAgICdtbSc6IDEuMC8yNS40LFxyXG4gICAgICAgICdpbic6IDEsXHJcbiAgICAgICAgJ3B0JzogMS4wLzcyLjAsXHJcbiAgICAgICAgJ3BjJzogMS4wLzYuMFxyXG4gICAgfSxcclxuICAgICdwdCc6IHtcclxuICAgICAgICAncHgnOiAwLjc1LFxyXG4gICAgICAgICdjbSc6IDcyLjAvMi41NCxcclxuICAgICAgICAnbW0nOiA3Mi4wLzI1LjQsXHJcbiAgICAgICAgJ2luJzogNzIsXHJcbiAgICAgICAgJ3B0JzogMSxcclxuICAgICAgICAncGMnOiAxMlxyXG4gICAgfSxcclxuICAgICdwYyc6IHtcclxuICAgICAgICAncHgnOiA2LjAvOTYuMCxcclxuICAgICAgICAnY20nOiA2LjAvMi41NCxcclxuICAgICAgICAnbW0nOiA2LjAvMjUuNCxcclxuICAgICAgICAnaW4nOiA2LFxyXG4gICAgICAgICdwdCc6IDYuMC83Mi4wLFxyXG4gICAgICAgICdwYyc6IDFcclxuICAgIH0sXHJcbiAgICAvLyBhbmdsZVxyXG4gICAgJ2RlZyc6IHtcclxuICAgICAgICAnZGVnJzogMSxcclxuICAgICAgICAnZ3JhZCc6IDAuOSxcclxuICAgICAgICAncmFkJzogMTgwL01hdGguUEksXHJcbiAgICAgICAgJ3R1cm4nOiAzNjBcclxuICAgIH0sXHJcbiAgICAnZ3JhZCc6IHtcclxuICAgICAgICAnZGVnJzogNDAwLzM2MCxcclxuICAgICAgICAnZ3JhZCc6IDEsXHJcbiAgICAgICAgJ3JhZCc6IDIwMC9NYXRoLlBJLFxyXG4gICAgICAgICd0dXJuJzogNDAwXHJcbiAgICB9LFxyXG4gICAgJ3JhZCc6IHtcclxuICAgICAgICAnZGVnJzogTWF0aC5QSS8xODAsXHJcbiAgICAgICAgJ2dyYWQnOiBNYXRoLlBJLzIwMCxcclxuICAgICAgICAncmFkJzogMSxcclxuICAgICAgICAndHVybic6IE1hdGguUEkqMlxyXG4gICAgfSxcclxuICAgICd0dXJuJzoge1xyXG4gICAgICAgICdkZWcnOiAxLzM2MCxcclxuICAgICAgICAnZ3JhZCc6IDEvNDAwLFxyXG4gICAgICAgICdyYWQnOiAwLjUvTWF0aC5QSSxcclxuICAgICAgICAndHVybic6IDFcclxuICAgIH0sXHJcbiAgICAvLyB0aW1lXHJcbiAgICAncyc6IHtcclxuICAgICAgICAncyc6IDEsXHJcbiAgICAgICAgJ21zJzogMS8xMDAwXHJcbiAgICB9LFxyXG4gICAgJ21zJzoge1xyXG4gICAgICAgICdzJzogMTAwMCxcclxuICAgICAgICAnbXMnOiAxXHJcbiAgICB9LFxyXG4gICAgLy8gZnJlcXVlbmN5XHJcbiAgICAnSHonOiB7XHJcbiAgICAgICAgJ0h6JzogMSxcclxuICAgICAgICAna0h6JzogMTAwMFxyXG4gICAgfSxcclxuICAgICdrSHonOiB7XHJcbiAgICAgICAgJ0h6JzogMS8xMDAwLFxyXG4gICAgICAgICdrSHonOiAxXHJcbiAgICB9LFxyXG4gICAgLy8gcmVzb2x1dGlvblxyXG4gICAgJ2RwaSc6IHtcclxuICAgICAgICAnZHBpJzogMSxcclxuICAgICAgICAnZHBjbSc6IDEuMC8yLjU0LFxyXG4gICAgICAgICdkcHB4JzogMS85NlxyXG4gICAgfSxcclxuICAgICdkcGNtJzoge1xyXG4gICAgICAgICdkcGknOiAyLjU0LFxyXG4gICAgICAgICdkcGNtJzogMSxcclxuICAgICAgICAnZHBweCc6IDIuNTQvOTYuMFxyXG4gICAgfSxcclxuICAgICdkcHB4Jzoge1xyXG4gICAgICAgICdkcGknOiA5NixcclxuICAgICAgICAnZHBjbSc6IDk2LjAvMi41NCxcclxuICAgICAgICAnZHBweCc6IDFcclxuICAgIH1cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHZhbHVlLCBzb3VyY2VVbml0LCB0YXJnZXRVbml0LCBwcmVjaXNpb24pIHtcclxuICAgIGlmICghY29udmVyc2lvbnMuaGFzT3duUHJvcGVydHkodGFyZ2V0VW5pdCkpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGNvbnZlcnQgdG8gXCIgKyB0YXJnZXRVbml0KTtcclxuXHJcbiAgICBpZiAoIWNvbnZlcnNpb25zW3RhcmdldFVuaXRdLmhhc093blByb3BlcnR5KHNvdXJjZVVuaXQpKVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBjb252ZXJ0IGZyb20gXCIgKyBzb3VyY2VVbml0ICsgXCIgdG8gXCIgKyB0YXJnZXRVbml0KTtcclxuXHJcbiAgICBwcmVjaXNpb24gPSBNYXRoLnBvdygxMCwgcGFyc2VJbnQocHJlY2lzaW9uKSB8fCA1KTtcclxuICAgIHJldHVybiBNYXRoLnJvdW5kKChjb252ZXJzaW9uc1t0YXJnZXRVbml0XVtzb3VyY2VVbml0XSAqIHZhbHVlKSAqIHByZWNpc2lvbikgLyBwcmVjaXNpb247XHJcbn07XHJcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGtleXMgPSByZXF1aXJlKCdvYmplY3Qta2V5cycpO1xudmFyIGhhc1N5bWJvbHMgPSB0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBTeW1ib2woJ2ZvbycpID09PSAnc3ltYm9sJztcblxudmFyIHRvU3RyID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbnZhciBjb25jYXQgPSBBcnJheS5wcm90b3R5cGUuY29uY2F0O1xudmFyIG9yaWdEZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcblxudmFyIGlzRnVuY3Rpb24gPSBmdW5jdGlvbiAoZm4pIHtcblx0cmV0dXJuIHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJyAmJiB0b1N0ci5jYWxsKGZuKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcbn07XG5cbnZhciBhcmVQcm9wZXJ0eURlc2NyaXB0b3JzU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgb2JqID0ge307XG5cdHRyeSB7XG5cdFx0b3JpZ0RlZmluZVByb3BlcnR5KG9iaiwgJ3gnLCB7IGVudW1lcmFibGU6IGZhbHNlLCB2YWx1ZTogb2JqIH0pO1xuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFycywgbm8tcmVzdHJpY3RlZC1zeW50YXhcblx0XHRmb3IgKHZhciBfIGluIG9iaikgeyAvLyBqc2NzOmlnbm9yZSBkaXNhbGxvd1VudXNlZFZhcmlhYmxlc1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0XHRyZXR1cm4gb2JqLnggPT09IG9iajtcblx0fSBjYXRjaCAoZSkgeyAvKiB0aGlzIGlzIElFIDguICovXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xudmFyIHN1cHBvcnRzRGVzY3JpcHRvcnMgPSBvcmlnRGVmaW5lUHJvcGVydHkgJiYgYXJlUHJvcGVydHlEZXNjcmlwdG9yc1N1cHBvcnRlZCgpO1xuXG52YXIgZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiAob2JqZWN0LCBuYW1lLCB2YWx1ZSwgcHJlZGljYXRlKSB7XG5cdGlmIChuYW1lIGluIG9iamVjdCAmJiAoIWlzRnVuY3Rpb24ocHJlZGljYXRlKSB8fCAhcHJlZGljYXRlKCkpKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGlmIChzdXBwb3J0c0Rlc2NyaXB0b3JzKSB7XG5cdFx0b3JpZ0RlZmluZVByb3BlcnR5KG9iamVjdCwgbmFtZSwge1xuXHRcdFx0Y29uZmlndXJhYmxlOiB0cnVlLFxuXHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXG5cdFx0XHR2YWx1ZTogdmFsdWUsXG5cdFx0XHR3cml0YWJsZTogdHJ1ZVxuXHRcdH0pO1xuXHR9IGVsc2Uge1xuXHRcdG9iamVjdFtuYW1lXSA9IHZhbHVlO1xuXHR9XG59O1xuXG52YXIgZGVmaW5lUHJvcGVydGllcyA9IGZ1bmN0aW9uIChvYmplY3QsIG1hcCkge1xuXHR2YXIgcHJlZGljYXRlcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDoge307XG5cdHZhciBwcm9wcyA9IGtleXMobWFwKTtcblx0aWYgKGhhc1N5bWJvbHMpIHtcblx0XHRwcm9wcyA9IGNvbmNhdC5jYWxsKHByb3BzLCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG1hcCkpO1xuXHR9XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRkZWZpbmVQcm9wZXJ0eShvYmplY3QsIHByb3BzW2ldLCBtYXBbcHJvcHNbaV1dLCBwcmVkaWNhdGVzW3Byb3BzW2ldXSk7XG5cdH1cbn07XG5cbmRlZmluZVByb3BlcnRpZXMuc3VwcG9ydHNEZXNjcmlwdG9ycyA9ICEhc3VwcG9ydHNEZXNjcmlwdG9ycztcblxubW9kdWxlLmV4cG9ydHMgPSBkZWZpbmVQcm9wZXJ0aWVzO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKiBnbG9iYWxzXG5cdEF0b21pY3MsXG5cdFNoYXJlZEFycmF5QnVmZmVyLFxuKi9cblxudmFyIHVuZGVmaW5lZDsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zaGFkb3ctcmVzdHJpY3RlZC1uYW1lc1xuXG52YXIgJFR5cGVFcnJvciA9IFR5cGVFcnJvcjtcblxudmFyIFRocm93VHlwZUVycm9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvclxuXHQ/IChmdW5jdGlvbiAoKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGFyZ3VtZW50cywgJ2NhbGxlZScpLmdldDsgfSgpKVxuXHQ6IGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3ICRUeXBlRXJyb3IoKTsgfTtcblxudmFyIGhhc1N5bWJvbHMgPSByZXF1aXJlKCdoYXMtc3ltYm9scycpKCk7XG5cbnZhciBnZXRQcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5fX3Byb3RvX187IH07IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcHJvdG9cblxudmFyIGdlbmVyYXRvcjsgLy8gPSBmdW5jdGlvbiAqICgpIHt9O1xudmFyIGdlbmVyYXRvckZ1bmN0aW9uID0gZ2VuZXJhdG9yID8gZ2V0UHJvdG8oZ2VuZXJhdG9yKSA6IHVuZGVmaW5lZDtcbnZhciBhc3luY0ZuOyAvLyBhc3luYyBmdW5jdGlvbigpIHt9O1xudmFyIGFzeW5jRnVuY3Rpb24gPSBhc3luY0ZuID8gYXN5bmNGbi5jb25zdHJ1Y3RvciA6IHVuZGVmaW5lZDtcbnZhciBhc3luY0dlbjsgLy8gYXN5bmMgZnVuY3Rpb24gKiAoKSB7fTtcbnZhciBhc3luY0dlbkZ1bmN0aW9uID0gYXN5bmNHZW4gPyBnZXRQcm90byhhc3luY0dlbikgOiB1bmRlZmluZWQ7XG52YXIgYXN5bmNHZW5JdGVyYXRvciA9IGFzeW5jR2VuID8gYXN5bmNHZW4oKSA6IHVuZGVmaW5lZDtcblxudmFyIFR5cGVkQXJyYXkgPSB0eXBlb2YgVWludDhBcnJheSA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBnZXRQcm90byhVaW50OEFycmF5KTtcblxudmFyIElOVFJJTlNJQ1MgPSB7XG5cdCckICVBcnJheSUnOiBBcnJheSxcblx0JyQgJUFycmF5QnVmZmVyJSc6IHR5cGVvZiBBcnJheUJ1ZmZlciA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBBcnJheUJ1ZmZlcixcblx0JyQgJUFycmF5QnVmZmVyUHJvdG90eXBlJSc6IHR5cGVvZiBBcnJheUJ1ZmZlciA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBBcnJheUJ1ZmZlci5wcm90b3R5cGUsXG5cdCckICVBcnJheUl0ZXJhdG9yUHJvdG90eXBlJSc6IGhhc1N5bWJvbHMgPyBnZXRQcm90byhbXVtTeW1ib2wuaXRlcmF0b3JdKCkpIDogdW5kZWZpbmVkLFxuXHQnJCAlQXJyYXlQcm90b3R5cGUlJzogQXJyYXkucHJvdG90eXBlLFxuXHQnJCAlQXJyYXlQcm90b19lbnRyaWVzJSc6IEFycmF5LnByb3RvdHlwZS5lbnRyaWVzLFxuXHQnJCAlQXJyYXlQcm90b19mb3JFYWNoJSc6IEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLFxuXHQnJCAlQXJyYXlQcm90b19rZXlzJSc6IEFycmF5LnByb3RvdHlwZS5rZXlzLFxuXHQnJCAlQXJyYXlQcm90b192YWx1ZXMlJzogQXJyYXkucHJvdG90eXBlLnZhbHVlcyxcblx0JyQgJUFzeW5jRnJvbVN5bmNJdGVyYXRvclByb3RvdHlwZSUnOiB1bmRlZmluZWQsXG5cdCckICVBc3luY0Z1bmN0aW9uJSc6IGFzeW5jRnVuY3Rpb24sXG5cdCckICVBc3luY0Z1bmN0aW9uUHJvdG90eXBlJSc6IGFzeW5jRnVuY3Rpb24gPyBhc3luY0Z1bmN0aW9uLnByb3RvdHlwZSA6IHVuZGVmaW5lZCxcblx0JyQgJUFzeW5jR2VuZXJhdG9yJSc6IGFzeW5jR2VuID8gZ2V0UHJvdG8oYXN5bmNHZW5JdGVyYXRvcikgOiB1bmRlZmluZWQsXG5cdCckICVBc3luY0dlbmVyYXRvckZ1bmN0aW9uJSc6IGFzeW5jR2VuRnVuY3Rpb24sXG5cdCckICVBc3luY0dlbmVyYXRvclByb3RvdHlwZSUnOiBhc3luY0dlbkZ1bmN0aW9uID8gYXN5bmNHZW5GdW5jdGlvbi5wcm90b3R5cGUgOiB1bmRlZmluZWQsXG5cdCckICVBc3luY0l0ZXJhdG9yUHJvdG90eXBlJSc6IGFzeW5jR2VuSXRlcmF0b3IgJiYgaGFzU3ltYm9scyAmJiBTeW1ib2wuYXN5bmNJdGVyYXRvciA/IGFzeW5jR2VuSXRlcmF0b3JbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCkgOiB1bmRlZmluZWQsXG5cdCckICVBdG9taWNzJSc6IHR5cGVvZiBBdG9taWNzID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IEF0b21pY3MsXG5cdCckICVCb29sZWFuJSc6IEJvb2xlYW4sXG5cdCckICVCb29sZWFuUHJvdG90eXBlJSc6IEJvb2xlYW4ucHJvdG90eXBlLFxuXHQnJCAlRGF0YVZpZXclJzogdHlwZW9mIERhdGFWaWV3ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IERhdGFWaWV3LFxuXHQnJCAlRGF0YVZpZXdQcm90b3R5cGUlJzogdHlwZW9mIERhdGFWaWV3ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IERhdGFWaWV3LnByb3RvdHlwZSxcblx0JyQgJURhdGUlJzogRGF0ZSxcblx0JyQgJURhdGVQcm90b3R5cGUlJzogRGF0ZS5wcm90b3R5cGUsXG5cdCckICVkZWNvZGVVUkklJzogZGVjb2RlVVJJLFxuXHQnJCAlZGVjb2RlVVJJQ29tcG9uZW50JSc6IGRlY29kZVVSSUNvbXBvbmVudCxcblx0JyQgJWVuY29kZVVSSSUnOiBlbmNvZGVVUkksXG5cdCckICVlbmNvZGVVUklDb21wb25lbnQlJzogZW5jb2RlVVJJQ29tcG9uZW50LFxuXHQnJCAlRXJyb3IlJzogRXJyb3IsXG5cdCckICVFcnJvclByb3RvdHlwZSUnOiBFcnJvci5wcm90b3R5cGUsXG5cdCckICVldmFsJSc6IGV2YWwsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tZXZhbFxuXHQnJCAlRXZhbEVycm9yJSc6IEV2YWxFcnJvcixcblx0JyQgJUV2YWxFcnJvclByb3RvdHlwZSUnOiBFdmFsRXJyb3IucHJvdG90eXBlLFxuXHQnJCAlRmxvYXQzMkFycmF5JSc6IHR5cGVvZiBGbG9hdDMyQXJyYXkgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogRmxvYXQzMkFycmF5LFxuXHQnJCAlRmxvYXQzMkFycmF5UHJvdG90eXBlJSc6IHR5cGVvZiBGbG9hdDMyQXJyYXkgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogRmxvYXQzMkFycmF5LnByb3RvdHlwZSxcblx0JyQgJUZsb2F0NjRBcnJheSUnOiB0eXBlb2YgRmxvYXQ2NEFycmF5ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IEZsb2F0NjRBcnJheSxcblx0JyQgJUZsb2F0NjRBcnJheVByb3RvdHlwZSUnOiB0eXBlb2YgRmxvYXQ2NEFycmF5ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IEZsb2F0NjRBcnJheS5wcm90b3R5cGUsXG5cdCckICVGdW5jdGlvbiUnOiBGdW5jdGlvbixcblx0JyQgJUZ1bmN0aW9uUHJvdG90eXBlJSc6IEZ1bmN0aW9uLnByb3RvdHlwZSxcblx0JyQgJUdlbmVyYXRvciUnOiBnZW5lcmF0b3IgPyBnZXRQcm90byhnZW5lcmF0b3IoKSkgOiB1bmRlZmluZWQsXG5cdCckICVHZW5lcmF0b3JGdW5jdGlvbiUnOiBnZW5lcmF0b3JGdW5jdGlvbixcblx0JyQgJUdlbmVyYXRvclByb3RvdHlwZSUnOiBnZW5lcmF0b3JGdW5jdGlvbiA/IGdlbmVyYXRvckZ1bmN0aW9uLnByb3RvdHlwZSA6IHVuZGVmaW5lZCxcblx0JyQgJUludDhBcnJheSUnOiB0eXBlb2YgSW50OEFycmF5ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IEludDhBcnJheSxcblx0JyQgJUludDhBcnJheVByb3RvdHlwZSUnOiB0eXBlb2YgSW50OEFycmF5ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IEludDhBcnJheS5wcm90b3R5cGUsXG5cdCckICVJbnQxNkFycmF5JSc6IHR5cGVvZiBJbnQxNkFycmF5ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IEludDE2QXJyYXksXG5cdCckICVJbnQxNkFycmF5UHJvdG90eXBlJSc6IHR5cGVvZiBJbnQxNkFycmF5ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IEludDhBcnJheS5wcm90b3R5cGUsXG5cdCckICVJbnQzMkFycmF5JSc6IHR5cGVvZiBJbnQzMkFycmF5ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IEludDMyQXJyYXksXG5cdCckICVJbnQzMkFycmF5UHJvdG90eXBlJSc6IHR5cGVvZiBJbnQzMkFycmF5ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IEludDMyQXJyYXkucHJvdG90eXBlLFxuXHQnJCAlaXNGaW5pdGUlJzogaXNGaW5pdGUsXG5cdCckICVpc05hTiUnOiBpc05hTixcblx0JyQgJUl0ZXJhdG9yUHJvdG90eXBlJSc6IGhhc1N5bWJvbHMgPyBnZXRQcm90byhnZXRQcm90byhbXVtTeW1ib2wuaXRlcmF0b3JdKCkpKSA6IHVuZGVmaW5lZCxcblx0JyQgJUpTT04lJzogSlNPTixcblx0JyQgJUpTT05QYXJzZSUnOiBKU09OLnBhcnNlLFxuXHQnJCAlTWFwJSc6IHR5cGVvZiBNYXAgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogTWFwLFxuXHQnJCAlTWFwSXRlcmF0b3JQcm90b3R5cGUlJzogdHlwZW9mIE1hcCA9PT0gJ3VuZGVmaW5lZCcgfHwgIWhhc1N5bWJvbHMgPyB1bmRlZmluZWQgOiBnZXRQcm90byhuZXcgTWFwKClbU3ltYm9sLml0ZXJhdG9yXSgpKSxcblx0JyQgJU1hcFByb3RvdHlwZSUnOiB0eXBlb2YgTWFwID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IE1hcC5wcm90b3R5cGUsXG5cdCckICVNYXRoJSc6IE1hdGgsXG5cdCckICVOdW1iZXIlJzogTnVtYmVyLFxuXHQnJCAlTnVtYmVyUHJvdG90eXBlJSc6IE51bWJlci5wcm90b3R5cGUsXG5cdCckICVPYmplY3QlJzogT2JqZWN0LFxuXHQnJCAlT2JqZWN0UHJvdG90eXBlJSc6IE9iamVjdC5wcm90b3R5cGUsXG5cdCckICVPYmpQcm90b190b1N0cmluZyUnOiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLFxuXHQnJCAlT2JqUHJvdG9fdmFsdWVPZiUnOiBPYmplY3QucHJvdG90eXBlLnZhbHVlT2YsXG5cdCckICVwYXJzZUZsb2F0JSc6IHBhcnNlRmxvYXQsXG5cdCckICVwYXJzZUludCUnOiBwYXJzZUludCxcblx0JyQgJVByb21pc2UlJzogdHlwZW9mIFByb21pc2UgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogUHJvbWlzZSxcblx0JyQgJVByb21pc2VQcm90b3R5cGUlJzogdHlwZW9mIFByb21pc2UgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogUHJvbWlzZS5wcm90b3R5cGUsXG5cdCckICVQcm9taXNlUHJvdG9fdGhlbiUnOiB0eXBlb2YgUHJvbWlzZSA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBQcm9taXNlLnByb3RvdHlwZS50aGVuLFxuXHQnJCAlUHJvbWlzZV9hbGwlJzogdHlwZW9mIFByb21pc2UgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogUHJvbWlzZS5hbGwsXG5cdCckICVQcm9taXNlX3JlamVjdCUnOiB0eXBlb2YgUHJvbWlzZSA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBQcm9taXNlLnJlamVjdCxcblx0JyQgJVByb21pc2VfcmVzb2x2ZSUnOiB0eXBlb2YgUHJvbWlzZSA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBQcm9taXNlLnJlc29sdmUsXG5cdCckICVQcm94eSUnOiB0eXBlb2YgUHJveHkgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogUHJveHksXG5cdCckICVSYW5nZUVycm9yJSc6IFJhbmdlRXJyb3IsXG5cdCckICVSYW5nZUVycm9yUHJvdG90eXBlJSc6IFJhbmdlRXJyb3IucHJvdG90eXBlLFxuXHQnJCAlUmVmZXJlbmNlRXJyb3IlJzogUmVmZXJlbmNlRXJyb3IsXG5cdCckICVSZWZlcmVuY2VFcnJvclByb3RvdHlwZSUnOiBSZWZlcmVuY2VFcnJvci5wcm90b3R5cGUsXG5cdCckICVSZWZsZWN0JSc6IHR5cGVvZiBSZWZsZWN0ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IFJlZmxlY3QsXG5cdCckICVSZWdFeHAlJzogUmVnRXhwLFxuXHQnJCAlUmVnRXhwUHJvdG90eXBlJSc6IFJlZ0V4cC5wcm90b3R5cGUsXG5cdCckICVTZXQlJzogdHlwZW9mIFNldCA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBTZXQsXG5cdCckICVTZXRJdGVyYXRvclByb3RvdHlwZSUnOiB0eXBlb2YgU2V0ID09PSAndW5kZWZpbmVkJyB8fCAhaGFzU3ltYm9scyA/IHVuZGVmaW5lZCA6IGdldFByb3RvKG5ldyBTZXQoKVtTeW1ib2wuaXRlcmF0b3JdKCkpLFxuXHQnJCAlU2V0UHJvdG90eXBlJSc6IHR5cGVvZiBTZXQgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogU2V0LnByb3RvdHlwZSxcblx0JyQgJVNoYXJlZEFycmF5QnVmZmVyJSc6IHR5cGVvZiBTaGFyZWRBcnJheUJ1ZmZlciA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBTaGFyZWRBcnJheUJ1ZmZlcixcblx0JyQgJVNoYXJlZEFycmF5QnVmZmVyUHJvdG90eXBlJSc6IHR5cGVvZiBTaGFyZWRBcnJheUJ1ZmZlciA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBTaGFyZWRBcnJheUJ1ZmZlci5wcm90b3R5cGUsXG5cdCckICVTdHJpbmclJzogU3RyaW5nLFxuXHQnJCAlU3RyaW5nSXRlcmF0b3JQcm90b3R5cGUlJzogaGFzU3ltYm9scyA/IGdldFByb3RvKCcnW1N5bWJvbC5pdGVyYXRvcl0oKSkgOiB1bmRlZmluZWQsXG5cdCckICVTdHJpbmdQcm90b3R5cGUlJzogU3RyaW5nLnByb3RvdHlwZSxcblx0JyQgJVN5bWJvbCUnOiBoYXNTeW1ib2xzID8gU3ltYm9sIDogdW5kZWZpbmVkLFxuXHQnJCAlU3ltYm9sUHJvdG90eXBlJSc6IGhhc1N5bWJvbHMgPyBTeW1ib2wucHJvdG90eXBlIDogdW5kZWZpbmVkLFxuXHQnJCAlU3ludGF4RXJyb3IlJzogU3ludGF4RXJyb3IsXG5cdCckICVTeW50YXhFcnJvclByb3RvdHlwZSUnOiBTeW50YXhFcnJvci5wcm90b3R5cGUsXG5cdCckICVUaHJvd1R5cGVFcnJvciUnOiBUaHJvd1R5cGVFcnJvcixcblx0JyQgJVR5cGVkQXJyYXklJzogVHlwZWRBcnJheSxcblx0JyQgJVR5cGVkQXJyYXlQcm90b3R5cGUlJzogVHlwZWRBcnJheSA/IFR5cGVkQXJyYXkucHJvdG90eXBlIDogdW5kZWZpbmVkLFxuXHQnJCAlVHlwZUVycm9yJSc6ICRUeXBlRXJyb3IsXG5cdCckICVUeXBlRXJyb3JQcm90b3R5cGUlJzogJFR5cGVFcnJvci5wcm90b3R5cGUsXG5cdCckICVVaW50OEFycmF5JSc6IHR5cGVvZiBVaW50OEFycmF5ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IFVpbnQ4QXJyYXksXG5cdCckICVVaW50OEFycmF5UHJvdG90eXBlJSc6IHR5cGVvZiBVaW50OEFycmF5ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IFVpbnQ4QXJyYXkucHJvdG90eXBlLFxuXHQnJCAlVWludDhDbGFtcGVkQXJyYXklJzogdHlwZW9mIFVpbnQ4Q2xhbXBlZEFycmF5ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IFVpbnQ4Q2xhbXBlZEFycmF5LFxuXHQnJCAlVWludDhDbGFtcGVkQXJyYXlQcm90b3R5cGUlJzogdHlwZW9mIFVpbnQ4Q2xhbXBlZEFycmF5ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IFVpbnQ4Q2xhbXBlZEFycmF5LnByb3RvdHlwZSxcblx0JyQgJVVpbnQxNkFycmF5JSc6IHR5cGVvZiBVaW50MTZBcnJheSA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBVaW50MTZBcnJheSxcblx0JyQgJVVpbnQxNkFycmF5UHJvdG90eXBlJSc6IHR5cGVvZiBVaW50MTZBcnJheSA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBVaW50MTZBcnJheS5wcm90b3R5cGUsXG5cdCckICVVaW50MzJBcnJheSUnOiB0eXBlb2YgVWludDMyQXJyYXkgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogVWludDMyQXJyYXksXG5cdCckICVVaW50MzJBcnJheVByb3RvdHlwZSUnOiB0eXBlb2YgVWludDMyQXJyYXkgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogVWludDMyQXJyYXkucHJvdG90eXBlLFxuXHQnJCAlVVJJRXJyb3IlJzogVVJJRXJyb3IsXG5cdCckICVVUklFcnJvclByb3RvdHlwZSUnOiBVUklFcnJvci5wcm90b3R5cGUsXG5cdCckICVXZWFrTWFwJSc6IHR5cGVvZiBXZWFrTWFwID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IFdlYWtNYXAsXG5cdCckICVXZWFrTWFwUHJvdG90eXBlJSc6IHR5cGVvZiBXZWFrTWFwID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IFdlYWtNYXAucHJvdG90eXBlLFxuXHQnJCAlV2Vha1NldCUnOiB0eXBlb2YgV2Vha1NldCA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBXZWFrU2V0LFxuXHQnJCAlV2Vha1NldFByb3RvdHlwZSUnOiB0eXBlb2YgV2Vha1NldCA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBXZWFrU2V0LnByb3RvdHlwZVxufTtcblxudmFyIGJpbmQgPSByZXF1aXJlKCdmdW5jdGlvbi1iaW5kJyk7XG52YXIgJHJlcGxhY2UgPSBiaW5kLmNhbGwoRnVuY3Rpb24uY2FsbCwgU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlKTtcblxuLyogYWRhcHRlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9sb2Rhc2gvbG9kYXNoL2Jsb2IvNC4xNy4xNS9kaXN0L2xvZGFzaC5qcyNMNjczNS1MNjc0NCAqL1xudmFyIHJlUHJvcE5hbWUgPSAvW14lLltcXF1dK3xcXFsoPzooLT9cXGQrKD86XFwuXFxkKyk/KXwoW1wiJ10pKCg/Oig/IVxcMilbXlxcXFxdfFxcXFwuKSo/KVxcMilcXF18KD89KD86XFwufFxcW1xcXSkoPzpcXC58XFxbXFxdfCUkKSkvZztcbnZhciByZUVzY2FwZUNoYXIgPSAvXFxcXChcXFxcKT8vZzsgLyoqIFVzZWQgdG8gbWF0Y2ggYmFja3NsYXNoZXMgaW4gcHJvcGVydHkgcGF0aHMuICovXG52YXIgc3RyaW5nVG9QYXRoID0gZnVuY3Rpb24gc3RyaW5nVG9QYXRoKHN0cmluZykge1xuXHR2YXIgcmVzdWx0ID0gW107XG5cdCRyZXBsYWNlKHN0cmluZywgcmVQcm9wTmFtZSwgZnVuY3Rpb24gKG1hdGNoLCBudW1iZXIsIHF1b3RlLCBzdWJTdHJpbmcpIHtcblx0XHRyZXN1bHRbcmVzdWx0Lmxlbmd0aF0gPSBxdW90ZSA/ICRyZXBsYWNlKHN1YlN0cmluZywgcmVFc2NhcGVDaGFyLCAnJDEnKSA6IChudW1iZXIgfHwgbWF0Y2gpO1xuXHR9KTtcblx0cmV0dXJuIHJlc3VsdDtcbn07XG4vKiBlbmQgYWRhcHRhdGlvbiAqL1xuXG52YXIgZ2V0QmFzZUludHJpbnNpYyA9IGZ1bmN0aW9uIGdldEJhc2VJbnRyaW5zaWMobmFtZSwgYWxsb3dNaXNzaW5nKSB7XG5cdHZhciBrZXkgPSAnJCAnICsgbmFtZTtcblx0aWYgKCEoa2V5IGluIElOVFJJTlNJQ1MpKSB7XG5cdFx0dGhyb3cgbmV3IFN5bnRheEVycm9yKCdpbnRyaW5zaWMgJyArIG5hbWUgKyAnIGRvZXMgbm90IGV4aXN0IScpO1xuXHR9XG5cblx0Ly8gaXN0YW5idWwgaWdub3JlIGlmIC8vIGhvcGVmdWxseSB0aGlzIGlzIGltcG9zc2libGUgdG8gdGVzdCA6LSlcblx0aWYgKHR5cGVvZiBJTlRSSU5TSUNTW2tleV0gPT09ICd1bmRlZmluZWQnICYmICFhbGxvd01pc3NpbmcpIHtcblx0XHR0aHJvdyBuZXcgJFR5cGVFcnJvcignaW50cmluc2ljICcgKyBuYW1lICsgJyBleGlzdHMsIGJ1dCBpcyBub3QgYXZhaWxhYmxlLiBQbGVhc2UgZmlsZSBhbiBpc3N1ZSEnKTtcblx0fVxuXG5cdHJldHVybiBJTlRSSU5TSUNTW2tleV07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIEdldEludHJpbnNpYyhuYW1lLCBhbGxvd01pc3NpbmcpIHtcblx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhbGxvd01pc3NpbmcgIT09ICdib29sZWFuJykge1xuXHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiYWxsb3dNaXNzaW5nXCIgYXJndW1lbnQgbXVzdCBiZSBhIGJvb2xlYW4nKTtcblx0fVxuXG5cdHZhciBwYXJ0cyA9IHN0cmluZ1RvUGF0aChuYW1lKTtcblxuXHRpZiAocGFydHMubGVuZ3RoID09PSAwKSB7XG5cdFx0cmV0dXJuIGdldEJhc2VJbnRyaW5zaWMobmFtZSwgYWxsb3dNaXNzaW5nKTtcblx0fVxuXG5cdHZhciB2YWx1ZSA9IGdldEJhc2VJbnRyaW5zaWMoJyUnICsgcGFydHNbMF0gKyAnJScsIGFsbG93TWlzc2luZyk7XG5cdGZvciAodmFyIGkgPSAxOyBpIDwgcGFydHMubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRpZiAodmFsdWUgIT0gbnVsbCkge1xuXHRcdFx0dmFsdWUgPSB2YWx1ZVtwYXJ0c1tpXV07XG5cdFx0fVxuXHR9XG5cdHJldHVybiB2YWx1ZTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBHZXRJbnRyaW5zaWMgPSByZXF1aXJlKCcuL0dldEludHJpbnNpYycpO1xuXG52YXIgJE9iamVjdCA9IEdldEludHJpbnNpYygnJU9iamVjdCUnKTtcbnZhciAkRXZhbEVycm9yID0gR2V0SW50cmluc2ljKCclRXZhbEVycm9yJScpO1xudmFyICRUeXBlRXJyb3IgPSBHZXRJbnRyaW5zaWMoJyVUeXBlRXJyb3IlJyk7XG52YXIgJFN0cmluZyA9IEdldEludHJpbnNpYygnJVN0cmluZyUnKTtcbnZhciAkRGF0ZSA9IEdldEludHJpbnNpYygnJURhdGUlJyk7XG52YXIgJE51bWJlciA9IEdldEludHJpbnNpYygnJU51bWJlciUnKTtcbnZhciAkZmxvb3IgPSBHZXRJbnRyaW5zaWMoJyVNYXRoLmZsb29yJScpO1xudmFyICREYXRlVVRDID0gR2V0SW50cmluc2ljKCclRGF0ZS5VVEMlJyk7XG52YXIgJGFicyA9IEdldEludHJpbnNpYygnJU1hdGguYWJzJScpO1xuXG52YXIgYXNzZXJ0UmVjb3JkID0gcmVxdWlyZSgnLi9oZWxwZXJzL2Fzc2VydFJlY29yZCcpO1xudmFyIGlzUHJvcGVydHlEZXNjcmlwdG9yID0gcmVxdWlyZSgnLi9oZWxwZXJzL2lzUHJvcGVydHlEZXNjcmlwdG9yJyk7XG52YXIgJGlzTmFOID0gcmVxdWlyZSgnLi9oZWxwZXJzL2lzTmFOJyk7XG52YXIgJGlzRmluaXRlID0gcmVxdWlyZSgnLi9oZWxwZXJzL2lzRmluaXRlJyk7XG52YXIgc2lnbiA9IHJlcXVpcmUoJy4vaGVscGVycy9zaWduJyk7XG52YXIgbW9kID0gcmVxdWlyZSgnLi9oZWxwZXJzL21vZCcpO1xudmFyIGlzUHJlZml4T2YgPSByZXF1aXJlKCcuL2hlbHBlcnMvaXNQcmVmaXhPZicpO1xudmFyIGNhbGxCb3VuZCA9IHJlcXVpcmUoJy4vaGVscGVycy9jYWxsQm91bmQnKTtcblxudmFyIElzQ2FsbGFibGUgPSByZXF1aXJlKCdpcy1jYWxsYWJsZScpO1xudmFyIHRvUHJpbWl0aXZlID0gcmVxdWlyZSgnZXMtdG8tcHJpbWl0aXZlL2VzNScpO1xuXG52YXIgaGFzID0gcmVxdWlyZSgnaGFzJyk7XG5cbnZhciAkZ2V0VVRDRnVsbFllYXIgPSBjYWxsQm91bmQoJ0RhdGUucHJvdG90eXBlLmdldFVUQ0Z1bGxZZWFyJyk7XG5cbnZhciBIb3Vyc1BlckRheSA9IDI0O1xudmFyIE1pbnV0ZXNQZXJIb3VyID0gNjA7XG52YXIgU2Vjb25kc1Blck1pbnV0ZSA9IDYwO1xudmFyIG1zUGVyU2Vjb25kID0gMWUzO1xudmFyIG1zUGVyTWludXRlID0gbXNQZXJTZWNvbmQgKiBTZWNvbmRzUGVyTWludXRlO1xudmFyIG1zUGVySG91ciA9IG1zUGVyTWludXRlICogTWludXRlc1BlckhvdXI7XG52YXIgbXNQZXJEYXkgPSA4NjQwMDAwMDtcblxuLy8gaHR0cHM6Ly9lczUuZ2l0aHViLmlvLyN4OVxudmFyIEVTNSA9IHtcblx0VG9QcmltaXRpdmU6IHRvUHJpbWl0aXZlLFxuXG5cdFRvQm9vbGVhbjogZnVuY3Rpb24gVG9Cb29sZWFuKHZhbHVlKSB7XG5cdFx0cmV0dXJuICEhdmFsdWU7XG5cdH0sXG5cdFRvTnVtYmVyOiBmdW5jdGlvbiBUb051bWJlcih2YWx1ZSkge1xuXHRcdHJldHVybiArdmFsdWU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8taW1wbGljaXQtY29lcmNpb25cblx0fSxcblx0VG9JbnRlZ2VyOiBmdW5jdGlvbiBUb0ludGVnZXIodmFsdWUpIHtcblx0XHR2YXIgbnVtYmVyID0gdGhpcy5Ub051bWJlcih2YWx1ZSk7XG5cdFx0aWYgKCRpc05hTihudW1iZXIpKSB7IHJldHVybiAwOyB9XG5cdFx0aWYgKG51bWJlciA9PT0gMCB8fCAhJGlzRmluaXRlKG51bWJlcikpIHsgcmV0dXJuIG51bWJlcjsgfVxuXHRcdHJldHVybiBzaWduKG51bWJlcikgKiBNYXRoLmZsb29yKE1hdGguYWJzKG51bWJlcikpO1xuXHR9LFxuXHRUb0ludDMyOiBmdW5jdGlvbiBUb0ludDMyKHgpIHtcblx0XHRyZXR1cm4gdGhpcy5Ub051bWJlcih4KSA+PiAwO1xuXHR9LFxuXHRUb1VpbnQzMjogZnVuY3Rpb24gVG9VaW50MzIoeCkge1xuXHRcdHJldHVybiB0aGlzLlRvTnVtYmVyKHgpID4+PiAwO1xuXHR9LFxuXHRUb1VpbnQxNjogZnVuY3Rpb24gVG9VaW50MTYodmFsdWUpIHtcblx0XHR2YXIgbnVtYmVyID0gdGhpcy5Ub051bWJlcih2YWx1ZSk7XG5cdFx0aWYgKCRpc05hTihudW1iZXIpIHx8IG51bWJlciA9PT0gMCB8fCAhJGlzRmluaXRlKG51bWJlcikpIHsgcmV0dXJuIDA7IH1cblx0XHR2YXIgcG9zSW50ID0gc2lnbihudW1iZXIpICogTWF0aC5mbG9vcihNYXRoLmFicyhudW1iZXIpKTtcblx0XHRyZXR1cm4gbW9kKHBvc0ludCwgMHgxMDAwMCk7XG5cdH0sXG5cdFRvU3RyaW5nOiBmdW5jdGlvbiBUb1N0cmluZyh2YWx1ZSkge1xuXHRcdHJldHVybiAkU3RyaW5nKHZhbHVlKTtcblx0fSxcblx0VG9PYmplY3Q6IGZ1bmN0aW9uIFRvT2JqZWN0KHZhbHVlKSB7XG5cdFx0dGhpcy5DaGVja09iamVjdENvZXJjaWJsZSh2YWx1ZSk7XG5cdFx0cmV0dXJuICRPYmplY3QodmFsdWUpO1xuXHR9LFxuXHRDaGVja09iamVjdENvZXJjaWJsZTogZnVuY3Rpb24gQ2hlY2tPYmplY3RDb2VyY2libGUodmFsdWUsIG9wdE1lc3NhZ2UpIHtcblx0XHQvKiBqc2hpbnQgZXFudWxsOnRydWUgKi9cblx0XHRpZiAodmFsdWUgPT0gbnVsbCkge1xuXHRcdFx0dGhyb3cgbmV3ICRUeXBlRXJyb3Iob3B0TWVzc2FnZSB8fCAnQ2Fubm90IGNhbGwgbWV0aG9kIG9uICcgKyB2YWx1ZSk7XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcblx0SXNDYWxsYWJsZTogSXNDYWxsYWJsZSxcblx0U2FtZVZhbHVlOiBmdW5jdGlvbiBTYW1lVmFsdWUoeCwgeSkge1xuXHRcdGlmICh4ID09PSB5KSB7IC8vIDAgPT09IC0wLCBidXQgdGhleSBhcmUgbm90IGlkZW50aWNhbC5cblx0XHRcdGlmICh4ID09PSAwKSB7IHJldHVybiAxIC8geCA9PT0gMSAvIHk7IH1cblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRyZXR1cm4gJGlzTmFOKHgpICYmICRpc05hTih5KTtcblx0fSxcblxuXHQvLyBodHRwczovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtOFxuXHRUeXBlOiBmdW5jdGlvbiBUeXBlKHgpIHtcblx0XHRpZiAoeCA9PT0gbnVsbCkge1xuXHRcdFx0cmV0dXJuICdOdWxsJztcblx0XHR9XG5cdFx0aWYgKHR5cGVvZiB4ID09PSAndW5kZWZpbmVkJykge1xuXHRcdFx0cmV0dXJuICdVbmRlZmluZWQnO1xuXHRcdH1cblx0XHRpZiAodHlwZW9mIHggPT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIHggPT09ICdvYmplY3QnKSB7XG5cdFx0XHRyZXR1cm4gJ09iamVjdCc7XG5cdFx0fVxuXHRcdGlmICh0eXBlb2YgeCA9PT0gJ251bWJlcicpIHtcblx0XHRcdHJldHVybiAnTnVtYmVyJztcblx0XHR9XG5cdFx0aWYgKHR5cGVvZiB4ID09PSAnYm9vbGVhbicpIHtcblx0XHRcdHJldHVybiAnQm9vbGVhbic7XG5cdFx0fVxuXHRcdGlmICh0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHtcblx0XHRcdHJldHVybiAnU3RyaW5nJztcblx0XHR9XG5cdH0sXG5cblx0Ly8gaHR0cHM6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzYuMC8jc2VjLXByb3BlcnR5LWRlc2NyaXB0b3Itc3BlY2lmaWNhdGlvbi10eXBlXG5cdElzUHJvcGVydHlEZXNjcmlwdG9yOiBmdW5jdGlvbiBJc1Byb3BlcnR5RGVzY3JpcHRvcihEZXNjKSB7XG5cdFx0cmV0dXJuIGlzUHJvcGVydHlEZXNjcmlwdG9yKHRoaXMsIERlc2MpO1xuXHR9LFxuXG5cdC8vIGh0dHBzOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy04LjEwLjFcblx0SXNBY2Nlc3NvckRlc2NyaXB0b3I6IGZ1bmN0aW9uIElzQWNjZXNzb3JEZXNjcmlwdG9yKERlc2MpIHtcblx0XHRpZiAodHlwZW9mIERlc2MgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0YXNzZXJ0UmVjb3JkKHRoaXMsICdQcm9wZXJ0eSBEZXNjcmlwdG9yJywgJ0Rlc2MnLCBEZXNjKTtcblxuXHRcdGlmICghaGFzKERlc2MsICdbW0dldF1dJykgJiYgIWhhcyhEZXNjLCAnW1tTZXRdXScpKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRydWU7XG5cdH0sXG5cblx0Ly8gaHR0cHM6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzUuMS8jc2VjLTguMTAuMlxuXHRJc0RhdGFEZXNjcmlwdG9yOiBmdW5jdGlvbiBJc0RhdGFEZXNjcmlwdG9yKERlc2MpIHtcblx0XHRpZiAodHlwZW9mIERlc2MgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0YXNzZXJ0UmVjb3JkKHRoaXMsICdQcm9wZXJ0eSBEZXNjcmlwdG9yJywgJ0Rlc2MnLCBEZXNjKTtcblxuXHRcdGlmICghaGFzKERlc2MsICdbW1ZhbHVlXV0nKSAmJiAhaGFzKERlc2MsICdbW1dyaXRhYmxlXV0nKSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdHJldHVybiB0cnVlO1xuXHR9LFxuXG5cdC8vIGh0dHBzOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy04LjEwLjNcblx0SXNHZW5lcmljRGVzY3JpcHRvcjogZnVuY3Rpb24gSXNHZW5lcmljRGVzY3JpcHRvcihEZXNjKSB7XG5cdFx0aWYgKHR5cGVvZiBEZXNjID09PSAndW5kZWZpbmVkJykge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdGFzc2VydFJlY29yZCh0aGlzLCAnUHJvcGVydHkgRGVzY3JpcHRvcicsICdEZXNjJywgRGVzYyk7XG5cblx0XHRpZiAoIXRoaXMuSXNBY2Nlc3NvckRlc2NyaXB0b3IoRGVzYykgJiYgIXRoaXMuSXNEYXRhRGVzY3JpcHRvcihEZXNjKSkge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9LFxuXG5cdC8vIGh0dHBzOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy04LjEwLjRcblx0RnJvbVByb3BlcnR5RGVzY3JpcHRvcjogZnVuY3Rpb24gRnJvbVByb3BlcnR5RGVzY3JpcHRvcihEZXNjKSB7XG5cdFx0aWYgKHR5cGVvZiBEZXNjID09PSAndW5kZWZpbmVkJykge1xuXHRcdFx0cmV0dXJuIERlc2M7XG5cdFx0fVxuXG5cdFx0YXNzZXJ0UmVjb3JkKHRoaXMsICdQcm9wZXJ0eSBEZXNjcmlwdG9yJywgJ0Rlc2MnLCBEZXNjKTtcblxuXHRcdGlmICh0aGlzLklzRGF0YURlc2NyaXB0b3IoRGVzYykpIHtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHZhbHVlOiBEZXNjWydbW1ZhbHVlXV0nXSxcblx0XHRcdFx0d3JpdGFibGU6ICEhRGVzY1snW1tXcml0YWJsZV1dJ10sXG5cdFx0XHRcdGVudW1lcmFibGU6ICEhRGVzY1snW1tFbnVtZXJhYmxlXV0nXSxcblx0XHRcdFx0Y29uZmlndXJhYmxlOiAhIURlc2NbJ1tbQ29uZmlndXJhYmxlXV0nXVxuXHRcdFx0fTtcblx0XHR9IGVsc2UgaWYgKHRoaXMuSXNBY2Nlc3NvckRlc2NyaXB0b3IoRGVzYykpIHtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGdldDogRGVzY1snW1tHZXRdXSddLFxuXHRcdFx0XHRzZXQ6IERlc2NbJ1tbU2V0XV0nXSxcblx0XHRcdFx0ZW51bWVyYWJsZTogISFEZXNjWydbW0VudW1lcmFibGVdXSddLFxuXHRcdFx0XHRjb25maWd1cmFibGU6ICEhRGVzY1snW1tDb25maWd1cmFibGVdXSddXG5cdFx0XHR9O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aHJvdyBuZXcgJFR5cGVFcnJvcignRnJvbVByb3BlcnR5RGVzY3JpcHRvciBtdXN0IGJlIGNhbGxlZCB3aXRoIGEgZnVsbHkgcG9wdWxhdGVkIFByb3BlcnR5IERlc2NyaXB0b3InKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gaHR0cHM6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzUuMS8jc2VjLTguMTAuNVxuXHRUb1Byb3BlcnR5RGVzY3JpcHRvcjogZnVuY3Rpb24gVG9Qcm9wZXJ0eURlc2NyaXB0b3IoT2JqKSB7XG5cdFx0aWYgKHRoaXMuVHlwZShPYmopICE9PSAnT2JqZWN0Jykge1xuXHRcdFx0dGhyb3cgbmV3ICRUeXBlRXJyb3IoJ1RvUHJvcGVydHlEZXNjcmlwdG9yIHJlcXVpcmVzIGFuIG9iamVjdCcpO1xuXHRcdH1cblxuXHRcdHZhciBkZXNjID0ge307XG5cdFx0aWYgKGhhcyhPYmosICdlbnVtZXJhYmxlJykpIHtcblx0XHRcdGRlc2NbJ1tbRW51bWVyYWJsZV1dJ10gPSB0aGlzLlRvQm9vbGVhbihPYmouZW51bWVyYWJsZSk7XG5cdFx0fVxuXHRcdGlmIChoYXMoT2JqLCAnY29uZmlndXJhYmxlJykpIHtcblx0XHRcdGRlc2NbJ1tbQ29uZmlndXJhYmxlXV0nXSA9IHRoaXMuVG9Cb29sZWFuKE9iai5jb25maWd1cmFibGUpO1xuXHRcdH1cblx0XHRpZiAoaGFzKE9iaiwgJ3ZhbHVlJykpIHtcblx0XHRcdGRlc2NbJ1tbVmFsdWVdXSddID0gT2JqLnZhbHVlO1xuXHRcdH1cblx0XHRpZiAoaGFzKE9iaiwgJ3dyaXRhYmxlJykpIHtcblx0XHRcdGRlc2NbJ1tbV3JpdGFibGVdXSddID0gdGhpcy5Ub0Jvb2xlYW4oT2JqLndyaXRhYmxlKTtcblx0XHR9XG5cdFx0aWYgKGhhcyhPYmosICdnZXQnKSkge1xuXHRcdFx0dmFyIGdldHRlciA9IE9iai5nZXQ7XG5cdFx0XHRpZiAodHlwZW9mIGdldHRlciAhPT0gJ3VuZGVmaW5lZCcgJiYgIXRoaXMuSXNDYWxsYWJsZShnZXR0ZXIpKSB7XG5cdFx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ2dldHRlciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcblx0XHRcdH1cblx0XHRcdGRlc2NbJ1tbR2V0XV0nXSA9IGdldHRlcjtcblx0XHR9XG5cdFx0aWYgKGhhcyhPYmosICdzZXQnKSkge1xuXHRcdFx0dmFyIHNldHRlciA9IE9iai5zZXQ7XG5cdFx0XHRpZiAodHlwZW9mIHNldHRlciAhPT0gJ3VuZGVmaW5lZCcgJiYgIXRoaXMuSXNDYWxsYWJsZShzZXR0ZXIpKSB7XG5cdFx0XHRcdHRocm93IG5ldyAkVHlwZUVycm9yKCdzZXR0ZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cdFx0XHR9XG5cdFx0XHRkZXNjWydbW1NldF1dJ10gPSBzZXR0ZXI7XG5cdFx0fVxuXG5cdFx0aWYgKChoYXMoZGVzYywgJ1tbR2V0XV0nKSB8fCBoYXMoZGVzYywgJ1tbU2V0XV0nKSkgJiYgKGhhcyhkZXNjLCAnW1tWYWx1ZV1dJykgfHwgaGFzKGRlc2MsICdbW1dyaXRhYmxlXV0nKSkpIHtcblx0XHRcdHRocm93IG5ldyAkVHlwZUVycm9yKCdJbnZhbGlkIHByb3BlcnR5IGRlc2NyaXB0b3IuIENhbm5vdCBib3RoIHNwZWNpZnkgYWNjZXNzb3JzIGFuZCBhIHZhbHVlIG9yIHdyaXRhYmxlIGF0dHJpYnV0ZScpO1xuXHRcdH1cblx0XHRyZXR1cm4gZGVzYztcblx0fSxcblxuXHQvLyBodHRwczovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTEuOS4zXG5cdCdBYnN0cmFjdCBFcXVhbGl0eSBDb21wYXJpc29uJzogZnVuY3Rpb24gQWJzdHJhY3RFcXVhbGl0eUNvbXBhcmlzb24oeCwgeSkge1xuXHRcdHZhciB4VHlwZSA9IHRoaXMuVHlwZSh4KTtcblx0XHR2YXIgeVR5cGUgPSB0aGlzLlR5cGUoeSk7XG5cdFx0aWYgKHhUeXBlID09PSB5VHlwZSkge1xuXHRcdFx0cmV0dXJuIHggPT09IHk7IC8vIEVTNisgc3BlY2lmaWVkIHRoaXMgc2hvcnRjdXQgYW55d2F5cy5cblx0XHR9XG5cdFx0aWYgKHggPT0gbnVsbCAmJiB5ID09IG51bGwpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRpZiAoeFR5cGUgPT09ICdOdW1iZXInICYmIHlUeXBlID09PSAnU3RyaW5nJykge1xuXHRcdFx0cmV0dXJuIHRoaXNbJ0Fic3RyYWN0IEVxdWFsaXR5IENvbXBhcmlzb24nXSh4LCB0aGlzLlRvTnVtYmVyKHkpKTtcblx0XHR9XG5cdFx0aWYgKHhUeXBlID09PSAnU3RyaW5nJyAmJiB5VHlwZSA9PT0gJ051bWJlcicpIHtcblx0XHRcdHJldHVybiB0aGlzWydBYnN0cmFjdCBFcXVhbGl0eSBDb21wYXJpc29uJ10odGhpcy5Ub051bWJlcih4KSwgeSk7XG5cdFx0fVxuXHRcdGlmICh4VHlwZSA9PT0gJ0Jvb2xlYW4nKSB7XG5cdFx0XHRyZXR1cm4gdGhpc1snQWJzdHJhY3QgRXF1YWxpdHkgQ29tcGFyaXNvbiddKHRoaXMuVG9OdW1iZXIoeCksIHkpO1xuXHRcdH1cblx0XHRpZiAoeVR5cGUgPT09ICdCb29sZWFuJykge1xuXHRcdFx0cmV0dXJuIHRoaXNbJ0Fic3RyYWN0IEVxdWFsaXR5IENvbXBhcmlzb24nXSh4LCB0aGlzLlRvTnVtYmVyKHkpKTtcblx0XHR9XG5cdFx0aWYgKCh4VHlwZSA9PT0gJ1N0cmluZycgfHwgeFR5cGUgPT09ICdOdW1iZXInKSAmJiB5VHlwZSA9PT0gJ09iamVjdCcpIHtcblx0XHRcdHJldHVybiB0aGlzWydBYnN0cmFjdCBFcXVhbGl0eSBDb21wYXJpc29uJ10oeCwgdGhpcy5Ub1ByaW1pdGl2ZSh5KSk7XG5cdFx0fVxuXHRcdGlmICh4VHlwZSA9PT0gJ09iamVjdCcgJiYgKHlUeXBlID09PSAnU3RyaW5nJyB8fCB5VHlwZSA9PT0gJ051bWJlcicpKSB7XG5cdFx0XHRyZXR1cm4gdGhpc1snQWJzdHJhY3QgRXF1YWxpdHkgQ29tcGFyaXNvbiddKHRoaXMuVG9QcmltaXRpdmUoeCksIHkpO1xuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0sXG5cblx0Ly8gaHR0cHM6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzUuMS8jc2VjLTExLjkuNlxuXHQnU3RyaWN0IEVxdWFsaXR5IENvbXBhcmlzb24nOiBmdW5jdGlvbiBTdHJpY3RFcXVhbGl0eUNvbXBhcmlzb24oeCwgeSkge1xuXHRcdHZhciB4VHlwZSA9IHRoaXMuVHlwZSh4KTtcblx0XHR2YXIgeVR5cGUgPSB0aGlzLlR5cGUoeSk7XG5cdFx0aWYgKHhUeXBlICE9PSB5VHlwZSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0XHRpZiAoeFR5cGUgPT09ICdVbmRlZmluZWQnIHx8IHhUeXBlID09PSAnTnVsbCcpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRyZXR1cm4geCA9PT0geTsgLy8gc2hvcnRjdXQgZm9yIHN0ZXBzIDQtN1xuXHR9LFxuXG5cdC8vIGh0dHBzOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy0xMS44LjVcblx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1zdGF0ZW1lbnRzXG5cdCdBYnN0cmFjdCBSZWxhdGlvbmFsIENvbXBhcmlzb24nOiBmdW5jdGlvbiBBYnN0cmFjdFJlbGF0aW9uYWxDb21wYXJpc29uKHgsIHksIExlZnRGaXJzdCkge1xuXHRcdGlmICh0aGlzLlR5cGUoTGVmdEZpcnN0KSAhPT0gJ0Jvb2xlYW4nKSB7XG5cdFx0XHR0aHJvdyBuZXcgJFR5cGVFcnJvcignQXNzZXJ0aW9uIGZhaWxlZDogTGVmdEZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBCb29sZWFuJyk7XG5cdFx0fVxuXHRcdHZhciBweDtcblx0XHR2YXIgcHk7XG5cdFx0aWYgKExlZnRGaXJzdCkge1xuXHRcdFx0cHggPSB0aGlzLlRvUHJpbWl0aXZlKHgsICROdW1iZXIpO1xuXHRcdFx0cHkgPSB0aGlzLlRvUHJpbWl0aXZlKHksICROdW1iZXIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRweSA9IHRoaXMuVG9QcmltaXRpdmUoeSwgJE51bWJlcik7XG5cdFx0XHRweCA9IHRoaXMuVG9QcmltaXRpdmUoeCwgJE51bWJlcik7XG5cdFx0fVxuXHRcdHZhciBib3RoU3RyaW5ncyA9IHRoaXMuVHlwZShweCkgPT09ICdTdHJpbmcnICYmIHRoaXMuVHlwZShweSkgPT09ICdTdHJpbmcnO1xuXHRcdGlmICghYm90aFN0cmluZ3MpIHtcblx0XHRcdHZhciBueCA9IHRoaXMuVG9OdW1iZXIocHgpO1xuXHRcdFx0dmFyIG55ID0gdGhpcy5Ub051bWJlcihweSk7XG5cdFx0XHRpZiAoJGlzTmFOKG54KSB8fCAkaXNOYU4obnkpKSB7XG5cdFx0XHRcdHJldHVybiB1bmRlZmluZWQ7XG5cdFx0XHR9XG5cdFx0XHRpZiAoJGlzRmluaXRlKG54KSAmJiAkaXNGaW5pdGUobnkpICYmIG54ID09PSBueSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRpZiAobnggPT09IDAgJiYgbnkgPT09IDApIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0aWYgKG54ID09PSBJbmZpbml0eSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRpZiAobnkgPT09IEluZmluaXR5KSB7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0aWYgKG55ID09PSAtSW5maW5pdHkpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0aWYgKG54ID09PSAtSW5maW5pdHkpIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnggPCBueTsgLy8gYnkgbm93LCB0aGVzZSBhcmUgYm90aCBub256ZXJvLCBmaW5pdGUsIGFuZCBub3QgZXF1YWxcblx0XHR9XG5cdFx0aWYgKGlzUHJlZml4T2YocHksIHB4KSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0XHRpZiAoaXNQcmVmaXhPZihweCwgcHkpKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0cmV0dXJuIHB4IDwgcHk7IC8vIGJvdGggc3RyaW5ncywgbmVpdGhlciBhIHByZWZpeCBvZiB0aGUgb3RoZXIuIHNob3J0Y3V0IGZvciBzdGVwcyBjLWZcblx0fSxcblxuXHQvLyBodHRwczovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuOS4xLjEwXG5cdG1zRnJvbVRpbWU6IGZ1bmN0aW9uIG1zRnJvbVRpbWUodCkge1xuXHRcdHJldHVybiBtb2QodCwgbXNQZXJTZWNvbmQpO1xuXHR9LFxuXG5cdC8vIGh0dHBzOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy0xNS45LjEuMTBcblx0U2VjRnJvbVRpbWU6IGZ1bmN0aW9uIFNlY0Zyb21UaW1lKHQpIHtcblx0XHRyZXR1cm4gbW9kKCRmbG9vcih0IC8gbXNQZXJTZWNvbmQpLCBTZWNvbmRzUGVyTWludXRlKTtcblx0fSxcblxuXHQvLyBodHRwczovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuOS4xLjEwXG5cdE1pbkZyb21UaW1lOiBmdW5jdGlvbiBNaW5Gcm9tVGltZSh0KSB7XG5cdFx0cmV0dXJuIG1vZCgkZmxvb3IodCAvIG1zUGVyTWludXRlKSwgTWludXRlc1BlckhvdXIpO1xuXHR9LFxuXG5cdC8vIGh0dHBzOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy0xNS45LjEuMTBcblx0SG91ckZyb21UaW1lOiBmdW5jdGlvbiBIb3VyRnJvbVRpbWUodCkge1xuXHRcdHJldHVybiBtb2QoJGZsb29yKHQgLyBtc1BlckhvdXIpLCBIb3Vyc1BlckRheSk7XG5cdH0sXG5cblx0Ly8gaHR0cHM6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzUuMS8jc2VjLTE1LjkuMS4yXG5cdERheTogZnVuY3Rpb24gRGF5KHQpIHtcblx0XHRyZXR1cm4gJGZsb29yKHQgLyBtc1BlckRheSk7XG5cdH0sXG5cblx0Ly8gaHR0cHM6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzUuMS8jc2VjLTE1LjkuMS4yXG5cdFRpbWVXaXRoaW5EYXk6IGZ1bmN0aW9uIFRpbWVXaXRoaW5EYXkodCkge1xuXHRcdHJldHVybiBtb2QodCwgbXNQZXJEYXkpO1xuXHR9LFxuXG5cdC8vIGh0dHBzOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy0xNS45LjEuM1xuXHREYXlGcm9tWWVhcjogZnVuY3Rpb24gRGF5RnJvbVllYXIoeSkge1xuXHRcdHJldHVybiAoMzY1ICogKHkgLSAxOTcwKSkgKyAkZmxvb3IoKHkgLSAxOTY5KSAvIDQpIC0gJGZsb29yKCh5IC0gMTkwMSkgLyAxMDApICsgJGZsb29yKCh5IC0gMTYwMSkgLyA0MDApO1xuXHR9LFxuXG5cdC8vIGh0dHBzOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy0xNS45LjEuM1xuXHRUaW1lRnJvbVllYXI6IGZ1bmN0aW9uIFRpbWVGcm9tWWVhcih5KSB7XG5cdFx0cmV0dXJuIG1zUGVyRGF5ICogdGhpcy5EYXlGcm9tWWVhcih5KTtcblx0fSxcblxuXHQvLyBodHRwczovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuOS4xLjNcblx0WWVhckZyb21UaW1lOiBmdW5jdGlvbiBZZWFyRnJvbVRpbWUodCkge1xuXHRcdC8vIGxhcmdlc3QgeSBzdWNoIHRoYXQgdGhpcy5UaW1lRnJvbVllYXIoeSkgPD0gdFxuXHRcdHJldHVybiAkZ2V0VVRDRnVsbFllYXIobmV3ICREYXRlKHQpKTtcblx0fSxcblxuXHQvLyBodHRwczovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuOS4xLjZcblx0V2Vla0RheTogZnVuY3Rpb24gV2Vla0RheSh0KSB7XG5cdFx0cmV0dXJuIG1vZCh0aGlzLkRheSh0KSArIDQsIDcpO1xuXHR9LFxuXG5cdC8vIGh0dHBzOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy0xNS45LjEuM1xuXHREYXlzSW5ZZWFyOiBmdW5jdGlvbiBEYXlzSW5ZZWFyKHkpIHtcblx0XHRpZiAobW9kKHksIDQpICE9PSAwKSB7XG5cdFx0XHRyZXR1cm4gMzY1O1xuXHRcdH1cblx0XHRpZiAobW9kKHksIDEwMCkgIT09IDApIHtcblx0XHRcdHJldHVybiAzNjY7XG5cdFx0fVxuXHRcdGlmIChtb2QoeSwgNDAwKSAhPT0gMCkge1xuXHRcdFx0cmV0dXJuIDM2NTtcblx0XHR9XG5cdFx0cmV0dXJuIDM2Njtcblx0fSxcblxuXHQvLyBodHRwczovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuOS4xLjNcblx0SW5MZWFwWWVhcjogZnVuY3Rpb24gSW5MZWFwWWVhcih0KSB7XG5cdFx0dmFyIGRheXMgPSB0aGlzLkRheXNJblllYXIodGhpcy5ZZWFyRnJvbVRpbWUodCkpO1xuXHRcdGlmIChkYXlzID09PSAzNjUpIHtcblx0XHRcdHJldHVybiAwO1xuXHRcdH1cblx0XHRpZiAoZGF5cyA9PT0gMzY2KSB7XG5cdFx0XHRyZXR1cm4gMTtcblx0XHR9XG5cdFx0dGhyb3cgbmV3ICRFdmFsRXJyb3IoJ0Fzc2VydGlvbiBmYWlsZWQ6IHRoZXJlIGFyZSBub3QgMzY1IG9yIDM2NiBkYXlzIGluIGEgeWVhciwgZ290OiAnICsgZGF5cyk7XG5cdH0sXG5cblx0Ly8gaHR0cHM6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzUuMS8jc2VjLTE1LjkuMS40XG5cdERheVdpdGhpblllYXI6IGZ1bmN0aW9uIERheVdpdGhpblllYXIodCkge1xuXHRcdHJldHVybiB0aGlzLkRheSh0KSAtIHRoaXMuRGF5RnJvbVllYXIodGhpcy5ZZWFyRnJvbVRpbWUodCkpO1xuXHR9LFxuXG5cdC8vIGh0dHBzOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy0xNS45LjEuNFxuXHRNb250aEZyb21UaW1lOiBmdW5jdGlvbiBNb250aEZyb21UaW1lKHQpIHtcblx0XHR2YXIgZGF5ID0gdGhpcy5EYXlXaXRoaW5ZZWFyKHQpO1xuXHRcdGlmICgwIDw9IGRheSAmJiBkYXkgPCAzMSkge1xuXHRcdFx0cmV0dXJuIDA7XG5cdFx0fVxuXHRcdHZhciBsZWFwID0gdGhpcy5JbkxlYXBZZWFyKHQpO1xuXHRcdGlmICgzMSA8PSBkYXkgJiYgZGF5IDwgKDU5ICsgbGVhcCkpIHtcblx0XHRcdHJldHVybiAxO1xuXHRcdH1cblx0XHRpZiAoKDU5ICsgbGVhcCkgPD0gZGF5ICYmIGRheSA8ICg5MCArIGxlYXApKSB7XG5cdFx0XHRyZXR1cm4gMjtcblx0XHR9XG5cdFx0aWYgKCg5MCArIGxlYXApIDw9IGRheSAmJiBkYXkgPCAoMTIwICsgbGVhcCkpIHtcblx0XHRcdHJldHVybiAzO1xuXHRcdH1cblx0XHRpZiAoKDEyMCArIGxlYXApIDw9IGRheSAmJiBkYXkgPCAoMTUxICsgbGVhcCkpIHtcblx0XHRcdHJldHVybiA0O1xuXHRcdH1cblx0XHRpZiAoKDE1MSArIGxlYXApIDw9IGRheSAmJiBkYXkgPCAoMTgxICsgbGVhcCkpIHtcblx0XHRcdHJldHVybiA1O1xuXHRcdH1cblx0XHRpZiAoKDE4MSArIGxlYXApIDw9IGRheSAmJiBkYXkgPCAoMjEyICsgbGVhcCkpIHtcblx0XHRcdHJldHVybiA2O1xuXHRcdH1cblx0XHRpZiAoKDIxMiArIGxlYXApIDw9IGRheSAmJiBkYXkgPCAoMjQzICsgbGVhcCkpIHtcblx0XHRcdHJldHVybiA3O1xuXHRcdH1cblx0XHRpZiAoKDI0MyArIGxlYXApIDw9IGRheSAmJiBkYXkgPCAoMjczICsgbGVhcCkpIHtcblx0XHRcdHJldHVybiA4O1xuXHRcdH1cblx0XHRpZiAoKDI3MyArIGxlYXApIDw9IGRheSAmJiBkYXkgPCAoMzA0ICsgbGVhcCkpIHtcblx0XHRcdHJldHVybiA5O1xuXHRcdH1cblx0XHRpZiAoKDMwNCArIGxlYXApIDw9IGRheSAmJiBkYXkgPCAoMzM0ICsgbGVhcCkpIHtcblx0XHRcdHJldHVybiAxMDtcblx0XHR9XG5cdFx0aWYgKCgzMzQgKyBsZWFwKSA8PSBkYXkgJiYgZGF5IDwgKDM2NSArIGxlYXApKSB7XG5cdFx0XHRyZXR1cm4gMTE7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIGh0dHBzOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy0xNS45LjEuNVxuXHREYXRlRnJvbVRpbWU6IGZ1bmN0aW9uIERhdGVGcm9tVGltZSh0KSB7XG5cdFx0dmFyIG0gPSB0aGlzLk1vbnRoRnJvbVRpbWUodCk7XG5cdFx0dmFyIGQgPSB0aGlzLkRheVdpdGhpblllYXIodCk7XG5cdFx0aWYgKG0gPT09IDApIHtcblx0XHRcdHJldHVybiBkICsgMTtcblx0XHR9XG5cdFx0aWYgKG0gPT09IDEpIHtcblx0XHRcdHJldHVybiBkIC0gMzA7XG5cdFx0fVxuXHRcdHZhciBsZWFwID0gdGhpcy5JbkxlYXBZZWFyKHQpO1xuXHRcdGlmIChtID09PSAyKSB7XG5cdFx0XHRyZXR1cm4gZCAtIDU4IC0gbGVhcDtcblx0XHR9XG5cdFx0aWYgKG0gPT09IDMpIHtcblx0XHRcdHJldHVybiBkIC0gODkgLSBsZWFwO1xuXHRcdH1cblx0XHRpZiAobSA9PT0gNCkge1xuXHRcdFx0cmV0dXJuIGQgLSAxMTkgLSBsZWFwO1xuXHRcdH1cblx0XHRpZiAobSA9PT0gNSkge1xuXHRcdFx0cmV0dXJuIGQgLSAxNTAgLSBsZWFwO1xuXHRcdH1cblx0XHRpZiAobSA9PT0gNikge1xuXHRcdFx0cmV0dXJuIGQgLSAxODAgLSBsZWFwO1xuXHRcdH1cblx0XHRpZiAobSA9PT0gNykge1xuXHRcdFx0cmV0dXJuIGQgLSAyMTEgLSBsZWFwO1xuXHRcdH1cblx0XHRpZiAobSA9PT0gOCkge1xuXHRcdFx0cmV0dXJuIGQgLSAyNDIgLSBsZWFwO1xuXHRcdH1cblx0XHRpZiAobSA9PT0gOSkge1xuXHRcdFx0cmV0dXJuIGQgLSAyNzIgLSBsZWFwO1xuXHRcdH1cblx0XHRpZiAobSA9PT0gMTApIHtcblx0XHRcdHJldHVybiBkIC0gMzAzIC0gbGVhcDtcblx0XHR9XG5cdFx0aWYgKG0gPT09IDExKSB7XG5cdFx0XHRyZXR1cm4gZCAtIDMzMyAtIGxlYXA7XG5cdFx0fVxuXHRcdHRocm93IG5ldyAkRXZhbEVycm9yKCdBc3NlcnRpb24gZmFpbGVkOiBNb250aEZyb21UaW1lIHJldHVybmVkIGFuIGltcG9zc2libGUgdmFsdWU6ICcgKyBtKTtcblx0fSxcblxuXHQvLyBodHRwczovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuOS4xLjEyXG5cdE1ha2VEYXk6IGZ1bmN0aW9uIE1ha2VEYXkoeWVhciwgbW9udGgsIGRhdGUpIHtcblx0XHRpZiAoISRpc0Zpbml0ZSh5ZWFyKSB8fCAhJGlzRmluaXRlKG1vbnRoKSB8fCAhJGlzRmluaXRlKGRhdGUpKSB7XG5cdFx0XHRyZXR1cm4gTmFOO1xuXHRcdH1cblx0XHR2YXIgeSA9IHRoaXMuVG9JbnRlZ2VyKHllYXIpO1xuXHRcdHZhciBtID0gdGhpcy5Ub0ludGVnZXIobW9udGgpO1xuXHRcdHZhciBkdCA9IHRoaXMuVG9JbnRlZ2VyKGRhdGUpO1xuXHRcdHZhciB5bSA9IHkgKyAkZmxvb3IobSAvIDEyKTtcblx0XHR2YXIgbW4gPSBtb2QobSwgMTIpO1xuXHRcdHZhciB0ID0gJERhdGVVVEMoeW0sIG1uLCAxKTtcblx0XHRpZiAodGhpcy5ZZWFyRnJvbVRpbWUodCkgIT09IHltIHx8IHRoaXMuTW9udGhGcm9tVGltZSh0KSAhPT0gbW4gfHwgdGhpcy5EYXRlRnJvbVRpbWUodCkgIT09IDEpIHtcblx0XHRcdHJldHVybiBOYU47XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLkRheSh0KSArIGR0IC0gMTtcblx0fSxcblxuXHQvLyBodHRwczovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuOS4xLjEzXG5cdE1ha2VEYXRlOiBmdW5jdGlvbiBNYWtlRGF0ZShkYXksIHRpbWUpIHtcblx0XHRpZiAoISRpc0Zpbml0ZShkYXkpIHx8ICEkaXNGaW5pdGUodGltZSkpIHtcblx0XHRcdHJldHVybiBOYU47XG5cdFx0fVxuXHRcdHJldHVybiAoZGF5ICogbXNQZXJEYXkpICsgdGltZTtcblx0fSxcblxuXHQvLyBodHRwczovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuOS4xLjExXG5cdE1ha2VUaW1lOiBmdW5jdGlvbiBNYWtlVGltZShob3VyLCBtaW4sIHNlYywgbXMpIHtcblx0XHRpZiAoISRpc0Zpbml0ZShob3VyKSB8fCAhJGlzRmluaXRlKG1pbikgfHwgISRpc0Zpbml0ZShzZWMpIHx8ICEkaXNGaW5pdGUobXMpKSB7XG5cdFx0XHRyZXR1cm4gTmFOO1xuXHRcdH1cblx0XHR2YXIgaCA9IHRoaXMuVG9JbnRlZ2VyKGhvdXIpO1xuXHRcdHZhciBtID0gdGhpcy5Ub0ludGVnZXIobWluKTtcblx0XHR2YXIgcyA9IHRoaXMuVG9JbnRlZ2VyKHNlYyk7XG5cdFx0dmFyIG1pbGxpID0gdGhpcy5Ub0ludGVnZXIobXMpO1xuXHRcdHZhciB0ID0gKGggKiBtc1BlckhvdXIpICsgKG0gKiBtc1Blck1pbnV0ZSkgKyAocyAqIG1zUGVyU2Vjb25kKSArIG1pbGxpO1xuXHRcdHJldHVybiB0O1xuXHR9LFxuXG5cdC8vIGh0dHBzOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy0xNS45LjEuMTRcblx0VGltZUNsaXA6IGZ1bmN0aW9uIFRpbWVDbGlwKHRpbWUpIHtcblx0XHRpZiAoISRpc0Zpbml0ZSh0aW1lKSB8fCAkYWJzKHRpbWUpID4gOC42NGUxNSkge1xuXHRcdFx0cmV0dXJuIE5hTjtcblx0XHR9XG5cdFx0cmV0dXJuICROdW1iZXIobmV3ICREYXRlKHRoaXMuVG9OdW1iZXIodGltZSkpKTtcblx0fSxcblxuXHQvLyBodHRwczovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtNS4yXG5cdG1vZHVsbzogZnVuY3Rpb24gbW9kdWxvKHgsIHkpIHtcblx0XHRyZXR1cm4gbW9kKHgsIHkpO1xuXHR9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEVTNTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIEdldEludHJpbnNpYyA9IHJlcXVpcmUoJy4uL0dldEludHJpbnNpYycpO1xuXG52YXIgJFR5cGVFcnJvciA9IEdldEludHJpbnNpYygnJVR5cGVFcnJvciUnKTtcbnZhciAkU3ludGF4RXJyb3IgPSBHZXRJbnRyaW5zaWMoJyVTeW50YXhFcnJvciUnKTtcblxudmFyIGhhcyA9IHJlcXVpcmUoJ2hhcycpO1xuXG52YXIgcHJlZGljYXRlcyA9IHtcblx0Ly8gaHR0cHM6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzYuMC8jc2VjLXByb3BlcnR5LWRlc2NyaXB0b3Itc3BlY2lmaWNhdGlvbi10eXBlXG5cdCdQcm9wZXJ0eSBEZXNjcmlwdG9yJzogZnVuY3Rpb24gaXNQcm9wZXJ0eURlc2NyaXB0b3IoRVMsIERlc2MpIHtcblx0XHRpZiAoRVMuVHlwZShEZXNjKSAhPT0gJ09iamVjdCcpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0dmFyIGFsbG93ZWQgPSB7XG5cdFx0XHQnW1tDb25maWd1cmFibGVdXSc6IHRydWUsXG5cdFx0XHQnW1tFbnVtZXJhYmxlXV0nOiB0cnVlLFxuXHRcdFx0J1tbR2V0XV0nOiB0cnVlLFxuXHRcdFx0J1tbU2V0XV0nOiB0cnVlLFxuXHRcdFx0J1tbVmFsdWVdXSc6IHRydWUsXG5cdFx0XHQnW1tXcml0YWJsZV1dJzogdHJ1ZVxuXHRcdH07XG5cblx0XHRmb3IgKHZhciBrZXkgaW4gRGVzYykgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cdFx0XHRpZiAoaGFzKERlc2MsIGtleSkgJiYgIWFsbG93ZWRba2V5XSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dmFyIGlzRGF0YSA9IGhhcyhEZXNjLCAnW1tWYWx1ZV1dJyk7XG5cdFx0dmFyIElzQWNjZXNzb3IgPSBoYXMoRGVzYywgJ1tbR2V0XV0nKSB8fCBoYXMoRGVzYywgJ1tbU2V0XV0nKTtcblx0XHRpZiAoaXNEYXRhICYmIElzQWNjZXNzb3IpIHtcblx0XHRcdHRocm93IG5ldyAkVHlwZUVycm9yKCdQcm9wZXJ0eSBEZXNjcmlwdG9ycyBtYXkgbm90IGJlIGJvdGggYWNjZXNzb3IgYW5kIGRhdGEgZGVzY3JpcHRvcnMnKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gYXNzZXJ0UmVjb3JkKEVTLCByZWNvcmRUeXBlLCBhcmd1bWVudE5hbWUsIHZhbHVlKSB7XG5cdHZhciBwcmVkaWNhdGUgPSBwcmVkaWNhdGVzW3JlY29yZFR5cGVdO1xuXHRpZiAodHlwZW9mIHByZWRpY2F0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuXHRcdHRocm93IG5ldyAkU3ludGF4RXJyb3IoJ3Vua25vd24gcmVjb3JkIHR5cGU6ICcgKyByZWNvcmRUeXBlKTtcblx0fVxuXHRpZiAoIXByZWRpY2F0ZShFUywgdmFsdWUpKSB7XG5cdFx0dGhyb3cgbmV3ICRUeXBlRXJyb3IoYXJndW1lbnROYW1lICsgJyBtdXN0IGJlIGEgJyArIHJlY29yZFR5cGUpO1xuXHR9XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYmluZCA9IHJlcXVpcmUoJ2Z1bmN0aW9uLWJpbmQnKTtcblxudmFyIEdldEludHJpbnNpYyA9IHJlcXVpcmUoJy4uL0dldEludHJpbnNpYycpO1xuXG52YXIgJEZ1bmN0aW9uID0gR2V0SW50cmluc2ljKCclRnVuY3Rpb24lJyk7XG52YXIgJGFwcGx5ID0gJEZ1bmN0aW9uLmFwcGx5O1xudmFyICRjYWxsID0gJEZ1bmN0aW9uLmNhbGw7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gY2FsbEJpbmQoKSB7XG5cdHJldHVybiBiaW5kLmFwcGx5KCRjYWxsLCBhcmd1bWVudHMpO1xufTtcblxubW9kdWxlLmV4cG9ydHMuYXBwbHkgPSBmdW5jdGlvbiBhcHBseUJpbmQoKSB7XG5cdHJldHVybiBiaW5kLmFwcGx5KCRhcHBseSwgYXJndW1lbnRzKTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBHZXRJbnRyaW5zaWMgPSByZXF1aXJlKCcuLi9HZXRJbnRyaW5zaWMnKTtcblxudmFyIGNhbGxCaW5kID0gcmVxdWlyZSgnLi9jYWxsQmluZCcpO1xuXG52YXIgJGluZGV4T2YgPSBjYWxsQmluZChHZXRJbnRyaW5zaWMoJ1N0cmluZy5wcm90b3R5cGUuaW5kZXhPZicpKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjYWxsQm91bmRJbnRyaW5zaWMobmFtZSwgYWxsb3dNaXNzaW5nKSB7XG5cdHZhciBpbnRyaW5zaWMgPSBHZXRJbnRyaW5zaWMobmFtZSwgISFhbGxvd01pc3NpbmcpO1xuXHRpZiAodHlwZW9mIGludHJpbnNpYyA9PT0gJ2Z1bmN0aW9uJyAmJiAkaW5kZXhPZihuYW1lLCAnLnByb3RvdHlwZS4nKSkge1xuXHRcdHJldHVybiBjYWxsQmluZChpbnRyaW5zaWMpO1xuXHR9XG5cdHJldHVybiBpbnRyaW5zaWM7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgJGlzTmFOID0gTnVtYmVyLmlzTmFOIHx8IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhICE9PSBhOyB9O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE51bWJlci5pc0Zpbml0ZSB8fCBmdW5jdGlvbiAoeCkgeyByZXR1cm4gdHlwZW9mIHggPT09ICdudW1iZXInICYmICEkaXNOYU4oeCkgJiYgeCAhPT0gSW5maW5pdHkgJiYgeCAhPT0gLUluZmluaXR5OyB9O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IE51bWJlci5pc05hTiB8fCBmdW5jdGlvbiBpc05hTihhKSB7XG5cdHJldHVybiBhICE9PSBhO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyICRzdHJTbGljZSA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvY2FsbEJvdW5kJykoJ1N0cmluZy5wcm90b3R5cGUuc2xpY2UnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpc1ByZWZpeE9mKHByZWZpeCwgc3RyaW5nKSB7XG5cdGlmIChwcmVmaXggPT09IHN0cmluZykge1xuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cdGlmIChwcmVmaXgubGVuZ3RoID4gc3RyaW5nLmxlbmd0aCkge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXHRyZXR1cm4gJHN0clNsaWNlKHN0cmluZywgMCwgcHJlZml4Lmxlbmd0aCkgPT09IHByZWZpeDtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBHZXRJbnRyaW5zaWMgPSByZXF1aXJlKCcuLi9HZXRJbnRyaW5zaWMnKTtcblxudmFyIGhhcyA9IHJlcXVpcmUoJ2hhcycpO1xudmFyICRUeXBlRXJyb3IgPSBHZXRJbnRyaW5zaWMoJyVUeXBlRXJyb3IlJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gSXNQcm9wZXJ0eURlc2NyaXB0b3IoRVMsIERlc2MpIHtcblx0aWYgKEVTLlR5cGUoRGVzYykgIT09ICdPYmplY3QnKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cdHZhciBhbGxvd2VkID0ge1xuXHRcdCdbW0NvbmZpZ3VyYWJsZV1dJzogdHJ1ZSxcblx0XHQnW1tFbnVtZXJhYmxlXV0nOiB0cnVlLFxuXHRcdCdbW0dldF1dJzogdHJ1ZSxcblx0XHQnW1tTZXRdXSc6IHRydWUsXG5cdFx0J1tbVmFsdWVdXSc6IHRydWUsXG5cdFx0J1tbV3JpdGFibGVdXSc6IHRydWVcblx0fTtcblxuICAgIGZvciAodmFyIGtleSBpbiBEZXNjKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcblx0XHRpZiAoaGFzKERlc2MsIGtleSkgJiYgIWFsbG93ZWRba2V5XSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdGlmIChFUy5Jc0RhdGFEZXNjcmlwdG9yKERlc2MpICYmIEVTLklzQWNjZXNzb3JEZXNjcmlwdG9yKERlc2MpKSB7XG5cdFx0dGhyb3cgbmV3ICRUeXBlRXJyb3IoJ1Byb3BlcnR5IERlc2NyaXB0b3JzIG1heSBub3QgYmUgYm90aCBhY2Nlc3NvciBhbmQgZGF0YSBkZXNjcmlwdG9ycycpO1xuXHR9XG5cdHJldHVybiB0cnVlO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBtb2QobnVtYmVyLCBtb2R1bG8pIHtcblx0dmFyIHJlbWFpbiA9IG51bWJlciAlIG1vZHVsbztcblx0cmV0dXJuIE1hdGguZmxvb3IocmVtYWluID49IDAgPyByZW1haW4gOiByZW1haW4gKyBtb2R1bG8pO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzaWduKG51bWJlcikge1xuXHRyZXR1cm4gbnVtYmVyID49IDAgPyAxIDogLTE7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG52YXIgaXNQcmltaXRpdmUgPSByZXF1aXJlKCcuL2hlbHBlcnMvaXNQcmltaXRpdmUnKTtcblxudmFyIGlzQ2FsbGFibGUgPSByZXF1aXJlKCdpcy1jYWxsYWJsZScpO1xuXG4vLyBodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy04LjEyLjhcbnZhciBFUzVpbnRlcm5hbFNsb3RzID0ge1xuXHQnW1tEZWZhdWx0VmFsdWVdXSc6IGZ1bmN0aW9uIChPKSB7XG5cdFx0dmFyIGFjdHVhbEhpbnQ7XG5cdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG5cdFx0XHRhY3R1YWxIaW50ID0gYXJndW1lbnRzWzFdO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRhY3R1YWxIaW50ID0gdG9TdHIuY2FsbChPKSA9PT0gJ1tvYmplY3QgRGF0ZV0nID8gU3RyaW5nIDogTnVtYmVyO1xuXHRcdH1cblxuXHRcdGlmIChhY3R1YWxIaW50ID09PSBTdHJpbmcgfHwgYWN0dWFsSGludCA9PT0gTnVtYmVyKSB7XG5cdFx0XHR2YXIgbWV0aG9kcyA9IGFjdHVhbEhpbnQgPT09IFN0cmluZyA/IFsndG9TdHJpbmcnLCAndmFsdWVPZiddIDogWyd2YWx1ZU9mJywgJ3RvU3RyaW5nJ107XG5cdFx0XHR2YXIgdmFsdWUsIGk7XG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgbWV0aG9kcy5sZW5ndGg7ICsraSkge1xuXHRcdFx0XHRpZiAoaXNDYWxsYWJsZShPW21ldGhvZHNbaV1dKSkge1xuXHRcdFx0XHRcdHZhbHVlID0gT1ttZXRob2RzW2ldXSgpO1xuXHRcdFx0XHRcdGlmIChpc1ByaW1pdGl2ZSh2YWx1ZSkpIHtcblx0XHRcdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ05vIGRlZmF1bHQgdmFsdWUnKTtcblx0XHR9XG5cdFx0dGhyb3cgbmV3IFR5cGVFcnJvcignaW52YWxpZCBbW0RlZmF1bHRWYWx1ZV1dIGhpbnQgc3VwcGxpZWQnKTtcblx0fVxufTtcblxuLy8gaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtOS4xXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIFRvUHJpbWl0aXZlKGlucHV0KSB7XG5cdGlmIChpc1ByaW1pdGl2ZShpbnB1dCkpIHtcblx0XHRyZXR1cm4gaW5wdXQ7XG5cdH1cblx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG5cdFx0cmV0dXJuIEVTNWludGVybmFsU2xvdHNbJ1tbRGVmYXVsdFZhbHVlXV0nXShpbnB1dCwgYXJndW1lbnRzWzFdKTtcblx0fVxuXHRyZXR1cm4gRVM1aW50ZXJuYWxTbG90c1snW1tEZWZhdWx0VmFsdWVdXSddKGlucHV0KTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGlzUHJpbWl0aXZlKHZhbHVlKSB7XG5cdHJldHVybiB2YWx1ZSA9PT0gbnVsbCB8fCAodHlwZW9mIHZhbHVlICE9PSAnZnVuY3Rpb24nICYmIHR5cGVvZiB2YWx1ZSAhPT0gJ29iamVjdCcpO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGlzQ2FsbGFibGUgPSByZXF1aXJlKCdpcy1jYWxsYWJsZScpO1xuXG52YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xudmFyIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcblxudmFyIGZvckVhY2hBcnJheSA9IGZ1bmN0aW9uIGZvckVhY2hBcnJheShhcnJheSwgaXRlcmF0b3IsIHJlY2VpdmVyKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFycmF5Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGFycmF5LCBpKSkge1xuICAgICAgICAgICAgaWYgKHJlY2VpdmVyID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpdGVyYXRvcihhcnJheVtpXSwgaSwgYXJyYXkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpdGVyYXRvci5jYWxsKHJlY2VpdmVyLCBhcnJheVtpXSwgaSwgYXJyYXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcblxudmFyIGZvckVhY2hTdHJpbmcgPSBmdW5jdGlvbiBmb3JFYWNoU3RyaW5nKHN0cmluZywgaXRlcmF0b3IsIHJlY2VpdmVyKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHN0cmluZy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAvLyBubyBzdWNoIHRoaW5nIGFzIGEgc3BhcnNlIHN0cmluZy5cbiAgICAgICAgaWYgKHJlY2VpdmVyID09IG51bGwpIHtcbiAgICAgICAgICAgIGl0ZXJhdG9yKHN0cmluZy5jaGFyQXQoaSksIGksIHN0cmluZyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpdGVyYXRvci5jYWxsKHJlY2VpdmVyLCBzdHJpbmcuY2hhckF0KGkpLCBpLCBzdHJpbmcpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxudmFyIGZvckVhY2hPYmplY3QgPSBmdW5jdGlvbiBmb3JFYWNoT2JqZWN0KG9iamVjdCwgaXRlcmF0b3IsIHJlY2VpdmVyKSB7XG4gICAgZm9yICh2YXIgayBpbiBvYmplY3QpIHtcbiAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBrKSkge1xuICAgICAgICAgICAgaWYgKHJlY2VpdmVyID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpdGVyYXRvcihvYmplY3Rba10sIGssIG9iamVjdCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGl0ZXJhdG9yLmNhbGwocmVjZWl2ZXIsIG9iamVjdFtrXSwgaywgb2JqZWN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn07XG5cbnZhciBmb3JFYWNoID0gZnVuY3Rpb24gZm9yRWFjaChsaXN0LCBpdGVyYXRvciwgdGhpc0FyZykge1xuICAgIGlmICghaXNDYWxsYWJsZShpdGVyYXRvcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignaXRlcmF0b3IgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgfVxuXG4gICAgdmFyIHJlY2VpdmVyO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDMpIHtcbiAgICAgICAgcmVjZWl2ZXIgPSB0aGlzQXJnO1xuICAgIH1cblxuICAgIGlmICh0b1N0ci5jYWxsKGxpc3QpID09PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICAgIGZvckVhY2hBcnJheShsaXN0LCBpdGVyYXRvciwgcmVjZWl2ZXIpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGxpc3QgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGZvckVhY2hTdHJpbmcobGlzdCwgaXRlcmF0b3IsIHJlY2VpdmVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBmb3JFYWNoT2JqZWN0KGxpc3QsIGl0ZXJhdG9yLCByZWNlaXZlcik7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmb3JFYWNoO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKiBlc2xpbnQgbm8taW52YWxpZC10aGlzOiAxICovXG5cbnZhciBFUlJPUl9NRVNTQUdFID0gJ0Z1bmN0aW9uLnByb3RvdHlwZS5iaW5kIGNhbGxlZCBvbiBpbmNvbXBhdGlibGUgJztcbnZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcbnZhciB0b1N0ciA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG52YXIgZnVuY1R5cGUgPSAnW29iamVjdCBGdW5jdGlvbl0nO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGJpbmQodGhhdCkge1xuICAgIHZhciB0YXJnZXQgPSB0aGlzO1xuICAgIGlmICh0eXBlb2YgdGFyZ2V0ICE9PSAnZnVuY3Rpb24nIHx8IHRvU3RyLmNhbGwodGFyZ2V0KSAhPT0gZnVuY1R5cGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihFUlJPUl9NRVNTQUdFICsgdGFyZ2V0KTtcbiAgICB9XG4gICAgdmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG5cbiAgICB2YXIgYm91bmQ7XG4gICAgdmFyIGJpbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMgaW5zdGFuY2VvZiBib3VuZCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRhcmdldC5hcHBseShcbiAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgIGFyZ3MuY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoT2JqZWN0KHJlc3VsdCkgPT09IHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQuYXBwbHkoXG4gICAgICAgICAgICAgICAgdGhhdCxcbiAgICAgICAgICAgICAgICBhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHZhciBib3VuZExlbmd0aCA9IE1hdGgubWF4KDAsIHRhcmdldC5sZW5ndGggLSBhcmdzLmxlbmd0aCk7XG4gICAgdmFyIGJvdW5kQXJncyA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYm91bmRMZW5ndGg7IGkrKykge1xuICAgICAgICBib3VuZEFyZ3MucHVzaCgnJCcgKyBpKTtcbiAgICB9XG5cbiAgICBib3VuZCA9IEZ1bmN0aW9uKCdiaW5kZXInLCAncmV0dXJuIGZ1bmN0aW9uICgnICsgYm91bmRBcmdzLmpvaW4oJywnKSArICcpeyByZXR1cm4gYmluZGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTsgfScpKGJpbmRlcik7XG5cbiAgICBpZiAodGFyZ2V0LnByb3RvdHlwZSkge1xuICAgICAgICB2YXIgRW1wdHkgPSBmdW5jdGlvbiBFbXB0eSgpIHt9O1xuICAgICAgICBFbXB0eS5wcm90b3R5cGUgPSB0YXJnZXQucHJvdG90eXBlO1xuICAgICAgICBib3VuZC5wcm90b3R5cGUgPSBuZXcgRW1wdHkoKTtcbiAgICAgICAgRW1wdHkucHJvdG90eXBlID0gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gYm91bmQ7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgaW1wbGVtZW50YXRpb24gPSByZXF1aXJlKCcuL2ltcGxlbWVudGF0aW9uJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgfHwgaW1wbGVtZW50YXRpb247XG4iLCJ2YXIgd2luO1xuXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHdpbiA9IHdpbmRvdztcbn0gZWxzZSBpZiAodHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHdpbiA9IGdsb2JhbDtcbn0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIpe1xuICAgIHdpbiA9IHNlbGY7XG59IGVsc2Uge1xuICAgIHdpbiA9IHt9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHdpbjtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIG9yaWdTeW1ib2wgPSBnbG9iYWwuU3ltYm9sO1xudmFyIGhhc1N5bWJvbFNoYW0gPSByZXF1aXJlKCcuL3NoYW1zJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaGFzTmF0aXZlU3ltYm9scygpIHtcblx0aWYgKHR5cGVvZiBvcmlnU3ltYm9sICE9PSAnZnVuY3Rpb24nKSB7IHJldHVybiBmYWxzZTsgfVxuXHRpZiAodHlwZW9mIFN5bWJvbCAhPT0gJ2Z1bmN0aW9uJykgeyByZXR1cm4gZmFsc2U7IH1cblx0aWYgKHR5cGVvZiBvcmlnU3ltYm9sKCdmb28nKSAhPT0gJ3N5bWJvbCcpIHsgcmV0dXJuIGZhbHNlOyB9XG5cdGlmICh0eXBlb2YgU3ltYm9sKCdiYXInKSAhPT0gJ3N5bWJvbCcpIHsgcmV0dXJuIGZhbHNlOyB9XG5cblx0cmV0dXJuIGhhc1N5bWJvbFNoYW0oKTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbi8qIGVzbGludCBjb21wbGV4aXR5OiBbMiwgMTddLCBtYXgtc3RhdGVtZW50czogWzIsIDMzXSAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBoYXNTeW1ib2xzKCkge1xuXHRpZiAodHlwZW9mIFN5bWJvbCAhPT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyAhPT0gJ2Z1bmN0aW9uJykgeyByZXR1cm4gZmFsc2U7IH1cblx0aWYgKHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICdzeW1ib2wnKSB7IHJldHVybiB0cnVlOyB9XG5cblx0dmFyIG9iaiA9IHt9O1xuXHR2YXIgc3ltID0gU3ltYm9sKCd0ZXN0Jyk7XG5cdHZhciBzeW1PYmogPSBPYmplY3Qoc3ltKTtcblx0aWYgKHR5cGVvZiBzeW0gPT09ICdzdHJpbmcnKSB7IHJldHVybiBmYWxzZTsgfVxuXG5cdGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoc3ltKSAhPT0gJ1tvYmplY3QgU3ltYm9sXScpIHsgcmV0dXJuIGZhbHNlOyB9XG5cdGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoc3ltT2JqKSAhPT0gJ1tvYmplY3QgU3ltYm9sXScpIHsgcmV0dXJuIGZhbHNlOyB9XG5cblx0Ly8gdGVtcCBkaXNhYmxlZCBwZXIgaHR0cHM6Ly9naXRodWIuY29tL2xqaGFyYi9vYmplY3QuYXNzaWduL2lzc3Vlcy8xN1xuXHQvLyBpZiAoc3ltIGluc3RhbmNlb2YgU3ltYm9sKSB7IHJldHVybiBmYWxzZTsgfVxuXHQvLyB0ZW1wIGRpc2FibGVkIHBlciBodHRwczovL2dpdGh1Yi5jb20vV2ViUmVmbGVjdGlvbi9nZXQtb3duLXByb3BlcnR5LXN5bWJvbHMvaXNzdWVzLzRcblx0Ly8gaWYgKCEoc3ltT2JqIGluc3RhbmNlb2YgU3ltYm9sKSkgeyByZXR1cm4gZmFsc2U7IH1cblxuXHQvLyBpZiAodHlwZW9mIFN5bWJvbC5wcm90b3R5cGUudG9TdHJpbmcgIT09ICdmdW5jdGlvbicpIHsgcmV0dXJuIGZhbHNlOyB9XG5cdC8vIGlmIChTdHJpbmcoc3ltKSAhPT0gU3ltYm9sLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHN5bSkpIHsgcmV0dXJuIGZhbHNlOyB9XG5cblx0dmFyIHN5bVZhbCA9IDQyO1xuXHRvYmpbc3ltXSA9IHN5bVZhbDtcblx0Zm9yIChzeW0gaW4gb2JqKSB7IHJldHVybiBmYWxzZTsgfSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXJlc3RyaWN0ZWQtc3ludGF4XG5cdGlmICh0eXBlb2YgT2JqZWN0LmtleXMgPT09ICdmdW5jdGlvbicgJiYgT2JqZWN0LmtleXMob2JqKS5sZW5ndGggIT09IDApIHsgcmV0dXJuIGZhbHNlOyB9XG5cblx0aWYgKHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyA9PT0gJ2Z1bmN0aW9uJyAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmopLmxlbmd0aCAhPT0gMCkgeyByZXR1cm4gZmFsc2U7IH1cblxuXHR2YXIgc3ltcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqKTtcblx0aWYgKHN5bXMubGVuZ3RoICE9PSAxIHx8IHN5bXNbMF0gIT09IHN5bSkgeyByZXR1cm4gZmFsc2U7IH1cblxuXHRpZiAoIU9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChvYmosIHN5bSkpIHsgcmV0dXJuIGZhbHNlOyB9XG5cblx0aWYgKHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0dmFyIGRlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwgc3ltKTtcblx0XHRpZiAoZGVzY3JpcHRvci52YWx1ZSAhPT0gc3ltVmFsIHx8IGRlc2NyaXB0b3IuZW51bWVyYWJsZSAhPT0gdHJ1ZSkgeyByZXR1cm4gZmFsc2U7IH1cblx0fVxuXG5cdHJldHVybiB0cnVlO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGJpbmQgPSByZXF1aXJlKCdmdW5jdGlvbi1iaW5kJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gYmluZC5jYWxsKEZ1bmN0aW9uLmNhbGwsIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkpO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZm5Ub1N0ciA9IEZ1bmN0aW9uLnByb3RvdHlwZS50b1N0cmluZztcblxudmFyIGNvbnN0cnVjdG9yUmVnZXggPSAvXlxccypjbGFzc1xcYi87XG52YXIgaXNFUzZDbGFzc0ZuID0gZnVuY3Rpb24gaXNFUzZDbGFzc0Z1bmN0aW9uKHZhbHVlKSB7XG5cdHRyeSB7XG5cdFx0dmFyIGZuU3RyID0gZm5Ub1N0ci5jYWxsKHZhbHVlKTtcblx0XHRyZXR1cm4gY29uc3RydWN0b3JSZWdleC50ZXN0KGZuU3RyKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdHJldHVybiBmYWxzZTsgLy8gbm90IGEgZnVuY3Rpb25cblx0fVxufTtcblxudmFyIHRyeUZ1bmN0aW9uT2JqZWN0ID0gZnVuY3Rpb24gdHJ5RnVuY3Rpb25Ub1N0cih2YWx1ZSkge1xuXHR0cnkge1xuXHRcdGlmIChpc0VTNkNsYXNzRm4odmFsdWUpKSB7IHJldHVybiBmYWxzZTsgfVxuXHRcdGZuVG9TdHIuY2FsbCh2YWx1ZSk7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn07XG52YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xudmFyIGZuQ2xhc3MgPSAnW29iamVjdCBGdW5jdGlvbl0nO1xudmFyIGdlbkNsYXNzID0gJ1tvYmplY3QgR2VuZXJhdG9yRnVuY3Rpb25dJztcbnZhciBoYXNUb1N0cmluZ1RhZyA9IHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIFN5bWJvbC50b1N0cmluZ1RhZyA9PT0gJ3N5bWJvbCc7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaXNDYWxsYWJsZSh2YWx1ZSkge1xuXHRpZiAoIXZhbHVlKSB7IHJldHVybiBmYWxzZTsgfVxuXHRpZiAodHlwZW9mIHZhbHVlICE9PSAnZnVuY3Rpb24nICYmIHR5cGVvZiB2YWx1ZSAhPT0gJ29iamVjdCcpIHsgcmV0dXJuIGZhbHNlOyB9XG5cdGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicgJiYgIXZhbHVlLnByb3RvdHlwZSkgeyByZXR1cm4gdHJ1ZTsgfVxuXHRpZiAoaGFzVG9TdHJpbmdUYWcpIHsgcmV0dXJuIHRyeUZ1bmN0aW9uT2JqZWN0KHZhbHVlKTsgfVxuXHRpZiAoaXNFUzZDbGFzc0ZuKHZhbHVlKSkgeyByZXR1cm4gZmFsc2U7IH1cblx0dmFyIHN0ckNsYXNzID0gdG9TdHIuY2FsbCh2YWx1ZSk7XG5cdHJldHVybiBzdHJDbGFzcyA9PT0gZm5DbGFzcyB8fCBzdHJDbGFzcyA9PT0gZ2VuQ2xhc3M7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBpc0Z1bmN0aW9uXG5cbnZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmdcblxuZnVuY3Rpb24gaXNGdW5jdGlvbiAoZm4pIHtcbiAgdmFyIHN0cmluZyA9IHRvU3RyaW5nLmNhbGwoZm4pXG4gIHJldHVybiBzdHJpbmcgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXScgfHxcbiAgICAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nICYmIHN0cmluZyAhPT0gJ1tvYmplY3QgUmVnRXhwXScpIHx8XG4gICAgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgIC8vIElFOCBhbmQgYmVsb3dcbiAgICAgKGZuID09PSB3aW5kb3cuc2V0VGltZW91dCB8fFxuICAgICAgZm4gPT09IHdpbmRvdy5hbGVydCB8fFxuICAgICAgZm4gPT09IHdpbmRvdy5jb25maXJtIHx8XG4gICAgICBmbiA9PT0gd2luZG93LnByb21wdCkpXG59O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5jb25zdCBob3QgPSByZXF1aXJlKFwiLi4vaG90XCIpO1xuY29uc3QgZmlsZV9zeXN0ZW1fMSA9IHJlcXVpcmUoXCJ0bnMtY29yZS1tb2R1bGVzL2ZpbGUtc3lzdGVtXCIpO1xuZnVuY3Rpb24gaG1yVXBkYXRlKCkge1xuICAgIGNvbnN0IGN1cnJlbnRBcHBGb2xkZXIgPSBmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCk7XG4gICAgY29uc3QgbGF0ZXN0SGFzaCA9IF9fd2VicGFja19yZXF1aXJlX19bXCJoXCJdKCk7XG4gICAgcmV0dXJuIGhvdChsYXRlc3RIYXNoLCBmaWxlbmFtZSA9PiB7XG4gICAgICAgIGNvbnN0IGZ1bGxGaWxlUGF0aCA9IGZpbGVfc3lzdGVtXzEucGF0aC5qb2luKGN1cnJlbnRBcHBGb2xkZXIucGF0aCwgZmlsZW5hbWUpO1xuICAgICAgICByZXR1cm4gZmlsZV9zeXN0ZW1fMS5GaWxlLmV4aXN0cyhmdWxsRmlsZVBhdGgpID8gY3VycmVudEFwcEZvbGRlci5nZXRGaWxlKGZpbGVuYW1lKSA6IG51bGw7XG4gICAgfSk7XG59XG5leHBvcnRzLmhtclVwZGF0ZSA9IGhtclVwZGF0ZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWhtci11cGRhdGUuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaG1yX3VwZGF0ZV8xID0gcmVxdWlyZShcIi4vaG1yLXVwZGF0ZVwiKTtcbmV4cG9ydHMuaG1yVXBkYXRlID0gaG1yX3VwZGF0ZV8xLmhtclVwZGF0ZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsImNvbnN0IGhtclByZWZpeCA9ICdITVI6JztcbmNvbnN0IGxvZyA9IHtcbiAgICBpbmZvOiAobWVzc2FnZSkgPT4gY29uc29sZS5pbmZvKGAke2htclByZWZpeH0gJHttZXNzYWdlfWApLFxuICAgIHdhcm46IChtZXNzYWdlKSA9PiBjb25zb2xlLndhcm4oYCR7aG1yUHJlZml4fSAke21lc3NhZ2V9YCksXG4gICAgZXJyb3I6IChtZXNzYWdlKSA9PiBjb25zb2xlLmVycm9yKGAke2htclByZWZpeH0gJHttZXNzYWdlfWApLFxufTtcbmNvbnN0IHJlZnJlc2ggPSAnQXBwbGljYXRpb24gbmVlZHMgdG8gYmUgcmVzdGFydGVkIGluIG9yZGVyIHRvIGFwcGx5IHRoZSBjaGFuZ2VzLic7XG5jb25zdCBob3RPcHRpb25zID0ge1xuICAgIGlnbm9yZVVuYWNjZXB0ZWQ6IGZhbHNlLFxuICAgIGlnbm9yZURlY2xpbmVkOiBmYWxzZSxcbiAgICBpZ25vcmVFcnJvcmVkOiBmYWxzZSxcbiAgICBvblVuYWNjZXB0ZWQoZGF0YSkge1xuICAgICAgICBjb25zdCBjaGFpbiA9IFtdLmNvbmNhdChkYXRhLmNoYWluKTtcbiAgICAgICAgY29uc3QgbGFzdCA9IGNoYWluW2NoYWluLmxlbmd0aCAtIDFdO1xuXG4gICAgICAgIGlmIChsYXN0ID09PSAwKSB7XG4gICAgICAgICAgICBjaGFpbi5wb3AoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxvZy53YXJuKGBJZ25vcmVkIGFuIHVwZGF0ZSB0byB1bmFjY2VwdGVkIG1vZHVsZTogYCk7XG4gICAgICAgIGNoYWluLmZvckVhY2gobW9kID0+IGxvZy53YXJuKGAgICAgICAgICDinq0gJHttb2R9YCkpO1xuICAgIH0sXG4gICAgb25EZWNsaW5lZChkYXRhKSB7XG4gICAgICAgIGxvZy53YXJuKGBJZ25vcmVkIGFuIHVwZGF0ZSB0byBkZWNsaW5lZCBtb2R1bGU6YCk7XG4gICAgICAgIGRhdGEuY2hhaW4uZm9yRWFjaChtb2QgPT4gbG9nLndhcm4oYCAgICAgICAgIOKerSAke21vZH1gKSk7XG4gICAgfSxcbiAgICBvbkVycm9yZWQoZGF0YSkge1xuICAgICAgICBsb2cud2FybihcbiAgICAgICAgICAgIGBJZ25vcmVkIGFuIGVycm9yIHdoaWxlIHVwZGF0aW5nIG1vZHVsZSAke2RhdGEubW9kdWxlSWR9IDwke2RhdGEudHlwZX0+YFxuICAgICAgICApO1xuICAgICAgICBsb2cud2FybihkYXRhLmVycm9yKTtcbiAgICB9LFxufTtcblxubGV0IG5leHRIYXNoO1xubGV0IGN1cnJlbnRIYXNoO1xuXG5mdW5jdGlvbiB1cFRvRGF0ZSgpIHtcbiAgICByZXR1cm4gbmV4dEhhc2guaW5kZXhPZihfX3dlYnBhY2tfaGFzaF9fKSA+PSAwO1xufVxuXG5mdW5jdGlvbiByZXN1bHQobW9kdWxlcywgYXBwbGllZE1vZHVsZXMpIHtcbiAgICBjb25zdCB1bmFjY2VwdGVkID0gbW9kdWxlcy5maWx0ZXIoXG4gICAgICAgIChtb2R1bGVJZCkgPT4gYXBwbGllZE1vZHVsZXMgJiYgYXBwbGllZE1vZHVsZXMuaW5kZXhPZihtb2R1bGVJZCkgPCAwXG4gICAgKTtcblxuICAgIGlmICh1bmFjY2VwdGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbG9nLndhcm4oJ1RoZSBmb2xsb3dpbmcgbW9kdWxlcyBjb3VsZCBub3QgYmUgdXBkYXRlZDonKTtcblxuICAgICAgICBmb3IgKGNvbnN0IG1vZHVsZUlkIG9mIHVuYWNjZXB0ZWQpIHtcbiAgICAgICAgICAgIGxvZy53YXJuKGAgICAgICAgICAg4qa7ICR7bW9kdWxlSWR9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIShhcHBsaWVkTW9kdWxlcyB8fCBbXSkubGVuZ3RoKSB7XG4gICAgICAgIGxvZy5pbmZvKCdObyBNb2R1bGVzIFVwZGF0ZWQuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLmluZm8oJ1RoZSBmb2xsb3dpbmcgbW9kdWxlcyB3ZXJlIHVwZGF0ZWQ6Jyk7XG5cbiAgICAgICAgZm9yIChjb25zdCBtb2R1bGVJZCBvZiBhcHBsaWVkTW9kdWxlcykge1xuICAgICAgICAgICAgbG9nLmluZm8oYCAgICAgICAgIOKGuyAke21vZHVsZUlkfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbnVtYmVySWRzID0gYXBwbGllZE1vZHVsZXMuZXZlcnkoXG4gICAgICAgICAgICAobW9kdWxlSWQpID0+IHR5cGVvZiBtb2R1bGVJZCA9PT0gJ251bWJlcidcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKG51bWJlcklkcykge1xuICAgICAgICAgICAgbG9nLmluZm8oXG4gICAgICAgICAgICAgICAgJ1BsZWFzZSBjb25zaWRlciB1c2luZyB0aGUgTmFtZWRNb2R1bGVzUGx1Z2luIGZvciBtb2R1bGUgbmFtZXMuJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gY2hlY2sob3B0aW9ucykge1xuICAgIHJldHVybiBtb2R1bGUuaG90XG4gICAgICAgIC5jaGVjaygpXG4gICAgICAgIC50aGVuKChtb2R1bGVzKSA9PiB7XG4gICAgICAgICAgICBpZiAoIW1vZHVsZXMpIHtcbiAgICAgICAgICAgICAgICBsb2cud2FybihcbiAgICAgICAgICAgICAgICAgICAgYENhbm5vdCBmaW5kIHVwZGF0ZS4gJHtyZWZyZXNofWBcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbW9kdWxlLmhvdFxuICAgICAgICAgICAgICAgIC5hcHBseShob3RPcHRpb25zKVxuICAgICAgICAgICAgICAgIC50aGVuKChhcHBsaWVkTW9kdWxlcykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dENoZWNrO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXVwVG9EYXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRDaGVjayA9IGNoZWNrKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0KG1vZHVsZXMsIGFwcGxpZWRNb2R1bGVzKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodXBUb0RhdGUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG8gbm90IG1vZGlmeSBtZXNzYWdlIC0gQ0xJIGRlcGVuZHMgb24gdGhpcyBleGFjdCBjb250ZW50IHRvIGRldGVybWluZSBobXIgb3BlcmF0aW9uIHN0YXR1cy5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy5pbmZvKGBTdWNjZXNzZnVsbHkgYXBwbGllZCB1cGRhdGUgd2l0aCBobXIgaGFzaCAke2N1cnJlbnRIYXNofS4gQXBwIGlzIHVwIHRvIGRhdGUuYCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dENoZWNrIHx8IG51bGw7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0dXMgPSBtb2R1bGUuaG90LnN0YXR1cygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoWydhYm9ydCcsICdmYWlsJ10uaW5kZXhPZihzdGF0dXMpID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERvIG5vdCBtb2RpZnkgbWVzc2FnZSAtIENMSSBkZXBlbmRzIG9uIHRoaXMgZXhhY3QgY29udGVudCB0byBkZXRlcm1pbmUgaG1yIG9wZXJhdGlvbiBzdGF0dXMuXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2cuZXJyb3IoYENhbm5vdCBhcHBseSB1cGRhdGUgd2l0aCBobXIgaGFzaCAke2N1cnJlbnRIYXNofS5gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy5lcnJvcihlcnIubWVzc2FnZSB8fCBlcnIuc3RhY2spO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nLmVycm9yKGBVcGRhdGUgZmFpbGVkOiAke2Vyci5tZXNzYWdlIHx8IGVyci5zdGFja31gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3RhdHVzID0gbW9kdWxlLmhvdC5zdGF0dXMoKTtcbiAgICAgICAgICAgIGlmIChbJ2Fib3J0JywgJ2ZhaWwnXS5pbmRleE9mKHN0YXR1cykgPj0gMCkge1xuICAgICAgICAgICAgICAgIGxvZy5lcnJvcihgQ2Fubm90IGNoZWNrIGZvciB1cGRhdGUuICR7cmVmcmVzaH1gKTtcbiAgICAgICAgICAgICAgICBsb2cuZXJyb3IoZXJyLm1lc3NhZ2UgfHwgZXJyLnN0YWNrKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbG9nLmVycm9yKGBVcGRhdGUgY2hlY2sgZmFpbGVkOiAke2Vyci5tZXNzYWdlIHx8IGVyci5zdGFja31gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG59XG5cbmlmIChtb2R1bGUuaG90KSB7XG4gICAgbG9nLmluZm8oJ0hvdCBNb2R1bGUgUmVwbGFjZW1lbnQgRW5hYmxlZC4gV2FpdGluZyBmb3Igc2lnbmFsLicpO1xufSBlbHNlIHtcbiAgICBsb2cuZXJyb3IoJ0hvdCBNb2R1bGUgUmVwbGFjZW1lbnQgaXMgZGlzYWJsZWQuJyk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZShsYXRlc3RIYXNoLCBvcHRpb25zKSB7XG4gICAgbmV4dEhhc2ggPSBsYXRlc3RIYXNoO1xuICAgIGlmICghdXBUb0RhdGUoKSkge1xuICAgICAgICBjb25zdCBzdGF0dXMgPSBtb2R1bGUuaG90LnN0YXR1cygpO1xuXG4gICAgICAgIGlmIChzdGF0dXMgPT09ICdpZGxlJykge1xuICAgICAgICAgICAgLy9EbyBub3QgbW9kaWZ5IG1lc3NhZ2UgLSBDTEkgZGVwZW5kcyBvbiB0aGlzIGV4YWN0IGNvbnRlbnQgdG8gZGV0ZXJtaW5lIGhtciBvcGVyYXRpb24gc3RhdHVzLlxuICAgICAgICAgICAgbG9nLmluZm8oYENoZWNraW5nIGZvciB1cGRhdGVzIHRvIHRoZSBidW5kbGUgd2l0aCBobXIgaGFzaCAke2N1cnJlbnRIYXNofS5gKTtcbiAgICAgICAgICAgIHJldHVybiBjaGVjayhvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIGlmIChbJ2Fib3J0JywgJ2ZhaWwnXS5pbmRleE9mKHN0YXR1cykgPj0gMCkge1xuICAgICAgICAgICAgbG9nLndhcm4oXG4gICAgICAgICAgICAgICAgYENhbm5vdCBhcHBseSB1cGRhdGUuIEEgcHJldmlvdXMgdXBkYXRlICR7c3RhdHVzfWVkLiAke3JlZnJlc2h9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmZ1bmN0aW9uIGdldE5leHRIYXNoKGhhc2gsIGdldEZpbGVDb250ZW50KSB7XG4gICAgY29uc3QgZmlsZSA9IGdldEZpbGVDb250ZW50KGAke2hhc2h9LmhvdC11cGRhdGUuanNvbmApO1xuICAgIGlmICghZmlsZSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGhhc2gpO1xuICAgIH1cblxuICAgIHJldHVybiBmaWxlLnJlYWRUZXh0KCkudGhlbihob3RVcGRhdGVDb250ZW50ID0+IHtcbiAgICAgICAgaWYgKGhvdFVwZGF0ZUNvbnRlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hbmlmZXN0ID0gSlNPTi5wYXJzZShob3RVcGRhdGVDb250ZW50KTtcbiAgICAgICAgICAgIGNvbnN0IG5ld0hhc2ggPSBtYW5pZmVzdC5oO1xuICAgICAgICAgICAgcmV0dXJuIGdldE5leHRIYXNoKG5ld0hhc2gsIGdldEZpbGVDb250ZW50KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoaGFzaCk7XG4gICAgICAgIH1cbiAgICB9KS5jYXRjaChlcnJvciA9PiBQcm9taXNlLnJlamVjdChlcnJvcikpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNoZWNrU3RhdGUoaW5pdGlhbEhhc2gsIGdldEZpbGVDb250ZW50KSB7XG4gICAgY3VycmVudEhhc2ggPSBpbml0aWFsSGFzaDtcbiAgICByZXR1cm4gZ2V0TmV4dEhhc2goaW5pdGlhbEhhc2gsIGdldEZpbGVDb250ZW50KS50aGVuKG5leHRIYXNoID0+IHtcbiAgICAgICAgaWYgKG5leHRIYXNoICE9IGluaXRpYWxIYXNoKSB7XG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlKG5leHRIYXNoLCB7fSk7XG4gICAgICAgIH1cbiAgICB9KVxufVxuIiwiY29uc3QgbG9hZENzcyA9IHJlcXVpcmUoXCIuL2xvYWQtYXBwbGljYXRpb24tY3NzXCIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICAgIGxvYWRDc3MoZnVuY3Rpb24oKSB7XG4gICAgICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcIi4vYXBwLmNzc1wiLCAoKSA9PiByZXF1aXJlKFwifi9hcHBcIikpO1xuICAgICAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJhcHAuY3NzXCIsICgpID0+IHJlcXVpcmUoXCJ+L2FwcFwiKSk7XG4gICAgfSk7XG59XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChsb2FkTW9kdWxlRm4pIHtcbiAgICBjb25zdCBhcHBsaWNhdGlvbiA9IHJlcXVpcmUoXCJ0bnMtY29yZS1tb2R1bGVzL2FwcGxpY2F0aW9uXCIpO1xuICAgIHJlcXVpcmUoXCJ0bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvc3R5bGUtc2NvcGVcIik7XG5cbiAgICBsb2FkTW9kdWxlRm4oKTtcblxuICAgIGFwcGxpY2F0aW9uLmxvYWRBcHBDc3MoKTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGtleXNTaGltO1xuaWYgKCFPYmplY3Qua2V5cykge1xuXHQvLyBtb2RpZmllZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9lcy1zaGltcy9lczUtc2hpbVxuXHR2YXIgaGFzID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcblx0dmFyIHRvU3RyID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblx0dmFyIGlzQXJncyA9IHJlcXVpcmUoJy4vaXNBcmd1bWVudHMnKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBnbG9iYWwtcmVxdWlyZVxuXHR2YXIgaXNFbnVtZXJhYmxlID0gT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcblx0dmFyIGhhc0RvbnRFbnVtQnVnID0gIWlzRW51bWVyYWJsZS5jYWxsKHsgdG9TdHJpbmc6IG51bGwgfSwgJ3RvU3RyaW5nJyk7XG5cdHZhciBoYXNQcm90b0VudW1CdWcgPSBpc0VudW1lcmFibGUuY2FsbChmdW5jdGlvbiAoKSB7fSwgJ3Byb3RvdHlwZScpO1xuXHR2YXIgZG9udEVudW1zID0gW1xuXHRcdCd0b1N0cmluZycsXG5cdFx0J3RvTG9jYWxlU3RyaW5nJyxcblx0XHQndmFsdWVPZicsXG5cdFx0J2hhc093blByb3BlcnR5Jyxcblx0XHQnaXNQcm90b3R5cGVPZicsXG5cdFx0J3Byb3BlcnR5SXNFbnVtZXJhYmxlJyxcblx0XHQnY29uc3RydWN0b3InXG5cdF07XG5cdHZhciBlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZSA9IGZ1bmN0aW9uIChvKSB7XG5cdFx0dmFyIGN0b3IgPSBvLmNvbnN0cnVjdG9yO1xuXHRcdHJldHVybiBjdG9yICYmIGN0b3IucHJvdG90eXBlID09PSBvO1xuXHR9O1xuXHR2YXIgZXhjbHVkZWRLZXlzID0ge1xuXHRcdCRhcHBsaWNhdGlvbkNhY2hlOiB0cnVlLFxuXHRcdCRjb25zb2xlOiB0cnVlLFxuXHRcdCRleHRlcm5hbDogdHJ1ZSxcblx0XHQkZnJhbWU6IHRydWUsXG5cdFx0JGZyYW1lRWxlbWVudDogdHJ1ZSxcblx0XHQkZnJhbWVzOiB0cnVlLFxuXHRcdCRpbm5lckhlaWdodDogdHJ1ZSxcblx0XHQkaW5uZXJXaWR0aDogdHJ1ZSxcblx0XHQkb25tb3pmdWxsc2NyZWVuY2hhbmdlOiB0cnVlLFxuXHRcdCRvbm1vemZ1bGxzY3JlZW5lcnJvcjogdHJ1ZSxcblx0XHQkb3V0ZXJIZWlnaHQ6IHRydWUsXG5cdFx0JG91dGVyV2lkdGg6IHRydWUsXG5cdFx0JHBhZ2VYT2Zmc2V0OiB0cnVlLFxuXHRcdCRwYWdlWU9mZnNldDogdHJ1ZSxcblx0XHQkcGFyZW50OiB0cnVlLFxuXHRcdCRzY3JvbGxMZWZ0OiB0cnVlLFxuXHRcdCRzY3JvbGxUb3A6IHRydWUsXG5cdFx0JHNjcm9sbFg6IHRydWUsXG5cdFx0JHNjcm9sbFk6IHRydWUsXG5cdFx0JHNlbGY6IHRydWUsXG5cdFx0JHdlYmtpdEluZGV4ZWREQjogdHJ1ZSxcblx0XHQkd2Via2l0U3RvcmFnZUluZm86IHRydWUsXG5cdFx0JHdpbmRvdzogdHJ1ZVxuXHR9O1xuXHR2YXIgaGFzQXV0b21hdGlvbkVxdWFsaXR5QnVnID0gKGZ1bmN0aW9uICgpIHtcblx0XHQvKiBnbG9iYWwgd2luZG93ICovXG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7IHJldHVybiBmYWxzZTsgfVxuXHRcdGZvciAodmFyIGsgaW4gd2luZG93KSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRpZiAoIWV4Y2x1ZGVkS2V5c1snJCcgKyBrXSAmJiBoYXMuY2FsbCh3aW5kb3csIGspICYmIHdpbmRvd1trXSAhPT0gbnVsbCAmJiB0eXBlb2Ygd2luZG93W2tdID09PSAnb2JqZWN0Jykge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZSh3aW5kb3dba10pO1xuXHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9KCkpO1xuXHR2YXIgZXF1YWxzQ29uc3RydWN0b3JQcm90b3R5cGVJZk5vdEJ1Z2d5ID0gZnVuY3Rpb24gKG8pIHtcblx0XHQvKiBnbG9iYWwgd2luZG93ICovXG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8ICFoYXNBdXRvbWF0aW9uRXF1YWxpdHlCdWcpIHtcblx0XHRcdHJldHVybiBlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZShvKTtcblx0XHR9XG5cdFx0dHJ5IHtcblx0XHRcdHJldHVybiBlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZShvKTtcblx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9O1xuXG5cdGtleXNTaGltID0gZnVuY3Rpb24ga2V5cyhvYmplY3QpIHtcblx0XHR2YXIgaXNPYmplY3QgPSBvYmplY3QgIT09IG51bGwgJiYgdHlwZW9mIG9iamVjdCA9PT0gJ29iamVjdCc7XG5cdFx0dmFyIGlzRnVuY3Rpb24gPSB0b1N0ci5jYWxsKG9iamVjdCkgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG5cdFx0dmFyIGlzQXJndW1lbnRzID0gaXNBcmdzKG9iamVjdCk7XG5cdFx0dmFyIGlzU3RyaW5nID0gaXNPYmplY3QgJiYgdG9TdHIuY2FsbChvYmplY3QpID09PSAnW29iamVjdCBTdHJpbmddJztcblx0XHR2YXIgdGhlS2V5cyA9IFtdO1xuXG5cdFx0aWYgKCFpc09iamVjdCAmJiAhaXNGdW5jdGlvbiAmJiAhaXNBcmd1bWVudHMpIHtcblx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdC5rZXlzIGNhbGxlZCBvbiBhIG5vbi1vYmplY3QnKTtcblx0XHR9XG5cblx0XHR2YXIgc2tpcFByb3RvID0gaGFzUHJvdG9FbnVtQnVnICYmIGlzRnVuY3Rpb247XG5cdFx0aWYgKGlzU3RyaW5nICYmIG9iamVjdC5sZW5ndGggPiAwICYmICFoYXMuY2FsbChvYmplY3QsIDApKSB7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG9iamVjdC5sZW5ndGg7ICsraSkge1xuXHRcdFx0XHR0aGVLZXlzLnB1c2goU3RyaW5nKGkpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoaXNBcmd1bWVudHMgJiYgb2JqZWN0Lmxlbmd0aCA+IDApIHtcblx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgb2JqZWN0Lmxlbmd0aDsgKytqKSB7XG5cdFx0XHRcdHRoZUtleXMucHVzaChTdHJpbmcoaikpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRmb3IgKHZhciBuYW1lIGluIG9iamVjdCkge1xuXHRcdFx0XHRpZiAoIShza2lwUHJvdG8gJiYgbmFtZSA9PT0gJ3Byb3RvdHlwZScpICYmIGhhcy5jYWxsKG9iamVjdCwgbmFtZSkpIHtcblx0XHRcdFx0XHR0aGVLZXlzLnB1c2goU3RyaW5nKG5hbWUpKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChoYXNEb250RW51bUJ1Zykge1xuXHRcdFx0dmFyIHNraXBDb25zdHJ1Y3RvciA9IGVxdWFsc0NvbnN0cnVjdG9yUHJvdG90eXBlSWZOb3RCdWdneShvYmplY3QpO1xuXG5cdFx0XHRmb3IgKHZhciBrID0gMDsgayA8IGRvbnRFbnVtcy5sZW5ndGg7ICsraykge1xuXHRcdFx0XHRpZiAoIShza2lwQ29uc3RydWN0b3IgJiYgZG9udEVudW1zW2tdID09PSAnY29uc3RydWN0b3InKSAmJiBoYXMuY2FsbChvYmplY3QsIGRvbnRFbnVtc1trXSkpIHtcblx0XHRcdFx0XHR0aGVLZXlzLnB1c2goZG9udEVudW1zW2tdKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdGhlS2V5cztcblx0fTtcbn1cbm1vZHVsZS5leHBvcnRzID0ga2V5c1NoaW07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcbnZhciBpc0FyZ3MgPSByZXF1aXJlKCcuL2lzQXJndW1lbnRzJyk7XG5cbnZhciBvcmlnS2V5cyA9IE9iamVjdC5rZXlzO1xudmFyIGtleXNTaGltID0gb3JpZ0tleXMgPyBmdW5jdGlvbiBrZXlzKG8pIHsgcmV0dXJuIG9yaWdLZXlzKG8pOyB9IDogcmVxdWlyZSgnLi9pbXBsZW1lbnRhdGlvbicpO1xuXG52YXIgb3JpZ2luYWxLZXlzID0gT2JqZWN0LmtleXM7XG5cbmtleXNTaGltLnNoaW0gPSBmdW5jdGlvbiBzaGltT2JqZWN0S2V5cygpIHtcblx0aWYgKE9iamVjdC5rZXlzKSB7XG5cdFx0dmFyIGtleXNXb3Jrc1dpdGhBcmd1bWVudHMgPSAoZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly8gU2FmYXJpIDUuMCBidWdcblx0XHRcdHZhciBhcmdzID0gT2JqZWN0LmtleXMoYXJndW1lbnRzKTtcblx0XHRcdHJldHVybiBhcmdzICYmIGFyZ3MubGVuZ3RoID09PSBhcmd1bWVudHMubGVuZ3RoO1xuXHRcdH0oMSwgMikpO1xuXHRcdGlmICgha2V5c1dvcmtzV2l0aEFyZ3VtZW50cykge1xuXHRcdFx0T2JqZWN0LmtleXMgPSBmdW5jdGlvbiBrZXlzKG9iamVjdCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGZ1bmMtbmFtZS1tYXRjaGluZ1xuXHRcdFx0XHRpZiAoaXNBcmdzKG9iamVjdCkpIHtcblx0XHRcdFx0XHRyZXR1cm4gb3JpZ2luYWxLZXlzKHNsaWNlLmNhbGwob2JqZWN0KSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIG9yaWdpbmFsS2V5cyhvYmplY3QpO1xuXHRcdFx0fTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0T2JqZWN0LmtleXMgPSBrZXlzU2hpbTtcblx0fVxuXHRyZXR1cm4gT2JqZWN0LmtleXMgfHwga2V5c1NoaW07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGtleXNTaGltO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGlzQXJndW1lbnRzKHZhbHVlKSB7XG5cdHZhciBzdHIgPSB0b1N0ci5jYWxsKHZhbHVlKTtcblx0dmFyIGlzQXJncyA9IHN0ciA9PT0gJ1tvYmplY3QgQXJndW1lbnRzXSc7XG5cdGlmICghaXNBcmdzKSB7XG5cdFx0aXNBcmdzID0gc3RyICE9PSAnW29iamVjdCBBcnJheV0nICYmXG5cdFx0XHR2YWx1ZSAhPT0gbnVsbCAmJlxuXHRcdFx0dHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJlxuXHRcdFx0dHlwZW9mIHZhbHVlLmxlbmd0aCA9PT0gJ251bWJlcicgJiZcblx0XHRcdHZhbHVlLmxlbmd0aCA+PSAwICYmXG5cdFx0XHR0b1N0ci5jYWxsKHZhbHVlLmNhbGxlZSkgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG5cdH1cblx0cmV0dXJuIGlzQXJncztcbn07XG4iLCJ2YXIgdHJpbSA9IHJlcXVpcmUoJ3N0cmluZy5wcm90b3R5cGUudHJpbScpXG4gICwgZm9yRWFjaCA9IHJlcXVpcmUoJ2Zvci1lYWNoJylcbiAgLCBpc0FycmF5ID0gZnVuY3Rpb24oYXJnKSB7XG4gICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFyZykgPT09ICdbb2JqZWN0IEFycmF5XSc7XG4gICAgfVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChoZWFkZXJzKSB7XG4gIGlmICghaGVhZGVycylcbiAgICByZXR1cm4ge31cblxuICB2YXIgcmVzdWx0ID0ge31cblxuICBmb3JFYWNoKFxuICAgICAgdHJpbShoZWFkZXJzKS5zcGxpdCgnXFxuJylcbiAgICAsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gcm93LmluZGV4T2YoJzonKVxuICAgICAgICAgICwga2V5ID0gdHJpbShyb3cuc2xpY2UoMCwgaW5kZXgpKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgLCB2YWx1ZSA9IHRyaW0ocm93LnNsaWNlKGluZGV4ICsgMSkpXG5cbiAgICAgICAgaWYgKHR5cGVvZihyZXN1bHRba2V5XSkgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZVxuICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkocmVzdWx0W2tleV0pKSB7XG4gICAgICAgICAgcmVzdWx0W2tleV0ucHVzaCh2YWx1ZSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXN1bHRba2V5XSA9IFsgcmVzdWx0W2tleV0sIHZhbHVlIF1cbiAgICAgICAgfVxuICAgICAgfVxuICApXG5cbiAgcmV0dXJuIHJlc3VsdFxufVxuIiwiLy8gLmRpcm5hbWUsIC5iYXNlbmFtZSwgYW5kIC5leHRuYW1lIG1ldGhvZHMgYXJlIGV4dHJhY3RlZCBmcm9tIE5vZGUuanMgdjguMTEuMSxcbi8vIGJhY2twb3J0ZWQgYW5kIHRyYW5zcGxpdGVkIHdpdGggQmFiZWwsIHdpdGggYmFja3dhcmRzLWNvbXBhdCBmaXhlc1xuXG4vLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuLy8gcmVzb2x2ZXMgLiBhbmQgLi4gZWxlbWVudHMgaW4gYSBwYXRoIGFycmF5IHdpdGggZGlyZWN0b3J5IG5hbWVzIHRoZXJlXG4vLyBtdXN0IGJlIG5vIHNsYXNoZXMsIGVtcHR5IGVsZW1lbnRzLCBvciBkZXZpY2UgbmFtZXMgKGM6XFwpIGluIHRoZSBhcnJheVxuLy8gKHNvIGFsc28gbm8gbGVhZGluZyBhbmQgdHJhaWxpbmcgc2xhc2hlcyAtIGl0IGRvZXMgbm90IGRpc3Rpbmd1aXNoXG4vLyByZWxhdGl2ZSBhbmQgYWJzb2x1dGUgcGF0aHMpXG5mdW5jdGlvbiBub3JtYWxpemVBcnJheShwYXJ0cywgYWxsb3dBYm92ZVJvb3QpIHtcbiAgLy8gaWYgdGhlIHBhdGggdHJpZXMgdG8gZ28gYWJvdmUgdGhlIHJvb3QsIGB1cGAgZW5kcyB1cCA+IDBcbiAgdmFyIHVwID0gMDtcbiAgZm9yICh2YXIgaSA9IHBhcnRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgdmFyIGxhc3QgPSBwYXJ0c1tpXTtcbiAgICBpZiAobGFzdCA9PT0gJy4nKSB7XG4gICAgICBwYXJ0cy5zcGxpY2UoaSwgMSk7XG4gICAgfSBlbHNlIGlmIChsYXN0ID09PSAnLi4nKSB7XG4gICAgICBwYXJ0cy5zcGxpY2UoaSwgMSk7XG4gICAgICB1cCsrO1xuICAgIH0gZWxzZSBpZiAodXApIHtcbiAgICAgIHBhcnRzLnNwbGljZShpLCAxKTtcbiAgICAgIHVwLS07XG4gICAgfVxuICB9XG5cbiAgLy8gaWYgdGhlIHBhdGggaXMgYWxsb3dlZCB0byBnbyBhYm92ZSB0aGUgcm9vdCwgcmVzdG9yZSBsZWFkaW5nIC4uc1xuICBpZiAoYWxsb3dBYm92ZVJvb3QpIHtcbiAgICBmb3IgKDsgdXAtLTsgdXApIHtcbiAgICAgIHBhcnRzLnVuc2hpZnQoJy4uJyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHBhcnRzO1xufVxuXG4vLyBwYXRoLnJlc29sdmUoW2Zyb20gLi4uXSwgdG8pXG4vLyBwb3NpeCB2ZXJzaW9uXG5leHBvcnRzLnJlc29sdmUgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHJlc29sdmVkUGF0aCA9ICcnLFxuICAgICAgcmVzb2x2ZWRBYnNvbHV0ZSA9IGZhbHNlO1xuXG4gIGZvciAodmFyIGkgPSBhcmd1bWVudHMubGVuZ3RoIC0gMTsgaSA+PSAtMSAmJiAhcmVzb2x2ZWRBYnNvbHV0ZTsgaS0tKSB7XG4gICAgdmFyIHBhdGggPSAoaSA+PSAwKSA/IGFyZ3VtZW50c1tpXSA6IHByb2Nlc3MuY3dkKCk7XG5cbiAgICAvLyBTa2lwIGVtcHR5IGFuZCBpbnZhbGlkIGVudHJpZXNcbiAgICBpZiAodHlwZW9mIHBhdGggIT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgdG8gcGF0aC5yZXNvbHZlIG11c3QgYmUgc3RyaW5ncycpO1xuICAgIH0gZWxzZSBpZiAoIXBhdGgpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIHJlc29sdmVkUGF0aCA9IHBhdGggKyAnLycgKyByZXNvbHZlZFBhdGg7XG4gICAgcmVzb2x2ZWRBYnNvbHV0ZSA9IHBhdGguY2hhckF0KDApID09PSAnLyc7XG4gIH1cblxuICAvLyBBdCB0aGlzIHBvaW50IHRoZSBwYXRoIHNob3VsZCBiZSByZXNvbHZlZCB0byBhIGZ1bGwgYWJzb2x1dGUgcGF0aCwgYnV0XG4gIC8vIGhhbmRsZSByZWxhdGl2ZSBwYXRocyB0byBiZSBzYWZlIChtaWdodCBoYXBwZW4gd2hlbiBwcm9jZXNzLmN3ZCgpIGZhaWxzKVxuXG4gIC8vIE5vcm1hbGl6ZSB0aGUgcGF0aFxuICByZXNvbHZlZFBhdGggPSBub3JtYWxpemVBcnJheShmaWx0ZXIocmVzb2x2ZWRQYXRoLnNwbGl0KCcvJyksIGZ1bmN0aW9uKHApIHtcbiAgICByZXR1cm4gISFwO1xuICB9KSwgIXJlc29sdmVkQWJzb2x1dGUpLmpvaW4oJy8nKTtcblxuICByZXR1cm4gKChyZXNvbHZlZEFic29sdXRlID8gJy8nIDogJycpICsgcmVzb2x2ZWRQYXRoKSB8fCAnLic7XG59O1xuXG4vLyBwYXRoLm5vcm1hbGl6ZShwYXRoKVxuLy8gcG9zaXggdmVyc2lvblxuZXhwb3J0cy5ub3JtYWxpemUgPSBmdW5jdGlvbihwYXRoKSB7XG4gIHZhciBpc0Fic29sdXRlID0gZXhwb3J0cy5pc0Fic29sdXRlKHBhdGgpLFxuICAgICAgdHJhaWxpbmdTbGFzaCA9IHN1YnN0cihwYXRoLCAtMSkgPT09ICcvJztcblxuICAvLyBOb3JtYWxpemUgdGhlIHBhdGhcbiAgcGF0aCA9IG5vcm1hbGl6ZUFycmF5KGZpbHRlcihwYXRoLnNwbGl0KCcvJyksIGZ1bmN0aW9uKHApIHtcbiAgICByZXR1cm4gISFwO1xuICB9KSwgIWlzQWJzb2x1dGUpLmpvaW4oJy8nKTtcblxuICBpZiAoIXBhdGggJiYgIWlzQWJzb2x1dGUpIHtcbiAgICBwYXRoID0gJy4nO1xuICB9XG4gIGlmIChwYXRoICYmIHRyYWlsaW5nU2xhc2gpIHtcbiAgICBwYXRoICs9ICcvJztcbiAgfVxuXG4gIHJldHVybiAoaXNBYnNvbHV0ZSA/ICcvJyA6ICcnKSArIHBhdGg7XG59O1xuXG4vLyBwb3NpeCB2ZXJzaW9uXG5leHBvcnRzLmlzQWJzb2x1dGUgPSBmdW5jdGlvbihwYXRoKSB7XG4gIHJldHVybiBwYXRoLmNoYXJBdCgwKSA9PT0gJy8nO1xufTtcblxuLy8gcG9zaXggdmVyc2lvblxuZXhwb3J0cy5qb2luID0gZnVuY3Rpb24oKSB7XG4gIHZhciBwYXRocyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCk7XG4gIHJldHVybiBleHBvcnRzLm5vcm1hbGl6ZShmaWx0ZXIocGF0aHMsIGZ1bmN0aW9uKHAsIGluZGV4KSB7XG4gICAgaWYgKHR5cGVvZiBwICE9PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnRzIHRvIHBhdGguam9pbiBtdXN0IGJlIHN0cmluZ3MnKTtcbiAgICB9XG4gICAgcmV0dXJuIHA7XG4gIH0pLmpvaW4oJy8nKSk7XG59O1xuXG5cbi8vIHBhdGgucmVsYXRpdmUoZnJvbSwgdG8pXG4vLyBwb3NpeCB2ZXJzaW9uXG5leHBvcnRzLnJlbGF0aXZlID0gZnVuY3Rpb24oZnJvbSwgdG8pIHtcbiAgZnJvbSA9IGV4cG9ydHMucmVzb2x2ZShmcm9tKS5zdWJzdHIoMSk7XG4gIHRvID0gZXhwb3J0cy5yZXNvbHZlKHRvKS5zdWJzdHIoMSk7XG5cbiAgZnVuY3Rpb24gdHJpbShhcnIpIHtcbiAgICB2YXIgc3RhcnQgPSAwO1xuICAgIGZvciAoOyBzdGFydCA8IGFyci5sZW5ndGg7IHN0YXJ0KyspIHtcbiAgICAgIGlmIChhcnJbc3RhcnRdICE9PSAnJykgYnJlYWs7XG4gICAgfVxuXG4gICAgdmFyIGVuZCA9IGFyci5sZW5ndGggLSAxO1xuICAgIGZvciAoOyBlbmQgPj0gMDsgZW5kLS0pIHtcbiAgICAgIGlmIChhcnJbZW5kXSAhPT0gJycpIGJyZWFrO1xuICAgIH1cblxuICAgIGlmIChzdGFydCA+IGVuZCkgcmV0dXJuIFtdO1xuICAgIHJldHVybiBhcnIuc2xpY2Uoc3RhcnQsIGVuZCAtIHN0YXJ0ICsgMSk7XG4gIH1cblxuICB2YXIgZnJvbVBhcnRzID0gdHJpbShmcm9tLnNwbGl0KCcvJykpO1xuICB2YXIgdG9QYXJ0cyA9IHRyaW0odG8uc3BsaXQoJy8nKSk7XG5cbiAgdmFyIGxlbmd0aCA9IE1hdGgubWluKGZyb21QYXJ0cy5sZW5ndGgsIHRvUGFydHMubGVuZ3RoKTtcbiAgdmFyIHNhbWVQYXJ0c0xlbmd0aCA9IGxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGlmIChmcm9tUGFydHNbaV0gIT09IHRvUGFydHNbaV0pIHtcbiAgICAgIHNhbWVQYXJ0c0xlbmd0aCA9IGk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICB2YXIgb3V0cHV0UGFydHMgPSBbXTtcbiAgZm9yICh2YXIgaSA9IHNhbWVQYXJ0c0xlbmd0aDsgaSA8IGZyb21QYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgIG91dHB1dFBhcnRzLnB1c2goJy4uJyk7XG4gIH1cblxuICBvdXRwdXRQYXJ0cyA9IG91dHB1dFBhcnRzLmNvbmNhdCh0b1BhcnRzLnNsaWNlKHNhbWVQYXJ0c0xlbmd0aCkpO1xuXG4gIHJldHVybiBvdXRwdXRQYXJ0cy5qb2luKCcvJyk7XG59O1xuXG5leHBvcnRzLnNlcCA9ICcvJztcbmV4cG9ydHMuZGVsaW1pdGVyID0gJzonO1xuXG5leHBvcnRzLmRpcm5hbWUgPSBmdW5jdGlvbiAocGF0aCkge1xuICBpZiAodHlwZW9mIHBhdGggIT09ICdzdHJpbmcnKSBwYXRoID0gcGF0aCArICcnO1xuICBpZiAocGF0aC5sZW5ndGggPT09IDApIHJldHVybiAnLic7XG4gIHZhciBjb2RlID0gcGF0aC5jaGFyQ29kZUF0KDApO1xuICB2YXIgaGFzUm9vdCA9IGNvZGUgPT09IDQ3IC8qLyovO1xuICB2YXIgZW5kID0gLTE7XG4gIHZhciBtYXRjaGVkU2xhc2ggPSB0cnVlO1xuICBmb3IgKHZhciBpID0gcGF0aC5sZW5ndGggLSAxOyBpID49IDE7IC0taSkge1xuICAgIGNvZGUgPSBwYXRoLmNoYXJDb2RlQXQoaSk7XG4gICAgaWYgKGNvZGUgPT09IDQ3IC8qLyovKSB7XG4gICAgICAgIGlmICghbWF0Y2hlZFNsYXNoKSB7XG4gICAgICAgICAgZW5kID0gaTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgIC8vIFdlIHNhdyB0aGUgZmlyc3Qgbm9uLXBhdGggc2VwYXJhdG9yXG4gICAgICBtYXRjaGVkU2xhc2ggPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBpZiAoZW5kID09PSAtMSkgcmV0dXJuIGhhc1Jvb3QgPyAnLycgOiAnLic7XG4gIGlmIChoYXNSb290ICYmIGVuZCA9PT0gMSkge1xuICAgIC8vIHJldHVybiAnLy8nO1xuICAgIC8vIEJhY2t3YXJkcy1jb21wYXQgZml4OlxuICAgIHJldHVybiAnLyc7XG4gIH1cbiAgcmV0dXJuIHBhdGguc2xpY2UoMCwgZW5kKTtcbn07XG5cbmZ1bmN0aW9uIGJhc2VuYW1lKHBhdGgpIHtcbiAgaWYgKHR5cGVvZiBwYXRoICE9PSAnc3RyaW5nJykgcGF0aCA9IHBhdGggKyAnJztcblxuICB2YXIgc3RhcnQgPSAwO1xuICB2YXIgZW5kID0gLTE7XG4gIHZhciBtYXRjaGVkU2xhc2ggPSB0cnVlO1xuICB2YXIgaTtcblxuICBmb3IgKGkgPSBwYXRoLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgaWYgKHBhdGguY2hhckNvZGVBdChpKSA9PT0gNDcgLyovKi8pIHtcbiAgICAgICAgLy8gSWYgd2UgcmVhY2hlZCBhIHBhdGggc2VwYXJhdG9yIHRoYXQgd2FzIG5vdCBwYXJ0IG9mIGEgc2V0IG9mIHBhdGhcbiAgICAgICAgLy8gc2VwYXJhdG9ycyBhdCB0aGUgZW5kIG9mIHRoZSBzdHJpbmcsIHN0b3Agbm93XG4gICAgICAgIGlmICghbWF0Y2hlZFNsYXNoKSB7XG4gICAgICAgICAgc3RhcnQgPSBpICsgMTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChlbmQgPT09IC0xKSB7XG4gICAgICAvLyBXZSBzYXcgdGhlIGZpcnN0IG5vbi1wYXRoIHNlcGFyYXRvciwgbWFyayB0aGlzIGFzIHRoZSBlbmQgb2Ygb3VyXG4gICAgICAvLyBwYXRoIGNvbXBvbmVudFxuICAgICAgbWF0Y2hlZFNsYXNoID0gZmFsc2U7XG4gICAgICBlbmQgPSBpICsgMTtcbiAgICB9XG4gIH1cblxuICBpZiAoZW5kID09PSAtMSkgcmV0dXJuICcnO1xuICByZXR1cm4gcGF0aC5zbGljZShzdGFydCwgZW5kKTtcbn1cblxuLy8gVXNlcyBhIG1peGVkIGFwcHJvYWNoIGZvciBiYWNrd2FyZHMtY29tcGF0aWJpbGl0eSwgYXMgZXh0IGJlaGF2aW9yIGNoYW5nZWRcbi8vIGluIG5ldyBOb2RlLmpzIHZlcnNpb25zLCBzbyBvbmx5IGJhc2VuYW1lKCkgYWJvdmUgaXMgYmFja3BvcnRlZCBoZXJlXG5leHBvcnRzLmJhc2VuYW1lID0gZnVuY3Rpb24gKHBhdGgsIGV4dCkge1xuICB2YXIgZiA9IGJhc2VuYW1lKHBhdGgpO1xuICBpZiAoZXh0ICYmIGYuc3Vic3RyKC0xICogZXh0Lmxlbmd0aCkgPT09IGV4dCkge1xuICAgIGYgPSBmLnN1YnN0cigwLCBmLmxlbmd0aCAtIGV4dC5sZW5ndGgpO1xuICB9XG4gIHJldHVybiBmO1xufTtcblxuZXhwb3J0cy5leHRuYW1lID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgaWYgKHR5cGVvZiBwYXRoICE9PSAnc3RyaW5nJykgcGF0aCA9IHBhdGggKyAnJztcbiAgdmFyIHN0YXJ0RG90ID0gLTE7XG4gIHZhciBzdGFydFBhcnQgPSAwO1xuICB2YXIgZW5kID0gLTE7XG4gIHZhciBtYXRjaGVkU2xhc2ggPSB0cnVlO1xuICAvLyBUcmFjayB0aGUgc3RhdGUgb2YgY2hhcmFjdGVycyAoaWYgYW55KSB3ZSBzZWUgYmVmb3JlIG91ciBmaXJzdCBkb3QgYW5kXG4gIC8vIGFmdGVyIGFueSBwYXRoIHNlcGFyYXRvciB3ZSBmaW5kXG4gIHZhciBwcmVEb3RTdGF0ZSA9IDA7XG4gIGZvciAodmFyIGkgPSBwYXRoLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgdmFyIGNvZGUgPSBwYXRoLmNoYXJDb2RlQXQoaSk7XG4gICAgaWYgKGNvZGUgPT09IDQ3IC8qLyovKSB7XG4gICAgICAgIC8vIElmIHdlIHJlYWNoZWQgYSBwYXRoIHNlcGFyYXRvciB0aGF0IHdhcyBub3QgcGFydCBvZiBhIHNldCBvZiBwYXRoXG4gICAgICAgIC8vIHNlcGFyYXRvcnMgYXQgdGhlIGVuZCBvZiB0aGUgc3RyaW5nLCBzdG9wIG5vd1xuICAgICAgICBpZiAoIW1hdGNoZWRTbGFzaCkge1xuICAgICAgICAgIHN0YXJ0UGFydCA9IGkgKyAxO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgIGlmIChlbmQgPT09IC0xKSB7XG4gICAgICAvLyBXZSBzYXcgdGhlIGZpcnN0IG5vbi1wYXRoIHNlcGFyYXRvciwgbWFyayB0aGlzIGFzIHRoZSBlbmQgb2Ygb3VyXG4gICAgICAvLyBleHRlbnNpb25cbiAgICAgIG1hdGNoZWRTbGFzaCA9IGZhbHNlO1xuICAgICAgZW5kID0gaSArIDE7XG4gICAgfVxuICAgIGlmIChjb2RlID09PSA0NiAvKi4qLykge1xuICAgICAgICAvLyBJZiB0aGlzIGlzIG91ciBmaXJzdCBkb3QsIG1hcmsgaXQgYXMgdGhlIHN0YXJ0IG9mIG91ciBleHRlbnNpb25cbiAgICAgICAgaWYgKHN0YXJ0RG90ID09PSAtMSlcbiAgICAgICAgICBzdGFydERvdCA9IGk7XG4gICAgICAgIGVsc2UgaWYgKHByZURvdFN0YXRlICE9PSAxKVxuICAgICAgICAgIHByZURvdFN0YXRlID0gMTtcbiAgICB9IGVsc2UgaWYgKHN0YXJ0RG90ICE9PSAtMSkge1xuICAgICAgLy8gV2Ugc2F3IGEgbm9uLWRvdCBhbmQgbm9uLXBhdGggc2VwYXJhdG9yIGJlZm9yZSBvdXIgZG90LCBzbyB3ZSBzaG91bGRcbiAgICAgIC8vIGhhdmUgYSBnb29kIGNoYW5jZSBhdCBoYXZpbmcgYSBub24tZW1wdHkgZXh0ZW5zaW9uXG4gICAgICBwcmVEb3RTdGF0ZSA9IC0xO1xuICAgIH1cbiAgfVxuXG4gIGlmIChzdGFydERvdCA9PT0gLTEgfHwgZW5kID09PSAtMSB8fFxuICAgICAgLy8gV2Ugc2F3IGEgbm9uLWRvdCBjaGFyYWN0ZXIgaW1tZWRpYXRlbHkgYmVmb3JlIHRoZSBkb3RcbiAgICAgIHByZURvdFN0YXRlID09PSAwIHx8XG4gICAgICAvLyBUaGUgKHJpZ2h0LW1vc3QpIHRyaW1tZWQgcGF0aCBjb21wb25lbnQgaXMgZXhhY3RseSAnLi4nXG4gICAgICBwcmVEb3RTdGF0ZSA9PT0gMSAmJiBzdGFydERvdCA9PT0gZW5kIC0gMSAmJiBzdGFydERvdCA9PT0gc3RhcnRQYXJ0ICsgMSkge1xuICAgIHJldHVybiAnJztcbiAgfVxuICByZXR1cm4gcGF0aC5zbGljZShzdGFydERvdCwgZW5kKTtcbn07XG5cbmZ1bmN0aW9uIGZpbHRlciAoeHMsIGYpIHtcbiAgICBpZiAoeHMuZmlsdGVyKSByZXR1cm4geHMuZmlsdGVyKGYpO1xuICAgIHZhciByZXMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHhzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChmKHhzW2ldLCBpLCB4cykpIHJlcy5wdXNoKHhzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbn1cblxuLy8gU3RyaW5nLnByb3RvdHlwZS5zdWJzdHIgLSBuZWdhdGl2ZSBpbmRleCBkb24ndCB3b3JrIGluIElFOFxudmFyIHN1YnN0ciA9ICdhYicuc3Vic3RyKC0xKSA9PT0gJ2InXG4gICAgPyBmdW5jdGlvbiAoc3RyLCBzdGFydCwgbGVuKSB7IHJldHVybiBzdHIuc3Vic3RyKHN0YXJ0LCBsZW4pIH1cbiAgICA6IGZ1bmN0aW9uIChzdHIsIHN0YXJ0LCBsZW4pIHtcbiAgICAgICAgaWYgKHN0YXJ0IDwgMCkgc3RhcnQgPSBzdHIubGVuZ3RoICsgc3RhcnQ7XG4gICAgICAgIHJldHVybiBzdHIuc3Vic3RyKHN0YXJ0LCBsZW4pO1xuICAgIH1cbjtcbiIsInZhciBwYXJzZSA9IHJlcXVpcmUoXCIuL3BhcnNlXCIpO1xudmFyIHdhbGsgPSByZXF1aXJlKFwiLi93YWxrXCIpO1xudmFyIHN0cmluZ2lmeSA9IHJlcXVpcmUoXCIuL3N0cmluZ2lmeVwiKTtcblxuZnVuY3Rpb24gVmFsdWVQYXJzZXIodmFsdWUpIHtcbiAgaWYgKHRoaXMgaW5zdGFuY2VvZiBWYWx1ZVBhcnNlcikge1xuICAgIHRoaXMubm9kZXMgPSBwYXJzZSh2YWx1ZSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgcmV0dXJuIG5ldyBWYWx1ZVBhcnNlcih2YWx1ZSk7XG59XG5cblZhbHVlUGFyc2VyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gQXJyYXkuaXNBcnJheSh0aGlzLm5vZGVzKSA/IHN0cmluZ2lmeSh0aGlzLm5vZGVzKSA6IFwiXCI7XG59O1xuXG5WYWx1ZVBhcnNlci5wcm90b3R5cGUud2FsayA9IGZ1bmN0aW9uKGNiLCBidWJibGUpIHtcbiAgd2Fsayh0aGlzLm5vZGVzLCBjYiwgYnViYmxlKTtcbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5WYWx1ZVBhcnNlci51bml0ID0gcmVxdWlyZShcIi4vdW5pdFwiKTtcblxuVmFsdWVQYXJzZXIud2FsayA9IHdhbGs7XG5cblZhbHVlUGFyc2VyLnN0cmluZ2lmeSA9IHN0cmluZ2lmeTtcblxubW9kdWxlLmV4cG9ydHMgPSBWYWx1ZVBhcnNlcjtcbiIsInZhciBvcGVuUGFyZW50aGVzZXMgPSBcIihcIi5jaGFyQ29kZUF0KDApO1xudmFyIGNsb3NlUGFyZW50aGVzZXMgPSBcIilcIi5jaGFyQ29kZUF0KDApO1xudmFyIHNpbmdsZVF1b3RlID0gXCInXCIuY2hhckNvZGVBdCgwKTtcbnZhciBkb3VibGVRdW90ZSA9ICdcIicuY2hhckNvZGVBdCgwKTtcbnZhciBiYWNrc2xhc2ggPSBcIlxcXFxcIi5jaGFyQ29kZUF0KDApO1xudmFyIHNsYXNoID0gXCIvXCIuY2hhckNvZGVBdCgwKTtcbnZhciBjb21tYSA9IFwiLFwiLmNoYXJDb2RlQXQoMCk7XG52YXIgY29sb24gPSBcIjpcIi5jaGFyQ29kZUF0KDApO1xudmFyIHN0YXIgPSBcIipcIi5jaGFyQ29kZUF0KDApO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGlucHV0KSB7XG4gIHZhciB0b2tlbnMgPSBbXTtcbiAgdmFyIHZhbHVlID0gaW5wdXQ7XG5cbiAgdmFyIG5leHQsIHF1b3RlLCBwcmV2LCB0b2tlbiwgZXNjYXBlLCBlc2NhcGVQb3MsIHdoaXRlc3BhY2VQb3M7XG4gIHZhciBwb3MgPSAwO1xuICB2YXIgY29kZSA9IHZhbHVlLmNoYXJDb2RlQXQocG9zKTtcbiAgdmFyIG1heCA9IHZhbHVlLmxlbmd0aDtcbiAgdmFyIHN0YWNrID0gW3sgbm9kZXM6IHRva2VucyB9XTtcbiAgdmFyIGJhbGFuY2VkID0gMDtcbiAgdmFyIHBhcmVudDtcblxuICB2YXIgbmFtZSA9IFwiXCI7XG4gIHZhciBiZWZvcmUgPSBcIlwiO1xuICB2YXIgYWZ0ZXIgPSBcIlwiO1xuXG4gIHdoaWxlIChwb3MgPCBtYXgpIHtcbiAgICAvLyBXaGl0ZXNwYWNlc1xuICAgIGlmIChjb2RlIDw9IDMyKSB7XG4gICAgICBuZXh0ID0gcG9zO1xuICAgICAgZG8ge1xuICAgICAgICBuZXh0ICs9IDE7XG4gICAgICAgIGNvZGUgPSB2YWx1ZS5jaGFyQ29kZUF0KG5leHQpO1xuICAgICAgfSB3aGlsZSAoY29kZSA8PSAzMik7XG4gICAgICB0b2tlbiA9IHZhbHVlLnNsaWNlKHBvcywgbmV4dCk7XG5cbiAgICAgIHByZXYgPSB0b2tlbnNbdG9rZW5zLmxlbmd0aCAtIDFdO1xuICAgICAgaWYgKGNvZGUgPT09IGNsb3NlUGFyZW50aGVzZXMgJiYgYmFsYW5jZWQpIHtcbiAgICAgICAgYWZ0ZXIgPSB0b2tlbjtcbiAgICAgIH0gZWxzZSBpZiAocHJldiAmJiBwcmV2LnR5cGUgPT09IFwiZGl2XCIpIHtcbiAgICAgICAgcHJldi5hZnRlciA9IHRva2VuO1xuICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgY29kZSA9PT0gY29tbWEgfHxcbiAgICAgICAgY29kZSA9PT0gY29sb24gfHxcbiAgICAgICAgKGNvZGUgPT09IHNsYXNoICYmIHZhbHVlLmNoYXJDb2RlQXQobmV4dCArIDEpICE9PSBzdGFyKVxuICAgICAgKSB7XG4gICAgICAgIGJlZm9yZSA9IHRva2VuO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdG9rZW5zLnB1c2goe1xuICAgICAgICAgIHR5cGU6IFwic3BhY2VcIixcbiAgICAgICAgICBzb3VyY2VJbmRleDogcG9zLFxuICAgICAgICAgIHZhbHVlOiB0b2tlblxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcG9zID0gbmV4dDtcblxuICAgICAgLy8gUXVvdGVzXG4gICAgfSBlbHNlIGlmIChjb2RlID09PSBzaW5nbGVRdW90ZSB8fCBjb2RlID09PSBkb3VibGVRdW90ZSkge1xuICAgICAgbmV4dCA9IHBvcztcbiAgICAgIHF1b3RlID0gY29kZSA9PT0gc2luZ2xlUXVvdGUgPyBcIidcIiA6ICdcIic7XG4gICAgICB0b2tlbiA9IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgc291cmNlSW5kZXg6IHBvcyxcbiAgICAgICAgcXVvdGU6IHF1b3RlXG4gICAgICB9O1xuICAgICAgZG8ge1xuICAgICAgICBlc2NhcGUgPSBmYWxzZTtcbiAgICAgICAgbmV4dCA9IHZhbHVlLmluZGV4T2YocXVvdGUsIG5leHQgKyAxKTtcbiAgICAgICAgaWYgKH5uZXh0KSB7XG4gICAgICAgICAgZXNjYXBlUG9zID0gbmV4dDtcbiAgICAgICAgICB3aGlsZSAodmFsdWUuY2hhckNvZGVBdChlc2NhcGVQb3MgLSAxKSA9PT0gYmFja3NsYXNoKSB7XG4gICAgICAgICAgICBlc2NhcGVQb3MgLT0gMTtcbiAgICAgICAgICAgIGVzY2FwZSA9ICFlc2NhcGU7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhbHVlICs9IHF1b3RlO1xuICAgICAgICAgIG5leHQgPSB2YWx1ZS5sZW5ndGggLSAxO1xuICAgICAgICAgIHRva2VuLnVuY2xvc2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSB3aGlsZSAoZXNjYXBlKTtcbiAgICAgIHRva2VuLnZhbHVlID0gdmFsdWUuc2xpY2UocG9zICsgMSwgbmV4dCk7XG5cbiAgICAgIHRva2Vucy5wdXNoKHRva2VuKTtcbiAgICAgIHBvcyA9IG5leHQgKyAxO1xuICAgICAgY29kZSA9IHZhbHVlLmNoYXJDb2RlQXQocG9zKTtcblxuICAgICAgLy8gQ29tbWVudHNcbiAgICB9IGVsc2UgaWYgKGNvZGUgPT09IHNsYXNoICYmIHZhbHVlLmNoYXJDb2RlQXQocG9zICsgMSkgPT09IHN0YXIpIHtcbiAgICAgIHRva2VuID0ge1xuICAgICAgICB0eXBlOiBcImNvbW1lbnRcIixcbiAgICAgICAgc291cmNlSW5kZXg6IHBvc1xuICAgICAgfTtcblxuICAgICAgbmV4dCA9IHZhbHVlLmluZGV4T2YoXCIqL1wiLCBwb3MpO1xuICAgICAgaWYgKG5leHQgPT09IC0xKSB7XG4gICAgICAgIHRva2VuLnVuY2xvc2VkID0gdHJ1ZTtcbiAgICAgICAgbmV4dCA9IHZhbHVlLmxlbmd0aDtcbiAgICAgIH1cblxuICAgICAgdG9rZW4udmFsdWUgPSB2YWx1ZS5zbGljZShwb3MgKyAyLCBuZXh0KTtcbiAgICAgIHRva2Vucy5wdXNoKHRva2VuKTtcblxuICAgICAgcG9zID0gbmV4dCArIDI7XG4gICAgICBjb2RlID0gdmFsdWUuY2hhckNvZGVBdChwb3MpO1xuXG4gICAgICAvLyBEaXZpZGVyc1xuICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gc2xhc2ggfHwgY29kZSA9PT0gY29tbWEgfHwgY29kZSA9PT0gY29sb24pIHtcbiAgICAgIHRva2VuID0gdmFsdWVbcG9zXTtcblxuICAgICAgdG9rZW5zLnB1c2goe1xuICAgICAgICB0eXBlOiBcImRpdlwiLFxuICAgICAgICBzb3VyY2VJbmRleDogcG9zIC0gYmVmb3JlLmxlbmd0aCxcbiAgICAgICAgdmFsdWU6IHRva2VuLFxuICAgICAgICBiZWZvcmU6IGJlZm9yZSxcbiAgICAgICAgYWZ0ZXI6IFwiXCJcbiAgICAgIH0pO1xuICAgICAgYmVmb3JlID0gXCJcIjtcblxuICAgICAgcG9zICs9IDE7XG4gICAgICBjb2RlID0gdmFsdWUuY2hhckNvZGVBdChwb3MpO1xuXG4gICAgICAvLyBPcGVuIHBhcmVudGhlc2VzXG4gICAgfSBlbHNlIGlmIChvcGVuUGFyZW50aGVzZXMgPT09IGNvZGUpIHtcbiAgICAgIC8vIFdoaXRlc3BhY2VzIGFmdGVyIG9wZW4gcGFyZW50aGVzZXNcbiAgICAgIG5leHQgPSBwb3M7XG4gICAgICBkbyB7XG4gICAgICAgIG5leHQgKz0gMTtcbiAgICAgICAgY29kZSA9IHZhbHVlLmNoYXJDb2RlQXQobmV4dCk7XG4gICAgICB9IHdoaWxlIChjb2RlIDw9IDMyKTtcbiAgICAgIHRva2VuID0ge1xuICAgICAgICB0eXBlOiBcImZ1bmN0aW9uXCIsXG4gICAgICAgIHNvdXJjZUluZGV4OiBwb3MgLSBuYW1lLmxlbmd0aCxcbiAgICAgICAgdmFsdWU6IG5hbWUsXG4gICAgICAgIGJlZm9yZTogdmFsdWUuc2xpY2UocG9zICsgMSwgbmV4dClcbiAgICAgIH07XG4gICAgICBwb3MgPSBuZXh0O1xuXG4gICAgICBpZiAobmFtZSA9PT0gXCJ1cmxcIiAmJiBjb2RlICE9PSBzaW5nbGVRdW90ZSAmJiBjb2RlICE9PSBkb3VibGVRdW90ZSkge1xuICAgICAgICBuZXh0IC09IDE7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICBlc2NhcGUgPSBmYWxzZTtcbiAgICAgICAgICBuZXh0ID0gdmFsdWUuaW5kZXhPZihcIilcIiwgbmV4dCArIDEpO1xuICAgICAgICAgIGlmICh+bmV4dCkge1xuICAgICAgICAgICAgZXNjYXBlUG9zID0gbmV4dDtcbiAgICAgICAgICAgIHdoaWxlICh2YWx1ZS5jaGFyQ29kZUF0KGVzY2FwZVBvcyAtIDEpID09PSBiYWNrc2xhc2gpIHtcbiAgICAgICAgICAgICAgZXNjYXBlUG9zIC09IDE7XG4gICAgICAgICAgICAgIGVzY2FwZSA9ICFlc2NhcGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlICs9IFwiKVwiO1xuICAgICAgICAgICAgbmV4dCA9IHZhbHVlLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB0b2tlbi51bmNsb3NlZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9IHdoaWxlIChlc2NhcGUpO1xuICAgICAgICAvLyBXaGl0ZXNwYWNlcyBiZWZvcmUgY2xvc2VkXG4gICAgICAgIHdoaXRlc3BhY2VQb3MgPSBuZXh0O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgd2hpdGVzcGFjZVBvcyAtPSAxO1xuICAgICAgICAgIGNvZGUgPSB2YWx1ZS5jaGFyQ29kZUF0KHdoaXRlc3BhY2VQb3MpO1xuICAgICAgICB9IHdoaWxlIChjb2RlIDw9IDMyKTtcbiAgICAgICAgaWYgKHBvcyAhPT0gd2hpdGVzcGFjZVBvcyArIDEpIHtcbiAgICAgICAgICB0b2tlbi5ub2RlcyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdHlwZTogXCJ3b3JkXCIsXG4gICAgICAgICAgICAgIHNvdXJjZUluZGV4OiBwb3MsXG4gICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZS5zbGljZShwb3MsIHdoaXRlc3BhY2VQb3MgKyAxKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG9rZW4ubm9kZXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodG9rZW4udW5jbG9zZWQgJiYgd2hpdGVzcGFjZVBvcyArIDEgIT09IG5leHQpIHtcbiAgICAgICAgICB0b2tlbi5hZnRlciA9IFwiXCI7XG4gICAgICAgICAgdG9rZW4ubm9kZXMucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiBcInNwYWNlXCIsXG4gICAgICAgICAgICBzb3VyY2VJbmRleDogd2hpdGVzcGFjZVBvcyArIDEsXG4gICAgICAgICAgICB2YWx1ZTogdmFsdWUuc2xpY2Uod2hpdGVzcGFjZVBvcyArIDEsIG5leHQpXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG9rZW4uYWZ0ZXIgPSB2YWx1ZS5zbGljZSh3aGl0ZXNwYWNlUG9zICsgMSwgbmV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgcG9zID0gbmV4dCArIDE7XG4gICAgICAgIGNvZGUgPSB2YWx1ZS5jaGFyQ29kZUF0KHBvcyk7XG4gICAgICAgIHRva2Vucy5wdXNoKHRva2VuKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJhbGFuY2VkICs9IDE7XG4gICAgICAgIHRva2VuLmFmdGVyID0gXCJcIjtcbiAgICAgICAgdG9rZW5zLnB1c2godG9rZW4pO1xuICAgICAgICBzdGFjay5wdXNoKHRva2VuKTtcbiAgICAgICAgdG9rZW5zID0gdG9rZW4ubm9kZXMgPSBbXTtcbiAgICAgICAgcGFyZW50ID0gdG9rZW47XG4gICAgICB9XG4gICAgICBuYW1lID0gXCJcIjtcblxuICAgICAgLy8gQ2xvc2UgcGFyZW50aGVzZXNcbiAgICB9IGVsc2UgaWYgKGNsb3NlUGFyZW50aGVzZXMgPT09IGNvZGUgJiYgYmFsYW5jZWQpIHtcbiAgICAgIHBvcyArPSAxO1xuICAgICAgY29kZSA9IHZhbHVlLmNoYXJDb2RlQXQocG9zKTtcblxuICAgICAgcGFyZW50LmFmdGVyID0gYWZ0ZXI7XG4gICAgICBhZnRlciA9IFwiXCI7XG4gICAgICBiYWxhbmNlZCAtPSAxO1xuICAgICAgc3RhY2sucG9wKCk7XG4gICAgICBwYXJlbnQgPSBzdGFja1tiYWxhbmNlZF07XG4gICAgICB0b2tlbnMgPSBwYXJlbnQubm9kZXM7XG5cbiAgICAgIC8vIFdvcmRzXG4gICAgfSBlbHNlIHtcbiAgICAgIG5leHQgPSBwb3M7XG4gICAgICBkbyB7XG4gICAgICAgIGlmIChjb2RlID09PSBiYWNrc2xhc2gpIHtcbiAgICAgICAgICBuZXh0ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgbmV4dCArPSAxO1xuICAgICAgICBjb2RlID0gdmFsdWUuY2hhckNvZGVBdChuZXh0KTtcbiAgICAgIH0gd2hpbGUgKFxuICAgICAgICBuZXh0IDwgbWF4ICYmXG4gICAgICAgICEoXG4gICAgICAgICAgY29kZSA8PSAzMiB8fFxuICAgICAgICAgIGNvZGUgPT09IHNpbmdsZVF1b3RlIHx8XG4gICAgICAgICAgY29kZSA9PT0gZG91YmxlUXVvdGUgfHxcbiAgICAgICAgICBjb2RlID09PSBjb21tYSB8fFxuICAgICAgICAgIGNvZGUgPT09IGNvbG9uIHx8XG4gICAgICAgICAgY29kZSA9PT0gc2xhc2ggfHxcbiAgICAgICAgICBjb2RlID09PSBvcGVuUGFyZW50aGVzZXMgfHxcbiAgICAgICAgICAoY29kZSA9PT0gY2xvc2VQYXJlbnRoZXNlcyAmJiBiYWxhbmNlZClcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICAgIHRva2VuID0gdmFsdWUuc2xpY2UocG9zLCBuZXh0KTtcblxuICAgICAgaWYgKG9wZW5QYXJlbnRoZXNlcyA9PT0gY29kZSkge1xuICAgICAgICBuYW1lID0gdG9rZW47XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0b2tlbnMucHVzaCh7XG4gICAgICAgICAgdHlwZTogXCJ3b3JkXCIsXG4gICAgICAgICAgc291cmNlSW5kZXg6IHBvcyxcbiAgICAgICAgICB2YWx1ZTogdG9rZW5cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHBvcyA9IG5leHQ7XG4gICAgfVxuICB9XG5cbiAgZm9yIChwb3MgPSBzdGFjay5sZW5ndGggLSAxOyBwb3M7IHBvcyAtPSAxKSB7XG4gICAgc3RhY2tbcG9zXS51bmNsb3NlZCA9IHRydWU7XG4gIH1cblxuICByZXR1cm4gc3RhY2tbMF0ubm9kZXM7XG59O1xuIiwiZnVuY3Rpb24gc3RyaW5naWZ5Tm9kZShub2RlLCBjdXN0b20pIHtcbiAgdmFyIHR5cGUgPSBub2RlLnR5cGU7XG4gIHZhciB2YWx1ZSA9IG5vZGUudmFsdWU7XG4gIHZhciBidWY7XG4gIHZhciBjdXN0b21SZXN1bHQ7XG5cbiAgaWYgKGN1c3RvbSAmJiAoY3VzdG9tUmVzdWx0ID0gY3VzdG9tKG5vZGUpKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIGN1c3RvbVJlc3VsdDtcbiAgfSBlbHNlIGlmICh0eXBlID09PSBcIndvcmRcIiB8fCB0eXBlID09PSBcInNwYWNlXCIpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJzdHJpbmdcIikge1xuICAgIGJ1ZiA9IG5vZGUucXVvdGUgfHwgXCJcIjtcbiAgICByZXR1cm4gYnVmICsgdmFsdWUgKyAobm9kZS51bmNsb3NlZCA/IFwiXCIgOiBidWYpO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiY29tbWVudFwiKSB7XG4gICAgcmV0dXJuIFwiLypcIiArIHZhbHVlICsgKG5vZGUudW5jbG9zZWQgPyBcIlwiIDogXCIqL1wiKTtcbiAgfSBlbHNlIGlmICh0eXBlID09PSBcImRpdlwiKSB7XG4gICAgcmV0dXJuIChub2RlLmJlZm9yZSB8fCBcIlwiKSArIHZhbHVlICsgKG5vZGUuYWZ0ZXIgfHwgXCJcIik7XG4gIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShub2RlLm5vZGVzKSkge1xuICAgIGJ1ZiA9IHN0cmluZ2lmeShub2RlLm5vZGVzKTtcbiAgICBpZiAodHlwZSAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm4gYnVmO1xuICAgIH1cbiAgICByZXR1cm4gKFxuICAgICAgdmFsdWUgK1xuICAgICAgXCIoXCIgK1xuICAgICAgKG5vZGUuYmVmb3JlIHx8IFwiXCIpICtcbiAgICAgIGJ1ZiArXG4gICAgICAobm9kZS5hZnRlciB8fCBcIlwiKSArXG4gICAgICAobm9kZS51bmNsb3NlZCA/IFwiXCIgOiBcIilcIilcbiAgICApO1xuICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cblxuZnVuY3Rpb24gc3RyaW5naWZ5KG5vZGVzLCBjdXN0b20pIHtcbiAgdmFyIHJlc3VsdCwgaTtcblxuICBpZiAoQXJyYXkuaXNBcnJheShub2RlcykpIHtcbiAgICByZXN1bHQgPSBcIlwiO1xuICAgIGZvciAoaSA9IG5vZGVzLmxlbmd0aCAtIDE7IH5pOyBpIC09IDEpIHtcbiAgICAgIHJlc3VsdCA9IHN0cmluZ2lmeU5vZGUobm9kZXNbaV0sIGN1c3RvbSkgKyByZXN1bHQ7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgcmV0dXJuIHN0cmluZ2lmeU5vZGUobm9kZXMsIGN1c3RvbSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gc3RyaW5naWZ5O1xuIiwidmFyIG1pbnVzID0gXCItXCIuY2hhckNvZGVBdCgwKTtcbnZhciBwbHVzID0gXCIrXCIuY2hhckNvZGVBdCgwKTtcbnZhciBkb3QgPSBcIi5cIi5jaGFyQ29kZUF0KDApO1xudmFyIGV4cCA9IFwiZVwiLmNoYXJDb2RlQXQoMCk7XG52YXIgRVhQID0gXCJFXCIuY2hhckNvZGVBdCgwKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih2YWx1ZSkge1xuICB2YXIgcG9zID0gMDtcbiAgdmFyIGxlbmd0aCA9IHZhbHVlLmxlbmd0aDtcbiAgdmFyIGRvdHRlZCA9IGZhbHNlO1xuICB2YXIgc2NpUG9zID0gLTE7XG4gIHZhciBjb250YWluc051bWJlciA9IGZhbHNlO1xuICB2YXIgY29kZTtcblxuICB3aGlsZSAocG9zIDwgbGVuZ3RoKSB7XG4gICAgY29kZSA9IHZhbHVlLmNoYXJDb2RlQXQocG9zKTtcblxuICAgIGlmIChjb2RlID49IDQ4ICYmIGNvZGUgPD0gNTcpIHtcbiAgICAgIGNvbnRhaW5zTnVtYmVyID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGNvZGUgPT09IGV4cCB8fCBjb2RlID09PSBFWFApIHtcbiAgICAgIGlmIChzY2lQb3MgPiAtMSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHNjaVBvcyA9IHBvcztcbiAgICB9IGVsc2UgaWYgKGNvZGUgPT09IGRvdCkge1xuICAgICAgaWYgKGRvdHRlZCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGRvdHRlZCA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChjb2RlID09PSBwbHVzIHx8IGNvZGUgPT09IG1pbnVzKSB7XG4gICAgICBpZiAocG9zICE9PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICBwb3MgKz0gMTtcbiAgfVxuXG4gIGlmIChzY2lQb3MgKyAxID09PSBwb3MpIHBvcy0tO1xuXG4gIHJldHVybiBjb250YWluc051bWJlclxuICAgID8ge1xuICAgICAgICBudW1iZXI6IHZhbHVlLnNsaWNlKDAsIHBvcyksXG4gICAgICAgIHVuaXQ6IHZhbHVlLnNsaWNlKHBvcylcbiAgICAgIH1cbiAgICA6IGZhbHNlO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gd2Fsayhub2RlcywgY2IsIGJ1YmJsZSkge1xuICB2YXIgaSwgbWF4LCBub2RlLCByZXN1bHQ7XG5cbiAgZm9yIChpID0gMCwgbWF4ID0gbm9kZXMubGVuZ3RoOyBpIDwgbWF4OyBpICs9IDEpIHtcbiAgICBub2RlID0gbm9kZXNbaV07XG4gICAgaWYgKCFidWJibGUpIHtcbiAgICAgIHJlc3VsdCA9IGNiKG5vZGUsIGksIG5vZGVzKTtcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICByZXN1bHQgIT09IGZhbHNlICYmXG4gICAgICBub2RlLnR5cGUgPT09IFwiZnVuY3Rpb25cIiAmJlxuICAgICAgQXJyYXkuaXNBcnJheShub2RlLm5vZGVzKVxuICAgICkge1xuICAgICAgd2Fsayhub2RlLm5vZGVzLCBjYiwgYnViYmxlKTtcbiAgICB9XG5cbiAgICBpZiAoYnViYmxlKSB7XG4gICAgICBjYihub2RlLCBpLCBub2Rlcyk7XG4gICAgfVxuICB9XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3Bvc3Rjc3NWYWx1ZVBhcnNlciA9IHJlcXVpcmUoJ3Bvc3Rjc3MtdmFsdWUtcGFyc2VyJyk7XG5cbnZhciBfcG9zdGNzc1ZhbHVlUGFyc2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3Rjc3NWYWx1ZVBhcnNlcik7XG5cbnZhciBfcGFyc2VyID0gcmVxdWlyZSgnLi9wYXJzZXInKTtcblxudmFyIF9yZWR1Y2VyID0gcmVxdWlyZSgnLi9saWIvcmVkdWNlcicpO1xuXG52YXIgX3JlZHVjZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVkdWNlcik7XG5cbnZhciBfc3RyaW5naWZpZXIgPSByZXF1aXJlKCcuL2xpYi9zdHJpbmdpZmllcicpO1xuXG52YXIgX3N0cmluZ2lmaWVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmluZ2lmaWVyKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLy8gZXNsaW50LWRpc2FibGUtbGluZVxudmFyIE1BVENIX0NBTEMgPSAvKCg/OlxcLVthLXpdK1xcLSk/Y2FsYykvO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgdmFyIHByZWNpc2lvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogNTtcblxuICByZXR1cm4gKDAsIF9wb3N0Y3NzVmFsdWVQYXJzZXIyLmRlZmF1bHQpKHZhbHVlKS53YWxrKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgLy8gc2tpcCBhbnl0aGluZyB3aGljaCBpc24ndCBhIGNhbGMoKSBmdW5jdGlvblxuICAgIGlmIChub2RlLnR5cGUgIT09ICdmdW5jdGlvbicgfHwgIU1BVENIX0NBTEMudGVzdChub2RlLnZhbHVlKSkgcmV0dXJuO1xuXG4gICAgLy8gc3RyaW5naWZ5IGNhbGMgZXhwcmVzc2lvbiBhbmQgcHJvZHVjZSBhbiBBU1RcbiAgICB2YXIgY29udGVudHMgPSBfcG9zdGNzc1ZhbHVlUGFyc2VyMi5kZWZhdWx0LnN0cmluZ2lmeShub2RlLm5vZGVzKTtcblxuICAgIC8vIHNraXAgY29uc3RhbnQoKSBhbmQgZW52KClcbiAgICBpZiAoY29udGVudHMuaW5kZXhPZignY29uc3RhbnQnKSA+PSAwIHx8IGNvbnRlbnRzLmluZGV4T2YoJ2VudicpID49IDApIHJldHVybjtcblxuICAgIHZhciBhc3QgPSBfcGFyc2VyLnBhcnNlci5wYXJzZShjb250ZW50cyk7XG5cbiAgICAvLyByZWR1Y2UgQVNUIHRvIGl0cyBzaW1wbGVzdCBmb3JtLCB0aGF0IGlzLCBlaXRoZXIgdG8gYSBzaW5nbGUgdmFsdWVcbiAgICAvLyBvciBhIHNpbXBsaWZpZWQgY2FsYyBleHByZXNzaW9uXG4gICAgdmFyIHJlZHVjZWRBc3QgPSAoMCwgX3JlZHVjZXIyLmRlZmF1bHQpKGFzdCwgcHJlY2lzaW9uKTtcblxuICAgIC8vIHN0cmluZ2lmeSBBU1QgYW5kIHdyaXRlIGl0IGJhY2tcbiAgICBub2RlLnR5cGUgPSAnd29yZCc7XG4gICAgbm9kZS52YWx1ZSA9ICgwLCBfc3RyaW5naWZpZXIyLmRlZmF1bHQpKG5vZGUudmFsdWUsIHJlZHVjZWRBc3QsIHByZWNpc2lvbik7XG4gIH0sIHRydWUpLnRvU3RyaW5nKCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsiLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3NzVW5pdENvbnZlcnRlciA9IHJlcXVpcmUoJ2Nzcy11bml0LWNvbnZlcnRlcicpO1xuXG52YXIgX2Nzc1VuaXRDb252ZXJ0ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3NzVW5pdENvbnZlcnRlcik7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIGNvbnZlcnROb2RlcyhsZWZ0LCByaWdodCwgcHJlY2lzaW9uKSB7XG4gIHN3aXRjaCAobGVmdC50eXBlKSB7XG4gICAgY2FzZSAnTGVuZ3RoVmFsdWUnOlxuICAgIGNhc2UgJ0FuZ2xlVmFsdWUnOlxuICAgIGNhc2UgJ1RpbWVWYWx1ZSc6XG4gICAgY2FzZSAnRnJlcXVlbmN5VmFsdWUnOlxuICAgIGNhc2UgJ1Jlc29sdXRpb25WYWx1ZSc6XG4gICAgICByZXR1cm4gY29udmVydEFic29sdXRlTGVuZ3RoKGxlZnQsIHJpZ2h0LCBwcmVjaXNpb24pO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4geyBsZWZ0OiBsZWZ0LCByaWdodDogcmlnaHQgfTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjb252ZXJ0QWJzb2x1dGVMZW5ndGgobGVmdCwgcmlnaHQsIHByZWNpc2lvbikge1xuICBpZiAocmlnaHQudHlwZSA9PT0gbGVmdC50eXBlKSB7XG4gICAgcmlnaHQgPSB7XG4gICAgICB0eXBlOiBsZWZ0LnR5cGUsXG4gICAgICB2YWx1ZTogKDAsIF9jc3NVbml0Q29udmVydGVyMi5kZWZhdWx0KShyaWdodC52YWx1ZSwgcmlnaHQudW5pdCwgbGVmdC51bml0LCBwcmVjaXNpb24pLFxuICAgICAgdW5pdDogbGVmdC51bml0XG4gICAgfTtcbiAgfVxuICByZXR1cm4geyBsZWZ0OiBsZWZ0LCByaWdodDogcmlnaHQgfTtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gY29udmVydE5vZGVzO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107IiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5mbGlwID0gZmxpcDtcblxudmFyIF9jb252ZXJ0ID0gcmVxdWlyZSgnLi9jb252ZXJ0Jyk7XG5cbnZhciBfY29udmVydDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb252ZXJ0KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gcmVkdWNlKG5vZGUsIHByZWNpc2lvbikge1xuICBpZiAobm9kZS50eXBlID09PSBcIk1hdGhFeHByZXNzaW9uXCIpIHJldHVybiByZWR1Y2VNYXRoRXhwcmVzc2lvbihub2RlLCBwcmVjaXNpb24pO1xuXG4gIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiBpc0VxdWFsKGxlZnQsIHJpZ2h0KSB7XG4gIHJldHVybiBsZWZ0LnR5cGUgPT09IHJpZ2h0LnR5cGUgJiYgbGVmdC52YWx1ZSA9PT0gcmlnaHQudmFsdWU7XG59XG5cbmZ1bmN0aW9uIGlzVmFsdWVUeXBlKHR5cGUpIHtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSAnTGVuZ3RoVmFsdWUnOlxuICAgIGNhc2UgJ0FuZ2xlVmFsdWUnOlxuICAgIGNhc2UgJ1RpbWVWYWx1ZSc6XG4gICAgY2FzZSAnRnJlcXVlbmN5VmFsdWUnOlxuICAgIGNhc2UgJ1Jlc29sdXRpb25WYWx1ZSc6XG4gICAgY2FzZSAnRW1WYWx1ZSc6XG4gICAgY2FzZSAnRXhWYWx1ZSc6XG4gICAgY2FzZSAnQ2hWYWx1ZSc6XG4gICAgY2FzZSAnUmVtVmFsdWUnOlxuICAgIGNhc2UgJ1ZoVmFsdWUnOlxuICAgIGNhc2UgJ1Z3VmFsdWUnOlxuICAgIGNhc2UgJ1ZtaW5WYWx1ZSc6XG4gICAgY2FzZSAnVm1heFZhbHVlJzpcbiAgICBjYXNlICdQZXJjZW50YWdlVmFsdWUnOlxuICAgIGNhc2UgJ1ZhbHVlJzpcbiAgICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gY29udmVydE1hdGhFeHByZXNzaW9uKG5vZGUsIHByZWNpc2lvbikge1xuICB2YXIgbm9kZXMgPSAoMCwgX2NvbnZlcnQyLmRlZmF1bHQpKG5vZGUubGVmdCwgbm9kZS5yaWdodCwgcHJlY2lzaW9uKTtcbiAgdmFyIGxlZnQgPSByZWR1Y2Uobm9kZXMubGVmdCwgcHJlY2lzaW9uKTtcbiAgdmFyIHJpZ2h0ID0gcmVkdWNlKG5vZGVzLnJpZ2h0LCBwcmVjaXNpb24pO1xuXG4gIGlmIChsZWZ0LnR5cGUgPT09IFwiTWF0aEV4cHJlc3Npb25cIiAmJiByaWdodC50eXBlID09PSBcIk1hdGhFeHByZXNzaW9uXCIpIHtcblxuICAgIGlmIChsZWZ0Lm9wZXJhdG9yID09PSAnLycgJiYgcmlnaHQub3BlcmF0b3IgPT09ICcqJyB8fCBsZWZ0Lm9wZXJhdG9yID09PSAnLScgJiYgcmlnaHQub3BlcmF0b3IgPT09ICcrJyB8fCBsZWZ0Lm9wZXJhdG9yID09PSAnKicgJiYgcmlnaHQub3BlcmF0b3IgPT09ICcvJyB8fCBsZWZ0Lm9wZXJhdG9yID09PSAnKycgJiYgcmlnaHQub3BlcmF0b3IgPT09ICctJykge1xuXG4gICAgICBpZiAoaXNFcXVhbChsZWZ0LnJpZ2h0LCByaWdodC5yaWdodCkpIG5vZGVzID0gKDAsIF9jb252ZXJ0Mi5kZWZhdWx0KShsZWZ0LmxlZnQsIHJpZ2h0LmxlZnQsIHByZWNpc2lvbik7ZWxzZSBpZiAoaXNFcXVhbChsZWZ0LnJpZ2h0LCByaWdodC5sZWZ0KSkgbm9kZXMgPSAoMCwgX2NvbnZlcnQyLmRlZmF1bHQpKGxlZnQubGVmdCwgcmlnaHQucmlnaHQsIHByZWNpc2lvbik7XG5cbiAgICAgIGxlZnQgPSByZWR1Y2Uobm9kZXMubGVmdCwgcHJlY2lzaW9uKTtcbiAgICAgIHJpZ2h0ID0gcmVkdWNlKG5vZGVzLnJpZ2h0LCBwcmVjaXNpb24pO1xuICAgIH1cbiAgfVxuXG4gIG5vZGUubGVmdCA9IGxlZnQ7XG4gIG5vZGUucmlnaHQgPSByaWdodDtcbiAgcmV0dXJuIG5vZGU7XG59XG5cbmZ1bmN0aW9uIGZsaXAob3BlcmF0b3IpIHtcbiAgcmV0dXJuIG9wZXJhdG9yID09PSAnKycgPyAnLScgOiAnKyc7XG59XG5cbmZ1bmN0aW9uIGZsaXBWYWx1ZShub2RlKSB7XG4gIGlmIChpc1ZhbHVlVHlwZShub2RlLnR5cGUpKSBub2RlLnZhbHVlID0gLW5vZGUudmFsdWU7ZWxzZSBpZiAobm9kZS50eXBlID09ICdNYXRoRXhwcmVzc2lvbicpIHtcbiAgICBub2RlLmxlZnQgPSBmbGlwVmFsdWUobm9kZS5sZWZ0KTtcbiAgICBub2RlLnJpZ2h0ID0gZmxpcFZhbHVlKG5vZGUucmlnaHQpO1xuICB9XG4gIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiByZWR1Y2VBZGRTdWJFeHByZXNzaW9uKG5vZGUsIHByZWNpc2lvbikge1xuICB2YXIgX25vZGUgPSBub2RlLFxuICAgICAgbGVmdCA9IF9ub2RlLmxlZnQsXG4gICAgICByaWdodCA9IF9ub2RlLnJpZ2h0LFxuICAgICAgb3AgPSBfbm9kZS5vcGVyYXRvcjtcblxuXG4gIGlmIChsZWZ0LnR5cGUgPT09ICdDc3NWYXJpYWJsZScgfHwgcmlnaHQudHlwZSA9PT0gJ0Nzc1ZhcmlhYmxlJykgcmV0dXJuIG5vZGU7XG5cbiAgLy8gc29tZXRoaW5nICsgMCA9PiBzb21ldGhpbmdcbiAgLy8gc29tZXRoaW5nIC0gMCA9PiBzb21ldGhpbmdcbiAgaWYgKHJpZ2h0LnZhbHVlID09PSAwKSByZXR1cm4gbGVmdDtcblxuICAvLyAwICsgc29tZXRoaW5nID0+IHNvbWV0aGluZ1xuICBpZiAobGVmdC52YWx1ZSA9PT0gMCAmJiBvcCA9PT0gXCIrXCIpIHJldHVybiByaWdodDtcblxuICAvLyAwIC0gc29tZXRoaW5nID0+IC1zb21ldGhpbmdcbiAgaWYgKGxlZnQudmFsdWUgPT09IDAgJiYgb3AgPT09IFwiLVwiKSByZXR1cm4gZmxpcFZhbHVlKHJpZ2h0KTtcblxuICAvLyB2YWx1ZSArIHZhbHVlXG4gIC8vIHZhbHVlIC0gdmFsdWVcbiAgaWYgKGxlZnQudHlwZSA9PT0gcmlnaHQudHlwZSAmJiBpc1ZhbHVlVHlwZShsZWZ0LnR5cGUpKSB7XG4gICAgbm9kZSA9IE9iamVjdC5hc3NpZ24oe30sIGxlZnQpO1xuICAgIGlmIChvcCA9PT0gXCIrXCIpIG5vZGUudmFsdWUgPSBsZWZ0LnZhbHVlICsgcmlnaHQudmFsdWU7ZWxzZSBub2RlLnZhbHVlID0gbGVmdC52YWx1ZSAtIHJpZ2h0LnZhbHVlO1xuICB9XG5cbiAgLy8gdmFsdWUgPG9wPiAoZXhwcilcbiAgaWYgKGlzVmFsdWVUeXBlKGxlZnQudHlwZSkgJiYgKHJpZ2h0Lm9wZXJhdG9yID09PSAnKycgfHwgcmlnaHQub3BlcmF0b3IgPT09ICctJykgJiYgcmlnaHQudHlwZSA9PT0gJ01hdGhFeHByZXNzaW9uJykge1xuICAgIC8vIHZhbHVlICsgKHZhbHVlICsgc29tZXRoaW5nKSA9PiAodmFsdWUgKyB2YWx1ZSkgKyBzb21ldGhpbmdcbiAgICAvLyB2YWx1ZSArICh2YWx1ZSAtIHNvbWV0aGluZykgPT4gKHZhbHVlICsgdmFsdWUpIC0gc29tZXRoaW5nXG4gICAgLy8gdmFsdWUgLSAodmFsdWUgKyBzb21ldGhpbmcpID0+ICh2YWx1ZSAtIHZhbHVlKSAtIHNvbWV0aGluZ1xuICAgIC8vIHZhbHVlIC0gKHZhbHVlIC0gc29tZXRoaW5nKSA9PiAodmFsdWUgLSB2YWx1ZSkgKyBzb21ldGhpbmdcbiAgICBpZiAobGVmdC50eXBlID09PSByaWdodC5sZWZ0LnR5cGUpIHtcbiAgICAgIG5vZGUgPSBPYmplY3QuYXNzaWduKHt9LCBub2RlKTtcbiAgICAgIG5vZGUubGVmdCA9IHJlZHVjZSh7XG4gICAgICAgIHR5cGU6ICdNYXRoRXhwcmVzc2lvbicsXG4gICAgICAgIG9wZXJhdG9yOiBvcCxcbiAgICAgICAgbGVmdDogbGVmdCxcbiAgICAgICAgcmlnaHQ6IHJpZ2h0LmxlZnRcbiAgICAgIH0sIHByZWNpc2lvbik7XG4gICAgICBub2RlLnJpZ2h0ID0gcmlnaHQucmlnaHQ7XG4gICAgICBub2RlLm9wZXJhdG9yID0gb3AgPT09ICctJyA/IGZsaXAocmlnaHQub3BlcmF0b3IpIDogcmlnaHQub3BlcmF0b3I7XG4gICAgICByZXR1cm4gcmVkdWNlKG5vZGUsIHByZWNpc2lvbik7XG4gICAgfVxuICAgIC8vIHZhbHVlICsgKHNvbWV0aGluZyArIHZhbHVlKSA9PiAodmFsdWUgKyB2YWx1ZSkgKyBzb21ldGhpbmdcbiAgICAvLyB2YWx1ZSArIChzb21ldGhpbmcgLSB2YWx1ZSkgPT4gKHZhbHVlIC0gdmFsdWUpICsgc29tZXRoaW5nXG4gICAgLy8gdmFsdWUgLSAoc29tZXRoaW5nICsgdmFsdWUpID0+ICh2YWx1ZSAtIHZhbHVlKSAtIHNvbWV0aGluZ1xuICAgIC8vIHZhbHVlIC0gKHNvbWV0aGluZyAtIHZhbHVlKSA9PiAodmFsdWUgKyB2YWx1ZSkgLSBzb21ldGhpbmdcbiAgICBlbHNlIGlmIChsZWZ0LnR5cGUgPT09IHJpZ2h0LnJpZ2h0LnR5cGUpIHtcbiAgICAgICAgbm9kZSA9IE9iamVjdC5hc3NpZ24oe30sIG5vZGUpO1xuICAgICAgICBub2RlLmxlZnQgPSByZWR1Y2Uoe1xuICAgICAgICAgIHR5cGU6ICdNYXRoRXhwcmVzc2lvbicsXG4gICAgICAgICAgb3BlcmF0b3I6IG9wID09PSAnLScgPyBmbGlwKHJpZ2h0Lm9wZXJhdG9yKSA6IHJpZ2h0Lm9wZXJhdG9yLFxuICAgICAgICAgIGxlZnQ6IGxlZnQsXG4gICAgICAgICAgcmlnaHQ6IHJpZ2h0LnJpZ2h0XG4gICAgICAgIH0sIHByZWNpc2lvbik7XG4gICAgICAgIG5vZGUucmlnaHQgPSByaWdodC5sZWZ0O1xuICAgICAgICByZXR1cm4gcmVkdWNlKG5vZGUsIHByZWNpc2lvbik7XG4gICAgICB9XG4gIH1cblxuICAvLyAoZXhwcikgPG9wPiB2YWx1ZVxuICBpZiAobGVmdC50eXBlID09PSAnTWF0aEV4cHJlc3Npb24nICYmIChsZWZ0Lm9wZXJhdG9yID09PSAnKycgfHwgbGVmdC5vcGVyYXRvciA9PT0gJy0nKSAmJiBpc1ZhbHVlVHlwZShyaWdodC50eXBlKSkge1xuICAgIC8vICh2YWx1ZSArIHNvbWV0aGluZykgKyB2YWx1ZSA9PiAodmFsdWUgKyB2YWx1ZSkgKyBzb21ldGhpbmdcbiAgICAvLyAodmFsdWUgLSBzb21ldGhpbmcpICsgdmFsdWUgPT4gKHZhbHVlICsgdmFsdWUpIC0gc29tZXRoaW5nXG4gICAgLy8gKHZhbHVlICsgc29tZXRoaW5nKSAtIHZhbHVlID0+ICh2YWx1ZSAtIHZhbHVlKSArIHNvbWV0aGluZ1xuICAgIC8vICh2YWx1ZSAtIHNvbWV0aGluZykgLSB2YWx1ZSA9PiAodmFsdWUgLSB2YWx1ZSkgLSBzb21ldGhpbmdcbiAgICBpZiAocmlnaHQudHlwZSA9PT0gbGVmdC5sZWZ0LnR5cGUpIHtcbiAgICAgIG5vZGUgPSBPYmplY3QuYXNzaWduKHt9LCBsZWZ0KTtcbiAgICAgIG5vZGUubGVmdCA9IHJlZHVjZSh7XG4gICAgICAgIHR5cGU6ICdNYXRoRXhwcmVzc2lvbicsXG4gICAgICAgIG9wZXJhdG9yOiBvcCxcbiAgICAgICAgbGVmdDogbGVmdC5sZWZ0LFxuICAgICAgICByaWdodDogcmlnaHRcbiAgICAgIH0sIHByZWNpc2lvbik7XG4gICAgICByZXR1cm4gcmVkdWNlKG5vZGUsIHByZWNpc2lvbik7XG4gICAgfVxuICAgIC8vIChzb21ldGhpbmcgKyB2YWx1ZSkgKyB2YWx1ZSA9PiBzb21ldGhpbmcgKyAodmFsdWUgKyB2YWx1ZSlcbiAgICAvLyAoc29tZXRoaW5nIC0gdmFsdWUxKSArIHZhbHVlMiA9PiBzb21ldGhpbmcgLSAodmFsdWUyIC0gdmFsdWUxKVxuICAgIC8vIChzb21ldGhpbmcgKyB2YWx1ZSkgLSB2YWx1ZSA9PiBzb21ldGhpbmcgKyAodmFsdWUgLSB2YWx1ZSlcbiAgICAvLyAoc29tZXRoaW5nIC0gdmFsdWUpIC0gdmFsdWUgPT4gc29tZXRoaW5nIC0gKHZhbHVlICsgdmFsdWUpXG4gICAgZWxzZSBpZiAocmlnaHQudHlwZSA9PT0gbGVmdC5yaWdodC50eXBlKSB7XG4gICAgICAgIG5vZGUgPSBPYmplY3QuYXNzaWduKHt9LCBsZWZ0KTtcbiAgICAgICAgaWYgKGxlZnQub3BlcmF0b3IgPT09ICctJykge1xuICAgICAgICAgIG5vZGUucmlnaHQgPSByZWR1Y2Uoe1xuICAgICAgICAgICAgdHlwZTogJ01hdGhFeHByZXNzaW9uJyxcbiAgICAgICAgICAgIG9wZXJhdG9yOiBvcCA9PT0gJy0nID8gJysnIDogJy0nLFxuICAgICAgICAgICAgbGVmdDogcmlnaHQsXG4gICAgICAgICAgICByaWdodDogbGVmdC5yaWdodFxuICAgICAgICAgIH0sIHByZWNpc2lvbik7XG4gICAgICAgICAgbm9kZS5vcGVyYXRvciA9IG9wID09PSAnLScgPyAnLScgOiAnKyc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm9kZS5yaWdodCA9IHJlZHVjZSh7XG4gICAgICAgICAgICB0eXBlOiAnTWF0aEV4cHJlc3Npb24nLFxuICAgICAgICAgICAgb3BlcmF0b3I6IG9wLFxuICAgICAgICAgICAgbGVmdDogbGVmdC5yaWdodCxcbiAgICAgICAgICAgIHJpZ2h0OiByaWdodFxuICAgICAgICAgIH0sIHByZWNpc2lvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5vZGUucmlnaHQudmFsdWUgPCAwKSB7XG4gICAgICAgICAgbm9kZS5yaWdodC52YWx1ZSAqPSAtMTtcbiAgICAgICAgICBub2RlLm9wZXJhdG9yID0gbm9kZS5vcGVyYXRvciA9PT0gJy0nID8gJysnIDogJy0nO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWR1Y2Uobm9kZSwgcHJlY2lzaW9uKTtcbiAgICAgIH1cbiAgfVxuICByZXR1cm4gbm9kZTtcbn1cblxuZnVuY3Rpb24gcmVkdWNlRGl2aXNpb25FeHByZXNzaW9uKG5vZGUsIHByZWNpc2lvbikge1xuICBpZiAoIWlzVmFsdWVUeXBlKG5vZGUucmlnaHQudHlwZSkpIHJldHVybiBub2RlO1xuXG4gIGlmIChub2RlLnJpZ2h0LnR5cGUgIT09ICdWYWx1ZScpIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGRpdmlkZSBieSBcIicgKyBub2RlLnJpZ2h0LnVuaXQgKyAnXCIsIG51bWJlciBleHBlY3RlZCcpO1xuXG4gIGlmIChub2RlLnJpZ2h0LnZhbHVlID09PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBkaXZpZGUgYnkgemVybycpO1xuXG4gIC8vIChleHByKSAvIHZhbHVlXG4gIGlmIChub2RlLmxlZnQudHlwZSA9PT0gJ01hdGhFeHByZXNzaW9uJykge1xuICAgIGlmIChpc1ZhbHVlVHlwZShub2RlLmxlZnQubGVmdC50eXBlKSAmJiBpc1ZhbHVlVHlwZShub2RlLmxlZnQucmlnaHQudHlwZSkpIHtcbiAgICAgIG5vZGUubGVmdC5sZWZ0LnZhbHVlIC89IG5vZGUucmlnaHQudmFsdWU7XG4gICAgICBub2RlLmxlZnQucmlnaHQudmFsdWUgLz0gbm9kZS5yaWdodC52YWx1ZTtcbiAgICAgIHJldHVybiByZWR1Y2Uobm9kZS5sZWZ0LCBwcmVjaXNpb24pO1xuICAgIH1cbiAgICByZXR1cm4gbm9kZTtcbiAgfVxuICAvLyBzb21ldGhpbmcgLyB2YWx1ZVxuICBlbHNlIGlmIChpc1ZhbHVlVHlwZShub2RlLmxlZnQudHlwZSkpIHtcbiAgICAgIG5vZGUubGVmdC52YWx1ZSAvPSBub2RlLnJpZ2h0LnZhbHVlO1xuICAgICAgcmV0dXJuIG5vZGUubGVmdDtcbiAgICB9XG4gIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiByZWR1Y2VNdWx0aXBsaWNhdGlvbkV4cHJlc3Npb24obm9kZSkge1xuICAvLyAoZXhwcikgKiB2YWx1ZVxuICBpZiAobm9kZS5sZWZ0LnR5cGUgPT09ICdNYXRoRXhwcmVzc2lvbicgJiYgbm9kZS5yaWdodC50eXBlID09PSAnVmFsdWUnKSB7XG4gICAgaWYgKGlzVmFsdWVUeXBlKG5vZGUubGVmdC5sZWZ0LnR5cGUpICYmIGlzVmFsdWVUeXBlKG5vZGUubGVmdC5yaWdodC50eXBlKSkge1xuICAgICAgbm9kZS5sZWZ0LmxlZnQudmFsdWUgKj0gbm9kZS5yaWdodC52YWx1ZTtcbiAgICAgIG5vZGUubGVmdC5yaWdodC52YWx1ZSAqPSBub2RlLnJpZ2h0LnZhbHVlO1xuICAgICAgcmV0dXJuIG5vZGUubGVmdDtcbiAgICB9XG4gIH1cbiAgLy8gc29tZXRoaW5nICogdmFsdWVcbiAgZWxzZSBpZiAoaXNWYWx1ZVR5cGUobm9kZS5sZWZ0LnR5cGUpICYmIG5vZGUucmlnaHQudHlwZSA9PT0gJ1ZhbHVlJykge1xuICAgICAgbm9kZS5sZWZ0LnZhbHVlICo9IG5vZGUucmlnaHQudmFsdWU7XG4gICAgICByZXR1cm4gbm9kZS5sZWZ0O1xuICAgIH1cbiAgICAvLyB2YWx1ZSAqIChleHByKVxuICAgIGVsc2UgaWYgKG5vZGUubGVmdC50eXBlID09PSAnVmFsdWUnICYmIG5vZGUucmlnaHQudHlwZSA9PT0gJ01hdGhFeHByZXNzaW9uJykge1xuICAgICAgICBpZiAoaXNWYWx1ZVR5cGUobm9kZS5yaWdodC5sZWZ0LnR5cGUpICYmIGlzVmFsdWVUeXBlKG5vZGUucmlnaHQucmlnaHQudHlwZSkpIHtcbiAgICAgICAgICBub2RlLnJpZ2h0LmxlZnQudmFsdWUgKj0gbm9kZS5sZWZ0LnZhbHVlO1xuICAgICAgICAgIG5vZGUucmlnaHQucmlnaHQudmFsdWUgKj0gbm9kZS5sZWZ0LnZhbHVlO1xuICAgICAgICAgIHJldHVybiBub2RlLnJpZ2h0O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyB2YWx1ZSAqIHNvbWV0aGluZ1xuICAgICAgZWxzZSBpZiAobm9kZS5sZWZ0LnR5cGUgPT09ICdWYWx1ZScgJiYgaXNWYWx1ZVR5cGUobm9kZS5yaWdodC50eXBlKSkge1xuICAgICAgICAgIG5vZGUucmlnaHQudmFsdWUgKj0gbm9kZS5sZWZ0LnZhbHVlO1xuICAgICAgICAgIHJldHVybiBub2RlLnJpZ2h0O1xuICAgICAgICB9XG4gIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiByZWR1Y2VNYXRoRXhwcmVzc2lvbihub2RlLCBwcmVjaXNpb24pIHtcbiAgbm9kZSA9IGNvbnZlcnRNYXRoRXhwcmVzc2lvbihub2RlLCBwcmVjaXNpb24pO1xuXG4gIHN3aXRjaCAobm9kZS5vcGVyYXRvcikge1xuICAgIGNhc2UgXCIrXCI6XG4gICAgY2FzZSBcIi1cIjpcbiAgICAgIHJldHVybiByZWR1Y2VBZGRTdWJFeHByZXNzaW9uKG5vZGUsIHByZWNpc2lvbik7XG4gICAgY2FzZSBcIi9cIjpcbiAgICAgIHJldHVybiByZWR1Y2VEaXZpc2lvbkV4cHJlc3Npb24obm9kZSwgcHJlY2lzaW9uKTtcbiAgICBjYXNlIFwiKlwiOlxuICAgICAgcmV0dXJuIHJlZHVjZU11bHRpcGxpY2F0aW9uRXhwcmVzc2lvbihub2RlKTtcbiAgfVxuICByZXR1cm4gbm9kZTtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gcmVkdWNlOyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoY2FsYywgbm9kZSwgcHJlY2lzaW9uKSB7XG4gIHZhciBzdHIgPSBzdHJpbmdpZnkobm9kZSwgcHJlY2lzaW9uKTtcblxuICBpZiAobm9kZS50eXBlID09PSBcIk1hdGhFeHByZXNzaW9uXCIpIHtcbiAgICAvLyBpZiBjYWxjIGV4cHJlc3Npb24gY291bGRuJ3QgYmUgcmVzb2x2ZWQgdG8gYSBzaW5nbGUgdmFsdWUsIHJlLXdyYXAgaXQgYXNcbiAgICAvLyBhIGNhbGMoKVxuICAgIHN0ciA9IGNhbGMgKyBcIihcIiArIHN0ciArIFwiKVwiO1xuICB9XG4gIHJldHVybiBzdHI7XG59O1xuXG52YXIgX3JlZHVjZXIgPSByZXF1aXJlKFwiLi9yZWR1Y2VyXCIpO1xuXG52YXIgb3JkZXIgPSB7XG4gIFwiKlwiOiAwLFxuICBcIi9cIjogMCxcbiAgXCIrXCI6IDEsXG4gIFwiLVwiOiAxXG59O1xuXG5mdW5jdGlvbiByb3VuZCh2YWx1ZSwgcHJlYykge1xuICBpZiAocHJlYyAhPT0gZmFsc2UpIHtcbiAgICB2YXIgcHJlY2lzaW9uID0gTWF0aC5wb3coMTAsIHByZWMpO1xuICAgIHJldHVybiBNYXRoLnJvdW5kKHZhbHVlICogcHJlY2lzaW9uKSAvIHByZWNpc2lvbjtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbmZ1bmN0aW9uIHN0cmluZ2lmeShub2RlLCBwcmVjKSB7XG4gIHN3aXRjaCAobm9kZS50eXBlKSB7XG4gICAgY2FzZSBcIk1hdGhFeHByZXNzaW9uXCI6XG4gICAgICB7XG4gICAgICAgIHZhciBsZWZ0ID0gbm9kZS5sZWZ0LFxuICAgICAgICAgICAgcmlnaHQgPSBub2RlLnJpZ2h0LFxuICAgICAgICAgICAgb3AgPSBub2RlLm9wZXJhdG9yO1xuXG4gICAgICAgIHZhciBzdHIgPSBcIlwiO1xuXG4gICAgICAgIGlmIChsZWZ0LnR5cGUgPT09ICdNYXRoRXhwcmVzc2lvbicgJiYgb3JkZXJbb3BdIDwgb3JkZXJbbGVmdC5vcGVyYXRvcl0pIHN0ciArPSBcIihcIiArIHN0cmluZ2lmeShsZWZ0LCBwcmVjKSArIFwiKVwiO2Vsc2Ugc3RyICs9IHN0cmluZ2lmeShsZWZ0LCBwcmVjKTtcblxuICAgICAgICBzdHIgKz0gXCIgXCIgKyBub2RlLm9wZXJhdG9yICsgXCIgXCI7XG5cbiAgICAgICAgaWYgKHJpZ2h0LnR5cGUgPT09ICdNYXRoRXhwcmVzc2lvbicgJiYgb3JkZXJbb3BdIDwgb3JkZXJbcmlnaHQub3BlcmF0b3JdKSBzdHIgKz0gXCIoXCIgKyBzdHJpbmdpZnkocmlnaHQsIHByZWMpICsgXCIpXCI7ZWxzZSBpZiAocmlnaHQudHlwZSA9PT0gJ01hdGhFeHByZXNzaW9uJyAmJiBvcCA9PT0gXCItXCIgJiYgW1wiK1wiLCBcIi1cIl0uaW5jbHVkZXMocmlnaHQub3BlcmF0b3IpKSB7XG4gICAgICAgICAgLy8gZml4ICM1MiA6IGEtKGIrYykgPSBhLWItY1xuICAgICAgICAgIHJpZ2h0Lm9wZXJhdG9yID0gKDAsIF9yZWR1Y2VyLmZsaXApKHJpZ2h0Lm9wZXJhdG9yKTtcbiAgICAgICAgICBzdHIgKz0gc3RyaW5naWZ5KHJpZ2h0LCBwcmVjKTtcbiAgICAgICAgfSBlbHNlIHN0ciArPSBzdHJpbmdpZnkocmlnaHQsIHByZWMpO1xuXG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgICB9XG4gICAgY2FzZSBcIlZhbHVlXCI6XG4gICAgICByZXR1cm4gcm91bmQobm9kZS52YWx1ZSwgcHJlYyk7XG4gICAgY2FzZSAnQ3NzVmFyaWFibGUnOlxuICAgICAgcmV0dXJuIG5vZGUudmFsdWU7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiByb3VuZChub2RlLnZhbHVlLCBwcmVjKSArIG5vZGUudW5pdDtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdOyIsIi8qIHBhcnNlciBnZW5lcmF0ZWQgYnkgamlzb24gMC40LjE4ICovXG4vKlxuICBSZXR1cm5zIGEgUGFyc2VyIG9iamVjdCBvZiB0aGUgZm9sbG93aW5nIHN0cnVjdHVyZTpcblxuICBQYXJzZXI6IHtcbiAgICB5eToge31cbiAgfVxuXG4gIFBhcnNlci5wcm90b3R5cGU6IHtcbiAgICB5eToge30sXG4gICAgdHJhY2U6IGZ1bmN0aW9uKCksXG4gICAgc3ltYm9sc186IHthc3NvY2lhdGl2ZSBsaXN0OiBuYW1lID09PiBudW1iZXJ9LFxuICAgIHRlcm1pbmFsc186IHthc3NvY2lhdGl2ZSBsaXN0OiBudW1iZXIgPT0+IG5hbWV9LFxuICAgIHByb2R1Y3Rpb25zXzogWy4uLl0sXG4gICAgcGVyZm9ybUFjdGlvbjogZnVuY3Rpb24gYW5vbnltb3VzKHl5dGV4dCwgeXlsZW5nLCB5eWxpbmVubywgeXksIHl5c3RhdGUsICQkLCBfJCksXG4gICAgdGFibGU6IFsuLi5dLFxuICAgIGRlZmF1bHRBY3Rpb25zOiB7Li4ufSxcbiAgICBwYXJzZUVycm9yOiBmdW5jdGlvbihzdHIsIGhhc2gpLFxuICAgIHBhcnNlOiBmdW5jdGlvbihpbnB1dCksXG5cbiAgICBsZXhlcjoge1xuICAgICAgICBFT0Y6IDEsXG4gICAgICAgIHBhcnNlRXJyb3I6IGZ1bmN0aW9uKHN0ciwgaGFzaCksXG4gICAgICAgIHNldElucHV0OiBmdW5jdGlvbihpbnB1dCksXG4gICAgICAgIGlucHV0OiBmdW5jdGlvbigpLFxuICAgICAgICB1bnB1dDogZnVuY3Rpb24oc3RyKSxcbiAgICAgICAgbW9yZTogZnVuY3Rpb24oKSxcbiAgICAgICAgbGVzczogZnVuY3Rpb24obiksXG4gICAgICAgIHBhc3RJbnB1dDogZnVuY3Rpb24oKSxcbiAgICAgICAgdXBjb21pbmdJbnB1dDogZnVuY3Rpb24oKSxcbiAgICAgICAgc2hvd1Bvc2l0aW9uOiBmdW5jdGlvbigpLFxuICAgICAgICB0ZXN0X21hdGNoOiBmdW5jdGlvbihyZWdleF9tYXRjaF9hcnJheSwgcnVsZV9pbmRleCksXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uKCksXG4gICAgICAgIGxleDogZnVuY3Rpb24oKSxcbiAgICAgICAgYmVnaW46IGZ1bmN0aW9uKGNvbmRpdGlvbiksXG4gICAgICAgIHBvcFN0YXRlOiBmdW5jdGlvbigpLFxuICAgICAgICBfY3VycmVudFJ1bGVzOiBmdW5jdGlvbigpLFxuICAgICAgICB0b3BTdGF0ZTogZnVuY3Rpb24oKSxcbiAgICAgICAgcHVzaFN0YXRlOiBmdW5jdGlvbihjb25kaXRpb24pLFxuXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgIHJhbmdlczogYm9vbGVhbiAgICAgICAgICAgKG9wdGlvbmFsOiB0cnVlID09PiB0b2tlbiBsb2NhdGlvbiBpbmZvIHdpbGwgaW5jbHVkZSBhIC5yYW5nZVtdIG1lbWJlcilcbiAgICAgICAgICAgIGZsZXg6IGJvb2xlYW4gICAgICAgICAgICAgKG9wdGlvbmFsOiB0cnVlID09PiBmbGV4LWxpa2UgbGV4aW5nIGJlaGF2aW91ciB3aGVyZSB0aGUgcnVsZXMgYXJlIHRlc3RlZCBleGhhdXN0aXZlbHkgdG8gZmluZCB0aGUgbG9uZ2VzdCBtYXRjaClcbiAgICAgICAgICAgIGJhY2t0cmFja19sZXhlcjogYm9vbGVhbiAgKG9wdGlvbmFsOiB0cnVlID09PiBsZXhlciByZWdleGVzIGFyZSB0ZXN0ZWQgaW4gb3JkZXIgYW5kIGZvciBlYWNoIG1hdGNoaW5nIHJlZ2V4IHRoZSBhY3Rpb24gY29kZSBpcyBpbnZva2VkOyB0aGUgbGV4ZXIgdGVybWluYXRlcyB0aGUgc2NhbiB3aGVuIGEgdG9rZW4gaXMgcmV0dXJuZWQgYnkgdGhlIGFjdGlvbiBjb2RlKVxuICAgICAgICB9LFxuXG4gICAgICAgIHBlcmZvcm1BY3Rpb246IGZ1bmN0aW9uKHl5LCB5eV8sICRhdm9pZGluZ19uYW1lX2NvbGxpc2lvbnMsIFlZX1NUQVJUKSxcbiAgICAgICAgcnVsZXM6IFsuLi5dLFxuICAgICAgICBjb25kaXRpb25zOiB7YXNzb2NpYXRpdmUgbGlzdDogbmFtZSA9PT4gc2V0fSxcbiAgICB9XG4gIH1cblxuXG4gIHRva2VuIGxvY2F0aW9uIGluZm8gKEAkLCBfJCwgZXRjLik6IHtcbiAgICBmaXJzdF9saW5lOiBuLFxuICAgIGxhc3RfbGluZTogbixcbiAgICBmaXJzdF9jb2x1bW46IG4sXG4gICAgbGFzdF9jb2x1bW46IG4sXG4gICAgcmFuZ2U6IFtzdGFydF9udW1iZXIsIGVuZF9udW1iZXJdICAgICAgICh3aGVyZSB0aGUgbnVtYmVycyBhcmUgaW5kZXhlcyBpbnRvIHRoZSBpbnB1dCBzdHJpbmcsIHJlZ3VsYXIgemVyby1iYXNlZClcbiAgfVxuXG5cbiAgdGhlIHBhcnNlRXJyb3IgZnVuY3Rpb24gcmVjZWl2ZXMgYSAnaGFzaCcgb2JqZWN0IHdpdGggdGhlc2UgbWVtYmVycyBmb3IgbGV4ZXIgYW5kIHBhcnNlciBlcnJvcnM6IHtcbiAgICB0ZXh0OiAgICAgICAgKG1hdGNoZWQgdGV4dClcbiAgICB0b2tlbjogICAgICAgKHRoZSBwcm9kdWNlZCB0ZXJtaW5hbCB0b2tlbiwgaWYgYW55KVxuICAgIGxpbmU6ICAgICAgICAoeXlsaW5lbm8pXG4gIH1cbiAgd2hpbGUgcGFyc2VyIChncmFtbWFyKSBlcnJvcnMgd2lsbCBhbHNvIHByb3ZpZGUgdGhlc2UgbWVtYmVycywgaS5lLiBwYXJzZXIgZXJyb3JzIGRlbGl2ZXIgYSBzdXBlcnNldCBvZiBhdHRyaWJ1dGVzOiB7XG4gICAgbG9jOiAgICAgICAgICh5eWxsb2MpXG4gICAgZXhwZWN0ZWQ6ICAgIChzdHJpbmcgZGVzY3JpYmluZyB0aGUgc2V0IG9mIGV4cGVjdGVkIHRva2VucylcbiAgICByZWNvdmVyYWJsZTogKGJvb2xlYW46IFRSVUUgd2hlbiB0aGUgcGFyc2VyIGhhcyBhIGVycm9yIHJlY292ZXJ5IHJ1bGUgYXZhaWxhYmxlIGZvciB0aGlzIHBhcnRpY3VsYXIgZXJyb3IpXG4gIH1cbiovXG52YXIgcGFyc2VyID0gKGZ1bmN0aW9uKCl7XG52YXIgbz1mdW5jdGlvbihrLHYsbyxsKXtmb3Iobz1vfHx7fSxsPWsubGVuZ3RoO2wtLTtvW2tbbF1dPXYpO3JldHVybiBvfSwkVjA9WzEsNV0sJFYxPVsxLDNdLCRWMj1bMSw0XSwkVjM9WzEsMjRdLCRWND1bMSw5XSwkVjU9WzEsMTBdLCRWNj1bMSwxMV0sJFY3PVsxLDEyXSwkVjg9WzEsMTNdLCRWOT1bMSwxNF0sJFZhPVsxLDE1XSwkVmI9WzEsMTZdLCRWYz1bMSwxN10sJFZkPVsxLDE4XSwkVmU9WzEsMTldLCRWZj1bMSwyMF0sJFZnPVsxLDIxXSwkVmg9WzEsMjJdLCRWaT1bMSwyM10sJFZqPVsxLDI2XSwkVms9WzEsMjddLCRWbD1bMSwyOF0sJFZtPVsxLDI5XSwkVm49WzEsMzVdLCRWbz1bNSw2LDcsOCw5LDExXSwkVnA9WzUsNiw3LDExXTtcbnZhciBwYXJzZXIgPSB7dHJhY2U6IGZ1bmN0aW9uIHRyYWNlKCkgeyB9LFxueXk6IHt9LFxuc3ltYm9sc186IHtcImVycm9yXCI6MixcImV4cHJlc3Npb25cIjozLFwibWF0aF9leHByZXNzaW9uXCI6NCxcIkVPRlwiOjUsXCJBRERcIjo2LFwiU1VCXCI6NyxcIk1VTFwiOjgsXCJESVZcIjo5LFwiTFBBUkVOXCI6MTAsXCJSUEFSRU5cIjoxMSxcIk5FU1RFRF9DQUxDXCI6MTIsXCJQUkVGSVhcIjoxMyxcImNzc192YXJpYWJsZVwiOjE0LFwiY3NzX3ZhbHVlXCI6MTUsXCJ2YWx1ZVwiOjE2LFwiTlVNQkVSXCI6MTcsXCJDU1NfVkFSXCI6MTgsXCJMRU5HVEhcIjoxOSxcIkFOR0xFXCI6MjAsXCJUSU1FXCI6MjEsXCJGUkVRXCI6MjIsXCJSRVNcIjoyMyxcIkVNU1wiOjI0LFwiRVhTXCI6MjUsXCJDSFNcIjoyNixcIlJFTVNcIjoyNyxcIlZIU1wiOjI4LFwiVldTXCI6MjksXCJWTUlOU1wiOjMwLFwiVk1BWFNcIjozMSxcIlBFUkNFTlRBR0VcIjozMixcIiRhY2NlcHRcIjowLFwiJGVuZFwiOjF9LFxudGVybWluYWxzXzogezI6XCJlcnJvclwiLDU6XCJFT0ZcIiw2OlwiQUREXCIsNzpcIlNVQlwiLDg6XCJNVUxcIiw5OlwiRElWXCIsMTA6XCJMUEFSRU5cIiwxMTpcIlJQQVJFTlwiLDEyOlwiTkVTVEVEX0NBTENcIiwxMzpcIlBSRUZJWFwiLDE3OlwiTlVNQkVSXCIsMTg6XCJDU1NfVkFSXCIsMTk6XCJMRU5HVEhcIiwyMDpcIkFOR0xFXCIsMjE6XCJUSU1FXCIsMjI6XCJGUkVRXCIsMjM6XCJSRVNcIiwyNDpcIkVNU1wiLDI1OlwiRVhTXCIsMjY6XCJDSFNcIiwyNzpcIlJFTVNcIiwyODpcIlZIU1wiLDI5OlwiVldTXCIsMzA6XCJWTUlOU1wiLDMxOlwiVk1BWFNcIiwzMjpcIlBFUkNFTlRBR0VcIn0sXG5wcm9kdWN0aW9uc186IFswLFszLDJdLFs0LDNdLFs0LDNdLFs0LDNdLFs0LDNdLFs0LDNdLFs0LDRdLFs0LDddLFs0LDFdLFs0LDFdLFs0LDFdLFsxNiwxXSxbMTYsMl0sWzE0LDFdLFsxNSwxXSxbMTUsMV0sWzE1LDFdLFsxNSwxXSxbMTUsMV0sWzE1LDFdLFsxNSwxXSxbMTUsMV0sWzE1LDFdLFsxNSwxXSxbMTUsMV0sWzE1LDFdLFsxNSwxXSxbMTUsMV0sWzE1LDJdXSxcbnBlcmZvcm1BY3Rpb246IGZ1bmN0aW9uIGFub255bW91cyh5eXRleHQsIHl5bGVuZywgeXlsaW5lbm8sIHl5LCB5eXN0YXRlIC8qIGFjdGlvblsxXSAqLywgJCQgLyogdnN0YWNrICovLCBfJCAvKiBsc3RhY2sgKi8pIHtcbi8qIHRoaXMgPT0geXl2YWwgKi9cblxudmFyICQwID0gJCQubGVuZ3RoIC0gMTtcbnN3aXRjaCAoeXlzdGF0ZSkge1xuY2FzZSAxOlxuIHJldHVybiAkJFskMC0xXTsgXG5icmVhaztcbmNhc2UgMjogY2FzZSAzOiBjYXNlIDQ6IGNhc2UgNTpcbiB0aGlzLiQgPSB7IHR5cGU6ICdNYXRoRXhwcmVzc2lvbicsIG9wZXJhdG9yOiAkJFskMC0xXSwgbGVmdDogJCRbJDAtMl0sIHJpZ2h0OiAkJFskMF0gfTsgXG5icmVhaztcbmNhc2UgNjogY2FzZSA3OiBjYXNlIDg6XG4gdGhpcy4kID0gJCRbJDAtMV07IFxuYnJlYWs7XG5jYXNlIDk6IGNhc2UgMTA6IGNhc2UgMTE6XG4gdGhpcy4kID0gJCRbJDBdOyBcbmJyZWFrO1xuY2FzZSAxMjpcbiB0aGlzLiQgPSB7IHR5cGU6ICdWYWx1ZScsIHZhbHVlOiBwYXJzZUZsb2F0KCQkWyQwXSkgfTsgXG5icmVhaztcbmNhc2UgMTM6XG4gdGhpcy4kID0geyB0eXBlOiAnVmFsdWUnLCB2YWx1ZTogcGFyc2VGbG9hdCgkJFskMF0pICogLTEgfTsgXG5icmVhaztcbmNhc2UgMTQ6XG4gdGhpcy4kID0geyB0eXBlOiAnQ3NzVmFyaWFibGUnLCB2YWx1ZTogJCRbJDBdIH07IFxuYnJlYWs7XG5jYXNlIDE1OlxuIHRoaXMuJCA9IHsgdHlwZTogJ0xlbmd0aFZhbHVlJywgdmFsdWU6IHBhcnNlRmxvYXQoJCRbJDBdKSwgdW5pdDogL1thLXpdKy8uZXhlYygkJFskMF0pWzBdIH07IFxuYnJlYWs7XG5jYXNlIDE2OlxuIHRoaXMuJCA9IHsgdHlwZTogJ0FuZ2xlVmFsdWUnLCB2YWx1ZTogcGFyc2VGbG9hdCgkJFskMF0pLCB1bml0OiAvW2Etel0rLy5leGVjKCQkWyQwXSlbMF0gfTsgXG5icmVhaztcbmNhc2UgMTc6XG4gdGhpcy4kID0geyB0eXBlOiAnVGltZVZhbHVlJywgdmFsdWU6IHBhcnNlRmxvYXQoJCRbJDBdKSwgdW5pdDogL1thLXpdKy8uZXhlYygkJFskMF0pWzBdIH07IFxuYnJlYWs7XG5jYXNlIDE4OlxuIHRoaXMuJCA9IHsgdHlwZTogJ0ZyZXF1ZW5jeVZhbHVlJywgdmFsdWU6IHBhcnNlRmxvYXQoJCRbJDBdKSwgdW5pdDogL1thLXpdKy8uZXhlYygkJFskMF0pWzBdIH07IFxuYnJlYWs7XG5jYXNlIDE5OlxuIHRoaXMuJCA9IHsgdHlwZTogJ1Jlc29sdXRpb25WYWx1ZScsIHZhbHVlOiBwYXJzZUZsb2F0KCQkWyQwXSksIHVuaXQ6IC9bYS16XSsvLmV4ZWMoJCRbJDBdKVswXSB9OyBcbmJyZWFrO1xuY2FzZSAyMDpcbiB0aGlzLiQgPSB7IHR5cGU6ICdFbVZhbHVlJywgdmFsdWU6IHBhcnNlRmxvYXQoJCRbJDBdKSwgdW5pdDogJ2VtJyB9OyBcbmJyZWFrO1xuY2FzZSAyMTpcbiB0aGlzLiQgPSB7IHR5cGU6ICdFeFZhbHVlJywgdmFsdWU6IHBhcnNlRmxvYXQoJCRbJDBdKSwgdW5pdDogJ2V4JyB9OyBcbmJyZWFrO1xuY2FzZSAyMjpcbiB0aGlzLiQgPSB7IHR5cGU6ICdDaFZhbHVlJywgdmFsdWU6IHBhcnNlRmxvYXQoJCRbJDBdKSwgdW5pdDogJ2NoJyB9OyBcbmJyZWFrO1xuY2FzZSAyMzpcbiB0aGlzLiQgPSB7IHR5cGU6ICdSZW1WYWx1ZScsIHZhbHVlOiBwYXJzZUZsb2F0KCQkWyQwXSksIHVuaXQ6ICdyZW0nIH07IFxuYnJlYWs7XG5jYXNlIDI0OlxuIHRoaXMuJCA9IHsgdHlwZTogJ1ZoVmFsdWUnLCB2YWx1ZTogcGFyc2VGbG9hdCgkJFskMF0pLCB1bml0OiAndmgnIH07IFxuYnJlYWs7XG5jYXNlIDI1OlxuIHRoaXMuJCA9IHsgdHlwZTogJ1Z3VmFsdWUnLCB2YWx1ZTogcGFyc2VGbG9hdCgkJFskMF0pLCB1bml0OiAndncnIH07IFxuYnJlYWs7XG5jYXNlIDI2OlxuIHRoaXMuJCA9IHsgdHlwZTogJ1ZtaW5WYWx1ZScsIHZhbHVlOiBwYXJzZUZsb2F0KCQkWyQwXSksIHVuaXQ6ICd2bWluJyB9OyBcbmJyZWFrO1xuY2FzZSAyNzpcbiB0aGlzLiQgPSB7IHR5cGU6ICdWbWF4VmFsdWUnLCB2YWx1ZTogcGFyc2VGbG9hdCgkJFskMF0pLCB1bml0OiAndm1heCcgfTsgXG5icmVhaztcbmNhc2UgMjg6XG4gdGhpcy4kID0geyB0eXBlOiAnUGVyY2VudGFnZVZhbHVlJywgdmFsdWU6IHBhcnNlRmxvYXQoJCRbJDBdKSwgdW5pdDogJyUnIH07IFxuYnJlYWs7XG5jYXNlIDI5OlxuIHZhciBwcmV2ID0gJCRbJDBdOyBwcmV2LnZhbHVlICo9IC0xOyB0aGlzLiQgPSBwcmV2OyBcbmJyZWFrO1xufVxufSxcbnRhYmxlOiBbezM6MSw0OjIsNzokVjAsMTA6JFYxLDEyOiRWMiwxNDo2LDE1OjcsMTY6OCwxNzokVjMsMTg6JFY0LDE5OiRWNSwyMDokVjYsMjE6JFY3LDIyOiRWOCwyMzokVjksMjQ6JFZhLDI1OiRWYiwyNjokVmMsMjc6JFZkLDI4OiRWZSwyOTokVmYsMzA6JFZnLDMxOiRWaCwzMjokVml9LHsxOlszXX0sezU6WzEsMjVdLDY6JFZqLDc6JFZrLDg6JFZsLDk6JFZtfSx7NDozMCw3OiRWMCwxMDokVjEsMTI6JFYyLDE0OjYsMTU6NywxNjo4LDE3OiRWMywxODokVjQsMTk6JFY1LDIwOiRWNiwyMTokVjcsMjI6JFY4LDIzOiRWOSwyNDokVmEsMjU6JFZiLDI2OiRWYywyNzokVmQsMjg6JFZlLDI5OiRWZiwzMDokVmcsMzE6JFZoLDMyOiRWaX0sezEwOlsxLDMxXX0sezc6JFZuLDEzOlsxLDMyXSwxNTozMywxNzpbMSwzNF0sMTk6JFY1LDIwOiRWNiwyMTokVjcsMjI6JFY4LDIzOiRWOSwyNDokVmEsMjU6JFZiLDI2OiRWYywyNzokVmQsMjg6JFZlLDI5OiRWZiwzMDokVmcsMzE6JFZoLDMyOiRWaX0sbygkVm8sWzIsOV0pLG8oJFZvLFsyLDEwXSksbygkVm8sWzIsMTFdKSxvKCRWbyxbMiwxNF0pLG8oJFZvLFsyLDE1XSksbygkVm8sWzIsMTZdKSxvKCRWbyxbMiwxN10pLG8oJFZvLFsyLDE4XSksbygkVm8sWzIsMTldKSxvKCRWbyxbMiwyMF0pLG8oJFZvLFsyLDIxXSksbygkVm8sWzIsMjJdKSxvKCRWbyxbMiwyM10pLG8oJFZvLFsyLDI0XSksbygkVm8sWzIsMjVdKSxvKCRWbyxbMiwyNl0pLG8oJFZvLFsyLDI3XSksbygkVm8sWzIsMjhdKSxvKCRWbyxbMiwxMl0pLHsxOlsyLDFdfSx7NDozNiw3OiRWMCwxMDokVjEsMTI6JFYyLDE0OjYsMTU6NywxNjo4LDE3OiRWMywxODokVjQsMTk6JFY1LDIwOiRWNiwyMTokVjcsMjI6JFY4LDIzOiRWOSwyNDokVmEsMjU6JFZiLDI2OiRWYywyNzokVmQsMjg6JFZlLDI5OiRWZiwzMDokVmcsMzE6JFZoLDMyOiRWaX0sezQ6MzcsNzokVjAsMTA6JFYxLDEyOiRWMiwxNDo2LDE1OjcsMTY6OCwxNzokVjMsMTg6JFY0LDE5OiRWNSwyMDokVjYsMjE6JFY3LDIyOiRWOCwyMzokVjksMjQ6JFZhLDI1OiRWYiwyNjokVmMsMjc6JFZkLDI4OiRWZSwyOTokVmYsMzA6JFZnLDMxOiRWaCwzMjokVml9LHs0OjM4LDc6JFYwLDEwOiRWMSwxMjokVjIsMTQ6NiwxNTo3LDE2OjgsMTc6JFYzLDE4OiRWNCwxOTokVjUsMjA6JFY2LDIxOiRWNywyMjokVjgsMjM6JFY5LDI0OiRWYSwyNTokVmIsMjY6JFZjLDI3OiRWZCwyODokVmUsMjk6JFZmLDMwOiRWZywzMTokVmgsMzI6JFZpfSx7NDozOSw3OiRWMCwxMDokVjEsMTI6JFYyLDE0OjYsMTU6NywxNjo4LDE3OiRWMywxODokVjQsMTk6JFY1LDIwOiRWNiwyMTokVjcsMjI6JFY4LDIzOiRWOSwyNDokVmEsMjU6JFZiLDI2OiRWYywyNzokVmQsMjg6JFZlLDI5OiRWZiwzMDokVmcsMzE6JFZoLDMyOiRWaX0sezY6JFZqLDc6JFZrLDg6JFZsLDk6JFZtLDExOlsxLDQwXX0sezQ6NDEsNzokVjAsMTA6JFYxLDEyOiRWMiwxNDo2LDE1OjcsMTY6OCwxNzokVjMsMTg6JFY0LDE5OiRWNSwyMDokVjYsMjE6JFY3LDIyOiRWOCwyMzokVjksMjQ6JFZhLDI1OiRWYiwyNjokVmMsMjc6JFZkLDI4OiRWZSwyOTokVmYsMzA6JFZnLDMxOiRWaCwzMjokVml9LHs3OlsxLDQyXX0sbygkVm8sWzIsMjldKSxvKCRWbyxbMiwxM10pLHs3OiRWbiwxNTozMywxOTokVjUsMjA6JFY2LDIxOiRWNywyMjokVjgsMjM6JFY5LDI0OiRWYSwyNTokVmIsMjY6JFZjLDI3OiRWZCwyODokVmUsMjk6JFZmLDMwOiRWZywzMTokVmgsMzI6JFZpfSxvKCRWcCxbMiwyXSx7ODokVmwsOTokVm19KSxvKCRWcCxbMiwzXSx7ODokVmwsOTokVm19KSxvKCRWbyxbMiw0XSksbygkVm8sWzIsNV0pLG8oJFZvLFsyLDZdKSx7NjokVmosNzokVmssODokVmwsOTokVm0sMTE6WzEsNDNdfSx7MTI6WzEsNDRdfSxvKCRWbyxbMiw3XSksezEwOlsxLDQ1XX0sezQ6NDYsNzokVjAsMTA6JFYxLDEyOiRWMiwxNDo2LDE1OjcsMTY6OCwxNzokVjMsMTg6JFY0LDE5OiRWNSwyMDokVjYsMjE6JFY3LDIyOiRWOCwyMzokVjksMjQ6JFZhLDI1OiRWYiwyNjokVmMsMjc6JFZkLDI4OiRWZSwyOTokVmYsMzA6JFZnLDMxOiRWaCwzMjokVml9LHs2OiRWaiw3OiRWayw4OiRWbCw5OiRWbSwxMTpbMSw0N119LG8oJFZvLFsyLDhdKV0sXG5kZWZhdWx0QWN0aW9uczogezI1OlsyLDFdfSxcbnBhcnNlRXJyb3I6IGZ1bmN0aW9uIHBhcnNlRXJyb3Ioc3RyLCBoYXNoKSB7XG4gICAgaWYgKGhhc2gucmVjb3ZlcmFibGUpIHtcbiAgICAgICAgdGhpcy50cmFjZShzdHIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBlcnJvciA9IG5ldyBFcnJvcihzdHIpO1xuICAgICAgICBlcnJvci5oYXNoID0gaGFzaDtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxufSxcbnBhcnNlOiBmdW5jdGlvbiBwYXJzZShpbnB1dCkge1xuICAgIHZhciBzZWxmID0gdGhpcywgc3RhY2sgPSBbMF0sIHRzdGFjayA9IFtdLCB2c3RhY2sgPSBbbnVsbF0sIGxzdGFjayA9IFtdLCB0YWJsZSA9IHRoaXMudGFibGUsIHl5dGV4dCA9ICcnLCB5eWxpbmVubyA9IDAsIHl5bGVuZyA9IDAsIHJlY292ZXJpbmcgPSAwLCBURVJST1IgPSAyLCBFT0YgPSAxO1xuICAgIHZhciBhcmdzID0gbHN0YWNrLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICB2YXIgbGV4ZXIgPSBPYmplY3QuY3JlYXRlKHRoaXMubGV4ZXIpO1xuICAgIHZhciBzaGFyZWRTdGF0ZSA9IHsgeXk6IHt9IH07XG4gICAgZm9yICh2YXIgayBpbiB0aGlzLnl5KSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy55eSwgaykpIHtcbiAgICAgICAgICAgIHNoYXJlZFN0YXRlLnl5W2tdID0gdGhpcy55eVtrXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXhlci5zZXRJbnB1dChpbnB1dCwgc2hhcmVkU3RhdGUueXkpO1xuICAgIHNoYXJlZFN0YXRlLnl5LmxleGVyID0gbGV4ZXI7XG4gICAgc2hhcmVkU3RhdGUueXkucGFyc2VyID0gdGhpcztcbiAgICBpZiAodHlwZW9mIGxleGVyLnl5bGxvYyA9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBsZXhlci55eWxsb2MgPSB7fTtcbiAgICB9XG4gICAgdmFyIHl5bG9jID0gbGV4ZXIueXlsbG9jO1xuICAgIGxzdGFjay5wdXNoKHl5bG9jKTtcbiAgICB2YXIgcmFuZ2VzID0gbGV4ZXIub3B0aW9ucyAmJiBsZXhlci5vcHRpb25zLnJhbmdlcztcbiAgICBpZiAodHlwZW9mIHNoYXJlZFN0YXRlLnl5LnBhcnNlRXJyb3IgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5wYXJzZUVycm9yID0gc2hhcmVkU3RhdGUueXkucGFyc2VFcnJvcjtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnBhcnNlRXJyb3IgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcykucGFyc2VFcnJvcjtcbiAgICB9XG4gICAgZnVuY3Rpb24gcG9wU3RhY2sobikge1xuICAgICAgICBzdGFjay5sZW5ndGggPSBzdGFjay5sZW5ndGggLSAyICogbjtcbiAgICAgICAgdnN0YWNrLmxlbmd0aCA9IHZzdGFjay5sZW5ndGggLSBuO1xuICAgICAgICBsc3RhY2subGVuZ3RoID0gbHN0YWNrLmxlbmd0aCAtIG47XG4gICAgfVxuICAgIF90b2tlbl9zdGFjazpcbiAgICAgICAgdmFyIGxleCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0b2tlbjtcbiAgICAgICAgICAgIHRva2VuID0gbGV4ZXIubGV4KCkgfHwgRU9GO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0b2tlbiAhPT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICB0b2tlbiA9IHNlbGYuc3ltYm9sc19bdG9rZW5dIHx8IHRva2VuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgICAgICB9O1xuICAgIHZhciBzeW1ib2wsIHByZUVycm9yU3ltYm9sLCBzdGF0ZSwgYWN0aW9uLCBhLCByLCB5eXZhbCA9IHt9LCBwLCBsZW4sIG5ld1N0YXRlLCBleHBlY3RlZDtcbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICBzdGF0ZSA9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdO1xuICAgICAgICBpZiAodGhpcy5kZWZhdWx0QWN0aW9uc1tzdGF0ZV0pIHtcbiAgICAgICAgICAgIGFjdGlvbiA9IHRoaXMuZGVmYXVsdEFjdGlvbnNbc3RhdGVdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHN5bWJvbCA9PT0gbnVsbCB8fCB0eXBlb2Ygc3ltYm9sID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgc3ltYm9sID0gbGV4KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhY3Rpb24gPSB0YWJsZVtzdGF0ZV0gJiYgdGFibGVbc3RhdGVdW3N5bWJvbF07XG4gICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhY3Rpb24gPT09ICd1bmRlZmluZWQnIHx8ICFhY3Rpb24ubGVuZ3RoIHx8ICFhY3Rpb25bMF0pIHtcbiAgICAgICAgICAgICAgICB2YXIgZXJyU3RyID0gJyc7XG4gICAgICAgICAgICAgICAgZXhwZWN0ZWQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHAgaW4gdGFibGVbc3RhdGVdKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRlcm1pbmFsc19bcF0gJiYgcCA+IFRFUlJPUikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWQucHVzaCgnXFwnJyArIHRoaXMudGVybWluYWxzX1twXSArICdcXCcnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobGV4ZXIuc2hvd1Bvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGVyclN0ciA9ICdQYXJzZSBlcnJvciBvbiBsaW5lICcgKyAoeXlsaW5lbm8gKyAxKSArICc6XFxuJyArIGxleGVyLnNob3dQb3NpdGlvbigpICsgJ1xcbkV4cGVjdGluZyAnICsgZXhwZWN0ZWQuam9pbignLCAnKSArICcsIGdvdCBcXCcnICsgKHRoaXMudGVybWluYWxzX1tzeW1ib2xdIHx8IHN5bWJvbCkgKyAnXFwnJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlcnJTdHIgPSAnUGFyc2UgZXJyb3Igb24gbGluZSAnICsgKHl5bGluZW5vICsgMSkgKyAnOiBVbmV4cGVjdGVkICcgKyAoc3ltYm9sID09IEVPRiA/ICdlbmQgb2YgaW5wdXQnIDogJ1xcJycgKyAodGhpcy50ZXJtaW5hbHNfW3N5bWJvbF0gfHwgc3ltYm9sKSArICdcXCcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJzZUVycm9yKGVyclN0ciwge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBsZXhlci5tYXRjaCxcbiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHRoaXMudGVybWluYWxzX1tzeW1ib2xdIHx8IHN5bWJvbCxcbiAgICAgICAgICAgICAgICAgICAgbGluZTogbGV4ZXIueXlsaW5lbm8sXG4gICAgICAgICAgICAgICAgICAgIGxvYzogeXlsb2MsXG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkOiBleHBlY3RlZFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICBpZiAoYWN0aW9uWzBdIGluc3RhbmNlb2YgQXJyYXkgJiYgYWN0aW9uLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUGFyc2UgRXJyb3I6IG11bHRpcGxlIGFjdGlvbnMgcG9zc2libGUgYXQgc3RhdGU6ICcgKyBzdGF0ZSArICcsIHRva2VuOiAnICsgc3ltYm9sKTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKGFjdGlvblswXSkge1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBzdGFjay5wdXNoKHN5bWJvbCk7XG4gICAgICAgICAgICB2c3RhY2sucHVzaChsZXhlci55eXRleHQpO1xuICAgICAgICAgICAgbHN0YWNrLnB1c2gobGV4ZXIueXlsbG9jKTtcbiAgICAgICAgICAgIHN0YWNrLnB1c2goYWN0aW9uWzFdKTtcbiAgICAgICAgICAgIHN5bWJvbCA9IG51bGw7XG4gICAgICAgICAgICBpZiAoIXByZUVycm9yU3ltYm9sKSB7XG4gICAgICAgICAgICAgICAgeXlsZW5nID0gbGV4ZXIueXlsZW5nO1xuICAgICAgICAgICAgICAgIHl5dGV4dCA9IGxleGVyLnl5dGV4dDtcbiAgICAgICAgICAgICAgICB5eWxpbmVubyA9IGxleGVyLnl5bGluZW5vO1xuICAgICAgICAgICAgICAgIHl5bG9jID0gbGV4ZXIueXlsbG9jO1xuICAgICAgICAgICAgICAgIGlmIChyZWNvdmVyaW5nID4gMCkge1xuICAgICAgICAgICAgICAgICAgICByZWNvdmVyaW5nLS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzeW1ib2wgPSBwcmVFcnJvclN5bWJvbDtcbiAgICAgICAgICAgICAgICBwcmVFcnJvclN5bWJvbCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgbGVuID0gdGhpcy5wcm9kdWN0aW9uc19bYWN0aW9uWzFdXVsxXTtcbiAgICAgICAgICAgIHl5dmFsLiQgPSB2c3RhY2tbdnN0YWNrLmxlbmd0aCAtIGxlbl07XG4gICAgICAgICAgICB5eXZhbC5fJCA9IHtcbiAgICAgICAgICAgICAgICBmaXJzdF9saW5lOiBsc3RhY2tbbHN0YWNrLmxlbmd0aCAtIChsZW4gfHwgMSldLmZpcnN0X2xpbmUsXG4gICAgICAgICAgICAgICAgbGFzdF9saW5lOiBsc3RhY2tbbHN0YWNrLmxlbmd0aCAtIDFdLmxhc3RfbGluZSxcbiAgICAgICAgICAgICAgICBmaXJzdF9jb2x1bW46IGxzdGFja1tsc3RhY2subGVuZ3RoIC0gKGxlbiB8fCAxKV0uZmlyc3RfY29sdW1uLFxuICAgICAgICAgICAgICAgIGxhc3RfY29sdW1uOiBsc3RhY2tbbHN0YWNrLmxlbmd0aCAtIDFdLmxhc3RfY29sdW1uXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHJhbmdlcykge1xuICAgICAgICAgICAgICAgIHl5dmFsLl8kLnJhbmdlID0gW1xuICAgICAgICAgICAgICAgICAgICBsc3RhY2tbbHN0YWNrLmxlbmd0aCAtIChsZW4gfHwgMSldLnJhbmdlWzBdLFxuICAgICAgICAgICAgICAgICAgICBsc3RhY2tbbHN0YWNrLmxlbmd0aCAtIDFdLnJhbmdlWzFdXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHIgPSB0aGlzLnBlcmZvcm1BY3Rpb24uYXBwbHkoeXl2YWwsIFtcbiAgICAgICAgICAgICAgICB5eXRleHQsXG4gICAgICAgICAgICAgICAgeXlsZW5nLFxuICAgICAgICAgICAgICAgIHl5bGluZW5vLFxuICAgICAgICAgICAgICAgIHNoYXJlZFN0YXRlLnl5LFxuICAgICAgICAgICAgICAgIGFjdGlvblsxXSxcbiAgICAgICAgICAgICAgICB2c3RhY2ssXG4gICAgICAgICAgICAgICAgbHN0YWNrXG4gICAgICAgICAgICBdLmNvbmNhdChhcmdzKSk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGVuKSB7XG4gICAgICAgICAgICAgICAgc3RhY2sgPSBzdGFjay5zbGljZSgwLCAtMSAqIGxlbiAqIDIpO1xuICAgICAgICAgICAgICAgIHZzdGFjayA9IHZzdGFjay5zbGljZSgwLCAtMSAqIGxlbik7XG4gICAgICAgICAgICAgICAgbHN0YWNrID0gbHN0YWNrLnNsaWNlKDAsIC0xICogbGVuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN0YWNrLnB1c2godGhpcy5wcm9kdWN0aW9uc19bYWN0aW9uWzFdXVswXSk7XG4gICAgICAgICAgICB2c3RhY2sucHVzaCh5eXZhbC4kKTtcbiAgICAgICAgICAgIGxzdGFjay5wdXNoKHl5dmFsLl8kKTtcbiAgICAgICAgICAgIG5ld1N0YXRlID0gdGFibGVbc3RhY2tbc3RhY2subGVuZ3RoIC0gMl1dW3N0YWNrW3N0YWNrLmxlbmd0aCAtIDFdXTtcbiAgICAgICAgICAgIHN0YWNrLnB1c2gobmV3U3RhdGUpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufX07XG4vKiBnZW5lcmF0ZWQgYnkgamlzb24tbGV4IDAuMy40ICovXG52YXIgbGV4ZXIgPSAoZnVuY3Rpb24oKXtcbnZhciBsZXhlciA9ICh7XG5cbkVPRjoxLFxuXG5wYXJzZUVycm9yOmZ1bmN0aW9uIHBhcnNlRXJyb3Ioc3RyLCBoYXNoKSB7XG4gICAgICAgIGlmICh0aGlzLnl5LnBhcnNlcikge1xuICAgICAgICAgICAgdGhpcy55eS5wYXJzZXIucGFyc2VFcnJvcihzdHIsIGhhc2gpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHN0cik7XG4gICAgICAgIH1cbiAgICB9LFxuXG4vLyByZXNldHMgdGhlIGxleGVyLCBzZXRzIG5ldyBpbnB1dFxuc2V0SW5wdXQ6ZnVuY3Rpb24gKGlucHV0LCB5eSkge1xuICAgICAgICB0aGlzLnl5ID0geXkgfHwgdGhpcy55eSB8fCB7fTtcbiAgICAgICAgdGhpcy5faW5wdXQgPSBpbnB1dDtcbiAgICAgICAgdGhpcy5fbW9yZSA9IHRoaXMuX2JhY2t0cmFjayA9IHRoaXMuZG9uZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnl5bGluZW5vID0gdGhpcy55eWxlbmcgPSAwO1xuICAgICAgICB0aGlzLnl5dGV4dCA9IHRoaXMubWF0Y2hlZCA9IHRoaXMubWF0Y2ggPSAnJztcbiAgICAgICAgdGhpcy5jb25kaXRpb25TdGFjayA9IFsnSU5JVElBTCddO1xuICAgICAgICB0aGlzLnl5bGxvYyA9IHtcbiAgICAgICAgICAgIGZpcnN0X2xpbmU6IDEsXG4gICAgICAgICAgICBmaXJzdF9jb2x1bW46IDAsXG4gICAgICAgICAgICBsYXN0X2xpbmU6IDEsXG4gICAgICAgICAgICBsYXN0X2NvbHVtbjogMFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJhbmdlcykge1xuICAgICAgICAgICAgdGhpcy55eWxsb2MucmFuZ2UgPSBbMCwwXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9mZnNldCA9IDA7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbi8vIGNvbnN1bWVzIGFuZCByZXR1cm5zIG9uZSBjaGFyIGZyb20gdGhlIGlucHV0XG5pbnB1dDpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjaCA9IHRoaXMuX2lucHV0WzBdO1xuICAgICAgICB0aGlzLnl5dGV4dCArPSBjaDtcbiAgICAgICAgdGhpcy55eWxlbmcrKztcbiAgICAgICAgdGhpcy5vZmZzZXQrKztcbiAgICAgICAgdGhpcy5tYXRjaCArPSBjaDtcbiAgICAgICAgdGhpcy5tYXRjaGVkICs9IGNoO1xuICAgICAgICB2YXIgbGluZXMgPSBjaC5tYXRjaCgvKD86XFxyXFxuP3xcXG4pLiovZyk7XG4gICAgICAgIGlmIChsaW5lcykge1xuICAgICAgICAgICAgdGhpcy55eWxpbmVubysrO1xuICAgICAgICAgICAgdGhpcy55eWxsb2MubGFzdF9saW5lKys7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnl5bGxvYy5sYXN0X2NvbHVtbisrO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMucmFuZ2VzKSB7XG4gICAgICAgICAgICB0aGlzLnl5bGxvYy5yYW5nZVsxXSsrO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5faW5wdXQgPSB0aGlzLl9pbnB1dC5zbGljZSgxKTtcbiAgICAgICAgcmV0dXJuIGNoO1xuICAgIH0sXG5cbi8vIHVuc2hpZnRzIG9uZSBjaGFyIChvciBhIHN0cmluZykgaW50byB0aGUgaW5wdXRcbnVucHV0OmZ1bmN0aW9uIChjaCkge1xuICAgICAgICB2YXIgbGVuID0gY2gubGVuZ3RoO1xuICAgICAgICB2YXIgbGluZXMgPSBjaC5zcGxpdCgvKD86XFxyXFxuP3xcXG4pL2cpO1xuXG4gICAgICAgIHRoaXMuX2lucHV0ID0gY2ggKyB0aGlzLl9pbnB1dDtcbiAgICAgICAgdGhpcy55eXRleHQgPSB0aGlzLnl5dGV4dC5zdWJzdHIoMCwgdGhpcy55eXRleHQubGVuZ3RoIC0gbGVuKTtcbiAgICAgICAgLy90aGlzLnl5bGVuZyAtPSBsZW47XG4gICAgICAgIHRoaXMub2Zmc2V0IC09IGxlbjtcbiAgICAgICAgdmFyIG9sZExpbmVzID0gdGhpcy5tYXRjaC5zcGxpdCgvKD86XFxyXFxuP3xcXG4pL2cpO1xuICAgICAgICB0aGlzLm1hdGNoID0gdGhpcy5tYXRjaC5zdWJzdHIoMCwgdGhpcy5tYXRjaC5sZW5ndGggLSAxKTtcbiAgICAgICAgdGhpcy5tYXRjaGVkID0gdGhpcy5tYXRjaGVkLnN1YnN0cigwLCB0aGlzLm1hdGNoZWQubGVuZ3RoIC0gMSk7XG5cbiAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIHRoaXMueXlsaW5lbm8gLT0gbGluZXMubGVuZ3RoIC0gMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgciA9IHRoaXMueXlsbG9jLnJhbmdlO1xuXG4gICAgICAgIHRoaXMueXlsbG9jID0ge1xuICAgICAgICAgICAgZmlyc3RfbGluZTogdGhpcy55eWxsb2MuZmlyc3RfbGluZSxcbiAgICAgICAgICAgIGxhc3RfbGluZTogdGhpcy55eWxpbmVubyArIDEsXG4gICAgICAgICAgICBmaXJzdF9jb2x1bW46IHRoaXMueXlsbG9jLmZpcnN0X2NvbHVtbixcbiAgICAgICAgICAgIGxhc3RfY29sdW1uOiBsaW5lcyA/XG4gICAgICAgICAgICAgICAgKGxpbmVzLmxlbmd0aCA9PT0gb2xkTGluZXMubGVuZ3RoID8gdGhpcy55eWxsb2MuZmlyc3RfY29sdW1uIDogMClcbiAgICAgICAgICAgICAgICAgKyBvbGRMaW5lc1tvbGRMaW5lcy5sZW5ndGggLSBsaW5lcy5sZW5ndGhdLmxlbmd0aCAtIGxpbmVzWzBdLmxlbmd0aCA6XG4gICAgICAgICAgICAgIHRoaXMueXlsbG9jLmZpcnN0X2NvbHVtbiAtIGxlblxuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMucmFuZ2VzKSB7XG4gICAgICAgICAgICB0aGlzLnl5bGxvYy5yYW5nZSA9IFtyWzBdLCByWzBdICsgdGhpcy55eWxlbmcgLSBsZW5dO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMueXlsZW5nID0gdGhpcy55eXRleHQubGVuZ3RoO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4vLyBXaGVuIGNhbGxlZCBmcm9tIGFjdGlvbiwgY2FjaGVzIG1hdGNoZWQgdGV4dCBhbmQgYXBwZW5kcyBpdCBvbiBuZXh0IGFjdGlvblxubW9yZTpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX21vcmUgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4vLyBXaGVuIGNhbGxlZCBmcm9tIGFjdGlvbiwgc2lnbmFscyB0aGUgbGV4ZXIgdGhhdCB0aGlzIHJ1bGUgZmFpbHMgdG8gbWF0Y2ggdGhlIGlucHV0LCBzbyB0aGUgbmV4dCBtYXRjaGluZyBydWxlIChyZWdleCkgc2hvdWxkIGJlIHRlc3RlZCBpbnN0ZWFkLlxucmVqZWN0OmZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5iYWNrdHJhY2tfbGV4ZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2JhY2t0cmFjayA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUVycm9yKCdMZXhpY2FsIGVycm9yIG9uIGxpbmUgJyArICh0aGlzLnl5bGluZW5vICsgMSkgKyAnLiBZb3UgY2FuIG9ubHkgaW52b2tlIHJlamVjdCgpIGluIHRoZSBsZXhlciB3aGVuIHRoZSBsZXhlciBpcyBvZiB0aGUgYmFja3RyYWNraW5nIHBlcnN1YXNpb24gKG9wdGlvbnMuYmFja3RyYWNrX2xleGVyID0gdHJ1ZSkuXFxuJyArIHRoaXMuc2hvd1Bvc2l0aW9uKCksIHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBcIlwiLFxuICAgICAgICAgICAgICAgIHRva2VuOiBudWxsLFxuICAgICAgICAgICAgICAgIGxpbmU6IHRoaXMueXlsaW5lbm9cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuLy8gcmV0YWluIGZpcnN0IG4gY2hhcmFjdGVycyBvZiB0aGUgbWF0Y2hcbmxlc3M6ZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgdGhpcy51bnB1dCh0aGlzLm1hdGNoLnNsaWNlKG4pKTtcbiAgICB9LFxuXG4vLyBkaXNwbGF5cyBhbHJlYWR5IG1hdGNoZWQgaW5wdXQsIGkuZS4gZm9yIGVycm9yIG1lc3NhZ2VzXG5wYXN0SW5wdXQ6ZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFzdCA9IHRoaXMubWF0Y2hlZC5zdWJzdHIoMCwgdGhpcy5tYXRjaGVkLmxlbmd0aCAtIHRoaXMubWF0Y2gubGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIChwYXN0Lmxlbmd0aCA+IDIwID8gJy4uLic6JycpICsgcGFzdC5zdWJzdHIoLTIwKS5yZXBsYWNlKC9cXG4vZywgXCJcIik7XG4gICAgfSxcblxuLy8gZGlzcGxheXMgdXBjb21pbmcgaW5wdXQsIGkuZS4gZm9yIGVycm9yIG1lc3NhZ2VzXG51cGNvbWluZ0lucHV0OmZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5leHQgPSB0aGlzLm1hdGNoO1xuICAgICAgICBpZiAobmV4dC5sZW5ndGggPCAyMCkge1xuICAgICAgICAgICAgbmV4dCArPSB0aGlzLl9pbnB1dC5zdWJzdHIoMCwgMjAtbmV4dC5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobmV4dC5zdWJzdHIoMCwyMCkgKyAobmV4dC5sZW5ndGggPiAyMCA/ICcuLi4nIDogJycpKS5yZXBsYWNlKC9cXG4vZywgXCJcIik7XG4gICAgfSxcblxuLy8gZGlzcGxheXMgdGhlIGNoYXJhY3RlciBwb3NpdGlvbiB3aGVyZSB0aGUgbGV4aW5nIGVycm9yIG9jY3VycmVkLCBpLmUuIGZvciBlcnJvciBtZXNzYWdlc1xuc2hvd1Bvc2l0aW9uOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHByZSA9IHRoaXMucGFzdElucHV0KCk7XG4gICAgICAgIHZhciBjID0gbmV3IEFycmF5KHByZS5sZW5ndGggKyAxKS5qb2luKFwiLVwiKTtcbiAgICAgICAgcmV0dXJuIHByZSArIHRoaXMudXBjb21pbmdJbnB1dCgpICsgXCJcXG5cIiArIGMgKyBcIl5cIjtcbiAgICB9LFxuXG4vLyB0ZXN0IHRoZSBsZXhlZCB0b2tlbjogcmV0dXJuIEZBTFNFIHdoZW4gbm90IGEgbWF0Y2gsIG90aGVyd2lzZSByZXR1cm4gdG9rZW5cbnRlc3RfbWF0Y2g6ZnVuY3Rpb24gKG1hdGNoLCBpbmRleGVkX3J1bGUpIHtcbiAgICAgICAgdmFyIHRva2VuLFxuICAgICAgICAgICAgbGluZXMsXG4gICAgICAgICAgICBiYWNrdXA7XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5iYWNrdHJhY2tfbGV4ZXIpIHtcbiAgICAgICAgICAgIC8vIHNhdmUgY29udGV4dFxuICAgICAgICAgICAgYmFja3VwID0ge1xuICAgICAgICAgICAgICAgIHl5bGluZW5vOiB0aGlzLnl5bGluZW5vLFxuICAgICAgICAgICAgICAgIHl5bGxvYzoge1xuICAgICAgICAgICAgICAgICAgICBmaXJzdF9saW5lOiB0aGlzLnl5bGxvYy5maXJzdF9saW5lLFxuICAgICAgICAgICAgICAgICAgICBsYXN0X2xpbmU6IHRoaXMubGFzdF9saW5lLFxuICAgICAgICAgICAgICAgICAgICBmaXJzdF9jb2x1bW46IHRoaXMueXlsbG9jLmZpcnN0X2NvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgbGFzdF9jb2x1bW46IHRoaXMueXlsbG9jLmxhc3RfY29sdW1uXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB5eXRleHQ6IHRoaXMueXl0ZXh0LFxuICAgICAgICAgICAgICAgIG1hdGNoOiB0aGlzLm1hdGNoLFxuICAgICAgICAgICAgICAgIG1hdGNoZXM6IHRoaXMubWF0Y2hlcyxcbiAgICAgICAgICAgICAgICBtYXRjaGVkOiB0aGlzLm1hdGNoZWQsXG4gICAgICAgICAgICAgICAgeXlsZW5nOiB0aGlzLnl5bGVuZyxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IHRoaXMub2Zmc2V0LFxuICAgICAgICAgICAgICAgIF9tb3JlOiB0aGlzLl9tb3JlLFxuICAgICAgICAgICAgICAgIF9pbnB1dDogdGhpcy5faW5wdXQsXG4gICAgICAgICAgICAgICAgeXk6IHRoaXMueXksXG4gICAgICAgICAgICAgICAgY29uZGl0aW9uU3RhY2s6IHRoaXMuY29uZGl0aW9uU3RhY2suc2xpY2UoMCksXG4gICAgICAgICAgICAgICAgZG9uZTogdGhpcy5kb25lXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5yYW5nZXMpIHtcbiAgICAgICAgICAgICAgICBiYWNrdXAueXlsbG9jLnJhbmdlID0gdGhpcy55eWxsb2MucmFuZ2Uuc2xpY2UoMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBsaW5lcyA9IG1hdGNoWzBdLm1hdGNoKC8oPzpcXHJcXG4/fFxcbikuKi9nKTtcbiAgICAgICAgaWYgKGxpbmVzKSB7XG4gICAgICAgICAgICB0aGlzLnl5bGluZW5vICs9IGxpbmVzLmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnl5bGxvYyA9IHtcbiAgICAgICAgICAgIGZpcnN0X2xpbmU6IHRoaXMueXlsbG9jLmxhc3RfbGluZSxcbiAgICAgICAgICAgIGxhc3RfbGluZTogdGhpcy55eWxpbmVubyArIDEsXG4gICAgICAgICAgICBmaXJzdF9jb2x1bW46IHRoaXMueXlsbG9jLmxhc3RfY29sdW1uLFxuICAgICAgICAgICAgbGFzdF9jb2x1bW46IGxpbmVzID9cbiAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXS5sZW5ndGggLSBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXS5tYXRjaCgvXFxyP1xcbj8vKVswXS5sZW5ndGggOlxuICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueXlsbG9jLmxhc3RfY29sdW1uICsgbWF0Y2hbMF0ubGVuZ3RoXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMueXl0ZXh0ICs9IG1hdGNoWzBdO1xuICAgICAgICB0aGlzLm1hdGNoICs9IG1hdGNoWzBdO1xuICAgICAgICB0aGlzLm1hdGNoZXMgPSBtYXRjaDtcbiAgICAgICAgdGhpcy55eWxlbmcgPSB0aGlzLnl5dGV4dC5sZW5ndGg7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMucmFuZ2VzKSB7XG4gICAgICAgICAgICB0aGlzLnl5bGxvYy5yYW5nZSA9IFt0aGlzLm9mZnNldCwgdGhpcy5vZmZzZXQgKz0gdGhpcy55eWxlbmddO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX21vcmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fYmFja3RyYWNrID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2lucHV0ID0gdGhpcy5faW5wdXQuc2xpY2UobWF0Y2hbMF0ubGVuZ3RoKTtcbiAgICAgICAgdGhpcy5tYXRjaGVkICs9IG1hdGNoWzBdO1xuICAgICAgICB0b2tlbiA9IHRoaXMucGVyZm9ybUFjdGlvbi5jYWxsKHRoaXMsIHRoaXMueXksIHRoaXMsIGluZGV4ZWRfcnVsZSwgdGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aCAtIDFdKTtcbiAgICAgICAgaWYgKHRoaXMuZG9uZSAmJiB0aGlzLl9pbnB1dCkge1xuICAgICAgICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICByZXR1cm4gdG9rZW47XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fYmFja3RyYWNrKSB7XG4gICAgICAgICAgICAvLyByZWNvdmVyIGNvbnRleHRcbiAgICAgICAgICAgIGZvciAodmFyIGsgaW4gYmFja3VwKSB7XG4gICAgICAgICAgICAgICAgdGhpc1trXSA9IGJhY2t1cFtrXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gcnVsZSBhY3Rpb24gY2FsbGVkIHJlamVjdCgpIGltcGx5aW5nIHRoZSBuZXh0IHJ1bGUgc2hvdWxkIGJlIHRlc3RlZCBpbnN0ZWFkLlxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LFxuXG4vLyByZXR1cm4gbmV4dCBtYXRjaCBpbiBpbnB1dFxubmV4dDpmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmRvbmUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkVPRjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuX2lucHV0KSB7XG4gICAgICAgICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHRva2VuLFxuICAgICAgICAgICAgbWF0Y2gsXG4gICAgICAgICAgICB0ZW1wTWF0Y2gsXG4gICAgICAgICAgICBpbmRleDtcbiAgICAgICAgaWYgKCF0aGlzLl9tb3JlKSB7XG4gICAgICAgICAgICB0aGlzLnl5dGV4dCA9ICcnO1xuICAgICAgICAgICAgdGhpcy5tYXRjaCA9ICcnO1xuICAgICAgICB9XG4gICAgICAgIHZhciBydWxlcyA9IHRoaXMuX2N1cnJlbnRSdWxlcygpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJ1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0ZW1wTWF0Y2ggPSB0aGlzLl9pbnB1dC5tYXRjaCh0aGlzLnJ1bGVzW3J1bGVzW2ldXSk7XG4gICAgICAgICAgICBpZiAodGVtcE1hdGNoICYmICghbWF0Y2ggfHwgdGVtcE1hdGNoWzBdLmxlbmd0aCA+IG1hdGNoWzBdLmxlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICBtYXRjaCA9IHRlbXBNYXRjaDtcbiAgICAgICAgICAgICAgICBpbmRleCA9IGk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5iYWNrdHJhY2tfbGV4ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9rZW4gPSB0aGlzLnRlc3RfbWF0Y2godGVtcE1hdGNoLCBydWxlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbiAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9iYWNrdHJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gcnVsZSBhY3Rpb24gY2FsbGVkIHJlamVjdCgpIGltcGx5aW5nIGEgcnVsZSBNSVNtYXRjaC5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVsc2U6IHRoaXMgaXMgYSBsZXhlciBydWxlIHdoaWNoIGNvbnN1bWVzIGlucHV0IHdpdGhvdXQgcHJvZHVjaW5nIGEgdG9rZW4gKGUuZy4gd2hpdGVzcGFjZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMub3B0aW9ucy5mbGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgIHRva2VuID0gdGhpcy50ZXN0X21hdGNoKG1hdGNoLCBydWxlc1tpbmRleF0pO1xuICAgICAgICAgICAgaWYgKHRva2VuICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGVsc2U6IHRoaXMgaXMgYSBsZXhlciBydWxlIHdoaWNoIGNvbnN1bWVzIGlucHV0IHdpdGhvdXQgcHJvZHVjaW5nIGEgdG9rZW4gKGUuZy4gd2hpdGVzcGFjZSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5faW5wdXQgPT09IFwiXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkVPRjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlRXJyb3IoJ0xleGljYWwgZXJyb3Igb24gbGluZSAnICsgKHRoaXMueXlsaW5lbm8gKyAxKSArICcuIFVucmVjb2duaXplZCB0ZXh0LlxcbicgKyB0aGlzLnNob3dQb3NpdGlvbigpLCB7XG4gICAgICAgICAgICAgICAgdGV4dDogXCJcIixcbiAgICAgICAgICAgICAgICB0b2tlbjogbnVsbCxcbiAgICAgICAgICAgICAgICBsaW5lOiB0aGlzLnl5bGluZW5vXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sXG5cbi8vIHJldHVybiBuZXh0IG1hdGNoIHRoYXQgaGFzIGEgdG9rZW5cbmxleDpmdW5jdGlvbiBsZXgoKSB7XG4gICAgICAgIHZhciByID0gdGhpcy5uZXh0KCk7XG4gICAgICAgIGlmIChyKSB7XG4gICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxleCgpO1xuICAgICAgICB9XG4gICAgfSxcblxuLy8gYWN0aXZhdGVzIGEgbmV3IGxleGVyIGNvbmRpdGlvbiBzdGF0ZSAocHVzaGVzIHRoZSBuZXcgbGV4ZXIgY29uZGl0aW9uIHN0YXRlIG9udG8gdGhlIGNvbmRpdGlvbiBzdGFjaylcbmJlZ2luOmZ1bmN0aW9uIGJlZ2luKGNvbmRpdGlvbikge1xuICAgICAgICB0aGlzLmNvbmRpdGlvblN0YWNrLnB1c2goY29uZGl0aW9uKTtcbiAgICB9LFxuXG4vLyBwb3AgdGhlIHByZXZpb3VzbHkgYWN0aXZlIGxleGVyIGNvbmRpdGlvbiBzdGF0ZSBvZmYgdGhlIGNvbmRpdGlvbiBzdGFja1xucG9wU3RhdGU6ZnVuY3Rpb24gcG9wU3RhdGUoKSB7XG4gICAgICAgIHZhciBuID0gdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGggLSAxO1xuICAgICAgICBpZiAobiA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmRpdGlvblN0YWNrLnBvcCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uZGl0aW9uU3RhY2tbMF07XG4gICAgICAgIH1cbiAgICB9LFxuXG4vLyBwcm9kdWNlIHRoZSBsZXhlciBydWxlIHNldCB3aGljaCBpcyBhY3RpdmUgZm9yIHRoZSBjdXJyZW50bHkgYWN0aXZlIGxleGVyIGNvbmRpdGlvbiBzdGF0ZVxuX2N1cnJlbnRSdWxlczpmdW5jdGlvbiBfY3VycmVudFJ1bGVzKCkge1xuICAgICAgICBpZiAodGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGggJiYgdGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aCAtIDFdKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25zW3RoaXMuY29uZGl0aW9uU3RhY2tbdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGggLSAxXV0ucnVsZXM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25zW1wiSU5JVElBTFwiXS5ydWxlcztcbiAgICAgICAgfVxuICAgIH0sXG5cbi8vIHJldHVybiB0aGUgY3VycmVudGx5IGFjdGl2ZSBsZXhlciBjb25kaXRpb24gc3RhdGU7IHdoZW4gYW4gaW5kZXggYXJndW1lbnQgaXMgcHJvdmlkZWQgaXQgcHJvZHVjZXMgdGhlIE4tdGggcHJldmlvdXMgY29uZGl0aW9uIHN0YXRlLCBpZiBhdmFpbGFibGVcbnRvcFN0YXRlOmZ1bmN0aW9uIHRvcFN0YXRlKG4pIHtcbiAgICAgICAgbiA9IHRoaXMuY29uZGl0aW9uU3RhY2subGVuZ3RoIC0gMSAtIE1hdGguYWJzKG4gfHwgMCk7XG4gICAgICAgIGlmIChuID49IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmRpdGlvblN0YWNrW25dO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFwiSU5JVElBTFwiO1xuICAgICAgICB9XG4gICAgfSxcblxuLy8gYWxpYXMgZm9yIGJlZ2luKGNvbmRpdGlvbilcbnB1c2hTdGF0ZTpmdW5jdGlvbiBwdXNoU3RhdGUoY29uZGl0aW9uKSB7XG4gICAgICAgIHRoaXMuYmVnaW4oY29uZGl0aW9uKTtcbiAgICB9LFxuXG4vLyByZXR1cm4gdGhlIG51bWJlciBvZiBzdGF0ZXMgY3VycmVudGx5IG9uIHRoZSBzdGFja1xuc3RhdGVTdGFja1NpemU6ZnVuY3Rpb24gc3RhdGVTdGFja1NpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aDtcbiAgICB9LFxub3B0aW9uczoge30sXG5wZXJmb3JtQWN0aW9uOiBmdW5jdGlvbiBhbm9ueW1vdXMoeXkseXlfLCRhdm9pZGluZ19uYW1lX2NvbGxpc2lvbnMsWVlfU1RBUlQpIHtcbnZhciBZWVNUQVRFPVlZX1NUQVJUO1xuc3dpdGNoKCRhdm9pZGluZ19uYW1lX2NvbGxpc2lvbnMpIHtcbmNhc2UgMDovKiBza2lwIHdoaXRlc3BhY2UgKi9cbmJyZWFrO1xuY2FzZSAxOnJldHVybiA4O1xuYnJlYWs7XG5jYXNlIDI6cmV0dXJuIDk7XG5icmVhaztcbmNhc2UgMzpyZXR1cm4gNjtcbmJyZWFrO1xuY2FzZSA0OnJldHVybiA3O1xuYnJlYWs7XG5jYXNlIDU6cmV0dXJuIDE5O1xuYnJlYWs7XG5jYXNlIDY6cmV0dXJuIDE5O1xuYnJlYWs7XG5jYXNlIDc6cmV0dXJuIDE5O1xuYnJlYWs7XG5jYXNlIDg6cmV0dXJuIDE5O1xuYnJlYWs7XG5jYXNlIDk6cmV0dXJuIDE5O1xuYnJlYWs7XG5jYXNlIDEwOnJldHVybiAxOTtcbmJyZWFrO1xuY2FzZSAxMTpyZXR1cm4gMjA7XG5icmVhaztcbmNhc2UgMTI6cmV0dXJuIDIwO1xuYnJlYWs7XG5jYXNlIDEzOnJldHVybiAyMDtcbmJyZWFrO1xuY2FzZSAxNDpyZXR1cm4gMjA7XG5icmVhaztcbmNhc2UgMTU6cmV0dXJuIDIxO1xuYnJlYWs7XG5jYXNlIDE2OnJldHVybiAyMTtcbmJyZWFrO1xuY2FzZSAxNzpyZXR1cm4gMjI7XG5icmVhaztcbmNhc2UgMTg6cmV0dXJuIDIyO1xuYnJlYWs7XG5jYXNlIDE5OnJldHVybiAyMztcbmJyZWFrO1xuY2FzZSAyMDpyZXR1cm4gMjM7XG5icmVhaztcbmNhc2UgMjE6cmV0dXJuIDIzO1xuYnJlYWs7XG5jYXNlIDIyOnJldHVybiAyNDtcbmJyZWFrO1xuY2FzZSAyMzpyZXR1cm4gMjU7XG5icmVhaztcbmNhc2UgMjQ6cmV0dXJuIDI2O1xuYnJlYWs7XG5jYXNlIDI1OnJldHVybiAyNztcbmJyZWFrO1xuY2FzZSAyNjpyZXR1cm4gMjk7XG5icmVhaztcbmNhc2UgMjc6cmV0dXJuIDI4O1xuYnJlYWs7XG5jYXNlIDI4OnJldHVybiAzMDtcbmJyZWFrO1xuY2FzZSAyOTpyZXR1cm4gMzE7XG5icmVhaztcbmNhc2UgMzA6cmV0dXJuIDMyO1xuYnJlYWs7XG5jYXNlIDMxOnJldHVybiAxNztcbmJyZWFrO1xuY2FzZSAzMjpyZXR1cm4gMTI7XG5icmVhaztcbmNhc2UgMzM6cmV0dXJuIDE4O1xuYnJlYWs7XG5jYXNlIDM0OnJldHVybiAxMztcbmJyZWFrO1xuY2FzZSAzNTpyZXR1cm4gMTA7XG5icmVhaztcbmNhc2UgMzY6cmV0dXJuIDExO1xuYnJlYWs7XG5jYXNlIDM3OnJldHVybiA1O1xuYnJlYWs7XG59XG59LFxucnVsZXM6IFsvXig/OlxccyspLywvXig/OlxcKikvLC9eKD86XFwvKS8sL14oPzpcXCspLywvXig/Oi0pLywvXig/OihbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKXB4XFxiKS8sL14oPzooWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKyljbVxcYikvLC9eKD86KFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspbW1cXGIpLywvXig/OihbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKWluXFxiKS8sL14oPzooWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylwdFxcYikvLC9eKD86KFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspcGNcXGIpLywvXig/OihbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKWRlZ1xcYikvLC9eKD86KFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspZ3JhZFxcYikvLC9eKD86KFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspcmFkXFxiKS8sL14oPzooWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKyl0dXJuXFxiKS8sL14oPzooWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylzXFxiKS8sL14oPzooWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKyltc1xcYikvLC9eKD86KFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspSHpcXGIpLywvXig/OihbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKWtIelxcYikvLC9eKD86KFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspZHBpXFxiKS8sL14oPzooWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylkcGNtXFxiKS8sL14oPzooWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylkcHB4XFxiKS8sL14oPzooWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKyllbVxcYikvLC9eKD86KFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspZXhcXGIpLywvXig/OihbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKWNoXFxiKS8sL14oPzooWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylyZW1cXGIpLywvXig/OihbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKXZ3XFxiKS8sL14oPzooWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKyl2aFxcYikvLC9eKD86KFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspdm1pblxcYikvLC9eKD86KFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspdm1heFxcYikvLC9eKD86KFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspJSkvLC9eKD86KFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspXFxiKS8sL14oPzooY2FsYykpLywvXig/Oih2YXJcXChbXlxcKV0qXFwpKSkvLC9eKD86KFthLXpdKykpLywvXig/OlxcKCkvLC9eKD86XFwpKS8sL14oPzokKS9dLFxuY29uZGl0aW9uczoge1wiSU5JVElBTFwiOntcInJ1bGVzXCI6WzAsMSwyLDMsNCw1LDYsNyw4LDksMTAsMTEsMTIsMTMsMTQsMTUsMTYsMTcsMTgsMTksMjAsMjEsMjIsMjMsMjQsMjUsMjYsMjcsMjgsMjksMzAsMzEsMzIsMzMsMzQsMzUsMzYsMzddLFwiaW5jbHVzaXZlXCI6dHJ1ZX19XG59KTtcbnJldHVybiBsZXhlcjtcbn0pKCk7XG5wYXJzZXIubGV4ZXIgPSBsZXhlcjtcbmZ1bmN0aW9uIFBhcnNlciAoKSB7XG4gIHRoaXMueXkgPSB7fTtcbn1cblBhcnNlci5wcm90b3R5cGUgPSBwYXJzZXI7cGFyc2VyLlBhcnNlciA9IFBhcnNlcjtcbnJldHVybiBuZXcgUGFyc2VyO1xufSkoKTtcblxuXG5pZiAodHlwZW9mIHJlcXVpcmUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuZXhwb3J0cy5wYXJzZXIgPSBwYXJzZXI7XG5leHBvcnRzLlBhcnNlciA9IHBhcnNlci5QYXJzZXI7XG5leHBvcnRzLnBhcnNlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gcGFyc2VyLnBhcnNlLmFwcGx5KHBhcnNlciwgYXJndW1lbnRzKTsgfTtcbmV4cG9ydHMubWFpbiA9IGZ1bmN0aW9uIGNvbW1vbmpzTWFpbihhcmdzKSB7XG4gICAgaWYgKCFhcmdzWzFdKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdVc2FnZTogJythcmdzWzBdKycgRklMRScpO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfVxuICAgIHZhciBzb3VyY2UgPSByZXF1aXJlKCdmcycpLnJlYWRGaWxlU3luYyhyZXF1aXJlKCdwYXRoJykubm9ybWFsaXplKGFyZ3NbMV0pLCBcInV0ZjhcIik7XG4gICAgcmV0dXJuIGV4cG9ydHMucGFyc2VyLnBhcnNlKHNvdXJjZSk7XG59O1xuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIHJlcXVpcmUubWFpbiA9PT0gbW9kdWxlKSB7XG4gIGV4cG9ydHMubWFpbihwcm9jZXNzLmFyZ3Yuc2xpY2UoMSkpO1xufVxufSIsIid1c2Ugc3RyaWN0JztcblxudmFyIGJpbmQgPSByZXF1aXJlKCdmdW5jdGlvbi1iaW5kJyk7XG52YXIgRVMgPSByZXF1aXJlKCdlcy1hYnN0cmFjdC9lczUnKTtcbnZhciByZXBsYWNlID0gYmluZC5jYWxsKEZ1bmN0aW9uLmNhbGwsIFN0cmluZy5wcm90b3R5cGUucmVwbGFjZSk7XG5cbi8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnRyb2wtcmVnZXggKi9cbnZhciBsZWZ0V2hpdGVzcGFjZSA9IC9eW1xceDA5XFx4MEFcXHgwQlxceDBDXFx4MERcXHgyMFxceEEwXFx1MTY4MFxcdTE4MEVcXHUyMDAwXFx1MjAwMVxcdTIwMDJcXHUyMDAzXFx1MjAwNFxcdTIwMDVcXHUyMDA2XFx1MjAwN1xcdTIwMDhcXHUyMDA5XFx1MjAwQVxcdTIwMkZcXHUyMDVGXFx1MzAwMFxcdTIwMjhcXHUyMDI5XFx1RkVGRl0rLztcbnZhciByaWdodFdoaXRlc3BhY2UgPSAvW1xceDA5XFx4MEFcXHgwQlxceDBDXFx4MERcXHgyMFxceEEwXFx1MTY4MFxcdTE4MEVcXHUyMDAwXFx1MjAwMVxcdTIwMDJcXHUyMDAzXFx1MjAwNFxcdTIwMDVcXHUyMDA2XFx1MjAwN1xcdTIwMDhcXHUyMDA5XFx1MjAwQVxcdTIwMkZcXHUyMDVGXFx1MzAwMFxcdTIwMjhcXHUyMDI5XFx1RkVGRl0rJC87XG4vKiBlc2xpbnQtZW5hYmxlIG5vLWNvbnRyb2wtcmVnZXggKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiB0cmltKCkge1xuXHR2YXIgUyA9IEVTLlRvU3RyaW5nKEVTLkNoZWNrT2JqZWN0Q29lcmNpYmxlKHRoaXMpKTtcblx0cmV0dXJuIHJlcGxhY2UocmVwbGFjZShTLCBsZWZ0V2hpdGVzcGFjZSwgJycpLCByaWdodFdoaXRlc3BhY2UsICcnKTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBiaW5kID0gcmVxdWlyZSgnZnVuY3Rpb24tYmluZCcpO1xudmFyIGRlZmluZSA9IHJlcXVpcmUoJ2RlZmluZS1wcm9wZXJ0aWVzJyk7XG5cbnZhciBpbXBsZW1lbnRhdGlvbiA9IHJlcXVpcmUoJy4vaW1wbGVtZW50YXRpb24nKTtcbnZhciBnZXRQb2x5ZmlsbCA9IHJlcXVpcmUoJy4vcG9seWZpbGwnKTtcbnZhciBzaGltID0gcmVxdWlyZSgnLi9zaGltJyk7XG5cbnZhciBib3VuZFRyaW0gPSBiaW5kLmNhbGwoRnVuY3Rpb24uY2FsbCwgZ2V0UG9seWZpbGwoKSk7XG5cbmRlZmluZShib3VuZFRyaW0sIHtcblx0Z2V0UG9seWZpbGw6IGdldFBvbHlmaWxsLFxuXHRpbXBsZW1lbnRhdGlvbjogaW1wbGVtZW50YXRpb24sXG5cdHNoaW06IHNoaW1cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGJvdW5kVHJpbTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGltcGxlbWVudGF0aW9uID0gcmVxdWlyZSgnLi9pbXBsZW1lbnRhdGlvbicpO1xuXG52YXIgemVyb1dpZHRoU3BhY2UgPSAnXFx1MjAwYic7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZ2V0UG9seWZpbGwoKSB7XG5cdGlmIChTdHJpbmcucHJvdG90eXBlLnRyaW0gJiYgemVyb1dpZHRoU3BhY2UudHJpbSgpID09PSB6ZXJvV2lkdGhTcGFjZSkge1xuXHRcdHJldHVybiBTdHJpbmcucHJvdG90eXBlLnRyaW07XG5cdH1cblx0cmV0dXJuIGltcGxlbWVudGF0aW9uO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGRlZmluZSA9IHJlcXVpcmUoJ2RlZmluZS1wcm9wZXJ0aWVzJyk7XG52YXIgZ2V0UG9seWZpbGwgPSByZXF1aXJlKCcuL3BvbHlmaWxsJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gc2hpbVN0cmluZ1RyaW0oKSB7XG5cdHZhciBwb2x5ZmlsbCA9IGdldFBvbHlmaWxsKCk7XG5cdGRlZmluZShTdHJpbmcucHJvdG90eXBlLCB7IHRyaW06IHBvbHlmaWxsIH0sIHtcblx0XHR0cmltOiBmdW5jdGlvbiB0ZXN0VHJpbSgpIHtcblx0XHRcdHJldHVybiBTdHJpbmcucHJvdG90eXBlLnRyaW0gIT09IHBvbHlmaWxsO1xuXHRcdH1cblx0fSk7XG5cdHJldHVybiBwb2x5ZmlsbDtcbn07XG4iLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5yZXF1aXJlKFwiLi4vZ2xvYmFsc1wiKTtcbnZhciBvYnNlcnZhYmxlXzEgPSByZXF1aXJlKFwiLi4vZGF0YS9vYnNlcnZhYmxlXCIpO1xuZXhwb3J0cy5PYnNlcnZhYmxlID0gb2JzZXJ2YWJsZV8xLk9ic2VydmFibGU7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vcHJvZmlsaW5nXCIpO1xudmFyIGV2ZW50cyA9IG5ldyBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSgpO1xudmFyIGxhdW5jaGVkID0gZmFsc2U7XG5mdW5jdGlvbiBzZXRMYXVuY2hlZCgpIHtcbiAgICBsYXVuY2hlZCA9IHRydWU7XG4gICAgZXZlbnRzLm9mZihcImxhdW5jaFwiLCBzZXRMYXVuY2hlZCk7XG59XG5ldmVudHMub24oXCJsYXVuY2hcIiwgc2V0TGF1bmNoZWQpO1xuaWYgKHByb2ZpbGluZ18xLmxldmVsKCkgPiAwKSB7XG4gICAgZXZlbnRzLm9uKFwiZGlzcGxheWVkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gcHJvZmlsaW5nXzEudXB0aW1lKCk7XG4gICAgICAgIHZhciBlbmQgPSBwcm9maWxpbmdfMS50aW1lKCk7XG4gICAgICAgIHZhciBzdGFydCA9IGVuZCAtIGR1cmF0aW9uO1xuICAgICAgICBwcm9maWxpbmdfMS50cmFjZShcIkRpc3BsYXllZCBpbiBcIiArIGR1cmF0aW9uLnRvRml4ZWQoMikgKyBcIm1zXCIsIHN0YXJ0LCBlbmQpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gaGFzTGF1bmNoZWQoKSB7XG4gICAgcmV0dXJuIGxhdW5jaGVkO1xufVxuZXhwb3J0cy5oYXNMYXVuY2hlZCA9IGhhc0xhdW5jaGVkO1xudmFyIHN5c3RlbV9jbGFzc2VzXzEgPSByZXF1aXJlKFwiLi4vY3NzL3N5c3RlbS1jbGFzc2VzXCIpO1xudmFyIGVudW1zXzEgPSByZXF1aXJlKFwiLi4vdWkvZW51bXMvZW51bXNcIik7XG5leHBvcnRzLmxhdW5jaEV2ZW50ID0gXCJsYXVuY2hcIjtcbmV4cG9ydHMuc3VzcGVuZEV2ZW50ID0gXCJzdXNwZW5kXCI7XG5leHBvcnRzLmRpc3BsYXllZEV2ZW50ID0gXCJkaXNwbGF5ZWRcIjtcbmV4cG9ydHMucmVzdW1lRXZlbnQgPSBcInJlc3VtZVwiO1xuZXhwb3J0cy5leGl0RXZlbnQgPSBcImV4aXRcIjtcbmV4cG9ydHMubG93TWVtb3J5RXZlbnQgPSBcImxvd01lbW9yeVwiO1xuZXhwb3J0cy51bmNhdWdodEVycm9yRXZlbnQgPSBcInVuY2F1Z2h0RXJyb3JcIjtcbmV4cG9ydHMuZGlzY2FyZGVkRXJyb3JFdmVudCA9IFwiZGlzY2FyZGVkRXJyb3JcIjtcbmV4cG9ydHMub3JpZW50YXRpb25DaGFuZ2VkRXZlbnQgPSBcIm9yaWVudGF0aW9uQ2hhbmdlZFwiO1xudmFyIE9SSUVOVEFUSU9OX0NTU19DTEFTU0VTID0gW1xuICAgIFwiXCIgKyBzeXN0ZW1fY2xhc3Nlc18xLkNMQVNTX1BSRUZJWCArIGVudW1zXzEuRGV2aWNlT3JpZW50YXRpb24ucG9ydHJhaXQsXG4gICAgXCJcIiArIHN5c3RlbV9jbGFzc2VzXzEuQ0xBU1NfUFJFRklYICsgZW51bXNfMS5EZXZpY2VPcmllbnRhdGlvbi5sYW5kc2NhcGUsXG4gICAgXCJcIiArIHN5c3RlbV9jbGFzc2VzXzEuQ0xBU1NfUFJFRklYICsgZW51bXNfMS5EZXZpY2VPcmllbnRhdGlvbi51bmtub3duXG5dO1xudmFyIGNzc0ZpbGUgPSBcIi4vYXBwLmNzc1wiO1xudmFyIHJlc291cmNlcyA9IHt9O1xuZnVuY3Rpb24gZ2V0UmVzb3VyY2VzKCkge1xuICAgIHJldHVybiByZXNvdXJjZXM7XG59XG5leHBvcnRzLmdldFJlc291cmNlcyA9IGdldFJlc291cmNlcztcbmZ1bmN0aW9uIHNldFJlc291cmNlcyhyZXMpIHtcbiAgICByZXNvdXJjZXMgPSByZXM7XG59XG5leHBvcnRzLnNldFJlc291cmNlcyA9IHNldFJlc291cmNlcztcbmV4cG9ydHMuYW5kcm9pZCA9IHVuZGVmaW5lZDtcbmV4cG9ydHMuaW9zID0gdW5kZWZpbmVkO1xuZXhwb3J0cy5vbiA9IGV2ZW50cy5vbi5iaW5kKGV2ZW50cyk7XG5leHBvcnRzLm9mZiA9IGV2ZW50cy5vZmYuYmluZChldmVudHMpO1xuZXhwb3J0cy5ub3RpZnkgPSBldmVudHMubm90aWZ5LmJpbmQoZXZlbnRzKTtcbmV4cG9ydHMuaGFzTGlzdGVuZXJzID0gZXZlbnRzLmhhc0xpc3RlbmVycy5iaW5kKGV2ZW50cyk7XG52YXIgYXBwO1xuZnVuY3Rpb24gc2V0QXBwbGljYXRpb24oaW5zdGFuY2UpIHtcbiAgICBhcHAgPSBpbnN0YW5jZTtcbn1cbmV4cG9ydHMuc2V0QXBwbGljYXRpb24gPSBzZXRBcHBsaWNhdGlvbjtcbmZ1bmN0aW9uIGxpdmVzeW5jKHJvb3RWaWV3LCBjb250ZXh0KSB7XG4gICAgZXZlbnRzLm5vdGlmeSh7IGV2ZW50TmFtZTogXCJsaXZlc3luY1wiLCBvYmplY3Q6IGFwcCB9KTtcbiAgICB2YXIgbGl2ZVN5bmNDb3JlID0gZ2xvYmFsLl9fb25MaXZlU3luY0NvcmU7XG4gICAgdmFyIHJlYXBwbHlBcHBTdHlsZXMgPSBmYWxzZTtcbiAgICBpZiAoY29udGV4dCAmJiBjb250ZXh0LnBhdGgpIHtcbiAgICAgICAgdmFyIHN0eWxlRXh0ZW5zaW9ucyA9IFtcImNzc1wiLCBcInNjc3NcIl07XG4gICAgICAgIHZhciBhcHBTdHlsZXNGdWxsRmlsZU5hbWUgPSBnZXRDc3NGaWxlTmFtZSgpO1xuICAgICAgICB2YXIgYXBwU3R5bGVzRmlsZU5hbWVfMSA9IGFwcFN0eWxlc0Z1bGxGaWxlTmFtZS5zdWJzdHJpbmcoMCwgYXBwU3R5bGVzRnVsbEZpbGVOYW1lLmxhc3RJbmRleE9mKFwiLlwiKSArIDEpO1xuICAgICAgICByZWFwcGx5QXBwU3R5bGVzID0gc3R5bGVFeHRlbnNpb25zLnNvbWUoZnVuY3Rpb24gKGV4dCkgeyByZXR1cm4gY29udGV4dC5wYXRoID09PSBhcHBTdHlsZXNGaWxlTmFtZV8xLmNvbmNhdChleHQpOyB9KTtcbiAgICB9XG4gICAgaWYgKHJvb3RWaWV3ICYmIHJlYXBwbHlBcHBTdHlsZXMpIHtcbiAgICAgICAgcm9vdFZpZXcuX29uQ3NzU3RhdGVDaGFuZ2UoKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobGl2ZVN5bmNDb3JlKSB7XG4gICAgICAgIGxpdmVTeW5jQ29yZShjb250ZXh0KTtcbiAgICB9XG59XG5leHBvcnRzLmxpdmVzeW5jID0gbGl2ZXN5bmM7XG5mdW5jdGlvbiBzZXRDc3NGaWxlTmFtZShjc3NGaWxlTmFtZSkge1xuICAgIGNzc0ZpbGUgPSBjc3NGaWxlTmFtZTtcbiAgICBldmVudHMubm90aWZ5KHsgZXZlbnROYW1lOiBcImNzc0NoYW5nZWRcIiwgb2JqZWN0OiBhcHAsIGNzc0ZpbGU6IGNzc0ZpbGVOYW1lIH0pO1xufVxuZXhwb3J0cy5zZXRDc3NGaWxlTmFtZSA9IHNldENzc0ZpbGVOYW1lO1xuZnVuY3Rpb24gZ2V0Q3NzRmlsZU5hbWUoKSB7XG4gICAgcmV0dXJuIGNzc0ZpbGU7XG59XG5leHBvcnRzLmdldENzc0ZpbGVOYW1lID0gZ2V0Q3NzRmlsZU5hbWU7XG5mdW5jdGlvbiBsb2FkQXBwQ3NzKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGV2ZW50cy5ub3RpZnkoeyBldmVudE5hbWU6IFwibG9hZEFwcENzc1wiLCBvYmplY3Q6IGFwcCwgY3NzRmlsZTogZ2V0Q3NzRmlsZU5hbWUoKSB9KTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIGZpbGUgXCIgKyBnZXRDc3NGaWxlTmFtZSgpICsgXCIgY291bGRuJ3QgYmUgbG9hZGVkISBcIiArXG4gICAgICAgICAgICBcIllvdSBtYXkgbmVlZCB0byByZWdpc3RlciBpdCBpbnNpZGUgLi9hcHAvdmVuZG9yLnRzLlwiKTtcbiAgICB9XG59XG5leHBvcnRzLmxvYWRBcHBDc3MgPSBsb2FkQXBwQ3NzO1xuZnVuY3Rpb24gb3JpZW50YXRpb25DaGFuZ2VkKHJvb3RWaWV3LCBuZXdPcmllbnRhdGlvbikge1xuICAgIHZhciBuZXdPcmllbnRhdGlvbkNzc0NsYXNzID0gXCJcIiArIHN5c3RlbV9jbGFzc2VzXzEuQ0xBU1NfUFJFRklYICsgbmV3T3JpZW50YXRpb247XG4gICAgaWYgKCFyb290Vmlldy5jc3NDbGFzc2VzLmhhcyhuZXdPcmllbnRhdGlvbkNzc0NsYXNzKSkge1xuICAgICAgICB2YXIgcmVtb3ZlQ3NzQ2xhc3NfMSA9IGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgICBzeXN0ZW1fY2xhc3Nlc18xLnJlbW92ZUZyb21Sb290Vmlld0Nzc0NsYXNzZXMoYyk7XG4gICAgICAgICAgICByb290Vmlldy5jc3NDbGFzc2VzLmRlbGV0ZShjKTtcbiAgICAgICAgfTtcbiAgICAgICAgT1JJRU5UQVRJT05fQ1NTX0NMQVNTRVMuZm9yRWFjaChmdW5jdGlvbiAoYykgeyByZXR1cm4gcmVtb3ZlQ3NzQ2xhc3NfMShjKTsgfSk7XG4gICAgICAgIHN5c3RlbV9jbGFzc2VzXzEucHVzaFRvUm9vdFZpZXdDc3NDbGFzc2VzKG5ld09yaWVudGF0aW9uQ3NzQ2xhc3MpO1xuICAgICAgICByb290Vmlldy5jc3NDbGFzc2VzLmFkZChuZXdPcmllbnRhdGlvbkNzc0NsYXNzKTtcbiAgICAgICAgcm9vdFZpZXcuX29uQ3NzU3RhdGVDaGFuZ2UoKTtcbiAgICB9XG59XG5leHBvcnRzLm9yaWVudGF0aW9uQ2hhbmdlZCA9IG9yaWVudGF0aW9uQ2hhbmdlZDtcbmdsb2JhbC5fX29uVW5jYXVnaHRFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgIGV2ZW50cy5ub3RpZnkoeyBldmVudE5hbWU6IGV4cG9ydHMudW5jYXVnaHRFcnJvckV2ZW50LCBvYmplY3Q6IGFwcCwgYW5kcm9pZDogZXJyb3IsIGlvczogZXJyb3IsIGVycm9yOiBlcnJvciB9KTtcbn07XG5nbG9iYWwuX19vbkRpc2NhcmRlZEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgZXZlbnRzLm5vdGlmeSh7IGV2ZW50TmFtZTogZXhwb3J0cy5kaXNjYXJkZWRFcnJvckV2ZW50LCBvYmplY3Q6IGFwcCwgZXJyb3I6IGVycm9yIH0pO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcGxpY2F0aW9uLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGFwcGxpY2F0aW9uX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vYXBwbGljYXRpb24tY29tbW9uXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2FwcGxpY2F0aW9uLWNvbW1vblwiKSk7XG52YXIgQWN0aXZpdHlDcmVhdGVkID0gXCJhY3Rpdml0eUNyZWF0ZWRcIjtcbnZhciBBY3Rpdml0eURlc3Ryb3llZCA9IFwiYWN0aXZpdHlEZXN0cm95ZWRcIjtcbnZhciBBY3Rpdml0eVN0YXJ0ZWQgPSBcImFjdGl2aXR5U3RhcnRlZFwiO1xudmFyIEFjdGl2aXR5UGF1c2VkID0gXCJhY3Rpdml0eVBhdXNlZFwiO1xudmFyIEFjdGl2aXR5UmVzdW1lZCA9IFwiYWN0aXZpdHlSZXN1bWVkXCI7XG52YXIgQWN0aXZpdHlTdG9wcGVkID0gXCJhY3Rpdml0eVN0b3BwZWRcIjtcbnZhciBTYXZlQWN0aXZpdHlTdGF0ZSA9IFwic2F2ZUFjdGl2aXR5U3RhdGVcIjtcbnZhciBBY3Rpdml0eVJlc3VsdCA9IFwiYWN0aXZpdHlSZXN1bHRcIjtcbnZhciBBY3Rpdml0eUJhY2tQcmVzc2VkID0gXCJhY3Rpdml0eUJhY2tQcmVzc2VkXCI7XG52YXIgQWN0aXZpdHlOZXdJbnRlbnQgPSBcImFjdGl2aXR5TmV3SW50ZW50XCI7XG52YXIgQWN0aXZpdHlSZXF1ZXN0UGVybWlzc2lvbnMgPSBcImFjdGl2aXR5UmVxdWVzdFBlcm1pc3Npb25zXCI7XG52YXIgQW5kcm9pZEFwcGxpY2F0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQW5kcm9pZEFwcGxpY2F0aW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFuZHJvaWRBcHBsaWNhdGlvbigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNhbGxiYWNrcyA9IHt9O1xuICAgICAgICBfdGhpcy5fcmVnaXN0ZXJlZFJlY2VpdmVycyA9IHt9O1xuICAgICAgICBfdGhpcy5fcGVuZGluZ1JlY2VpdmVyUmVnaXN0cmF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEFuZHJvaWRBcHBsaWNhdGlvbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChuYXRpdmVBcHApIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlQXBwID09PSBuYXRpdmVBcHApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5uYXRpdmVBcHApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImFwcGxpY2F0aW9uLmFuZHJvaWQgYWxyZWFkeSBpbml0aWFsaXplZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYXRpdmVBcHAgPSBuYXRpdmVBcHA7XG4gICAgICAgIHRoaXMucGFja2FnZU5hbWUgPSBuYXRpdmVBcHAuZ2V0UGFja2FnZU5hbWUoKTtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gbmF0aXZlQXBwLmdldEFwcGxpY2F0aW9uQ29udGV4dCgpO1xuICAgICAgICB0aGlzLmNhbGxiYWNrcy5saWZlY3ljbGVDYWxsYmFja3MgPSBpbml0TGlmZWN5Y2xlQ2FsbGJhY2tzKCk7XG4gICAgICAgIHRoaXMuY2FsbGJhY2tzLmNvbXBvbmVudENhbGxiYWNrcyA9IGluaXRDb21wb25lbnRDYWxsYmFja3MoKTtcbiAgICAgICAgdGhpcy5uYXRpdmVBcHAucmVnaXN0ZXJBY3Rpdml0eUxpZmVjeWNsZUNhbGxiYWNrcyh0aGlzLmNhbGxiYWNrcy5saWZlY3ljbGVDYWxsYmFja3MpO1xuICAgICAgICB0aGlzLm5hdGl2ZUFwcC5yZWdpc3RlckNvbXBvbmVudENhbGxiYWNrcyh0aGlzLmNhbGxiYWNrcy5jb21wb25lbnRDYWxsYmFja3MpO1xuICAgICAgICB0aGlzLl9yZWdpc3RlclBlbmRpbmdSZWNlaXZlcnMoKTtcbiAgICB9O1xuICAgIEFuZHJvaWRBcHBsaWNhdGlvbi5wcm90b3R5cGUuX3JlZ2lzdGVyUGVuZGluZ1JlY2VpdmVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fcGVuZGluZ1JlY2VpdmVyUmVnaXN0cmF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChmdW5jKSB7IHJldHVybiBmdW5jKF90aGlzLmNvbnRleHQpOyB9KTtcbiAgICAgICAgdGhpcy5fcGVuZGluZ1JlY2VpdmVyUmVnaXN0cmF0aW9ucy5sZW5ndGggPSAwO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFuZHJvaWRBcHBsaWNhdGlvbi5wcm90b3R5cGUsIFwib3JpZW50YXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fb3JpZW50YXRpb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzb3VyY2VzID0gdGhpcy5jb250ZXh0LmdldFJlc291cmNlcygpO1xuICAgICAgICAgICAgICAgIHZhciBjb25maWd1cmF0aW9uID0gcmVzb3VyY2VzLmdldENvbmZpZ3VyYXRpb24oKTtcbiAgICAgICAgICAgICAgICB2YXIgb3JpZW50YXRpb25fMSA9IGNvbmZpZ3VyYXRpb24ub3JpZW50YXRpb247XG4gICAgICAgICAgICAgICAgdGhpcy5fb3JpZW50YXRpb24gPSBnZXRPcmllbnRhdGlvblZhbHVlKG9yaWVudGF0aW9uXzEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29yaWVudGF0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fb3JpZW50YXRpb24gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQW5kcm9pZEFwcGxpY2F0aW9uLnByb3RvdHlwZS5yZWdpc3RlckJyb2FkY2FzdFJlY2VpdmVyID0gZnVuY3Rpb24gKGludGVudEZpbHRlciwgb25SZWNlaXZlQ2FsbGJhY2spIHtcbiAgICAgICAgZW5zdXJlQnJvYWRDYXN0UmVjZWl2ZXJDbGFzcygpO1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHZhciByZWdpc3RlckZ1bmMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIHJlY2VpdmVyID0gbmV3IEJyb2FkY2FzdFJlY2VpdmVyQ2xhc3Mob25SZWNlaXZlQ2FsbGJhY2spO1xuICAgICAgICAgICAgY29udGV4dC5yZWdpc3RlclJlY2VpdmVyKHJlY2VpdmVyLCBuZXcgYW5kcm9pZC5jb250ZW50LkludGVudEZpbHRlcihpbnRlbnRGaWx0ZXIpKTtcbiAgICAgICAgICAgIHRoYXQuX3JlZ2lzdGVyZWRSZWNlaXZlcnNbaW50ZW50RmlsdGVyXSA9IHJlY2VpdmVyO1xuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5jb250ZXh0KSB7XG4gICAgICAgICAgICByZWdpc3RlckZ1bmModGhpcy5jb250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdSZWNlaXZlclJlZ2lzdHJhdGlvbnMucHVzaChyZWdpc3RlckZ1bmMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBbmRyb2lkQXBwbGljYXRpb24ucHJvdG90eXBlLnVucmVnaXN0ZXJCcm9hZGNhc3RSZWNlaXZlciA9IGZ1bmN0aW9uIChpbnRlbnRGaWx0ZXIpIHtcbiAgICAgICAgdmFyIHJlY2VpdmVyID0gdGhpcy5fcmVnaXN0ZXJlZFJlY2VpdmVyc1tpbnRlbnRGaWx0ZXJdO1xuICAgICAgICBpZiAocmVjZWl2ZXIpIHtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC51bnJlZ2lzdGVyUmVjZWl2ZXIocmVjZWl2ZXIpO1xuICAgICAgICAgICAgdGhpcy5fcmVnaXN0ZXJlZFJlY2VpdmVyc1tpbnRlbnRGaWx0ZXJdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3JlZ2lzdGVyZWRSZWNlaXZlcnNbaW50ZW50RmlsdGVyXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQW5kcm9pZEFwcGxpY2F0aW9uLmFjdGl2aXR5Q3JlYXRlZEV2ZW50ID0gQWN0aXZpdHlDcmVhdGVkO1xuICAgIEFuZHJvaWRBcHBsaWNhdGlvbi5hY3Rpdml0eURlc3Ryb3llZEV2ZW50ID0gQWN0aXZpdHlEZXN0cm95ZWQ7XG4gICAgQW5kcm9pZEFwcGxpY2F0aW9uLmFjdGl2aXR5U3RhcnRlZEV2ZW50ID0gQWN0aXZpdHlTdGFydGVkO1xuICAgIEFuZHJvaWRBcHBsaWNhdGlvbi5hY3Rpdml0eVBhdXNlZEV2ZW50ID0gQWN0aXZpdHlQYXVzZWQ7XG4gICAgQW5kcm9pZEFwcGxpY2F0aW9uLmFjdGl2aXR5UmVzdW1lZEV2ZW50ID0gQWN0aXZpdHlSZXN1bWVkO1xuICAgIEFuZHJvaWRBcHBsaWNhdGlvbi5hY3Rpdml0eVN0b3BwZWRFdmVudCA9IEFjdGl2aXR5U3RvcHBlZDtcbiAgICBBbmRyb2lkQXBwbGljYXRpb24uc2F2ZUFjdGl2aXR5U3RhdGVFdmVudCA9IFNhdmVBY3Rpdml0eVN0YXRlO1xuICAgIEFuZHJvaWRBcHBsaWNhdGlvbi5hY3Rpdml0eVJlc3VsdEV2ZW50ID0gQWN0aXZpdHlSZXN1bHQ7XG4gICAgQW5kcm9pZEFwcGxpY2F0aW9uLmFjdGl2aXR5QmFja1ByZXNzZWRFdmVudCA9IEFjdGl2aXR5QmFja1ByZXNzZWQ7XG4gICAgQW5kcm9pZEFwcGxpY2F0aW9uLmFjdGl2aXR5TmV3SW50ZW50RXZlbnQgPSBBY3Rpdml0eU5ld0ludGVudDtcbiAgICBBbmRyb2lkQXBwbGljYXRpb24uYWN0aXZpdHlSZXF1ZXN0UGVybWlzc2lvbnNFdmVudCA9IEFjdGl2aXR5UmVxdWVzdFBlcm1pc3Npb25zO1xuICAgIHJldHVybiBBbmRyb2lkQXBwbGljYXRpb247XG59KGFwcGxpY2F0aW9uX2NvbW1vbl8xLk9ic2VydmFibGUpKTtcbmV4cG9ydHMuQW5kcm9pZEFwcGxpY2F0aW9uID0gQW5kcm9pZEFwcGxpY2F0aW9uO1xudmFyIGFuZHJvaWRBcHAgPSBuZXcgQW5kcm9pZEFwcGxpY2F0aW9uKCk7XG5leHBvcnRzLmFuZHJvaWQgPSBhbmRyb2lkQXBwO1xuYXBwbGljYXRpb25fY29tbW9uXzEuc2V0QXBwbGljYXRpb24oYW5kcm9pZEFwcCk7XG52YXIgbWFpbkVudHJ5O1xudmFyIHN0YXJ0ZWQgPSBmYWxzZTtcbnZhciBjcmVhdGVSb290RnJhbWUgPSB7IHZhbHVlOiB0cnVlIH07XG5mdW5jdGlvbiBfc3RhcnQoZW50cnkpIHtcbiAgICBpZiAoc3RhcnRlZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBcHBsaWNhdGlvbiBpcyBhbHJlYWR5IHN0YXJ0ZWQuXCIpO1xuICAgIH1cbiAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICBtYWluRW50cnkgPSB0eXBlb2YgZW50cnkgPT09IFwic3RyaW5nXCIgPyB7IG1vZHVsZU5hbWU6IGVudHJ5IH0gOiBlbnRyeTtcbiAgICBpZiAoIWFuZHJvaWRBcHAubmF0aXZlQXBwKSB7XG4gICAgICAgIHZhciBuYXRpdmVBcHAgPSBnZXROYXRpdmVBcHBsaWNhdGlvbigpO1xuICAgICAgICBhbmRyb2lkQXBwLmluaXQobmF0aXZlQXBwKTtcbiAgICB9XG59XG5leHBvcnRzLl9zdGFydCA9IF9zdGFydDtcbmZ1bmN0aW9uIF9zaG91bGRDcmVhdGVSb290RnJhbWUoKSB7XG4gICAgcmV0dXJuIGNyZWF0ZVJvb3RGcmFtZS52YWx1ZTtcbn1cbmV4cG9ydHMuX3Nob3VsZENyZWF0ZVJvb3RGcmFtZSA9IF9zaG91bGRDcmVhdGVSb290RnJhbWU7XG5mdW5jdGlvbiBydW4oZW50cnkpIHtcbiAgICBjcmVhdGVSb290RnJhbWUudmFsdWUgPSBmYWxzZTtcbiAgICBfc3RhcnQoZW50cnkpO1xufVxuZXhwb3J0cy5ydW4gPSBydW47XG5mdW5jdGlvbiBhZGRDc3MoY3NzVGV4dCkge1xuICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLm5vdGlmeSh7IGV2ZW50TmFtZTogXCJjc3NDaGFuZ2VkXCIsIG9iamVjdDogYW5kcm9pZEFwcCwgY3NzVGV4dDogY3NzVGV4dCB9KTtcbiAgICB2YXIgcm9vdFZpZXcgPSBnZXRSb290VmlldygpO1xuICAgIGlmIChyb290Vmlldykge1xuICAgICAgICByb290Vmlldy5fb25Dc3NTdGF0ZUNoYW5nZSgpO1xuICAgIH1cbn1cbmV4cG9ydHMuYWRkQ3NzID0gYWRkQ3NzO1xudmFyIENBTExCQUNLUyA9IFwiX2NhbGxiYWNrc1wiO1xuZnVuY3Rpb24gX3Jlc2V0Um9vdFZpZXcoZW50cnkpIHtcbiAgICB2YXIgYWN0aXZpdHkgPSBhbmRyb2lkQXBwLmZvcmVncm91bmRBY3Rpdml0eTtcbiAgICBpZiAoIWFjdGl2aXR5KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIGFuZHJvaWQgYWN0aXZpdHkuXCIpO1xuICAgIH1cbiAgICBjcmVhdGVSb290RnJhbWUudmFsdWUgPSBmYWxzZTtcbiAgICBtYWluRW50cnkgPSB0eXBlb2YgZW50cnkgPT09IFwic3RyaW5nXCIgPyB7IG1vZHVsZU5hbWU6IGVudHJ5IH0gOiBlbnRyeTtcbiAgICB2YXIgY2FsbGJhY2tzID0gYWN0aXZpdHlbQ0FMTEJBQ0tTXTtcbiAgICBpZiAoIWNhbGxiYWNrcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBhbmRyb2lkIGFjdGl2aXR5IGNhbGxiYWNrcy5cIik7XG4gICAgfVxuICAgIGNhbGxiYWNrcy5yZXNldEFjdGl2aXR5Q29udGVudChhY3Rpdml0eSk7XG59XG5leHBvcnRzLl9yZXNldFJvb3RWaWV3ID0gX3Jlc2V0Um9vdFZpZXc7XG5mdW5jdGlvbiBnZXRNYWluRW50cnkoKSB7XG4gICAgcmV0dXJuIG1haW5FbnRyeTtcbn1cbmV4cG9ydHMuZ2V0TWFpbkVudHJ5ID0gZ2V0TWFpbkVudHJ5O1xuZnVuY3Rpb24gZ2V0Um9vdFZpZXcoKSB7XG4gICAgdmFyIGFjdGl2aXR5ID0gYW5kcm9pZEFwcC5mb3JlZ3JvdW5kQWN0aXZpdHkgfHwgYW5kcm9pZEFwcC5zdGFydEFjdGl2aXR5O1xuICAgIGlmICghYWN0aXZpdHkpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgdmFyIGNhbGxiYWNrcyA9IGFjdGl2aXR5W0NBTExCQUNLU107XG4gICAgcmV0dXJuIGNhbGxiYWNrcyA/IGNhbGxiYWNrcy5nZXRSb290VmlldygpIDogdW5kZWZpbmVkO1xufVxuZXhwb3J0cy5nZXRSb290VmlldyA9IGdldFJvb3RWaWV3O1xuZnVuY3Rpb24gZ2V0TmF0aXZlQXBwbGljYXRpb24oKSB7XG4gICAgdmFyIG5hdGl2ZUFwcCA9IGFuZHJvaWRBcHAubmF0aXZlQXBwO1xuICAgIGlmICghbmF0aXZlQXBwKSB7XG4gICAgICAgIGlmICghbmF0aXZlQXBwICYmIGNvbS50bnMuTmF0aXZlU2NyaXB0QXBwbGljYXRpb24pIHtcbiAgICAgICAgICAgIG5hdGl2ZUFwcCA9IGNvbS50bnMuTmF0aXZlU2NyaXB0QXBwbGljYXRpb24uZ2V0SW5zdGFuY2UoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW5hdGl2ZUFwcCkge1xuICAgICAgICAgICAgdmFyIGNsYXp6ID0gamF2YS5sYW5nLkNsYXNzLmZvck5hbWUoXCJhbmRyb2lkLmFwcC5BY3Rpdml0eVRocmVhZFwiKTtcbiAgICAgICAgICAgIGlmIChjbGF6eikge1xuICAgICAgICAgICAgICAgIHZhciBtZXRob2QgPSBjbGF6ei5nZXRNZXRob2QoXCJjdXJyZW50QXBwbGljYXRpb25cIiwgbnVsbCk7XG4gICAgICAgICAgICAgICAgaWYgKG1ldGhvZCkge1xuICAgICAgICAgICAgICAgICAgICBuYXRpdmVBcHAgPSBtZXRob2QuaW52b2tlKG51bGwsIG51bGwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIW5hdGl2ZUFwcCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIHJldHJpZXZlIG5hdGl2ZSBBbmRyb2lkIEFwcGxpY2F0aW9uIG9iamVjdC4gSWYgeW91IGhhdmUgYSBjdXN0b20gYW5kcm9pZC5hcHAuQXBwbGljYXRpb24gdHlwZSBpbXBsZW1lbnRlZCBtYWtlIHN1cmUgdGhhdCB5b3UndmUgY2FsbGVkIHRoZSAnPGFwcGxpY2F0aW9uLW1vZHVsZT4uYW5kcm9pZC5pbml0JyBtZXRob2QuXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuYXRpdmVBcHA7XG59XG5leHBvcnRzLmdldE5hdGl2ZUFwcGxpY2F0aW9uID0gZ2V0TmF0aXZlQXBwbGljYXRpb247XG5hcHBsaWNhdGlvbl9jb21tb25fMS5vbihhcHBsaWNhdGlvbl9jb21tb25fMS5vcmllbnRhdGlvbkNoYW5nZWRFdmVudCwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICB2YXIgcm9vdFZpZXcgPSBnZXRSb290VmlldygpO1xuICAgIGlmIChyb290Vmlldykge1xuICAgICAgICBhcHBsaWNhdGlvbl9jb21tb25fMS5vcmllbnRhdGlvbkNoYW5nZWQocm9vdFZpZXcsIGFyZ3MubmV3VmFsdWUpO1xuICAgIH1cbn0pO1xuZ2xvYmFsLl9fb25MaXZlU3luYyA9IGZ1bmN0aW9uIF9fb25MaXZlU3luYyhjb250ZXh0KSB7XG4gICAgaWYgKGFuZHJvaWRBcHAgJiYgYW5kcm9pZEFwcC5wYXVzZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgcm9vdFZpZXcgPSBnZXRSb290VmlldygpO1xuICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLmxpdmVzeW5jKHJvb3RWaWV3LCBjb250ZXh0KTtcbn07XG5mdW5jdGlvbiBnZXRPcmllbnRhdGlvblZhbHVlKG9yaWVudGF0aW9uKSB7XG4gICAgc3dpdGNoIChvcmllbnRhdGlvbikge1xuICAgICAgICBjYXNlIGFuZHJvaWQuY29udGVudC5yZXMuQ29uZmlndXJhdGlvbi5PUklFTlRBVElPTl9MQU5EU0NBUEU6XG4gICAgICAgICAgICByZXR1cm4gXCJsYW5kc2NhcGVcIjtcbiAgICAgICAgY2FzZSBhbmRyb2lkLmNvbnRlbnQucmVzLkNvbmZpZ3VyYXRpb24uT1JJRU5UQVRJT05fUE9SVFJBSVQ6XG4gICAgICAgICAgICByZXR1cm4gXCJwb3J0cmFpdFwiO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIFwidW5rbm93blwiO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGluaXRMaWZlY3ljbGVDYWxsYmFja3MoKSB7XG4gICAgdmFyIHNldFRoZW1lT25MYXVuY2ggPSBwcm9maWxpbmdfMS5wcm9maWxlKFwic2V0VGhlbWVPbkxhdW5jaFwiLCBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcbiAgICAgICAgdmFyIGFjdGl2aXR5SW5mbyA9IGFjdGl2aXR5LmdldFBhY2thZ2VNYW5hZ2VyKCkuZ2V0QWN0aXZpdHlJbmZvKGFjdGl2aXR5LmdldENvbXBvbmVudE5hbWUoKSwgYW5kcm9pZC5jb250ZW50LnBtLlBhY2thZ2VNYW5hZ2VyLkdFVF9NRVRBX0RBVEEpO1xuICAgICAgICBpZiAoYWN0aXZpdHlJbmZvLm1ldGFEYXRhKSB7XG4gICAgICAgICAgICB2YXIgc2V0VGhlbWVPbkxhdW5jaF8xID0gYWN0aXZpdHlJbmZvLm1ldGFEYXRhLmdldEludChcIlNFVF9USEVNRV9PTl9MQVVOQ0hcIiwgLTEpO1xuICAgICAgICAgICAgaWYgKHNldFRoZW1lT25MYXVuY2hfMSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBhY3Rpdml0eS5zZXRUaGVtZShzZXRUaGVtZU9uTGF1bmNoXzEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG4gICAgdmFyIG5vdGlmeUFjdGl2aXR5Q3JlYXRlZCA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJub3RpZnlBY3Rpdml0eUNyZWF0ZWRcIiwgZnVuY3Rpb24gKGFjdGl2aXR5LCBzYXZlZEluc3RhbmNlU3RhdGUpIHtcbiAgICAgICAgYW5kcm9pZEFwcC5ub3RpZnkoeyBldmVudE5hbWU6IEFjdGl2aXR5Q3JlYXRlZCwgb2JqZWN0OiBhbmRyb2lkQXBwLCBhY3Rpdml0eTogYWN0aXZpdHksIGJ1bmRsZTogc2F2ZWRJbnN0YW5jZVN0YXRlIH0pO1xuICAgIH0pO1xuICAgIHZhciBzdWJzY3JpYmVGb3JHbG9iYWxMYXlvdXQgPSBwcm9maWxpbmdfMS5wcm9maWxlKFwic3Vic2NyaWJlRm9yR2xvYmFsTGF5b3V0XCIsIGZ1bmN0aW9uIChhY3Rpdml0eSkge1xuICAgICAgICB2YXIgcm9vdFZpZXcgPSBhY3Rpdml0eS5nZXRXaW5kb3coKS5nZXREZWNvclZpZXcoKS5nZXRSb290VmlldygpO1xuICAgICAgICBnbG9iYWwub25HbG9iYWxMYXlvdXRMaXN0ZW5lciA9IG5ldyBhbmRyb2lkLnZpZXcuVmlld1RyZWVPYnNlcnZlci5Pbkdsb2JhbExheW91dExpc3RlbmVyKHtcbiAgICAgICAgICAgIG9uR2xvYmFsTGF5b3V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25fY29tbW9uXzEubm90aWZ5KHsgZXZlbnROYW1lOiBhcHBsaWNhdGlvbl9jb21tb25fMS5kaXNwbGF5ZWRFdmVudCwgb2JqZWN0OiBhbmRyb2lkQXBwLCBhY3Rpdml0eTogYWN0aXZpdHkgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHZpZXdUcmVlT2JzZXJ2ZXIgPSByb290Vmlldy5nZXRWaWV3VHJlZU9ic2VydmVyKCk7XG4gICAgICAgICAgICAgICAgdmlld1RyZWVPYnNlcnZlci5yZW1vdmVPbkdsb2JhbExheW91dExpc3RlbmVyKGdsb2JhbC5vbkdsb2JhbExheW91dExpc3RlbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJvb3RWaWV3LmdldFZpZXdUcmVlT2JzZXJ2ZXIoKS5hZGRPbkdsb2JhbExheW91dExpc3RlbmVyKGdsb2JhbC5vbkdsb2JhbExheW91dExpc3RlbmVyKTtcbiAgICB9KTtcbiAgICB2YXIgbGlmZWN5Y2xlQ2FsbGJhY2tzID0gbmV3IGFuZHJvaWQuYXBwLkFwcGxpY2F0aW9uLkFjdGl2aXR5TGlmZWN5Y2xlQ2FsbGJhY2tzKHtcbiAgICAgICAgb25BY3Rpdml0eUNyZWF0ZWQ6IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJvbkFjdGl2aXR5Q3JlYXRlZFwiLCBmdW5jdGlvbiAoYWN0aXZpdHksIHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICAgICAgc2V0VGhlbWVPbkxhdW5jaChhY3Rpdml0eSk7XG4gICAgICAgICAgICBpZiAoIWFuZHJvaWRBcHAuc3RhcnRBY3Rpdml0eSkge1xuICAgICAgICAgICAgICAgIGFuZHJvaWRBcHAuc3RhcnRBY3Rpdml0eSA9IGFjdGl2aXR5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm90aWZ5QWN0aXZpdHlDcmVhdGVkKGFjdGl2aXR5LCBzYXZlZEluc3RhbmNlU3RhdGUpO1xuICAgICAgICAgICAgaWYgKGFwcGxpY2F0aW9uX2NvbW1vbl8xLmhhc0xpc3RlbmVycyhhcHBsaWNhdGlvbl9jb21tb25fMS5kaXNwbGF5ZWRFdmVudCkpIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpYmVGb3JHbG9iYWxMYXlvdXQoYWN0aXZpdHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSxcbiAgICAgICAgb25BY3Rpdml0eURlc3Ryb3llZDogcHJvZmlsaW5nXzEucHJvZmlsZShcIm9uQWN0aXZpdHlEZXN0cm95ZWRcIiwgZnVuY3Rpb24gKGFjdGl2aXR5KSB7XG4gICAgICAgICAgICBpZiAoYWN0aXZpdHkgPT09IGFuZHJvaWRBcHAuZm9yZWdyb3VuZEFjdGl2aXR5KSB7XG4gICAgICAgICAgICAgICAgYW5kcm9pZEFwcC5mb3JlZ3JvdW5kQWN0aXZpdHkgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYWN0aXZpdHkgPT09IGFuZHJvaWRBcHAuc3RhcnRBY3Rpdml0eSkge1xuICAgICAgICAgICAgICAgIGFuZHJvaWRBcHAuc3RhcnRBY3Rpdml0eSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFuZHJvaWRBcHAubm90aWZ5KHsgZXZlbnROYW1lOiBBY3Rpdml0eURlc3Ryb3llZCwgb2JqZWN0OiBhbmRyb2lkQXBwLCBhY3Rpdml0eTogYWN0aXZpdHkgfSk7XG4gICAgICAgICAgICBnYygpO1xuICAgICAgICB9KSxcbiAgICAgICAgb25BY3Rpdml0eVBhdXNlZDogcHJvZmlsaW5nXzEucHJvZmlsZShcIm9uQWN0aXZpdHlQYXVzZWRcIiwgZnVuY3Rpb24gKGFjdGl2aXR5KSB7XG4gICAgICAgICAgICBpZiAoYWN0aXZpdHkuaXNOYXRpdmVTY3JpcHRBY3Rpdml0eSkge1xuICAgICAgICAgICAgICAgIGFuZHJvaWRBcHAucGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbl9jb21tb25fMS5ub3RpZnkoeyBldmVudE5hbWU6IGFwcGxpY2F0aW9uX2NvbW1vbl8xLnN1c3BlbmRFdmVudCwgb2JqZWN0OiBhbmRyb2lkQXBwLCBhbmRyb2lkOiBhY3Rpdml0eSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFuZHJvaWRBcHAubm90aWZ5KHsgZXZlbnROYW1lOiBBY3Rpdml0eVBhdXNlZCwgb2JqZWN0OiBhbmRyb2lkQXBwLCBhY3Rpdml0eTogYWN0aXZpdHkgfSk7XG4gICAgICAgIH0pLFxuICAgICAgICBvbkFjdGl2aXR5UmVzdW1lZDogcHJvZmlsaW5nXzEucHJvZmlsZShcIm9uQWN0aXZpdHlSZXN1bWVkXCIsIGZ1bmN0aW9uIChhY3Rpdml0eSkge1xuICAgICAgICAgICAgYW5kcm9pZEFwcC5mb3JlZ3JvdW5kQWN0aXZpdHkgPSBhY3Rpdml0eTtcbiAgICAgICAgICAgIGFuZHJvaWRBcHAubm90aWZ5KHsgZXZlbnROYW1lOiBBY3Rpdml0eVJlc3VtZWQsIG9iamVjdDogYW5kcm9pZEFwcCwgYWN0aXZpdHk6IGFjdGl2aXR5IH0pO1xuICAgICAgICB9KSxcbiAgICAgICAgb25BY3Rpdml0eVNhdmVJbnN0YW5jZVN0YXRlOiBwcm9maWxpbmdfMS5wcm9maWxlKFwib25BY3Rpdml0eVNhdmVJbnN0YW5jZVN0YXRlXCIsIGZ1bmN0aW9uIChhY3Rpdml0eSwgb3V0U3RhdGUpIHtcbiAgICAgICAgICAgIGFuZHJvaWRBcHAubm90aWZ5KHsgZXZlbnROYW1lOiBTYXZlQWN0aXZpdHlTdGF0ZSwgb2JqZWN0OiBhbmRyb2lkQXBwLCBhY3Rpdml0eTogYWN0aXZpdHksIGJ1bmRsZTogb3V0U3RhdGUgfSk7XG4gICAgICAgIH0pLFxuICAgICAgICBvbkFjdGl2aXR5U3RhcnRlZDogcHJvZmlsaW5nXzEucHJvZmlsZShcIm9uQWN0aXZpdHlTdGFydGVkXCIsIGZ1bmN0aW9uIChhY3Rpdml0eSkge1xuICAgICAgICAgICAgYW5kcm9pZEFwcC5ub3RpZnkoeyBldmVudE5hbWU6IEFjdGl2aXR5U3RhcnRlZCwgb2JqZWN0OiBhbmRyb2lkQXBwLCBhY3Rpdml0eTogYWN0aXZpdHkgfSk7XG4gICAgICAgIH0pLFxuICAgICAgICBvbkFjdGl2aXR5U3RvcHBlZDogcHJvZmlsaW5nXzEucHJvZmlsZShcIm9uQWN0aXZpdHlTdG9wcGVkXCIsIGZ1bmN0aW9uIChhY3Rpdml0eSkge1xuICAgICAgICAgICAgYW5kcm9pZEFwcC5ub3RpZnkoeyBldmVudE5hbWU6IEFjdGl2aXR5U3RvcHBlZCwgb2JqZWN0OiBhbmRyb2lkQXBwLCBhY3Rpdml0eTogYWN0aXZpdHkgfSk7XG4gICAgICAgIH0pXG4gICAgfSk7XG4gICAgcmV0dXJuIGxpZmVjeWNsZUNhbGxiYWNrcztcbn1cbmZ1bmN0aW9uIGluaXRDb21wb25lbnRDYWxsYmFja3MoKSB7XG4gICAgdmFyIGNvbXBvbmVudENhbGxiYWNrcyA9IG5ldyBhbmRyb2lkLmNvbnRlbnQuQ29tcG9uZW50Q2FsbGJhY2tzMih7XG4gICAgICAgIG9uTG93TWVtb3J5OiBwcm9maWxpbmdfMS5wcm9maWxlKFwib25Mb3dNZW1vcnlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZ2MoKTtcbiAgICAgICAgICAgIGphdmEubGFuZy5TeXN0ZW0uZ2MoKTtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLm5vdGlmeSh7IGV2ZW50TmFtZTogYXBwbGljYXRpb25fY29tbW9uXzEubG93TWVtb3J5RXZlbnQsIG9iamVjdDogdGhpcywgYW5kcm9pZDogdGhpcyB9KTtcbiAgICAgICAgfSksXG4gICAgICAgIG9uVHJpbU1lbW9yeTogcHJvZmlsaW5nXzEucHJvZmlsZShcIm9uVHJpbU1lbW9yeVwiLCBmdW5jdGlvbiAobGV2ZWwpIHtcbiAgICAgICAgfSksXG4gICAgICAgIG9uQ29uZmlndXJhdGlvbkNoYW5nZWQ6IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJvbkNvbmZpZ3VyYXRpb25DaGFuZ2VkXCIsIGZ1bmN0aW9uIChuZXdDb25maWcpIHtcbiAgICAgICAgICAgIHZhciBuZXdDb25maWdPcmllbnRhdGlvbiA9IG5ld0NvbmZpZy5vcmllbnRhdGlvbjtcbiAgICAgICAgICAgIHZhciBuZXdPcmllbnRhdGlvbiA9IGdldE9yaWVudGF0aW9uVmFsdWUobmV3Q29uZmlnT3JpZW50YXRpb24pO1xuICAgICAgICAgICAgaWYgKGFuZHJvaWRBcHAub3JpZW50YXRpb24gIT09IG5ld09yaWVudGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgYW5kcm9pZEFwcC5vcmllbnRhdGlvbiA9IG5ld09yaWVudGF0aW9uO1xuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLm5vdGlmeSh7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50TmFtZTogYXBwbGljYXRpb25fY29tbW9uXzEub3JpZW50YXRpb25DaGFuZ2VkRXZlbnQsXG4gICAgICAgICAgICAgICAgICAgIGFuZHJvaWQ6IGFuZHJvaWRBcHAubmF0aXZlQXBwLFxuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZTogYW5kcm9pZEFwcC5vcmllbnRhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0OiBhbmRyb2lkQXBwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSk7XG4gICAgcmV0dXJuIGNvbXBvbmVudENhbGxiYWNrcztcbn1cbnZhciBCcm9hZGNhc3RSZWNlaXZlckNsYXNzO1xuZnVuY3Rpb24gZW5zdXJlQnJvYWRDYXN0UmVjZWl2ZXJDbGFzcygpIHtcbiAgICBpZiAoQnJvYWRjYXN0UmVjZWl2ZXJDbGFzcykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBCcm9hZGNhc3RSZWNlaXZlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhCcm9hZGNhc3RSZWNlaXZlciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gQnJvYWRjYXN0UmVjZWl2ZXIob25SZWNlaXZlQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5fb25SZWNlaXZlQ2FsbGJhY2sgPSBvblJlY2VpdmVDYWxsYmFjaztcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIEJyb2FkY2FzdFJlY2VpdmVyLnByb3RvdHlwZS5vblJlY2VpdmUgPSBmdW5jdGlvbiAoY29udGV4dCwgaW50ZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fb25SZWNlaXZlQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vblJlY2VpdmVDYWxsYmFjayhjb250ZXh0LCBpbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gQnJvYWRjYXN0UmVjZWl2ZXI7XG4gICAgfShhbmRyb2lkLmNvbnRlbnQuQnJvYWRjYXN0UmVjZWl2ZXIpKTtcbiAgICBCcm9hZGNhc3RSZWNlaXZlckNsYXNzID0gQnJvYWRjYXN0UmVjZWl2ZXI7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHBsaWNhdGlvbi5hbmRyb2lkLmpzLm1hcCIsImlmIChnbG9iYWwuVE5TX1dFQlBBQ0spIHtcbiAgICByZXF1aXJlKFwiZ2xvYmFsc1wiKTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ0ZXh0L2Zvcm1hdHRlZC1zdHJpbmdcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdGV4dC9mb3JtYXR0ZWQtc3RyaW5nXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ0ZXh0L3NwYW5cIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdGV4dC9zcGFuXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9hY3Rpb24tYmFyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL2FjdGlvbi1iYXJcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2FjdGl2aXR5LWluZGljYXRvclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9hY3Rpdml0eS1pbmRpY2F0b3JcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2JvcmRlclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9ib3JkZXJcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2JvdHRvbS1uYXZpZ2F0aW9uXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL2JvdHRvbS1uYXZpZ2F0aW9uXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9idXR0b25cIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvYnV0dG9uXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9jb250ZW50LXZpZXdcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvY29udGVudC12aWV3XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9kYXRlLXBpY2tlclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9kYXRlLXBpY2tlclwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvZnJhbWVcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvZnJhbWVcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2h0bWwtdmlld1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9odG1sLXZpZXdcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2ltYWdlXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL2ltYWdlXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9sYWJlbFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9sYWJlbFwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvbGF5b3V0cy9hYnNvbHV0ZS1sYXlvdXRcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvbGF5b3V0cy9hYnNvbHV0ZS1sYXlvdXRcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2xheW91dHMvZG9jay1sYXlvdXRcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvbGF5b3V0cy9kb2NrLWxheW91dFwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvbGF5b3V0cy9ncmlkLWxheW91dFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9sYXlvdXRzL2dyaWQtbGF5b3V0XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9sYXlvdXRzL3N0YWNrLWxheW91dFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9sYXlvdXRzL3N0YWNrLWxheW91dFwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvbGF5b3V0cy9mbGV4Ym94LWxheW91dFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9sYXlvdXRzL2ZsZXhib3gtbGF5b3V0XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9sYXlvdXRzL3dyYXAtbGF5b3V0XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL2xheW91dHMvd3JhcC1sYXlvdXRcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2xpc3QtcGlja2VyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL2xpc3QtcGlja2VyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9wYWdlXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL3BhZ2VcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3BsYWNlaG9sZGVyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL3BsYWNlaG9sZGVyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9wcm9ncmVzc1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9wcm9ncmVzc1wiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvcHJveHktdmlldy1jb250YWluZXJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvcHJveHktdmlldy1jb250YWluZXJcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3JlcGVhdGVyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL3JlcGVhdGVyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9zY3JvbGwtdmlld1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9zY3JvbGwtdmlld1wiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvc2VhcmNoLWJhclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9zZWFyY2gtYmFyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9zZWdtZW50ZWQtYmFyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL3NlZ21lbnRlZC1iYXJcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3NsaWRlclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9zbGlkZXJcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3N3aXRjaFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9zd2l0Y2hcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3RhYi12aWV3XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL3RhYi12aWV3XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcFwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXAtaXRlbVwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcC1pdGVtXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1jb250ZW50LWl0ZW1cIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItY29udGVudC1pdGVtXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS90YWJzXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL3RhYnNcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3dlYi12aWV3XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL3dlYi12aWV3XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS90ZXh0LWZpZWxkXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL3RleHQtZmllbGRcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3RleHQtdmlld1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS90ZXh0LXZpZXdcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3RpbWUtcGlja2VyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL3RpbWUtcGlja2VyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9saXN0LXZpZXdcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvbGlzdC12aWV3XCIpOyB9KTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJ1bmRsZS1lbnRyeS1wb2ludHMuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHR5cGVzID0gcmVxdWlyZShcIi4uL3V0aWxzL3R5cGVzXCIpO1xudmFyIGtub3duQ29sb3JzID0gcmVxdWlyZShcIi4va25vd24tY29sb3JzXCIpO1xudmFyIFNIQVJQID0gXCIjXCI7XG52YXIgSEVYX1JFR0VYID0gLyheI1swLTlBLUZdezZ9JCl8KF4jWzAtOUEtRl17M30kKXwoXiNbMC05QS1GXXs4fSQpL2k7XG52YXIgQ29sb3IgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENvbG9yKCkge1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIGlmICh0eXBlcy5pc1N0cmluZyhhcmcpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzUmdiT3JSZ2JhKGFyZykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXJnYiA9IGFyZ2JGcm9tUmdiT3JSZ2JhKGFyZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGtub3duQ29sb3JzLmlzS25vd25OYW1lKGFyZykpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhleCA9IGtub3duQ29sb3JzLmdldEtub3duQ29sb3IoYXJnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbmFtZSA9IGFyZztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXJnYiA9IHRoaXMuX2FyZ2JGcm9tU3RyaW5nKGhleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKEhFWF9SRUdFWC50ZXN0KGFyZykpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhleCA9IHRoaXMuX25vcm1hbGl6ZUhleChhcmcpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hcmdiID0gdGhpcy5fYXJnYkZyb21TdHJpbmcoaGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgY29sb3I6IFwiICsgYXJnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlcy5pc051bWJlcihhcmcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXJnYiA9IGFyZyA+Pj4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV4cGVjdGVkIDEgb3IgNCBjb25zdHJ1Y3RvciBwYXJhbWV0ZXJzLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSA0KSB7XG4gICAgICAgICAgICB0aGlzLl9hcmdiID0gKGFyZ3VtZW50c1swXSAmIDB4RkYpICogMHgwMTAwMDAwMFxuICAgICAgICAgICAgICAgICsgKGFyZ3VtZW50c1sxXSAmIDB4RkYpICogMHgwMDAxMDAwMFxuICAgICAgICAgICAgICAgICsgKGFyZ3VtZW50c1syXSAmIDB4RkYpICogMHgwMDAwMDEwMFxuICAgICAgICAgICAgICAgICsgKGFyZ3VtZW50c1szXSAmIDB4RkYpICogMHgwMDAwMDAwMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV4cGVjdGVkIDEgb3IgNCBjb25zdHJ1Y3RvciBwYXJhbWV0ZXJzLlwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImFcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzLl9hcmdiIC8gMHgwMTAwMDAwMCkgJiAweEZGOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcInJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzLl9hcmdiIC8gMHgwMDAxMDAwMCkgJiAweEZGOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzLl9hcmdiIC8gMHgwMDAwMDEwMCkgJiAweEZGOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzLl9hcmdiIC8gMHgwMDAwMDAwMSkgJiAweEZGOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImFyZ2JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcmdiO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImhleFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYSA9PT0gMHhGRikge1xuICAgICAgICAgICAgICAgIHJldHVybiAoXCIjXCIgKyB0aGlzLl9jb21wb25lbnRUb0hleCh0aGlzLnIpICsgdGhpcy5fY29tcG9uZW50VG9IZXgodGhpcy5nKSArIHRoaXMuX2NvbXBvbmVudFRvSGV4KHRoaXMuYikpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFwiI1wiICsgdGhpcy5fY29tcG9uZW50VG9IZXgodGhpcy5hKSArIHRoaXMuX2NvbXBvbmVudFRvSGV4KHRoaXMucikgKyB0aGlzLl9jb21wb25lbnRUb0hleCh0aGlzLmcpICsgdGhpcy5fY29tcG9uZW50VG9IZXgodGhpcy5iKSkudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJuYW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbmFtZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb2xvci5wcm90b3R5cGUsIFwiYW5kcm9pZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQ29sb3IucHJvdG90eXBlLl9hcmdiRnJvbVN0cmluZyA9IGZ1bmN0aW9uIChoZXgpIHtcbiAgICAgICAgaWYgKGhleC5jaGFyQXQoMCkgPT09IFwiI1wiKSB7XG4gICAgICAgICAgICBoZXggPSBoZXguc3Vic3RyKDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChoZXgubGVuZ3RoID09PSAzKSB7XG4gICAgICAgICAgICBoZXggPSBoZXhbMF0gKyBoZXhbMF0gKyBoZXhbMV0gKyBoZXhbMV0gKyBoZXhbMl0gKyBoZXhbMl07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaGV4Lmxlbmd0aCA9PT0gNCkge1xuICAgICAgICAgICAgaGV4ID0gaGV4WzBdICsgaGV4WzBdICsgaGV4WzFdICsgaGV4WzFdICsgaGV4WzJdICsgaGV4WzJdICsgaGV4WzNdICsgaGV4WzNdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnRWYWwgPSBwYXJzZUludChoZXgsIDE2KTtcbiAgICAgICAgaWYgKGhleC5sZW5ndGggPT09IDYpIHtcbiAgICAgICAgICAgIGludFZhbCA9IChpbnRWYWwgJiAweDAwRkZGRkZGKSArIDB4RkYwMDAwMDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGludFZhbDtcbiAgICB9O1xuICAgIENvbG9yLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICYmIHRoaXMuYXJnYiA9PT0gdmFsdWUuYXJnYjtcbiAgICB9O1xuICAgIENvbG9yLmVxdWFscyA9IGZ1bmN0aW9uICh2YWx1ZTEsIHZhbHVlMikge1xuICAgICAgICBpZiAoIXZhbHVlMSAmJiAhdmFsdWUyKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZhbHVlMSB8fCAhdmFsdWUyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlMS5lcXVhbHModmFsdWUyKTtcbiAgICB9O1xuICAgIENvbG9yLmlzVmFsaWQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVzLmlzTnVsbE9yVW5kZWZpbmVkKHZhbHVlKSB8fCB2YWx1ZSBpbnN0YW5jZW9mIENvbG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXR5cGVzLmlzU3RyaW5nKHZhbHVlKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChrbm93bkNvbG9ycy5pc0tub3duTmFtZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBIRVhfUkVHRVgudGVzdCh2YWx1ZSkgfHwgaXNSZ2JPclJnYmEodmFsdWUpO1xuICAgIH07XG4gICAgQ29sb3IucHJvdG90eXBlLl9jb21wb25lbnRUb0hleCA9IGZ1bmN0aW9uIChjb21wb25lbnQpIHtcbiAgICAgICAgdmFyIGhleCA9IGNvbXBvbmVudC50b1N0cmluZygxNik7XG4gICAgICAgIGlmIChoZXgubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICBoZXggPSBcIjBcIiArIGhleDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGV4O1xuICAgIH07XG4gICAgQ29sb3IucHJvdG90eXBlLl9ub3JtYWxpemVIZXggPSBmdW5jdGlvbiAoaGV4U3RyKSB7XG4gICAgICAgIGlmIChoZXhTdHIuY2hhckF0KDApID09PSBTSEFSUCAmJiBoZXhTdHIubGVuZ3RoID09PSA0KSB7XG4gICAgICAgICAgICBoZXhTdHIgPSBoZXhTdHIuY2hhckF0KDApXG4gICAgICAgICAgICAgICAgKyBoZXhTdHIuY2hhckF0KDEpICsgaGV4U3RyLmNoYXJBdCgxKVxuICAgICAgICAgICAgICAgICsgaGV4U3RyLmNoYXJBdCgyKSArIGhleFN0ci5jaGFyQXQoMilcbiAgICAgICAgICAgICAgICArIGhleFN0ci5jaGFyQXQoMykgKyBoZXhTdHIuY2hhckF0KDMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoZXhTdHI7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhleDtcbiAgICB9O1xuICAgIHJldHVybiBDb2xvcjtcbn0oKSk7XG5leHBvcnRzLkNvbG9yID0gQ29sb3I7XG5mdW5jdGlvbiBpc1JnYk9yUmdiYSh2YWx1ZSkge1xuICAgIHZhciB0b0xvd2VyID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICByZXR1cm4gKHRvTG93ZXIuaW5kZXhPZihcInJnYihcIikgPT09IDAgfHwgdG9Mb3dlci5pbmRleE9mKFwicmdiYShcIikgPT09IDApICYmIHRvTG93ZXIuaW5kZXhPZihcIilcIikgPT09ICh0b0xvd2VyLmxlbmd0aCAtIDEpO1xufVxuZnVuY3Rpb24gYXJnYkZyb21SZ2JPclJnYmEodmFsdWUpIHtcbiAgICB2YXIgdG9Mb3dlciA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgdmFyIHBhcnRzID0gdG9Mb3dlci5yZXBsYWNlKFwicmdiYShcIiwgXCJcIikucmVwbGFjZShcInJnYihcIiwgXCJcIikucmVwbGFjZShcIilcIiwgXCJcIikudHJpbSgpLnNwbGl0KFwiLFwiKTtcbiAgICB2YXIgciA9IDI1NTtcbiAgICB2YXIgZyA9IDI1NTtcbiAgICB2YXIgYiA9IDI1NTtcbiAgICB2YXIgYSA9IDI1NTtcbiAgICBpZiAocGFydHNbMF0pIHtcbiAgICAgICAgciA9IHBhcnNlSW50KHBhcnRzWzBdLnRyaW0oKSk7XG4gICAgfVxuICAgIGlmIChwYXJ0c1sxXSkge1xuICAgICAgICBnID0gcGFyc2VJbnQocGFydHNbMV0udHJpbSgpKTtcbiAgICB9XG4gICAgaWYgKHBhcnRzWzJdKSB7XG4gICAgICAgIGIgPSBwYXJzZUludChwYXJ0c1syXS50cmltKCkpO1xuICAgIH1cbiAgICBpZiAocGFydHNbM10pIHtcbiAgICAgICAgYSA9IE1hdGgucm91bmQocGFyc2VGbG9hdChwYXJ0c1szXS50cmltKCkpICogMjU1KTtcbiAgICB9XG4gICAgcmV0dXJuIChhICYgMHhGRikgKiAweDAxMDAwMDAwXG4gICAgICAgICsgKHIgJiAweEZGKSAqIDB4MDAwMTAwMDBcbiAgICAgICAgKyAoZyAmIDB4RkYpICogMHgwMDAwMDEwMFxuICAgICAgICArIChiICYgMHhGRikgKiAweDAwMDAwMDAxO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29sb3ItY29tbW9uLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBjb21tb24gPSByZXF1aXJlKFwiLi9jb2xvci1jb21tb25cIik7XG52YXIgQ29sb3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDb2xvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb2xvcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImFuZHJvaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFyZ2IgPj4gMDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIENvbG9yO1xufShjb21tb24uQ29sb3IpKTtcbmV4cG9ydHMuQ29sb3IgPSBDb2xvcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbG9yLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIF9hbGxDb2xvcnMgPSB7fTtcbmZ1bmN0aW9uIHJlZ2lzdGVyQ29sb3IobmFtZSwgdmFsdWUpIHtcbiAgICBfYWxsQ29sb3JzW25hbWUudG9Mb3dlckNhc2UoKV0gPSB2YWx1ZTtcbiAgICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiBpc0tub3duTmFtZShuYW1lKSB7XG4gICAgaWYgKCFuYW1lKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiBuYW1lLnRvTG93ZXJDYXNlKCkgaW4gX2FsbENvbG9ycztcbn1cbmV4cG9ydHMuaXNLbm93bk5hbWUgPSBpc0tub3duTmFtZTtcbmZ1bmN0aW9uIGdldEtub3duQ29sb3IobmFtZSkge1xuICAgIGlmICghbmFtZSkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gX2FsbENvbG9yc1tuYW1lLnRvTG93ZXJDYXNlKCldO1xufVxuZXhwb3J0cy5nZXRLbm93bkNvbG9yID0gZ2V0S25vd25Db2xvcjtcbmV4cG9ydHMuVHJhbnNwYXJlbnQgPSByZWdpc3RlckNvbG9yKFwiVHJhbnNwYXJlbnRcIiwgXCIjMDAwMDAwMDBcIik7XG5leHBvcnRzLkFsaWNlQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJBbGljZUJsdWVcIiwgXCIjRjBGOEZGXCIpO1xuZXhwb3J0cy5BbnRpcXVlV2hpdGUgPSByZWdpc3RlckNvbG9yKFwiQW50aXF1ZVdoaXRlXCIsIFwiI0ZBRUJEN1wiKTtcbmV4cG9ydHMuQXF1YSA9IHJlZ2lzdGVyQ29sb3IoXCJBcXVhXCIsIFwiIzAwRkZGRlwiKTtcbmV4cG9ydHMuQXF1YW1hcmluZSA9IHJlZ2lzdGVyQ29sb3IoXCJBcXVhbWFyaW5lXCIsIFwiIzdGRkZENFwiKTtcbmV4cG9ydHMuQXp1cmUgPSByZWdpc3RlckNvbG9yKFwiQXp1cmVcIiwgXCIjRjBGRkZGXCIpO1xuZXhwb3J0cy5CZWlnZSA9IHJlZ2lzdGVyQ29sb3IoXCJCZWlnZVwiLCBcIiNGNUY1RENcIik7XG5leHBvcnRzLkJpc3F1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJCaXNxdWVcIiwgXCIjRkZFNEM0XCIpO1xuZXhwb3J0cy5CbGFjayA9IHJlZ2lzdGVyQ29sb3IoXCJCbGFja1wiLCBcIiMwMDAwMDBcIik7XG5leHBvcnRzLkJsYW5jaGVkQWxtb25kID0gcmVnaXN0ZXJDb2xvcihcIkJsYW5jaGVkQWxtb25kXCIsIFwiI0ZGRUJDRFwiKTtcbmV4cG9ydHMuQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJCbHVlXCIsIFwiIzAwMDBGRlwiKTtcbmV4cG9ydHMuQmx1ZVZpb2xldCA9IHJlZ2lzdGVyQ29sb3IoXCJCbHVlVmlvbGV0XCIsIFwiIzhBMkJFMlwiKTtcbmV4cG9ydHMuQnJvd24gPSByZWdpc3RlckNvbG9yKFwiQnJvd25cIiwgXCIjQTUyQTJBXCIpO1xuZXhwb3J0cy5CdXJseVdvb2QgPSByZWdpc3RlckNvbG9yKFwiQnVybHlXb29kXCIsIFwiI0RFQjg4N1wiKTtcbmV4cG9ydHMuQ2FkZXRCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkNhZGV0Qmx1ZVwiLCBcIiM1RjlFQTBcIik7XG5leHBvcnRzLkNoYXJ0cmV1c2UgPSByZWdpc3RlckNvbG9yKFwiQ2hhcnRyZXVzZVwiLCBcIiM3RkZGMDBcIik7XG5leHBvcnRzLkNob2NvbGF0ZSA9IHJlZ2lzdGVyQ29sb3IoXCJDaG9jb2xhdGVcIiwgXCIjRDI2OTFFXCIpO1xuZXhwb3J0cy5Db3JhbCA9IHJlZ2lzdGVyQ29sb3IoXCJDb3JhbFwiLCBcIiNGRjdGNTBcIik7XG5leHBvcnRzLkNvcm5mbG93ZXJCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkNvcm5mbG93ZXJCbHVlXCIsIFwiIzY0OTVFRFwiKTtcbmV4cG9ydHMuQ29ybnNpbGsgPSByZWdpc3RlckNvbG9yKFwiQ29ybnNpbGtcIiwgXCIjRkZGOERDXCIpO1xuZXhwb3J0cy5Dcmltc29uID0gcmVnaXN0ZXJDb2xvcihcIkNyaW1zb25cIiwgXCIjREMxNDNDXCIpO1xuZXhwb3J0cy5DeWFuID0gcmVnaXN0ZXJDb2xvcihcIkN5YW5cIiwgXCIjMDBGRkZGXCIpO1xuZXhwb3J0cy5EYXJrQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrQmx1ZVwiLCBcIiMwMDAwOEJcIik7XG5leHBvcnRzLkRhcmtDeWFuID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtDeWFuXCIsIFwiIzAwOEI4QlwiKTtcbmV4cG9ydHMuRGFya0dvbGRlblJvZCA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrR29sZGVuUm9kXCIsIFwiI0I4ODYwQlwiKTtcbmV4cG9ydHMuRGFya0dyYXkgPSByZWdpc3RlckNvbG9yKFwiRGFya0dyYXlcIiwgXCIjQTlBOUE5XCIpO1xuZXhwb3J0cy5EYXJrR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiRGFya0dyZWVuXCIsIFwiIzAwNjQwMFwiKTtcbmV4cG9ydHMuRGFya0toYWtpID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtLaGFraVwiLCBcIiNCREI3NkJcIik7XG5leHBvcnRzLkRhcmtNYWdlbnRhID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtNYWdlbnRhXCIsIFwiIzhCMDA4QlwiKTtcbmV4cG9ydHMuRGFya09saXZlR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiRGFya09saXZlR3JlZW5cIiwgXCIjNTU2QjJGXCIpO1xuZXhwb3J0cy5EYXJrT3JhbmdlID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtPcmFuZ2VcIiwgXCIjRkY4QzAwXCIpO1xuZXhwb3J0cy5EYXJrT3JjaGlkID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtPcmNoaWRcIiwgXCIjOTkzMkNDXCIpO1xuZXhwb3J0cy5EYXJrUmVkID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtSZWRcIiwgXCIjOEIwMDAwXCIpO1xuZXhwb3J0cy5EYXJrU2FsbW9uID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtTYWxtb25cIiwgXCIjRTk5NjdBXCIpO1xuZXhwb3J0cy5EYXJrU2VhR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiRGFya1NlYUdyZWVuXCIsIFwiIzhGQkM4RlwiKTtcbmV4cG9ydHMuRGFya1NsYXRlQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrU2xhdGVCbHVlXCIsIFwiIzQ4M0Q4QlwiKTtcbmV4cG9ydHMuRGFya1NsYXRlR3JheSA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrU2xhdGVHcmF5XCIsIFwiIzJGNEY0RlwiKTtcbmV4cG9ydHMuRGFya1R1cnF1b2lzZSA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrVHVycXVvaXNlXCIsIFwiIzAwQ0VEMVwiKTtcbmV4cG9ydHMuRGFya1Zpb2xldCA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrVmlvbGV0XCIsIFwiIzk0MDBEM1wiKTtcbmV4cG9ydHMuRGVlcFBpbmsgPSByZWdpc3RlckNvbG9yKFwiRGVlcFBpbmtcIiwgXCIjRkYxNDkzXCIpO1xuZXhwb3J0cy5EZWVwU2t5Qmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJEZWVwU2t5Qmx1ZVwiLCBcIiMwMEJGRkZcIik7XG5leHBvcnRzLkRpbUdyYXkgPSByZWdpc3RlckNvbG9yKFwiRGltR3JheVwiLCBcIiM2OTY5NjlcIik7XG5leHBvcnRzLkRvZGdlckJsdWUgPSByZWdpc3RlckNvbG9yKFwiRG9kZ2VyQmx1ZVwiLCBcIiMxRTkwRkZcIik7XG5leHBvcnRzLkZpcmVCcmljayA9IHJlZ2lzdGVyQ29sb3IoXCJGaXJlQnJpY2tcIiwgXCIjQjIyMjIyXCIpO1xuZXhwb3J0cy5GbG9yYWxXaGl0ZSA9IHJlZ2lzdGVyQ29sb3IoXCJGbG9yYWxXaGl0ZVwiLCBcIiNGRkZBRjBcIik7XG5leHBvcnRzLkZvcmVzdEdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkZvcmVzdEdyZWVuXCIsIFwiIzIyOEIyMlwiKTtcbmV4cG9ydHMuRnVjaHNpYSA9IHJlZ2lzdGVyQ29sb3IoXCJGdWNoc2lhXCIsIFwiI0ZGMDBGRlwiKTtcbmV4cG9ydHMuR2FpbnNib3JvID0gcmVnaXN0ZXJDb2xvcihcIkdhaW5zYm9yb1wiLCBcIiNEQ0RDRENcIik7XG5leHBvcnRzLkdob3N0V2hpdGUgPSByZWdpc3RlckNvbG9yKFwiR2hvc3RXaGl0ZVwiLCBcIiNGOEY4RkZcIik7XG5leHBvcnRzLkdvbGQgPSByZWdpc3RlckNvbG9yKFwiR29sZFwiLCBcIiNGRkQ3MDBcIik7XG5leHBvcnRzLkdvbGRlblJvZCA9IHJlZ2lzdGVyQ29sb3IoXCJHb2xkZW5Sb2RcIiwgXCIjREFBNTIwXCIpO1xuZXhwb3J0cy5HcmF5ID0gcmVnaXN0ZXJDb2xvcihcIkdyYXlcIiwgXCIjODA4MDgwXCIpO1xuZXhwb3J0cy5HcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJHcmVlblwiLCBcIiMwMDgwMDBcIik7XG5leHBvcnRzLkdyZWVuWWVsbG93ID0gcmVnaXN0ZXJDb2xvcihcIkdyZWVuWWVsbG93XCIsIFwiI0FERkYyRlwiKTtcbmV4cG9ydHMuSG9uZXlEZXcgPSByZWdpc3RlckNvbG9yKFwiSG9uZXlEZXdcIiwgXCIjRjBGRkYwXCIpO1xuZXhwb3J0cy5Ib3RQaW5rID0gcmVnaXN0ZXJDb2xvcihcIkhvdFBpbmtcIiwgXCIjRkY2OUI0XCIpO1xuZXhwb3J0cy5JbmRpYW5SZWQgPSByZWdpc3RlckNvbG9yKFwiSW5kaWFuUmVkXCIsIFwiI0NENUM1Q1wiKTtcbmV4cG9ydHMuSW5kaWdvID0gcmVnaXN0ZXJDb2xvcihcIkluZGlnb1wiLCBcIiM0QjAwODJcIik7XG5leHBvcnRzLkl2b3J5ID0gcmVnaXN0ZXJDb2xvcihcIkl2b3J5XCIsIFwiI0ZGRkZGMFwiKTtcbmV4cG9ydHMuS2hha2kgPSByZWdpc3RlckNvbG9yKFwiS2hha2lcIiwgXCIjRjBFNjhDXCIpO1xuZXhwb3J0cy5MYXZlbmRlciA9IHJlZ2lzdGVyQ29sb3IoXCJMYXZlbmRlclwiLCBcIiNFNkU2RkFcIik7XG5leHBvcnRzLkxhdmVuZGVyQmx1c2ggPSByZWdpc3RlckNvbG9yKFwiTGF2ZW5kZXJCbHVzaFwiLCBcIiNGRkYwRjVcIik7XG5leHBvcnRzLkxhd25HcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJMYXduR3JlZW5cIiwgXCIjN0NGQzAwXCIpO1xuZXhwb3J0cy5MZW1vbkNoaWZmb24gPSByZWdpc3RlckNvbG9yKFwiTGVtb25DaGlmZm9uXCIsIFwiI0ZGRkFDRFwiKTtcbmV4cG9ydHMuTGlnaHRCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0Qmx1ZVwiLCBcIiNBREQ4RTZcIik7XG5leHBvcnRzLkxpZ2h0Q29yYWwgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRDb3JhbFwiLCBcIiNGMDgwODBcIik7XG5leHBvcnRzLkxpZ2h0Q3lhbiA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodEN5YW5cIiwgXCIjRTBGRkZGXCIpO1xuZXhwb3J0cy5MaWdodEdvbGRlblJvZFllbGxvdyA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodEdvbGRlblJvZFllbGxvd1wiLCBcIiNGQUZBRDJcIik7XG5leHBvcnRzLkxpZ2h0R3JheSA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodEdyYXlcIiwgXCIjRDNEM0QzXCIpO1xuZXhwb3J0cy5MaWdodEdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0R3JlZW5cIiwgXCIjOTBFRTkwXCIpO1xuZXhwb3J0cy5MaWdodFBpbmsgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRQaW5rXCIsIFwiI0ZGQjZDMVwiKTtcbmV4cG9ydHMuTGlnaHRTYWxtb24gPSByZWdpc3RlckNvbG9yKFwiTGlnaHRTYWxtb25cIiwgXCIjRkZBMDdBXCIpO1xuZXhwb3J0cy5MaWdodFNlYUdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0U2VhR3JlZW5cIiwgXCIjMjBCMkFBXCIpO1xuZXhwb3J0cy5MaWdodFNreUJsdWUgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRTa3lCbHVlXCIsIFwiIzg3Q0VGQVwiKTtcbmV4cG9ydHMuTGlnaHRTbGF0ZUdyYXkgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRTbGF0ZUdyYXlcIiwgXCIjNzc4ODk5XCIpO1xuZXhwb3J0cy5MaWdodFN0ZWVsQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodFN0ZWVsQmx1ZVwiLCBcIiNCMEM0REVcIik7XG5leHBvcnRzLkxpZ2h0WWVsbG93ID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0WWVsbG93XCIsIFwiI0ZGRkZFMFwiKTtcbmV4cG9ydHMuTGltZSA9IHJlZ2lzdGVyQ29sb3IoXCJMaW1lXCIsIFwiIzAwRkYwMFwiKTtcbmV4cG9ydHMuTGltZUdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkxpbWVHcmVlblwiLCBcIiMzMkNEMzJcIik7XG5leHBvcnRzLkxpbmVuID0gcmVnaXN0ZXJDb2xvcihcIkxpbmVuXCIsIFwiI0ZBRjBFNlwiKTtcbmV4cG9ydHMuTWFnZW50YSA9IHJlZ2lzdGVyQ29sb3IoXCJNYWdlbnRhXCIsIFwiI0ZGMDBGRlwiKTtcbmV4cG9ydHMuTWFyb29uID0gcmVnaXN0ZXJDb2xvcihcIk1hcm9vblwiLCBcIiM4MDAwMDBcIik7XG5leHBvcnRzLk1lZGl1bUFxdWFNYXJpbmUgPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtQXF1YU1hcmluZVwiLCBcIiM2NkNEQUFcIik7XG5leHBvcnRzLk1lZGl1bUJsdWUgPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtQmx1ZVwiLCBcIiMwMDAwQ0RcIik7XG5leHBvcnRzLk1lZGl1bU9yY2hpZCA9IHJlZ2lzdGVyQ29sb3IoXCJNZWRpdW1PcmNoaWRcIiwgXCIjQkE1NUQzXCIpO1xuZXhwb3J0cy5NZWRpdW1QdXJwbGUgPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtUHVycGxlXCIsIFwiIzkzNzBEQlwiKTtcbmV4cG9ydHMuTWVkaXVtU2VhR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtU2VhR3JlZW5cIiwgXCIjM0NCMzcxXCIpO1xuZXhwb3J0cy5NZWRpdW1TbGF0ZUJsdWUgPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtU2xhdGVCbHVlXCIsIFwiIzdCNjhFRVwiKTtcbmV4cG9ydHMuTWVkaXVtU3ByaW5nR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtU3ByaW5nR3JlZW5cIiwgXCIjMDBGQTlBXCIpO1xuZXhwb3J0cy5NZWRpdW1UdXJxdW9pc2UgPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtVHVycXVvaXNlXCIsIFwiIzQ4RDFDQ1wiKTtcbmV4cG9ydHMuTWVkaXVtVmlvbGV0UmVkID0gcmVnaXN0ZXJDb2xvcihcIk1lZGl1bVZpb2xldFJlZFwiLCBcIiNDNzE1ODVcIik7XG5leHBvcnRzLk1pZG5pZ2h0Qmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJNaWRuaWdodEJsdWVcIiwgXCIjMTkxOTcwXCIpO1xuZXhwb3J0cy5NaW50Q3JlYW0gPSByZWdpc3RlckNvbG9yKFwiTWludENyZWFtXCIsIFwiI0Y1RkZGQVwiKTtcbmV4cG9ydHMuTWlzdHlSb3NlID0gcmVnaXN0ZXJDb2xvcihcIk1pc3R5Um9zZVwiLCBcIiNGRkU0RTFcIik7XG5leHBvcnRzLk1vY2Nhc2luID0gcmVnaXN0ZXJDb2xvcihcIk1vY2Nhc2luXCIsIFwiI0ZGRTRCNVwiKTtcbmV4cG9ydHMuTmF2YWpvV2hpdGUgPSByZWdpc3RlckNvbG9yKFwiTmF2YWpvV2hpdGVcIiwgXCIjRkZERUFEXCIpO1xuZXhwb3J0cy5OYXZ5ID0gcmVnaXN0ZXJDb2xvcihcIk5hdnlcIiwgXCIjMDAwMDgwXCIpO1xuZXhwb3J0cy5PbGRMYWNlID0gcmVnaXN0ZXJDb2xvcihcIk9sZExhY2VcIiwgXCIjRkRGNUU2XCIpO1xuZXhwb3J0cy5PbGl2ZSA9IHJlZ2lzdGVyQ29sb3IoXCJPbGl2ZVwiLCBcIiM4MDgwMDBcIik7XG5leHBvcnRzLk9saXZlRHJhYiA9IHJlZ2lzdGVyQ29sb3IoXCJPbGl2ZURyYWJcIiwgXCIjNkI4RTIzXCIpO1xuZXhwb3J0cy5PcmFuZ2UgPSByZWdpc3RlckNvbG9yKFwiT3JhbmdlXCIsIFwiI0ZGQTUwMFwiKTtcbmV4cG9ydHMuT3JhbmdlUmVkID0gcmVnaXN0ZXJDb2xvcihcIk9yYW5nZVJlZFwiLCBcIiNGRjQ1MDBcIik7XG5leHBvcnRzLk9yY2hpZCA9IHJlZ2lzdGVyQ29sb3IoXCJPcmNoaWRcIiwgXCIjREE3MEQ2XCIpO1xuZXhwb3J0cy5QYWxlR29sZGVuUm9kID0gcmVnaXN0ZXJDb2xvcihcIlBhbGVHb2xkZW5Sb2RcIiwgXCIjRUVFOEFBXCIpO1xuZXhwb3J0cy5QYWxlR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiUGFsZUdyZWVuXCIsIFwiIzk4RkI5OFwiKTtcbmV4cG9ydHMuUGFsZVR1cnF1b2lzZSA9IHJlZ2lzdGVyQ29sb3IoXCJQYWxlVHVycXVvaXNlXCIsIFwiI0FGRUVFRVwiKTtcbmV4cG9ydHMuUGFsZVZpb2xldFJlZCA9IHJlZ2lzdGVyQ29sb3IoXCJQYWxlVmlvbGV0UmVkXCIsIFwiI0RCNzA5M1wiKTtcbmV4cG9ydHMuUGFwYXlhV2hpcCA9IHJlZ2lzdGVyQ29sb3IoXCJQYXBheWFXaGlwXCIsIFwiI0ZGRUZENVwiKTtcbmV4cG9ydHMuUGVhY2hQdWZmID0gcmVnaXN0ZXJDb2xvcihcIlBlYWNoUHVmZlwiLCBcIiNGRkRBQjlcIik7XG5leHBvcnRzLlBlcnUgPSByZWdpc3RlckNvbG9yKFwiUGVydVwiLCBcIiNDRDg1M0ZcIik7XG5leHBvcnRzLlBpbmsgPSByZWdpc3RlckNvbG9yKFwiUGlua1wiLCBcIiNGRkMwQ0JcIik7XG5leHBvcnRzLlBsdW0gPSByZWdpc3RlckNvbG9yKFwiUGx1bVwiLCBcIiNEREEwRERcIik7XG5leHBvcnRzLlBvd2RlckJsdWUgPSByZWdpc3RlckNvbG9yKFwiUG93ZGVyQmx1ZVwiLCBcIiNCMEUwRTZcIik7XG5leHBvcnRzLlB1cnBsZSA9IHJlZ2lzdGVyQ29sb3IoXCJQdXJwbGVcIiwgXCIjODAwMDgwXCIpO1xuZXhwb3J0cy5SZWJlY2NhUHVycGxlID0gcmVnaXN0ZXJDb2xvcihcIlJlYmVjY2FQdXJwbGVcIiwgXCIjNjYzMzk5XCIpO1xuZXhwb3J0cy5SZWQgPSByZWdpc3RlckNvbG9yKFwiUmVkXCIsIFwiI0ZGMDAwMFwiKTtcbmV4cG9ydHMuUm9zeUJyb3duID0gcmVnaXN0ZXJDb2xvcihcIlJvc3lCcm93blwiLCBcIiNCQzhGOEZcIik7XG5leHBvcnRzLlJveWFsQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJSb3lhbEJsdWVcIiwgXCIjNDE2OUUxXCIpO1xuZXhwb3J0cy5TYWRkbGVCcm93biA9IHJlZ2lzdGVyQ29sb3IoXCJTYWRkbGVCcm93blwiLCBcIiM4QjQ1MTNcIik7XG5leHBvcnRzLlNhbG1vbiA9IHJlZ2lzdGVyQ29sb3IoXCJTYWxtb25cIiwgXCIjRkE4MDcyXCIpO1xuZXhwb3J0cy5TYW5keUJyb3duID0gcmVnaXN0ZXJDb2xvcihcIlNhbmR5QnJvd25cIiwgXCIjRjRBNDYwXCIpO1xuZXhwb3J0cy5TZWFHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJTZWFHcmVlblwiLCBcIiMyRThCNTdcIik7XG5leHBvcnRzLlNlYVNoZWxsID0gcmVnaXN0ZXJDb2xvcihcIlNlYVNoZWxsXCIsIFwiI0ZGRjVFRVwiKTtcbmV4cG9ydHMuU2llbm5hID0gcmVnaXN0ZXJDb2xvcihcIlNpZW5uYVwiLCBcIiNBMDUyMkRcIik7XG5leHBvcnRzLlNpbHZlciA9IHJlZ2lzdGVyQ29sb3IoXCJTaWx2ZXJcIiwgXCIjQzBDMEMwXCIpO1xuZXhwb3J0cy5Ta3lCbHVlID0gcmVnaXN0ZXJDb2xvcihcIlNreUJsdWVcIiwgXCIjODdDRUVCXCIpO1xuZXhwb3J0cy5TbGF0ZUJsdWUgPSByZWdpc3RlckNvbG9yKFwiU2xhdGVCbHVlXCIsIFwiIzZBNUFDRFwiKTtcbmV4cG9ydHMuU2xhdGVHcmF5ID0gcmVnaXN0ZXJDb2xvcihcIlNsYXRlR3JheVwiLCBcIiM3MDgwOTBcIik7XG5leHBvcnRzLlNub3cgPSByZWdpc3RlckNvbG9yKFwiU25vd1wiLCBcIiNGRkZBRkFcIik7XG5leHBvcnRzLlNwcmluZ0dyZWVuID0gcmVnaXN0ZXJDb2xvcihcIlNwcmluZ0dyZWVuXCIsIFwiIzAwRkY3RlwiKTtcbmV4cG9ydHMuU3RlZWxCbHVlID0gcmVnaXN0ZXJDb2xvcihcIlN0ZWVsQmx1ZVwiLCBcIiM0NjgyQjRcIik7XG5leHBvcnRzLlRhbiA9IHJlZ2lzdGVyQ29sb3IoXCJUYW5cIiwgXCIjRDJCNDhDXCIpO1xuZXhwb3J0cy5UZWFsID0gcmVnaXN0ZXJDb2xvcihcIlRlYWxcIiwgXCIjMDA4MDgwXCIpO1xuZXhwb3J0cy5UaGlzdGxlID0gcmVnaXN0ZXJDb2xvcihcIlRoaXN0bGVcIiwgXCIjRDhCRkQ4XCIpO1xuZXhwb3J0cy5Ub21hdG8gPSByZWdpc3RlckNvbG9yKFwiVG9tYXRvXCIsIFwiI0ZGNjM0N1wiKTtcbmV4cG9ydHMuVHVycXVvaXNlID0gcmVnaXN0ZXJDb2xvcihcIlR1cnF1b2lzZVwiLCBcIiM0MEUwRDBcIik7XG5leHBvcnRzLlZpb2xldCA9IHJlZ2lzdGVyQ29sb3IoXCJWaW9sZXRcIiwgXCIjRUU4MkVFXCIpO1xuZXhwb3J0cy5XaGVhdCA9IHJlZ2lzdGVyQ29sb3IoXCJXaGVhdFwiLCBcIiNGNURFQjNcIik7XG5leHBvcnRzLldoaXRlID0gcmVnaXN0ZXJDb2xvcihcIldoaXRlXCIsIFwiI0ZGRkZGRlwiKTtcbmV4cG9ydHMuV2hpdGVTbW9rZSA9IHJlZ2lzdGVyQ29sb3IoXCJXaGl0ZVNtb2tlXCIsIFwiI0Y1RjVGNVwiKTtcbmV4cG9ydHMuWWVsbG93ID0gcmVnaXN0ZXJDb2xvcihcIlllbGxvd1wiLCBcIiNGRkZGMDBcIik7XG5leHBvcnRzLlllbGxvd0dyZWVuID0gcmVnaXN0ZXJDb2xvcihcIlllbGxvd0dyZWVuXCIsIFwiIzlBQ0QzMlwiKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtub3duLWNvbG9ycy5qcy5tYXAiLCJcbmV4cG9ydHMucGFyc2UgPSBwYXJzZTtcblxuZnVuY3Rpb24gcGFyc2Uoc3RyKSB7XG4gIHJldHVybiBuZXcgUGFyc2VyKHN0cikucGFyc2UoKTtcbn1cblxuZnVuY3Rpb24gUGFyc2VyKHN0cikge1xuICB0aGlzLnN0ciA9IHN0cjtcbn1cblxuUGFyc2VyLnByb3RvdHlwZS5za2lwID0gZnVuY3Rpb24obSl7XG4gIHRoaXMuc3RyID0gdGhpcy5zdHIuc2xpY2UobVswXS5sZW5ndGgpO1xufTtcblxuUGFyc2VyLnByb3RvdHlwZS5jb21tYSA9IGZ1bmN0aW9uKCl7XG4gIHZhciBtID0gL14sICovLmV4ZWModGhpcy5zdHIpO1xuICBpZiAoIW0pIHJldHVybjtcbiAgdGhpcy5za2lwKG0pO1xuICByZXR1cm4geyB0eXBlOiAnY29tbWEnLCBzdHJpbmc6ICcsJyB9O1xufTtcblxuUGFyc2VyLnByb3RvdHlwZS5pZGVudCA9IGZ1bmN0aW9uKCl7XG4gIHZhciBtID0gL14oW1xcdy1dKykgKi8uZXhlYyh0aGlzLnN0cik7XG4gIGlmICghbSkgcmV0dXJuO1xuICB0aGlzLnNraXAobSk7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ2lkZW50JyxcbiAgICBzdHJpbmc6IG1bMV1cbiAgfVxufTtcblxuUGFyc2VyLnByb3RvdHlwZS5pbnQgPSBmdW5jdGlvbigpe1xuICB2YXIgbSA9IC9eKChbLVxcK10/XFxkKykoXFxTKyk/KSAqLy5leGVjKHRoaXMuc3RyKTtcbiAgaWYgKCFtKSByZXR1cm47XG4gIHRoaXMuc2tpcChtKTtcbiAgdmFyIG4gPSB+fm1bMl07XG4gIHZhciB1ID0gbVszXTtcblxuICByZXR1cm4ge1xuICAgIHR5cGU6ICdudW1iZXInLFxuICAgIHN0cmluZzogbVsxXSxcbiAgICB1bml0OiB1IHx8ICcnLFxuICAgIHZhbHVlOiBuXG4gIH1cbn07XG5cblBhcnNlci5wcm90b3R5cGUuZmxvYXQgPSBmdW5jdGlvbigpe1xuICB2YXIgbSA9IC9eKCgoPzpbLVxcK10/XFxkKyk/XFwuXFxkKykoXFxTKyk/KSAqLy5leGVjKHRoaXMuc3RyKTtcbiAgaWYgKCFtKSByZXR1cm47XG4gIHRoaXMuc2tpcChtKTtcbiAgdmFyIG4gPSBwYXJzZUZsb2F0KG1bMl0pO1xuICB2YXIgdSA9IG1bM107XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICBzdHJpbmc6IG1bMV0sXG4gICAgdW5pdDogdSB8fCAnJyxcbiAgICB2YWx1ZTogblxuICB9XG59O1xuXG5QYXJzZXIucHJvdG90eXBlLm51bWJlciA9IGZ1bmN0aW9uKCl7XG4gIHJldHVybiB0aGlzLmZsb2F0KCkgfHwgdGhpcy5pbnQoKTtcbn07XG5cblBhcnNlci5wcm90b3R5cGUuZG91YmxlID0gZnVuY3Rpb24oKXtcbiAgdmFyIG0gPSAvXlwiKFteXCJdKilcIiAqLy5leGVjKHRoaXMuc3RyKTtcbiAgaWYgKCFtKSByZXR1cm4gbTtcbiAgdGhpcy5za2lwKG0pO1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgIHF1b3RlOiAnXCInLFxuICAgIHN0cmluZzogJ1wiJyArIG1bMV0gKyAnXCInLFxuICAgIHZhbHVlOiBtWzFdXG4gIH1cbn07XG5cblBhcnNlci5wcm90b3R5cGUuc2luZ2xlID0gZnVuY3Rpb24oKXtcbiAgdmFyIG0gPSAvXicoW14nXSopJyAqLy5leGVjKHRoaXMuc3RyKTtcbiAgaWYgKCFtKSByZXR1cm4gbTtcbiAgdGhpcy5za2lwKG0pO1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgIHF1b3RlOiBcIidcIixcbiAgICBzdHJpbmc6IFwiJ1wiICsgbVsxXSArIFwiJ1wiLFxuICAgIHZhbHVlOiBtWzFdXG4gIH1cbn07XG5cblBhcnNlci5wcm90b3R5cGUuc3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgcmV0dXJuIHRoaXMuc2luZ2xlKCkgfHwgdGhpcy5kb3VibGUoKTtcbn07XG5cblxuUGFyc2VyLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uKCl7XG4gIHJldHVybiB0aGlzLm51bWJlcigpXG4gICAgfHwgdGhpcy5pZGVudCgpXG4gICAgfHwgdGhpcy5zdHJpbmcoKVxuICAgIHx8IHRoaXMuY29tbWEoKTtcbn07XG5cblBhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbigpe1xuICB2YXIgdmFscyA9IFtdO1xuXG4gIHdoaWxlICh0aGlzLnN0ci5sZW5ndGgpIHtcbiAgICB2YXIgb2JqID0gdGhpcy52YWx1ZSgpO1xuICAgIGlmICghb2JqKSB0aHJvdyBuZXcgRXJyb3IoJ2ZhaWxlZCB0byBwYXJzZSBuZWFyIGAnICsgdGhpcy5zdHIuc2xpY2UoMCwgMTApICsgJy4uLmAnKTtcbiAgICB2YWxzLnB1c2gob2JqKTtcbiAgfVxuXG4gIHJldHVybiB2YWxzO1xufTtcbiIsImV4cG9ydHMucGFyc2UgPSByZXF1aXJlKCcuL2xpYi9wYXJzZScpO1xuIiwiLy8gaHR0cDovL3d3dy53My5vcmcvVFIvQ1NTMjEvZ3JhbW1hci5odG1sXG4vLyBodHRwczovL2dpdGh1Yi5jb20vdmlzaW9ubWVkaWEvY3NzLXBhcnNlL3B1bGwvNDkjaXNzdWVjb21tZW50LTMwMDg4MDI3XG52YXIgY29tbWVudHJlID0gL1xcL1xcKlteKl0qXFwqKyhbXi8qXVteKl0qXFwqKykqXFwvL2dcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihjc3MsIG9wdGlvbnMpe1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAvKipcbiAgICogUG9zaXRpb25hbC5cbiAgICovXG5cbiAgdmFyIGxpbmVubyA9IDE7XG4gIHZhciBjb2x1bW4gPSAxO1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgbGluZW5vIGFuZCBjb2x1bW4gYmFzZWQgb24gYHN0cmAuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIHVwZGF0ZVBvc2l0aW9uKHN0cikge1xuICAgIHZhciBsaW5lcyA9IHN0ci5tYXRjaCgvXFxuL2cpO1xuICAgIGlmIChsaW5lcykgbGluZW5vICs9IGxpbmVzLmxlbmd0aDtcbiAgICB2YXIgaSA9IHN0ci5sYXN0SW5kZXhPZignXFxuJyk7XG4gICAgY29sdW1uID0gfmkgPyBzdHIubGVuZ3RoIC0gaSA6IGNvbHVtbiArIHN0ci5sZW5ndGg7XG4gIH1cblxuICAvKipcbiAgICogTWFyayBwb3NpdGlvbiBhbmQgcGF0Y2ggYG5vZGUucG9zaXRpb25gLlxuICAgKi9cblxuICBmdW5jdGlvbiBwb3NpdGlvbigpIHtcbiAgICB2YXIgc3RhcnQgPSB7IGxpbmU6IGxpbmVubywgY29sdW1uOiBjb2x1bW4gfTtcbiAgICByZXR1cm4gZnVuY3Rpb24obm9kZSl7XG4gICAgICBub2RlLnBvc2l0aW9uID0gbmV3IFBvc2l0aW9uKHN0YXJ0KTtcbiAgICAgIHdoaXRlc3BhY2UoKTtcbiAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogU3RvcmUgcG9zaXRpb24gaW5mb3JtYXRpb24gZm9yIGEgbm9kZVxuICAgKi9cblxuICBmdW5jdGlvbiBQb3NpdGlvbihzdGFydCkge1xuICAgIHRoaXMuc3RhcnQgPSBzdGFydDtcbiAgICB0aGlzLmVuZCA9IHsgbGluZTogbGluZW5vLCBjb2x1bW46IGNvbHVtbiB9O1xuICAgIHRoaXMuc291cmNlID0gb3B0aW9ucy5zb3VyY2U7XG4gIH1cblxuICAvKipcbiAgICogTm9uLWVudW1lcmFibGUgc291cmNlIHN0cmluZ1xuICAgKi9cblxuICBQb3NpdGlvbi5wcm90b3R5cGUuY29udGVudCA9IGNzcztcblxuICAvKipcbiAgICogRXJyb3IgYG1zZ2AuXG4gICAqL1xuXG4gIHZhciBlcnJvcnNMaXN0ID0gW107XG5cbiAgZnVuY3Rpb24gZXJyb3IobXNnKSB7XG4gICAgdmFyIGVyciA9IG5ldyBFcnJvcihvcHRpb25zLnNvdXJjZSArICc6JyArIGxpbmVubyArICc6JyArIGNvbHVtbiArICc6ICcgKyBtc2cpO1xuICAgIGVyci5yZWFzb24gPSBtc2c7XG4gICAgZXJyLmZpbGVuYW1lID0gb3B0aW9ucy5zb3VyY2U7XG4gICAgZXJyLmxpbmUgPSBsaW5lbm87XG4gICAgZXJyLmNvbHVtbiA9IGNvbHVtbjtcbiAgICBlcnIuc291cmNlID0gY3NzO1xuXG4gICAgaWYgKG9wdGlvbnMuc2lsZW50KSB7XG4gICAgICBlcnJvcnNMaXN0LnB1c2goZXJyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBzdHlsZXNoZWV0LlxuICAgKi9cblxuICBmdW5jdGlvbiBzdHlsZXNoZWV0KCkge1xuICAgIHZhciBydWxlc0xpc3QgPSBydWxlcygpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdzdHlsZXNoZWV0JyxcbiAgICAgIHN0eWxlc2hlZXQ6IHtcbiAgICAgICAgcnVsZXM6IHJ1bGVzTGlzdCxcbiAgICAgICAgcGFyc2luZ0Vycm9yczogZXJyb3JzTGlzdFxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogT3BlbmluZyBicmFjZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gb3BlbigpIHtcbiAgICByZXR1cm4gbWF0Y2goL157XFxzKi8pO1xuICB9XG5cbiAgLyoqXG4gICAqIENsb3NpbmcgYnJhY2UuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgIHJldHVybiBtYXRjaCgvXn0vKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBydWxlc2V0LlxuICAgKi9cblxuICBmdW5jdGlvbiBydWxlcygpIHtcbiAgICB2YXIgbm9kZTtcbiAgICB2YXIgcnVsZXMgPSBbXTtcbiAgICB3aGl0ZXNwYWNlKCk7XG4gICAgY29tbWVudHMocnVsZXMpO1xuICAgIHdoaWxlIChjc3MubGVuZ3RoICYmIGNzcy5jaGFyQXQoMCkgIT0gJ30nICYmIChub2RlID0gYXRydWxlKCkgfHwgcnVsZSgpKSkge1xuICAgICAgaWYgKG5vZGUgIT09IGZhbHNlKSB7XG4gICAgICAgIHJ1bGVzLnB1c2gobm9kZSk7XG4gICAgICAgIGNvbW1lbnRzKHJ1bGVzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJ1bGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIE1hdGNoIGByZWAgYW5kIHJldHVybiBjYXB0dXJlcy5cbiAgICovXG5cbiAgZnVuY3Rpb24gbWF0Y2gocmUpIHtcbiAgICB2YXIgbSA9IHJlLmV4ZWMoY3NzKTtcbiAgICBpZiAoIW0pIHJldHVybjtcbiAgICB2YXIgc3RyID0gbVswXTtcbiAgICB1cGRhdGVQb3NpdGlvbihzdHIpO1xuICAgIGNzcyA9IGNzcy5zbGljZShzdHIubGVuZ3RoKTtcbiAgICByZXR1cm4gbTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSB3aGl0ZXNwYWNlLlxuICAgKi9cblxuICBmdW5jdGlvbiB3aGl0ZXNwYWNlKCkge1xuICAgIG1hdGNoKC9eXFxzKi8pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGNvbW1lbnRzO1xuICAgKi9cblxuICBmdW5jdGlvbiBjb21tZW50cyhydWxlcykge1xuICAgIHZhciBjO1xuICAgIHJ1bGVzID0gcnVsZXMgfHwgW107XG4gICAgd2hpbGUgKGMgPSBjb21tZW50KCkpIHtcbiAgICAgIGlmIChjICE9PSBmYWxzZSkge1xuICAgICAgICBydWxlcy5wdXNoKGMpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcnVsZXM7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgY29tbWVudC5cbiAgICovXG5cbiAgZnVuY3Rpb24gY29tbWVudCgpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICBpZiAoJy8nICE9IGNzcy5jaGFyQXQoMCkgfHwgJyonICE9IGNzcy5jaGFyQXQoMSkpIHJldHVybjtcblxuICAgIHZhciBpID0gMjtcbiAgICB3aGlsZSAoXCJcIiAhPSBjc3MuY2hhckF0KGkpICYmICgnKicgIT0gY3NzLmNoYXJBdChpKSB8fCAnLycgIT0gY3NzLmNoYXJBdChpICsgMSkpKSArK2k7XG4gICAgaSArPSAyO1xuXG4gICAgaWYgKFwiXCIgPT09IGNzcy5jaGFyQXQoaS0xKSkge1xuICAgICAgcmV0dXJuIGVycm9yKCdFbmQgb2YgY29tbWVudCBtaXNzaW5nJyk7XG4gICAgfVxuXG4gICAgdmFyIHN0ciA9IGNzcy5zbGljZSgyLCBpIC0gMik7XG4gICAgY29sdW1uICs9IDI7XG4gICAgdXBkYXRlUG9zaXRpb24oc3RyKTtcbiAgICBjc3MgPSBjc3Muc2xpY2UoaSk7XG4gICAgY29sdW1uICs9IDI7XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdjb21tZW50JyxcbiAgICAgIGNvbW1lbnQ6IHN0clxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIHNlbGVjdG9yLlxuICAgKi9cblxuICBmdW5jdGlvbiBzZWxlY3RvcigpIHtcbiAgICB2YXIgbSA9IG1hdGNoKC9eKFtee10rKS8pO1xuICAgIGlmICghbSkgcmV0dXJuO1xuICAgIC8qIEBmaXggUmVtb3ZlIGFsbCBjb21tZW50cyBmcm9tIHNlbGVjdG9yc1xuICAgICAqIGh0dHA6Ly9vc3Rlcm1pbGxlci5vcmcvZmluZGNvbW1lbnQuaHRtbCAqL1xuICAgIHJldHVybiB0cmltKG1bMF0pXG4gICAgICAucmVwbGFjZSgvXFwvXFwqKFteKl18W1xcclxcbl18KFxcKisoW14qL118W1xcclxcbl0pKSkqXFwqXFwvKy9nLCAnJylcbiAgICAgIC5yZXBsYWNlKC9cIig/OlxcXFxcInxbXlwiXSkqXCJ8Jyg/OlxcXFwnfFteJ10pKicvZywgZnVuY3Rpb24obSkge1xuICAgICAgICByZXR1cm4gbS5yZXBsYWNlKC8sL2csICdcXHUyMDBDJyk7XG4gICAgICB9KVxuICAgICAgLnNwbGl0KC9cXHMqKD8hW14oXSpcXCkpLFxccyovKVxuICAgICAgLm1hcChmdW5jdGlvbihzKSB7XG4gICAgICAgIHJldHVybiBzLnJlcGxhY2UoL1xcdTIwMEMvZywgJywnKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGRlY2xhcmF0aW9uLlxuICAgKi9cblxuICBmdW5jdGlvbiBkZWNsYXJhdGlvbigpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcblxuICAgIC8vIHByb3BcbiAgICB2YXIgcHJvcCA9IG1hdGNoKC9eKFxcKj9bLSNcXC9cXCpcXFxcXFx3XSsoXFxbWzAtOWEtel8tXStcXF0pPylcXHMqLyk7XG4gICAgaWYgKCFwcm9wKSByZXR1cm47XG4gICAgcHJvcCA9IHRyaW0ocHJvcFswXSk7XG5cbiAgICAvLyA6XG4gICAgaWYgKCFtYXRjaCgvXjpcXHMqLykpIHJldHVybiBlcnJvcihcInByb3BlcnR5IG1pc3NpbmcgJzonXCIpO1xuXG4gICAgLy8gdmFsXG4gICAgdmFyIHZhbCA9IG1hdGNoKC9eKCg/OicoPzpcXFxcJ3wuKSo/J3xcIig/OlxcXFxcInwuKSo/XCJ8XFwoW15cXCldKj9cXCl8W159O10pKykvKTtcblxuICAgIHZhciByZXQgPSBwb3Moe1xuICAgICAgdHlwZTogJ2RlY2xhcmF0aW9uJyxcbiAgICAgIHByb3BlcnR5OiBwcm9wLnJlcGxhY2UoY29tbWVudHJlLCAnJyksXG4gICAgICB2YWx1ZTogdmFsID8gdHJpbSh2YWxbMF0pLnJlcGxhY2UoY29tbWVudHJlLCAnJykgOiAnJ1xuICAgIH0pO1xuXG4gICAgLy8gO1xuICAgIG1hdGNoKC9eWztcXHNdKi8pO1xuXG4gICAgcmV0dXJuIHJldDtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBkZWNsYXJhdGlvbnMuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGRlY2xhcmF0aW9ucygpIHtcbiAgICB2YXIgZGVjbHMgPSBbXTtcblxuICAgIGlmICghb3BlbigpKSByZXR1cm4gZXJyb3IoXCJtaXNzaW5nICd7J1wiKTtcbiAgICBjb21tZW50cyhkZWNscyk7XG5cbiAgICAvLyBkZWNsYXJhdGlvbnNcbiAgICB2YXIgZGVjbDtcbiAgICB3aGlsZSAoZGVjbCA9IGRlY2xhcmF0aW9uKCkpIHtcbiAgICAgIGlmIChkZWNsICE9PSBmYWxzZSkge1xuICAgICAgICBkZWNscy5wdXNoKGRlY2wpO1xuICAgICAgICBjb21tZW50cyhkZWNscyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFjbG9zZSgpKSByZXR1cm4gZXJyb3IoXCJtaXNzaW5nICd9J1wiKTtcbiAgICByZXR1cm4gZGVjbHM7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2Uga2V5ZnJhbWUuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGtleWZyYW1lKCkge1xuICAgIHZhciBtO1xuICAgIHZhciB2YWxzID0gW107XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG5cbiAgICB3aGlsZSAobSA9IG1hdGNoKC9eKChcXGQrXFwuXFxkK3xcXC5cXGQrfFxcZCspJT98W2Etel0rKVxccyovKSkge1xuICAgICAgdmFscy5wdXNoKG1bMV0pO1xuICAgICAgbWF0Y2goL14sXFxzKi8pO1xuICAgIH1cblxuICAgIGlmICghdmFscy5sZW5ndGgpIHJldHVybjtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ2tleWZyYW1lJyxcbiAgICAgIHZhbHVlczogdmFscyxcbiAgICAgIGRlY2xhcmF0aW9uczogZGVjbGFyYXRpb25zKClcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBrZXlmcmFtZXMuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGF0a2V5ZnJhbWVzKCkge1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuICAgIHZhciBtID0gbWF0Y2goL15AKFstXFx3XSspP2tleWZyYW1lc1xccyovKTtcblxuICAgIGlmICghbSkgcmV0dXJuO1xuICAgIHZhciB2ZW5kb3IgPSBtWzFdO1xuXG4gICAgLy8gaWRlbnRpZmllclxuICAgIHZhciBtID0gbWF0Y2goL14oWy1cXHddKylcXHMqLyk7XG4gICAgaWYgKCFtKSByZXR1cm4gZXJyb3IoXCJAa2V5ZnJhbWVzIG1pc3NpbmcgbmFtZVwiKTtcbiAgICB2YXIgbmFtZSA9IG1bMV07XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwiQGtleWZyYW1lcyBtaXNzaW5nICd7J1wiKTtcblxuICAgIHZhciBmcmFtZTtcbiAgICB2YXIgZnJhbWVzID0gY29tbWVudHMoKTtcbiAgICB3aGlsZSAoZnJhbWUgPSBrZXlmcmFtZSgpKSB7XG4gICAgICBmcmFtZXMucHVzaChmcmFtZSk7XG4gICAgICBmcmFtZXMgPSBmcmFtZXMuY29uY2F0KGNvbW1lbnRzKCkpO1xuICAgIH1cblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwiQGtleWZyYW1lcyBtaXNzaW5nICd9J1wiKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ2tleWZyYW1lcycsXG4gICAgICBuYW1lOiBuYW1lLFxuICAgICAgdmVuZG9yOiB2ZW5kb3IsXG4gICAgICBrZXlmcmFtZXM6IGZyYW1lc1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIHN1cHBvcnRzLlxuICAgKi9cblxuICBmdW5jdGlvbiBhdHN1cHBvcnRzKCkge1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuICAgIHZhciBtID0gbWF0Y2goL15Ac3VwcG9ydHMgKihbXntdKykvKTtcblxuICAgIGlmICghbSkgcmV0dXJuO1xuICAgIHZhciBzdXBwb3J0cyA9IHRyaW0obVsxXSk7XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwiQHN1cHBvcnRzIG1pc3NpbmcgJ3snXCIpO1xuXG4gICAgdmFyIHN0eWxlID0gY29tbWVudHMoKS5jb25jYXQocnVsZXMoKSk7XG5cbiAgICBpZiAoIWNsb3NlKCkpIHJldHVybiBlcnJvcihcIkBzdXBwb3J0cyBtaXNzaW5nICd9J1wiKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ3N1cHBvcnRzJyxcbiAgICAgIHN1cHBvcnRzOiBzdXBwb3J0cyxcbiAgICAgIHJ1bGVzOiBzdHlsZVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGhvc3QuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGF0aG9zdCgpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgbSA9IG1hdGNoKC9eQGhvc3RcXHMqLyk7XG5cbiAgICBpZiAoIW0pIHJldHVybjtcblxuICAgIGlmICghb3BlbigpKSByZXR1cm4gZXJyb3IoXCJAaG9zdCBtaXNzaW5nICd7J1wiKTtcblxuICAgIHZhciBzdHlsZSA9IGNvbW1lbnRzKCkuY29uY2F0KHJ1bGVzKCkpO1xuXG4gICAgaWYgKCFjbG9zZSgpKSByZXR1cm4gZXJyb3IoXCJAaG9zdCBtaXNzaW5nICd9J1wiKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ2hvc3QnLFxuICAgICAgcnVsZXM6IHN0eWxlXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgbWVkaWEuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGF0bWVkaWEoKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgdmFyIG0gPSBtYXRjaCgvXkBtZWRpYSAqKFtee10rKS8pO1xuXG4gICAgaWYgKCFtKSByZXR1cm47XG4gICAgdmFyIG1lZGlhID0gdHJpbShtWzFdKTtcblxuICAgIGlmICghb3BlbigpKSByZXR1cm4gZXJyb3IoXCJAbWVkaWEgbWlzc2luZyAneydcIik7XG5cbiAgICB2YXIgc3R5bGUgPSBjb21tZW50cygpLmNvbmNhdChydWxlcygpKTtcblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwiQG1lZGlhIG1pc3NpbmcgJ30nXCIpO1xuXG4gICAgcmV0dXJuIHBvcyh7XG4gICAgICB0eXBlOiAnbWVkaWEnLFxuICAgICAgbWVkaWE6IG1lZGlhLFxuICAgICAgcnVsZXM6IHN0eWxlXG4gICAgfSk7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBQYXJzZSBjdXN0b20tbWVkaWEuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGF0Y3VzdG9tbWVkaWEoKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgdmFyIG0gPSBtYXRjaCgvXkBjdXN0b20tbWVkaWFcXHMrKC0tW15cXHNdKylcXHMqKFteeztdKyk7Lyk7XG4gICAgaWYgKCFtKSByZXR1cm47XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdjdXN0b20tbWVkaWEnLFxuICAgICAgbmFtZTogdHJpbShtWzFdKSxcbiAgICAgIG1lZGlhOiB0cmltKG1bMl0pXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgcGFnZWQgbWVkaWEuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGF0cGFnZSgpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgbSA9IG1hdGNoKC9eQHBhZ2UgKi8pO1xuICAgIGlmICghbSkgcmV0dXJuO1xuXG4gICAgdmFyIHNlbCA9IHNlbGVjdG9yKCkgfHwgW107XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwiQHBhZ2UgbWlzc2luZyAneydcIik7XG4gICAgdmFyIGRlY2xzID0gY29tbWVudHMoKTtcblxuICAgIC8vIGRlY2xhcmF0aW9uc1xuICAgIHZhciBkZWNsO1xuICAgIHdoaWxlIChkZWNsID0gZGVjbGFyYXRpb24oKSkge1xuICAgICAgZGVjbHMucHVzaChkZWNsKTtcbiAgICAgIGRlY2xzID0gZGVjbHMuY29uY2F0KGNvbW1lbnRzKCkpO1xuICAgIH1cblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwiQHBhZ2UgbWlzc2luZyAnfSdcIik7XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdwYWdlJyxcbiAgICAgIHNlbGVjdG9yczogc2VsLFxuICAgICAgZGVjbGFyYXRpb25zOiBkZWNsc1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGRvY3VtZW50LlxuICAgKi9cblxuICBmdW5jdGlvbiBhdGRvY3VtZW50KCkge1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuICAgIHZhciBtID0gbWF0Y2goL15AKFstXFx3XSspP2RvY3VtZW50ICooW157XSspLyk7XG4gICAgaWYgKCFtKSByZXR1cm47XG5cbiAgICB2YXIgdmVuZG9yID0gdHJpbShtWzFdKTtcbiAgICB2YXIgZG9jID0gdHJpbShtWzJdKTtcblxuICAgIGlmICghb3BlbigpKSByZXR1cm4gZXJyb3IoXCJAZG9jdW1lbnQgbWlzc2luZyAneydcIik7XG5cbiAgICB2YXIgc3R5bGUgPSBjb21tZW50cygpLmNvbmNhdChydWxlcygpKTtcblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwiQGRvY3VtZW50IG1pc3NpbmcgJ30nXCIpO1xuXG4gICAgcmV0dXJuIHBvcyh7XG4gICAgICB0eXBlOiAnZG9jdW1lbnQnLFxuICAgICAgZG9jdW1lbnQ6IGRvYyxcbiAgICAgIHZlbmRvcjogdmVuZG9yLFxuICAgICAgcnVsZXM6IHN0eWxlXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgZm9udC1mYWNlLlxuICAgKi9cblxuICBmdW5jdGlvbiBhdGZvbnRmYWNlKCkge1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuICAgIHZhciBtID0gbWF0Y2goL15AZm9udC1mYWNlXFxzKi8pO1xuICAgIGlmICghbSkgcmV0dXJuO1xuXG4gICAgaWYgKCFvcGVuKCkpIHJldHVybiBlcnJvcihcIkBmb250LWZhY2UgbWlzc2luZyAneydcIik7XG4gICAgdmFyIGRlY2xzID0gY29tbWVudHMoKTtcblxuICAgIC8vIGRlY2xhcmF0aW9uc1xuICAgIHZhciBkZWNsO1xuICAgIHdoaWxlIChkZWNsID0gZGVjbGFyYXRpb24oKSkge1xuICAgICAgZGVjbHMucHVzaChkZWNsKTtcbiAgICAgIGRlY2xzID0gZGVjbHMuY29uY2F0KGNvbW1lbnRzKCkpO1xuICAgIH1cblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwiQGZvbnQtZmFjZSBtaXNzaW5nICd9J1wiKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ2ZvbnQtZmFjZScsXG4gICAgICBkZWNsYXJhdGlvbnM6IGRlY2xzXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgaW1wb3J0XG4gICAqL1xuXG4gIHZhciBhdGltcG9ydCA9IF9jb21waWxlQXRydWxlKCdpbXBvcnQnKTtcblxuICAvKipcbiAgICogUGFyc2UgY2hhcnNldFxuICAgKi9cblxuICB2YXIgYXRjaGFyc2V0ID0gX2NvbXBpbGVBdHJ1bGUoJ2NoYXJzZXQnKTtcblxuICAvKipcbiAgICogUGFyc2UgbmFtZXNwYWNlXG4gICAqL1xuXG4gIHZhciBhdG5hbWVzcGFjZSA9IF9jb21waWxlQXRydWxlKCduYW1lc3BhY2UnKTtcblxuICAvKipcbiAgICogUGFyc2Ugbm9uLWJsb2NrIGF0LXJ1bGVzXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gX2NvbXBpbGVBdHJ1bGUobmFtZSkge1xuICAgIHZhciByZSA9IG5ldyBSZWdFeHAoJ15AJyArIG5hbWUgKyAnXFxcXHMqKFteO10rKTsnKTtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICAgIHZhciBtID0gbWF0Y2gocmUpO1xuICAgICAgaWYgKCFtKSByZXR1cm47XG4gICAgICB2YXIgcmV0ID0geyB0eXBlOiBuYW1lIH07XG4gICAgICByZXRbbmFtZV0gPSBtWzFdLnRyaW0oKTtcbiAgICAgIHJldHVybiBwb3MocmV0KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgYXQgcnVsZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gYXRydWxlKCkge1xuICAgIGlmIChjc3NbMF0gIT0gJ0AnKSByZXR1cm47XG5cbiAgICByZXR1cm4gYXRrZXlmcmFtZXMoKVxuICAgICAgfHwgYXRtZWRpYSgpXG4gICAgICB8fCBhdGN1c3RvbW1lZGlhKClcbiAgICAgIHx8IGF0c3VwcG9ydHMoKVxuICAgICAgfHwgYXRpbXBvcnQoKVxuICAgICAgfHwgYXRjaGFyc2V0KClcbiAgICAgIHx8IGF0bmFtZXNwYWNlKClcbiAgICAgIHx8IGF0ZG9jdW1lbnQoKVxuICAgICAgfHwgYXRwYWdlKClcbiAgICAgIHx8IGF0aG9zdCgpXG4gICAgICB8fCBhdGZvbnRmYWNlKCk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgcnVsZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gcnVsZSgpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgc2VsID0gc2VsZWN0b3IoKTtcblxuICAgIGlmICghc2VsKSByZXR1cm4gZXJyb3IoJ3NlbGVjdG9yIG1pc3NpbmcnKTtcbiAgICBjb21tZW50cygpO1xuXG4gICAgcmV0dXJuIHBvcyh7XG4gICAgICB0eXBlOiAncnVsZScsXG4gICAgICBzZWxlY3RvcnM6IHNlbCxcbiAgICAgIGRlY2xhcmF0aW9uczogZGVjbGFyYXRpb25zKClcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBhZGRQYXJlbnQoc3R5bGVzaGVldCgpKTtcbn07XG5cbi8qKlxuICogVHJpbSBgc3RyYC5cbiAqL1xuXG5mdW5jdGlvbiB0cmltKHN0cikge1xuICByZXR1cm4gc3RyID8gc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKSA6ICcnO1xufVxuXG4vKipcbiAqIEFkZHMgbm9uLWVudW1lcmFibGUgcGFyZW50IG5vZGUgcmVmZXJlbmNlIHRvIGVhY2ggbm9kZS5cbiAqL1xuXG5mdW5jdGlvbiBhZGRQYXJlbnQob2JqLCBwYXJlbnQpIHtcbiAgdmFyIGlzTm9kZSA9IG9iaiAmJiB0eXBlb2Ygb2JqLnR5cGUgPT09ICdzdHJpbmcnO1xuICB2YXIgY2hpbGRQYXJlbnQgPSBpc05vZGUgPyBvYmogOiBwYXJlbnQ7XG5cbiAgZm9yICh2YXIgayBpbiBvYmopIHtcbiAgICB2YXIgdmFsdWUgPSBvYmpba107XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICB2YWx1ZS5mb3JFYWNoKGZ1bmN0aW9uKHYpIHsgYWRkUGFyZW50KHYsIGNoaWxkUGFyZW50KTsgfSk7XG4gICAgfSBlbHNlIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICBhZGRQYXJlbnQodmFsdWUsIGNoaWxkUGFyZW50KTtcbiAgICB9XG4gIH1cblxuICBpZiAoaXNOb2RlKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwgJ3BhcmVudCcsIHtcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICB2YWx1ZTogcGFyZW50IHx8IG51bGxcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBvYmo7XG59XG4iLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXJsUmVnRXggPSAvXFxzKnVybFxcKCg/OignfFwiKShbXlxcMV0qKVxcMXwoW15cXCldKikpXFwpXFxzKi9neTtcbmZ1bmN0aW9uIHBhcnNlVVJMKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgdXJsUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IHVybFJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSB1cmxSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHZhbHVlID0gcmVzdWx0WzJdIHx8IHJlc3VsdFszXTtcbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbn1cbmV4cG9ydHMucGFyc2VVUkwgPSBwYXJzZVVSTDtcbnZhciBoZXhDb2xvclJlZ0V4ID0gL1xccyojKCg/OlswLTlBLUZdezh9KXwoPzpbMC05QS1GXXs2fSl8KD86WzAtOUEtRl17M30pKVxccyovZ2l5O1xuZnVuY3Rpb24gcGFyc2VIZXhDb2xvcih0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGhleENvbG9yUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IGhleENvbG9yUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IGhleENvbG9yUmVnRXgubGFzdEluZGV4O1xuICAgIHZhciBoZXggPSByZXN1bHRbMV07XG4gICAgdmFyIGFyZ2I7XG4gICAgaWYgKGhleC5sZW5ndGggPT09IDgpIHtcbiAgICAgICAgYXJnYiA9IHBhcnNlSW50KFwiMHhcIiArIGhleCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGhleC5sZW5ndGggPT09IDYpIHtcbiAgICAgICAgYXJnYiA9IHBhcnNlSW50KFwiMHhGRlwiICsgaGV4KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoaGV4Lmxlbmd0aCA9PT0gMykge1xuICAgICAgICBhcmdiID0gcGFyc2VJbnQoXCIweEZGXCIgKyBoZXhbMF0gKyBoZXhbMF0gKyBoZXhbMV0gKyBoZXhbMV0gKyBoZXhbMl0gKyBoZXhbMl0pO1xuICAgIH1cbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogYXJnYiB9O1xufVxuZXhwb3J0cy5wYXJzZUhleENvbG9yID0gcGFyc2VIZXhDb2xvcjtcbmZ1bmN0aW9uIHJnYmFUb0FyZ2JOdW1iZXIociwgZywgYiwgYSkge1xuICAgIGlmIChhID09PSB2b2lkIDApIHsgYSA9IDE7IH1cbiAgICBpZiAociA+PSAwICYmIHIgPD0gMjU1ICYmIGcgPj0gMCAmJiBnIDw9IDI1NSAmJiBiID49IDAgJiYgYiA8PSAyNTUgJiYgYSA+PSAwICYmIGEgPD0gMSkge1xuICAgICAgICByZXR1cm4gKE1hdGgucm91bmQoYSAqIDB4RkYpICogMHgwMTAwMDAwMCkgKyAociAqIDB4MDEwMDAwKSArIChnICogMHgwMDAxMDApICsgKGIgKiAweDAwMDAwMSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG52YXIgcmdiQ29sb3JSZWdFeCA9IC9cXHMqKHJnYlxcKFxccyooXFxkKilcXHMqLFxccyooXFxkKilcXHMqLFxccyooXFxkKilcXHMqXFwpKS9neTtcbmZ1bmN0aW9uIHBhcnNlUkdCQ29sb3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICByZ2JDb2xvclJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSByZ2JDb2xvclJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSByZ2JDb2xvclJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgdmFsdWUgPSByZXN1bHRbMV0gJiYgcmdiYVRvQXJnYk51bWJlcihwYXJzZUludChyZXN1bHRbMl0pLCBwYXJzZUludChyZXN1bHRbM10pLCBwYXJzZUludChyZXN1bHRbNF0pKTtcbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbn1cbmV4cG9ydHMucGFyc2VSR0JDb2xvciA9IHBhcnNlUkdCQ29sb3I7XG52YXIgcmdiYUNvbG9yUmVnRXggPSAvXFxzKihyZ2JhXFwoXFxzKihcXGQqKVxccyosXFxzKihcXGQqKVxccyosXFxzKihcXGQqKVxccyosXFxzKihbMDFdP1xcLj9cXGQqKVxccypcXCkpL2d5O1xuZnVuY3Rpb24gcGFyc2VSR0JBQ29sb3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICByZ2JhQ29sb3JSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gcmdiYUNvbG9yUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IHJnYmFDb2xvclJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgdmFsdWUgPSByZ2JhVG9BcmdiTnVtYmVyKHBhcnNlSW50KHJlc3VsdFsyXSksIHBhcnNlSW50KHJlc3VsdFszXSksIHBhcnNlSW50KHJlc3VsdFs0XSksIHBhcnNlRmxvYXQocmVzdWx0WzVdKSk7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG5leHBvcnRzLnBhcnNlUkdCQUNvbG9yID0gcGFyc2VSR0JBQ29sb3I7XG52YXIgY29sb3JzO1xuKGZ1bmN0aW9uIChjb2xvcnMpIHtcbiAgICBjb2xvcnNbY29sb3JzW1widHJhbnNwYXJlbnRcIl0gPSAwXSA9IFwidHJhbnNwYXJlbnRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYWxpY2VibHVlXCJdID0gNDI5Mzk4MjQ2M10gPSBcImFsaWNlYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJhbnRpcXVld2hpdGVcIl0gPSA0Mjk0NjM0NDU1XSA9IFwiYW50aXF1ZXdoaXRlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImFxdWFcIl0gPSA0Mjc4MjU1NjE1XSA9IFwiYXF1YVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJhcXVhbWFyaW5lXCJdID0gNDI4NjU3ODY0NF0gPSBcImFxdWFtYXJpbmVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYXp1cmVcIl0gPSA0MjkzOTg0MjU1XSA9IFwiYXp1cmVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYmVpZ2VcIl0gPSA0Mjk0MzA5MzQwXSA9IFwiYmVpZ2VcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYmlzcXVlXCJdID0gNDI5NDk2MDMyNF0gPSBcImJpc3F1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJibGFja1wiXSA9IDQyNzgxOTAwODBdID0gXCJibGFja1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJibGFuY2hlZGFsbW9uZFwiXSA9IDQyOTQ5NjIxMjVdID0gXCJibGFuY2hlZGFsbW9uZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJibHVlXCJdID0gNDI3ODE5MDMzNV0gPSBcImJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYmx1ZXZpb2xldFwiXSA9IDQyODcyNDUyODJdID0gXCJibHVldmlvbGV0XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImJyb3duXCJdID0gNDI4OTAxNDMxNF0gPSBcImJyb3duXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImJ1cmx5d29vZFwiXSA9IDQyOTI3ODYzMTFdID0gXCJidXJseXdvb2RcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY2FkZXRibHVlXCJdID0gNDI4NDQ1NjYwOF0gPSBcImNhZGV0Ymx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJjaGFydHJldXNlXCJdID0gNDI4NjU3ODQzMl0gPSBcImNoYXJ0cmV1c2VcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY2hvY29sYXRlXCJdID0gNDI5MTk3OTU1MF0gPSBcImNob2NvbGF0ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJjb3JhbFwiXSA9IDQyOTQ5MzQzNTJdID0gXCJjb3JhbFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJjb3JuZmxvd2VyYmx1ZVwiXSA9IDQyODQ3ODIwNjFdID0gXCJjb3JuZmxvd2VyYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJjb3Juc2lsa1wiXSA9IDQyOTQ5NjU0NjhdID0gXCJjb3Juc2lsa1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJjcmltc29uXCJdID0gNDI5MjYxMzE4MF0gPSBcImNyaW1zb25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY3lhblwiXSA9IDQyNzgyNTU2MTVdID0gXCJjeWFuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtibHVlXCJdID0gNDI3ODE5MDIxOV0gPSBcImRhcmtibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtjeWFuXCJdID0gNDI3ODIyNTgwM10gPSBcImRhcmtjeWFuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtnb2xkZW5yb2RcIl0gPSA0MjkwMjgzMDE5XSA9IFwiZGFya2dvbGRlbnJvZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrZ3JheVwiXSA9IDQyODkzMDkwOTddID0gXCJkYXJrZ3JheVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrZ3JlZW5cIl0gPSA0Mjc4MjE1NjgwXSA9IFwiZGFya2dyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtncmV5XCJdID0gNDI4OTMwOTA5N10gPSBcImRhcmtncmV5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtraGFraVwiXSA9IDQyOTA2MjMzMzldID0gXCJkYXJra2hha2lcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya21hZ2VudGFcIl0gPSA0Mjg3Mjk5NzIzXSA9IFwiZGFya21hZ2VudGFcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya29saXZlZ3JlZW5cIl0gPSA0MjgzNzg4MDc5XSA9IFwiZGFya29saXZlZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya29yYW5nZVwiXSA9IDQyOTQ5Mzc2MDBdID0gXCJkYXJrb3JhbmdlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtvcmNoaWRcIl0gPSA0Mjg4MjMwMDkyXSA9IFwiZGFya29yY2hpZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrcmVkXCJdID0gNDI4NzI5OTU4NF0gPSBcImRhcmtyZWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya3NhbG1vblwiXSA9IDQyOTM0OTg0OTBdID0gXCJkYXJrc2FsbW9uXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtzZWFncmVlblwiXSA9IDQyODc2MDk5OTldID0gXCJkYXJrc2VhZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya3NsYXRlYmx1ZVwiXSA9IDQyODI5MjQ0MjddID0gXCJkYXJrc2xhdGVibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtzbGF0ZWdyYXlcIl0gPSA0MjgxMjkwNTc1XSA9IFwiZGFya3NsYXRlZ3JheVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrc2xhdGVncmV5XCJdID0gNDI4MTI5MDU3NV0gPSBcImRhcmtzbGF0ZWdyZXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya3R1cnF1b2lzZVwiXSA9IDQyNzgyNDMwMjVdID0gXCJkYXJrdHVycXVvaXNlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmt2aW9sZXRcIl0gPSA0Mjg3ODg5NjE5XSA9IFwiZGFya3Zpb2xldFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkZWVwcGlua1wiXSA9IDQyOTQ5MDcwMjddID0gXCJkZWVwcGlua1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkZWVwc2t5Ymx1ZVwiXSA9IDQyNzgyMzkyMzFdID0gXCJkZWVwc2t5Ymx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkaW1ncmF5XCJdID0gNDI4NTA5ODM0NV0gPSBcImRpbWdyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGltZ3JleVwiXSA9IDQyODUwOTgzNDVdID0gXCJkaW1ncmV5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRvZGdlcmJsdWVcIl0gPSA0MjgwMTkzMjc5XSA9IFwiZG9kZ2VyYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJmaXJlYnJpY2tcIl0gPSA0Mjg5ODY0MjI2XSA9IFwiZmlyZWJyaWNrXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImZsb3JhbHdoaXRlXCJdID0gNDI5NDk2NjAwMF0gPSBcImZsb3JhbHdoaXRlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImZvcmVzdGdyZWVuXCJdID0gNDI4MDQ1MzkyMl0gPSBcImZvcmVzdGdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImZ1Y2hzaWFcIl0gPSA0Mjk0OTAyMDE1XSA9IFwiZnVjaHNpYVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJnYWluc2Jvcm9cIl0gPSA0MjkyNjY0NTQwXSA9IFwiZ2FpbnNib3JvXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImdob3N0d2hpdGVcIl0gPSA0Mjk0NTA2NzUxXSA9IFwiZ2hvc3R3aGl0ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJnb2xkXCJdID0gNDI5NDk1NjgwMF0gPSBcImdvbGRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ29sZGVucm9kXCJdID0gNDI5MjUxOTIwMF0gPSBcImdvbGRlbnJvZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJncmF5XCJdID0gNDI4NjYxMTU4NF0gPSBcImdyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ3JlZW5cIl0gPSA0Mjc4MjIyODQ4XSA9IFwiZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ3JlZW55ZWxsb3dcIl0gPSA0Mjg5NTkzMTM1XSA9IFwiZ3JlZW55ZWxsb3dcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ3JleVwiXSA9IDQyODY2MTE1ODRdID0gXCJncmV5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImhvbmV5ZGV3XCJdID0gNDI5Mzk4NDI0MF0gPSBcImhvbmV5ZGV3XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImhvdHBpbmtcIl0gPSA0Mjk0OTI4ODIwXSA9IFwiaG90cGlua1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJpbmRpYW5yZWRcIl0gPSA0MjkxNjQ4NjA0XSA9IFwiaW5kaWFucmVkXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImluZGlnb1wiXSA9IDQyODMxMDU0MTBdID0gXCJpbmRpZ29cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiaXZvcnlcIl0gPSA0Mjk0OTY3MjgwXSA9IFwiaXZvcnlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wia2hha2lcIl0gPSA0MjkzOTc3NzQwXSA9IFwia2hha2lcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGF2ZW5kZXJcIl0gPSA0MjkzMzIyNDkwXSA9IFwibGF2ZW5kZXJcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGF2ZW5kZXJibHVzaFwiXSA9IDQyOTQ5NjM0NDVdID0gXCJsYXZlbmRlcmJsdXNoXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxhd25ncmVlblwiXSA9IDQyODYzODEwNTZdID0gXCJsYXduZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGVtb25jaGlmZm9uXCJdID0gNDI5NDk2NTk2NV0gPSBcImxlbW9uY2hpZmZvblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodGJsdWVcIl0gPSA0Mjg5NTgzMzM0XSA9IFwibGlnaHRibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0Y29yYWxcIl0gPSA0MjkzOTUxNjE2XSA9IFwibGlnaHRjb3JhbFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodGN5YW5cIl0gPSA0MjkyOTM1Njc5XSA9IFwibGlnaHRjeWFuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0Z29sZGVucm9keWVsbG93XCJdID0gNDI5NDYzODI5MF0gPSBcImxpZ2h0Z29sZGVucm9keWVsbG93XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0Z3JheVwiXSA9IDQyOTIwNzI0MDNdID0gXCJsaWdodGdyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRncmVlblwiXSA9IDQyODc2ODgzMzZdID0gXCJsaWdodGdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0Z3JleVwiXSA9IDQyOTIwNzI0MDNdID0gXCJsaWdodGdyZXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRwaW5rXCJdID0gNDI5NDk0ODU0NV0gPSBcImxpZ2h0cGlua1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodHNhbG1vblwiXSA9IDQyOTQ5NDI4NDJdID0gXCJsaWdodHNhbG1vblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodHNlYWdyZWVuXCJdID0gNDI4MDMzMjk3MF0gPSBcImxpZ2h0c2VhZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRza3libHVlXCJdID0gNDI4NzA5MDQyNl0gPSBcImxpZ2h0c2t5Ymx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodHNsYXRlZ3JheVwiXSA9IDQyODYwMjM4MzNdID0gXCJsaWdodHNsYXRlZ3JheVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodHNsYXRlZ3JleVwiXSA9IDQyODYwMjM4MzNdID0gXCJsaWdodHNsYXRlZ3JleVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodHN0ZWVsYmx1ZVwiXSA9IDQyODk3NzQ4MTRdID0gXCJsaWdodHN0ZWVsYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodHllbGxvd1wiXSA9IDQyOTQ5NjcyNjRdID0gXCJsaWdodHllbGxvd1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaW1lXCJdID0gNDI3ODI1NTM2MF0gPSBcImxpbWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGltZWdyZWVuXCJdID0gNDI4MTUxOTQxMF0gPSBcImxpbWVncmVlblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaW5lblwiXSA9IDQyOTQ2MzU3NTBdID0gXCJsaW5lblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtYWdlbnRhXCJdID0gNDI5NDkwMjAxNV0gPSBcIm1hZ2VudGFcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWFyb29uXCJdID0gNDI4NjU3ODY4OF0gPSBcIm1hcm9vblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtZWRpdW1hcXVhbWFyaW5lXCJdID0gNDI4NDkyNzQwMl0gPSBcIm1lZGl1bWFxdWFtYXJpbmVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWVkaXVtYmx1ZVwiXSA9IDQyNzgxOTAyODVdID0gXCJtZWRpdW1ibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1lZGl1bW9yY2hpZFwiXSA9IDQyOTA0MDE3NDddID0gXCJtZWRpdW1vcmNoaWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWVkaXVtcHVycGxlXCJdID0gNDI4Nzg1Mjc2M10gPSBcIm1lZGl1bXB1cnBsZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtZWRpdW1zZWFncmVlblwiXSA9IDQyODIxNjgxNzddID0gXCJtZWRpdW1zZWFncmVlblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtZWRpdW1zbGF0ZWJsdWVcIl0gPSA0Mjg2Mjc3ODcwXSA9IFwibWVkaXVtc2xhdGVibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1lZGl1bXNwcmluZ2dyZWVuXCJdID0gNDI3ODI1NDIzNF0gPSBcIm1lZGl1bXNwcmluZ2dyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1lZGl1bXR1cnF1b2lzZVwiXSA9IDQyODI5NjIzODBdID0gXCJtZWRpdW10dXJxdW9pc2VcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWVkaXVtdmlvbGV0cmVkXCJdID0gNDI5MTIzNzI1M10gPSBcIm1lZGl1bXZpb2xldHJlZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtaWRuaWdodGJsdWVcIl0gPSA0Mjc5ODM0OTkyXSA9IFwibWlkbmlnaHRibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1pbnRjcmVhbVwiXSA9IDQyOTQzMTE5MzBdID0gXCJtaW50Y3JlYW1cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWlzdHlyb3NlXCJdID0gNDI5NDk2MDM1M10gPSBcIm1pc3R5cm9zZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtb2NjYXNpblwiXSA9IDQyOTQ5NjAzMDldID0gXCJtb2NjYXNpblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJuYXZham93aGl0ZVwiXSA9IDQyOTQ5NTg3NjVdID0gXCJuYXZham93aGl0ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJuYXZ5XCJdID0gNDI3ODE5MDIwOF0gPSBcIm5hdnlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wib2xkbGFjZVwiXSA9IDQyOTQ4MzM2MzhdID0gXCJvbGRsYWNlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm9saXZlXCJdID0gNDI4NjYxMTQ1Nl0gPSBcIm9saXZlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm9saXZlZHJhYlwiXSA9IDQyODUyMzg4MTldID0gXCJvbGl2ZWRyYWJcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wib3JhbmdlXCJdID0gNDI5NDk0NDAwMF0gPSBcIm9yYW5nZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJvcmFuZ2VyZWRcIl0gPSA0Mjk0OTE5NDI0XSA9IFwib3JhbmdlcmVkXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm9yY2hpZFwiXSA9IDQyOTI1MDU4MTRdID0gXCJvcmNoaWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicGFsZWdvbGRlbnJvZFwiXSA9IDQyOTM4NDcyMTBdID0gXCJwYWxlZ29sZGVucm9kXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBhbGVncmVlblwiXSA9IDQyODgyMTU5NjBdID0gXCJwYWxlZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicGFsZXR1cnF1b2lzZVwiXSA9IDQyODk3MjAwNDZdID0gXCJwYWxldHVycXVvaXNlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBhbGV2aW9sZXRyZWRcIl0gPSA0MjkyNTcxMjgzXSA9IFwicGFsZXZpb2xldHJlZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJwYXBheWF3aGlwXCJdID0gNDI5NDk2MzE1N10gPSBcInBhcGF5YXdoaXBcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicGVhY2hwdWZmXCJdID0gNDI5NDk1Nzc1M10gPSBcInBlYWNocHVmZlwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJwZXJ1XCJdID0gNDI5MTY1OTA3MV0gPSBcInBlcnVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicGlua1wiXSA9IDQyOTQ5NTExMTVdID0gXCJwaW5rXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBsdW1cIl0gPSA0MjkyNzE0NzE3XSA9IFwicGx1bVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJwb3dkZXJibHVlXCJdID0gNDI4OTc4MTk5MF0gPSBcInBvd2RlcmJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicHVycGxlXCJdID0gNDI4NjU3ODgxNl0gPSBcInB1cnBsZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJyZWJlY2NhcHVycGxlXCJdID0gNDI4NDg4Nzk2MV0gPSBcInJlYmVjY2FwdXJwbGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicmVkXCJdID0gNDI5NDkwMTc2MF0gPSBcInJlZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJyb3N5YnJvd25cIl0gPSA0MjkwNTQ3NTk5XSA9IFwicm9zeWJyb3duXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInJveWFsYmx1ZVwiXSA9IDQyODI0NzcwMjVdID0gXCJyb3lhbGJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2FkZGxlYnJvd25cIl0gPSA0Mjg3MzE3MjY3XSA9IFwic2FkZGxlYnJvd25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2FsbW9uXCJdID0gNDI5NDYwNjk2Ml0gPSBcInNhbG1vblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJzYW5keWJyb3duXCJdID0gNDI5NDIyMjk0NF0gPSBcInNhbmR5YnJvd25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2VhZ3JlZW5cIl0gPSA0MjgxMjQwNDA3XSA9IFwic2VhZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2Vhc2hlbGxcIl0gPSA0Mjk0OTY0NzE4XSA9IFwic2Vhc2hlbGxcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2llbm5hXCJdID0gNDI4ODY5Njg3N10gPSBcInNpZW5uYVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJzaWx2ZXJcIl0gPSA0MjkwODIyMzM2XSA9IFwic2lsdmVyXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNreWJsdWVcIl0gPSA0Mjg3MDkwNDExXSA9IFwic2t5Ymx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJzbGF0ZWJsdWVcIl0gPSA0Mjg1MTYwMTQxXSA9IFwic2xhdGVibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNsYXRlZ3JheVwiXSA9IDQyODU1NjMwMjRdID0gXCJzbGF0ZWdyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2xhdGVncmV5XCJdID0gNDI4NTU2MzAyNF0gPSBcInNsYXRlZ3JleVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJzbm93XCJdID0gNDI5NDk2NjAxMF0gPSBcInNub3dcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic3ByaW5nZ3JlZW5cIl0gPSA0Mjc4MjU1NDg3XSA9IFwic3ByaW5nZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic3RlZWxibHVlXCJdID0gNDI4MjgxMTA2MF0gPSBcInN0ZWVsYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJ0YW5cIl0gPSA0MjkxOTk4ODYwXSA9IFwidGFuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInRlYWxcIl0gPSA0Mjc4MjIyOTc2XSA9IFwidGVhbFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJ0aGlzdGxlXCJdID0gNDI5MjM5NDk2OF0gPSBcInRoaXN0bGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1widG9tYXRvXCJdID0gNDI5NDkyNzE3NV0gPSBcInRvbWF0b1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJ0dXJxdW9pc2VcIl0gPSA0MjgyNDQxOTM2XSA9IFwidHVycXVvaXNlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInZpb2xldFwiXSA9IDQyOTM4MjExNjZdID0gXCJ2aW9sZXRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wid2hlYXRcIl0gPSA0Mjk0MzAzNDExXSA9IFwid2hlYXRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wid2hpdGVcIl0gPSA0Mjk0OTY3Mjk1XSA9IFwid2hpdGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wid2hpdGVzbW9rZVwiXSA9IDQyOTQzMDkzNjVdID0gXCJ3aGl0ZXNtb2tlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInllbGxvd1wiXSA9IDQyOTQ5NjcwNDBdID0gXCJ5ZWxsb3dcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wieWVsbG93Z3JlZW5cIl0gPSA0Mjg4MzM1MTU0XSA9IFwieWVsbG93Z3JlZW5cIjtcbn0pKGNvbG9ycyA9IGV4cG9ydHMuY29sb3JzIHx8IChleHBvcnRzLmNvbG9ycyA9IHt9KSk7XG5mdW5jdGlvbiBwYXJzZUNvbG9yS2V5d29yZCh2YWx1ZSwgc3RhcnQsIGtleXdvcmQpIHtcbiAgICBpZiAoa2V5d29yZCA9PT0gdm9pZCAwKSB7IGtleXdvcmQgPSBwYXJzZUtleXdvcmQodmFsdWUsIHN0YXJ0KTsgfVxuICAgIGlmIChrZXl3b3JkICYmIGtleXdvcmQudmFsdWUgaW4gY29sb3JzKSB7XG4gICAgICAgIHZhciBlbmQgPSBrZXl3b3JkLmVuZDtcbiAgICAgICAgdmFyIHZhbHVlXzEgPSBjb2xvcnNba2V5d29yZC52YWx1ZV07XG4gICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZV8xIH07XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuZXhwb3J0cy5wYXJzZUNvbG9yS2V5d29yZCA9IHBhcnNlQ29sb3JLZXl3b3JkO1xuZnVuY3Rpb24gcGFyc2VDb2xvcih2YWx1ZSwgc3RhcnQsIGtleXdvcmQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBpZiAoa2V5d29yZCA9PT0gdm9pZCAwKSB7IGtleXdvcmQgPSBwYXJzZUtleXdvcmQodmFsdWUsIHN0YXJ0KTsgfVxuICAgIHJldHVybiBwYXJzZUhleENvbG9yKHZhbHVlLCBzdGFydCkgfHwgcGFyc2VDb2xvcktleXdvcmQodmFsdWUsIHN0YXJ0LCBrZXl3b3JkKSB8fCBwYXJzZVJHQkNvbG9yKHZhbHVlLCBzdGFydCkgfHwgcGFyc2VSR0JBQ29sb3IodmFsdWUsIHN0YXJ0KTtcbn1cbmV4cG9ydHMucGFyc2VDb2xvciA9IHBhcnNlQ29sb3I7XG52YXIga2V5d29yZFJlZ0V4ID0gL1xccyooW2Etel1bXFx3XFwtXSopXFxzKi9naXk7XG5mdW5jdGlvbiBwYXJzZUtleXdvcmQodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBrZXl3b3JkUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IGtleXdvcmRSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0ga2V5d29yZFJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgdmFsdWUgPSByZXN1bHRbMV07XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG52YXIgYmFja2dyb3VuZFJlcGVhdEtleXdvcmRzID0gbmV3IFNldChbXCJyZXBlYXRcIiwgXCJyZXBlYXQteFwiLCBcInJlcGVhdC15XCIsIFwibm8tcmVwZWF0XCJdKTtcbmZ1bmN0aW9uIHBhcnNlUmVwZWF0KHZhbHVlLCBzdGFydCwga2V5d29yZCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGlmIChrZXl3b3JkID09PSB2b2lkIDApIHsga2V5d29yZCA9IHBhcnNlS2V5d29yZCh2YWx1ZSwgc3RhcnQpOyB9XG4gICAgaWYgKGtleXdvcmQgJiYgYmFja2dyb3VuZFJlcGVhdEtleXdvcmRzLmhhcyhrZXl3b3JkLnZhbHVlKSkge1xuICAgICAgICB2YXIgZW5kID0ga2V5d29yZC5lbmQ7XG4gICAgICAgIHZhciB2YWx1ZV8yID0ga2V5d29yZC52YWx1ZTtcbiAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlXzIgfTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5leHBvcnRzLnBhcnNlUmVwZWF0ID0gcGFyc2VSZXBlYXQ7XG52YXIgdW5pdFJlZ0V4ID0gL1xccyooW1xcK1xcLV0/KD86XFxkK1xcLlxcZCt8XFxkK3xcXC5cXGQrKSg/OltlRV1bXFwrXFwtXT9cXGQrKT8pKFthLXpBLVpdK3wlKT9cXHMqL2d5O1xuZnVuY3Rpb24gcGFyc2VVbml0KHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgdW5pdFJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSB1bml0UmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IHVuaXRSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHZhbHVlID0gcGFyc2VGbG9hdChyZXN1bHRbMV0pO1xuICAgIHZhciB1bml0ID0gcmVzdWx0WzJdIHx8IFwiZGlwXCI7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgdmFsdWU6IHZhbHVlLCB1bml0OiB1bml0IH0gfTtcbn1cbmV4cG9ydHMucGFyc2VVbml0ID0gcGFyc2VVbml0O1xuZnVuY3Rpb24gcGFyc2VQZXJjZW50YWdlT3JMZW5ndGgodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICB2YXIgdW5pdFJlc3VsdCA9IHBhcnNlVW5pdCh0ZXh0LCBzdGFydCk7XG4gICAgaWYgKHVuaXRSZXN1bHQpIHtcbiAgICAgICAgdmFyIHN0YXJ0XzEgPSB1bml0UmVzdWx0LnN0YXJ0LCBlbmQgPSB1bml0UmVzdWx0LmVuZDtcbiAgICAgICAgdmFyIHZhbHVlID0gdW5pdFJlc3VsdC52YWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlLnVuaXQgPT09IFwiJVwiKSB7XG4gICAgICAgICAgICB2YWx1ZS52YWx1ZSAvPSAxMDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIXZhbHVlLnVuaXQpIHtcbiAgICAgICAgICAgIHZhbHVlLnVuaXQgPSBcImRpcFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlLnVuaXQgPT09IFwicHhcIiB8fCB2YWx1ZS51bml0ID09PSBcImRpcFwiKSB7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnRfMSwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydHMucGFyc2VQZXJjZW50YWdlT3JMZW5ndGggPSBwYXJzZVBlcmNlbnRhZ2VPckxlbmd0aDtcbnZhciBhbmdsZVVuaXRzVG9SYWRNYXAgPSB7XG4gICAgXCJkZWdcIjogZnVuY3Rpb24gKHN0YXJ0LCBlbmQsIGRlZykgeyByZXR1cm4gKHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IGRlZyAvIDE4MCAqIE1hdGguUEkgfSk7IH0sXG4gICAgXCJyYWRcIjogZnVuY3Rpb24gKHN0YXJ0LCBlbmQsIHJhZCkgeyByZXR1cm4gKHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHJhZCB9KTsgfSxcbiAgICBcImdyYWRcIjogZnVuY3Rpb24gKHN0YXJ0LCBlbmQsIGdyYWQpIHsgcmV0dXJuICh7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiBncmFkIC8gMjAwICogTWF0aC5QSSB9KTsgfSxcbiAgICBcInR1cm5cIjogZnVuY3Rpb24gKHN0YXJ0LCBlbmQsIHR1cm4pIHsgcmV0dXJuICh7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB0dXJuICogTWF0aC5QSSAqIDIgfSk7IH1cbn07XG5mdW5jdGlvbiBwYXJzZUFuZ2xlKHZhbHVlLCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHZhciBhbmdsZVJlc3VsdCA9IHBhcnNlVW5pdCh2YWx1ZSwgc3RhcnQpO1xuICAgIGlmIChhbmdsZVJlc3VsdCkge1xuICAgICAgICB2YXIgc3RhcnRfMiA9IGFuZ2xlUmVzdWx0LnN0YXJ0LCBlbmQgPSBhbmdsZVJlc3VsdC5lbmQsIHZhbHVlXzMgPSBhbmdsZVJlc3VsdC52YWx1ZTtcbiAgICAgICAgcmV0dXJuIChhbmdsZVVuaXRzVG9SYWRNYXBbdmFsdWVfMy51bml0XSB8fCAoZnVuY3Rpb24gKF8sIF9fLCBfX18pIHsgcmV0dXJuIG51bGw7IH0pKShzdGFydF8yLCBlbmQsIHZhbHVlXzMudmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydHMucGFyc2VBbmdsZSA9IHBhcnNlQW5nbGU7XG52YXIgYmFja2dyb3VuZFNpemVLZXl3b3JkcyA9IG5ldyBTZXQoW1wiYXV0b1wiLCBcImNvbnRhaW5cIiwgXCJjb3ZlclwiXSk7XG5mdW5jdGlvbiBwYXJzZUJhY2tncm91bmRTaXplKHZhbHVlLCBzdGFydCwga2V5d29yZCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGlmIChrZXl3b3JkID09PSB2b2lkIDApIHsga2V5d29yZCA9IHBhcnNlS2V5d29yZCh2YWx1ZSwgc3RhcnQpOyB9XG4gICAgdmFyIGVuZCA9IHN0YXJ0O1xuICAgIGlmIChrZXl3b3JkICYmIGJhY2tncm91bmRTaXplS2V5d29yZHMuaGFzKGtleXdvcmQudmFsdWUpKSB7XG4gICAgICAgIGVuZCA9IGtleXdvcmQuZW5kO1xuICAgICAgICB2YXIgdmFsdWVfNCA9IGtleXdvcmQudmFsdWU7XG4gICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZV80IH07XG4gICAgfVxuICAgIHZhciBmaXJzdExlbmd0aCA9IHBhcnNlUGVyY2VudGFnZU9yTGVuZ3RoKHZhbHVlLCBlbmQpO1xuICAgIGlmIChmaXJzdExlbmd0aCkge1xuICAgICAgICBlbmQgPSBmaXJzdExlbmd0aC5lbmQ7XG4gICAgICAgIHZhciBzZWNvbmRMZW5ndGggPSBwYXJzZVBlcmNlbnRhZ2VPckxlbmd0aCh2YWx1ZSwgZmlyc3RMZW5ndGguZW5kKTtcbiAgICAgICAgaWYgKHNlY29uZExlbmd0aCkge1xuICAgICAgICAgICAgZW5kID0gc2Vjb25kTGVuZ3RoLmVuZDtcbiAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHg6IGZpcnN0TGVuZ3RoLnZhbHVlLCB5OiBzZWNvbmRMZW5ndGgudmFsdWUgfSB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgeDogZmlyc3RMZW5ndGgudmFsdWUsIHk6IFwiYXV0b1wiIH0gfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydHMucGFyc2VCYWNrZ3JvdW5kU2l6ZSA9IHBhcnNlQmFja2dyb3VuZFNpemU7XG52YXIgYmFja2dyb3VuZFBvc2l0aW9uS2V5d29yZHMgPSBPYmplY3QuZnJlZXplKG5ldyBTZXQoW1wibGVmdFwiLCBcInJpZ2h0XCIsIFwidG9wXCIsIFwiYm90dG9tXCIsIFwiY2VudGVyXCJdKSk7XG52YXIgYmFja2dyb3VuZFBvc2l0aW9uS2V5d29yZHNEaXJlY3Rpb24gPSB7XG4gICAgXCJsZWZ0XCI6IFwieFwiLFxuICAgIFwicmlnaHRcIjogXCJ4XCIsXG4gICAgXCJjZW50ZXJcIjogXCJjZW50ZXJcIixcbiAgICBcInRvcFwiOiBcInlcIixcbiAgICBcImJvdHRvbVwiOiBcInlcIlxufTtcbmZ1bmN0aW9uIHBhcnNlQmFja2dyb3VuZFBvc2l0aW9uKHRleHQsIHN0YXJ0LCBrZXl3b3JkKSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgaWYgKGtleXdvcmQgPT09IHZvaWQgMCkgeyBrZXl3b3JkID0gcGFyc2VLZXl3b3JkKHRleHQsIHN0YXJ0KTsgfVxuICAgIGZ1bmN0aW9uIGZvcm1hdEgoYWxpZ24sIG9mZnNldCkge1xuICAgICAgICBpZiAoYWxpZ24udmFsdWUgPT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBcImNlbnRlclwiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvZmZzZXQgJiYgb2Zmc2V0LnZhbHVlLnZhbHVlICE9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4geyBhbGlnbjogYWxpZ24udmFsdWUsIG9mZnNldDogb2Zmc2V0LnZhbHVlIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFsaWduLnZhbHVlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBmb3JtYXRWKGFsaWduLCBvZmZzZXQpIHtcbiAgICAgICAgaWYgKGFsaWduLnZhbHVlID09PSBcImNlbnRlclwiKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJjZW50ZXJcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAob2Zmc2V0ICYmIG9mZnNldC52YWx1ZS52YWx1ZSAhPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgYWxpZ246IGFsaWduLnZhbHVlLCBvZmZzZXQ6IG9mZnNldC52YWx1ZSB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhbGlnbi52YWx1ZTtcbiAgICB9XG4gICAgdmFyIGVuZCA9IHN0YXJ0O1xuICAgIGlmIChrZXl3b3JkICYmIGJhY2tncm91bmRQb3NpdGlvbktleXdvcmRzLmhhcyhrZXl3b3JkLnZhbHVlKSkge1xuICAgICAgICBlbmQgPSBrZXl3b3JkLmVuZDtcbiAgICAgICAgdmFyIGZpcnN0RGlyZWN0aW9uID0gYmFja2dyb3VuZFBvc2l0aW9uS2V5d29yZHNEaXJlY3Rpb25ba2V5d29yZC52YWx1ZV07XG4gICAgICAgIHZhciBmaXJzdExlbmd0aCA9IGZpcnN0RGlyZWN0aW9uICE9PSBcImNlbnRlclwiICYmIHBhcnNlUGVyY2VudGFnZU9yTGVuZ3RoKHRleHQsIGVuZCk7XG4gICAgICAgIGlmIChmaXJzdExlbmd0aCkge1xuICAgICAgICAgICAgZW5kID0gZmlyc3RMZW5ndGguZW5kO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZWNvbmRLZXl3b3JkID0gcGFyc2VLZXl3b3JkKHRleHQsIGVuZCk7XG4gICAgICAgIGlmIChzZWNvbmRLZXl3b3JkICYmIGJhY2tncm91bmRQb3NpdGlvbktleXdvcmRzLmhhcyhzZWNvbmRLZXl3b3JkLnZhbHVlKSkge1xuICAgICAgICAgICAgZW5kID0gc2Vjb25kS2V5d29yZC5lbmQ7XG4gICAgICAgICAgICB2YXIgc2Vjb25kRGlyZWN0aW9uID0gYmFja2dyb3VuZFBvc2l0aW9uS2V5d29yZHNEaXJlY3Rpb25bc2Vjb25kS2V5d29yZC5lbmRdO1xuICAgICAgICAgICAgaWYgKGZpcnN0RGlyZWN0aW9uID09PSBzZWNvbmREaXJlY3Rpb24gJiYgZmlyc3REaXJlY3Rpb24gIT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzZWNvbmRMZW5ndGggPSBzZWNvbmREaXJlY3Rpb24gIT09IFwiY2VudGVyXCIgJiYgcGFyc2VQZXJjZW50YWdlT3JMZW5ndGgodGV4dCwgZW5kKTtcbiAgICAgICAgICAgIGlmIChzZWNvbmRMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBlbmQgPSBzZWNvbmRMZW5ndGguZW5kO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChmaXJzdERpcmVjdGlvbiA9PT0gc2Vjb25kRGlyZWN0aW9uICYmIHNlY29uZERpcmVjdGlvbiA9PT0gXCJjZW50ZXJcIikgfHwgKGZpcnN0RGlyZWN0aW9uID09PSBcInhcIiB8fCBzZWNvbmREaXJlY3Rpb24gPT09IFwieVwiKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4OiBmb3JtYXRIKGtleXdvcmQsIGZpcnN0TGVuZ3RoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IGZvcm1hdFYoc2Vjb25kS2V5d29yZCwgc2Vjb25kTGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICB9IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgeDogZm9ybWF0SChzZWNvbmRLZXl3b3JkLCBzZWNvbmRMZW5ndGgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgeTogZm9ybWF0VihrZXl3b3JkLCBmaXJzdExlbmd0aCksXG4gICAgICAgICAgICAgICAgICAgIH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChmaXJzdERpcmVjdGlvbiA9PT0gXCJjZW50ZXJcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHg6IFwiY2VudGVyXCIsIHk6IFwiY2VudGVyXCIgfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZmlyc3REaXJlY3Rpb24gPT09IFwieFwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgeDogZm9ybWF0SChrZXl3b3JkLCBmaXJzdExlbmd0aCksIHk6IFwiY2VudGVyXCIgfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgeDogXCJjZW50ZXJcIiwgeTogZm9ybWF0VihrZXl3b3JkLCBmaXJzdExlbmd0aCkgfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgZmlyc3RMZW5ndGggPSBwYXJzZVBlcmNlbnRhZ2VPckxlbmd0aCh0ZXh0LCBlbmQpO1xuICAgICAgICBpZiAoZmlyc3RMZW5ndGgpIHtcbiAgICAgICAgICAgIGVuZCA9IGZpcnN0TGVuZ3RoLmVuZDtcbiAgICAgICAgICAgIHZhciBzZWNvbmRMZW5ndGggPSBwYXJzZVBlcmNlbnRhZ2VPckxlbmd0aCh0ZXh0LCBlbmQpO1xuICAgICAgICAgICAgaWYgKHNlY29uZExlbmd0aCkge1xuICAgICAgICAgICAgICAgIGVuZCA9IHNlY29uZExlbmd0aC5lbmQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgeDogeyBhbGlnbjogXCJsZWZ0XCIsIG9mZnNldDogZmlyc3RMZW5ndGgudmFsdWUgfSwgeTogeyBhbGlnbjogXCJ0b3BcIiwgb2Zmc2V0OiBzZWNvbmRMZW5ndGgudmFsdWUgfSB9IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyB4OiB7IGFsaWduOiBcImxlZnRcIiwgb2Zmc2V0OiBmaXJzdExlbmd0aC52YWx1ZSB9LCB5OiBcImNlbnRlclwiIH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5wYXJzZUJhY2tncm91bmRQb3NpdGlvbiA9IHBhcnNlQmFja2dyb3VuZFBvc2l0aW9uO1xudmFyIGRpcmVjdGlvblJlZ0V4ID0gL1xccyp0b1xccyoobGVmdHxyaWdodHx0b3B8Ym90dG9tKVxccyoobGVmdHxyaWdodHx0b3B8Ym90dG9tKT9cXHMqL2d5O1xudmFyIHNpZGVEaXJlY3Rpb25zID0ge1xuICAgIHRvcDogTWF0aC5QSSAqIDAgLyAyLFxuICAgIHJpZ2h0OiBNYXRoLlBJICogMSAvIDIsXG4gICAgYm90dG9tOiBNYXRoLlBJICogMiAvIDIsXG4gICAgbGVmdDogTWF0aC5QSSAqIDMgLyAyXG59O1xudmFyIGNvcm5lckRpcmVjdGlvbnMgPSB7XG4gICAgdG9wOiB7XG4gICAgICAgIHJpZ2h0OiBNYXRoLlBJICogMSAvIDQsXG4gICAgICAgIGxlZnQ6IE1hdGguUEkgKiA3IC8gNFxuICAgIH0sXG4gICAgcmlnaHQ6IHtcbiAgICAgICAgdG9wOiBNYXRoLlBJICogMSAvIDQsXG4gICAgICAgIGJvdHRvbTogTWF0aC5QSSAqIDMgLyA0XG4gICAgfSxcbiAgICBib3R0b206IHtcbiAgICAgICAgcmlnaHQ6IE1hdGguUEkgKiAzIC8gNCxcbiAgICAgICAgbGVmdDogTWF0aC5QSSAqIDUgLyA0XG4gICAgfSxcbiAgICBsZWZ0OiB7XG4gICAgICAgIHRvcDogTWF0aC5QSSAqIDcgLyA0LFxuICAgICAgICBib3R0b206IE1hdGguUEkgKiA1IC8gNFxuICAgIH1cbn07XG5mdW5jdGlvbiBwYXJzZURpcmVjdGlvbih0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGRpcmVjdGlvblJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSBkaXJlY3Rpb25SZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gZGlyZWN0aW9uUmVnRXgubGFzdEluZGV4O1xuICAgIHZhciBmaXJzdERpcmVjdGlvbiA9IHJlc3VsdFsxXTtcbiAgICBpZiAocmVzdWx0WzJdKSB7XG4gICAgICAgIHZhciBzZWNvbmREaXJlY3Rpb24gPSByZXN1bHRbMl07XG4gICAgICAgIHZhciB2YWx1ZSA9IGNvcm5lckRpcmVjdGlvbnNbZmlyc3REaXJlY3Rpb25dW3NlY29uZERpcmVjdGlvbl07XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogc2lkZURpcmVjdGlvbnNbZmlyc3REaXJlY3Rpb25dIH07XG4gICAgfVxufVxudmFyIG9wZW5pbmdCcmFja2V0UmVnRXggPSAvXFxzKlxcKFxccyovZ3k7XG52YXIgY2xvc2luZ0JyYWNrZXRSZWdFeCA9IC9cXHMqXFwpXFxzKi9neTtcbnZhciBjbG9zaW5nQnJhY2tldE9yQ29tbWFSZWdFeCA9IC9cXHMqKFxcKXwsKVxccyovZ3k7XG5mdW5jdGlvbiBwYXJzZUFyZ3VtZW50c0xpc3QodGV4dCwgc3RhcnQsIGFyZ3VtZW50KSB7XG4gICAgb3BlbmluZ0JyYWNrZXRSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgb3BlbmluZ0JyYWNrZXQgPSBvcGVuaW5nQnJhY2tldFJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFvcGVuaW5nQnJhY2tldCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IG9wZW5pbmdCcmFja2V0UmVnRXgubGFzdEluZGV4O1xuICAgIHZhciB2YWx1ZSA9IFtdO1xuICAgIGNsb3NpbmdCcmFja2V0UmVnRXgubGFzdEluZGV4ID0gZW5kO1xuICAgIHZhciBjbG9zaW5nQnJhY2tldCA9IGNsb3NpbmdCcmFja2V0UmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoY2xvc2luZ0JyYWNrZXQpIHtcbiAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG4gICAgfVxuICAgIGZvciAodmFyIGluZGV4XzEgPSAwOyB0cnVlOyBpbmRleF8xKyspIHtcbiAgICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50KHRleHQsIGVuZCwgaW5kZXhfMSk7XG4gICAgICAgIGlmICghYXJnKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbmQgPSBhcmcuZW5kO1xuICAgICAgICB2YWx1ZS5wdXNoKGFyZyk7XG4gICAgICAgIGNsb3NpbmdCcmFja2V0T3JDb21tYVJlZ0V4Lmxhc3RJbmRleCA9IGVuZDtcbiAgICAgICAgdmFyIGNsb3NpbmdCcmFja2V0T3JDb21tYSA9IGNsb3NpbmdCcmFja2V0T3JDb21tYVJlZ0V4LmV4ZWModGV4dCk7XG4gICAgICAgIGlmIChjbG9zaW5nQnJhY2tldE9yQ29tbWEpIHtcbiAgICAgICAgICAgIGVuZCA9IGNsb3NpbmdCcmFja2V0T3JDb21tYVJlZ0V4Lmxhc3RJbmRleDtcbiAgICAgICAgICAgIGlmIChjbG9zaW5nQnJhY2tldE9yQ29tbWFbMV0gPT09IFwiLFwiKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjbG9zaW5nQnJhY2tldE9yQ29tbWFbMV0gPT09IFwiKVwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHBhcnNlQ29sb3JTdG9wKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgdmFyIGNvbG9yID0gcGFyc2VDb2xvcih0ZXh0LCBzdGFydCk7XG4gICAgaWYgKCFjb2xvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IGNvbG9yLmVuZDtcbiAgICB2YXIgb2Zmc2V0ID0gcGFyc2VQZXJjZW50YWdlT3JMZW5ndGgodGV4dCwgZW5kKTtcbiAgICBpZiAob2Zmc2V0KSB7XG4gICAgICAgIGVuZCA9IG9mZnNldC5lbmQ7XG4gICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IGFyZ2I6IGNvbG9yLnZhbHVlLCBvZmZzZXQ6IG9mZnNldC52YWx1ZSB9IH07XG4gICAgfVxuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IGFyZ2I6IGNvbG9yLnZhbHVlIH0gfTtcbn1cbmV4cG9ydHMucGFyc2VDb2xvclN0b3AgPSBwYXJzZUNvbG9yU3RvcDtcbnZhciBsaW5lYXJHcmFkaWVudFN0YXJ0UmVnRXggPSAvXFxzKmxpbmVhci1ncmFkaWVudFxccyovZ3k7XG5mdW5jdGlvbiBwYXJzZUxpbmVhckdyYWRpZW50KHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgbGluZWFyR3JhZGllbnRTdGFydFJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciBsZ3MgPSBsaW5lYXJHcmFkaWVudFN0YXJ0UmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIWxncykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IGxpbmVhckdyYWRpZW50U3RhcnRSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIGFuZ2xlID0gTWF0aC5QSTtcbiAgICB2YXIgY29sb3JzID0gW107XG4gICAgdmFyIHBhcnNlZEFyZ3MgPSBwYXJzZUFyZ3VtZW50c0xpc3QodGV4dCwgZW5kLCBmdW5jdGlvbiAodGV4dCwgc3RhcnQsIGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgdmFyIGFuZ2xlQXJnID0gcGFyc2VBbmdsZSh0ZXh0LCBzdGFydCkgfHwgcGFyc2VEaXJlY3Rpb24odGV4dCwgc3RhcnQpO1xuICAgICAgICAgICAgaWYgKGFuZ2xlQXJnKSB7XG4gICAgICAgICAgICAgICAgYW5nbGUgPSBhbmdsZUFyZy52YWx1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYW5nbGVBcmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbG9yU3RvcCA9IHBhcnNlQ29sb3JTdG9wKHRleHQsIHN0YXJ0KTtcbiAgICAgICAgaWYgKGNvbG9yU3RvcCkge1xuICAgICAgICAgICAgY29sb3JzLnB1c2goY29sb3JTdG9wLnZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBjb2xvclN0b3A7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSk7XG4gICAgaWYgKCFwYXJzZWRBcmdzKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBlbmQgPSBwYXJzZWRBcmdzLmVuZDtcbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyBhbmdsZTogYW5nbGUsIGNvbG9yczogY29sb3JzIH0gfTtcbn1cbmV4cG9ydHMucGFyc2VMaW5lYXJHcmFkaWVudCA9IHBhcnNlTGluZWFyR3JhZGllbnQ7XG52YXIgc2xhc2hSZWdFeCA9IC9cXHMqKFxcLylcXHMqL2d5O1xuZnVuY3Rpb24gcGFyc2VTbGFzaCh0ZXh0LCBzdGFydCkge1xuICAgIHNsYXNoUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHNsYXNoID0gc2xhc2hSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghc2xhc2gpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBzbGFzaFJlZ0V4Lmxhc3RJbmRleDtcbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogXCIvXCIgfTtcbn1cbmZ1bmN0aW9uIHBhcnNlQmFja2dyb3VuZCh0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHZhciB2YWx1ZSA9IHt9O1xuICAgIHZhciBlbmQgPSBzdGFydDtcbiAgICB3aGlsZSAoZW5kIDwgdGV4dC5sZW5ndGgpIHtcbiAgICAgICAgdmFyIGtleXdvcmQgPSBwYXJzZUtleXdvcmQodGV4dCwgZW5kKTtcbiAgICAgICAgdmFyIGNvbG9yID0gcGFyc2VDb2xvcih0ZXh0LCBlbmQsIGtleXdvcmQpO1xuICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgIHZhbHVlLmNvbG9yID0gY29sb3IudmFsdWU7XG4gICAgICAgICAgICBlbmQgPSBjb2xvci5lbmQ7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVwZWF0ID0gcGFyc2VSZXBlYXQodGV4dCwgZW5kLCBrZXl3b3JkKTtcbiAgICAgICAgaWYgKHJlcGVhdCkge1xuICAgICAgICAgICAgdmFsdWUucmVwZWF0ID0gcmVwZWF0LnZhbHVlO1xuICAgICAgICAgICAgZW5kID0gcmVwZWF0LmVuZDtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwb3NpdGlvbiA9IHBhcnNlQmFja2dyb3VuZFBvc2l0aW9uKHRleHQsIGVuZCwga2V5d29yZCk7XG4gICAgICAgIGlmIChwb3NpdGlvbikge1xuICAgICAgICAgICAgcG9zaXRpb24udmFsdWUudGV4dCA9IHRleHQuc3Vic3RyaW5nKHBvc2l0aW9uLnN0YXJ0LCBwb3NpdGlvbi5lbmQpO1xuICAgICAgICAgICAgdmFsdWUucG9zaXRpb24gPSBwb3NpdGlvbi52YWx1ZTtcbiAgICAgICAgICAgIGVuZCA9IHBvc2l0aW9uLmVuZDtcbiAgICAgICAgICAgIHZhciBzbGFzaCA9IHBhcnNlU2xhc2godGV4dCwgZW5kKTtcbiAgICAgICAgICAgIGlmIChzbGFzaCkge1xuICAgICAgICAgICAgICAgIGVuZCA9IHNsYXNoLmVuZDtcbiAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IHBhcnNlQmFja2dyb3VuZFNpemUodGV4dCwgZW5kKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhbHVlLnNpemUgPSBzaXplLnZhbHVlO1xuICAgICAgICAgICAgICAgIGVuZCA9IHNpemUuZW5kO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHVybCA9IHBhcnNlVVJMKHRleHQsIGVuZCk7XG4gICAgICAgIGlmICh1cmwpIHtcbiAgICAgICAgICAgIHZhbHVlLmltYWdlID0gdXJsLnZhbHVlO1xuICAgICAgICAgICAgZW5kID0gdXJsLmVuZDtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBncmFkaWVudCA9IHBhcnNlTGluZWFyR3JhZGllbnQodGV4dCwgZW5kKTtcbiAgICAgICAgaWYgKGdyYWRpZW50KSB7XG4gICAgICAgICAgICB2YWx1ZS5pbWFnZSA9IGdyYWRpZW50LnZhbHVlO1xuICAgICAgICAgICAgZW5kID0gZ3JhZGllbnQuZW5kO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xufVxuZXhwb3J0cy5wYXJzZUJhY2tncm91bmQgPSBwYXJzZUJhY2tncm91bmQ7XG52YXIgdW5pdmVyc2FsU2VsZWN0b3JSZWdFeCA9IC9cXCovZ3k7XG5mdW5jdGlvbiBwYXJzZVVuaXZlcnNhbFNlbGVjdG9yKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgdW5pdmVyc2FsU2VsZWN0b3JSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gdW5pdmVyc2FsU2VsZWN0b3JSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gdW5pdmVyc2FsU2VsZWN0b3JSZWdFeC5sYXN0SW5kZXg7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgdHlwZTogXCIqXCIgfSB9O1xufVxuZXhwb3J0cy5wYXJzZVVuaXZlcnNhbFNlbGVjdG9yID0gcGFyc2VVbml2ZXJzYWxTZWxlY3RvcjtcbnZhciBzaW1wbGVJZGVudGlmaWVyU2VsZWN0b3JSZWdFeCA9IC8oI3xcXC58OnxcXGIpKFtfLVxcd11bXy1cXHdcXGRcXFxcL10qKS9neTtcbmZ1bmN0aW9uIHBhcnNlU2ltcGxlSWRlbnRpZmllclNlbGVjdG9yKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgc2ltcGxlSWRlbnRpZmllclNlbGVjdG9yUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IHNpbXBsZUlkZW50aWZpZXJTZWxlY3RvclJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBzaW1wbGVJZGVudGlmaWVyU2VsZWN0b3JSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHR5cGUgPSByZXN1bHRbMV07XG4gICAgdmFyIGlkZW50aWZpZXIgPSByZXN1bHRbMl0ucmVwbGFjZSgvXFxcXC9nLCBcIlwiKTtcbiAgICB2YXIgdmFsdWUgPSB7IHR5cGU6IHR5cGUsIGlkZW50aWZpZXI6IGlkZW50aWZpZXIgfTtcbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbn1cbmV4cG9ydHMucGFyc2VTaW1wbGVJZGVudGlmaWVyU2VsZWN0b3IgPSBwYXJzZVNpbXBsZUlkZW50aWZpZXJTZWxlY3RvcjtcbnZhciBhdHRyaWJ1dGVTZWxlY3RvclJlZ0V4ID0gL1xcW1xccyooW18tXFx3XVtfLVxcd1xcZF0qKVxccyooPzooPXxcXF49fFxcJD18XFwqPXxcXH49fFxcfD0pXFxzKig/OihbXy1cXHddW18tXFx3XFxkXSopfFwiKCg/OlteXFxcXFwiXXxcXFxcKD86XCJ8bnxyfGZ8XFxcXHwwLTlhLWYpKSopXCJ8JygoPzpbXlxcXFwnXXxcXFxcKD86J3xufHJ8ZnxcXFxcfDAtOWEtZikpKiknKVxccyopP1xcXS9neTtcbmZ1bmN0aW9uIHBhcnNlQXR0cmlidXRlU2VsZWN0b3IodGV4dCwgc3RhcnQpIHtcbiAgICBhdHRyaWJ1dGVTZWxlY3RvclJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSBhdHRyaWJ1dGVTZWxlY3RvclJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBhdHRyaWJ1dGVTZWxlY3RvclJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgcHJvcGVydHkgPSByZXN1bHRbMV07XG4gICAgaWYgKHJlc3VsdFsyXSkge1xuICAgICAgICB2YXIgdGVzdF8xID0gcmVzdWx0WzJdO1xuICAgICAgICB2YXIgdmFsdWUgPSByZXN1bHRbM10gfHwgcmVzdWx0WzRdIHx8IHJlc3VsdFs1XTtcbiAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgdHlwZTogXCJbXVwiLCBwcm9wZXJ0eTogcHJvcGVydHksIHRlc3Q6IHRlc3RfMSwgdmFsdWU6IHZhbHVlIH0gfTtcbiAgICB9XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgdHlwZTogXCJbXVwiLCBwcm9wZXJ0eTogcHJvcGVydHkgfSB9O1xufVxuZXhwb3J0cy5wYXJzZUF0dHJpYnV0ZVNlbGVjdG9yID0gcGFyc2VBdHRyaWJ1dGVTZWxlY3RvcjtcbmZ1bmN0aW9uIHBhcnNlU2ltcGxlU2VsZWN0b3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICByZXR1cm4gcGFyc2VVbml2ZXJzYWxTZWxlY3Rvcih0ZXh0LCBzdGFydCkgfHxcbiAgICAgICAgcGFyc2VTaW1wbGVJZGVudGlmaWVyU2VsZWN0b3IodGV4dCwgc3RhcnQpIHx8XG4gICAgICAgIHBhcnNlQXR0cmlidXRlU2VsZWN0b3IodGV4dCwgc3RhcnQpO1xufVxuZXhwb3J0cy5wYXJzZVNpbXBsZVNlbGVjdG9yID0gcGFyc2VTaW1wbGVTZWxlY3RvcjtcbmZ1bmN0aW9uIHBhcnNlU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSh0ZXh0LCBzdGFydCkge1xuICAgIHZhciBzaW1wbGVTZWxlY3RvciA9IHBhcnNlU2ltcGxlU2VsZWN0b3IodGV4dCwgc3RhcnQpO1xuICAgIGlmICghc2ltcGxlU2VsZWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBzaW1wbGVTZWxlY3Rvci5lbmQ7XG4gICAgdmFyIHZhbHVlID0gW107XG4gICAgd2hpbGUgKHNpbXBsZVNlbGVjdG9yKSB7XG4gICAgICAgIHZhbHVlLnB1c2goc2ltcGxlU2VsZWN0b3IudmFsdWUpO1xuICAgICAgICBlbmQgPSBzaW1wbGVTZWxlY3Rvci5lbmQ7XG4gICAgICAgIHNpbXBsZVNlbGVjdG9yID0gcGFyc2VTaW1wbGVTZWxlY3Rvcih0ZXh0LCBlbmQpO1xuICAgIH1cbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbn1cbmV4cG9ydHMucGFyc2VTaW1wbGVTZWxlY3RvclNlcXVlbmNlID0gcGFyc2VTaW1wbGVTZWxlY3RvclNlcXVlbmNlO1xudmFyIGNvbWJpbmF0b3JSZWdFeCA9IC9cXHMqKFxcK3x+fD4pP1xccyovZ3k7XG5mdW5jdGlvbiBwYXJzZUNvbWJpbmF0b3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBjb21iaW5hdG9yUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IGNvbWJpbmF0b3JSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gY29tYmluYXRvclJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgdmFsdWUgPSByZXN1bHRbMV0gfHwgXCIgXCI7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG5leHBvcnRzLnBhcnNlQ29tYmluYXRvciA9IHBhcnNlQ29tYmluYXRvcjtcbnZhciB3aGl0ZVNwYWNlUmVnRXggPSAvXFxzKi9neTtcbmZ1bmN0aW9uIHBhcnNlU2VsZWN0b3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICB2YXIgZW5kID0gc3RhcnQ7XG4gICAgd2hpdGVTcGFjZVJlZ0V4Lmxhc3RJbmRleCA9IGVuZDtcbiAgICB2YXIgbGVhZGluZ1doaXRlU3BhY2UgPSB3aGl0ZVNwYWNlUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAobGVhZGluZ1doaXRlU3BhY2UpIHtcbiAgICAgICAgZW5kID0gd2hpdGVTcGFjZVJlZ0V4Lmxhc3RJbmRleDtcbiAgICB9XG4gICAgdmFyIHZhbHVlID0gW107XG4gICAgdmFyIGNvbWJpbmF0b3I7XG4gICAgdmFyIGV4cGVjdFNpbXBsZVNlbGVjdG9yID0gdHJ1ZTtcbiAgICB2YXIgcGFpcjtcbiAgICBkbyB7XG4gICAgICAgIHZhciBzaW1wbGVTZWxlY3RvclNlcXVlbmNlID0gcGFyc2VTaW1wbGVTZWxlY3RvclNlcXVlbmNlKHRleHQsIGVuZCk7XG4gICAgICAgIGlmICghc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSkge1xuICAgICAgICAgICAgaWYgKGV4cGVjdFNpbXBsZVNlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbmQgPSBzaW1wbGVTZWxlY3RvclNlcXVlbmNlLmVuZDtcbiAgICAgICAgaWYgKGNvbWJpbmF0b3IpIHtcbiAgICAgICAgICAgIHBhaXJbMV0gPSBjb21iaW5hdG9yLnZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHBhaXIgPSBbc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZS52YWx1ZSwgdW5kZWZpbmVkXTtcbiAgICAgICAgdmFsdWUucHVzaChwYWlyKTtcbiAgICAgICAgY29tYmluYXRvciA9IHBhcnNlQ29tYmluYXRvcih0ZXh0LCBlbmQpO1xuICAgICAgICBpZiAoY29tYmluYXRvcikge1xuICAgICAgICAgICAgZW5kID0gY29tYmluYXRvci5lbmQ7XG4gICAgICAgIH1cbiAgICAgICAgZXhwZWN0U2ltcGxlU2VsZWN0b3IgPSBjb21iaW5hdG9yICYmIGNvbWJpbmF0b3IudmFsdWUgIT09IFwiIFwiO1xuICAgIH0gd2hpbGUgKGNvbWJpbmF0b3IpO1xuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xufVxuZXhwb3J0cy5wYXJzZVNlbGVjdG9yID0gcGFyc2VTZWxlY3RvcjtcbnZhciB3aGl0ZXNwYWNlUmVnRXggPSAvW1xcc1xcdFxcblxcclxcZl0qL2d5bTtcbnZhciBzaW5nbGVRdW90ZVN0cmluZ1JlZ0V4ID0gLycoKD86W15cXG5cXHJcXGZcXCddfFxcXFwoPzpcXCR8XFxufFswLTlhLWZBLUZdezEsNn1cXHM/KSkqKSg6Pyd8JCkvZ3ltO1xudmFyIGRvdWJsZVF1b3RlU3RyaW5nUmVnRXggPSAvXCIoKD86W15cXG5cXHJcXGZcXFwiXXxcXFxcKD86XFwkfFxcbnxbMC05YS1mQS1GXXsxLDZ9XFxzPykpKikoOj9cInwkKS9neW07XG52YXIgY29tbWVudFJlZ0V4ID0gLyhcXC9cXCooPzpbXlxcKl18XFwqW15cXC9dKSpcXCpcXC8pL2d5bTtcbnZhciBudW1iZXJSZWdFeCA9IC9bXFwrXFwtXT8oPzpcXGQrXFwuXFxkK3xcXGQrfFxcLlxcZCspKD86W2VFXVtcXCtcXC1dP1xcZCspPy9neW07XG52YXIgbmFtZVJlZ0V4ID0gLy0/KD86KD86W2EtekEtWl9dfFteXFx4MDAtXFx4N0ZdfFxcXFwoPzpcXCR8XFxufFswLTlhLWZBLUZdezEsNn1cXHM/KSkoPzpbYS16QS1aXzAtOVxcLV0qfFxcXFwoPzpcXCR8XFxufFswLTlhLWZBLUZdezEsNn1cXHM/KSkqKS9neW07XG52YXIgQ1NTM1BhcnNlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ1NTM1BhcnNlcih0ZXh0KSB7XG4gICAgICAgIHRoaXMudGV4dCA9IHRleHQ7XG4gICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPSAwO1xuICAgIH1cbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS50b2tlbml6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VucyA9IFtdO1xuICAgICAgICB2YXIgaW5wdXRUb2tlbjtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgaW5wdXRUb2tlbiA9IHRoaXMuY29uc3VtZUFUb2tlbigpO1xuICAgICAgICAgICAgdG9rZW5zLnB1c2goaW5wdXRUb2tlbik7XG4gICAgICAgIH0gd2hpbGUgKGlucHV0VG9rZW4pO1xuICAgICAgICByZXR1cm4gdG9rZW5zO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVjb25zdW1lZElucHV0VG9rZW4pIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLnJlY29uc3VtZWRJbnB1dFRva2VuO1xuICAgICAgICAgICAgdGhpcy5yZWNvbnN1bWVkSW5wdXRUb2tlbiA9IG51bGw7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIHZhciBjaGFyID0gdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdO1xuICAgICAgICBzd2l0Y2ggKGNoYXIpIHtcbiAgICAgICAgICAgIGNhc2UgXCJcXFwiXCI6IHJldHVybiB0aGlzLmNvbnN1bWVBU3RyaW5nVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCInXCI6IHJldHVybiB0aGlzLmNvbnN1bWVBU3RyaW5nVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCIoXCI6XG4gICAgICAgICAgICBjYXNlIFwiKVwiOlxuICAgICAgICAgICAgY2FzZSBcIixcIjpcbiAgICAgICAgICAgIGNhc2UgXCI6XCI6XG4gICAgICAgICAgICBjYXNlIFwiO1wiOlxuICAgICAgICAgICAgY2FzZSBcIltcIjpcbiAgICAgICAgICAgIGNhc2UgXCJdXCI6XG4gICAgICAgICAgICBjYXNlIFwie1wiOlxuICAgICAgICAgICAgY2FzZSBcIn1cIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4Kys7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoYXI7XG4gICAgICAgICAgICBjYXNlIFwiI1wiOiByZXR1cm4gdGhpcy5jb25zdW1lQUhhc2hUb2tlbigpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiIFwiOlxuICAgICAgICAgICAgY2FzZSBcIlxcdFwiOlxuICAgICAgICAgICAgY2FzZSBcIlxcblwiOlxuICAgICAgICAgICAgY2FzZSBcIlxcclwiOlxuICAgICAgICAgICAgY2FzZSBcIlxcZlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBV2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgY2FzZSBcIkBcIjogcmV0dXJuIHRoaXMuY29uc3VtZUF0S2V5d29yZCgpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiXFxcXFwiOiByZXR1cm4gdGhpcy5jb25zdW1lQW5JZGVudExpa2VUb2tlbigpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiMFwiOlxuICAgICAgICAgICAgY2FzZSBcIjFcIjpcbiAgICAgICAgICAgIGNhc2UgXCIyXCI6XG4gICAgICAgICAgICBjYXNlIFwiM1wiOlxuICAgICAgICAgICAgY2FzZSBcIjRcIjpcbiAgICAgICAgICAgIGNhc2UgXCI1XCI6XG4gICAgICAgICAgICBjYXNlIFwiNlwiOlxuICAgICAgICAgICAgY2FzZSBcIjdcIjpcbiAgICAgICAgICAgIGNhc2UgXCI4XCI6XG4gICAgICAgICAgICBjYXNlIFwiOVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBTnVtZXJpY1Rva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwidVwiOlxuICAgICAgICAgICAgY2FzZSBcIlVcIjpcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggKyAxXSA9PT0gXCIrXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXJkQ2hhciA9IHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ICsgMl07XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlyZENoYXIgPj0gXCIwXCIgJiYgdGhpcmRDaGFyIDw9IFwiOVwiIHx8IHRoaXJkQ2hhciA9PT0gXCI/XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuaWNvZGUgdG9rZW5zIG5vdCBzdXBwb3J0ZWQhXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBbklkZW50TGlrZVRva2VuKCkgfHwgdGhpcy5jb25zdW1lQURlbGltVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCIkXCI6XG4gICAgICAgICAgICBjYXNlIFwiKlwiOlxuICAgICAgICAgICAgY2FzZSBcIl5cIjpcbiAgICAgICAgICAgIGNhc2UgXCJ8XCI6XG4gICAgICAgICAgICBjYXNlIFwiflwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBTWF0Y2hUb2tlbigpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiLVwiOiByZXR1cm4gdGhpcy5jb25zdW1lQU51bWVyaWNUb2tlbigpIHx8IHRoaXMuY29uc3VtZUFuSWRlbnRMaWtlVG9rZW4oKSB8fCB0aGlzLmNvbnN1bWVDREMoKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcIitcIjpcbiAgICAgICAgICAgIGNhc2UgXCIuXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3VtZUFOdW1lcmljVG9rZW4oKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcIi9cIjogcmV0dXJuIHRoaXMuY29uc3VtZUFDb21tZW50KCkgfHwgdGhpcy5jb25zdW1lQURlbGltVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCI8XCI6IHJldHVybiB0aGlzLmNvbnN1bWVDRE8oKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICAgICAgY2FzZSB1bmRlZmluZWQ6IHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gdGhpcy5jb25zdW1lQW5JZGVudExpa2VUb2tlbigpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBRGVsaW1Ub2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgdHlwZTogMiwgdGV4dDogdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrK10gfTtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBV2hpdGVzcGFjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgd2hpdGVzcGFjZVJlZ0V4Lmxhc3RJbmRleCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgIHdoaXRlc3BhY2VSZWdFeC5leGVjKHRoaXMudGV4dCk7XG4gICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPSB3aGl0ZXNwYWNlUmVnRXgubGFzdEluZGV4O1xuICAgICAgICByZXR1cm4gXCIgXCI7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQUhhc2hUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICB2YXIgaGFzaE5hbWUgPSB0aGlzLmNvbnN1bWVBTmFtZSgpO1xuICAgICAgICBpZiAoaGFzaE5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IDEyLCB0ZXh0OiBcIiNcIiArIGhhc2hOYW1lLnRleHQgfTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4LS07XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUNETyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudGV4dC5zdWJzdHIodGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCwgNCkgPT09IFwiPCEtLVwiKSB7XG4gICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ICs9IDQ7XG4gICAgICAgICAgICByZXR1cm4gXCI8IS0tXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQ0RDID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50ZXh0LnN1YnN0cih0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4LCAzKSA9PT0gXCItLT5cIikge1xuICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCArPSAzO1xuICAgICAgICAgICAgcmV0dXJuIFwiLS0+XCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQU1hdGNoVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCArIDFdID09PSBcIj1cIikge1xuICAgICAgICAgICAgdmFyIHRva2VuID0gdGhpcy50ZXh0LnN1YnN0cih0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4LCAyKTtcbiAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggKz0gMjtcbiAgICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBTnVtZXJpY1Rva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBudW1iZXJSZWdFeC5sYXN0SW5kZXggPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICB2YXIgcmVzdWx0ID0gbnVtYmVyUmVnRXguZXhlYyh0aGlzLnRleHQpO1xuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA9IG51bWJlclJlZ0V4Lmxhc3RJbmRleDtcbiAgICAgICAgaWYgKHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4XSA9PT0gXCIlXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IDQsIHRleHQ6IHJlc3VsdFswXSB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYW1lID0gdGhpcy5jb25zdW1lQU5hbWUoKTtcbiAgICAgICAgaWYgKG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IDUsIHRleHQ6IHJlc3VsdFswXSArIG5hbWUudGV4dCB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHR5cGU6IDMsIHRleHQ6IHJlc3VsdFswXSB9O1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFuSWRlbnRMaWtlVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYW1lID0gdGhpcy5jb25zdW1lQU5hbWUoKTtcbiAgICAgICAgaWYgKCFuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdID09PSBcIihcIikge1xuICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICAgICAgaWYgKG5hbWUudGV4dC50b0xvd2VyQ2FzZSgpID09PSBcInVybFwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3VtZUFVUkxUb2tlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogOCwgbmFtZTogbmFtZS50ZXh0LCB0ZXh0OiBuYW1lLnRleHQgKyBcIihcIiB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuYW1lO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFTdHJpbmdUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNoYXIgPSB0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF07XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIGlmIChjaGFyID09PSBcIidcIikge1xuICAgICAgICAgICAgc2luZ2xlUXVvdGVTdHJpbmdSZWdFeC5sYXN0SW5kZXggPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICAgICAgcmVzdWx0ID0gc2luZ2xlUXVvdGVTdHJpbmdSZWdFeC5leGVjKHRoaXMudGV4dCk7XG4gICAgICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA9IHNpbmdsZVF1b3RlU3RyaW5nUmVnRXgubGFzdEluZGV4O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNoYXIgPT09IFwiXFxcIlwiKSB7XG4gICAgICAgICAgICBkb3VibGVRdW90ZVN0cmluZ1JlZ0V4Lmxhc3RJbmRleCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgICAgICByZXN1bHQgPSBkb3VibGVRdW90ZVN0cmluZ1JlZ0V4LmV4ZWModGhpcy50ZXh0KTtcbiAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID0gZG91YmxlUXVvdGVTdHJpbmdSZWdFeC5sYXN0SW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgdHlwZTogMSwgdGV4dDogcmVzdWx0WzBdIH07XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQVVSTFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4IC0gMyAtIDE7XG4gICAgICAgIHZhciB1cmxUb2tlbiA9IHsgdHlwZTogNywgdGV4dDogdW5kZWZpbmVkIH07XG4gICAgICAgIHRoaXMuY29uc3VtZUFXaGl0ZXNwYWNlKCk7XG4gICAgICAgIGlmICh0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID49IHRoaXMudGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB1cmxUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV4dElucHV0Q29kZVBvaW50ID0gdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdO1xuICAgICAgICBpZiAobmV4dElucHV0Q29kZVBvaW50ID09PSBcIlxcXCJcIiB8fCBuZXh0SW5wdXRDb2RlUG9pbnQgPT09IFwiJ1wiKSB7XG4gICAgICAgICAgICB2YXIgc3RyaW5nVG9rZW4gPSB0aGlzLmNvbnN1bWVBU3RyaW5nVG9rZW4oKTtcbiAgICAgICAgICAgIHVybFRva2VuLnRleHQgPSBzdHJpbmdUb2tlbi50ZXh0O1xuICAgICAgICAgICAgdGhpcy5jb25zdW1lQVdoaXRlc3BhY2UoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF0gPT09IFwiKVwiIHx8IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPj0gdGhpcy50ZXh0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrKztcbiAgICAgICAgICAgICAgICB2YXIgZW5kID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgICAgICAgICB1cmxUb2tlbi50ZXh0ID0gdGhpcy50ZXh0LnN1YnN0cmluZyhzdGFydCwgZW5kKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXJsVG9rZW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAodGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA8IHRoaXMudGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBjaGFyID0gdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrK107XG4gICAgICAgICAgICBzd2l0Y2ggKGNoYXIpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiKVwiOiByZXR1cm4gdXJsVG9rZW47XG4gICAgICAgICAgICAgICAgY2FzZSBcIiBcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwiXFx0XCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcIlxcblwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJcXHJcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwiXFxmXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uc3VtZUFXaGl0ZXNwYWNlKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF0gPT09IFwiKVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4Kys7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXJsVG9rZW47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgXCJcXFwiXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcIlxcJ1wiOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICBjYXNlIFwiXFxcXFwiOlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFc2NhcGluZyBub3QgeWV0IHN1cHBvcnRlZCFcIik7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdXJsVG9rZW4udGV4dCArPSBjaGFyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1cmxUb2tlbjtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBTmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbmFtZVJlZ0V4Lmxhc3RJbmRleCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgIHZhciByZXN1bHQgPSBuYW1lUmVnRXguZXhlYyh0aGlzLnRleHQpO1xuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA9IG5hbWVSZWdFeC5sYXN0SW5kZXg7XG4gICAgICAgIHJldHVybiB7IHR5cGU6IDYsIHRleHQ6IHJlc3VsdFswXSB9O1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUF0S2V5d29yZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICB2YXIgbmFtZSA9IHRoaXMuY29uc3VtZUFOYW1lKCk7XG4gICAgICAgIGlmIChuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4geyB0eXBlOiAxMSwgdGV4dDogbmFtZS50ZXh0IH07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleC0tO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBQ29tbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ICsgMV0gPT09IFwiKlwiKSB7XG4gICAgICAgICAgICBjb21tZW50UmVnRXgubGFzdEluZGV4ID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBjb21tZW50UmVnRXguZXhlYyh0aGlzLnRleHQpO1xuICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPSBjb21tZW50UmVnRXgubGFzdEluZGV4O1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3VtZUFUb2tlbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUucmVjb25zdW1lVGhlQ3VycmVudElucHV0VG9rZW4gPSBmdW5jdGlvbiAoY3VycmVudElucHV0VG9rZW4pIHtcbiAgICAgICAgdGhpcy5yZWNvbnN1bWVkSW5wdXRUb2tlbiA9IGN1cnJlbnRJbnB1dFRva2VuO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUucGFyc2VBU3R5bGVzaGVldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy50b3BMZXZlbEZsYWcgPSB0cnVlO1xuICAgICAgICB2YXIgc3R5bGVzaGVldCA9IHtcbiAgICAgICAgICAgIHJ1bGVzOiB0aGlzLmNvbnN1bWVBTGlzdE9mUnVsZXMoKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gc3R5bGVzaGVldDtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBTGlzdE9mUnVsZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBydWxlcyA9IFtdO1xuICAgICAgICB2YXIgaW5wdXRUb2tlbjtcbiAgICAgICAgd2hpbGUgKGlucHV0VG9rZW4gPSB0aGlzLmNvbnN1bWVBVG9rZW4oKSkge1xuICAgICAgICAgICAgc3dpdGNoIChpbnB1dFRva2VuKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIiBcIjogY29udGludWU7XG4gICAgICAgICAgICAgICAgY2FzZSBcIjwhLS1cIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwiLS0+XCI6XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRvcExldmVsRmxhZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNvbnN1bWVUaGVDdXJyZW50SW5wdXRUb2tlbihpbnB1dFRva2VuKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF0UnVsZSA9IHRoaXMuY29uc3VtZUFuQXRSdWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhdFJ1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGVzLnB1c2goYXRSdWxlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnB1dFRva2VuLnR5cGUgPT09IDExKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWNvbnN1bWVUaGVDdXJyZW50SW5wdXRUb2tlbihpbnB1dFRva2VuKTtcbiAgICAgICAgICAgICAgICB2YXIgYXRSdWxlID0gdGhpcy5jb25zdW1lQW5BdFJ1bGUoKTtcbiAgICAgICAgICAgICAgICBpZiAoYXRSdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJ1bGVzLnB1c2goYXRSdWxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlY29uc3VtZVRoZUN1cnJlbnRJbnB1dFRva2VuKGlucHV0VG9rZW4pO1xuICAgICAgICAgICAgdmFyIHF1YWxpZmllZFJ1bGUgPSB0aGlzLmNvbnN1bWVBUXVhbGlmaWVkUnVsZSgpO1xuICAgICAgICAgICAgaWYgKHF1YWxpZmllZFJ1bGUpIHtcbiAgICAgICAgICAgICAgICBydWxlcy5wdXNoKHF1YWxpZmllZFJ1bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBydWxlcztcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBbkF0UnVsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlucHV0VG9rZW4gPSB0aGlzLmNvbnN1bWVBVG9rZW4oKTtcbiAgICAgICAgdmFyIGF0UnVsZSA9IHtcbiAgICAgICAgICAgIHR5cGU6IFwiYXQtcnVsZVwiLFxuICAgICAgICAgICAgbmFtZTogaW5wdXRUb2tlbi50ZXh0LFxuICAgICAgICAgICAgcHJlbHVkZTogW10sXG4gICAgICAgICAgICBibG9jazogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICAgIHdoaWxlIChpbnB1dFRva2VuID0gdGhpcy5jb25zdW1lQVRva2VuKCkpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dFRva2VuID09PSBcIjtcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiBhdFJ1bGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpbnB1dFRva2VuID09PSBcIntcIikge1xuICAgICAgICAgICAgICAgIGF0UnVsZS5ibG9jayA9IHRoaXMuY29uc3VtZUFTaW1wbGVCbG9jayhpbnB1dFRva2VuKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXRSdWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaW5wdXRUb2tlbi50eXBlID09PSA5ICYmIGlucHV0VG9rZW4uYXNzb2NpYXRlZFRva2VuID09PSBcIntcIikge1xuICAgICAgICAgICAgICAgIGF0UnVsZS5ibG9jayA9IGlucHV0VG9rZW47XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF0UnVsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVjb25zdW1lVGhlQ3VycmVudElucHV0VG9rZW4oaW5wdXRUb2tlbik7XG4gICAgICAgICAgICB2YXIgY29tcG9uZW50ID0gdGhpcy5jb25zdW1lQUNvbXBvbmVudFZhbHVlKCk7XG4gICAgICAgICAgICBpZiAoY29tcG9uZW50KSB7XG4gICAgICAgICAgICAgICAgYXRSdWxlLnByZWx1ZGUucHVzaChjb21wb25lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhdFJ1bGU7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQVF1YWxpZmllZFJ1bGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBxdWFsaWZpZWRSdWxlID0ge1xuICAgICAgICAgICAgdHlwZTogXCJxdWFsaWZpZWQtcnVsZVwiLFxuICAgICAgICAgICAgcHJlbHVkZTogW10sXG4gICAgICAgICAgICBibG9jazogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICAgIHZhciBpbnB1dFRva2VuO1xuICAgICAgICB3aGlsZSAoaW5wdXRUb2tlbiA9IHRoaXMuY29uc3VtZUFUb2tlbigpKSB7XG4gICAgICAgICAgICBpZiAoaW5wdXRUb2tlbiA9PT0gXCJ7XCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgYmxvY2sgPSB0aGlzLmNvbnN1bWVBU2ltcGxlQmxvY2soaW5wdXRUb2tlbik7XG4gICAgICAgICAgICAgICAgcXVhbGlmaWVkUnVsZS5ibG9jayA9IGJsb2NrO1xuICAgICAgICAgICAgICAgIHJldHVybiBxdWFsaWZpZWRSdWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaW5wdXRUb2tlbi50eXBlID09PSA5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHNpbXBsZUJsb2NrID0gaW5wdXRUb2tlbjtcbiAgICAgICAgICAgICAgICBpZiAoc2ltcGxlQmxvY2suYXNzb2NpYXRlZFRva2VuID09PSBcIntcIikge1xuICAgICAgICAgICAgICAgICAgICBxdWFsaWZpZWRSdWxlLmJsb2NrID0gc2ltcGxlQmxvY2s7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBxdWFsaWZpZWRSdWxlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVjb25zdW1lVGhlQ3VycmVudElucHV0VG9rZW4oaW5wdXRUb2tlbik7XG4gICAgICAgICAgICB2YXIgY29tcG9uZW50VmFsdWUgPSB0aGlzLmNvbnN1bWVBQ29tcG9uZW50VmFsdWUoKTtcbiAgICAgICAgICAgIGlmIChjb21wb25lbnRWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHF1YWxpZmllZFJ1bGUucHJlbHVkZS5wdXNoKGNvbXBvbmVudFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBQ29tcG9uZW50VmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpbnB1dFRva2VuID0gdGhpcy5jb25zdW1lQVRva2VuKCk7XG4gICAgICAgIHN3aXRjaCAoaW5wdXRUb2tlbikge1xuICAgICAgICAgICAgY2FzZSBcIntcIjpcbiAgICAgICAgICAgIGNhc2UgXCJbXCI6XG4gICAgICAgICAgICBjYXNlIFwiKFwiOlxuICAgICAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrKztcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdW1lQVNpbXBsZUJsb2NrKGlucHV0VG9rZW4pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgaW5wdXRUb2tlbiA9PT0gXCJvYmplY3RcIiAmJiBpbnB1dFRva2VuLnR5cGUgPT09IDgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBRnVuY3Rpb24oaW5wdXRUb2tlbi5uYW1lKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5wdXRUb2tlbjtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBU2ltcGxlQmxvY2sgPSBmdW5jdGlvbiAoYXNzb2NpYXRlZFRva2VuKSB7XG4gICAgICAgIHZhciBlbmRpYW5Ub2tlbiA9IHtcbiAgICAgICAgICAgIFwiW1wiOiBcIl1cIixcbiAgICAgICAgICAgIFwie1wiOiBcIn1cIixcbiAgICAgICAgICAgIFwiKFwiOiBcIilcIlxuICAgICAgICB9W2Fzc29jaWF0ZWRUb2tlbl07XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggLSAxO1xuICAgICAgICB2YXIgYmxvY2sgPSB7XG4gICAgICAgICAgICB0eXBlOiA5LFxuICAgICAgICAgICAgdGV4dDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgYXNzb2NpYXRlZFRva2VuOiBhc3NvY2lhdGVkVG9rZW4sXG4gICAgICAgICAgICB2YWx1ZXM6IFtdXG4gICAgICAgIH07XG4gICAgICAgIHZhciBuZXh0SW5wdXRUb2tlbjtcbiAgICAgICAgd2hpbGUgKG5leHRJbnB1dFRva2VuID0gdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdKSB7XG4gICAgICAgICAgICBpZiAobmV4dElucHV0VG9rZW4gPT09IGVuZGlhblRva2VuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICAgICAgICAgIHZhciBlbmQgPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICAgICAgICAgIGJsb2NrLnRleHQgPSB0aGlzLnRleHQuc3Vic3RyaW5nKHN0YXJ0LCBlbmQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBibG9jaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuY29uc3VtZUFDb21wb25lbnRWYWx1ZSgpO1xuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgYmxvY2sudmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJsb2NrLnRleHQgPSB0aGlzLnRleHQuc3Vic3RyaW5nKHN0YXJ0KTtcbiAgICAgICAgcmV0dXJuIGJsb2NrO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFGdW5jdGlvbiA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgIHZhciBmdW5jVG9rZW4gPSB7IHR5cGU6IDE0LCBuYW1lOiBuYW1lLCB0ZXh0OiB1bmRlZmluZWQsIGNvbXBvbmVudHM6IFtdIH07XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID49IHRoaXMudGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBmdW5jVG9rZW4udGV4dCA9IG5hbWUgKyBcIihcIiArIHRoaXMudGV4dC5zdWJzdHJpbmcoc3RhcnQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jVG9rZW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbmV4dElucHV0VG9rZW4gPSB0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF07XG4gICAgICAgICAgICBzd2l0Y2ggKG5leHRJbnB1dFRva2VuKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIilcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW5kID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgICAgICAgICAgICAgZnVuY1Rva2VuLnRleHQgPSBuYW1lICsgXCIoXCIgKyB0aGlzLnRleHQuc3Vic3RyaW5nKHN0YXJ0LCBlbmQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY1Rva2VuO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wb25lbnQgPSB0aGlzLmNvbnN1bWVBQ29tcG9uZW50VmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBvbmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY1Rva2VuLmNvbXBvbmVudHMucHVzaChjb21wb25lbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gd2hpbGUgKHRydWUpO1xuICAgIH07XG4gICAgcmV0dXJuIENTUzNQYXJzZXI7XG59KCkpO1xuZXhwb3J0cy5DU1MzUGFyc2VyID0gQ1NTM1BhcnNlcjtcbnZhciBDU1NOYXRpdmVTY3JpcHQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENTU05hdGl2ZVNjcmlwdCgpIHtcbiAgICB9XG4gICAgQ1NTTmF0aXZlU2NyaXB0LnByb3RvdHlwZS5wYXJzZVN0eWxlc2hlZXQgPSBmdW5jdGlvbiAoc3R5bGVzaGVldCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogXCJzdHlsZXNoZWV0XCIsXG4gICAgICAgICAgICBzdHlsZXNoZWV0OiB7XG4gICAgICAgICAgICAgICAgcnVsZXM6IHRoaXMucGFyc2VSdWxlcyhzdHlsZXNoZWV0LnJ1bGVzKVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG4gICAgQ1NTTmF0aXZlU2NyaXB0LnByb3RvdHlwZS5wYXJzZVJ1bGVzID0gZnVuY3Rpb24gKHJ1bGVzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBydWxlcy5tYXAoZnVuY3Rpb24gKHJ1bGUpIHsgcmV0dXJuIF90aGlzLnBhcnNlUnVsZShydWxlKTsgfSk7XG4gICAgfTtcbiAgICBDU1NOYXRpdmVTY3JpcHQucHJvdG90eXBlLnBhcnNlUnVsZSA9IGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgIGlmIChydWxlLnR5cGUgPT09IFwiYXQtcnVsZVwiKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUF0UnVsZShydWxlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChydWxlLnR5cGUgPT09IFwicXVhbGlmaWVkLXJ1bGVcIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VRdWFsaWZpZWRSdWxlKHJ1bGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDU1NOYXRpdmVTY3JpcHQucHJvdG90eXBlLnBhcnNlQXRSdWxlID0gZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgaWYgKHJ1bGUubmFtZSA9PT0gXCJpbXBvcnRcIikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpbXBvcnQ6IHJ1bGUucHJlbHVkZS5tYXAoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIHR5cGVvZiBtID09PSBcInN0cmluZ1wiID8gbSA6IG0udGV4dDsgfSkuam9pbihcIlwiKS50cmltKCksXG4gICAgICAgICAgICAgICAgdHlwZTogXCJpbXBvcnRcIlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgfTtcbiAgICBDU1NOYXRpdmVTY3JpcHQucHJvdG90eXBlLnBhcnNlUXVhbGlmaWVkUnVsZSA9IGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiBcInJ1bGVcIixcbiAgICAgICAgICAgIHNlbGVjdG9yczogdGhpcy5wcmVsdWRlVG9TZWxlY3RvcnNTdHJpbmdBcnJheShydWxlLnByZWx1ZGUpLFxuICAgICAgICAgICAgZGVjbGFyYXRpb25zOiB0aGlzLnJ1bGVCbG9ja1RvRGVjbGFyYXRpb25zKHJ1bGUuYmxvY2sudmFsdWVzKVxuICAgICAgICB9O1xuICAgIH07XG4gICAgQ1NTTmF0aXZlU2NyaXB0LnByb3RvdHlwZS5ydWxlQmxvY2tUb0RlY2xhcmF0aW9ucyA9IGZ1bmN0aW9uIChkZWNsYXJhdGlvbnNJbnB1dFRva2Vucykge1xuICAgICAgICB2YXIgZGVjbGFyYXRpb25zID0gW107XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IFwiXCI7XG4gICAgICAgIHZhciB2YWx1ZSA9IFwiXCI7XG4gICAgICAgIHZhciByZWFkaW5nID0gXCJwcm9wZXJ0eVwiO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRlY2xhcmF0aW9uc0lucHV0VG9rZW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaW5wdXRUb2tlbiA9IGRlY2xhcmF0aW9uc0lucHV0VG9rZW5zW2ldO1xuICAgICAgICAgICAgaWYgKHJlYWRpbmcgPT09IFwicHJvcGVydHlcIikge1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dFRva2VuID09PSBcIjpcIikge1xuICAgICAgICAgICAgICAgICAgICByZWFkaW5nID0gXCJ2YWx1ZVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgaW5wdXRUb2tlbiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eSArPSBpbnB1dFRva2VuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHkgKz0gaW5wdXRUb2tlbi50ZXh0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dFRva2VuID09PSBcIjtcIikge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eSA9IHByb3BlcnR5LnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9ucy5wdXNoKHsgdHlwZTogXCJkZWNsYXJhdGlvblwiLCBwcm9wZXJ0eTogcHJvcGVydHksIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHkgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIHJlYWRpbmcgPSBcInByb3BlcnR5XCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBpbnB1dFRva2VuID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlICs9IGlucHV0VG9rZW47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSArPSBpbnB1dFRva2VuLnRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHByb3BlcnR5ID0gcHJvcGVydHkudHJpbSgpO1xuICAgICAgICB2YWx1ZSA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgaWYgKHByb3BlcnR5IHx8IHZhbHVlKSB7XG4gICAgICAgICAgICBkZWNsYXJhdGlvbnMucHVzaCh7IHR5cGU6IFwiZGVjbGFyYXRpb25cIiwgcHJvcGVydHk6IHByb3BlcnR5LCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlY2xhcmF0aW9ucztcbiAgICB9O1xuICAgIENTU05hdGl2ZVNjcmlwdC5wcm90b3R5cGUucHJlbHVkZVRvU2VsZWN0b3JzU3RyaW5nQXJyYXkgPSBmdW5jdGlvbiAocHJlbHVkZSkge1xuICAgICAgICB2YXIgc2VsZWN0b3JzID0gW107XG4gICAgICAgIHZhciBzZWxlY3RvciA9IFwiXCI7XG4gICAgICAgIHByZWx1ZGUuZm9yRWFjaChmdW5jdGlvbiAoaW5wdXRUb2tlbikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dFRva2VuID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0VG9rZW4gPT09IFwiLFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3JzLnB1c2goc2VsZWN0b3IudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RvciA9IFwiXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RvciArPSBpbnB1dFRva2VuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBpbnB1dFRva2VuID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3IgKz0gaW5wdXRUb2tlbi50ZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICBzZWxlY3RvcnMucHVzaChzZWxlY3Rvci50cmltKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZWxlY3RvcnM7XG4gICAgfTtcbiAgICByZXR1cm4gQ1NTTmF0aXZlU2NyaXB0O1xufSgpKTtcbmV4cG9ydHMuQ1NTTmF0aXZlU2NyaXB0ID0gQ1NTTmF0aXZlU2NyaXB0O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFyc2VyLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBNT0RBTCA9IFwibW9kYWxcIjtcbnZhciBST09UID0gXCJyb290XCI7XG5leHBvcnRzLkNMQVNTX1BSRUZJWCA9IFwibnMtXCI7XG52YXIgbW9kYWxSb290Vmlld0Nzc0NsYXNzID0gXCJcIiArIGV4cG9ydHMuQ0xBU1NfUFJFRklYICsgTU9EQUw7XG52YXIgcm9vdFZpZXdDc3NDbGFzc2VzID0gW1wiXCIgKyBleHBvcnRzLkNMQVNTX1BSRUZJWCArIFJPT1RdO1xuZnVuY3Rpb24gZ2V0TW9kYWxSb290Vmlld0Nzc0NsYXNzKCkge1xuICAgIHJldHVybiBtb2RhbFJvb3RWaWV3Q3NzQ2xhc3M7XG59XG5leHBvcnRzLmdldE1vZGFsUm9vdFZpZXdDc3NDbGFzcyA9IGdldE1vZGFsUm9vdFZpZXdDc3NDbGFzcztcbmZ1bmN0aW9uIGdldFJvb3RWaWV3Q3NzQ2xhc3NlcygpIHtcbiAgICByZXR1cm4gcm9vdFZpZXdDc3NDbGFzc2VzO1xufVxuZXhwb3J0cy5nZXRSb290Vmlld0Nzc0NsYXNzZXMgPSBnZXRSb290Vmlld0Nzc0NsYXNzZXM7XG5mdW5jdGlvbiBwdXNoVG9Sb290Vmlld0Nzc0NsYXNzZXModmFsdWUpIHtcbiAgICByb290Vmlld0Nzc0NsYXNzZXMucHVzaCh2YWx1ZSk7XG4gICAgcmV0dXJuIHJvb3RWaWV3Q3NzQ2xhc3Nlcy5sZW5ndGg7XG59XG5leHBvcnRzLnB1c2hUb1Jvb3RWaWV3Q3NzQ2xhc3NlcyA9IHB1c2hUb1Jvb3RWaWV3Q3NzQ2xhc3NlcztcbmZ1bmN0aW9uIHJlbW92ZUZyb21Sb290Vmlld0Nzc0NsYXNzZXModmFsdWUpIHtcbiAgICB2YXIgaW5kZXggPSByb290Vmlld0Nzc0NsYXNzZXMuaW5kZXhPZih2YWx1ZSk7XG4gICAgdmFyIHJlbW92ZWRFbGVtZW50O1xuICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgIHJlbW92ZWRFbGVtZW50ID0gcm9vdFZpZXdDc3NDbGFzc2VzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuICAgIHJldHVybiByZW1vdmVkRWxlbWVudDtcbn1cbmV4cG9ydHMucmVtb3ZlRnJvbVJvb3RWaWV3Q3NzQ2xhc3NlcyA9IHJlbW92ZUZyb21Sb290Vmlld0Nzc0NsYXNzZXM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zeXN0ZW0tY2xhc3Nlcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgb2JzZXJ2YWJsZSA9IHJlcXVpcmUoXCIuLi9vYnNlcnZhYmxlXCIpO1xudmFyIHR5cGVzID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3R5cGVzXCIpO1xudmFyIENoYW5nZVR5cGUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENoYW5nZVR5cGUoKSB7XG4gICAgfVxuICAgIENoYW5nZVR5cGUuQWRkID0gXCJhZGRcIjtcbiAgICBDaGFuZ2VUeXBlLkRlbGV0ZSA9IFwiZGVsZXRlXCI7XG4gICAgQ2hhbmdlVHlwZS5VcGRhdGUgPSBcInVwZGF0ZVwiO1xuICAgIENoYW5nZVR5cGUuU3BsaWNlID0gXCJzcGxpY2VcIjtcbiAgICByZXR1cm4gQ2hhbmdlVHlwZTtcbn0oKSk7XG5leHBvcnRzLkNoYW5nZVR5cGUgPSBDaGFuZ2VUeXBlO1xudmFyIENIQU5HRSA9IFwiY2hhbmdlXCI7XG52YXIgT2JzZXJ2YWJsZUFycmF5ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoT2JzZXJ2YWJsZUFycmF5LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE9ic2VydmFibGVBcnJheSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgQXJyYXkuaXNBcnJheShhcmd1bWVudHNbMF0pKSB7XG4gICAgICAgICAgICBfdGhpcy5fYXJyYXkgPSBhcmd1bWVudHNbMF0uc2xpY2UoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF90aGlzLl9hcnJheSA9IEFycmF5LmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMuX2FkZEFyZ3MgPSB7XG4gICAgICAgICAgICBldmVudE5hbWU6IENIQU5HRSwgb2JqZWN0OiBfdGhpcyxcbiAgICAgICAgICAgIGFjdGlvbjogQ2hhbmdlVHlwZS5BZGQsXG4gICAgICAgICAgICBpbmRleDogbnVsbCxcbiAgICAgICAgICAgIHJlbW92ZWQ6IG5ldyBBcnJheSgpLFxuICAgICAgICAgICAgYWRkZWRDb3VudDogMVxuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5fZGVsZXRlQXJncyA9IHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogQ0hBTkdFLCBvYmplY3Q6IF90aGlzLFxuICAgICAgICAgICAgYWN0aW9uOiBDaGFuZ2VUeXBlLkRlbGV0ZSxcbiAgICAgICAgICAgIGluZGV4OiBudWxsLFxuICAgICAgICAgICAgcmVtb3ZlZDogbnVsbCxcbiAgICAgICAgICAgIGFkZGVkQ291bnQ6IDBcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLmdldEl0ZW0gPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5W2luZGV4XTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuc2V0SXRlbSA9IGZ1bmN0aW9uIChpbmRleCwgdmFsdWUpIHtcbiAgICAgICAgdmFyIG9sZFZhbHVlID0gdGhpcy5fYXJyYXlbaW5kZXhdO1xuICAgICAgICB0aGlzLl9hcnJheVtpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5ub3RpZnkoe1xuICAgICAgICAgICAgZXZlbnROYW1lOiBDSEFOR0UsIG9iamVjdDogdGhpcyxcbiAgICAgICAgICAgIGFjdGlvbjogQ2hhbmdlVHlwZS5VcGRhdGUsXG4gICAgICAgICAgICBpbmRleDogaW5kZXgsXG4gICAgICAgICAgICByZW1vdmVkOiBbb2xkVmFsdWVdLFxuICAgICAgICAgICAgYWRkZWRDb3VudDogMVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLCBcImxlbmd0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5Lmxlbmd0aDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlcy5pc051bWJlcih2YWx1ZSkgJiYgdGhpcy5fYXJyYXkgJiYgdGhpcy5fYXJyYXkubGVuZ3RoICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3BsaWNlKHZhbHVlLCB0aGlzLl9hcnJheS5sZW5ndGggLSB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS50b1N0cmluZygpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS50b0xvY2FsZVN0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5LnRvTG9jYWxlU3RyaW5nKCk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fYWRkQXJncy5pbmRleCA9IHRoaXMuX2FycmF5Lmxlbmd0aDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuX2FycmF5LmNvbmNhdC5hcHBseSh0aGlzLl9hcnJheSwgYXJndW1lbnRzKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuam9pbiA9IGZ1bmN0aW9uIChzZXBhcmF0b3IpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5LmpvaW4oc2VwYXJhdG9yKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUucG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9kZWxldGVBcmdzLmluZGV4ID0gdGhpcy5fYXJyYXkubGVuZ3RoIC0gMTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuX2FycmF5LnBvcCgpO1xuICAgICAgICB0aGlzLl9kZWxldGVBcmdzLnJlbW92ZWQgPSBbcmVzdWx0XTtcbiAgICAgICAgdGhpcy5ub3RpZnkodGhpcy5fZGVsZXRlQXJncyk7XG4gICAgICAgIHRoaXMuX25vdGlmeUxlbmd0aENoYW5nZSgpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9hZGRBcmdzLmluZGV4ID0gdGhpcy5fYXJyYXkubGVuZ3RoO1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSAmJiBBcnJheS5pc0FycmF5KGFyZ3VtZW50c1swXSkpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbMF07XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHNvdXJjZS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hcnJheS5wdXNoKHNvdXJjZVtpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9hcnJheS5wdXNoLmFwcGx5KHRoaXMuX2FycmF5LCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FkZEFyZ3MuYWRkZWRDb3VudCA9IHRoaXMuX2FycmF5Lmxlbmd0aCAtIHRoaXMuX2FkZEFyZ3MuaW5kZXg7XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuX2FkZEFyZ3MpO1xuICAgICAgICB0aGlzLl9ub3RpZnlMZW5ndGhDaGFuZ2UoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5Lmxlbmd0aDtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuX25vdGlmeUxlbmd0aENoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGxlbmd0aENoYW5nZWREYXRhID0gdGhpcy5fY3JlYXRlUHJvcGVydHlDaGFuZ2VEYXRhKFwibGVuZ3RoXCIsIHRoaXMuX2FycmF5Lmxlbmd0aCk7XG4gICAgICAgIHRoaXMubm90aWZ5KGxlbmd0aENoYW5nZWREYXRhKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUucmV2ZXJzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5LnJldmVyc2UoKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuc2hpZnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9hcnJheS5zaGlmdCgpO1xuICAgICAgICB0aGlzLl9kZWxldGVBcmdzLmluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5fZGVsZXRlQXJncy5yZW1vdmVkID0gW3Jlc3VsdF07XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuX2RlbGV0ZUFyZ3MpO1xuICAgICAgICB0aGlzLl9ub3RpZnlMZW5ndGhDaGFuZ2UoKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkuc2xpY2Uoc3RhcnQsIGVuZCk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnNvcnQgPSBmdW5jdGlvbiAoY29tcGFyZUZuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5zb3J0KGNvbXBhcmVGbik7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnNwbGljZSA9IGZ1bmN0aW9uIChzdGFydCwgZGVsZXRlQ291bnQpIHtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHRoaXMuX2FycmF5Lmxlbmd0aDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuX2FycmF5LnNwbGljZS5hcHBseSh0aGlzLl9hcnJheSwgYXJndW1lbnRzKTtcbiAgICAgICAgdGhpcy5ub3RpZnkoe1xuICAgICAgICAgICAgZXZlbnROYW1lOiBDSEFOR0UsIG9iamVjdDogdGhpcyxcbiAgICAgICAgICAgIGFjdGlvbjogQ2hhbmdlVHlwZS5TcGxpY2UsXG4gICAgICAgICAgICBpbmRleDogc3RhcnQsXG4gICAgICAgICAgICByZW1vdmVkOiByZXN1bHQsXG4gICAgICAgICAgICBhZGRlZENvdW50OiB0aGlzLl9hcnJheS5sZW5ndGggKyByZXN1bHQubGVuZ3RoIC0gbGVuZ3RoXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5fYXJyYXkubGVuZ3RoICE9PSBsZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuX25vdGlmeUxlbmd0aENoYW5nZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnVuc2hpZnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLl9hcnJheS5sZW5ndGg7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9hcnJheS51bnNoaWZ0LmFwcGx5KHRoaXMuX2FycmF5LCBhcmd1bWVudHMpO1xuICAgICAgICB0aGlzLl9hZGRBcmdzLmluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5fYWRkQXJncy5hZGRlZENvdW50ID0gcmVzdWx0IC0gbGVuZ3RoO1xuICAgICAgICB0aGlzLm5vdGlmeSh0aGlzLl9hZGRBcmdzKTtcbiAgICAgICAgdGhpcy5fbm90aWZ5TGVuZ3RoQ2hhbmdlKCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiAoc2VhcmNoRWxlbWVudCwgZnJvbUluZGV4KSB7XG4gICAgICAgIHZhciBpbmRleCA9IGZyb21JbmRleCA/IGZyb21JbmRleCA6IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSBpbmRleCwgbCA9IHRoaXMuX2FycmF5Lmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2FycmF5W2ldID09PSBzZWFyY2hFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5sYXN0SW5kZXhPZiA9IGZ1bmN0aW9uIChzZWFyY2hFbGVtZW50LCBmcm9tSW5kZXgpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gZnJvbUluZGV4ID8gZnJvbUluZGV4IDogdGhpcy5fYXJyYXkubGVuZ3RoIC0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IGluZGV4OyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2FycmF5W2ldID09PSBzZWFyY2hFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5ldmVyeSA9IGZ1bmN0aW9uIChjYWxsYmFja2ZuLCB0aGlzQXJnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5ldmVyeShjYWxsYmFja2ZuLCB0aGlzQXJnKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuc29tZSA9IGZ1bmN0aW9uIChjYWxsYmFja2ZuLCB0aGlzQXJnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5zb21lKGNhbGxiYWNrZm4sIHRoaXNBcmcpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGNhbGxiYWNrZm4sIHRoaXNBcmcpIHtcbiAgICAgICAgdGhpcy5fYXJyYXkuZm9yRWFjaChjYWxsYmFja2ZuLCB0aGlzQXJnKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUubWFwID0gZnVuY3Rpb24gKGNhbGxiYWNrZm4sIHRoaXNBcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5Lm1hcChjYWxsYmFja2ZuLCB0aGlzQXJnKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuZmlsdGVyID0gZnVuY3Rpb24gKGNhbGxiYWNrZm4sIHRoaXNBcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5LmZpbHRlcihjYWxsYmFja2ZuLCB0aGlzQXJnKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUucmVkdWNlID0gZnVuY3Rpb24gKGNhbGxiYWNrZm4sIGluaXRpYWxWYWx1ZSkge1xuICAgICAgICByZXR1cm4gaW5pdGlhbFZhbHVlICE9PSB1bmRlZmluZWQgPyB0aGlzLl9hcnJheS5yZWR1Y2UoY2FsbGJhY2tmbiwgaW5pdGlhbFZhbHVlKSA6IHRoaXMuX2FycmF5LnJlZHVjZShjYWxsYmFja2ZuKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUucmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoY2FsbGJhY2tmbiwgaW5pdGlhbFZhbHVlKSB7XG4gICAgICAgIHJldHVybiBpbml0aWFsVmFsdWUgIT09IHVuZGVmaW5lZCA/IHRoaXMuX2FycmF5LnJlZHVjZVJpZ2h0KGNhbGxiYWNrZm4sIGluaXRpYWxWYWx1ZSkgOiB0aGlzLl9hcnJheS5yZWR1Y2VSaWdodChjYWxsYmFja2ZuKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5jaGFuZ2VFdmVudCA9IENIQU5HRTtcbiAgICByZXR1cm4gT2JzZXJ2YWJsZUFycmF5O1xufShvYnNlcnZhYmxlLk9ic2VydmFibGUpKTtcbmV4cG9ydHMuT2JzZXJ2YWJsZUFycmF5ID0gT2JzZXJ2YWJsZUFycmF5O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b2JzZXJ2YWJsZS1hcnJheS5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgX3dyYXBwZWRJbmRleCA9IDA7XG52YXIgV3JhcHBlZFZhbHVlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBXcmFwcGVkVmFsdWUod3JhcHBlZCkge1xuICAgICAgICB0aGlzLndyYXBwZWQgPSB3cmFwcGVkO1xuICAgIH1cbiAgICBXcmFwcGVkVmFsdWUudW53cmFwID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiAodmFsdWUgaW5zdGFuY2VvZiBXcmFwcGVkVmFsdWUpID8gdmFsdWUud3JhcHBlZCA6IHZhbHVlO1xuICAgIH07XG4gICAgV3JhcHBlZFZhbHVlLndyYXAgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHcgPSBfd3JhcHBlZFZhbHVlc1tfd3JhcHBlZEluZGV4KysgJSA1XTtcbiAgICAgICAgdy53cmFwcGVkID0gdmFsdWU7XG4gICAgICAgIHJldHVybiB3O1xuICAgIH07XG4gICAgcmV0dXJuIFdyYXBwZWRWYWx1ZTtcbn0oKSk7XG5leHBvcnRzLldyYXBwZWRWYWx1ZSA9IFdyYXBwZWRWYWx1ZTtcbnZhciBfd3JhcHBlZFZhbHVlcyA9IFtcbiAgICBuZXcgV3JhcHBlZFZhbHVlKG51bGwpLFxuICAgIG5ldyBXcmFwcGVkVmFsdWUobnVsbCksXG4gICAgbmV3IFdyYXBwZWRWYWx1ZShudWxsKSxcbiAgICBuZXcgV3JhcHBlZFZhbHVlKG51bGwpLFxuICAgIG5ldyBXcmFwcGVkVmFsdWUobnVsbClcbl07XG52YXIgT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gT2JzZXJ2YWJsZSgpIHtcbiAgICAgICAgdGhpcy5fb2JzZXJ2ZXJzID0ge307XG4gICAgfVxuICAgIE9ic2VydmFibGUucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzW25hbWVdO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHZhciBvbGRWYWx1ZSA9IHRoaXNbbmFtZV07XG4gICAgICAgIGlmICh0aGlzW25hbWVdID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuZXdWYWx1ZSA9IFdyYXBwZWRWYWx1ZS51bndyYXAodmFsdWUpO1xuICAgICAgICB0aGlzW25hbWVdID0gbmV3VmFsdWU7XG4gICAgICAgIHRoaXMubm90aWZ5UHJvcGVydHlDaGFuZ2UobmFtZSwgbmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLm9uID0gZnVuY3Rpb24gKGV2ZW50TmFtZXMsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWVzLCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24gKGV2ZW50LCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICB2YXIgbGlzdCA9IHRoaXMuX2dldEV2ZW50TGlzdChldmVudCwgdHJ1ZSk7XG4gICAgICAgIGxpc3QucHVzaCh7IGNhbGxiYWNrOiBjYWxsYmFjaywgdGhpc0FyZzogdGhpc0FyZywgb25jZTogdHJ1ZSB9KTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIChldmVudE5hbWVzLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lcywgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudE5hbWVzLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBpZiAodHlwZW9mIGV2ZW50TmFtZXMgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJFdmVudHMgbmFtZShzKSBtdXN0IGJlIHN0cmluZy5cIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiY2FsbGJhY2sgbXVzdCBiZSBmdW5jdGlvbi5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGV2ZW50cyA9IGV2ZW50TmFtZXMuc3BsaXQoXCIsXCIpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGV2ZW50cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBldmVudF8xID0gZXZlbnRzW2ldLnRyaW0oKTtcbiAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5fZ2V0RXZlbnRMaXN0KGV2ZW50XzEsIHRydWUpO1xuICAgICAgICAgICAgbGlzdC5wdXNoKHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjazogY2FsbGJhY2ssXG4gICAgICAgICAgICAgICAgdGhpc0FyZzogdGhpc0FyZ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnROYW1lcywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBldmVudE5hbWVzICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXZlbnRzIG5hbWUocykgbXVzdCBiZSBzdHJpbmcuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYWxsYmFjayAmJiB0eXBlb2YgY2FsbGJhY2sgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImNhbGxiYWNrIG11c3QgYmUgZnVuY3Rpb24uXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBldmVudHMgPSBldmVudE5hbWVzLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBldmVudHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZXZlbnRfMiA9IGV2ZW50c1tpXS50cmltKCk7XG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMuX2dldEV2ZW50TGlzdChldmVudF8yLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgaWYgKGxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4XzEgPSB0aGlzLl9pbmRleE9mTGlzdGVuZXIobGlzdCwgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXhfMSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0LnNwbGljZShpbmRleF8xLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobGlzdC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9vYnNlcnZlcnNbZXZlbnRfMl07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vYnNlcnZlcnNbZXZlbnRfMl0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX29ic2VydmVyc1tldmVudF8yXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUubm90aWZ5ID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdmFyIG9ic2VydmVycyA9IHRoaXMuX29ic2VydmVyc1tkYXRhLmV2ZW50TmFtZV07XG4gICAgICAgIGlmICghb2JzZXJ2ZXJzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IG9ic2VydmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIGVudHJ5ID0gb2JzZXJ2ZXJzW2ldO1xuICAgICAgICAgICAgaWYgKGVudHJ5Lm9uY2UpIHtcbiAgICAgICAgICAgICAgICBvYnNlcnZlcnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVudHJ5LnRoaXNBcmcpIHtcbiAgICAgICAgICAgICAgICBlbnRyeS5jYWxsYmFjay5hcHBseShlbnRyeS50aGlzQXJnLCBbZGF0YV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZW50cnkuY2FsbGJhY2soZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLm5vdGlmeVByb3BlcnR5Q2hhbmdlID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICB0aGlzLm5vdGlmeSh0aGlzLl9jcmVhdGVQcm9wZXJ0eUNoYW5nZURhdGEobmFtZSwgdmFsdWUsIG9sZFZhbHVlKSk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5oYXNMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoZXZlbnROYW1lKSB7XG4gICAgICAgIHJldHVybiBldmVudE5hbWUgaW4gdGhpcy5fb2JzZXJ2ZXJzO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuX2NyZWF0ZVByb3BlcnR5Q2hhbmdlRGF0YSA9IGZ1bmN0aW9uIChwcm9wZXJ0eU5hbWUsIHZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICByZXR1cm4geyBldmVudE5hbWU6IE9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCwgb2JqZWN0OiB0aGlzLCBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSwgdmFsdWU6IHZhbHVlLCBvbGRWYWx1ZTogb2xkVmFsdWUgfTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLl9lbWl0ID0gZnVuY3Rpb24gKGV2ZW50TmFtZXMpIHtcbiAgICAgICAgdmFyIGV2ZW50cyA9IGV2ZW50TmFtZXMuc3BsaXQoXCIsXCIpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGV2ZW50cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBldmVudF8zID0gZXZlbnRzW2ldLnRyaW0oKTtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5KHsgZXZlbnROYW1lOiBldmVudF8zLCBvYmplY3Q6IHRoaXMgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLl9nZXRFdmVudExpc3QgPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBjcmVhdGVJZk5lZWRlZCkge1xuICAgICAgICBpZiAoIWV2ZW50TmFtZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkV2ZW50TmFtZSBtdXN0IGJlIHZhbGlkIHN0cmluZy5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9vYnNlcnZlcnNbZXZlbnROYW1lXTtcbiAgICAgICAgaWYgKCFsaXN0ICYmIGNyZWF0ZUlmTmVlZGVkKSB7XG4gICAgICAgICAgICBsaXN0ID0gW107XG4gICAgICAgICAgICB0aGlzLl9vYnNlcnZlcnNbZXZlbnROYW1lXSA9IGxpc3Q7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxpc3Q7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5faW5kZXhPZkxpc3RlbmVyID0gZnVuY3Rpb24gKGxpc3QsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGVudHJ5ID0gbGlzdFtpXTtcbiAgICAgICAgICAgIGlmICh0aGlzQXJnKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVudHJ5LmNhbGxiYWNrID09PSBjYWxsYmFjayAmJiBlbnRyeS50aGlzQXJnID09PSB0aGlzQXJnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5jYWxsYmFjayA9PT0gY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCA9IFwicHJvcGVydHlDaGFuZ2VcIjtcbiAgICByZXR1cm4gT2JzZXJ2YWJsZTtcbn0oKSk7XG5leHBvcnRzLk9ic2VydmFibGUgPSBPYnNlcnZhYmxlO1xudmFyIE9ic2VydmFibGVGcm9tT2JqZWN0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoT2JzZXJ2YWJsZUZyb21PYmplY3QsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gT2JzZXJ2YWJsZUZyb21PYmplY3QoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fbWFwID0ge307XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JzZXJ2YWJsZUZyb21PYmplY3QucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tYXBbbmFtZV07XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlRnJvbU9iamVjdC5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSB0aGlzLl9tYXBbbmFtZV07XG4gICAgICAgIGlmIChjdXJyZW50VmFsdWUgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5ld1ZhbHVlID0gV3JhcHBlZFZhbHVlLnVud3JhcCh2YWx1ZSk7XG4gICAgICAgIHRoaXMuX21hcFtuYW1lXSA9IG5ld1ZhbHVlO1xuICAgICAgICB0aGlzLm5vdGlmeVByb3BlcnR5Q2hhbmdlKG5hbWUsIG5ld1ZhbHVlLCBjdXJyZW50VmFsdWUpO1xuICAgIH07XG4gICAgcmV0dXJuIE9ic2VydmFibGVGcm9tT2JqZWN0O1xufShPYnNlcnZhYmxlKSk7XG5mdW5jdGlvbiBkZWZpbmVOZXdQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5TmFtZSkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5TmFtZSwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQuX21hcFtwcm9wZXJ0eU5hbWVdO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGFyZ2V0LnNldChwcm9wZXJ0eU5hbWUsIHZhbHVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG59XG5mdW5jdGlvbiBhZGRQcm9wZXJ0aWVzRnJvbU9iamVjdChvYnNlcnZhYmxlLCBzb3VyY2UsIHJlY3Vyc2l2ZSkge1xuICAgIGlmIChyZWN1cnNpdmUgPT09IHZvaWQgMCkgeyByZWN1cnNpdmUgPSBmYWxzZTsgfVxuICAgIE9iamVjdC5rZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAocHJvcCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBzb3VyY2VbcHJvcF07XG4gICAgICAgIGlmIChyZWN1cnNpdmVcbiAgICAgICAgICAgICYmICFBcnJheS5pc0FycmF5KHZhbHVlKVxuICAgICAgICAgICAgJiYgdmFsdWVcbiAgICAgICAgICAgICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIlxuICAgICAgICAgICAgJiYgISh2YWx1ZSBpbnN0YW5jZW9mIE9ic2VydmFibGUpKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IGZyb21PYmplY3RSZWN1cnNpdmUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGRlZmluZU5ld1Byb3BlcnR5KG9ic2VydmFibGUsIHByb3ApO1xuICAgICAgICBvYnNlcnZhYmxlLnNldChwcm9wLCB2YWx1ZSk7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBmcm9tT2JqZWN0KHNvdXJjZSkge1xuICAgIHZhciBvYnNlcnZhYmxlID0gbmV3IE9ic2VydmFibGVGcm9tT2JqZWN0KCk7XG4gICAgYWRkUHJvcGVydGllc0Zyb21PYmplY3Qob2JzZXJ2YWJsZSwgc291cmNlLCBmYWxzZSk7XG4gICAgcmV0dXJuIG9ic2VydmFibGU7XG59XG5leHBvcnRzLmZyb21PYmplY3QgPSBmcm9tT2JqZWN0O1xuZnVuY3Rpb24gZnJvbU9iamVjdFJlY3Vyc2l2ZShzb3VyY2UpIHtcbiAgICB2YXIgb2JzZXJ2YWJsZSA9IG5ldyBPYnNlcnZhYmxlRnJvbU9iamVjdCgpO1xuICAgIGFkZFByb3BlcnRpZXNGcm9tT2JqZWN0KG9ic2VydmFibGUsIHNvdXJjZSwgdHJ1ZSk7XG4gICAgcmV0dXJuIG9ic2VydmFibGU7XG59XG5leHBvcnRzLmZyb21PYmplY3RSZWN1cnNpdmUgPSBmcm9tT2JqZWN0UmVjdXJzaXZlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b2JzZXJ2YWJsZS5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbmV0d29yaztcbmZ1bmN0aW9uIGdldE5ldHdvcmsoKSB7XG4gICAgcmV0dXJuIG5ldHdvcms7XG59XG5leHBvcnRzLmdldE5ldHdvcmsgPSBnZXROZXR3b3JrO1xuZnVuY3Rpb24gc2V0TmV0d29yayhuZXdOZXR3b3JrKSB7XG4gICAgbmV0d29yayA9IG5ld05ldHdvcms7XG59XG5leHBvcnRzLnNldE5ldHdvcmsgPSBzZXROZXR3b3JrO1xudmFyIGRvbTtcbmZ1bmN0aW9uIGdldERPTSgpIHtcbiAgICByZXR1cm4gZG9tO1xufVxuZXhwb3J0cy5nZXRET00gPSBnZXRET007XG5mdW5jdGlvbiBzZXRET00obmV3RE9NKSB7XG4gICAgZG9tID0gbmV3RE9NO1xufVxuZXhwb3J0cy5zZXRET00gPSBzZXRET007XG52YXIgY3NzO1xuZnVuY3Rpb24gZ2V0Q1NTKCkge1xuICAgIHJldHVybiBjc3M7XG59XG5leHBvcnRzLmdldENTUyA9IGdldENTUztcbmZ1bmN0aW9uIHNldENTUyhuZXdDU1MpIHtcbiAgICBjc3MgPSBuZXdDU1M7XG59XG5leHBvcnRzLnNldENTUyA9IHNldENTUztcbnZhciBOZXR3b3JrQWdlbnQ7XG4oZnVuY3Rpb24gKE5ldHdvcmtBZ2VudCkge1xuICAgIGZ1bmN0aW9uIHJlc3BvbnNlUmVjZWl2ZWQocmVxdWVzdElkLCByZXN1bHQsIGhlYWRlcnMpIHtcbiAgICAgICAgdmFyIHJlcXVlc3RJZFN0ciA9IHJlcXVlc3RJZC50b1N0cmluZygpO1xuICAgICAgICB2YXIgbWltZVR5cGUgPSBoZWFkZXJzW1wiQ29udGVudC1UeXBlXCJdIHx8IGhlYWRlcnNbXCJjb250ZW50LXR5cGVcIl0gfHwgXCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW1cIjtcbiAgICAgICAgdmFyIGNvbnRlbnRMZW5ndGhIZWFkZXIgPSBoZWFkZXJzW1wiQ29udGVudC1MZW5ndGhcIl0gfHwgaGVhZGVyc1tcImNvbnRlbnQtbGVuZ3RoXCJdO1xuICAgICAgICB2YXIgY29udGVudExlbmd0aCA9IHBhcnNlSW50KGNvbnRlbnRMZW5ndGhIZWFkZXIsIDEwKTtcbiAgICAgICAgaWYgKGlzTmFOKGNvbnRlbnRMZW5ndGgpKSB7XG4gICAgICAgICAgICBjb250ZW50TGVuZ3RoID0gMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzcG9uc2UgPSB7XG4gICAgICAgICAgICB1cmw6IHJlc3VsdC51cmwgfHwgXCJcIixcbiAgICAgICAgICAgIHN0YXR1czogcmVzdWx0LnN0YXR1c0NvZGUsXG4gICAgICAgICAgICBzdGF0dXNUZXh0OiByZXN1bHQuc3RhdHVzVGV4dCB8fCBcIlwiLFxuICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgICAgICAgIG1pbWVUeXBlOiBtaW1lVHlwZSxcbiAgICAgICAgICAgIGZyb21EaXNrQ2FjaGU6IGZhbHNlLFxuICAgICAgICAgICAgY29ubmVjdGlvblJldXNlZDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbm5lY3Rpb25JZDogMCxcbiAgICAgICAgICAgIGVuY29kZWREYXRhTGVuZ3RoOiBjb250ZW50TGVuZ3RoLFxuICAgICAgICAgICAgc2VjdXJpdHlTdGF0ZTogXCJpbmZvXCJcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHJlc3BvbnNlRGF0YSA9IHtcbiAgICAgICAgICAgIHJlcXVlc3RJZDogcmVxdWVzdElkU3RyLFxuICAgICAgICAgICAgdHlwZTogbWltZVR5cGVUb1R5cGUocmVzcG9uc2UubWltZVR5cGUpLFxuICAgICAgICAgICAgcmVzcG9uc2U6IHJlc3BvbnNlLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBnZXRUaW1lU3RhbXAoKVxuICAgICAgICB9O1xuICAgICAgICBnbG9iYWwuX19pbnNwZWN0b3IucmVzcG9uc2VSZWNlaXZlZChyZXNwb25zZURhdGEpO1xuICAgICAgICBnbG9iYWwuX19pbnNwZWN0b3IubG9hZGluZ0ZpbmlzaGVkKHtcbiAgICAgICAgICAgIHJlcXVlc3RJZDogcmVxdWVzdElkU3RyLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBnZXRUaW1lU3RhbXAoKSxcbiAgICAgICAgICAgIGVuY29kZWREYXRhTGVuZ3RoOiBjb250ZW50TGVuZ3RoXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgaGFzVGV4dENvbnRlbnQgPSByZXNwb25zZURhdGEudHlwZSA9PT0gXCJEb2N1bWVudFwiIHx8IHJlc3BvbnNlRGF0YS50eXBlID09PSBcIlNjcmlwdFwiO1xuICAgICAgICB2YXIgZGF0YTtcbiAgICAgICAgaWYgKCFoYXNUZXh0Q29udGVudCkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlRGF0YS50eXBlID09PSBcIkltYWdlXCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgYml0bWFwID0gcmVzdWx0LnJlc3BvbnNlQXNJbWFnZTtcbiAgICAgICAgICAgICAgICBpZiAoYml0bWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvdXRwdXRTdHJlYW0gPSBuZXcgamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW0oKTtcbiAgICAgICAgICAgICAgICAgICAgYml0bWFwLmNvbXByZXNzKGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwLkNvbXByZXNzRm9ybWF0LlBORywgMTAwLCBvdXRwdXRTdHJlYW0pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYmFzZTY0SW1hZ2UgPSBhbmRyb2lkLnV0aWwuQmFzZTY0LmVuY29kZVRvU3RyaW5nKG91dHB1dFN0cmVhbS50b0J5dGVBcnJheSgpLCBhbmRyb2lkLnV0aWwuQmFzZTY0LkRFRkFVTFQpO1xuICAgICAgICAgICAgICAgICAgICBkYXRhID0gYmFzZTY0SW1hZ2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGF0YSA9IHJlc3VsdC5yZXNwb25zZUFzU3RyaW5nO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdWNjZXNzZnVsUmVxdWVzdERhdGEgPSB7XG4gICAgICAgICAgICByZXF1ZXN0SWQ6IHJlcXVlc3RJZFN0cixcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICBoYXNUZXh0Q29udGVudDogaGFzVGV4dENvbnRlbnRcbiAgICAgICAgfTtcbiAgICAgICAgZ2xvYmFsLl9faW5zcGVjdG9yLmRhdGFGb3JSZXF1ZXN0SWQoc3VjY2Vzc2Z1bFJlcXVlc3REYXRhKTtcbiAgICB9XG4gICAgTmV0d29ya0FnZW50LnJlc3BvbnNlUmVjZWl2ZWQgPSByZXNwb25zZVJlY2VpdmVkO1xuICAgIGZ1bmN0aW9uIHJlcXVlc3RXaWxsQmVTZW50KHJlcXVlc3RJZCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgcmVxdWVzdCA9IHtcbiAgICAgICAgICAgIHVybDogb3B0aW9ucy51cmwsXG4gICAgICAgICAgICBtZXRob2Q6IG9wdGlvbnMubWV0aG9kLFxuICAgICAgICAgICAgaGVhZGVyczogb3B0aW9ucy5oZWFkZXJzIHx8IHt9LFxuICAgICAgICAgICAgcG9zdERhdGE6IG9wdGlvbnMuY29udGVudCA/IG9wdGlvbnMuY29udGVudC50b1N0cmluZygpIDogXCJcIixcbiAgICAgICAgICAgIGluaXRpYWxQcmlvcml0eTogXCJNZWRpdW1cIixcbiAgICAgICAgICAgIHJlZmVycmVyUG9saWN5OiBcIm5vLXJlZmVycmVyLXdoZW4tZG93bmdyYWRlXCJcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHJlcXVlc3REYXRhID0ge1xuICAgICAgICAgICAgcmVxdWVzdElkOiByZXF1ZXN0SWQudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIHVybDogcmVxdWVzdC51cmwsXG4gICAgICAgICAgICByZXF1ZXN0OiByZXF1ZXN0LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBnZXRUaW1lU3RhbXAoKSxcbiAgICAgICAgICAgIHR5cGU6IFwiRG9jdW1lbnRcIixcbiAgICAgICAgICAgIHdhbGxUaW1lOiAwXG4gICAgICAgIH07XG4gICAgICAgIGdsb2JhbC5fX2luc3BlY3Rvci5yZXF1ZXN0V2lsbEJlU2VudChyZXF1ZXN0RGF0YSk7XG4gICAgfVxuICAgIE5ldHdvcmtBZ2VudC5yZXF1ZXN0V2lsbEJlU2VudCA9IHJlcXVlc3RXaWxsQmVTZW50O1xuICAgIGZ1bmN0aW9uIGdldFRpbWVTdGFtcCgpIHtcbiAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChkLmdldFRpbWUoKSAvIDEwMDApO1xuICAgIH1cbiAgICBmdW5jdGlvbiBtaW1lVHlwZVRvVHlwZShtaW1lVHlwZSkge1xuICAgICAgICB2YXIgdHlwZSA9IFwiRG9jdW1lbnRcIjtcbiAgICAgICAgaWYgKG1pbWVUeXBlKSB7XG4gICAgICAgICAgICBpZiAobWltZVR5cGUuaW5kZXhPZihcImltYWdlXCIpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdHlwZSA9IFwiSW1hZ2VcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG1pbWVUeXBlLmluZGV4T2YoXCJqYXZhc2NyaXB0XCIpICE9PSAtMSB8fCBtaW1lVHlwZS5pbmRleE9mKFwianNvblwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICB0eXBlID0gXCJTY3JpcHRcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHlwZTtcbiAgICB9XG59KShOZXR3b3JrQWdlbnQgPSBleHBvcnRzLk5ldHdvcmtBZ2VudCB8fCAoZXhwb3J0cy5OZXR3b3JrQWdlbnQgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVidWdnZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGRvbV9ub2RlXzEgPSByZXF1aXJlKFwiLi9kb20tbm9kZVwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uL3V0aWxzL3V0aWxzXCIpO1xudmFyIGZyYW1lVG9wbW9zdCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuLi91aS9mcmFtZVwiKS50b3Btb3N0KCk7IH07XG52YXIgdW5zZXRWYWx1ZTtcbmZ1bmN0aW9uIHVuc2V0Vmlld1ZhbHVlKHZpZXcsIG5hbWUpIHtcbiAgICBpZiAoIXVuc2V0VmFsdWUpIHtcbiAgICAgICAgdW5zZXRWYWx1ZSA9IHJlcXVpcmUoXCIuLi91aS9jb3JlL3Byb3BlcnRpZXNcIikudW5zZXRWYWx1ZTtcbiAgICB9XG4gICAgdmlld1tuYW1lXSA9IHVuc2V0VmFsdWU7XG59XG5mdW5jdGlvbiBnZXRWaWV3QnlJZChub2RlSWQpIHtcbiAgICB2YXIgbm9kZSA9IGRvbV9ub2RlXzEuZ2V0Tm9kZUJ5SWQobm9kZUlkKTtcbiAgICB2YXIgdmlldztcbiAgICBpZiAobm9kZSkge1xuICAgICAgICB2aWV3ID0gbm9kZS52aWV3UmVmLmdldCgpO1xuICAgIH1cbiAgICByZXR1cm4gdmlldztcbn1cbmZ1bmN0aW9uIGdldERvY3VtZW50KCkge1xuICAgIHZhciB0b3BNb3N0RnJhbWUgPSBmcmFtZVRvcG1vc3QoKTtcbiAgICBpZiAoIXRvcE1vc3RGcmFtZSkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICB0b3BNb3N0RnJhbWUuZW5zdXJlRG9tTm9kZSgpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkVSUk9SIGluIGdldERvY3VtZW50KCk6IFwiICsgZSk7XG4gICAgfVxuICAgIHJldHVybiB0b3BNb3N0RnJhbWUuZG9tTm9kZS50b09iamVjdCgpO1xufVxuZXhwb3J0cy5nZXREb2N1bWVudCA9IGdldERvY3VtZW50O1xuZnVuY3Rpb24gZ2V0Q29tcHV0ZWRTdHlsZXNGb3JOb2RlKG5vZGVJZCkge1xuICAgIHZhciB2aWV3ID0gZ2V0Vmlld0J5SWQobm9kZUlkKTtcbiAgICBpZiAodmlldykge1xuICAgICAgICByZXR1cm4gdmlldy5kb21Ob2RlLmdldENvbXB1dGVkUHJvcGVydGllcygpO1xuICAgIH1cbiAgICByZXR1cm4gW107XG59XG5leHBvcnRzLmdldENvbXB1dGVkU3R5bGVzRm9yTm9kZSA9IGdldENvbXB1dGVkU3R5bGVzRm9yTm9kZTtcbmV4cG9ydHMucmVtb3ZlTm9kZSA9IHV0aWxzXzEubWFpblRocmVhZGlmeShmdW5jdGlvbiByZW1vdmVOb2RlKG5vZGVJZCkge1xuICAgIHZhciB2aWV3ID0gZ2V0Vmlld0J5SWQobm9kZUlkKTtcbiAgICBpZiAodmlldykge1xuICAgICAgICB2YXIgcGFyZW50XzEgPSB2aWV3LnBhcmVudDtcbiAgICAgICAgaWYgKHBhcmVudF8xLnJlbW92ZUNoaWxkKSB7XG4gICAgICAgICAgICBwYXJlbnRfMS5yZW1vdmVDaGlsZCh2aWV3KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwYXJlbnRfMS5jb250ZW50ID09PSB2aWV3KSB7XG4gICAgICAgICAgICBwYXJlbnRfMS5jb250ZW50ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2FuJ3QgcmVtb3ZlIGNoaWxkIGZyb20gXCIgKyBwYXJlbnRfMSk7XG4gICAgICAgIH1cbiAgICB9XG59KTtcbmV4cG9ydHMuc2V0QXR0cmlidXRlQXNUZXh0ID0gdXRpbHNfMS5tYWluVGhyZWFkaWZ5KGZ1bmN0aW9uIHNldEF0dHJpYnV0ZUFzVGV4dChub2RlSWQsIHRleHQsIG5hbWUpIHtcbiAgICB2YXIgdmlldyA9IGdldFZpZXdCeUlkKG5vZGVJZCk7XG4gICAgaWYgKHZpZXcpIHtcbiAgICAgICAgdmFyIGhhc09yaWdpbmFsQXR0cmlidXRlID0gISFuYW1lLnRyaW0oKTtcbiAgICAgICAgaWYgKHRleHQpIHtcbiAgICAgICAgICAgIHZhciB0ZXh0UGFydHMgPSB0ZXh0LnNwbGl0KFwiPVwiKTtcbiAgICAgICAgICAgIGlmICh0ZXh0UGFydHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJOYW1lID0gdGV4dFBhcnRzWzBdO1xuICAgICAgICAgICAgICAgIHZhciBhdHRyVmFsdWUgPSB0ZXh0UGFydHNbMV0ucmVwbGFjZSgvWydcIl0rL2csIFwiXCIpO1xuICAgICAgICAgICAgICAgIGlmIChuYW1lICE9PSBhdHRyTmFtZSAmJiBoYXNPcmlnaW5hbEF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgICAgICB1bnNldFZpZXdWYWx1ZSh2aWV3LCBuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgdmlld1thdHRyTmFtZV0gPSBhdHRyVmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2aWV3W2hhc09yaWdpbmFsQXR0cmlidXRlID8gbmFtZSA6IGF0dHJOYW1lXSA9IGF0dHJWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB1bnNldFZpZXdWYWx1ZSh2aWV3LCBuYW1lKTtcbiAgICAgICAgfVxuICAgICAgICB2aWV3LmRvbU5vZGUubG9hZEF0dHJpYnV0ZXMoKTtcbiAgICB9XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRldnRvb2xzLWVsZW1lbnRzLmNvbW1vbi5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZGV2dG9vbHNfZWxlbWVudHNfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9kZXZ0b29scy1lbGVtZW50cy5jb21tb25cIik7XG52YXIgZG9tX25vZGVfMSA9IHJlcXVpcmUoXCIuL2RvbS1ub2RlXCIpO1xuZnVuY3Rpb24gYXR0YWNoRE9NSW5zcGVjdG9yRXZlbnRDYWxsYmFja3MoRE9NRG9tYWluRnJvbnRlbmQpIHtcbiAgICBkb21fbm9kZV8xLnJlZ2lzdGVySW5zcGVjdG9yRXZlbnRzKERPTURvbWFpbkZyb250ZW5kKTtcbiAgICB2YXIgb3JpZ2luYWxDaGlsZE5vZGVJbnNlcnRlZCA9IERPTURvbWFpbkZyb250ZW5kLmNoaWxkTm9kZUluc2VydGVkO1xuICAgIERPTURvbWFpbkZyb250ZW5kLmNoaWxkTm9kZUluc2VydGVkID0gZnVuY3Rpb24gKHBhcmVudElkLCBsYXN0SWQsIG5vZGUpIHtcbiAgICAgICAgb3JpZ2luYWxDaGlsZE5vZGVJbnNlcnRlZChwYXJlbnRJZCwgbGFzdElkLCBKU09OLnN0cmluZ2lmeShub2RlLnRvT2JqZWN0KCkpKTtcbiAgICB9O1xufVxuZXhwb3J0cy5hdHRhY2hET01JbnNwZWN0b3JFdmVudENhbGxiYWNrcyA9IGF0dGFjaERPTUluc3BlY3RvckV2ZW50Q2FsbGJhY2tzO1xuZnVuY3Rpb24gYXR0YWNoRE9NSW5zcGVjdG9yQ29tbWFuZENhbGxiYWNrcyhET01Eb21haW5CYWNrZW5kKSB7XG4gICAgRE9NRG9tYWluQmFja2VuZC5nZXREb2N1bWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRldnRvb2xzX2VsZW1lbnRzX2NvbW1vbl8xLmdldERvY3VtZW50KCkpO1xuICAgIH07XG4gICAgRE9NRG9tYWluQmFja2VuZC5nZXRDb21wdXRlZFN0eWxlc0Zvck5vZGUgPSBmdW5jdGlvbiAobm9kZUlkKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkZXZ0b29sc19lbGVtZW50c19jb21tb25fMS5nZXRDb21wdXRlZFN0eWxlc0Zvck5vZGUobm9kZUlkKSk7XG4gICAgfTtcbiAgICBET01Eb21haW5CYWNrZW5kLnJlbW92ZU5vZGUgPSBkZXZ0b29sc19lbGVtZW50c19jb21tb25fMS5yZW1vdmVOb2RlO1xuICAgIERPTURvbWFpbkJhY2tlbmQuc2V0QXR0cmlidXRlQXNUZXh0ID0gZGV2dG9vbHNfZWxlbWVudHNfY29tbW9uXzEuc2V0QXR0cmlidXRlQXNUZXh0O1xufVxuZXhwb3J0cy5hdHRhY2hET01JbnNwZWN0b3JDb21tYW5kQ2FsbGJhY2tzID0gYXR0YWNoRE9NSW5zcGVjdG9yQ29tbWFuZENhbGxiYWNrcztcbmZ1bmN0aW9uIGF0dGFjaENTU0luc3BlY3RvckNvbW1hbmRDYWxsYmFja3MoQ1NTRG9tYWluRnJvbnRlbmQpIHtcbn1cbmV4cG9ydHMuYXR0YWNoQ1NTSW5zcGVjdG9yQ29tbWFuZENhbGxiYWNrcyA9IGF0dGFjaENTU0luc3BlY3RvckNvbW1hbmRDYWxsYmFja3M7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZXZ0b29scy1lbGVtZW50cy5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciByZWdpc3RlcmVkRG9tTm9kZXMgPSB7fTtcbnZhciBFTEVNRU5UX05PREVfVFlQRSA9IDE7XG52YXIgUk9PVF9OT0RFX1RZUEUgPSA5O1xudmFyIHByb3BlcnR5QmxhY2tsaXN0ID0gW1xuICAgIFwiZWZmZWN0aXZlUGFkZGluZ0xlZnRcIixcbiAgICBcImVmZmVjdGl2ZVBhZGRpbmdCb3R0b21cIixcbiAgICBcImVmZmVjdGl2ZVBhZGRpbmdSaWdodFwiLFxuICAgIFwiZWZmZWN0aXZlUGFkZGluZ1RvcFwiLFxuICAgIFwiZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGhcIixcbiAgICBcImVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGhcIixcbiAgICBcImVmZmVjdGl2ZUJvcmRlckJvdHRvbVdpZHRoXCIsXG4gICAgXCJlZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGhcIixcbiAgICBcImVmZmVjdGl2ZU1pbldpZHRoXCIsXG4gICAgXCJlZmZlY3RpdmVNaW5IZWlnaHRcIixcbiAgICBcImVmZmVjdGl2ZVdpZHRoXCIsXG4gICAgXCJlZmZlY3RpdmVIZWlnaHRcIixcbiAgICBcImVmZmVjdGl2ZU1hcmdpbkxlZnRcIixcbiAgICBcImVmZmVjdGl2ZU1hcmdpblRvcFwiLFxuICAgIFwiZWZmZWN0aXZlTWFyZ2luUmlnaHRcIixcbiAgICBcImVmZmVjdGl2ZU1hcmdpbkJvdHRvbVwiLFxuICAgIFwibm9kZU5hbWVcIixcbiAgICBcIm5vZGVUeXBlXCIsXG4gICAgXCJkZWNvZGVXaWR0aFwiLFxuICAgIFwiZGVjb2RlSGVpZ2h0XCIsXG4gICAgXCJuZy1yZWZsZWN0LWl0ZW1zXCIsXG4gICAgXCJkb21Ob2RlXCIsXG4gICAgXCJ0b3VjaExpc3RlbmVySXNTZXRcIixcbiAgICBcImJpbmRpbmdDb250ZXh0XCIsXG4gICAgXCJuYXRpdmVWaWV3XCJcbl07XG5mdW5jdGlvbiBsYXp5KGFjdGlvbikge1xuICAgIHZhciBfdmFsdWU7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF92YWx1ZSB8fCAoX3ZhbHVlID0gYWN0aW9uKCkpOyB9O1xufVxudmFyIHBlcmNlbnRMZW5ndGhUb1N0cmluZ0xhenkgPSBsYXp5KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuLi91aS9zdHlsaW5nL3N0eWxlLXByb3BlcnRpZXNcIikuUGVyY2VudExlbmd0aC5jb252ZXJ0VG9TdHJpbmc7IH0pO1xudmFyIGdldFNldFByb3BlcnRpZXNMYXp5ID0gbGF6eShmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi4vdWkvY29yZS9wcm9wZXJ0aWVzXCIpLmdldFNldFByb3BlcnRpZXM7IH0pO1xudmFyIGdldENvbXB1dGVkQ3NzVmFsdWVzTGF6eSA9IGxhenkoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4uL3VpL2NvcmUvcHJvcGVydGllc1wiKS5nZXRDb21wdXRlZENzc1ZhbHVlczsgfSk7XG5mdW5jdGlvbiByZWdpc3Rlckluc3BlY3RvckV2ZW50cyhpbnNwZWN0b3IpIHtcbiAgICBpbnNwZWN0b3JGcm9udGVuZEluc3RhbmNlID0gaW5zcGVjdG9yO1xufVxuZXhwb3J0cy5yZWdpc3Rlckluc3BlY3RvckV2ZW50cyA9IHJlZ2lzdGVySW5zcGVjdG9yRXZlbnRzO1xudmFyIGluc3BlY3RvckZyb250ZW5kSW5zdGFuY2U7XG5mdW5jdGlvbiBub3RpZnlJbnNwZWN0b3IoY2FsbGJhY2spIHtcbiAgICBpZiAoaW5zcGVjdG9yRnJvbnRlbmRJbnN0YW5jZSkge1xuICAgICAgICBjYWxsYmFjayhpbnNwZWN0b3JGcm9udGVuZEluc3RhbmNlKTtcbiAgICB9XG59XG5mdW5jdGlvbiB2YWx1ZVRvU3RyaW5nKHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJ1bmRlZmluZWRcIiB8fCB2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIHZhbHVlLnVuaXQpIHtcbiAgICAgICAgcmV0dXJuIHBlcmNlbnRMZW5ndGhUb1N0cmluZ0xhenkoKSh2YWx1ZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gdmFsdWUgKyBcIlwiO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHByb3BlcnR5RmlsdGVyKF9hKSB7XG4gICAgdmFyIG5hbWUgPSBfYVswXSwgdmFsdWUgPSBfYVsxXTtcbiAgICBpZiAobmFtZVswXSA9PT0gXCJfXCIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHByb3BlcnR5QmxhY2tsaXN0LmluZGV4T2YobmFtZSkgPj0gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gcmVnaXN0ZXJOb2RlKGRvbU5vZGUpIHtcbiAgICByZWdpc3RlcmVkRG9tTm9kZXNbZG9tTm9kZS5ub2RlSWRdID0gZG9tTm9kZTtcbn1cbmZ1bmN0aW9uIHVucmVnaXN0ZXJOb2RlKGRvbU5vZGUpIHtcbiAgICBkZWxldGUgcmVnaXN0ZXJlZERvbU5vZGVzW2RvbU5vZGUubm9kZUlkXTtcbn1cbmZ1bmN0aW9uIGdldE5vZGVCeUlkKGlkKSB7XG4gICAgcmV0dXJuIHJlZ2lzdGVyZWREb21Ob2Rlc1tpZF07XG59XG5leHBvcnRzLmdldE5vZGVCeUlkID0gZ2V0Tm9kZUJ5SWQ7XG52YXIgRE9NTm9kZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRE9NTm9kZSh2aWV3KSB7XG4gICAgICAgIHRoaXMubm9kZVZhbHVlID0gXCJcIjtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gW107XG4gICAgICAgIHRoaXMudmlld1JlZiA9IG5ldyBXZWFrUmVmKHZpZXcpO1xuICAgICAgICB0aGlzLm5vZGVUeXBlID0gdmlldy50eXBlTmFtZSA9PT0gXCJGcmFtZVwiID8gUk9PVF9OT0RFX1RZUEUgOiBFTEVNRU5UX05PREVfVFlQRTtcbiAgICAgICAgdGhpcy5ub2RlSWQgPSB2aWV3Ll9kb21JZDtcbiAgICAgICAgdGhpcy5ub2RlTmFtZSA9IHZpZXcudHlwZU5hbWU7XG4gICAgICAgIHRoaXMubG9jYWxOYW1lID0gdGhpcy5ub2RlTmFtZTtcbiAgICAgICAgdGhpcy5sb2FkQXR0cmlidXRlcygpO1xuICAgICAgICByZWdpc3Rlck5vZGUodGhpcyk7XG4gICAgfVxuICAgIERPTU5vZGUucHJvdG90eXBlLmxvYWRBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBbXTtcbiAgICAgICAgZ2V0U2V0UHJvcGVydGllc0xhenkoKSh0aGlzLnZpZXdSZWYuZ2V0KCkpXG4gICAgICAgICAgICAuZmlsdGVyKHByb3BlcnR5RmlsdGVyKVxuICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKHBhaXIpIHsgcmV0dXJuIF90aGlzLmF0dHJpYnV0ZXMucHVzaChwYWlyWzBdLCBwYWlyWzFdICsgXCJcIik7IH0pO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERPTU5vZGUucHJvdG90eXBlLCBcImNoaWxkcmVuXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZXMgPSBbXTtcbiAgICAgICAgICAgIHZpZXcuZWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgICAgIGNoaWxkLmVuc3VyZURvbU5vZGUoKTtcbiAgICAgICAgICAgICAgICByZXMucHVzaChjaGlsZC5kb21Ob2RlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRE9NTm9kZS5wcm90b3R5cGUub25DaGlsZEFkZGVkID0gZnVuY3Rpb24gKGNoaWxkVmlldykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBub3RpZnlJbnNwZWN0b3IoZnVuY3Rpb24gKGlucykge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSBfdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgdmFyIHByZXZpb3VzQ2hpbGQ7XG4gICAgICAgICAgICB2aWV3LmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGQgPT09IGNoaWxkVmlldykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByZXZpb3VzQ2hpbGQgPSBjaGlsZDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gISFwcmV2aW91c0NoaWxkID8gcHJldmlvdXNDaGlsZC5fZG9tSWQgOiAwO1xuICAgICAgICAgICAgY2hpbGRWaWV3LmVuc3VyZURvbU5vZGUoKTtcbiAgICAgICAgICAgIGlucy5jaGlsZE5vZGVJbnNlcnRlZChfdGhpcy5ub2RlSWQsIGluZGV4LCBjaGlsZFZpZXcuZG9tTm9kZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRE9NTm9kZS5wcm90b3R5cGUub25DaGlsZFJlbW92ZWQgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBub3RpZnlJbnNwZWN0b3IoZnVuY3Rpb24gKGlucykge1xuICAgICAgICAgICAgaW5zLmNoaWxkTm9kZVJlbW92ZWQoX3RoaXMubm9kZUlkLCB2aWV3Ll9kb21JZCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRE9NTm9kZS5wcm90b3R5cGUuYXR0cmlidXRlTW9kaWZpZWQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgbm90aWZ5SW5zcGVjdG9yKGZ1bmN0aW9uIChpbnMpIHtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eUJsYWNrbGlzdC5pbmRleE9mKG5hbWUpIDwgMCkge1xuICAgICAgICAgICAgICAgIGlucy5hdHRyaWJ1dGVNb2RpZmllZChfdGhpcy5ub2RlSWQsIG5hbWUsIHZhbHVlVG9TdHJpbmcodmFsdWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBET01Ob2RlLnByb3RvdHlwZS5hdHRyaWJ1dGVSZW1vdmVkID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgbm90aWZ5SW5zcGVjdG9yKGZ1bmN0aW9uIChpbnMpIHtcbiAgICAgICAgICAgIGlucy5hdHRyaWJ1dGVSZW1vdmVkKF90aGlzLm5vZGVJZCwgbmFtZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRE9NTm9kZS5wcm90b3R5cGUuZ2V0Q29tcHV0ZWRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdCA9IGdldENvbXB1dGVkQ3NzVmFsdWVzTGF6eSgpKHZpZXcpXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChwYWlyKSB7IHJldHVybiBwYWlyWzBdWzBdICE9PSBcIl9cIjsgfSlcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHBhaXIpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogcGFpclswXSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWVUb1N0cmluZyhwYWlyWzFdKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBET01Ob2RlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB1bnJlZ2lzdGVyTm9kZSh0aGlzKTtcbiAgICAgICAgdGhpcy52aWV3UmVmLmNsZWFyKCk7XG4gICAgfTtcbiAgICBET01Ob2RlLnByb3RvdHlwZS50b09iamVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5vZGVJZDogdGhpcy5ub2RlSWQsXG4gICAgICAgICAgICBub2RlVHlwZTogdGhpcy5ub2RlVHlwZSxcbiAgICAgICAgICAgIG5vZGVOYW1lOiB0aGlzLm5vZGVOYW1lLFxuICAgICAgICAgICAgbG9jYWxOYW1lOiB0aGlzLmxvY2FsTmFtZSxcbiAgICAgICAgICAgIG5vZGVWYWx1ZTogdGhpcy5ub2RlVmFsdWUsXG4gICAgICAgICAgICBjaGlsZHJlbjogdGhpcy5jaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGMpIHsgcmV0dXJuIGMudG9PYmplY3QoKTsgfSksXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB0aGlzLmF0dHJpYnV0ZXMsXG4gICAgICAgICAgICBiYWNrZW5kTm9kZUlkOiAwXG4gICAgICAgIH07XG4gICAgfTtcbiAgICByZXR1cm4gRE9NTm9kZTtcbn0oKSk7XG5leHBvcnRzLkRPTU5vZGUgPSBET01Ob2RlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZG9tLW5vZGUuanMubWFwIiwi77u/KGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBleHBvcnRzLlhNTEh0dHBSZXF1ZXN0ID0gZ2xvYmFsLlhNTEh0dHBSZXF1ZXN0O1xuICAgIGV4cG9ydHMuRm9ybURhdGEgPSBnbG9iYWwuRm9ybURhdGE7XG5cbiAgICBpZiAoIWV4cG9ydHMuWE1MSHR0cFJlcXVlc3QpIHtcbiAgICAgICAgdmFyIHhociA9IHJlcXVpcmUoXCJ4aHJcIik7XG4gICAgICAgIGV4cG9ydHMuWE1MSHR0cFJlcXVlc3QgPSB4aHIuWE1MSHR0cFJlcXVlc3Q7XG4gICAgICAgIGV4cG9ydHMuRm9ybURhdGEgPSB4aHIuRm9ybURhdGE7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbm9ybWFsaXplTmFtZShuYW1lKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9bXmEtejAtOVxcLSMkJSYnKisuXFxeX2B8fl0vaS50ZXN0KG5hbWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGNoYXJhY3RlciBpbiBoZWFkZXIgZmllbGQgbmFtZScpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5hbWUudG9Mb3dlckNhc2UoKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZVZhbHVlKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gSGVhZGVycyhoZWFkZXJzKSB7XG4gICAgICAgIHRoaXMubWFwID0ge31cblxuICAgICAgICBpZiAoaGVhZGVycyBpbnN0YW5jZW9mIEhlYWRlcnMpIHtcbiAgICAgICAgICAgIGhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIG5hbWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZChuYW1lLCB2YWx1ZSlcbiAgICAgICAgICAgIH0sIHRoaXMpXG5cbiAgICAgICAgfSBlbHNlIGlmIChoZWFkZXJzKSB7XG4gICAgICAgICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgaGVhZGVyc1tuYW1lXSlcbiAgICAgICAgICAgIH0sIHRoaXMpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBIZWFkZXJzLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgbmFtZSA9IG5vcm1hbGl6ZU5hbWUobmFtZSlcbiAgICAgICAgdmFsdWUgPSBub3JtYWxpemVWYWx1ZSh2YWx1ZSlcbiAgICAgICAgdmFyIGxpc3QgPSB0aGlzLm1hcFtuYW1lXVxuICAgICAgICBpZiAoIWxpc3QpIHtcbiAgICAgICAgICAgIGxpc3QgPSBbXVxuICAgICAgICAgICAgdGhpcy5tYXBbbmFtZV0gPSBsaXN0XG4gICAgICAgIH1cbiAgICAgICAgbGlzdC5wdXNoKHZhbHVlKVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlWydkZWxldGUnXSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXVxuICAgICAgICByZXR1cm4gdmFsdWVzID8gdmFsdWVzWzBdIDogbnVsbFxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLmdldEFsbCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSB8fCBbXVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShub3JtYWxpemVOYW1lKG5hbWUpKVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSA9IFtub3JtYWxpemVWYWx1ZSh2YWx1ZSldXG4gICAgfVxuXG4gICAgSGVhZGVycy5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzLm1hcCkuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgdGhpcy5tYXBbbmFtZV0uZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXNBcmcsIHZhbHVlLCBuYW1lLCB0aGlzKVxuICAgICAgICAgICAgfSwgdGhpcylcbiAgICAgICAgfSwgdGhpcylcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb25zdW1lZChib2R5KSB7XG4gICAgICAgIGlmIChib2R5LmJvZHlVc2VkKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcignQWxyZWFkeSByZWFkJykpXG4gICAgICAgIH1cbiAgICAgICAgYm9keS5ib2R5VXNlZCA9IHRydWVcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocmVhZGVyLnJlc3VsdClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJlamVjdChyZWFkZXIuZXJyb3IpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVhZEJsb2JBc0FycmF5QnVmZmVyKGJsb2IpIHtcbiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICAgICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGJsb2IpXG4gICAgICAgIHJldHVybiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlYWRCbG9iQXNUZXh0KGJsb2IpIHtcbiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoYmxvYilcbiAgICAgICAgcmV0dXJuIGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpXG4gICAgfVxuXG4gICAgdmFyIHN1cHBvcnQgPSB7XG4gICAgICAgIGJsb2I6ICdGaWxlUmVhZGVyJyBpbiBleHBvcnRzICYmICdCbG9iJyBpbiBleHBvcnRzICYmIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIG5ldyBCbG9iKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKSxcbiAgICAgICAgZm9ybURhdGE6ICdGb3JtRGF0YScgaW4gZXhwb3J0c1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIEJvZHkoKSB7XG4gICAgICAgIHRoaXMuYm9keVVzZWQgPSBmYWxzZVxuXG5cbiAgICAgICAgdGhpcy5faW5pdEJvZHkgPSBmdW5jdGlvbiAoYm9keSkge1xuICAgICAgICAgICAgdGhpcy5fYm9keUluaXQgPSBib2R5XG4gICAgICAgICAgICBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm9keVRleHQgPSBib2R5XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuYmxvYiAmJiBCbG9iLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm9keUJsb2IgPSBib2R5XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuZm9ybURhdGEgJiYgZXhwb3J0cy5Gb3JtRGF0YS5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JvZHlGb3JtRGF0YSA9IGJvZHlcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWJvZHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9ib2R5VGV4dCA9ICcnXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigndW5zdXBwb3J0ZWQgQm9keUluaXQgdHlwZScpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3VwcG9ydC5ibG9iKSB7XG4gICAgICAgICAgICB0aGlzLmJsb2IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgICAgICAgICAgICBpZiAocmVqZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdGVkXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keUJsb2IpXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5Rm9ybURhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgcmVhZCBGb3JtRGF0YSBib2R5IGFzIGJsb2InKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlUZXh0XSkpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmFycmF5QnVmZmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJsb2IoKS50aGVuKHJlYWRCbG9iQXNBcnJheUJ1ZmZlcilcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy50ZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgICAgICAgICAgICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3RlZFxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9ib2R5QmxvYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVhZEJsb2JBc1RleHQodGhpcy5fYm9keUJsb2IpXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5Rm9ybURhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgcmVhZCBGb3JtRGF0YSBib2R5IGFzIHRleHQnKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keVRleHQpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50ZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdGVkID8gcmVqZWN0ZWQgOiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keVRleHQpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3VwcG9ydC5mb3JtRGF0YSkge1xuICAgICAgICAgICAgdGhpcy5mb3JtRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihkZWNvZGUpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmpzb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihKU09OLnBhcnNlKVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG5cbiAgICAvLyBIVFRQIG1ldGhvZHMgd2hvc2UgY2FwaXRhbGl6YXRpb24gc2hvdWxkIGJlIG5vcm1hbGl6ZWRcbiAgICB2YXIgbWV0aG9kcyA9IFsnREVMRVRFJywgJ0dFVCcsICdIRUFEJywgJ09QVElPTlMnLCAnUE9TVCcsICdQVVQnXVxuXG4gICAgZnVuY3Rpb24gbm9ybWFsaXplTWV0aG9kKG1ldGhvZCkge1xuICAgICAgICB2YXIgdXBjYXNlZCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpXG4gICAgICAgIHJldHVybiAobWV0aG9kcy5pbmRleE9mKHVwY2FzZWQpID4gLTEpID8gdXBjYXNlZCA6IG1ldGhvZFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIFJlcXVlc3QodXJsLCBvcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9XG4gICAgICAgIHRoaXMudXJsID0gdXJsXG5cbiAgICAgICAgdGhpcy5jcmVkZW50aWFscyA9IG9wdGlvbnMuY3JlZGVudGlhbHMgfHwgJ29taXQnXG4gICAgICAgIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycylcbiAgICAgICAgdGhpcy5tZXRob2QgPSBub3JtYWxpemVNZXRob2Qob3B0aW9ucy5tZXRob2QgfHwgJ0dFVCcpXG4gICAgICAgIHRoaXMubW9kZSA9IG9wdGlvbnMubW9kZSB8fCBudWxsXG4gICAgICAgIHRoaXMucmVmZXJyZXIgPSBudWxsXG5cbiAgICAgICAgaWYgKCh0aGlzLm1ldGhvZCA9PT0gJ0dFVCcgfHwgdGhpcy5tZXRob2QgPT09ICdIRUFEJykgJiYgb3B0aW9ucy5ib2R5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdCb2R5IG5vdCBhbGxvd2VkIGZvciBHRVQgb3IgSEVBRCByZXF1ZXN0cycpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faW5pdEJvZHkob3B0aW9ucy5ib2R5KVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlY29kZShib2R5KSB7XG4gICAgICAgIHZhciBmb3JtID0gbmV3IGV4cG9ydHMuRm9ybURhdGEoKVxuICAgICAgICBib2R5LnRyaW0oKS5zcGxpdCgnJicpLmZvckVhY2goZnVuY3Rpb24gKGJ5dGVzKSB7XG4gICAgICAgICAgICBpZiAoYnl0ZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3BsaXQgPSBieXRlcy5zcGxpdCgnPScpXG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBzcGxpdC5zaGlmdCgpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gc3BsaXQuam9pbignPScpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgICAgICAgICAgZm9ybS5hcHBlbmQoZGVjb2RlVVJJQ29tcG9uZW50KG5hbWUpLCBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gZm9ybVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhlYWRlcnMoeGhyKSB7XG4gICAgICAgIHZhciBoZWFkID0gbmV3IEhlYWRlcnMoKVxuICAgICAgICB2YXIgcGFpcnMgPSB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkudHJpbSgpLnNwbGl0KCdcXG4nKVxuICAgICAgICBwYWlycy5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgICAgICAgIHZhciBzcGxpdCA9IGhlYWRlci50cmltKCkuc3BsaXQoJzonKVxuICAgICAgICAgICAgdmFyIGtleSA9IHNwbGl0LnNoaWZ0KCkudHJpbSgpXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBzcGxpdC5qb2luKCc6JykudHJpbSgpXG4gICAgICAgICAgICBoZWFkLmFwcGVuZChrZXksIHZhbHVlKVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gaGVhZFxuICAgIH1cblxuICAgIEJvZHkuY2FsbChSZXF1ZXN0LnByb3RvdHlwZSlcblxuICAgIGZ1bmN0aW9uIFJlc3BvbnNlKGJvZHlJbml0LCBvcHRpb25zKSB7XG4gICAgICAgIGlmICghb3B0aW9ucykge1xuICAgICAgICAgICAgb3B0aW9ucyA9IHt9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9pbml0Qm9keShib2R5SW5pdClcbiAgICAgICAgdGhpcy50eXBlID0gJ2RlZmF1bHQnXG4gICAgICAgIHRoaXMudXJsID0gbnVsbFxuICAgICAgICB0aGlzLnN0YXR1cyA9IG9wdGlvbnMuc3RhdHVzXG4gICAgICAgIHRoaXMub2sgPSB0aGlzLnN0YXR1cyA+PSAyMDAgJiYgdGhpcy5zdGF0dXMgPCAzMDBcbiAgICAgICAgdGhpcy5zdGF0dXNUZXh0ID0gb3B0aW9ucy5zdGF0dXNUZXh0XG4gICAgICAgIHRoaXMuaGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycyBpbnN0YW5jZW9mIEhlYWRlcnMgPyBvcHRpb25zLmhlYWRlcnMgOiBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpXG4gICAgICAgIHRoaXMudXJsID0gb3B0aW9ucy51cmwgfHwgJydcbiAgICB9XG5cbiAgICBCb2R5LmNhbGwoUmVzcG9uc2UucHJvdG90eXBlKVxuXG4gICAgZXhwb3J0cy5IZWFkZXJzID0gSGVhZGVycztcbiAgICBleHBvcnRzLlJlcXVlc3QgPSBSZXF1ZXN0O1xuICAgIGV4cG9ydHMuUmVzcG9uc2UgPSBSZXNwb25zZTtcblxuICAgIGV4cG9ydHMuZmV0Y2ggPSBmdW5jdGlvbiAoaW5wdXQsIGluaXQpIHtcbiAgICAgICAgLy8gVE9ETzogUmVxdWVzdCBjb25zdHJ1Y3RvciBzaG91bGQgYWNjZXB0IGlucHV0LCBpbml0XG4gICAgICAgIHZhciByZXF1ZXN0XG4gICAgICAgIGlmIChSZXF1ZXN0LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGlucHV0KSAmJiAhaW5pdCkge1xuICAgICAgICAgICAgcmVxdWVzdCA9IGlucHV0XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXF1ZXN0ID0gbmV3IFJlcXVlc3QoaW5wdXQsIGluaXQpXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIHhociA9IG5ldyBleHBvcnRzLlhNTEh0dHBSZXF1ZXN0KClcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmVzcG9uc2VVUkwoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCdyZXNwb25zZVVSTCcgaW4geGhyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4aHIucmVzcG9uc2VVUkxcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBdm9pZCBzZWN1cml0eSB3YXJuaW5ncyBvbiBnZXRSZXNwb25zZUhlYWRlciB3aGVuIG5vdCBhbGxvd2VkIGJ5IENPUlNcbiAgICAgICAgICAgICAgICBpZiAoL15YLVJlcXVlc3QtVVJMOi9tLnRlc3QoeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geGhyLmdldFJlc3BvbnNlSGVhZGVyKCdYLVJlcXVlc3QtVVJMJylcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9ICh4aHIuc3RhdHVzID09PSAxMjIzKSA/IDIwNCA6IHhoci5zdGF0dXNcbiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzIDwgMTAwIHx8IHN0YXR1cyA+IDU5OSkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcignTmV0d29yayByZXF1ZXN0IGZhaWxlZCcpKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OiB4aHIuc3RhdHVzVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyh4aHIpLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHJlc3BvbnNlVVJMKClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy92YXIgYm9keSA9ICdyZXNwb25zZScgaW4geGhyID8geGhyLnJlc3BvbnNlIDogeGhyLnJlc3BvbnNlVGV4dDtcbiAgICAgICAgICAgICAgICByZXNvbHZlKG5ldyBSZXNwb25zZSh4aHIucmVzcG9uc2VUZXh0LCBvcHRpb25zKSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcihbJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZV0uam9pbignICcpKSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgeGhyLm9wZW4ocmVxdWVzdC5tZXRob2QsIHJlcXVlc3QudXJsLCB0cnVlKVxuXG4gICAgICAgICAgICBpZiAocmVxdWVzdC5jcmVkZW50aWFscyA9PT0gJ2luY2x1ZGUnKSB7XG4gICAgICAgICAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWVcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCdyZXNwb25zZVR5cGUnIGluIHhociAmJiBzdXBwb3J0LmJsb2IpIHtcbiAgICAgICAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlcXVlc3QuaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgbmFtZSkge1xuICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgeGhyLnNlbmQodHlwZW9mIHJlcXVlc3QuX2JvZHlJbml0ID09PSAndW5kZWZpbmVkJyA/IG51bGwgOiByZXF1ZXN0Ll9ib2R5SW5pdClcbiAgICAgICAgfSlcbiAgICB9XG4gICAgZXhwb3J0cy5mZXRjaC5wb2x5ZmlsbCA9IHRydWVcblxufSkoKTsiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdGV4dE1vZHVsZSA9IHJlcXVpcmUoXCIuLi90ZXh0XCIpO1xudmFyIGFwcGxpY2F0aW9uXzEgPSByZXF1aXJlKFwiLi4vYXBwbGljYXRpb25cIik7XG52YXIgYXBwbGljYXRpb25Db250ZXh0O1xuZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25Db250ZXh0KCkge1xuICAgIGlmICghYXBwbGljYXRpb25Db250ZXh0KSB7XG4gICAgICAgIGFwcGxpY2F0aW9uQ29udGV4dCA9IGFwcGxpY2F0aW9uXzEuZ2V0TmF0aXZlQXBwbGljYXRpb24oKS5nZXRBcHBsaWNhdGlvbkNvbnRleHQoKTtcbiAgICB9XG4gICAgcmV0dXJuIGFwcGxpY2F0aW9uQ29udGV4dDtcbn1cbnZhciBGaWxlU3lzdGVtQWNjZXNzID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGaWxlU3lzdGVtQWNjZXNzKCkge1xuICAgICAgICB0aGlzLl9wYXRoU2VwYXJhdG9yID0gXCIvXCI7XG4gICAgfVxuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldExhc3RNb2RpZmllZCA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBqYXZhRmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUocGF0aCk7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShqYXZhRmlsZS5sYXN0TW9kaWZpZWQoKSk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRGaWxlU2l6ZSA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBqYXZhRmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUocGF0aCk7XG4gICAgICAgIHJldHVybiBqYXZhRmlsZS5sZW5ndGgoKTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldFBhcmVudCA9IGZ1bmN0aW9uIChwYXRoLCBvbkVycm9yKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgamF2YUZpbGUgPSBuZXcgamF2YS5pby5GaWxlKHBhdGgpO1xuICAgICAgICAgICAgdmFyIHBhcmVudF8xID0gamF2YUZpbGUuZ2V0UGFyZW50RmlsZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHsgcGF0aDogcGFyZW50XzEuZ2V0QWJzb2x1dGVQYXRoKCksIG5hbWU6IHBhcmVudF8xLmdldE5hbWUoKSB9O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleGNlcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihleGNlcHRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0RmlsZSA9IGZ1bmN0aW9uIChwYXRoLCBvbkVycm9yKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVuc3VyZUZpbGUobmV3IGphdmEuaW8uRmlsZShwYXRoKSwgZmFsc2UsIG9uRXJyb3IpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0Rm9sZGVyID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdmFyIGphdmFGaWxlID0gbmV3IGphdmEuaW8uRmlsZShwYXRoKTtcbiAgICAgICAgdmFyIGRpckluZm8gPSB0aGlzLmVuc3VyZUZpbGUoamF2YUZpbGUsIHRydWUsIG9uRXJyb3IpO1xuICAgICAgICBpZiAoIWRpckluZm8pIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgcGF0aDogZGlySW5mby5wYXRoLCBuYW1lOiBkaXJJbmZvLm5hbWUgfTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmVhY2hFbnRpdHkgPSBmdW5jdGlvbiAocGF0aCwgb25FbnRpdHksIG9uRXJyb3IpIHtcbiAgICAgICAgaWYgKCFvbkVudGl0eSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW51bUVudGl0aWVzKHBhdGgsIG9uRW50aXR5LCBvbkVycm9yKTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldEVudGl0aWVzID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdmFyIGZpbGVJbmZvcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB2YXIgb25FbnRpdHkgPSBmdW5jdGlvbiAoZW50aXR5KSB7XG4gICAgICAgICAgICBmaWxlSW5mb3MucHVzaChlbnRpdHkpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBlcnJvck9jY3VycmVkO1xuICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVycm9yT2NjdXJyZWQgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmVudW1FbnRpdGllcyhwYXRoLCBvbkVudGl0eSwgbG9jYWxFcnJvcik7XG4gICAgICAgIGlmICghZXJyb3JPY2N1cnJlZCkge1xuICAgICAgICAgICAgcmV0dXJuIGZpbGVJbmZvcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmZpbGVFeGlzdHMgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgZmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUocGF0aCk7XG4gICAgICAgIHJldHVybiBmaWxlLmV4aXN0cygpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZm9sZGVyRXhpc3RzID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIGZpbGUgPSBuZXcgamF2YS5pby5GaWxlKHBhdGgpO1xuICAgICAgICByZXR1cm4gZmlsZS5leGlzdHMoKSAmJiBmaWxlLmlzRGlyZWN0b3J5KCk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5kZWxldGVGaWxlID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBqYXZhRmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUocGF0aCk7XG4gICAgICAgICAgICBpZiAoIWphdmFGaWxlLmlzRmlsZSgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcih7IG1lc3NhZ2U6IFwiVGhlIHNwZWNpZmllZCBwYXJhbWV0ZXIgaXMgbm90IGEgRmlsZSBlbnRpdHkuXCIgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghamF2YUZpbGUuZGVsZXRlKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKHsgbWVzc2FnZTogXCJGaWxlIGRlbGV0aW9uIGZhaWxlZFwiIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXhjZXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXhjZXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZGVsZXRlRm9sZGVyID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBqYXZhRmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUocGF0aCk7XG4gICAgICAgICAgICBpZiAoIWphdmFGaWxlLmdldENhbm9uaWNhbEZpbGUoKS5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcih7IG1lc3NhZ2U6IFwiVGhlIHNwZWNpZmllZCBwYXJhbWV0ZXIgaXMgbm90IGEgRm9sZGVyIGVudGl0eS5cIiB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5kZWxldGVGb2xkZXJDb250ZW50KGphdmFGaWxlKTtcbiAgICAgICAgICAgIGlmICghamF2YUZpbGUuZGVsZXRlKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKHsgbWVzc2FnZTogXCJGb2xkZXIgZGVsZXRpb24gZmFpbGVkLlwiIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXhjZXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXhjZXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZW1wdHlGb2xkZXIgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGphdmFGaWxlID0gbmV3IGphdmEuaW8uRmlsZShwYXRoKTtcbiAgICAgICAgICAgIGlmICghamF2YUZpbGUuZ2V0Q2Fub25pY2FsRmlsZSgpLmlzRGlyZWN0b3J5KCkpIHtcbiAgICAgICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKHsgbWVzc2FnZTogXCJUaGUgc3BlY2lmaWVkIHBhcmFtZXRlciBpcyBub3QgYSBGb2xkZXIgZW50aXR5LlwiIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRlbGV0ZUZvbGRlckNvbnRlbnQoamF2YUZpbGUpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleGNlcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihleGNlcHRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5yZW5hbWUgPSBmdW5jdGlvbiAocGF0aCwgbmV3UGF0aCwgb25FcnJvcikge1xuICAgICAgICB2YXIgamF2YUZpbGUgPSBuZXcgamF2YS5pby5GaWxlKHBhdGgpO1xuICAgICAgICBpZiAoIWphdmFGaWxlLmV4aXN0cygpKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiVGhlIGZpbGUgdG8gcmVuYW1lIGRvZXMgbm90IGV4aXN0XCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3RmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUobmV3UGF0aCk7XG4gICAgICAgIGlmIChuZXdGaWxlLmV4aXN0cygpKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiQSBmaWxlIHdpdGggdGhlIHNhbWUgbmFtZSBhbHJlYWR5IGV4aXN0cy5cIikpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghamF2YUZpbGUucmVuYW1lVG8obmV3RmlsZSkpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcmVuYW1lIGZpbGUgJ1wiICsgcGF0aCArIFwiJyB0byAnXCIgKyBuZXdQYXRoICsgXCInXCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0RG9jdW1lbnRzRm9sZGVyUGF0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRpciA9IGdldEFwcGxpY2F0aW9uQ29udGV4dCgpLmdldEZpbGVzRGlyKCk7XG4gICAgICAgIHJldHVybiBkaXIuZ2V0QWJzb2x1dGVQYXRoKCk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRMb2dpY2FsUm9vdFBhdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBkaXIgPSBnZXRBcHBsaWNhdGlvbkNvbnRleHQoKS5nZXRGaWxlc0RpcigpO1xuICAgICAgICByZXR1cm4gZGlyLmdldENhbm9uaWNhbFBhdGgoKTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldFRlbXBGb2xkZXJQYXRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGlyID0gZ2V0QXBwbGljYXRpb25Db250ZXh0KCkuZ2V0Q2FjaGVEaXIoKTtcbiAgICAgICAgcmV0dXJuIGRpci5nZXRBYnNvbHV0ZVBhdGgoKTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldEN1cnJlbnRBcHBQYXRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRMb2dpY2FsUm9vdFBhdGgoKSArIFwiL2FwcFwiO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUucmVhZCA9IGZ1bmN0aW9uIChwYXRoLCBvbkVycm9yKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgamF2YUZpbGUgPSBuZXcgamF2YS5pby5GaWxlKHBhdGgpO1xuICAgICAgICAgICAgdmFyIHN0cmVhbSA9IG5ldyBqYXZhLmlvLkZpbGVJbnB1dFN0cmVhbShqYXZhRmlsZSk7XG4gICAgICAgICAgICB2YXIgYnl0ZXMgPSBBcnJheS5jcmVhdGUoXCJieXRlXCIsIGphdmFGaWxlLmxlbmd0aCgpKTtcbiAgICAgICAgICAgIHZhciBkYXRhSW5wdXRTdHJlYW0gPSBuZXcgamF2YS5pby5EYXRhSW5wdXRTdHJlYW0oc3RyZWFtKTtcbiAgICAgICAgICAgIGRhdGFJbnB1dFN0cmVhbS5yZWFkRnVsbHkoYnl0ZXMpO1xuICAgICAgICAgICAgcmV0dXJuIGJ5dGVzO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleGNlcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihleGNlcHRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChwYXRoLCBieXRlcywgb25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGphdmFGaWxlID0gbmV3IGphdmEuaW8uRmlsZShwYXRoKTtcbiAgICAgICAgICAgIHZhciBzdHJlYW0gPSBuZXcgamF2YS5pby5GaWxlT3V0cHV0U3RyZWFtKGphdmFGaWxlKTtcbiAgICAgICAgICAgIHN0cmVhbS53cml0ZShieXRlcywgMCwgYnl0ZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIHN0cmVhbS5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleGNlcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihleGNlcHRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5yZWFkVGV4dCA9IGZ1bmN0aW9uIChwYXRoLCBvbkVycm9yLCBlbmNvZGluZykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGphdmFGaWxlID0gbmV3IGphdmEuaW8uRmlsZShwYXRoKTtcbiAgICAgICAgICAgIHZhciBzdHJlYW0gPSBuZXcgamF2YS5pby5GaWxlSW5wdXRTdHJlYW0oamF2YUZpbGUpO1xuICAgICAgICAgICAgdmFyIGFjdHVhbEVuY29kaW5nID0gZW5jb2Rpbmc7XG4gICAgICAgICAgICBpZiAoIWFjdHVhbEVuY29kaW5nKSB7XG4gICAgICAgICAgICAgICAgYWN0dWFsRW5jb2RpbmcgPSB0ZXh0TW9kdWxlLmVuY29kaW5nLlVURl84O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBqYXZhLmlvLklucHV0U3RyZWFtUmVhZGVyKHN0cmVhbSwgYWN0dWFsRW5jb2RpbmcpO1xuICAgICAgICAgICAgdmFyIGJ1ZmZlcmVkUmVhZGVyID0gbmV3IGphdmEuaW8uQnVmZmVyZWRSZWFkZXIocmVhZGVyKTtcbiAgICAgICAgICAgIHZhciBsaW5lID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFwiXCI7XG4gICAgICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgICAgIGxpbmUgPSBidWZmZXJlZFJlYWRlci5yZWFkTGluZSgpO1xuICAgICAgICAgICAgICAgIGlmIChsaW5lID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IFwiXFxuXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlc3VsdCArPSBsaW5lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFjdHVhbEVuY29kaW5nID09PSB0ZXh0TW9kdWxlLmVuY29kaW5nLlVURl84KSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gRmlsZVN5c3RlbUFjY2Vzcy5fcmVtb3ZlVXRmOEJvbShyZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnVmZmVyZWRSZWFkZXIuY2xvc2UoKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4Y2VwdGlvbikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGV4Y2VwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MuX3JlbW92ZVV0ZjhCb20gPSBmdW5jdGlvbiAocykge1xuICAgICAgICBpZiAocy5jaGFyQ29kZUF0KDApID09PSAweEZFRkYpIHtcbiAgICAgICAgICAgIHMgPSBzLnNsaWNlKDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUud3JpdGVUZXh0ID0gZnVuY3Rpb24gKHBhdGgsIGNvbnRlbnQsIG9uRXJyb3IsIGVuY29kaW5nKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgamF2YUZpbGUgPSBuZXcgamF2YS5pby5GaWxlKHBhdGgpO1xuICAgICAgICAgICAgdmFyIHN0cmVhbSA9IG5ldyBqYXZhLmlvLkZpbGVPdXRwdXRTdHJlYW0oamF2YUZpbGUpO1xuICAgICAgICAgICAgdmFyIGFjdHVhbEVuY29kaW5nID0gZW5jb2Rpbmc7XG4gICAgICAgICAgICBpZiAoIWFjdHVhbEVuY29kaW5nKSB7XG4gICAgICAgICAgICAgICAgYWN0dWFsRW5jb2RpbmcgPSB0ZXh0TW9kdWxlLmVuY29kaW5nLlVURl84O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHdyaXRlciA9IG5ldyBqYXZhLmlvLk91dHB1dFN0cmVhbVdyaXRlcihzdHJlYW0sIGFjdHVhbEVuY29kaW5nKTtcbiAgICAgICAgICAgIHdyaXRlci53cml0ZShjb250ZW50KTtcbiAgICAgICAgICAgIHdyaXRlci5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleGNlcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihleGNlcHRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5kZWxldGVGb2xkZXJDb250ZW50ID0gZnVuY3Rpb24gKGZpbGUpIHtcbiAgICAgICAgdmFyIGZpbGVzTGlzdCA9IGZpbGUubGlzdEZpbGVzKCk7XG4gICAgICAgIGlmIChmaWxlc0xpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hpbGRGaWxlO1xuICAgICAgICB2YXIgc3VjY2VzcyA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbGVzTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY2hpbGRGaWxlID0gZmlsZXNMaXN0W2ldO1xuICAgICAgICAgICAgaWYgKGNoaWxkRmlsZS5nZXRDYW5vbmljYWxGaWxlKCkuaXNEaXJlY3RvcnkoKSkge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSB0aGlzLmRlbGV0ZUZvbGRlckNvbnRlbnQoY2hpbGRGaWxlKTtcbiAgICAgICAgICAgICAgICBpZiAoIXN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3VjY2VzcyA9IGNoaWxkRmlsZS5kZWxldGUoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VjY2VzcztcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmVuc3VyZUZpbGUgPSBmdW5jdGlvbiAoamF2YUZpbGUsIGlzRm9sZGVyLCBvbkVycm9yKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIWphdmFGaWxlLmV4aXN0cygpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNyZWF0ZWQgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgaWYgKGlzRm9sZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQgPSBqYXZhRmlsZS5ta2RpcnMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGphdmFGaWxlLmdldFBhcmVudEZpbGUoKS5ta2RpcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZCA9IGphdmFGaWxlLmNyZWF0ZU5ld0ZpbGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFjcmVhdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBuZXcgamF2YSBGaWxlIGZvciBwYXRoIFwiICsgamF2YUZpbGUuZ2V0QWJzb2x1dGVQYXRoKCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBqYXZhRmlsZS5zZXRSZWFkYWJsZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgamF2YUZpbGUuc2V0V3JpdGFibGUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHBhdGggPSBqYXZhRmlsZS5nZXRBYnNvbHV0ZVBhdGgoKTtcbiAgICAgICAgICAgIHJldHVybiB7IHBhdGg6IHBhdGgsIG5hbWU6IGphdmFGaWxlLmdldE5hbWUoKSwgZXh0ZW5zaW9uOiB0aGlzLmdldEZpbGVFeHRlbnNpb24ocGF0aCkgfTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXhjZXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXhjZXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldEZpbGVFeHRlbnNpb24gPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgZG90SW5kZXggPSBwYXRoLmxhc3RJbmRleE9mKFwiLlwiKTtcbiAgICAgICAgaWYgKGRvdEluZGV4ICYmIGRvdEluZGV4ID49IDAgJiYgZG90SW5kZXggPCBwYXRoLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHBhdGguc3Vic3RyaW5nKGRvdEluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmVudW1FbnRpdGllcyA9IGZ1bmN0aW9uIChwYXRoLCBjYWxsYmFjaywgb25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGphdmFGaWxlID0gbmV3IGphdmEuaW8uRmlsZShwYXRoKTtcbiAgICAgICAgICAgIGlmICghamF2YUZpbGUuZ2V0Q2Fub25pY2FsRmlsZSgpLmlzRGlyZWN0b3J5KCkpIHtcbiAgICAgICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKFwiVGhlcmUgaXMgbm8gZm9sZGVyIGV4aXN0aW5nIGF0IHBhdGggXCIgKyBwYXRoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZpbGVzTGlzdCA9IGphdmFGaWxlLmxpc3RGaWxlcygpO1xuICAgICAgICAgICAgdmFyIGxlbmd0aF8xID0gZmlsZXNMaXN0Lmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBpbmZvID0gdm9pZCAwO1xuICAgICAgICAgICAgdmFyIHJldFZhbCA9IHZvaWQgMDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICAgICAgICAgIGphdmFGaWxlID0gZmlsZXNMaXN0W2ldO1xuICAgICAgICAgICAgICAgIGluZm8gPSB7XG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IGphdmFGaWxlLmdldEFic29sdXRlUGF0aCgpLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBqYXZhRmlsZS5nZXROYW1lKClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChqYXZhRmlsZS5pc0ZpbGUoKSkge1xuICAgICAgICAgICAgICAgICAgICBpbmZvLmV4dGVuc2lvbiA9IHRoaXMuZ2V0RmlsZUV4dGVuc2lvbihpbmZvLnBhdGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXRWYWwgPSBjYWxsYmFjayhpbmZvKTtcbiAgICAgICAgICAgICAgICBpZiAocmV0VmFsID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4Y2VwdGlvbikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGV4Y2VwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldFBhdGhTZXBhcmF0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYXRoU2VwYXJhdG9yO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUubm9ybWFsaXplUGF0aCA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBmaWxlID0gbmV3IGphdmEuaW8uRmlsZShwYXRoKTtcbiAgICAgICAgcmV0dXJuIGZpbGUuZ2V0QWJzb2x1dGVQYXRoKCk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5qb2luUGF0aCA9IGZ1bmN0aW9uIChsZWZ0LCByaWdodCkge1xuICAgICAgICB2YXIgZmlsZTEgPSBuZXcgamF2YS5pby5GaWxlKGxlZnQpO1xuICAgICAgICB2YXIgZmlsZTIgPSBuZXcgamF2YS5pby5GaWxlKGZpbGUxLCByaWdodCk7XG4gICAgICAgIHJldHVybiBmaWxlMi5nZXRQYXRoKCk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5qb2luUGF0aHMgPSBmdW5jdGlvbiAocGF0aHMpIHtcbiAgICAgICAgaWYgKCFwYXRocyB8fCBwYXRocy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXRocy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXRoc1swXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0ID0gcGF0aHNbMF07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgcGF0aHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuam9pblBhdGgocmVzdWx0LCBwYXRoc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIHJldHVybiBGaWxlU3lzdGVtQWNjZXNzO1xufSgpKTtcbmV4cG9ydHMuRmlsZVN5c3RlbUFjY2VzcyA9IEZpbGVTeXN0ZW1BY2Nlc3M7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1maWxlLXN5c3RlbS1hY2Nlc3MuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZmlsZV9zeXN0ZW1fYWNjZXNzXzEgPSByZXF1aXJlKFwiLi9maWxlLXN5c3RlbS1hY2Nlc3NcIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vcHJvZmlsaW5nXCIpO1xudmFyIGZpbGVBY2Nlc3M7XG5mdW5jdGlvbiBnZXRGaWxlQWNjZXNzKCkge1xuICAgIGlmICghZmlsZUFjY2Vzcykge1xuICAgICAgICBmaWxlQWNjZXNzID0gbmV3IGZpbGVfc3lzdGVtX2FjY2Vzc18xLkZpbGVTeXN0ZW1BY2Nlc3MoKTtcbiAgICB9XG4gICAgcmV0dXJuIGZpbGVBY2Nlc3M7XG59XG52YXIgcGxhdGZvcm07XG5mdW5jdGlvbiBlbnN1cmVQbGF0Zm9ybSgpIHtcbiAgICBpZiAoIXBsYXRmb3JtKSB7XG4gICAgICAgIHBsYXRmb3JtID0gcmVxdWlyZShcIi4uL3BsYXRmb3JtXCIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZUZpbGUoaW5mbykge1xuICAgIHZhciBmaWxlID0gbmV3IEZpbGUoKTtcbiAgICBmaWxlLl9wYXRoID0gaW5mby5wYXRoO1xuICAgIGZpbGUuX25hbWUgPSBpbmZvLm5hbWU7XG4gICAgZmlsZS5fZXh0ZW5zaW9uID0gaW5mby5leHRlbnNpb247XG4gICAgcmV0dXJuIGZpbGU7XG59XG5mdW5jdGlvbiBjcmVhdGVGb2xkZXIoaW5mbykge1xuICAgIHZhciBkb2N1bWVudHMgPSBrbm93bkZvbGRlcnMuZG9jdW1lbnRzKCk7XG4gICAgaWYgKGluZm8ucGF0aCA9PT0gZG9jdW1lbnRzLnBhdGgpIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50cztcbiAgICB9XG4gICAgdmFyIHRlbXAgPSBrbm93bkZvbGRlcnMudGVtcCgpO1xuICAgIGlmIChpbmZvLnBhdGggPT09IHRlbXAucGF0aCkge1xuICAgICAgICByZXR1cm4gdGVtcDtcbiAgICB9XG4gICAgdmFyIGZvbGRlciA9IG5ldyBGb2xkZXIoKTtcbiAgICBmb2xkZXIuX3BhdGggPSBpbmZvLnBhdGg7XG4gICAgZm9sZGVyLl9uYW1lID0gaW5mby5uYW1lO1xuICAgIHJldHVybiBmb2xkZXI7XG59XG52YXIgRmlsZVN5c3RlbUVudGl0eSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRmlsZVN5c3RlbUVudGl0eSgpIHtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbGVTeXN0ZW1FbnRpdHkucHJvdG90eXBlLCBcInBhcmVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgZm9sZGVySW5mbyA9IGdldEZpbGVBY2Nlc3MoKS5nZXRQYXJlbnQodGhpcy5wYXRoLCBvbkVycm9yKTtcbiAgICAgICAgICAgIGlmICghZm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlRm9sZGVyKGZvbGRlckluZm8pO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGaWxlU3lzdGVtRW50aXR5LnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgaGFzRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBsb2NhbEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaGFzRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgX3RoaXMucmVtb3ZlU3luYyhsb2NhbEVycm9yKTtcbiAgICAgICAgICAgIGlmICghaGFzRXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUVudGl0eS5wcm90b3R5cGUucmVtb3ZlU3luYyA9IGZ1bmN0aW9uIChvbkVycm9yKSB7XG4gICAgICAgIGlmICh0aGlzLl9pc0tub3duKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoeyBtZXNzYWdlOiBcIkNhbm5vdCBkZWxldGUga25vd24gZm9sZGVyLlwiIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmaWxlQWNjZXNzID0gZ2V0RmlsZUFjY2VzcygpO1xuICAgICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIEZpbGUpIHtcbiAgICAgICAgICAgIGZpbGVBY2Nlc3MuZGVsZXRlRmlsZSh0aGlzLnBhdGgsIG9uRXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMgaW5zdGFuY2VvZiBGb2xkZXIpIHtcbiAgICAgICAgICAgIGZpbGVBY2Nlc3MuZGVsZXRlRm9sZGVyKHRoaXMucGF0aCwgb25FcnJvcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1FbnRpdHkucHJvdG90eXBlLnJlbmFtZSA9IGZ1bmN0aW9uIChuZXdOYW1lKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgaGFzRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBsb2NhbEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaGFzRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgX3RoaXMucmVuYW1lU3luYyhuZXdOYW1lLCBsb2NhbEVycm9yKTtcbiAgICAgICAgICAgIGlmICghaGFzRXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUVudGl0eS5wcm90b3R5cGUucmVuYW1lU3luYyA9IGZ1bmN0aW9uIChuZXdOYW1lLCBvbkVycm9yKSB7XG4gICAgICAgIGlmICh0aGlzLl9pc0tub3duKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiQ2Fubm90IHJlbmFtZSBrbm93biBmb2xkZXIuXCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyZW50Rm9sZGVyID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmICghcGFyZW50Rm9sZGVyKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiTm8gcGFyZW50IGZvbGRlci5cIikpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmaWxlQWNjZXNzID0gZ2V0RmlsZUFjY2VzcygpO1xuICAgICAgICB2YXIgcGF0aCA9IHBhcmVudEZvbGRlci5wYXRoO1xuICAgICAgICB2YXIgbmV3UGF0aCA9IGZpbGVBY2Nlc3Muam9pblBhdGgocGF0aCwgbmV3TmFtZSk7XG4gICAgICAgIHZhciBsb2NhbEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIGZpbGVBY2Nlc3MucmVuYW1lKHRoaXMucGF0aCwgbmV3UGF0aCwgbG9jYWxFcnJvcik7XG4gICAgICAgIHRoaXMuX3BhdGggPSBuZXdQYXRoO1xuICAgICAgICB0aGlzLl9uYW1lID0gbmV3TmFtZTtcbiAgICAgICAgaWYgKHRoaXMgaW5zdGFuY2VvZiBGaWxlKSB7XG4gICAgICAgICAgICB0aGlzLl9leHRlbnNpb24gPSBmaWxlQWNjZXNzLmdldEZpbGVFeHRlbnNpb24obmV3UGF0aCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaWxlU3lzdGVtRW50aXR5LnByb3RvdHlwZSwgXCJuYW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbmFtZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbGVTeXN0ZW1FbnRpdHkucHJvdG90eXBlLCBcInBhdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wYXRoO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlsZVN5c3RlbUVudGl0eS5wcm90b3R5cGUsIFwibGFzdE1vZGlmaWVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLl9sYXN0TW9kaWZpZWQ7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2xhc3RNb2RpZmllZCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5fbGFzdE1vZGlmaWVkID0gZ2V0RmlsZUFjY2VzcygpLmdldExhc3RNb2RpZmllZCh0aGlzLnBhdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gRmlsZVN5c3RlbUVudGl0eTtcbn0oKSk7XG5leHBvcnRzLkZpbGVTeXN0ZW1FbnRpdHkgPSBGaWxlU3lzdGVtRW50aXR5O1xudmFyIEZpbGUgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGaWxlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZpbGUoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgRmlsZS5mcm9tUGF0aCA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGZpbGVJbmZvID0gZ2V0RmlsZUFjY2VzcygpLmdldEZpbGUocGF0aCwgb25FcnJvcik7XG4gICAgICAgIGlmICghZmlsZUluZm8pIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyZWF0ZUZpbGUoZmlsZUluZm8pO1xuICAgIH07XG4gICAgRmlsZS5leGlzdHMgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICByZXR1cm4gZ2V0RmlsZUFjY2VzcygpLmZpbGVFeGlzdHMocGF0aCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlsZS5wcm90b3R5cGUsIFwiZXh0ZW5zaW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZXh0ZW5zaW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlsZS5wcm90b3R5cGUsIFwiaXNMb2NrZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAhIXRoaXMuX2xvY2tlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbGUucHJvdG90eXBlLCBcInNpemVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRGaWxlQWNjZXNzKCkuZ2V0RmlsZVNpemUodGhpcy5wYXRoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRmlsZS5wcm90b3R5cGUucmVhZFN5bmMgPSBmdW5jdGlvbiAob25FcnJvcikge1xuICAgICAgICB0aGlzLmNoZWNrQWNjZXNzKCk7XG4gICAgICAgIHRoaXMuX2xvY2tlZCA9IHRydWU7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoYXQuX2xvY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSBnZXRGaWxlQWNjZXNzKCkucmVhZCh0aGlzLnBhdGgsIGxvY2FsRXJyb3IpO1xuICAgICAgICB0aGlzLl9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfTtcbiAgICBGaWxlLnByb3RvdHlwZS53cml0ZVN5bmMgPSBmdW5jdGlvbiAoY29udGVudCwgb25FcnJvcikge1xuICAgICAgICB0aGlzLmNoZWNrQWNjZXNzKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLl9sb2NrZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHRoYXRfMSA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRoYXRfMS5fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGdldEZpbGVBY2Nlc3MoKS53cml0ZSh0aGlzLnBhdGgsIGNvbnRlbnQsIGxvY2FsRXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGUucHJvdG90eXBlLnJlYWRUZXh0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgaGFzRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBsb2NhbEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaGFzRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBfdGhpcy5yZWFkVGV4dFN5bmMobG9jYWxFcnJvciwgZW5jb2RpbmcpO1xuICAgICAgICAgICAgaWYgKCFoYXNFcnJvcikge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRmlsZS5wcm90b3R5cGUucmVhZFRleHRTeW5jID0gZnVuY3Rpb24gKG9uRXJyb3IsIGVuY29kaW5nKSB7XG4gICAgICAgIHRoaXMuY2hlY2tBY2Nlc3MoKTtcbiAgICAgICAgdGhpcy5fbG9ja2VkID0gdHJ1ZTtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgdGhhdC5fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB2YXIgY29udGVudCA9IGdldEZpbGVBY2Nlc3MoKS5yZWFkVGV4dCh0aGlzLnBhdGgsIGxvY2FsRXJyb3IsIGVuY29kaW5nKTtcbiAgICAgICAgdGhpcy5fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBjb250ZW50O1xuICAgIH07XG4gICAgRmlsZS5wcm90b3R5cGUud3JpdGVUZXh0ID0gZnVuY3Rpb24gKGNvbnRlbnQsIGVuY29kaW5nKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgaGFzRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBsb2NhbEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaGFzRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgX3RoaXMud3JpdGVUZXh0U3luYyhjb250ZW50LCBsb2NhbEVycm9yLCBlbmNvZGluZyk7XG4gICAgICAgICAgICBpZiAoIWhhc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEZpbGUucHJvdG90eXBlLndyaXRlVGV4dFN5bmMgPSBmdW5jdGlvbiAoY29udGVudCwgb25FcnJvciwgZW5jb2RpbmcpIHtcbiAgICAgICAgdGhpcy5jaGVja0FjY2VzcygpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5fbG9ja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciB0aGF0XzIgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGF0XzIuX2xvY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBnZXRGaWxlQWNjZXNzKCkud3JpdGVUZXh0KHRoaXMucGF0aCwgY29udGVudCwgbG9jYWxFcnJvciwgZW5jb2RpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGUucHJvdG90eXBlLmNoZWNrQWNjZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pc0xvY2tlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGFjY2VzcyBhIGxvY2tlZCBmaWxlLlwiKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBGaWxlLnByb3RvdHlwZSwgXCJyZWFkVGV4dFN5bmNcIiwgbnVsbCk7XG4gICAgcmV0dXJuIEZpbGU7XG59KEZpbGVTeXN0ZW1FbnRpdHkpKTtcbmV4cG9ydHMuRmlsZSA9IEZpbGU7XG52YXIgRm9sZGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRm9sZGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZvbGRlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBGb2xkZXIuZnJvbVBhdGggPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgb25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBmb2xkZXJJbmZvID0gZ2V0RmlsZUFjY2VzcygpLmdldEZvbGRlcihwYXRoLCBvbkVycm9yKTtcbiAgICAgICAgaWYgKCFmb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjcmVhdGVGb2xkZXIoZm9sZGVySW5mbyk7XG4gICAgfTtcbiAgICBGb2xkZXIuZXhpc3RzID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgcmV0dXJuIGdldEZpbGVBY2Nlc3MoKS5mb2xkZXJFeGlzdHMocGF0aCk7XG4gICAgfTtcbiAgICBGb2xkZXIucHJvdG90eXBlLmNvbnRhaW5zID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIGZpbGVBY2Nlc3MgPSBnZXRGaWxlQWNjZXNzKCk7XG4gICAgICAgIHZhciBwYXRoID0gZmlsZUFjY2Vzcy5qb2luUGF0aCh0aGlzLnBhdGgsIG5hbWUpO1xuICAgICAgICBpZiAoZmlsZUFjY2Vzcy5maWxlRXhpc3RzKHBhdGgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlsZUFjY2Vzcy5mb2xkZXJFeGlzdHMocGF0aCk7XG4gICAgfTtcbiAgICBGb2xkZXIucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIGhhc0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgb25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIF90aGlzLmNsZWFyU3luYyhvbkVycm9yKTtcbiAgICAgICAgICAgIGlmICghaGFzRXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRm9sZGVyLnByb3RvdHlwZS5jbGVhclN5bmMgPSBmdW5jdGlvbiAob25FcnJvcikge1xuICAgICAgICBnZXRGaWxlQWNjZXNzKCkuZW1wdHlGb2xkZXIodGhpcy5wYXRoLCBvbkVycm9yKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb2xkZXIucHJvdG90eXBlLCBcImlzS25vd25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc0tub3duO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGb2xkZXIucHJvdG90eXBlLmdldEZpbGUgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgZmlsZUFjY2VzcyA9IGdldEZpbGVBY2Nlc3MoKTtcbiAgICAgICAgdmFyIHBhdGggPSBmaWxlQWNjZXNzLmpvaW5QYXRoKHRoaXMucGF0aCwgbmFtZSk7XG4gICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGZpbGVJbmZvID0gZmlsZUFjY2Vzcy5nZXRGaWxlKHBhdGgsIG9uRXJyb3IpO1xuICAgICAgICBpZiAoIWZpbGVJbmZvKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjcmVhdGVGaWxlKGZpbGVJbmZvKTtcbiAgICB9O1xuICAgIEZvbGRlci5wcm90b3R5cGUuZ2V0Rm9sZGVyID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIGZpbGVBY2Nlc3MgPSBnZXRGaWxlQWNjZXNzKCk7XG4gICAgICAgIHZhciBwYXRoID0gZmlsZUFjY2Vzcy5qb2luUGF0aCh0aGlzLnBhdGgsIG5hbWUpO1xuICAgICAgICB2YXIgb25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBmb2xkZXJJbmZvID0gZmlsZUFjY2Vzcy5nZXRGb2xkZXIocGF0aCwgb25FcnJvcik7XG4gICAgICAgIGlmICghZm9sZGVySW5mbykge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3JlYXRlRm9sZGVyKGZvbGRlckluZm8pO1xuICAgIH07XG4gICAgRm9sZGVyLnByb3RvdHlwZS5nZXRFbnRpdGllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBoYXNFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBoYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgZW50aXRpZXMgPSBfdGhpcy5nZXRFbnRpdGllc1N5bmMobG9jYWxFcnJvcik7XG4gICAgICAgICAgICBpZiAoIWhhc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShlbnRpdGllcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRm9sZGVyLnByb3RvdHlwZS5nZXRFbnRpdGllc1N5bmMgPSBmdW5jdGlvbiAob25FcnJvcikge1xuICAgICAgICB2YXIgZmlsZUluZm9zID0gZ2V0RmlsZUFjY2VzcygpLmdldEVudGl0aWVzKHRoaXMucGF0aCwgb25FcnJvcik7XG4gICAgICAgIGlmICghZmlsZUluZm9zKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZW50aXRpZXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaWxlSW5mb3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChmaWxlSW5mb3NbaV0uZXh0ZW5zaW9uKSB7XG4gICAgICAgICAgICAgICAgZW50aXRpZXMucHVzaChjcmVhdGVGaWxlKGZpbGVJbmZvc1tpXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZW50aXRpZXMucHVzaChjcmVhdGVGb2xkZXIoZmlsZUluZm9zW2ldKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVudGl0aWVzO1xuICAgIH07XG4gICAgRm9sZGVyLnByb3RvdHlwZS5lYWNoRW50aXR5ID0gZnVuY3Rpb24gKG9uRW50aXR5KSB7XG4gICAgICAgIGlmICghb25FbnRpdHkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb25TdWNjZXNzID0gZnVuY3Rpb24gKGZpbGVJbmZvKSB7XG4gICAgICAgICAgICB2YXIgZW50aXR5O1xuICAgICAgICAgICAgaWYgKGZpbGVJbmZvLmV4dGVuc2lvbikge1xuICAgICAgICAgICAgICAgIGVudGl0eSA9IGNyZWF0ZUZpbGUoZmlsZUluZm8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZW50aXR5ID0gY3JlYXRlRm9sZGVyKGZpbGVJbmZvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvbkVudGl0eShlbnRpdHkpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgb25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH07XG4gICAgICAgIGdldEZpbGVBY2Nlc3MoKS5lYWNoRW50aXR5KHRoaXMucGF0aCwgb25TdWNjZXNzLCBvbkVycm9yKTtcbiAgICB9O1xuICAgIHJldHVybiBGb2xkZXI7XG59KEZpbGVTeXN0ZW1FbnRpdHkpKTtcbmV4cG9ydHMuRm9sZGVyID0gRm9sZGVyO1xudmFyIGtub3duRm9sZGVycztcbihmdW5jdGlvbiAoa25vd25Gb2xkZXJzKSB7XG4gICAgdmFyIF9kb2N1bWVudHM7XG4gICAgdmFyIF90ZW1wO1xuICAgIHZhciBfYXBwO1xuICAgIGZ1bmN0aW9uIGRvY3VtZW50cygpIHtcbiAgICAgICAgaWYgKCFfZG9jdW1lbnRzKSB7XG4gICAgICAgICAgICB2YXIgcGF0aF8xID0gZ2V0RmlsZUFjY2VzcygpLmdldERvY3VtZW50c0ZvbGRlclBhdGgoKTtcbiAgICAgICAgICAgIF9kb2N1bWVudHMgPSBuZXcgRm9sZGVyKCk7XG4gICAgICAgICAgICBfZG9jdW1lbnRzLl9wYXRoID0gcGF0aF8xO1xuICAgICAgICAgICAgX2RvY3VtZW50cy5faXNLbm93biA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9kb2N1bWVudHM7XG4gICAgfVxuICAgIGtub3duRm9sZGVycy5kb2N1bWVudHMgPSBkb2N1bWVudHM7XG4gICAgZnVuY3Rpb24gdGVtcCgpIHtcbiAgICAgICAgaWYgKCFfdGVtcCkge1xuICAgICAgICAgICAgdmFyIHBhdGhfMiA9IGdldEZpbGVBY2Nlc3MoKS5nZXRUZW1wRm9sZGVyUGF0aCgpO1xuICAgICAgICAgICAgX3RlbXAgPSBuZXcgRm9sZGVyKCk7XG4gICAgICAgICAgICBfdGVtcC5fcGF0aCA9IHBhdGhfMjtcbiAgICAgICAgICAgIF90ZW1wLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3RlbXA7XG4gICAgfVxuICAgIGtub3duRm9sZGVycy50ZW1wID0gdGVtcDtcbiAgICBmdW5jdGlvbiBjdXJyZW50QXBwKCkge1xuICAgICAgICBpZiAoIV9hcHApIHtcbiAgICAgICAgICAgIHZhciBwYXRoXzMgPSBnZXRGaWxlQWNjZXNzKCkuZ2V0Q3VycmVudEFwcFBhdGgoKTtcbiAgICAgICAgICAgIF9hcHAgPSBuZXcgRm9sZGVyKCk7XG4gICAgICAgICAgICBfYXBwLl9wYXRoID0gcGF0aF8zO1xuICAgICAgICAgICAgX2FwcC5faXNLbm93biA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9hcHA7XG4gICAgfVxuICAgIGtub3duRm9sZGVycy5jdXJyZW50QXBwID0gY3VycmVudEFwcDtcbiAgICB2YXIgaW9zO1xuICAgIChmdW5jdGlvbiAoaW9zKSB7XG4gICAgICAgIGZ1bmN0aW9uIF9jaGVja1BsYXRmb3JtKGtub3duRm9sZGVyTmFtZSkge1xuICAgICAgICAgICAgZW5zdXJlUGxhdGZvcm0oKTtcbiAgICAgICAgICAgIGlmICghcGxhdGZvcm0uaXNJT1MpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgXFxcIlwiICsga25vd25Gb2xkZXJOYW1lICsgXCJcXFwiIGtub3duIGZvbGRlciBpcyBhdmFpbGFibGUgb24gaU9TIG9ubHkhXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBfbGlicmFyeTtcbiAgICAgICAgZnVuY3Rpb24gbGlicmFyeSgpIHtcbiAgICAgICAgICAgIF9jaGVja1BsYXRmb3JtKFwibGlicmFyeVwiKTtcbiAgICAgICAgICAgIGlmICghX2xpYnJhcnkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdGb2xkZXJJbmZvID0gZ2V0RXhpc3RpbmdGb2xkZXJJbmZvKDUpO1xuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0ZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgX2xpYnJhcnkgPSBleGlzdGluZ0ZvbGRlckluZm8uZm9sZGVyO1xuICAgICAgICAgICAgICAgICAgICBfbGlicmFyeS5fcGF0aCA9IGV4aXN0aW5nRm9sZGVySW5mby5wYXRoO1xuICAgICAgICAgICAgICAgICAgICBfbGlicmFyeS5faXNLbm93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIF9saWJyYXJ5O1xuICAgICAgICB9XG4gICAgICAgIGlvcy5saWJyYXJ5ID0gbGlicmFyeTtcbiAgICAgICAgdmFyIF9kZXZlbG9wZXI7XG4gICAgICAgIGZ1bmN0aW9uIGRldmVsb3BlcigpIHtcbiAgICAgICAgICAgIF9jaGVja1BsYXRmb3JtKFwiZGV2ZWxvcGVyXCIpO1xuICAgICAgICAgICAgaWYgKCFfZGV2ZWxvcGVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRm9sZGVySW5mbyA9IGdldEV4aXN0aW5nRm9sZGVySW5mbyg2KTtcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdGb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIF9kZXZlbG9wZXIgPSBleGlzdGluZ0ZvbGRlckluZm8uZm9sZGVyO1xuICAgICAgICAgICAgICAgICAgICBfZGV2ZWxvcGVyLl9wYXRoID0gZXhpc3RpbmdGb2xkZXJJbmZvLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgIF9kZXZlbG9wZXIuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBfZGV2ZWxvcGVyO1xuICAgICAgICB9XG4gICAgICAgIGlvcy5kZXZlbG9wZXIgPSBkZXZlbG9wZXI7XG4gICAgICAgIHZhciBfZGVza3RvcDtcbiAgICAgICAgZnVuY3Rpb24gZGVza3RvcCgpIHtcbiAgICAgICAgICAgIF9jaGVja1BsYXRmb3JtKFwiZGVza3RvcFwiKTtcbiAgICAgICAgICAgIGlmICghX2Rlc2t0b3ApIHtcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdGb2xkZXJJbmZvID0gZ2V0RXhpc3RpbmdGb2xkZXJJbmZvKDEyKTtcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdGb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIF9kZXNrdG9wID0gZXhpc3RpbmdGb2xkZXJJbmZvLmZvbGRlcjtcbiAgICAgICAgICAgICAgICAgICAgX2Rlc2t0b3AuX3BhdGggPSBleGlzdGluZ0ZvbGRlckluZm8ucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgX2Rlc2t0b3AuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBfZGVza3RvcDtcbiAgICAgICAgfVxuICAgICAgICBpb3MuZGVza3RvcCA9IGRlc2t0b3A7XG4gICAgICAgIHZhciBfZG93bmxvYWRzO1xuICAgICAgICBmdW5jdGlvbiBkb3dubG9hZHMoKSB7XG4gICAgICAgICAgICBfY2hlY2tQbGF0Zm9ybShcImRvd25sb2Fkc1wiKTtcbiAgICAgICAgICAgIGlmICghX2Rvd25sb2Fkcykge1xuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZvbGRlckluZm8gPSBnZXRFeGlzdGluZ0ZvbGRlckluZm8oMTUpO1xuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0ZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgX2Rvd25sb2FkcyA9IGV4aXN0aW5nRm9sZGVySW5mby5mb2xkZXI7XG4gICAgICAgICAgICAgICAgICAgIF9kb3dubG9hZHMuX3BhdGggPSBleGlzdGluZ0ZvbGRlckluZm8ucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgX2Rvd25sb2Fkcy5faXNLbm93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIF9kb3dubG9hZHM7XG4gICAgICAgIH1cbiAgICAgICAgaW9zLmRvd25sb2FkcyA9IGRvd25sb2FkcztcbiAgICAgICAgdmFyIF9tb3ZpZXM7XG4gICAgICAgIGZ1bmN0aW9uIG1vdmllcygpIHtcbiAgICAgICAgICAgIF9jaGVja1BsYXRmb3JtKFwibW92aWVzXCIpO1xuICAgICAgICAgICAgaWYgKCFfbW92aWVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRm9sZGVySW5mbyA9IGdldEV4aXN0aW5nRm9sZGVySW5mbygxNyk7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgICAgICBfbW92aWVzID0gZXhpc3RpbmdGb2xkZXJJbmZvLmZvbGRlcjtcbiAgICAgICAgICAgICAgICAgICAgX21vdmllcy5fcGF0aCA9IGV4aXN0aW5nRm9sZGVySW5mby5wYXRoO1xuICAgICAgICAgICAgICAgICAgICBfbW92aWVzLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX21vdmllcztcbiAgICAgICAgfVxuICAgICAgICBpb3MubW92aWVzID0gbW92aWVzO1xuICAgICAgICB2YXIgX211c2ljO1xuICAgICAgICBmdW5jdGlvbiBtdXNpYygpIHtcbiAgICAgICAgICAgIF9jaGVja1BsYXRmb3JtKFwibXVzaWNcIik7XG4gICAgICAgICAgICBpZiAoIV9tdXNpYykge1xuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZvbGRlckluZm8gPSBnZXRFeGlzdGluZ0ZvbGRlckluZm8oMTgpO1xuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0ZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgX211c2ljID0gZXhpc3RpbmdGb2xkZXJJbmZvLmZvbGRlcjtcbiAgICAgICAgICAgICAgICAgICAgX211c2ljLl9wYXRoID0gZXhpc3RpbmdGb2xkZXJJbmZvLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgIF9tdXNpYy5faXNLbm93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIF9tdXNpYztcbiAgICAgICAgfVxuICAgICAgICBpb3MubXVzaWMgPSBtdXNpYztcbiAgICAgICAgdmFyIF9waWN0dXJlcztcbiAgICAgICAgZnVuY3Rpb24gcGljdHVyZXMoKSB7XG4gICAgICAgICAgICBfY2hlY2tQbGF0Zm9ybShcInBpY3R1cmVzXCIpO1xuICAgICAgICAgICAgaWYgKCFfcGljdHVyZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdGb2xkZXJJbmZvID0gZ2V0RXhpc3RpbmdGb2xkZXJJbmZvKDE5KTtcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdGb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIF9waWN0dXJlcyA9IGV4aXN0aW5nRm9sZGVySW5mby5mb2xkZXI7XG4gICAgICAgICAgICAgICAgICAgIF9waWN0dXJlcy5fcGF0aCA9IGV4aXN0aW5nRm9sZGVySW5mby5wYXRoO1xuICAgICAgICAgICAgICAgICAgICBfcGljdHVyZXMuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBfcGljdHVyZXM7XG4gICAgICAgIH1cbiAgICAgICAgaW9zLnBpY3R1cmVzID0gcGljdHVyZXM7XG4gICAgICAgIHZhciBfc2hhcmVkUHVibGljO1xuICAgICAgICBmdW5jdGlvbiBzaGFyZWRQdWJsaWMoKSB7XG4gICAgICAgICAgICBfY2hlY2tQbGF0Zm9ybShcInNoYXJlZFB1YmxpY1wiKTtcbiAgICAgICAgICAgIGlmICghX3NoYXJlZFB1YmxpYykge1xuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZvbGRlckluZm8gPSBnZXRFeGlzdGluZ0ZvbGRlckluZm8oMjEpO1xuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0ZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgX3NoYXJlZFB1YmxpYyA9IGV4aXN0aW5nRm9sZGVySW5mby5mb2xkZXI7XG4gICAgICAgICAgICAgICAgICAgIF9zaGFyZWRQdWJsaWMuX3BhdGggPSBleGlzdGluZ0ZvbGRlckluZm8ucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgX3NoYXJlZFB1YmxpYy5faXNLbm93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIF9zaGFyZWRQdWJsaWM7XG4gICAgICAgIH1cbiAgICAgICAgaW9zLnNoYXJlZFB1YmxpYyA9IHNoYXJlZFB1YmxpYztcbiAgICAgICAgZnVuY3Rpb24gZ2V0RXhpc3RpbmdGb2xkZXJJbmZvKHBhdGhEaXJlY3RvcnkpIHtcbiAgICAgICAgICAgIHZhciBmaWxlQWNjZXNzID0gZ2V0RmlsZUFjY2VzcygpO1xuICAgICAgICAgICAgdmFyIGZvbGRlclBhdGggPSBmaWxlQWNjZXNzLmdldEtub3duUGF0aChwYXRoRGlyZWN0b3J5KTtcbiAgICAgICAgICAgIHZhciBmb2xkZXJJbmZvID0gZmlsZUFjY2Vzcy5nZXRFeGlzdGluZ0ZvbGRlcihmb2xkZXJQYXRoKTtcbiAgICAgICAgICAgIGlmIChmb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZm9sZGVyOiBjcmVhdGVGb2xkZXIoZm9sZGVySW5mbyksXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IGZvbGRlclBhdGhcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH0pKGlvcyA9IGtub3duRm9sZGVycy5pb3MgfHwgKGtub3duRm9sZGVycy5pb3MgPSB7fSkpO1xufSkoa25vd25Gb2xkZXJzID0gZXhwb3J0cy5rbm93bkZvbGRlcnMgfHwgKGV4cG9ydHMua25vd25Gb2xkZXJzID0ge30pKTtcbnZhciBwYXRoO1xuKGZ1bmN0aW9uIChwYXRoXzQpIHtcbiAgICBmdW5jdGlvbiBub3JtYWxpemUocGF0aCkge1xuICAgICAgICByZXR1cm4gZ2V0RmlsZUFjY2VzcygpLm5vcm1hbGl6ZVBhdGgocGF0aCk7XG4gICAgfVxuICAgIHBhdGhfNC5ub3JtYWxpemUgPSBub3JtYWxpemU7XG4gICAgZnVuY3Rpb24gam9pbigpIHtcbiAgICAgICAgdmFyIHBhdGhzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBwYXRoc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmaWxlQWNjZXNzID0gZ2V0RmlsZUFjY2VzcygpO1xuICAgICAgICByZXR1cm4gZmlsZUFjY2Vzcy5qb2luUGF0aHMocGF0aHMpO1xuICAgIH1cbiAgICBwYXRoXzQuam9pbiA9IGpvaW47XG4gICAgcGF0aF80LnNlcGFyYXRvciA9IGdldEZpbGVBY2Nlc3MoKS5nZXRQYXRoU2VwYXJhdG9yKCk7XG59KShwYXRoID0gZXhwb3J0cy5wYXRoIHx8IChleHBvcnRzLnBhdGggPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmlsZS1zeXN0ZW0uanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xucmVxdWlyZShcIi4uL3RzLWhlbHBlcnNcIik7XG5yZXF1aXJlKFwiLi4vcmVnaXN0ZXItbW9kdWxlLWhlbHBlcnNcIik7XG5nbG9iYWwubW9kdWxlTWVyZ2UgPSBmdW5jdGlvbiAoc291cmNlRXhwb3J0cywgZGVzdEV4cG9ydHMpIHtcbiAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlRXhwb3J0cykge1xuICAgICAgICBkZXN0RXhwb3J0c1trZXldID0gc291cmNlRXhwb3J0c1trZXldO1xuICAgIH1cbn07XG5nbG9iYWwuem9uZWRDYWxsYmFjayA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIGlmIChnbG9iYWwuem9uZSkge1xuICAgICAgICByZXR1cm4gZ2xvYmFsLnpvbmUuYmluZChjYWxsYmFjayk7XG4gICAgfVxuICAgIGlmIChnbG9iYWwuWm9uZSkge1xuICAgICAgICByZXR1cm4gZ2xvYmFsLlpvbmUuY3VycmVudC53cmFwKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFjaztcbiAgICB9XG59O1xuZ2xvYmFsLlN5c3RlbSA9IHtcbiAgICBpbXBvcnQ6IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZ2xvYmFsLnJlcXVpcmUocGF0aCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1nbG9iYWxzLWNvcmUuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gRGVwcmVjYXRlZCh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIGlmIChkZXNjcmlwdG9yKSB7XG4gICAgICAgIHZhciBvcmlnaW5hbE1ldGhvZF8xID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGtleS50b1N0cmluZygpICsgXCIgaXMgZGVwcmVjYXRlZFwiKTtcbiAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbE1ldGhvZF8xLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZGVzY3JpcHRvcjtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCh0YXJnZXQgJiYgdGFyZ2V0Lm5hbWUgfHwgdGFyZ2V0KSArIFwiIGlzIGRlcHJlY2F0ZWRcIik7XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfVxufVxuZXhwb3J0cy5EZXByZWNhdGVkID0gRGVwcmVjYXRlZDtcbmdsb2JhbC5EZXByZWNhdGVkID0gRGVwcmVjYXRlZDtcbmZ1bmN0aW9uIEV4cGVyaW1lbnRhbCh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIGlmIChkZXNjcmlwdG9yKSB7XG4gICAgICAgIHZhciBvcmlnaW5hbE1ldGhvZF8yID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGtleS50b1N0cmluZygpICsgXCIgaXMgZXhwZXJpbWVudGFsXCIpO1xuICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsTWV0aG9kXzIuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBkZXNjcmlwdG9yO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coKHRhcmdldCAmJiB0YXJnZXQubmFtZSB8fCB0YXJnZXQpICsgXCIgaXMgZXhwZXJpbWVudGFsXCIpO1xuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH1cbn1cbmV4cG9ydHMuRXhwZXJpbWVudGFsID0gRXhwZXJpbWVudGFsO1xuZ2xvYmFsLkV4cGVyaW1lbnRhbCA9IEV4cGVyaW1lbnRhbDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlY29yYXRvcnMuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xucmVxdWlyZShcIi4vY29yZVwiKTtcbnJlcXVpcmUoXCIuL3BvbHlmaWxscy90aW1lcnNcIik7XG5yZXF1aXJlKFwiLi9wb2x5ZmlsbHMvZGlhbG9nc1wiKTtcbnJlcXVpcmUoXCIuL3BvbHlmaWxscy94aHJcIik7XG5yZXF1aXJlKFwiLi9wb2x5ZmlsbHMvZmV0Y2hcIik7XG5yZXF1aXJlKFwiLi9kZWNvcmF0b3JzXCIpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z2xvYmFscy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5yZXF1aXJlKFwiLi4vLi4vY29yZVwiKTtcbnZhciBwb2x5ZmlsbF9oZWxwZXJzXzEgPSByZXF1aXJlKFwiLi4vcG9seWZpbGwtaGVscGVyc1wiKTtcbmdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInRucy1jb3JlLW1vZHVsZXMvdWkvZGlhbG9nc1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi4vLi4vLi4vdWkvZGlhbG9nc1wiKTsgfSk7XG5wb2x5ZmlsbF9oZWxwZXJzXzEuaW5zdGFsbFBvbHlmaWxscyhcInRucy1jb3JlLW1vZHVsZXMvdWkvZGlhbG9nc1wiLCBbXCJhbGVydFwiLCBcImNvbmZpcm1cIiwgXCJwcm9tcHRcIiwgXCJsb2dpblwiLCBcImFjdGlvblwiXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kaWFsb2dzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnJlcXVpcmUoXCIuLi8uLi9jb3JlXCIpO1xucmVxdWlyZShcIi4uLy4uL3BvbHlmaWxscy94aHJcIik7XG52YXIgcG9seWZpbGxfaGVscGVyc18xID0gcmVxdWlyZShcIi4uL3BvbHlmaWxsLWhlbHBlcnNcIik7XG5nbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJmZXRjaFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi4vLi4vLi4vZmV0Y2hcIik7IH0pO1xucG9seWZpbGxfaGVscGVyc18xLmluc3RhbGxQb2x5ZmlsbHMoXCJmZXRjaFwiLCBbXCJmZXRjaFwiLCBcIkhlYWRlcnNcIiwgXCJSZXF1ZXN0XCIsIFwiUmVzcG9uc2VcIl0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmV0Y2guanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xucmVxdWlyZShcIi4uLy4uL2NvcmVcIik7XG5mdW5jdGlvbiByZWdpc3Rlck9uR2xvYmFsQ29udGV4dChtb2R1bGVOYW1lLCBleHBvcnROYW1lKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwgZXhwb3J0TmFtZSwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBtID0gZ2xvYmFsLmxvYWRNb2R1bGUobW9kdWxlTmFtZSk7XG4gICAgICAgICAgICB2YXIgcmVzb2x2ZWRWYWx1ZSA9IG1bZXhwb3J0TmFtZV07XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZ2xvYmFsLCBleHBvcnROYW1lLCB7IHZhbHVlOiByZXNvbHZlZFZhbHVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmVkVmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xufVxuZnVuY3Rpb24gaW5zdGFsbFBvbHlmaWxscyhtb2R1bGVOYW1lLCBleHBvcnROYW1lcykge1xuICAgIGlmIChnbG9iYWwuX19zbmFwc2hvdCkge1xuICAgICAgICB2YXIgbG9hZGVkTW9kdWxlXzEgPSBnbG9iYWwubG9hZE1vZHVsZShtb2R1bGVOYW1lKTtcbiAgICAgICAgZXhwb3J0TmFtZXMuZm9yRWFjaChmdW5jdGlvbiAoZXhwb3J0TmFtZSkgeyByZXR1cm4gZ2xvYmFsW2V4cG9ydE5hbWVdID0gbG9hZGVkTW9kdWxlXzFbZXhwb3J0TmFtZV07IH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZXhwb3J0TmFtZXMuZm9yRWFjaChmdW5jdGlvbiAoZXhwb3J0TmFtZSkgeyByZXR1cm4gcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQobW9kdWxlTmFtZSwgZXhwb3J0TmFtZSk7IH0pO1xuICAgIH1cbn1cbmV4cG9ydHMuaW5zdGFsbFBvbHlmaWxscyA9IGluc3RhbGxQb2x5ZmlsbHM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wb2x5ZmlsbC1oZWxwZXJzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnJlcXVpcmUoXCIuLi8uLi9jb3JlXCIpO1xudmFyIHBvbHlmaWxsX2hlbHBlcnNfMSA9IHJlcXVpcmUoXCIuLi9wb2x5ZmlsbC1oZWxwZXJzXCIpO1xuZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidGltZXJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4uLy4uLy4uL3RpbWVyXCIpOyB9KTtcbnBvbHlmaWxsX2hlbHBlcnNfMS5pbnN0YWxsUG9seWZpbGxzKFwidGltZXJcIiwgW1wic2V0VGltZW91dFwiLCBcImNsZWFyVGltZW91dFwiLCBcInNldEludGVydmFsXCIsIFwiY2xlYXJJbnRlcnZhbFwiXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10aW1lcnMuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xucmVxdWlyZShcIi4uLy4uL2NvcmVcIik7XG52YXIgcG9seWZpbGxfaGVscGVyc18xID0gcmVxdWlyZShcIi4uL3BvbHlmaWxsLWhlbHBlcnNcIik7XG5nbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ4aHJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4uLy4uLy4uL3hoclwiKTsgfSk7XG5wb2x5ZmlsbF9oZWxwZXJzXzEuaW5zdGFsbFBvbHlmaWxscyhcInhoclwiLCBbXCJYTUxIdHRwUmVxdWVzdFwiLCBcIkZvcm1EYXRhXCJdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXhoci5qcy5tYXAiLCJ2YXIgbW9kdWxlcyA9IG5ldyBNYXAoKTtcbnZhciBtb2R1bGVzTG9hZGVkRm9yVUkgPSBuZXcgU2V0KCk7XG52YXIgZGVmYXVsdEV4dGVuc2lvbk1hcCA9IHtcbiAgICBcIi5qc1wiOiBcIi5qc1wiLFxuICAgIFwiLnRzXCI6IFwiLmpzXCIsXG4gICAgXCIuY3NzXCI6IFwiLmNzc1wiLFxuICAgIFwiLnNjc3NcIjogXCIuY3NzXCIsXG4gICAgXCIubGVzc1wiOiBcIi5jc3NcIixcbiAgICBcIi5zYXNzXCI6IFwiLmNzc1wiLFxuICAgIFwiLnhtbFwiOiBcIi54bWxcIlxufTtcbmdsb2JhbC5tb2R1bGVSZXNvbHZlcnMgPSBbZ2xvYmFsLnJlcXVpcmVdO1xuZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlID0gZnVuY3Rpb24gKG5hbWUsIGxvYWRlcikge1xuICAgIG1vZHVsZXMuc2V0KG5hbWUsIHsgbG9hZGVyOiBsb2FkZXIsIG1vZHVsZUlkOiBuYW1lIH0pO1xufTtcbmdsb2JhbC5fdW5yZWdpc3Rlck1vZHVsZSA9IGZ1bmN0aW9uIF91bnJlZ2lzdGVyTW9kdWxlKG5hbWUpIHtcbiAgICBtb2R1bGVzLmRlbGV0ZShuYW1lKTtcbn07XG5nbG9iYWwuX2lzTW9kdWxlTG9hZGVkRm9yVUkgPSBmdW5jdGlvbiBfaXNNb2R1bGVMb2FkZWRGb3JVSShtb2R1bGVOYW1lKSB7XG4gICAgcmV0dXJuIG1vZHVsZXNMb2FkZWRGb3JVSS5oYXMobW9kdWxlTmFtZSk7XG59O1xuZ2xvYmFsLnJlZ2lzdGVyV2VicGFja01vZHVsZXMgPSBmdW5jdGlvbiByZWdpc3RlcldlYnBhY2tNb2R1bGVzKGNvbnRleHQsIGV4dGVuc2lvbk1hcCkge1xuICAgIGlmIChleHRlbnNpb25NYXAgPT09IHZvaWQgMCkgeyBleHRlbnNpb25NYXAgPSB7fTsgfVxuICAgIGNvbnRleHQua2V5cygpLmZvckVhY2goZnVuY3Rpb24gKG1vZHVsZUlkKSB7XG4gICAgICAgIHZhciBleHREb3RJbmRleCA9IG1vZHVsZUlkLmxhc3RJbmRleE9mKFwiLlwiKTtcbiAgICAgICAgdmFyIGJhc2UgPSBtb2R1bGVJZC5zdWJzdHIoMCwgZXh0RG90SW5kZXgpO1xuICAgICAgICB2YXIgb3JpZ2luYWxFeHQgPSBtb2R1bGVJZC5zdWJzdHIoZXh0RG90SW5kZXgpO1xuICAgICAgICB2YXIgcmVnaXN0ZXJFeHQgPSBleHRlbnNpb25NYXBbb3JpZ2luYWxFeHRdIHx8IGRlZmF1bHRFeHRlbnNpb25NYXBbb3JpZ2luYWxFeHRdIHx8IG9yaWdpbmFsRXh0O1xuICAgICAgICB2YXIgaXNTb3VyY2VGaWxlID0gb3JpZ2luYWxFeHQgIT09IHJlZ2lzdGVyRXh0O1xuICAgICAgICB2YXIgcmVnaXN0ZXJOYW1lID0gYmFzZSArIHJlZ2lzdGVyRXh0O1xuICAgICAgICB2YXIgcmVnaXN0ZXJXaXRoTmFtZSA9IGZ1bmN0aW9uIChuaWNrTmFtZSkge1xuICAgICAgICAgICAgbW9kdWxlcy5zZXQobmlja05hbWUsIHtcbiAgICAgICAgICAgICAgICBtb2R1bGVJZDogbW9kdWxlSWQsXG4gICAgICAgICAgICAgICAgbG9hZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0KG1vZHVsZUlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHJlZ2lzdGVyTmFtZS5zdGFydHNXaXRoKFwiLi9cIikgJiYgcmVnaXN0ZXJOYW1lLmVuZHNXaXRoKFwiLmpzXCIpKSB7XG4gICAgICAgICAgICB2YXIganNOaWNrTmFtZXMgPSBbXG4gICAgICAgICAgICAgICAgcmVnaXN0ZXJOYW1lLnN1YnN0cigyLCByZWdpc3Rlck5hbWUubGVuZ3RoIC0gNSksXG4gICAgICAgICAgICAgICAgcmVnaXN0ZXJOYW1lLnN1YnN0cigwLCByZWdpc3Rlck5hbWUubGVuZ3RoIC0gMyksXG4gICAgICAgICAgICAgICAgcmVnaXN0ZXJOYW1lLnN1YnN0cigyKSxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBqc05pY2tOYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChqc05pY2tOYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzU291cmNlRmlsZSB8fCAhZ2xvYmFsLm1vZHVsZUV4aXN0cyhqc05pY2tOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICByZWdpc3RlcldpdGhOYW1lKGpzTmlja05hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHJlZ2lzdGVyTmFtZS5zdGFydHNXaXRoKFwiLi9cIikpIHtcbiAgICAgICAgICAgIHZhciBtb2R1bGVOaWNrTmFtZXMgPSBbXG4gICAgICAgICAgICAgICAgcmVnaXN0ZXJOYW1lLnN1YnN0cigyKSxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBtb2R1bGVOaWNrTmFtZXMuZm9yRWFjaChmdW5jdGlvbiAobW9kdWxlTmlja05hbWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWdsb2JhbC5tb2R1bGVFeGlzdHMobW9kdWxlTmlja05hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyV2l0aE5hbWUobW9kdWxlTmlja05hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1NvdXJjZUZpbGUgfHwgIWdsb2JhbC5tb2R1bGVFeGlzdHMocmVnaXN0ZXJOYW1lKSkge1xuICAgICAgICAgICAgcmVnaXN0ZXJXaXRoTmFtZShyZWdpc3Rlck5hbWUpO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuZ2xvYmFsLm1vZHVsZUV4aXN0cyA9IGZ1bmN0aW9uIG1vZHVsZUV4aXN0cyhuYW1lKSB7XG4gICAgcmV0dXJuIG1vZHVsZXMuaGFzKG5hbWUpO1xufTtcbmdsb2JhbC5sb2FkTW9kdWxlID0gZnVuY3Rpb24gbG9hZE1vZHVsZShuYW1lLCBpc1VJTW9kdWxlKSB7XG4gICAgaWYgKGlzVUlNb2R1bGUgPT09IHZvaWQgMCkgeyBpc1VJTW9kdWxlID0gZmFsc2U7IH1cbiAgICB2YXIgbW9kdWxlSW5mbyA9IG1vZHVsZXMuZ2V0KG5hbWUpO1xuICAgIGlmIChtb2R1bGVJbmZvKSB7XG4gICAgICAgIGlmIChpc1VJTW9kdWxlKSB7XG4gICAgICAgICAgICBtb2R1bGVzTG9hZGVkRm9yVUkuYWRkKG1vZHVsZUluZm8ubW9kdWxlSWQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXN1bHQgPSBtb2R1bGVJbmZvLmxvYWRlcihuYW1lKTtcbiAgICAgICAgaWYgKHJlc3VsdC5lbmFibGVBdXRvQWNjZXB0KSB7XG4gICAgICAgICAgICByZXN1bHQuZW5hYmxlQXV0b0FjY2VwdCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKHJlc29sdmVyKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSByZXNvbHZlcihuYW1lKTtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgbW9kdWxlcy5zZXQobmFtZSwgeyBtb2R1bGVJZDogbmFtZSwgbG9hZGVyOiBmdW5jdGlvbiAoKSB7IHJldHVybiByZXN1bHQ7IH0gfSk7XG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogcmVzdWx0IH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBnbG9iYWwubW9kdWxlUmVzb2x2ZXJzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgcmVzb2x2ZXIgPSBfYVtfaV07XG4gICAgICAgIHZhciBzdGF0ZV8xID0gX2xvb3BfMShyZXNvbHZlcik7XG4gICAgICAgIGlmICh0eXBlb2Ygc3RhdGVfMSA9PT0gXCJvYmplY3RcIilcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZV8xLnZhbHVlO1xuICAgIH1cbn07XG5nbG9iYWwuZ2V0UmVnaXN0ZXJlZE1vZHVsZXMgPSBmdW5jdGlvbiBnZXRSZWdpc3RlcmVkTW9kdWxlcygpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShtb2R1bGVzLmtleXMoKSk7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cmVnaXN0ZXItbW9kdWxlLWhlbHBlcnMuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuaWYgKCFnbG9iYWwuX19leHRlbmRzKSB7XG4gICAgZ2xvYmFsLl9fZXh0ZW5kcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGZvciAodmFyIHAgaW4gYikge1xuICAgICAgICAgICAgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIHtcbiAgICAgICAgICAgICAgICBkW3BdID0gYltwXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59XG52YXIgdHNsaWIgPSByZXF1aXJlKFwidHNsaWJcIik7XG5mb3IgKHZhciBfaSA9IDAsIF9hID0gT2JqZWN0LmtleXModHNsaWIpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgIHZhciBmbk5hbWUgPSBfYVtfaV07XG4gICAgaWYgKHR5cGVvZiB0c2xpYltmbk5hbWVdICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChmbk5hbWUgaW4gZ2xvYmFsKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBnbG9iYWxbZm5OYW1lXSA9IHRzbGliW2ZuTmFtZV07XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD10cy1oZWxwZXJzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIGdldEZpbGVuYW1lRnJvbVVybCh1cmwpIHtcbiAgICB2YXIgZnMgPSByZXF1aXJlKFwiLi4vLi4vZmlsZS1zeXN0ZW1cIik7XG4gICAgdmFyIHNsYXNoUG9zID0gdXJsLmxhc3RJbmRleE9mKFwiL1wiKSArIDE7XG4gICAgdmFyIHF1ZXN0aW9uTWFya1BvcyA9IHVybC5sYXN0SW5kZXhPZihcIj9cIik7XG4gICAgdmFyIGFjdHVhbEZpbGVOYW1lO1xuICAgIGlmIChxdWVzdGlvbk1hcmtQb3MgIT09IC0xKSB7XG4gICAgICAgIGFjdHVhbEZpbGVOYW1lID0gdXJsLnN1YnN0cmluZyhzbGFzaFBvcywgcXVlc3Rpb25NYXJrUG9zKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGFjdHVhbEZpbGVOYW1lID0gdXJsLnN1YnN0cmluZyhzbGFzaFBvcyk7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSBmcy5wYXRoLmpvaW4oZnMua25vd25Gb2xkZXJzLmRvY3VtZW50cygpLnBhdGgsIGFjdHVhbEZpbGVOYW1lKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZXhwb3J0cy5nZXRGaWxlbmFtZUZyb21VcmwgPSBnZXRGaWxlbmFtZUZyb21Vcmw7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1odHRwLXJlcXVlc3QtY29tbW9uLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBodHRwX3JlcXVlc3RfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9odHRwLXJlcXVlc3QtY29tbW9uXCIpO1xudmFyIGRlYnVnZ2VyXzEgPSByZXF1aXJlKFwiLi4vLi4vZGVidWdnZXIvZGVidWdnZXJcIik7XG52YXIgSHR0cFJlc3BvbnNlRW5jb2Rpbmc7XG4oZnVuY3Rpb24gKEh0dHBSZXNwb25zZUVuY29kaW5nKSB7XG4gICAgSHR0cFJlc3BvbnNlRW5jb2RpbmdbSHR0cFJlc3BvbnNlRW5jb2RpbmdbXCJVVEY4XCJdID0gMF0gPSBcIlVURjhcIjtcbiAgICBIdHRwUmVzcG9uc2VFbmNvZGluZ1tIdHRwUmVzcG9uc2VFbmNvZGluZ1tcIkdCS1wiXSA9IDFdID0gXCJHQktcIjtcbn0pKEh0dHBSZXNwb25zZUVuY29kaW5nID0gZXhwb3J0cy5IdHRwUmVzcG9uc2VFbmNvZGluZyB8fCAoZXhwb3J0cy5IdHRwUmVzcG9uc2VFbmNvZGluZyA9IHt9KSk7XG5mdW5jdGlvbiBwYXJzZUpTT04oc291cmNlKSB7XG4gICAgdmFyIHNyYyA9IHNvdXJjZS50cmltKCk7XG4gICAgaWYgKHNyYy5sYXN0SW5kZXhPZihcIilcIikgPT09IHNyYy5sZW5ndGggLSAxKSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKHNyYy5zdWJzdHJpbmcoc3JjLmluZGV4T2YoXCIoXCIpICsgMSwgc3JjLmxhc3RJbmRleE9mKFwiKVwiKSkpO1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5wYXJzZShzcmMpO1xufVxudmFyIHJlcXVlc3RJZENvdW50ZXIgPSAwO1xudmFyIHBlbmRpbmdSZXF1ZXN0cyA9IHt9O1xudmFyIGltYWdlU291cmNlO1xuZnVuY3Rpb24gZW5zdXJlSW1hZ2VTb3VyY2UoKSB7XG4gICAgaWYgKCFpbWFnZVNvdXJjZSkge1xuICAgICAgICBpbWFnZVNvdXJjZSA9IHJlcXVpcmUoXCIuLi8uLi9pbWFnZS1zb3VyY2VcIik7XG4gICAgfVxufVxudmFyIHBsYXRmb3JtO1xuZnVuY3Rpb24gZW5zdXJlUGxhdGZvcm0oKSB7XG4gICAgaWYgKCFwbGF0Zm9ybSkge1xuICAgICAgICBwbGF0Zm9ybSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybVwiKTtcbiAgICB9XG59XG52YXIgZnM7XG5mdW5jdGlvbiBlbnN1cmVGaWxlU3lzdGVtKCkge1xuICAgIGlmICghZnMpIHtcbiAgICAgICAgZnMgPSByZXF1aXJlKFwiLi4vLi4vZmlsZS1zeXN0ZW1cIik7XG4gICAgfVxufVxudmFyIGNvbXBsZXRlQ2FsbGJhY2s7XG5mdW5jdGlvbiBlbnN1cmVDb21wbGV0ZUNhbGxiYWNrKCkge1xuICAgIGlmIChjb21wbGV0ZUNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29tcGxldGVDYWxsYmFjayA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQXN5bmMuQ29tcGxldGVDYWxsYmFjayh7XG4gICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uIChyZXN1bHQsIGNvbnRleHQpIHtcbiAgICAgICAgICAgIG9uUmVxdWVzdENvbXBsZXRlKGNvbnRleHQsIHJlc3VsdCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvciwgY29udGV4dCkge1xuICAgICAgICAgICAgb25SZXF1ZXN0RXJyb3IoZXJyb3IsIGNvbnRleHQpO1xuICAgICAgICB9LFxuICAgIH0pO1xufVxuZnVuY3Rpb24gb25SZXF1ZXN0Q29tcGxldGUocmVxdWVzdElkLCByZXN1bHQpIHtcbiAgICB2YXIgY2FsbGJhY2tzID0gcGVuZGluZ1JlcXVlc3RzW3JlcXVlc3RJZF07XG4gICAgZGVsZXRlIHBlbmRpbmdSZXF1ZXN0c1tyZXF1ZXN0SWRdO1xuICAgIGlmIChyZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgY2FsbGJhY2tzLnJlamVjdENhbGxiYWNrKG5ldyBFcnJvcihyZXN1bHQuZXJyb3IudG9TdHJpbmcoKSkpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBoZWFkZXJzID0ge307XG4gICAgaWYgKHJlc3VsdC5oZWFkZXJzKSB7XG4gICAgICAgIHZhciBqSGVhZGVycyA9IHJlc3VsdC5oZWFkZXJzO1xuICAgICAgICB2YXIgbGVuZ3RoXzEgPSBqSGVhZGVycy5zaXplKCk7XG4gICAgICAgIHZhciBwYWlyID0gdm9pZCAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aF8xOyBpKyspIHtcbiAgICAgICAgICAgIHBhaXIgPSBqSGVhZGVycy5nZXQoaSk7XG4gICAgICAgICAgICBhZGRIZWFkZXIoaGVhZGVycywgcGFpci5rZXksIHBhaXIudmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChnbG9iYWwuX19pbnNwZWN0b3IgJiYgZ2xvYmFsLl9faW5zcGVjdG9yLmlzQ29ubmVjdGVkKSB7XG4gICAgICAgIGRlYnVnZ2VyXzEuTmV0d29ya0FnZW50LnJlc3BvbnNlUmVjZWl2ZWQocmVxdWVzdElkLCByZXN1bHQsIGhlYWRlcnMpO1xuICAgIH1cbiAgICBjYWxsYmFja3MucmVzb2x2ZUNhbGxiYWNrKHtcbiAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgcmF3OiByZXN1bHQucmF3LFxuICAgICAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uIChlbmNvZGluZykge1xuICAgICAgICAgICAgICAgIHZhciBzdHI7XG4gICAgICAgICAgICAgICAgaWYgKGVuY29kaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IGRlY29kZVJlc3BvbnNlKHJlc3VsdC5yYXcsIGVuY29kaW5nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IHJlc3VsdC5yZXNwb25zZUFzU3RyaW5nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN0ciA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUmVzcG9uc2UgY29udGVudCBtYXkgbm90IGJlIGNvbnZlcnRlZCB0byBzdHJpbmdcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRvSlNPTjogZnVuY3Rpb24gKGVuY29kaW5nKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0cjtcbiAgICAgICAgICAgICAgICBpZiAoZW5jb2RpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gZGVjb2RlUmVzcG9uc2UocmVzdWx0LnJhdywgZW5jb2RpbmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gcmVzdWx0LnJlc3BvbnNlQXNTdHJpbmc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUpTT04oc3RyKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0b0ltYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZW5zdXJlSW1hZ2VTb3VyY2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmVJbWFnZSwgcmVqZWN0SW1hZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5yZXNwb25zZUFzSW1hZ2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUltYWdlKGltYWdlU291cmNlLmZyb21OYXRpdmVTb3VyY2UocmVzdWx0LnJlc3BvbnNlQXNJbWFnZSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0SW1hZ2UobmV3IEVycm9yKFwiUmVzcG9uc2UgY29udGVudCBtYXkgbm90IGJlIGNvbnZlcnRlZCB0byBhbiBJbWFnZVwiKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0b0ZpbGU6IGZ1bmN0aW9uIChkZXN0aW5hdGlvbkZpbGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgZW5zdXJlRmlsZVN5c3RlbSgpO1xuICAgICAgICAgICAgICAgIGlmICghZGVzdGluYXRpb25GaWxlUGF0aCkge1xuICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbkZpbGVQYXRoID0gaHR0cF9yZXF1ZXN0X2NvbW1vbl8xLmdldEZpbGVuYW1lRnJvbVVybChjYWxsYmFja3MudXJsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHN0cmVhbTtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IGZzLkZpbGUuZnJvbVBhdGgoZGVzdGluYXRpb25GaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBqYXZhRmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUoZGVzdGluYXRpb25GaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbSA9IG5ldyBqYXZhLmlvLkZpbGVPdXRwdXRTdHJlYW0oamF2YUZpbGUpO1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW0ud3JpdGUocmVzdWx0LnJhdy50b0J5dGVBcnJheSgpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChleGNlcHRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IHNhdmUgZmlsZSB3aXRoIHBhdGg6IFwiICsgZGVzdGluYXRpb25GaWxlUGF0aCArIFwiLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdHJlYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmVhbS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzdGF0dXNDb2RlOiByZXN1bHQuc3RhdHVzQ29kZSxcbiAgICAgICAgaGVhZGVyczogaGVhZGVyc1xuICAgIH0pO1xufVxuZnVuY3Rpb24gb25SZXF1ZXN0RXJyb3IoZXJyb3IsIHJlcXVlc3RJZCkge1xuICAgIHZhciBjYWxsYmFja3MgPSBwZW5kaW5nUmVxdWVzdHNbcmVxdWVzdElkXTtcbiAgICBkZWxldGUgcGVuZGluZ1JlcXVlc3RzW3JlcXVlc3RJZF07XG4gICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICBjYWxsYmFja3MucmVqZWN0Q2FsbGJhY2sobmV3IEVycm9yKGVycm9yKSk7XG4gICAgfVxufVxuZnVuY3Rpb24gYnVpbGRKYXZhT3B0aW9ucyhvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLnVybCAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJIdHRwIHJlcXVlc3QgbXVzdCBwcm92aWRlIGEgdmFsaWQgdXJsLlwiKTtcbiAgICB9XG4gICAgdmFyIGphdmFPcHRpb25zID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Bc3luYy5IdHRwLlJlcXVlc3RPcHRpb25zKCk7XG4gICAgamF2YU9wdGlvbnMudXJsID0gb3B0aW9ucy51cmw7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLm1ldGhvZCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBqYXZhT3B0aW9ucy5tZXRob2QgPSBvcHRpb25zLm1ldGhvZDtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLmNvbnRlbnQgPT09IFwic3RyaW5nXCIgfHwgb3B0aW9ucy5jb250ZW50IGluc3RhbmNlb2YgRm9ybURhdGEpIHtcbiAgICAgICAgamF2YU9wdGlvbnMuY29udGVudCA9IG9wdGlvbnMuY29udGVudC50b1N0cmluZygpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMudGltZW91dCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICBqYXZhT3B0aW9ucy50aW1lb3V0ID0gb3B0aW9ucy50aW1lb3V0O1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMuZG9udEZvbGxvd1JlZGlyZWN0cyA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgamF2YU9wdGlvbnMuZG9udEZvbGxvd1JlZGlyZWN0cyA9IG9wdGlvbnMuZG9udEZvbGxvd1JlZGlyZWN0cztcbiAgICB9XG4gICAgaWYgKG9wdGlvbnMuaGVhZGVycykge1xuICAgICAgICB2YXIgYXJyYXlMaXN0ID0gbmV3IGphdmEudXRpbC5BcnJheUxpc3QoKTtcbiAgICAgICAgdmFyIHBhaXIgPSBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQXN5bmMuSHR0cC5LZXlWYWx1ZVBhaXI7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBvcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgICAgICAgIGFycmF5TGlzdC5hZGQobmV3IHBhaXIoa2V5LCBvcHRpb25zLmhlYWRlcnNba2V5XSArIFwiXCIpKTtcbiAgICAgICAgfVxuICAgICAgICBqYXZhT3B0aW9ucy5oZWFkZXJzID0gYXJyYXlMaXN0O1xuICAgIH1cbiAgICBlbnN1cmVQbGF0Zm9ybSgpO1xuICAgIHZhciBzY3JlZW4gPSBwbGF0Zm9ybS5zY3JlZW4ubWFpblNjcmVlbjtcbiAgICBqYXZhT3B0aW9ucy5zY3JlZW5XaWR0aCA9IHNjcmVlbi53aWR0aFBpeGVscztcbiAgICBqYXZhT3B0aW9ucy5zY3JlZW5IZWlnaHQgPSBzY3JlZW4uaGVpZ2h0UGl4ZWxzO1xuICAgIHJldHVybiBqYXZhT3B0aW9ucztcbn1cbmZ1bmN0aW9uIHJlcXVlc3Qob3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zID09PSB1bmRlZmluZWQgfHwgb3B0aW9ucyA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgamF2YU9wdGlvbnMgPSBidWlsZEphdmFPcHRpb25zKG9wdGlvbnMpO1xuICAgICAgICAgICAgaWYgKGdsb2JhbC5fX2luc3BlY3RvciAmJiBnbG9iYWwuX19pbnNwZWN0b3IuaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICBkZWJ1Z2dlcl8xLk5ldHdvcmtBZ2VudC5yZXF1ZXN0V2lsbEJlU2VudChyZXF1ZXN0SWRDb3VudGVyLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjYWxsYmFja3MgPSB7XG4gICAgICAgICAgICAgICAgdXJsOiBvcHRpb25zLnVybCxcbiAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGJhY2s6IHJlc29sdmUsXG4gICAgICAgICAgICAgICAgcmVqZWN0Q2FsbGJhY2s6IHJlamVjdFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHBlbmRpbmdSZXF1ZXN0c1tyZXF1ZXN0SWRDb3VudGVyXSA9IGNhbGxiYWNrcztcbiAgICAgICAgICAgIGVuc3VyZUNvbXBsZXRlQ2FsbGJhY2soKTtcbiAgICAgICAgICAgIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Bc3luYy5IdHRwLk1ha2VSZXF1ZXN0KGphdmFPcHRpb25zLCBjb21wbGV0ZUNhbGxiYWNrLCBuZXcgamF2YS5sYW5nLkludGVnZXIocmVxdWVzdElkQ291bnRlcikpO1xuICAgICAgICAgICAgcmVxdWVzdElkQ291bnRlcisrO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgcmVqZWN0KGV4KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0cy5yZXF1ZXN0ID0gcmVxdWVzdDtcbmZ1bmN0aW9uIGRlY29kZVJlc3BvbnNlKHJhdywgZW5jb2RpbmcpIHtcbiAgICB2YXIgY2hhcnNldE5hbWUgPSBcIlVURi04XCI7XG4gICAgaWYgKGVuY29kaW5nID09PSBIdHRwUmVzcG9uc2VFbmNvZGluZy5HQkspIHtcbiAgICAgICAgY2hhcnNldE5hbWUgPSBcIkdCS1wiO1xuICAgIH1cbiAgICByZXR1cm4gcmF3LnRvU3RyaW5nKGNoYXJzZXROYW1lKTtcbn1cbmZ1bmN0aW9uIGFkZEhlYWRlcihoZWFkZXJzLCBrZXksIHZhbHVlKSB7XG4gICAgaWYgKCFoZWFkZXJzW2tleV0pIHtcbiAgICAgICAgaGVhZGVyc1trZXldID0gdmFsdWU7XG4gICAgfVxuICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaGVhZGVyc1trZXldKSkge1xuICAgICAgICBoZWFkZXJzW2tleV0ucHVzaCh2YWx1ZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgdmFsdWVzID0gW2hlYWRlcnNba2V5XV07XG4gICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgaGVhZGVyc1trZXldID0gdmFsdWVzO1xuICAgIH1cbn1cbmV4cG9ydHMuYWRkSGVhZGVyID0gYWRkSGVhZGVyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aHR0cC1yZXF1ZXN0LmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBodHRwUmVxdWVzdCA9IHJlcXVpcmUoXCIuL2h0dHAtcmVxdWVzdFwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2h0dHAtcmVxdWVzdFwiKSk7XG5mdW5jdGlvbiBnZXRTdHJpbmcoYXJnKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgaHR0cFJlcXVlc3QucmVxdWVzdCh0eXBlb2YgYXJnID09PSBcInN0cmluZ1wiID8geyB1cmw6IGFyZywgbWV0aG9kOiBcIkdFVFwiIH0gOiBhcmcpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgc3RyID0gci5jb250ZW50LnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7IHJldHVybiByZWplY3QoZSk7IH0pO1xuICAgIH0pO1xufVxuZXhwb3J0cy5nZXRTdHJpbmcgPSBnZXRTdHJpbmc7XG5mdW5jdGlvbiBnZXRKU09OKGFyZykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGh0dHBSZXF1ZXN0LnJlcXVlc3QodHlwZW9mIGFyZyA9PT0gXCJzdHJpbmdcIiA/IHsgdXJsOiBhcmcsIG1ldGhvZDogXCJHRVRcIiB9IDogYXJnKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIGpzb24gPSByLmNvbnRlbnQudG9KU09OKCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShqc29uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gcmVqZWN0KGUpOyB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuZ2V0SlNPTiA9IGdldEpTT047XG5mdW5jdGlvbiBnZXRJbWFnZShhcmcpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBodHRwUmVxdWVzdC5yZXF1ZXN0KHR5cGVvZiBhcmcgPT09IFwic3RyaW5nXCIgPyB7IHVybDogYXJnLCBtZXRob2Q6IFwiR0VUXCIgfSA6IGFyZylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoci5jb250ZW50LnRvSW1hZ2UoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuZ2V0SW1hZ2UgPSBnZXRJbWFnZTtcbmZ1bmN0aW9uIGdldEZpbGUoYXJnLCBkZXN0aW5hdGlvbkZpbGVQYXRoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgaHR0cFJlcXVlc3QucmVxdWVzdCh0eXBlb2YgYXJnID09PSBcInN0cmluZ1wiID8geyB1cmw6IGFyZywgbWV0aG9kOiBcIkdFVFwiIH0gOiBhcmcpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IHIuY29udGVudC50b0ZpbGUoZGVzdGluYXRpb25GaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gcmVqZWN0KGUpOyB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuZ2V0RmlsZSA9IGdldEZpbGU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1odHRwLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBvYnNlcnZhYmxlXzEgPSByZXF1aXJlKFwiLi4vZGF0YS9vYnNlcnZhYmxlXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vcGxhdGZvcm1cIik7XG52YXIgSW1hZ2VBc3NldEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJbWFnZUFzc2V0QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBJbWFnZUFzc2V0QmFzZSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX29wdGlvbnMgPSB7IGtlZXBBc3BlY3RSYXRpbzogdHJ1ZSwgYXV0b1NjYWxlRmFjdG9yOiB0cnVlIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEltYWdlQXNzZXRCYXNlLnByb3RvdHlwZSwgXCJvcHRpb25zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb3B0aW9ucztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX29wdGlvbnMgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEltYWdlQXNzZXRCYXNlLnByb3RvdHlwZSwgXCJuYXRpdmVJbWFnZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25hdGl2ZUltYWdlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fbmF0aXZlSW1hZ2UgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgSW1hZ2VBc3NldEJhc2UucHJvdG90eXBlLmdldEltYWdlQXN5bmMgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICB9O1xuICAgIHJldHVybiBJbWFnZUFzc2V0QmFzZTtcbn0ob2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpKTtcbmV4cG9ydHMuSW1hZ2VBc3NldEJhc2UgPSBJbWFnZUFzc2V0QmFzZTtcbmZ1bmN0aW9uIGdldEFzcGVjdFNhZmVEaW1lbnNpb25zKHNvdXJjZVdpZHRoLCBzb3VyY2VIZWlnaHQsIHJlcVdpZHRoLCByZXFIZWlnaHQpIHtcbiAgICB2YXIgd2lkdGhDb2VmID0gc291cmNlV2lkdGggLyByZXFXaWR0aDtcbiAgICB2YXIgaGVpZ2h0Q29lZiA9IHNvdXJjZUhlaWdodCAvIHJlcUhlaWdodDtcbiAgICB2YXIgYXNwZWN0Q29lZiA9IE1hdGgubWluKHdpZHRoQ29lZiwgaGVpZ2h0Q29lZik7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgd2lkdGg6IE1hdGguZmxvb3Ioc291cmNlV2lkdGggLyBhc3BlY3RDb2VmKSxcbiAgICAgICAgaGVpZ2h0OiBNYXRoLmZsb29yKHNvdXJjZUhlaWdodCAvIGFzcGVjdENvZWYpXG4gICAgfTtcbn1cbmV4cG9ydHMuZ2V0QXNwZWN0U2FmZURpbWVuc2lvbnMgPSBnZXRBc3BlY3RTYWZlRGltZW5zaW9ucztcbmZ1bmN0aW9uIGdldFJlcXVlc3RlZEltYWdlU2l6ZShzcmMsIG9wdGlvbnMpIHtcbiAgICB2YXIgc2NyZWVuID0gcGxhdGZvcm1fMS5zY3JlZW4ubWFpblNjcmVlbjtcbiAgICB2YXIgcmVxV2lkdGggPSBvcHRpb25zLndpZHRoIHx8IE1hdGgubWluKHNyYy53aWR0aCwgc2NyZWVuLndpZHRoUGl4ZWxzKTtcbiAgICB2YXIgcmVxSGVpZ2h0ID0gb3B0aW9ucy5oZWlnaHQgfHwgTWF0aC5taW4oc3JjLmhlaWdodCwgc2NyZWVuLmhlaWdodFBpeGVscyk7XG4gICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5rZWVwQXNwZWN0UmF0aW8pIHtcbiAgICAgICAgdmFyIHNhZmVBc3BlY3RTaXplID0gZ2V0QXNwZWN0U2FmZURpbWVuc2lvbnMoc3JjLndpZHRoLCBzcmMuaGVpZ2h0LCByZXFXaWR0aCwgcmVxSGVpZ2h0KTtcbiAgICAgICAgcmVxV2lkdGggPSBzYWZlQXNwZWN0U2l6ZS53aWR0aDtcbiAgICAgICAgcmVxSGVpZ2h0ID0gc2FmZUFzcGVjdFNpemUuaGVpZ2h0O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aDogcmVxV2lkdGgsXG4gICAgICAgIGhlaWdodDogcmVxSGVpZ2h0XG4gICAgfTtcbn1cbmV4cG9ydHMuZ2V0UmVxdWVzdGVkSW1hZ2VTaXplID0gZ2V0UmVxdWVzdGVkSW1hZ2VTaXplO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW1hZ2UtYXNzZXQtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaW1hZ2VfYXNzZXRfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9pbWFnZS1hc3NldC1jb21tb25cIik7XG52YXIgZmlsZV9zeXN0ZW1fMSA9IHJlcXVpcmUoXCIuLi9maWxlLXN5c3RlbVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2ltYWdlLWFzc2V0LWNvbW1vblwiKSk7XG52YXIgSW1hZ2VBc3NldCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEltYWdlQXNzZXQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW1hZ2VBc3NldChhc3NldCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICB2YXIgZmlsZU5hbWUgPSB0eXBlb2YgYXNzZXQgPT09IFwic3RyaW5nXCIgPyBhc3NldC50cmltKCkgOiBcIlwiO1xuICAgICAgICBpZiAoZmlsZU5hbWUuaW5kZXhPZihcIn4vXCIpID09PSAwKSB7XG4gICAgICAgICAgICBmaWxlTmFtZSA9IGZpbGVfc3lzdGVtXzEucGF0aC5qb2luKGZpbGVfc3lzdGVtXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoLCBmaWxlTmFtZS5yZXBsYWNlKFwifi9cIiwgXCJcIikpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzLmFuZHJvaWQgPSBmaWxlTmFtZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW1hZ2VBc3NldC5wcm90b3R5cGUsIFwiYW5kcm9pZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FuZHJvaWQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9hbmRyb2lkID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEltYWdlQXNzZXQucHJvdG90eXBlLmdldEltYWdlQXN5bmMgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGJpdG1hcE9wdGlvbnMgPSBuZXcgYW5kcm9pZC5ncmFwaGljcy5CaXRtYXBGYWN0b3J5Lk9wdGlvbnMoKTtcbiAgICAgICAgYml0bWFwT3B0aW9ucy5pbkp1c3REZWNvZGVCb3VuZHMgPSB0cnVlO1xuICAgICAgICB2YXIgYml0bWFwID0gYW5kcm9pZC5ncmFwaGljcy5CaXRtYXBGYWN0b3J5LmRlY29kZUZpbGUodGhpcy5hbmRyb2lkLCBiaXRtYXBPcHRpb25zKTtcbiAgICAgICAgdmFyIHNvdXJjZVNpemUgPSB7XG4gICAgICAgICAgICB3aWR0aDogYml0bWFwT3B0aW9ucy5vdXRXaWR0aCxcbiAgICAgICAgICAgIGhlaWdodDogYml0bWFwT3B0aW9ucy5vdXRIZWlnaHRcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHJlcXVlc3RlZFNpemUgPSBpbWFnZV9hc3NldF9jb21tb25fMS5nZXRSZXF1ZXN0ZWRJbWFnZVNpemUoc291cmNlU2l6ZSwgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgdmFyIHNhbXBsZVNpemUgPSBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuaW1hZ2UuRmV0Y2hlci5jYWxjdWxhdGVJblNhbXBsZVNpemUoYml0bWFwT3B0aW9ucy5vdXRXaWR0aCwgYml0bWFwT3B0aW9ucy5vdXRIZWlnaHQsIHJlcXVlc3RlZFNpemUud2lkdGgsIHJlcXVlc3RlZFNpemUuaGVpZ2h0KTtcbiAgICAgICAgdmFyIGZpbmFsQml0bWFwT3B0aW9ucyA9IG5ldyBhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcEZhY3RvcnkuT3B0aW9ucygpO1xuICAgICAgICBmaW5hbEJpdG1hcE9wdGlvbnMuaW5TYW1wbGVTaXplID0gc2FtcGxlU2l6ZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBlcnJvciA9IG51bGw7XG4gICAgICAgICAgICBiaXRtYXAgPSBhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcEZhY3RvcnkuZGVjb2RlRmlsZSh0aGlzLmFuZHJvaWQsIGZpbmFsQml0bWFwT3B0aW9ucyk7XG4gICAgICAgICAgICBpZiAoYml0bWFwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlcXVlc3RlZFNpemUud2lkdGggIT09IGJpdG1hcC5nZXRXaWR0aCgpIHx8IHJlcXVlc3RlZFNpemUuaGVpZ2h0ICE9PSBiaXRtYXAuZ2V0SGVpZ2h0KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYml0bWFwID0gYW5kcm9pZC5ncmFwaGljcy5CaXRtYXAuY3JlYXRlU2NhbGVkQml0bWFwKGJpdG1hcCwgcmVxdWVzdGVkU2l6ZS53aWR0aCwgcmVxdWVzdGVkU2l6ZS5oZWlnaHQsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcm90YXRpb25BbmdsZSA9IGNhbGN1bGF0ZUFuZ2xlRnJvbUZpbGUodGhpcy5hbmRyb2lkKTtcbiAgICAgICAgICAgICAgICBpZiAocm90YXRpb25BbmdsZSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWF0cml4ID0gbmV3IGFuZHJvaWQuZ3JhcGhpY3MuTWF0cml4KCk7XG4gICAgICAgICAgICAgICAgICAgIG1hdHJpeC5wb3N0Um90YXRlKHJvdGF0aW9uQW5nbGUpO1xuICAgICAgICAgICAgICAgICAgICBiaXRtYXAgPSBhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcC5jcmVhdGVCaXRtYXAoYml0bWFwLCAwLCAwLCBiaXRtYXAuZ2V0V2lkdGgoKSwgYml0bWFwLmdldEhlaWdodCgpLCBtYXRyaXgsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghYml0bWFwKSB7XG4gICAgICAgICAgICAgICAgZXJyb3IgPSBcIkFzc2V0ICdcIiArIHRoaXMuYW5kcm9pZCArIFwiJyBjYW5ub3QgYmUgZm91bmQuXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYWxsYmFjayhiaXRtYXAsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGV4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEltYWdlQXNzZXQ7XG59KGltYWdlX2Fzc2V0X2NvbW1vbl8xLkltYWdlQXNzZXRCYXNlKSk7XG5leHBvcnRzLkltYWdlQXNzZXQgPSBJbWFnZUFzc2V0O1xuZnVuY3Rpb24gY2FsY3VsYXRlQW5nbGVGcm9tRmlsZShmaWxlbmFtZSkge1xuICAgIHZhciByb3RhdGlvbkFuZ2xlID0gMDtcbiAgICB2YXIgZWkgPSBuZXcgYW5kcm9pZC5tZWRpYS5FeGlmSW50ZXJmYWNlKGZpbGVuYW1lKTtcbiAgICB2YXIgb3JpZW50YXRpb24gPSBlaS5nZXRBdHRyaWJ1dGVJbnQoYW5kcm9pZC5tZWRpYS5FeGlmSW50ZXJmYWNlLlRBR19PUklFTlRBVElPTiwgYW5kcm9pZC5tZWRpYS5FeGlmSW50ZXJmYWNlLk9SSUVOVEFUSU9OX05PUk1BTCk7XG4gICAgc3dpdGNoIChvcmllbnRhdGlvbikge1xuICAgICAgICBjYXNlIGFuZHJvaWQubWVkaWEuRXhpZkludGVyZmFjZS5PUklFTlRBVElPTl9ST1RBVEVfOTA6XG4gICAgICAgICAgICByb3RhdGlvbkFuZ2xlID0gOTA7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBhbmRyb2lkLm1lZGlhLkV4aWZJbnRlcmZhY2UuT1JJRU5UQVRJT05fUk9UQVRFXzE4MDpcbiAgICAgICAgICAgIHJvdGF0aW9uQW5nbGUgPSAxODA7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBhbmRyb2lkLm1lZGlhLkV4aWZJbnRlcmZhY2UuT1JJRU5UQVRJT05fUk9UQVRFXzI3MDpcbiAgICAgICAgICAgIHJvdGF0aW9uQW5nbGUgPSAyNzA7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIHJvdGF0aW9uQW5nbGU7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1hc3NldC5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmaWxlX3N5c3RlbV8xID0gcmVxdWlyZShcIi4uL2ZpbGUtc3lzdGVtXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vdXRpbHMvdXRpbHNcIik7XG5leHBvcnRzLmlzRmlsZU9yUmVzb3VyY2VQYXRoID0gdXRpbHNfMS5pc0ZpbGVPclJlc291cmNlUGF0aDtcbnZhciBhcHBsaWNhdGlvbl8xID0gcmVxdWlyZShcIi4uL2FwcGxpY2F0aW9uXCIpO1xudmFyIGh0dHA7XG5mdW5jdGlvbiBlbnN1cmVIdHRwKCkge1xuICAgIGlmICghaHR0cCkge1xuICAgICAgICBodHRwID0gcmVxdWlyZShcIi4uL2h0dHBcIik7XG4gICAgfVxufVxudmFyIGFwcGxpY2F0aW9uO1xudmFyIHJlc291cmNlcztcbmZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uKCkge1xuICAgIGlmICghYXBwbGljYXRpb24pIHtcbiAgICAgICAgYXBwbGljYXRpb24gPSBhcHBsaWNhdGlvbl8xLmdldE5hdGl2ZUFwcGxpY2F0aW9uKCk7XG4gICAgfVxuICAgIHJldHVybiBhcHBsaWNhdGlvbjtcbn1cbmZ1bmN0aW9uIGdldFJlc291cmNlcygpIHtcbiAgICBpZiAoIXJlc291cmNlcykge1xuICAgICAgICByZXNvdXJjZXMgPSBnZXRBcHBsaWNhdGlvbigpLmdldFJlc291cmNlcygpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzb3VyY2VzO1xufVxudmFyIEltYWdlU291cmNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBJbWFnZVNvdXJjZSgpIHtcbiAgICB9XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmZyb21Bc3NldCA9IGZ1bmN0aW9uIChhc3NldCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgYXNzZXQuZ2V0SW1hZ2VBc3luYyhmdW5jdGlvbiAoaW1hZ2UsIGVycikge1xuICAgICAgICAgICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXROYXRpdmVTb3VyY2UoaW1hZ2UpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5sb2FkRnJvbVJlc291cmNlID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdGhpcy5hbmRyb2lkID0gbnVsbDtcbiAgICAgICAgdmFyIHJlcyA9IGdldFJlc291cmNlcygpO1xuICAgICAgICBpZiAocmVzKSB7XG4gICAgICAgICAgICB2YXIgaWRlbnRpZmllciA9IHJlcy5nZXRJZGVudGlmaWVyKG5hbWUsIFwiZHJhd2FibGVcIiwgZ2V0QXBwbGljYXRpb24oKS5nZXRQYWNrYWdlTmFtZSgpKTtcbiAgICAgICAgICAgIGlmICgwIDwgaWRlbnRpZmllcikge1xuICAgICAgICAgICAgICAgIHZhciBiaXRtYXBEcmF3YWJsZSA9IHJlcy5nZXREcmF3YWJsZShpZGVudGlmaWVyKTtcbiAgICAgICAgICAgICAgICBpZiAoYml0bWFwRHJhd2FibGUgJiYgYml0bWFwRHJhd2FibGUuZ2V0Qml0bWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYW5kcm9pZCA9IGJpdG1hcERyYXdhYmxlLmdldEJpdG1hcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5hbmRyb2lkICE9IG51bGw7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUuZnJvbVJlc291cmNlID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHJlc29sdmUoX3RoaXMubG9hZEZyb21SZXNvdXJjZShuYW1lKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLnNldFJvdGF0aW9uQW5nbGVGcm9tRmlsZSA9IGZ1bmN0aW9uIChmaWxlbmFtZSkge1xuICAgICAgICB0aGlzLnJvdGF0aW9uQW5nbGUgPSAwO1xuICAgICAgICB2YXIgZWkgPSBuZXcgYW5kcm9pZC5tZWRpYS5FeGlmSW50ZXJmYWNlKGZpbGVuYW1lKTtcbiAgICAgICAgdmFyIG9yaWVudGF0aW9uID0gZWkuZ2V0QXR0cmlidXRlSW50KGFuZHJvaWQubWVkaWEuRXhpZkludGVyZmFjZS5UQUdfT1JJRU5UQVRJT04sIGFuZHJvaWQubWVkaWEuRXhpZkludGVyZmFjZS5PUklFTlRBVElPTl9OT1JNQUwpO1xuICAgICAgICBzd2l0Y2ggKG9yaWVudGF0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQubWVkaWEuRXhpZkludGVyZmFjZS5PUklFTlRBVElPTl9ST1RBVEVfOTA6XG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGlvbkFuZ2xlID0gOTA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQubWVkaWEuRXhpZkludGVyZmFjZS5PUklFTlRBVElPTl9ST1RBVEVfMTgwOlxuICAgICAgICAgICAgICAgIHRoaXMucm90YXRpb25BbmdsZSA9IDE4MDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC5tZWRpYS5FeGlmSW50ZXJmYWNlLk9SSUVOVEFUSU9OX1JPVEFURV8yNzA6XG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGlvbkFuZ2xlID0gMjcwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUubG9hZEZyb21GaWxlID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIGZpbGVOYW1lID0gdHlwZW9mIHBhdGggPT09IFwic3RyaW5nXCIgPyBwYXRoLnRyaW0oKSA6IFwiXCI7XG4gICAgICAgIGlmIChmaWxlTmFtZS5pbmRleE9mKFwifi9cIikgPT09IDApIHtcbiAgICAgICAgICAgIGZpbGVOYW1lID0gZmlsZV9zeXN0ZW1fMS5wYXRoLmpvaW4oZmlsZV9zeXN0ZW1fMS5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgsIGZpbGVOYW1lLnJlcGxhY2UoXCJ+L1wiLCBcIlwiKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRSb3RhdGlvbkFuZ2xlRnJvbUZpbGUoZmlsZU5hbWUpO1xuICAgICAgICB0aGlzLmFuZHJvaWQgPSBhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcEZhY3RvcnkuZGVjb2RlRmlsZShmaWxlTmFtZSwgbnVsbCk7XG4gICAgICAgIHJldHVybiB0aGlzLmFuZHJvaWQgIT0gbnVsbDtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5mcm9tRmlsZSA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICByZXNvbHZlKF90aGlzLmxvYWRGcm9tRmlsZShwYXRoKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmxvYWRGcm9tRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRoaXMuYW5kcm9pZCA9IGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwRmFjdG9yeS5kZWNvZGVTdHJlYW0oZGF0YSk7XG4gICAgICAgIHJldHVybiB0aGlzLmFuZHJvaWQgIT0gbnVsbDtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5mcm9tRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICByZXNvbHZlKF90aGlzLmxvYWRGcm9tRGF0YShkYXRhKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmxvYWRGcm9tQmFzZTY0ID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICBpZiAodHlwZW9mIHNvdXJjZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIGJ5dGVzID0gYW5kcm9pZC51dGlsLkJhc2U2NC5kZWNvZGUoc291cmNlLCBhbmRyb2lkLnV0aWwuQmFzZTY0LkRFRkFVTFQpO1xuICAgICAgICAgICAgdGhpcy5hbmRyb2lkID0gYW5kcm9pZC5ncmFwaGljcy5CaXRtYXBGYWN0b3J5LmRlY29kZUJ5dGVBcnJheShieXRlcywgMCwgYnl0ZXMubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5hbmRyb2lkICE9IG51bGw7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUuZnJvbUJhc2U2NCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICByZXNvbHZlKF90aGlzLmxvYWRGcm9tQmFzZTY0KGRhdGEpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUubG9hZEZyb21Gb250SWNvbkNvZGUgPSBmdW5jdGlvbiAoc291cmNlLCBmb250LCBjb2xvcikge1xuICAgICAgICB2YXIgcGFpbnQgPSBuZXcgYW5kcm9pZC5ncmFwaGljcy5QYWludCgpO1xuICAgICAgICBwYWludC5zZXRUeXBlZmFjZShmb250LmdldEFuZHJvaWRUeXBlZmFjZSgpKTtcbiAgICAgICAgcGFpbnQuc2V0QW50aUFsaWFzKHRydWUpO1xuICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgIHBhaW50LnNldENvbG9yKGNvbG9yLmFuZHJvaWQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmb250U2l6ZSA9IHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGZvbnQuZm9udFNpemUpO1xuICAgICAgICBpZiAoIWZvbnRTaXplKSB7XG4gICAgICAgICAgICBmb250U2l6ZSA9IHBhaW50LmdldFRleHRTaXplKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRlbnNpdHkgPSB1dGlsc18xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgICAgICB2YXIgc2NhbGVkRm9udFNpemUgPSBmb250U2l6ZSAqIGRlbnNpdHk7XG4gICAgICAgIHBhaW50LnNldFRleHRTaXplKHNjYWxlZEZvbnRTaXplKTtcbiAgICAgICAgdmFyIHRleHRCb3VuZHMgPSBuZXcgYW5kcm9pZC5ncmFwaGljcy5SZWN0KCk7XG4gICAgICAgIHBhaW50LmdldFRleHRCb3VuZHMoc291cmNlLCAwLCBzb3VyY2UubGVuZ3RoLCB0ZXh0Qm91bmRzKTtcbiAgICAgICAgdmFyIHRleHRXaWR0aCA9IHRleHRCb3VuZHMud2lkdGgoKTtcbiAgICAgICAgdmFyIHRleHRIZWlnaHQgPSB0ZXh0Qm91bmRzLmhlaWdodCgpO1xuICAgICAgICBpZiAodGV4dFdpZHRoID4gMCAmJiB0ZXh0SGVpZ2h0ID4gMCkge1xuICAgICAgICAgICAgdmFyIGJpdG1hcCA9IGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwXG4gICAgICAgICAgICAgICAgLmNyZWF0ZUJpdG1hcCh0ZXh0V2lkdGgsIHRleHRIZWlnaHQsIGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwLkNvbmZpZy5BUkdCXzg4ODgpO1xuICAgICAgICAgICAgdmFyIGNhbnZhcyA9IG5ldyBhbmRyb2lkLmdyYXBoaWNzLkNhbnZhcyhiaXRtYXApO1xuICAgICAgICAgICAgY2FudmFzLmRyYXdUZXh0KHNvdXJjZSwgLXRleHRCb3VuZHMubGVmdCwgLXRleHRCb3VuZHMudG9wLCBwYWludCk7XG4gICAgICAgICAgICB0aGlzLmFuZHJvaWQgPSBiaXRtYXA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuYW5kcm9pZCAhPSBudWxsO1xuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLnNldE5hdGl2ZVNvdXJjZSA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgICAgaWYgKHNvdXJjZSAmJiAhKHNvdXJjZSBpbnN0YW5jZW9mIGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIG1ldGhvZCBzZXROYXRpdmVTb3VyY2UoKSBleHBlY3RzIGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwIGluc3RhbmNlLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFuZHJvaWQgPSBzb3VyY2U7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUuc2F2ZVRvRmlsZSA9IGZ1bmN0aW9uIChwYXRoLCBmb3JtYXQsIHF1YWxpdHkpIHtcbiAgICAgICAgaWYgKHF1YWxpdHkgPT09IHZvaWQgMCkgeyBxdWFsaXR5ID0gMTAwOyB9XG4gICAgICAgIGlmICghdGhpcy5hbmRyb2lkKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRhcmdldEZvcm1hdCA9IGdldFRhcmdldEZvcm1hdChmb3JtYXQpO1xuICAgICAgICB2YXIgb3V0cHV0U3RyZWFtID0gbmV3IGphdmEuaW8uQnVmZmVyZWRPdXRwdXRTdHJlYW0obmV3IGphdmEuaW8uRmlsZU91dHB1dFN0cmVhbShwYXRoKSk7XG4gICAgICAgIHZhciByZXMgPSB0aGlzLmFuZHJvaWQuY29tcHJlc3ModGFyZ2V0Rm9ybWF0LCBxdWFsaXR5LCBvdXRwdXRTdHJlYW0pO1xuICAgICAgICBvdXRwdXRTdHJlYW0uY2xvc2UoKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS50b0Jhc2U2NFN0cmluZyA9IGZ1bmN0aW9uIChmb3JtYXQsIHF1YWxpdHkpIHtcbiAgICAgICAgaWYgKHF1YWxpdHkgPT09IHZvaWQgMCkgeyBxdWFsaXR5ID0gMTAwOyB9XG4gICAgICAgIGlmICghdGhpcy5hbmRyb2lkKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGFyZ2V0Rm9ybWF0ID0gZ2V0VGFyZ2V0Rm9ybWF0KGZvcm1hdCk7XG4gICAgICAgIHZhciBvdXRwdXRTdHJlYW0gPSBuZXcgamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW0oKTtcbiAgICAgICAgdmFyIGJhc2U2NFN0cmVhbSA9IG5ldyBhbmRyb2lkLnV0aWwuQmFzZTY0T3V0cHV0U3RyZWFtKG91dHB1dFN0cmVhbSwgYW5kcm9pZC51dGlsLkJhc2U2NC5OT19XUkFQKTtcbiAgICAgICAgdGhpcy5hbmRyb2lkLmNvbXByZXNzKHRhcmdldEZvcm1hdCwgcXVhbGl0eSwgYmFzZTY0U3RyZWFtKTtcbiAgICAgICAgYmFzZTY0U3RyZWFtLmNsb3NlKCk7XG4gICAgICAgIG91dHB1dFN0cmVhbS5jbG9zZSgpO1xuICAgICAgICByZXR1cm4gb3V0cHV0U3RyZWFtLnRvU3RyaW5nKCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW1hZ2VTb3VyY2UucHJvdG90eXBlLCBcImhlaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYW5kcm9pZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFuZHJvaWQuZ2V0SGVpZ2h0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gTmFOO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW1hZ2VTb3VyY2UucHJvdG90eXBlLCBcIndpZHRoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hbmRyb2lkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYW5kcm9pZC5nZXRXaWR0aCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE5hTjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEltYWdlU291cmNlLnByb3RvdHlwZSwgXCJyb3RhdGlvbkFuZ2xlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcm90YXRpb25BbmdsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX3JvdGF0aW9uQW5nbGUgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIEltYWdlU291cmNlO1xufSgpKTtcbmV4cG9ydHMuSW1hZ2VTb3VyY2UgPSBJbWFnZVNvdXJjZTtcbmZ1bmN0aW9uIGdldFRhcmdldEZvcm1hdChmb3JtYXQpIHtcbiAgICBzd2l0Y2ggKGZvcm1hdCkge1xuICAgICAgICBjYXNlIFwianBlZ1wiOlxuICAgICAgICBjYXNlIFwianBnXCI6XG4gICAgICAgICAgICByZXR1cm4gYW5kcm9pZC5ncmFwaGljcy5CaXRtYXAuQ29tcHJlc3NGb3JtYXQuSlBFRztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcC5Db21wcmVzc0Zvcm1hdC5QTkc7XG4gICAgfVxufVxuZnVuY3Rpb24gZnJvbUFzc2V0KGFzc2V0KSB7XG4gICAgdmFyIGltYWdlID0gbmV3IEltYWdlU291cmNlKCk7XG4gICAgcmV0dXJuIGltYWdlLmZyb21Bc3NldChhc3NldCk7XG59XG5leHBvcnRzLmZyb21Bc3NldCA9IGZyb21Bc3NldDtcbmZ1bmN0aW9uIGZyb21SZXNvdXJjZShuYW1lKSB7XG4gICAgdmFyIGltYWdlID0gbmV3IEltYWdlU291cmNlKCk7XG4gICAgcmV0dXJuIGltYWdlLmxvYWRGcm9tUmVzb3VyY2UobmFtZSkgPyBpbWFnZSA6IG51bGw7XG59XG5leHBvcnRzLmZyb21SZXNvdXJjZSA9IGZyb21SZXNvdXJjZTtcbmZ1bmN0aW9uIGZyb21GaWxlKHBhdGgpIHtcbiAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2VTb3VyY2UoKTtcbiAgICByZXR1cm4gaW1hZ2UubG9hZEZyb21GaWxlKHBhdGgpID8gaW1hZ2UgOiBudWxsO1xufVxuZXhwb3J0cy5mcm9tRmlsZSA9IGZyb21GaWxlO1xuZnVuY3Rpb24gZnJvbURhdGEoZGF0YSkge1xuICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZVNvdXJjZSgpO1xuICAgIHJldHVybiBpbWFnZS5sb2FkRnJvbURhdGEoZGF0YSkgPyBpbWFnZSA6IG51bGw7XG59XG5leHBvcnRzLmZyb21EYXRhID0gZnJvbURhdGE7XG5mdW5jdGlvbiBmcm9tRm9udEljb25Db2RlKHNvdXJjZSwgZm9udCwgY29sb3IpIHtcbiAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2VTb3VyY2UoKTtcbiAgICByZXR1cm4gaW1hZ2UubG9hZEZyb21Gb250SWNvbkNvZGUoc291cmNlLCBmb250LCBjb2xvcikgPyBpbWFnZSA6IG51bGw7XG59XG5leHBvcnRzLmZyb21Gb250SWNvbkNvZGUgPSBmcm9tRm9udEljb25Db2RlO1xuZnVuY3Rpb24gZnJvbUJhc2U2NChzb3VyY2UpIHtcbiAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2VTb3VyY2UoKTtcbiAgICByZXR1cm4gaW1hZ2UubG9hZEZyb21CYXNlNjQoc291cmNlKSA/IGltYWdlIDogbnVsbDtcbn1cbmV4cG9ydHMuZnJvbUJhc2U2NCA9IGZyb21CYXNlNjQ7XG5mdW5jdGlvbiBmcm9tTmF0aXZlU291cmNlKHNvdXJjZSkge1xuICAgIHZhciBpbWFnZVNvdXJjZSA9IG5ldyBJbWFnZVNvdXJjZSgpO1xuICAgIGltYWdlU291cmNlLnNldE5hdGl2ZVNvdXJjZShzb3VyY2UpO1xuICAgIHJldHVybiBpbWFnZVNvdXJjZTtcbn1cbmV4cG9ydHMuZnJvbU5hdGl2ZVNvdXJjZSA9IGZyb21OYXRpdmVTb3VyY2U7XG5mdW5jdGlvbiBmcm9tVXJsKHVybCkge1xuICAgIGVuc3VyZUh0dHAoKTtcbiAgICByZXR1cm4gaHR0cC5nZXRJbWFnZSh1cmwpO1xufVxuZXhwb3J0cy5mcm9tVXJsID0gZnJvbVVybDtcbmZ1bmN0aW9uIGZyb21GaWxlT3JSZXNvdXJjZShwYXRoKSB7XG4gICAgaWYgKCF1dGlsc18xLmlzRmlsZU9yUmVzb3VyY2VQYXRoKHBhdGgpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihwYXRoICsgXCIgaXMgbm90IGEgdmFsaWQgZmlsZSBvciByZXNvdXJjZS5cIik7XG4gICAgfVxuICAgIGlmIChwYXRoLmluZGV4T2YodXRpbHNfMS5SRVNPVVJDRV9QUkVGSVgpID09PSAwKSB7XG4gICAgICAgIHJldHVybiBmcm9tUmVzb3VyY2UocGF0aC5zdWJzdHIodXRpbHNfMS5SRVNPVVJDRV9QUkVGSVgubGVuZ3RoKSk7XG4gICAgfVxuICAgIHJldHVybiBmcm9tRmlsZShwYXRoKTtcbn1cbmV4cG9ydHMuZnJvbUZpbGVPclJlc291cmNlID0gZnJvbUZpbGVPclJlc291cmNlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW1hZ2Utc291cmNlLmFuZHJvaWQuanMubWFwIiwi77u/XHQvKlxuXHRuZXcgZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHBhcnNlciA9IG5ldyBFYXN5U0FYUGFyc2VyKCk7XG5cblx0XHRwYXJzZXIubnMoJ3JzcycsIHsgLy8gb3IgZmFsc2Vcblx0XHRcdHJzczogJ2h0dHA6Ly9wdXJsLm9yZy9yc3MvMS4wLycsXG5cdFx0XHRhdG9tOiAnaHR0cDovL3d3dy53My5vcmcvMjAwNS9BdG9tJyxcblx0XHRcdHhodG1sOiAnaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCcsXG5cdFx0XHRtZWRpYTogJ2h0dHA6Ly9zZWFyY2gueWFob28uY29tL21yc3MvJ1xuXHRcdH0pO1xuXG5cblx0XHRwYXJzZXIub24oJ2Vycm9yJywgZnVuY3Rpb24obXNnKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKG1zZylcblx0XHR9KTtcblxuXHRcdHBhcnNlci5vbignc3RhcnROb2RlJywgZnVuY3Rpb24oZWxlbSwgYXR0ciwgdXEsIHRhZ2VuZCwgZ2V0U3RyTm9kZSkge1xuXHRcdFx0YXR0cigpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdFx0aWYgKHRhZ2VuZCkge1xuXHRcdFx0XHRjb25zb2xlLmxvZygnICAgJytzdHIpXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLmxvZygnKyAgJytzdHIpXG5cdFx0XHR9O1xuXHRcdH0pO1xuXG5cdFx0cGFyc2VyLm9uKCdlbmROb2RlJywgZnVuY3Rpb24oZWxlbSwgdXEsIHRhZ3N0YXJ0LCBzdHIpIHtcblx0XHRcdHJldHVybjtcblx0XHRcdGlmICghdGFnc3RhcnQpIGNvbnNvbGUubG9nKCctICAnICsgc3RyKVxuXHRcdH0pO1xuXG5cdFx0cGFyc2VyLm9uKCd0ZXh0Tm9kZScsIGZ1bmN0aW9uKHMsIHVxKSB7XG5cdFx0XHR1cShzKTtcblx0XHRcdHJldHVyblxuXHRcdFx0Y29uc29sZS5sb2coJyAgICcrcylcblx0XHR9KTtcblxuXHRcdHBhcnNlci5vbignY2RhdGEnLCBmdW5jdGlvbihkYXRhKSB7XG5cdFx0fSk7XG5cblxuXHRcdHBhcnNlci5vbignY29tbWVudCcsIGZ1bmN0aW9uKHRleHQpIHtcblx0XHRcdC8vY29uc29sZS5sb2coJy0tJyt0ZXh0KyctLScpXG5cdFx0fSk7XG5cblx0XHQvL3BhcnNlci5vbigncXVlc3Rpb24nLCBmdW5jdGlvbigpIHt9KTsgLy8gPD8gLi4uID8+XG5cdFx0Ly9wYXJzZXIub24oJ2F0dGVudGlvbicsIGZ1bmN0aW9uKCkge30pOyAvLyA8IVhYWFhYIHp6eno9XCJlZWVlXCI+XG5cblx0XHRjb25zb2xlLnRpbWUoJ2Vhc3lzYXgnKTtcblx0XHRmb3IodmFyIHo9MTAwMDt6LS07KSB7XG5cdFx0XHRwYXJzZXIucGFyc2UoeG1sKVxuXHRcdH07XG5cdFx0Y29uc29sZS50aW1lRW5kKCdlYXN5c2F4Jyk7XG5cdH07XG5cblxuXHQqL1xuXG4vLyA8PCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gPj4gLy9cblxuXG5pZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnIC8qJiYgdGhpcyA9PSBleHBvcnRzKi8pIHtcblx0bW9kdWxlLmV4cG9ydHMuRWFzeVNBWFBhcnNlciA9IEVhc3lTQVhQYXJzZXI7XG59O1xuXG5mdW5jdGlvbiBFYXN5U0FYUGFyc2VyKCkge1xuXHQndXNlIHN0cmljdCc7XG5cblx0aWYgKCF0aGlzKSByZXR1cm4gbnVsbDtcblxuICAgIHRoaXMuYW5ndWxhclN5bnRheCA9IGZhbHNlO1xuXG5cdGZ1bmN0aW9uIG51bGxGdW5jKCkge307XG5cblx0dGhpcy5vblRleHROb2RlID0gbnVsbEZ1bmM7XG4gICAgdGhpcy5vblN0YXJ0Tm9kZSA9IG51bGxGdW5jO1xuICAgIHRoaXMub25FbmROb2RlID0gbnVsbEZ1bmM7XG4gICAgdGhpcy5vbkNEQVRBID0gbnVsbEZ1bmM7XG4gICAgdGhpcy5vbkVycm9yID0gbnVsbEZ1bmM7XG4gICAgdGhpcy5vbkNvbW1lbnQgPSBudWxsO1xuICAgIHRoaXMub25RdWVzdGlvbiA9IG51bGw7XG4gICAgdGhpcy5vbkF0dGVudGlvbiA9IG51bGw7XG5cdHRoaXMuaXNfb25Db21tZW50ID0gdGhpcy5pc19vblF1ZXN0aW9uID0gdGhpcy5pc19vbkF0dGVudGlvbiA9IGZhbHNlO1xuXG5cdHRoaXMuaXNOYW1lc3BhY2UgPSBmYWxzZTtcbiAgICB0aGlzLnVzZU5TID0gbnVsbDtcbiAgICB0aGlzLmRlZmF1bHRfeG1sbnMgPSBudWxsO1xuICAgIHRoaXMueG1sbnMgPSBudWxsO1xuXHR0aGlzLm5zbWF0cml4ID0ge3htbG5zOiB0aGlzLnhtbG5zfTtcblx0dGhpcy5oYXNTdXJtaXNlTlMgPSBmYWxzZTtcblx0O1xuXG5cblx0dGhpcy5hdHRyX3N0cmluZyA9ICcnOyAvLyDRgdGC0YDQvtC60LAg0LDRgtGA0LjQsdGD0YLQvtCyXG5cdHRoaXMuYXR0cl9wb3NzdGFydCA9IDA7IC8vXG5cdHRoaXMuYXR0cl9yZXM7IC8vINC30LDQutC10YjQuNGA0L7QstCw0L3QvdGL0Lkg0YDQtdC30YPQu9GM0YLQsNGCINGA0LDQt9Cx0L7RgNCwINCw0YLRgNC40LHRg9GC0L7QsiAsIG51bGwgLSDRgNCw0LfQsdC+0YAg0L3QtSDQv9GA0L7QstC+0LTQuNC70YHRjywgb2JqZWN0IC0g0YXQtdGIINCw0YLRgNC40LHRg9GC0L7QsiwgdHJ1ZSAtINC90LXRgiDQsNGC0YDQuNCx0YPRgtC+0LIsIGZhbHNlIC0g0L3QtdCy0LDQu9C40LTQvdGL0LkgeG1sXG59XG5cbkVhc3lTQVhQYXJzZXIucHJvdG90eXBlLm9uID0gZnVuY3Rpb24obmFtZSwgY2IpIHtcbiAgICBpZiAodHlwZW9mIGNiICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGlmIChjYiAhPT0gbnVsbCkgcmV0dXJuO1xuICAgIH07XG5cbiAgICBzd2l0Y2gobmFtZSkge1xuICAgICAgICBjYXNlICdlcnJvcic6IHRoaXMub25FcnJvciA9IGNiIHx8IG51bGxGdW5jOyBicmVhaztcbiAgICAgICAgY2FzZSAnc3RhcnROb2RlJzogdGhpcy5vblN0YXJ0Tm9kZSA9IGNiIHx8IG51bGxGdW5jOyBicmVhaztcbiAgICAgICAgY2FzZSAnZW5kTm9kZSc6IHRoaXMub25FbmROb2RlID0gY2IgfHwgbnVsbEZ1bmM7IGJyZWFrO1xuICAgICAgICBjYXNlICd0ZXh0Tm9kZSc6IHRoaXMub25UZXh0Tm9kZSA9IGNiIHx8IG51bGxGdW5jOyBicmVhaztcbiAgICAgICAgY2FzZSAnY2RhdGEnOiB0aGlzLm9uQ0RBVEEgPSBjYiB8fCBudWxsRnVuYzsgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnY29tbWVudCc6IHRoaXMub25Db21tZW50ID0gY2I7IHRoaXMuaXNfb25Db21tZW50ID0gISFjYjsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3F1ZXN0aW9uJzogdGhpcy5vblF1ZXN0aW9uID0gY2I7IHRoaXMuaXNfb25RdWVzdGlvbiA9ICEhY2I7IGJyZWFrOyAvLyA8PyAuLi4uICA/PlxuICAgICAgICBjYXNlICdhdHRlbnRpb24nOiB0aGlzLm9uQXR0ZW50aW9uID0gY2I7IHRoaXMuaXNfb25BdHRlbnRpb24gPSAhIWNiOyBicmVhazsgLy8gPCFYWFhYWCB6enp6PVwiZWVlZVwiPlxuICAgIH07XG59O1xuXG5FYXN5U0FYUGFyc2VyLnByb3RvdHlwZS5ucyA9IGZ1bmN0aW9uKHJvb3QsIG5zKSB7XG4gICAgaWYgKCFyb290IHx8IHR5cGVvZiByb290ICE9PSAnc3RyaW5nJyB8fCAhbnMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH07XG5cbiAgICB2YXIgdSwgeCA9IHt9LCBvaywgdiwgaTtcblxuICAgIGZvcihpIGluIG5zKSB7XG4gICAgICAgIHYgPSBuc1tpXTtcbiAgICAgICAgaWYgKHR5cGVvZiB2ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgaWYgKHJvb3QgPT09IHYpIG9rID0gdHJ1ZTtcbiAgICAgICAgICAgIHhbaV0gPSB2O1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBpZiAob2spIHtcbiAgICAgICAgdGhpcy5pc05hbWVzcGFjZSA9IHRydWU7XG4gICAgICAgIHRoaXMuZGVmYXVsdF94bWxucyA9IHJvb3Q7XG4gICAgICAgIHRoaXMudXNlTlMgPSB4O1xuICAgIH07XG59O1xuXG5cbkVhc3lTQVhQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24oeG1sKSB7XG4gICAgaWYgKHR5cGVvZiB4bWwgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9O1xuXG4gICAgaWYgKHRoaXMuaXNOYW1lc3BhY2UpIHtcbiAgICAgICAgdGhpcy5uc21hdHJpeCA9IHt4bWxuczogdGhpcy5kZWZhdWx0X3htbG5zfTtcblxuICAgICAgICBwYXJzZSh4bWwpO1xuXG4gICAgICAgIHRoaXMubnNtYXRyaXggPSBmYWxzZTtcblxuICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcnNlKHhtbCk7XG4gICAgfTtcblxuICAgIHRoaXMuYXR0cl9yZXMgPSB0cnVlO1xufTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxudmFyIHhoYXJzUXVvdD17Y29uc3RydWN0b3I6IGZhbHNlLCBoYXNPd25Qcm9wZXJ0eTogZmFsc2UsIGlzUHJvdG90eXBlT2Y6IGZhbHNlLCBwcm9wZXJ0eUlzRW51bWVyYWJsZTogZmFsc2UsIHRvTG9jYWxlU3RyaW5nOiBmYWxzZSwgdG9TdHJpbmc6IGZhbHNlLCB2YWx1ZU9mOiBmYWxzZVxuICAgICwgcXVvdDogJ1wiJ1xuICAgICwgUVVPVDogJ1wiJ1xuICAgICwgYW1wOiAnJidcbiAgICAsIEFNUDogJyYnXG4gICAgLCBuYnNwOiAnXFx1MDBBMCdcbiAgICAsIGFwb3M6ICdcXCcnXG4gICAgLCBsdDogJzwnXG4gICAgLCBMVDogJzwnXG4gICAgLCBndDogJz4nXG4gICAgLCBHVDogJz4nXG4gICAgLCBjb3B5OiAnXFx1MDBBOSdcbiAgICAsIGxhcXVvOiAnXFx1MDBBQidcbiAgICAsIHJhcXVvOiAnXFx1MDBCQidcbiAgICAsIHJlZzogJ1xcdTAwQUUnXG4gICAgLCBkZWc6ICdcXHUwMEIwJ1xuICAgICwgcGx1c21uOiAnXFx1MDBCMSdcbiAgICAsIHN1cDI6ICdcXHUwMEIyJ1xuICAgICwgc3VwMzogJ1xcdTAwQjMnXG4gICAgLCBtaWNybzogJ1xcdTAwQjUnXG4gICAgLCBwYXJhOiAnXFx1MDBCNidcbn07XG5cblxuZnVuY3Rpb24gcnBFbnRpdGllcyhzLCBkLCB4LCB6KSB7XG4gICAgaWYgKHopIHtcbiAgICAgICAgcmV0dXJuIHhoYXJzUXVvdFt6XSB8fCAnXFx4MDEnO1xuICAgIH07XG5cbiAgICBpZiAoZCkge1xuICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21Db2RlUG9pbnQoZCk7XG4gICAgfTtcblxuICAgIHJldHVybiBTdHJpbmcuZnJvbUNvZGVQb2ludChwYXJzZUludCh4LCAxNikpO1xufTtcblxuZnVuY3Rpb24gdW5FbnRpdGllcyhzLCBpKSB7XG4gICAgcyA9IFN0cmluZyhzKTtcbiAgICBpZiAocy5sZW5ndGggPiAzICYmIHMuaW5kZXhPZignJicpICE9PSAtMSkge1xuICAgICAgICBpZiAocy5pbmRleE9mKCcmZ3Q7JykgIT09IC0xKSBzID0gcy5yZXBsYWNlKC8mZ3Q7L2csICc+Jyk7XG4gICAgICAgIGlmIChzLmluZGV4T2YoJyZsdDsnKSAhPT0gLTEpIHMgPSBzLnJlcGxhY2UoLyZsdDsvZywgJzwnKTtcbiAgICAgICAgaWYgKHMuaW5kZXhPZignJnF1b3Q7JykgIT09IC0xKSBzID0gcy5yZXBsYWNlKC8mcXVvdDsvZywgJ1wiJyk7XG5cbiAgICAgICAgaWYgKHMuaW5kZXhPZignJicpICE9PSAtMSkge1xuICAgICAgICAgICAgcyA9IHMucmVwbGFjZSgvJiMoXFxkKyk7fCYjeChbMDEyMzQ1Njc4OWFiY2RlZl0rKTt8JihcXHcrKTsvaWcsIHJwRW50aXRpZXMpO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICByZXR1cm4gcztcbn07XG5cblxuRWFzeVNBWFBhcnNlci5wcm90b3R5cGUuYWxsb3dlZEFuZ3VsYXJBdHRyaWJ1dGVDaGFycyA9IGZ1bmN0aW9uKHcpIHtcbiAgICBpZiAoIXRoaXMuYW5ndWxhclN5bnRheCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIHcgPT09IDQwIHx8IC8vIChcbiAgICAgICAgICAgIHcgPT09IDQxIHx8IC8vIClcbiAgICAgICAgICAgIHcgPT09IDkxIHx8IC8vIFtcbiAgICAgICAgICAgIHcgPT09IDkzIHx8IC8vIF1cbiAgICAgICAgICAgIHcgPT09IDk0IHx8IC8vIF5cbiAgICAgICAgICAgIHcgPT09IDM1ICAgIC8vICNcbiAgICAgICAgKTtcbiAgICB9XG59O1xuXG5cdC8qXG5cdFx00L/QsNGA0YHQuNGCINCw0YLRgNC40LHRg9GC0Ysg0L/QviDRgtGA0LXQsdC+0LLQsNC90LjRji4g0JLQsNC20L3QviEgLSDRhNGD0L3QutGG0LjRjyDQvdC1INCz0LXQvdC10YDQuNGA0YPQtdGCINC40YHQutC70Y7Rh9C10L3QuNGPLlxuXG5cdFx00LXRgdC70Lgg0LHRi9C70LAg0L7RiNC40LHQutCwINGA0LDQt9Cx0L7RgNCwINCy0L7Qt9Cy0YDQsNGI0LDQtdGC0YHRjyBmYWxzZVxuXHRcdNC10YHQu9C4INCw0YLRgNC40LHRg9GC0L7QsiDQvdC10YIg0Lgg0YDQsNC30LHQvtGAINGD0LTQsNGH0LXQvSDRgtC+INCy0L7Qt9Cy0YDQsNGI0LDQtdGC0YHRjyB0cnVlXG5cdFx00LXRgdC70Lgg0LXRgdGC0Ywg0LDRgtGA0LjQsdGD0YLRiyDRgtC+INCy0L7Qt9Cy0YDQsNGI0LDQtdGC0YHRjyDQvtCx0YzQtdC60YIo0YXQtdGIKVxuXHQqL1xuXG5FYXN5U0FYUGFyc2VyLnByb3RvdHlwZS5nZXRBdHRycyA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmF0dHJfcmVzICE9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF0dHJfcmVzO1xuICAgIH07XG5cbiAgICAvKlxuICAgIGlmICh4eHRlc3QgIT09IHUgJiYgYXR0cl9zdHJpbmcuaW5kZXhPZih4eHRlc3QpID09PSAtMSkge1xuICAgICAgICAvICpcbiAgICAgICAgICAgIC8vINC00LvRjyDRg9GB0LrQvtGA0LXQvdC40Y9cbiAgICAgICAgICAgIGlmIChnZXRBdHRycygnaHRtbCcpLnR5cGUgPT0gJ2h0bWwnKSB7XG4gICAgICAgICAgICAgICAgLi4uXG4gICAgICAgICAgICB9O1xuICAgICAgICAqIC9cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICAqL1xuXG4gICAgdmFyIHVcbiAgICAsIHJlcyA9IHt9XG4gICAgLCBzID0gdGhpcy5hdHRyX3N0cmluZ1xuICAgICwgaSA9IHRoaXMuYXR0cl9wb3NzdGFydFxuICAgICwgbCA9IHMubGVuZ3RoXG4gICAgLCBhdHRyX2xpc3QgPSB0aGlzLmhhc1N1cm1pc2VOUyA/IFtdIDogZmFsc2VcbiAgICAsIG5hbWUsIHZhbHVlID0gJydcbiAgICAsIG9rID0gZmFsc2VcbiAgICAsIG5vVmFsdWVBdHRyaWJ1dGUgPSBmYWxzZVxuICAgICwgaiwgdywgbm4sIG5cbiAgICAsIGhhc05ld01hdHJpeFxuICAgICwgYWxpYXMsIG5ld2FsaWFzXG4gICAgO1xuXG4gICAgYWE6XG4gICAgZm9yKDsgaSA8IGw7IGkrKykge1xuICAgICAgICB3ID0gcy5jaGFyQ29kZUF0KGkpO1xuXG4gICAgICAgIGlmICh3PT09MzIgfHwgKHc8MTQgJiYgdyA+IDgpICkgeyAvLyBcXGZcXG5cXHJcXHRcXHZcbiAgICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQ2hlY2sgZm9yIHZhbGlkIGF0dHJpYnV0ZSBzdGFydCBjaGFyXG4gICAgICAgIGlmICgodyA8IDY1ICYmICF0aGlzLmFsbG93ZWRBbmd1bGFyQXR0cmlidXRlQ2hhcnModykpIHx8XG4gICAgICAgICAgICAgICAgdyA+IDEyMiB8fCAodyA+IDkwICYmIHcgPCA5NyAmJiAhdGhpcy5hbGxvd2VkQW5ndWxhckF0dHJpYnV0ZUNoYXJzKHcpKSApIHsgLy8g0L7QttC40LTQsNC10Lwg0YHQuNC80LLQvtC7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRyX3JlcyA9IGZhbHNlOyAvLyBlcnJvci4gaW52YWxpZCBjaGFyXG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yKGogPSBpICsgMTsgaiA8IGw7IGorKykgeyAvLyDQv9GA0L7QstC10YDRj9C10Lwg0LLRgdC1INGB0LjQvNCy0L7Qu9GLINC40LzQtdC90Lgg0LDRgtGA0LjQsdGD0YLQsFxuICAgICAgICAgICAgdyA9IHMuY2hhckNvZGVBdChqKTtcblxuICAgICAgICAgICAgaWYgKHcgPiA5NiAmJiB3IDwgMTIzIHx8IHcgPiA2NCAmJiB3IDwgOTEgfHwgdyA+IDQ3ICYmIHcgPCA1OSB8fCB3ID09PSA0NSB8fCB3ID09PSA5NSB8fCB3ID09PSA0NiAvKiBodHRwczovL2dpdGh1Yi5jb20vdGVsZXJpay94UGxhdENvcmUvaXNzdWVzLzE3OSAqLykge1xuICAgICAgICAgICAgICAgIGlmIChub1ZhbHVlQXR0cmlidXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGotLTsgLy9TdGFydGVkIG5leHQgYXR0cmlidXRlLiBHZXQgYmFjayBhbmQgYnJlYWsgb3V0IG9mIHRoZSBsb29wLlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAodGhpcy5hbGxvd2VkQW5ndWxhckF0dHJpYnV0ZUNoYXJzKHcpKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh3ID09PSAzMiB8fCAodyA+IDggJiYgdyA8IDE0KSApIHsgIC8vIFxcZlxcblxcclxcdFxcdiDQv9GA0L7QsdC10LtcbiAgICAgICAgICAgICAgICBub1ZhbHVlQXR0cmlidXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodyA9PT0gNjEpIHsgLy8gXCI9XCIgPT0gNjFcbiAgICAgICAgICAgICAgICBub1ZhbHVlQXR0cmlidXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2Vycm9yIDInKTtcbiAgICAgICAgICAgICAgICBpZiAoIW5vVmFsdWVBdHRyaWJ1dGUpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJfcmVzID0gZmFsc2U7IC8vIGVycm9yLiBpbnZhbGlkIGNoYXJcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9O1xuXG4gICAgICAgIG5hbWUgPSBzLnN1YnN0cmluZyhpLCBqKS50cmltKCk7XG4gICAgICAgIG9rID0gdHJ1ZTtcblxuICAgICAgICBpZiAobmFtZSA9PT0gJ3htbG5zOnhtbG5zJykge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnZXJyb3IgNicpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRyX3JlcyA9IGZhbHNlOyAvLyBlcnJvci4gaW52YWxpZCBuYW1lXG4gICAgICAgIH07XG5cbiAgICAgICAgdyA9IHMuY2hhckNvZGVBdChqKzEpO1xuXG4gICAgICAgIHdoaWxlICh3ID0gcy5jaGFyQ29kZUF0KGorMSkpIHtcbiAgICAgICAgICAgIGlmICh3PT09MzIgfHwgKHcgPiA4ICYmIHc8MTQpICkgeyAgLy8gXFxmXFxuXFxyXFx0XFx2INC/0YDQvtCx0LXQu1xuICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIW5vVmFsdWVBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIGlmICh3ID09PSAzNCkgeyAgLy8gJ1wiJ1xuICAgICAgICAgICAgICAgIGogPSBzLmluZGV4T2YoJ1wiJywgaSA9IGorMiApO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh3ID09PSAzOSkge1xuICAgICAgICAgICAgICAgICAgICBqID0gcy5pbmRleE9mKCdcXCcnLCBpID0gaisyICk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgeyAgLy8gXCInXCJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXR0cl9yZXMgPSBmYWxzZTsgLy8gZXJyb3IuIGludmFsaWQgY2hhclxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdlcnJvciA0JylcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJfcmVzID0gZmFsc2U7IC8vIGVycm9yLiBpbnZhbGlkIGNoYXJcbiAgICAgICAgfTtcblxuXG4gICAgICAgIGlmIChqKzEgPCBsICYmICFub1ZhbHVlQXR0cmlidXRlKSB7XG4gICAgICAgICAgICB3ID0gcy5jaGFyQ29kZUF0KGorMSk7XG5cbiAgICAgICAgICAgIGlmICh3ID4gMzIgfHwgdyA8IDkgfHwgKHcgPCAzMiAmJiB3ID4gMTMpKSB7XG4gICAgICAgICAgICAgICAgLy8gZXJyb3IuIGludmFsaWQgY2hhclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2Vycm9yIDUnKVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJfcmVzID0gZmFsc2U7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgaWYgKG5vVmFsdWVBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIHZhbHVlID0gJyc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHMuc3Vic3RyaW5nKGksIGopO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9pID0gaiArIDE7IC8vINGB0LvQtdC0LiDRgdC10LzQstC+0Lsg0YPQttC1INC/0YDQvtCy0LXRgNC10L0g0L/QvtGC0L7QvNGDINC/0YDQvtCy0LXRgNGP0YLRjCDQvdGD0LbQvdC+INGB0LvQtdC00YPRjtGI0LjQuVxuICAgICAgICBpID0gajsgLy8g0YHQu9C10LQuINGB0LXQvNCy0L7QuyDRg9C20LUg0L/RgNC+0LLQtdGA0LXQvSDQv9C+0YLQvtC80YMg0L/RgNC+0LLQtdGA0Y/RgtGMINC90YPQttC90L4g0YHQu9C10LTRg9GO0YjQuNC5XG5cbiAgICAgICAgaWYgKHRoaXMuaXNOYW1lc3BhY2UpIHsgLy9cbiAgICAgICAgICAgIGlmICh0aGlzLmhhc1N1cm1pc2VOUykge1xuICAgICAgICAgICAgICAgIC8vINC10YHRgtGMINC/0L7QtNC+0LfRgNC10L3QuNC1INGH0YLQviDQsiDQsNGC0YDQuNCx0YPRgtCw0YUg0L/RgNC40YHRg9GC0YHRgtCy0YPQtdGCIHhtbG5zXG5cbiAgICAgICAgICAgICAgICBpZiAobmV3YWxpYXMgPSBuYW1lID09PSAneG1sbnMnID8gJ3htbG5zJyA6IG5hbWUuY2hhckNvZGVBdCgwKSA9PT0gMTIwICYmIG5hbWUuc3Vic3RyKDAsIDYpID09PSAneG1sbnM6JyAmJiBuYW1lLnN1YnN0cig2KSApIHtcbiAgICAgICAgICAgICAgICAgICAgYWxpYXMgPSB0aGlzLnVzZU5TW3VuRW50aXRpZXModmFsdWUpXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoYWxpYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5zbWF0cml4W25ld2FsaWFzXSAhPT0gYWxpYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc05ld01hdHJpeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNOZXdNYXRyaXggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBubiA9IHt9OyBmb3IgKG4gaW4gdGhpcy5uc21hdHJpeCkgbm5bbl0gPSB0aGlzLm5zbWF0cml4W25dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5zbWF0cml4ID0gbm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXhbbmV3YWxpYXNdID0gYWxpYXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubnNtYXRyaXhbbmV3YWxpYXNdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNOZXdNYXRyaXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzTmV3TWF0cml4ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm4gPSB7fTsgZm9yIChuIGluIHRoaXMubnNtYXRyaXgpIG5uW25dID0gdGhpcy5uc21hdHJpeFtuXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uc21hdHJpeCA9IG5uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5zbWF0cml4W25ld2FsaWFzXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICByZXNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGF0dHJfbGlzdC5wdXNoKG5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHcgPSBuYW1lLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlKC0tdykge1xuICAgICAgICAgICAgICAgIGlmIChuYW1lLmNoYXJDb2RlQXQodykgPT09IDU4KSB7IC8vICc6J1xuICAgICAgICAgICAgICAgICAgICBpZiAodyA9IHRoaXMubnNtYXRyaXhbbmFtZS5zdWJzdHJpbmcoMCwgdyldICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzW3cgKyBuYW1lLnN1YnN0cih3KV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWUgYWE7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gJ3htbDpiYXNlJyA/Pz9cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgbm9WYWx1ZUF0dHJpYnV0ZSA9IGZhbHNlO1xuICAgIH07XG5cblxuICAgIGlmICghb2spIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXR0cl9yZXMgPSB0cnVlOyAgLy8g0LDRgtGA0LjQsdGD0YLQvtCyINC90LXRgiwg0L7RiNC40LHQvtC6INGC0L7QttC1INC90LXRglxuICAgIH07XG5cblxuICAgIGlmICh0aGlzLmhhc1N1cm1pc2VOUykgIHtcbiAgICAgICAgYmI6XG5cbiAgICAgICAgZm9yIChpID0gMCwgbCA9IGF0dHJfbGlzdC5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIG5hbWUgPSBhdHRyX2xpc3RbaSsrXTtcblxuICAgICAgICAgICAgdyA9IG5hbWUubGVuZ3RoO1xuICAgICAgICAgICAgd2hpbGUoLS13KSB7IC8vIG5hbWUuaW5kZXhPZignOicpXG4gICAgICAgICAgICAgICAgaWYgKG5hbWUuY2hhckNvZGVBdCh3KSA9PT0gNTgpIHsgLy8gJzonXG4gICAgICAgICAgICAgICAgICAgIGlmICh3ID0gdGhpcy5uc21hdHJpeFtuYW1lLnN1YnN0cmluZygwLCB3KV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc1t3ICsgbmFtZS5zdWJzdHIodyldID0gYXR0cl9saXN0W2ldO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZSBiYjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJlc1tuYW1lXSA9IGF0dHJfbGlzdFtpXTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXMuYXR0cl9yZXMgPSByZXM7XG59O1xuXG5cbi8vIHhtbCAtIHN0cmluZ1xuRWFzeVNBWFBhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbih4bWwpIHtcbiAgICB2YXIgdVxuICAgICwgeG1sID0gU3RyaW5nKHhtbClcbiAgICAsIG5vZGVzdGFjayA9IFtdXG4gICAgLCBzdGFja25zbWF0cml4ID0gW11cbiAgICAvLywgc3RyaW5nX25vZGVcbiAgICAsIGVsZW1cbiAgICAsIHRhZ2VuZCA9IGZhbHNlXG4gICAgLCB0YWdzdGFydCA9IGZhbHNlXG4gICAgLCBqID0gMCwgaSA9IDAsIGsgPSAwLCBsZW5cbiAgICAsIHgsIHksIHEsIHdcbiAgICAsIHhtbG5zXG4gICAgLCBzdG9wSW5kZXggPSAwXG4gICAgLCBzdG9wIC8vINC40YHQv9C+0LvRjNC30YPQtdGC0YHRjyDQv9GA0Lgg0YDQsNC30LHQvtGA0LUgXCJuYW1lc3BhY2VcIiAuINC10YHQu9C4INCy0YHRgtGA0LXRgtC40LvRgdGPINC90LXQuNC30LLQtdGB0YLQvdC+0LUg0L/RgNC+0YHRgtGA0LDQvdGB0YLQstC+INGC0L4g0YHQvtCx0YvRgtC40Y8g0L3QtSDQs9C10L3QtdGA0LjRgNGD0Y7RgtGB0Y9cbiAgICAsIF9uc21hdHJpeFxuICAgICwgb2tcbiAgICAsIHBvcyA9IDAsIGxuID0gMCwgbG5TdGFydCA9IC0yLCBsbkVuZCA9IC0xXG4gICAgO1xuXG4gICAgbGVuID0geG1sLmxlbmd0aDtcbiAgICBmdW5jdGlvbiBnZXRTdHJpbmdOb2RlKCkge1xuICAgICAgICByZXR1cm4geG1sLnN1YnN0cmluZyhpLCBqKzEpXG4gICAgfTtcbiAgICBmdW5jdGlvbiBmaW5kTGluZUFuZENvbHVtbkZyb21Qb3MoKSB7XG4gICAgICAgIHdoaWxlIChsblN0YXJ0IDwgbG5FbmQgJiYgbG5FbmQgPCBwb3MpIHtcbiAgICAgICAgICAgIGxuU3RhcnQgPSBsbkVuZDtcbiAgICAgICAgICAgIGxuRW5kID0geG1sLmluZGV4T2YoXCJcXG5cIiwgbG5FbmQgKyAxKTtcbiAgICAgICAgICAgICsrbG47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgbGluZTogbG4sIGNvbHVtbjogcG9zIC0gbG5TdGFydCB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBwb3NpdGlvbihwKSB7XG4gICAgICAgIHBvcyA9IHA7XG4gICAgICAgIHJldHVybiBmaW5kTGluZUFuZENvbHVtbkZyb21Qb3M7XG4gICAgfVxuXG4gICAgd2hpbGUoaiAhPT0gLTEpIHtcbiAgICAgICAgc3RvcCA9IHN0b3BJbmRleCA+IDA7XG5cbiAgICAgICAgaWYgKHhtbC5jaGFyQ29kZUF0KGopID09PSA2MCkgeyAvLyBcIjxcIlxuICAgICAgICAgICAgaSA9IGo7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpID0geG1sLmluZGV4T2YoJzwnLCBqKTtcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoaSA9PT0gLTEpIHsgLy8g0LrQvtC90LXRhiDRgNCw0LfQsdC+0YDQsFxuXG4gICAgICAgICAgICBpZiAobm9kZXN0YWNrLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignZW5kIGZpbGUnLCBwb3NpdGlvbihqKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChqICE9PSBpICYmICFzdG9wKSB7XG4gICAgICAgICAgICBvayA9IHRoaXMub25UZXh0Tm9kZSh4bWwuc3Vic3RyaW5nKGosIGkpLCB1bkVudGl0aWVzLCBwb3NpdGlvbihqKSk7XG4gICAgICAgICAgICBpZiAob2sgPT09IGZhbHNlKSByZXR1cm47XG4gICAgICAgIH07XG5cbiAgICAgICAgdyA9IHhtbC5jaGFyQ29kZUF0KGkrMSk7XG5cbiAgICAgICAgaWYgKHcgPT09IDMzKSB7IC8vIFwiIVwiXG4gICAgICAgICAgICB3ID0geG1sLmNoYXJDb2RlQXQoaSsyKTtcbiAgICAgICAgICAgIGlmICh3ID09PSA5MSAmJiB4bWwuc3Vic3RyKGkrMywgNikgPT09ICdDREFUQVsnKSB7IC8vIDkxID09IFwiW1wiXG4gICAgICAgICAgICAgICAgaiA9IHhtbC5pbmRleE9mKCddXT4nLCBpKTtcbiAgICAgICAgICAgICAgICBpZiAoaiA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKCdjZGF0YScsIHBvc2l0aW9uKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvL3ggPSB4bWwuc3Vic3RyaW5nKGkrOSwgaik7XG4gICAgICAgICAgICAgICAgaWYgKCFzdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIG9rID0gdGhpcy5vbkNEQVRBKHhtbC5zdWJzdHJpbmcoaSs5LCBqKSwgZmFsc2UsIHBvc2l0aW9uKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9rID09PSBmYWxzZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBqICs9IDM7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAodyA9PT0gNDUgJiYgeG1sLmNoYXJDb2RlQXQoaSszKSA9PT0gNDUpIHsgLy8gNDUgPT0gXCItXCJcbiAgICAgICAgICAgICAgICBqID0geG1sLmluZGV4T2YoJy0tPicsIGkpO1xuICAgICAgICAgICAgICAgIGlmIChqID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoJ2V4cGVjdGVkIC0tPicsIHBvc2l0aW9uKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzX29uQ29tbWVudCAmJiAhc3RvcCkge1xuICAgICAgICAgICAgICAgICAgICBvayA9IHRoaXMub25Db21tZW50KHhtbC5zdWJzdHJpbmcoaSs0LCBqKSwgdW5FbnRpdGllcywgcG9zaXRpb24oaSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob2sgPT09IGZhbHNlKSByZXR1cm47XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGogKz0gMztcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGogPSB4bWwuaW5kZXhPZignPicsIGkrMSk7XG4gICAgICAgICAgICBpZiAoaiA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoJ2V4cGVjdGVkIFwiPlwiJywgcG9zaXRpb24oaSArIDEpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAodGhpcy5pc19vbkF0dGVudGlvbiAmJiAhc3RvcCkge1xuICAgICAgICAgICAgICAgIG9rID0gdGhpcy5vbkF0dGVudGlvbih4bWwuc3Vic3RyaW5nKGksIGorMSksIHVuRW50aXRpZXMsIHBvc2l0aW9uKGkpKTtcbiAgICAgICAgICAgICAgICBpZiAob2sgPT09IGZhbHNlKSByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBqICs9IDE7XG4gICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHcgPT09IDYzKSB7IC8vIFwiP1wiXG4gICAgICAgICAgICAgICAgaiA9IHhtbC5pbmRleE9mKCc/PicsIGkpO1xuICAgICAgICAgICAgICAgIGlmIChqID09PSAtMSkgeyAvLyBlcnJvclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoJy4uLj8+JywgcG9zaXRpb24oaSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzX29uUXVlc3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgb2sgPSB0aGlzLm9uUXVlc3Rpb24oeG1sLnN1YnN0cmluZyhpLCBqKzIpLCBwb3NpdGlvbihpKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvayA9PT0gZmFsc2UpIHJldHVybjtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaiArPSAyO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgaW5zaWRlPWZhbHNlO1xuICAgICAgICBmb3IgKGs9aSxqPS0xO2s8bGVuO2srKykge1xuICAgICAgICAgICAgdmFyIGMgPSB4bWwuY2hhckNvZGVBdChrKTtcbiAgICAgICAgICAgIGlmICghaW5zaWRlKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoYyA9PT0gMzQpIHsgLy8gJ1wiJ1xuICAgICAgICAgICAgICAgICAgICBpbnNpZGUgPSBjO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjID09PSAzOSkgeyAvLyBcIidcIlxuICAgICAgICAgICAgICAgICAgICBpbnNpZGUgPSBjO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjID09PSA2MikgeyAvLyA8XG4gICAgICAgICAgICAgICAgICAgIGogPSBrOyBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjID09PSBpbnNpZGUpIHsgaW5zaWRlID0gZmFsc2U7IH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChqID09IC0xKSB7IC8vIGVycm9yXG4gICAgICAgICAgICB0aGlzLm9uRXJyb3IoJy4uLj4nLCBwb3NpdGlvbihpICsgMSkpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuYXR0cl9yZXMgPSB0cnVlOyAvLyDQsNGC0YDQuNCx0YPRgtC+0LIg0L3QtdGCXG5cbiAgICAgICAgLy9pZiAoeG1sLmNoYXJDb2RlQXQoaSsxKSA9PT0gNDcpIHsgLy8gPC8uLi5cbiAgICAgICAgaWYgKHcgPT09IDQ3KSB7IC8vIDwvLi4uXG4gICAgICAgICAgICB0YWdzdGFydCA9IGZhbHNlO1xuICAgICAgICAgICAgdGFnZW5kID0gdHJ1ZTtcblxuICAgICAgICAgICAgLy8g0L/RgNC+0LLQtdGA0Y/QtdC8INGH0YLQviDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0LfQsNC60YDRi9GCINGC0L7RgtC20LUg0YLQtdCzINGH0YLQviDQuCDQvtGC0LrRgNGL0LLQsNC70YHRj1xuICAgICAgICAgICAgeCA9IGVsZW0gPSBub2Rlc3RhY2sucG9wKCk7XG4gICAgICAgICAgICBxID0gaSArIDIgKyB4Lmxlbmd0aDtcblxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygpXG4gICAgICAgICAgICBpZiAoeG1sLnN1YnN0cmluZyhpKzIsIHEpICE9PSB4KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKCdjbG9zZSB0YWduYW1lJywgcG9zaXRpb24oaSArIDIpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyDQv9GA0L7QstC10YDQuNC8INGH0YLQviDQsiDQt9Cw0LrRgNGL0LLQsNGO0YjQtdC8INGC0LXQs9C1INC90LXRgiDQu9C40YjQvdC10LPQvlxuICAgICAgICAgICAgZm9yKDsgcSA8IGo7IHErKykge1xuICAgICAgICAgICAgICAgIHcgPSB4bWwuY2hhckNvZGVBdChxKTtcblxuICAgICAgICAgICAgICAgIGlmICh3PT09MzIgfHwgKHcgPiA4ICYmIHc8MTQpICkgeyAgLy8gXFxmXFxuXFxyXFx0XFx2INC/0YDQvtCx0LXQu1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKCdjbG9zZSB0YWcnLCBwb3NpdGlvbihpICsgMikpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh4bWwuY2hhckNvZGVBdChqLTEpID09PSAgNDcpIHsgLy8gLi4uLz5cbiAgICAgICAgICAgICAgICB4ID0gZWxlbSA9IHhtbC5zdWJzdHJpbmcoaSsxLCBqLTEpO1xuXG4gICAgICAgICAgICAgICAgdGFnc3RhcnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRhZ2VuZCA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHggPSBlbGVtID0geG1sLnN1YnN0cmluZyhpKzEsIGopO1xuXG4gICAgICAgICAgICAgICAgdGFnc3RhcnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRhZ2VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKCAhKHcgPiA5NiAgJiYgdyA8IDEyMyB8fCB3ID4gNjQgJiYgdyA8OTEpICkge1xuICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignZmlyc3QgY2hhciBub2RlTmFtZScsIHBvc2l0aW9uKGkgKyAxKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZm9yKHEgPSAxLCB5ID0geC5sZW5ndGg7IHEgPCB5OyBxKyspIHtcbiAgICAgICAgICAgICAgICB3ID0geC5jaGFyQ29kZUF0KHEpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHcgPiA5NiAmJiB3IDwgMTIzIHx8IHcgPiA2NCAmJiB3IDwgOTEgfHwgdyA+IDQ3ICYmIHcgPCA1OSB8fCB3ID09PSA0NSB8fCB3ID09PSA5NSB8fCB3ID09PSA0NiAvKiBodHRwczovL2dpdGh1Yi5jb20vdGVsZXJpay94UGxhdENvcmUvaXNzdWVzLzE3OSAqLykge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKHc9PT0zMiB8fCAodzwxNCAmJiB3ID4gOCkpIHsgLy8gXFxmXFxuXFxyXFx0XFx2INC/0YDQvtCx0LXQu1xuICAgICAgICAgICAgICAgICAgICBlbGVtID0geC5zdWJzdHJpbmcoMCwgcSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdHRyX3JlcyA9IG51bGw7IC8vINCy0L7Qt9C80L7QttC90L4g0LXRgdGC0Ywg0LDRgtC40YDQuNCx0YPRgtGLXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoJ2ludmFsaWQgbm9kZU5hbWUnLCBwb3NpdGlvbihpICsgMSkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICghdGFnZW5kKSB7XG4gICAgICAgICAgICAgICAgbm9kZXN0YWNrLnB1c2goZWxlbSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgaWYgKHRoaXMuaXNOYW1lc3BhY2UpIHtcbiAgICAgICAgICAgIGlmIChzdG9wKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRhZ2VuZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRhZ3N0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoLS1zdG9wSW5kZXggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5zbWF0cml4ID0gc3RhY2tuc21hdHJpeC5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdG9wSW5kZXggKz0gMTtcbiAgICAgICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgICAgICBqICs9IDE7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBfbnNtYXRyaXggPSB0aGlzLm5zbWF0cml4O1xuXG4gICAgICAgICAgICBpZiAoIXRhZ2VuZCkge1xuICAgICAgICAgICAgICAgIHN0YWNrbnNtYXRyaXgucHVzaCh0aGlzLm5zbWF0cml4KTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmF0dHJfcmVzICE9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1N1cm1pc2VOUyA9IHguaW5kZXhPZigneG1sbnMnLCBxKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXR0cl9zdHJpbmcgPSB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hdHRyX3Bvc3N0YXJ0ID0gcTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRBdHRycygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhc1N1cm1pc2VOUyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgIHcgPSBlbGVtLmluZGV4T2YoJzonKTtcbiAgICAgICAgICAgIGlmICh3ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHhtbG5zID0gdGhpcy5uc21hdHJpeFtlbGVtLnN1YnN0cmluZygwLCB3KV07XG4gICAgICAgICAgICAgICAgZWxlbSA9IGVsZW0uc3Vic3RyKHcrMSk7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgeG1sbnMgPSB0aGlzLm5zbWF0cml4LnhtbG5zO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKCF4bWxucykge1xuICAgICAgICAgICAgICAgIGlmICh0YWdlbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhZ3N0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5zbWF0cml4ID0gX25zbWF0cml4O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uc21hdHJpeCA9IHN0YWNrbnNtYXRyaXgucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvcEluZGV4ID0gMTsgLy8g0L/QtdGA0LLRi9C5INGN0LvQtdC80LXQvdGCINC00LvRjyDQutC+0YLQvtGA0L7Qs9C+INC90LUg0L7Qv9GA0LXQtNC10LvQtdC90L4g0L/RgNC+0YHRgtGA0LDQvdGB0YLQstC+INC40LzQtdC9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXR0cl9yZXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBqICs9IDE7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBlbGVtID0geG1sbnMgKyAnOicgKyBlbGVtO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vc3RyaW5nX25vZGUgPSB4bWwuc3Vic3RyaW5nKGksIGorMSk7IC8vINGC0LXQutGB0YIg0L3QvtC00Ysg0LrQsNC6INC10YHRgtGMXG5cbiAgICAgICAgaWYgKHRhZ3N0YXJ0KSB7IC8vIGlzX29uU3RhcnROb2RlXG4gICAgICAgICAgICB0aGlzLmF0dHJfc3RyaW5nID0geDtcbiAgICAgICAgICAgIHRoaXMuYXR0cl9wb3NzdGFydCA9IHE7XG5cbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIG9rID0gdGhpcy5vblN0YXJ0Tm9kZShlbGVtLCBmdW5jdGlvbigpIHsgcmV0dXJuIHRoYXQuZ2V0QXR0cnMoKSB9LCB1bkVudGl0aWVzLCB0YWdlbmRcbiAgICAgICAgICAgICAgICAsIGdldFN0cmluZ05vZGUsIHBvc2l0aW9uKGkpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAob2sgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5hdHRyX3JlcyA9IHRydWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHRhZ2VuZCkge1xuICAgICAgICAgICAgb2sgPSB0aGlzLm9uRW5kTm9kZShlbGVtLCB1bkVudGl0aWVzLCB0YWdzdGFydFxuICAgICAgICAgICAgICAgICwgZ2V0U3RyaW5nTm9kZSwgcG9zaXRpb24oaSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGlmIChvayA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAodGhpcy5pc05hbWVzcGFjZSkge1xuICAgICAgICAgICAgICAgIGlmICh0YWdzdGFydCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5zbWF0cml4ID0gX25zbWF0cml4O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXggPSBzdGFja25zbWF0cml4LnBvcCgpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIGogKz0gMTtcbiAgICB9O1xufTtcbiIsIu+7vy8qXG4gIENvcHlyaWdodCAoQykgMjAxMyBBcml5YSBIaWRheWF0IDxhcml5YS5oaWRheWF0QGdtYWlsLmNvbT5cbiAgQ29weXJpZ2h0IChDKSAyMDEzIFRoYWRkZWUgVHlsIDx0aGFkZGVlLnR5bEBnbWFpbC5jb20+XG4gIENvcHlyaWdodCAoQykgMjAxMiBBcml5YSBIaWRheWF0IDxhcml5YS5oaWRheWF0QGdtYWlsLmNvbT5cbiAgQ29weXJpZ2h0IChDKSAyMDEyIE1hdGhpYXMgQnluZW5zIDxtYXRoaWFzQHFpd2kuYmU+XG4gIENvcHlyaWdodCAoQykgMjAxMiBKb29zdC1XaW0gQm9la2VzdGVpam4gPGpvb3N0LXdpbUBib2VrZXN0ZWlqbi5ubD5cbiAgQ29weXJpZ2h0IChDKSAyMDEyIEtyaXMgS293YWwgPGtyaXMua293YWxAY2l4YXIuY29tPlxuICBDb3B5cmlnaHQgKEMpIDIwMTIgWXVzdWtlIFN1enVraSA8dXRhdGFuZS50ZWFAZ21haWwuY29tPlxuICBDb3B5cmlnaHQgKEMpIDIwMTIgQXJwYWQgQm9yc29zIDxhcnBhZC5ib3Jzb3NAZ29vZ2xlbWFpbC5jb20+XG4gIENvcHlyaWdodCAoQykgMjAxMSBBcml5YSBIaWRheWF0IDxhcml5YS5oaWRheWF0QGdtYWlsLmNvbT5cblxuICBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXRcbiAgbW9kaWZpY2F0aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zIGFyZSBtZXQ6XG5cbiAgICAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0XG4gICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gICAgKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodFxuICAgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZVxuICAgICAgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi5cblxuICBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIlxuICBBTkQgQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFXG4gIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFXG4gIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCA8Q09QWVJJR0hUIEhPTERFUj4gQkUgTElBQkxFIEZPUiBBTllcbiAgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVNcbiAgKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTO1xuICBMT1NTIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkRcbiAgT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksIE9SIFRPUlRcbiAgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GXG4gIFRISVMgU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4qL1xuXG4oZnVuY3Rpb24gKGdsb2JhbCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBUb2tlbixcbiAgICAgICAgVG9rZW5OYW1lLFxuICAgICAgICBTeW50YXgsXG4gICAgICAgIE1lc3NhZ2VzLFxuICAgICAgICBzb3VyY2UsXG4gICAgICAgIGluZGV4LFxuICAgICAgICBsZW5ndGgsXG4gICAgICAgIGRlbGVnYXRlLFxuICAgICAgICBsb29rYWhlYWQsXG4gICAgICAgIHN0YXRlO1xuXG4gICAgVG9rZW4gPSB7XG4gICAgICAgIEJvb2xlYW5MaXRlcmFsOiAxLFxuICAgICAgICBFT0Y6IDIsXG4gICAgICAgIElkZW50aWZpZXI6IDMsXG4gICAgICAgIEtleXdvcmQ6IDQsXG4gICAgICAgIE51bGxMaXRlcmFsOiA1LFxuICAgICAgICBOdW1lcmljTGl0ZXJhbDogNixcbiAgICAgICAgUHVuY3R1YXRvcjogNyxcbiAgICAgICAgU3RyaW5nTGl0ZXJhbDogOFxuICAgIH07XG5cbiAgICBUb2tlbk5hbWUgPSB7fTtcbiAgICBUb2tlbk5hbWVbVG9rZW4uQm9vbGVhbkxpdGVyYWxdID0gJ0Jvb2xlYW4nO1xuICAgIFRva2VuTmFtZVtUb2tlbi5FT0ZdID0gJzxlbmQ+JztcbiAgICBUb2tlbk5hbWVbVG9rZW4uSWRlbnRpZmllcl0gPSAnSWRlbnRpZmllcic7XG4gICAgVG9rZW5OYW1lW1Rva2VuLktleXdvcmRdID0gJ0tleXdvcmQnO1xuICAgIFRva2VuTmFtZVtUb2tlbi5OdWxsTGl0ZXJhbF0gPSAnTnVsbCc7XG4gICAgVG9rZW5OYW1lW1Rva2VuLk51bWVyaWNMaXRlcmFsXSA9ICdOdW1lcmljJztcbiAgICBUb2tlbk5hbWVbVG9rZW4uUHVuY3R1YXRvcl0gPSAnUHVuY3R1YXRvcic7XG4gICAgVG9rZW5OYW1lW1Rva2VuLlN0cmluZ0xpdGVyYWxdID0gJ1N0cmluZyc7XG5cbiAgICBTeW50YXggPSB7XG4gICAgICAgIEFycmF5RXhwcmVzc2lvbjogJ0FycmF5RXhwcmVzc2lvbicsXG4gICAgICAgIEJpbmFyeUV4cHJlc3Npb246ICdCaW5hcnlFeHByZXNzaW9uJyxcbiAgICAgICAgQ2FsbEV4cHJlc3Npb246ICdDYWxsRXhwcmVzc2lvbicsXG4gICAgICAgIENvbmRpdGlvbmFsRXhwcmVzc2lvbjogJ0NvbmRpdGlvbmFsRXhwcmVzc2lvbicsXG4gICAgICAgIEVtcHR5U3RhdGVtZW50OiAnRW1wdHlTdGF0ZW1lbnQnLFxuICAgICAgICBFeHByZXNzaW9uU3RhdGVtZW50OiAnRXhwcmVzc2lvblN0YXRlbWVudCcsXG4gICAgICAgIElkZW50aWZpZXI6ICdJZGVudGlmaWVyJyxcbiAgICAgICAgTGl0ZXJhbDogJ0xpdGVyYWwnLFxuICAgICAgICBMYWJlbGVkU3RhdGVtZW50OiAnTGFiZWxlZFN0YXRlbWVudCcsXG4gICAgICAgIExvZ2ljYWxFeHByZXNzaW9uOiAnTG9naWNhbEV4cHJlc3Npb24nLFxuICAgICAgICBNZW1iZXJFeHByZXNzaW9uOiAnTWVtYmVyRXhwcmVzc2lvbicsXG4gICAgICAgIE9iamVjdEV4cHJlc3Npb246ICdPYmplY3RFeHByZXNzaW9uJyxcbiAgICAgICAgUHJvZ3JhbTogJ1Byb2dyYW0nLFxuICAgICAgICBQcm9wZXJ0eTogJ1Byb3BlcnR5JyxcbiAgICAgICAgVGhpc0V4cHJlc3Npb246ICdUaGlzRXhwcmVzc2lvbicsXG4gICAgICAgIFVuYXJ5RXhwcmVzc2lvbjogJ1VuYXJ5RXhwcmVzc2lvbidcbiAgICB9O1xuXG4gICAgLy8gRXJyb3IgbWVzc2FnZXMgc2hvdWxkIGJlIGlkZW50aWNhbCB0byBWOC5cbiAgICBNZXNzYWdlcyA9IHtcbiAgICAgICAgVW5leHBlY3RlZFRva2VuOiAnVW5leHBlY3RlZCB0b2tlbiAlMCcsXG4gICAgICAgIFVua25vd25MYWJlbDogJ1VuZGVmaW5lZCBsYWJlbCBcXCclMFxcJycsXG4gICAgICAgIFJlZGVjbGFyYXRpb246ICclMCBcXCclMVxcJyBoYXMgYWxyZWFkeSBiZWVuIGRlY2xhcmVkJ1xuICAgIH07XG5cbiAgICAvLyBFbnN1cmUgdGhlIGNvbmRpdGlvbiBpcyB0cnVlLCBvdGhlcndpc2UgdGhyb3cgYW4gZXJyb3IuXG4gICAgLy8gVGhpcyBpcyBvbmx5IHRvIGhhdmUgYSBiZXR0ZXIgY29udHJhY3Qgc2VtYW50aWMsIGkuZS4gYW5vdGhlciBzYWZldHkgbmV0XG4gICAgLy8gdG8gY2F0Y2ggYSBsb2dpYyBlcnJvci4gVGhlIGNvbmRpdGlvbiBzaGFsbCBiZSBmdWxmaWxsZWQgaW4gbm9ybWFsIGNhc2UuXG4gICAgLy8gRG8gTk9UIHVzZSB0aGlzIHRvIGVuZm9yY2UgYSBjZXJ0YWluIGNvbmRpdGlvbiBvbiBhbnkgdXNlciBpbnB1dC5cblxuICAgIGZ1bmN0aW9uIGFzc2VydChjb25kaXRpb24sIG1lc3NhZ2UpIHtcbiAgICAgICAgaWYgKCFjb25kaXRpb24pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQVNTRVJUOiAnICsgbWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0RlY2ltYWxEaWdpdChjaCkge1xuICAgICAgICByZXR1cm4gKGNoID49IDQ4ICYmIGNoIDw9IDU3KTsgICAvLyAwLi45XG4gICAgfVxuXG5cbiAgICAvLyA3LjIgV2hpdGUgU3BhY2VcblxuICAgIGZ1bmN0aW9uIGlzV2hpdGVTcGFjZShjaCkge1xuICAgICAgICByZXR1cm4gKGNoID09PSAzMikgfHwgIC8vIHNwYWNlXG4gICAgICAgICAgICAoY2ggPT09IDkpIHx8ICAgICAgLy8gdGFiXG4gICAgICAgICAgICAoY2ggPT09IDB4QikgfHxcbiAgICAgICAgICAgIChjaCA9PT0gMHhDKSB8fFxuICAgICAgICAgICAgKGNoID09PSAweEEwKSB8fFxuICAgICAgICAgICAgKGNoID49IDB4MTY4MCAmJiAnXFx1MTY4MFxcdTE4MEVcXHUyMDAwXFx1MjAwMVxcdTIwMDJcXHUyMDAzXFx1MjAwNFxcdTIwMDVcXHUyMDA2XFx1MjAwN1xcdTIwMDhcXHUyMDA5XFx1MjAwQVxcdTIwMkZcXHUyMDVGXFx1MzAwMFxcdUZFRkYnLmluZGV4T2YoU3RyaW5nLmZyb21DaGFyQ29kZShjaCkpID4gMCk7XG4gICAgfVxuXG4gICAgLy8gNy4zIExpbmUgVGVybWluYXRvcnNcblxuICAgIGZ1bmN0aW9uIGlzTGluZVRlcm1pbmF0b3IoY2gpIHtcbiAgICAgICAgcmV0dXJuIChjaCA9PT0gMTApIHx8IChjaCA9PT0gMTMpIHx8IChjaCA9PT0gMHgyMDI4KSB8fCAoY2ggPT09IDB4MjAyOSk7XG4gICAgfVxuXG4gICAgLy8gNy42IElkZW50aWZpZXIgTmFtZXMgYW5kIElkZW50aWZpZXJzXG5cbiAgICBmdW5jdGlvbiBpc0lkZW50aWZpZXJTdGFydChjaCkge1xuICAgICAgICByZXR1cm4gKGNoID09PSAzNikgfHwgKGNoID09PSA5NSkgfHwgIC8vICQgKGRvbGxhcikgYW5kIF8gKHVuZGVyc2NvcmUpXG4gICAgICAgICAgICAoY2ggPj0gNjUgJiYgY2ggPD0gOTApIHx8ICAgICAgICAgLy8gQS4uWlxuICAgICAgICAgICAgKGNoID49IDk3ICYmIGNoIDw9IDEyMik7ICAgICAgICAgIC8vIGEuLnpcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0lkZW50aWZpZXJQYXJ0KGNoKSB7XG4gICAgICAgIHJldHVybiAoY2ggPT09IDM2KSB8fCAoY2ggPT09IDk1KSB8fCAgLy8gJCAoZG9sbGFyKSBhbmQgXyAodW5kZXJzY29yZSlcbiAgICAgICAgICAgIChjaCA+PSA2NSAmJiBjaCA8PSA5MCkgfHwgICAgICAgICAvLyBBLi5aXG4gICAgICAgICAgICAoY2ggPj0gOTcgJiYgY2ggPD0gMTIyKSB8fCAgICAgICAgLy8gYS4uelxuICAgICAgICAgICAgKGNoID49IDQ4ICYmIGNoIDw9IDU3KTsgICAgICAgICAgIC8vIDAuLjlcbiAgICB9XG5cbiAgICAvLyA3LjYuMS4xIEtleXdvcmRzXG5cbiAgICBmdW5jdGlvbiBpc0tleXdvcmQoaWQpIHtcbiAgICAgICAgcmV0dXJuIChpZCA9PT0gJ3RoaXMnKVxuICAgIH1cblxuICAgIC8vIDcuNCBDb21tZW50c1xuXG4gICAgZnVuY3Rpb24gc2tpcFdoaXRlc3BhY2UoKSB7XG4gICAgICAgIHdoaWxlIChpbmRleCA8IGxlbmd0aCAmJiBpc1doaXRlU3BhY2Uoc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpKSkge1xuICAgICAgICAgICAgKytpbmRleDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldElkZW50aWZpZXIoKSB7XG4gICAgICAgIHZhciBzdGFydCwgY2g7XG5cbiAgICAgICAgc3RhcnQgPSBpbmRleCsrO1xuICAgICAgICB3aGlsZSAoaW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICAgIGNoID0gc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpO1xuICAgICAgICAgICAgaWYgKGlzSWRlbnRpZmllclBhcnQoY2gpKSB7XG4gICAgICAgICAgICAgICAgKytpbmRleDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc291cmNlLnNsaWNlKHN0YXJ0LCBpbmRleCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2NhbklkZW50aWZpZXIoKSB7XG4gICAgICAgIHZhciBzdGFydCwgaWQsIHR5cGU7XG5cbiAgICAgICAgc3RhcnQgPSBpbmRleDtcblxuICAgICAgICBpZCA9IGdldElkZW50aWZpZXIoKTtcblxuICAgICAgICAvLyBUaGVyZSBpcyBubyBrZXl3b3JkIG9yIGxpdGVyYWwgd2l0aCBvbmx5IG9uZSBjaGFyYWN0ZXIuXG4gICAgICAgIC8vIFRodXMsIGl0IG11c3QgYmUgYW4gaWRlbnRpZmllci5cbiAgICAgICAgaWYgKGlkLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgdHlwZSA9IFRva2VuLklkZW50aWZpZXI7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNLZXl3b3JkKGlkKSkge1xuICAgICAgICAgICAgdHlwZSA9IFRva2VuLktleXdvcmQ7XG4gICAgICAgIH0gZWxzZSBpZiAoaWQgPT09ICdudWxsJykge1xuICAgICAgICAgICAgdHlwZSA9IFRva2VuLk51bGxMaXRlcmFsO1xuICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAndHJ1ZScgfHwgaWQgPT09ICdmYWxzZScpIHtcbiAgICAgICAgICAgIHR5cGUgPSBUb2tlbi5Cb29sZWFuTGl0ZXJhbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHR5cGUgPSBUb2tlbi5JZGVudGlmaWVyO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICB2YWx1ZTogaWQsXG4gICAgICAgICAgICByYW5nZTogW3N0YXJ0LCBpbmRleF1cbiAgICAgICAgfTtcbiAgICB9XG5cblxuICAgIC8vIDcuNyBQdW5jdHVhdG9yc1xuXG4gICAgZnVuY3Rpb24gc2NhblB1bmN0dWF0b3IoKSB7XG4gICAgICAgIHZhciBzdGFydCA9IGluZGV4LFxuICAgICAgICAgICAgY29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KSxcbiAgICAgICAgICAgIGNvZGUyLFxuICAgICAgICAgICAgY2gxID0gc291cmNlW2luZGV4XSxcbiAgICAgICAgICAgIGNoMjtcblxuICAgICAgICBzd2l0Y2ggKGNvZGUpIHtcblxuICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIG1vc3QgY29tbW9uIHNpbmdsZS1jaGFyYWN0ZXIgcHVuY3R1YXRvcnMuXG4gICAgICAgICAgICBjYXNlIDQ2OiAgIC8vIC4gZG90XG4gICAgICAgICAgICBjYXNlIDQwOiAgIC8vICggb3BlbiBicmFja2V0XG4gICAgICAgICAgICBjYXNlIDQxOiAgIC8vICkgY2xvc2UgYnJhY2tldFxuICAgICAgICAgICAgY2FzZSA1OTogICAvLyA7IHNlbWljb2xvblxuICAgICAgICAgICAgY2FzZSA0NDogICAvLyAsIGNvbW1hXG4gICAgICAgICAgICBjYXNlIDEyMzogIC8vIHsgb3BlbiBjdXJseSBicmFjZVxuICAgICAgICAgICAgY2FzZSAxMjU6ICAvLyB9IGNsb3NlIGN1cmx5IGJyYWNlXG4gICAgICAgICAgICBjYXNlIDkxOiAgIC8vIFtcbiAgICAgICAgICAgIGNhc2UgOTM6ICAgLy8gXVxuICAgICAgICAgICAgY2FzZSA1ODogICAvLyA6XG4gICAgICAgICAgICBjYXNlIDYzOiAgIC8vID9cbiAgICAgICAgICAgICAgICArK2luZGV4O1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFRva2VuLlB1bmN0dWF0b3IsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBTdHJpbmcuZnJvbUNoYXJDb2RlKGNvZGUpLFxuICAgICAgICAgICAgICAgICAgICByYW5nZTogW3N0YXJ0LCBpbmRleF1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNvZGUyID0gc291cmNlLmNoYXJDb2RlQXQoaW5kZXggKyAxKTtcblxuICAgICAgICAgICAgICAgIC8vICc9JyAoY2hhciAjNjEpIG1hcmtzIGFuIGFzc2lnbm1lbnQgb3IgY29tcGFyaXNvbiBvcGVyYXRvci5cbiAgICAgICAgICAgICAgICBpZiAoY29kZTIgPT09IDYxKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY29kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzNzogIC8vICVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzg6ICAvLyAmXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQyOiAgLy8gKjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDM6ICAvLyArXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ1OiAgLy8gLVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0NzogIC8vIC9cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjA6ICAvLyA8XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDYyOiAgLy8gPlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjQ6IC8vIHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCArPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFRva2VuLlB1bmN0dWF0b3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBTdHJpbmcuZnJvbUNoYXJDb2RlKGNvZGUpICsgU3RyaW5nLmZyb21DaGFyQ29kZShjb2RlMiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlOiBbc3RhcnQsIGluZGV4XVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzM6IC8vICFcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjE6IC8vID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCArPSAyO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gIT09IGFuZCA9PT1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpID09PSA2MSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArK2luZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBUb2tlbi5QdW5jdHVhdG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogc291cmNlLnNsaWNlKHN0YXJ0LCBpbmRleCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlOiBbc3RhcnQsIGluZGV4XVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUGVlayBtb3JlIGNoYXJhY3RlcnMuXG5cbiAgICAgICAgY2gyID0gc291cmNlW2luZGV4ICsgMV07XG5cbiAgICAgICAgLy8gT3RoZXIgMi1jaGFyYWN0ZXIgcHVuY3R1YXRvcnM6ICYmIHx8XG5cbiAgICAgICAgaWYgKGNoMSA9PT0gY2gyICYmICgnJnwnLmluZGV4T2YoY2gxKSA+PSAwKSkge1xuICAgICAgICAgICAgaW5kZXggKz0gMjtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogVG9rZW4uUHVuY3R1YXRvcixcbiAgICAgICAgICAgICAgICB2YWx1ZTogY2gxICsgY2gyLFxuICAgICAgICAgICAgICAgIHJhbmdlOiBbc3RhcnQsIGluZGV4XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgnPD49ISstKiUmfF4vJy5pbmRleE9mKGNoMSkgPj0gMCkge1xuICAgICAgICAgICAgKytpbmRleDtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogVG9rZW4uUHVuY3R1YXRvcixcbiAgICAgICAgICAgICAgICB2YWx1ZTogY2gxLFxuICAgICAgICAgICAgICAgIHJhbmdlOiBbc3RhcnQsIGluZGV4XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRocm93RXJyb3Ioe30sIE1lc3NhZ2VzLlVuZXhwZWN0ZWRUb2tlbiwgJ0lMTEVHQUwnKTtcbiAgICB9XG5cbiAgICAvLyA3LjguMyBOdW1lcmljIExpdGVyYWxzXG4gICAgZnVuY3Rpb24gc2Nhbk51bWVyaWNMaXRlcmFsKCkge1xuICAgICAgICB2YXIgbnVtYmVyLCBzdGFydCwgY2g7XG5cbiAgICAgICAgY2ggPSBzb3VyY2VbaW5kZXhdO1xuICAgICAgICBhc3NlcnQoaXNEZWNpbWFsRGlnaXQoY2guY2hhckNvZGVBdCgwKSkgfHwgKGNoID09PSAnLicpLFxuICAgICAgICAgICAgJ051bWVyaWMgbGl0ZXJhbCBtdXN0IHN0YXJ0IHdpdGggYSBkZWNpbWFsIGRpZ2l0IG9yIGEgZGVjaW1hbCBwb2ludCcpO1xuXG4gICAgICAgIHN0YXJ0ID0gaW5kZXg7XG4gICAgICAgIG51bWJlciA9ICcnO1xuICAgICAgICBpZiAoY2ggIT09ICcuJykge1xuICAgICAgICAgICAgbnVtYmVyID0gc291cmNlW2luZGV4KytdO1xuICAgICAgICAgICAgY2ggPSBzb3VyY2VbaW5kZXhdO1xuXG4gICAgICAgICAgICAvLyBIZXggbnVtYmVyIHN0YXJ0cyB3aXRoICcweCcuXG4gICAgICAgICAgICAvLyBPY3RhbCBudW1iZXIgc3RhcnRzIHdpdGggJzAnLlxuICAgICAgICAgICAgaWYgKG51bWJlciA9PT0gJzAnKSB7XG4gICAgICAgICAgICAgICAgLy8gZGVjaW1hbCBudW1iZXIgc3RhcnRzIHdpdGggJzAnIHN1Y2ggYXMgJzA5JyBpcyBpbGxlZ2FsLlxuICAgICAgICAgICAgICAgIGlmIChjaCAmJiBpc0RlY2ltYWxEaWdpdChjaC5jaGFyQ29kZUF0KDApKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvd0Vycm9yKHt9LCBNZXNzYWdlcy5VbmV4cGVjdGVkVG9rZW4sICdJTExFR0FMJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aGlsZSAoaXNEZWNpbWFsRGlnaXQoc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpKSkge1xuICAgICAgICAgICAgICAgIG51bWJlciArPSBzb3VyY2VbaW5kZXgrK107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaCA9IHNvdXJjZVtpbmRleF07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2ggPT09ICcuJykge1xuICAgICAgICAgICAgbnVtYmVyICs9IHNvdXJjZVtpbmRleCsrXTtcbiAgICAgICAgICAgIHdoaWxlIChpc0RlY2ltYWxEaWdpdChzb3VyY2UuY2hhckNvZGVBdChpbmRleCkpKSB7XG4gICAgICAgICAgICAgICAgbnVtYmVyICs9IHNvdXJjZVtpbmRleCsrXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNoID0gc291cmNlW2luZGV4XTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjaCA9PT0gJ2UnIHx8IGNoID09PSAnRScpIHtcbiAgICAgICAgICAgIG51bWJlciArPSBzb3VyY2VbaW5kZXgrK107XG5cbiAgICAgICAgICAgIGNoID0gc291cmNlW2luZGV4XTtcbiAgICAgICAgICAgIGlmIChjaCA9PT0gJysnIHx8IGNoID09PSAnLScpIHtcbiAgICAgICAgICAgICAgICBudW1iZXIgKz0gc291cmNlW2luZGV4KytdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzRGVjaW1hbERpZ2l0KHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KSkpIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAoaXNEZWNpbWFsRGlnaXQoc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpKSkge1xuICAgICAgICAgICAgICAgICAgICBudW1iZXIgKz0gc291cmNlW2luZGV4KytdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3dFcnJvcih7fSwgTWVzc2FnZXMuVW5leHBlY3RlZFRva2VuLCAnSUxMRUdBTCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzSWRlbnRpZmllclN0YXJ0KHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KSkpIHtcbiAgICAgICAgICAgIHRocm93RXJyb3Ioe30sIE1lc3NhZ2VzLlVuZXhwZWN0ZWRUb2tlbiwgJ0lMTEVHQUwnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiBUb2tlbi5OdW1lcmljTGl0ZXJhbCxcbiAgICAgICAgICAgIHZhbHVlOiBwYXJzZUZsb2F0KG51bWJlciksXG4gICAgICAgICAgICByYW5nZTogW3N0YXJ0LCBpbmRleF1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyA3LjguNCBTdHJpbmcgTGl0ZXJhbHNcblxuICAgIGZ1bmN0aW9uIHNjYW5TdHJpbmdMaXRlcmFsKCkge1xuICAgICAgICB2YXIgc3RyID0gJycsIHF1b3RlLCBzdGFydCwgY2gsIG9jdGFsID0gZmFsc2U7XG5cbiAgICAgICAgcXVvdGUgPSBzb3VyY2VbaW5kZXhdO1xuICAgICAgICBhc3NlcnQoKHF1b3RlID09PSAnXFwnJyB8fCBxdW90ZSA9PT0gJ1wiJyksXG4gICAgICAgICAgICAnU3RyaW5nIGxpdGVyYWwgbXVzdCBzdGFydHMgd2l0aCBhIHF1b3RlJyk7XG5cbiAgICAgICAgc3RhcnQgPSBpbmRleDtcbiAgICAgICAgKytpbmRleDtcblxuICAgICAgICB3aGlsZSAoaW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICAgIGNoID0gc291cmNlW2luZGV4KytdO1xuXG4gICAgICAgICAgICBpZiAoY2ggPT09IHF1b3RlKSB7XG4gICAgICAgICAgICAgICAgcXVvdGUgPSAnJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2ggPT09ICdcXFxcJykge1xuICAgICAgICAgICAgICAgIGNoID0gc291cmNlW2luZGV4KytdO1xuICAgICAgICAgICAgICAgIGlmICghY2ggfHwgIWlzTGluZVRlcm1pbmF0b3IoY2guY2hhckNvZGVBdCgwKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICdcXG4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICdcXHInO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAndCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICdcXHQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICdcXGInO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICdcXGYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAndic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICdcXHgwQic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IGNoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoID09PSAnXFxyJyAmJiBzb3VyY2VbaW5kZXhdID09PSAnXFxuJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgKytpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNMaW5lVGVybWluYXRvcihjaC5jaGFyQ29kZUF0KDApKSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdHIgKz0gY2g7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocXVvdGUgIT09ICcnKSB7XG4gICAgICAgICAgICB0aHJvd0Vycm9yKHt9LCBNZXNzYWdlcy5VbmV4cGVjdGVkVG9rZW4sICdJTExFR0FMJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogVG9rZW4uU3RyaW5nTGl0ZXJhbCxcbiAgICAgICAgICAgIHZhbHVlOiBzdHIsXG4gICAgICAgICAgICBvY3RhbDogb2N0YWwsXG4gICAgICAgICAgICByYW5nZTogW3N0YXJ0LCBpbmRleF1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0lkZW50aWZpZXJOYW1lKHRva2VuKSB7XG4gICAgICAgIHJldHVybiB0b2tlbi50eXBlID09PSBUb2tlbi5JZGVudGlmaWVyIHx8XG4gICAgICAgICAgICB0b2tlbi50eXBlID09PSBUb2tlbi5LZXl3b3JkIHx8XG4gICAgICAgICAgICB0b2tlbi50eXBlID09PSBUb2tlbi5Cb29sZWFuTGl0ZXJhbCB8fFxuICAgICAgICAgICAgdG9rZW4udHlwZSA9PT0gVG9rZW4uTnVsbExpdGVyYWw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWR2YW5jZSgpIHtcbiAgICAgICAgdmFyIGNoO1xuXG4gICAgICAgIHNraXBXaGl0ZXNwYWNlKCk7XG5cbiAgICAgICAgaWYgKGluZGV4ID49IGxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBUb2tlbi5FT0YsXG4gICAgICAgICAgICAgICAgcmFuZ2U6IFtpbmRleCwgaW5kZXhdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgY2ggPSBzb3VyY2UuY2hhckNvZGVBdChpbmRleCk7XG5cbiAgICAgICAgLy8gVmVyeSBjb21tb246ICggYW5kICkgYW5kIDtcbiAgICAgICAgaWYgKGNoID09PSA0MCB8fCBjaCA9PT0gNDEgfHwgY2ggPT09IDU4KSB7XG4gICAgICAgICAgICByZXR1cm4gc2NhblB1bmN0dWF0b3IoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN0cmluZyBsaXRlcmFsIHN0YXJ0cyB3aXRoIHNpbmdsZSBxdW90ZSAoIzM5KSBvciBkb3VibGUgcXVvdGUgKCMzNCkuXG4gICAgICAgIGlmIChjaCA9PT0gMzkgfHwgY2ggPT09IDM0KSB7XG4gICAgICAgICAgICByZXR1cm4gc2NhblN0cmluZ0xpdGVyYWwoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc0lkZW50aWZpZXJTdGFydChjaCkpIHtcbiAgICAgICAgICAgIHJldHVybiBzY2FuSWRlbnRpZmllcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRG90ICguKSBjaGFyICM0NiBjYW4gYWxzbyBzdGFydCBhIGZsb2F0aW5nLXBvaW50IG51bWJlciwgaGVuY2UgdGhlIG5lZWRcbiAgICAgICAgLy8gdG8gY2hlY2sgdGhlIG5leHQgY2hhcmFjdGVyLlxuICAgICAgICBpZiAoY2ggPT09IDQ2KSB7XG4gICAgICAgICAgICBpZiAoaXNEZWNpbWFsRGlnaXQoc291cmNlLmNoYXJDb2RlQXQoaW5kZXggKyAxKSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2Nhbk51bWVyaWNMaXRlcmFsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc2NhblB1bmN0dWF0b3IoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc0RlY2ltYWxEaWdpdChjaCkpIHtcbiAgICAgICAgICAgIHJldHVybiBzY2FuTnVtZXJpY0xpdGVyYWwoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzY2FuUHVuY3R1YXRvcigpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxleCgpIHtcbiAgICAgICAgdmFyIHRva2VuO1xuXG4gICAgICAgIHRva2VuID0gbG9va2FoZWFkO1xuICAgICAgICBpbmRleCA9IHRva2VuLnJhbmdlWzFdO1xuXG4gICAgICAgIGxvb2thaGVhZCA9IGFkdmFuY2UoKTtcblxuICAgICAgICBpbmRleCA9IHRva2VuLnJhbmdlWzFdO1xuXG4gICAgICAgIHJldHVybiB0b2tlbjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwZWVrKCkge1xuICAgICAgICB2YXIgcG9zO1xuXG4gICAgICAgIHBvcyA9IGluZGV4O1xuICAgICAgICBsb29rYWhlYWQgPSBhZHZhbmNlKCk7XG4gICAgICAgIGluZGV4ID0gcG9zO1xuICAgIH1cblxuICAgIC8vIFRocm93IGFuIGV4Y2VwdGlvblxuXG4gICAgZnVuY3Rpb24gdGhyb3dFcnJvcih0b2tlbiwgbWVzc2FnZUZvcm1hdCkge1xuICAgICAgICB2YXIgZXJyb3IsXG4gICAgICAgICAgICBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKSxcbiAgICAgICAgICAgIG1zZyA9IG1lc3NhZ2VGb3JtYXQucmVwbGFjZShcbiAgICAgICAgICAgICAgICAvJShcXGQpL2csXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHdob2xlLCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQoaW5kZXggPCBhcmdzLmxlbmd0aCwgJ01lc3NhZ2UgcmVmZXJlbmNlIG11c3QgYmUgaW4gcmFuZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFyZ3NbaW5kZXhdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgZXJyb3IgPSBuZXcgRXJyb3IobXNnKTtcbiAgICAgICAgZXJyb3IuaW5kZXggPSBpbmRleDtcbiAgICAgICAgZXJyb3IuZGVzY3JpcHRpb24gPSBtc2c7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH1cblxuICAgIC8vIFRocm93IGFuIGV4Y2VwdGlvbiBiZWNhdXNlIG9mIHRoZSB0b2tlbi5cblxuICAgIGZ1bmN0aW9uIHRocm93VW5leHBlY3RlZCh0b2tlbikge1xuICAgICAgICB0aHJvd0Vycm9yKHRva2VuLCBNZXNzYWdlcy5VbmV4cGVjdGVkVG9rZW4sIHRva2VuLnZhbHVlKTtcbiAgICB9XG5cbiAgICAvLyBFeHBlY3QgdGhlIG5leHQgdG9rZW4gdG8gbWF0Y2ggdGhlIHNwZWNpZmllZCBwdW5jdHVhdG9yLlxuICAgIC8vIElmIG5vdCwgYW4gZXhjZXB0aW9uIHdpbGwgYmUgdGhyb3duLlxuXG4gICAgZnVuY3Rpb24gZXhwZWN0KHZhbHVlKSB7XG4gICAgICAgIHZhciB0b2tlbiA9IGxleCgpO1xuICAgICAgICBpZiAodG9rZW4udHlwZSAhPT0gVG9rZW4uUHVuY3R1YXRvciB8fCB0b2tlbi52YWx1ZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHRocm93VW5leHBlY3RlZCh0b2tlbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gdHJ1ZSBpZiB0aGUgbmV4dCB0b2tlbiBtYXRjaGVzIHRoZSBzcGVjaWZpZWQgcHVuY3R1YXRvci5cblxuICAgIGZ1bmN0aW9uIG1hdGNoKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBsb29rYWhlYWQudHlwZSA9PT0gVG9rZW4uUHVuY3R1YXRvciAmJiBsb29rYWhlYWQudmFsdWUgPT09IHZhbHVlO1xuICAgIH1cblxuICAgIC8vIFJldHVybiB0cnVlIGlmIHRoZSBuZXh0IHRva2VuIG1hdGNoZXMgdGhlIHNwZWNpZmllZCBrZXl3b3JkXG5cbiAgICBmdW5jdGlvbiBtYXRjaEtleXdvcmQoa2V5d29yZCkge1xuICAgICAgICByZXR1cm4gbG9va2FoZWFkLnR5cGUgPT09IFRva2VuLktleXdvcmQgJiYgbG9va2FoZWFkLnZhbHVlID09PSBrZXl3b3JkO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvbnN1bWVTZW1pY29sb24oKSB7XG4gICAgICAgIC8vIENhdGNoIHRoZSB2ZXJ5IGNvbW1vbiBjYXNlIGZpcnN0OiBpbW1lZGlhdGVseSBhIHNlbWljb2xvbiAoY2hhciAjNTkpLlxuICAgICAgICBpZiAoc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpID09PSA1OSkge1xuICAgICAgICAgICAgbGV4KCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBza2lwV2hpdGVzcGFjZSgpO1xuXG4gICAgICAgIGlmIChtYXRjaCgnOycpKSB7XG4gICAgICAgICAgICBsZXgoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsb29rYWhlYWQudHlwZSAhPT0gVG9rZW4uRU9GICYmICFtYXRjaCgnfScpKSB7XG4gICAgICAgICAgICB0aHJvd1VuZXhwZWN0ZWQobG9va2FoZWFkKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIDExLjEuNCBBcnJheSBJbml0aWFsaXNlclxuXG4gICAgZnVuY3Rpb24gcGFyc2VBcnJheUluaXRpYWxpc2VyKCkge1xuICAgICAgICB2YXIgZWxlbWVudHMgPSBbXTtcblxuICAgICAgICBleHBlY3QoJ1snKTtcblxuICAgICAgICB3aGlsZSAoIW1hdGNoKCddJykpIHtcbiAgICAgICAgICAgIGlmIChtYXRjaCgnLCcpKSB7XG4gICAgICAgICAgICAgICAgbGV4KCk7XG4gICAgICAgICAgICAgICAgZWxlbWVudHMucHVzaChudWxsKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudHMucHVzaChwYXJzZUV4cHJlc3Npb24oKSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIW1hdGNoKCddJykpIHtcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCcsJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZXhwZWN0KCddJyk7XG5cbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmNyZWF0ZUFycmF5RXhwcmVzc2lvbihlbGVtZW50cyk7XG4gICAgfVxuXG4gICAgLy8gMTEuMS41IE9iamVjdCBJbml0aWFsaXNlclxuXG4gICAgZnVuY3Rpb24gcGFyc2VPYmplY3RQcm9wZXJ0eUtleSgpIHtcbiAgICAgICAgdmFyIHRva2VuO1xuXG4gICAgICAgIHNraXBXaGl0ZXNwYWNlKCk7XG4gICAgICAgIHRva2VuID0gbGV4KCk7XG5cbiAgICAgICAgLy8gTm90ZTogVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgb25seSBmcm9tIHBhcnNlT2JqZWN0UHJvcGVydHkoKSwgd2hlcmVcbiAgICAgICAgLy8gRU9GIGFuZCBQdW5jdHVhdG9yIHRva2VucyBhcmUgYWxyZWFkeSBmaWx0ZXJlZCBvdXQuXG4gICAgICAgIGlmICh0b2tlbi50eXBlID09PSBUb2tlbi5TdHJpbmdMaXRlcmFsIHx8IHRva2VuLnR5cGUgPT09IFRva2VuLk51bWVyaWNMaXRlcmFsKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVsZWdhdGUuY3JlYXRlTGl0ZXJhbCh0b2tlbik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZGVsZWdhdGUuY3JlYXRlSWRlbnRpZmllcih0b2tlbi52YWx1ZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VPYmplY3RQcm9wZXJ0eSgpIHtcbiAgICAgICAgdmFyIHRva2VuLCBrZXk7XG5cbiAgICAgICAgdG9rZW4gPSBsb29rYWhlYWQ7XG4gICAgICAgIHNraXBXaGl0ZXNwYWNlKCk7XG5cbiAgICAgICAgaWYgKHRva2VuLnR5cGUgPT09IFRva2VuLkVPRiB8fCB0b2tlbi50eXBlID09PSBUb2tlbi5QdW5jdHVhdG9yKSB7XG4gICAgICAgICAgICB0aHJvd1VuZXhwZWN0ZWQodG9rZW4pO1xuICAgICAgICB9XG5cbiAgICAgICAga2V5ID0gcGFyc2VPYmplY3RQcm9wZXJ0eUtleSgpO1xuICAgICAgICBleHBlY3QoJzonKTtcbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmNyZWF0ZVByb3BlcnR5KCdpbml0Jywga2V5LCBwYXJzZUV4cHJlc3Npb24oKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VPYmplY3RJbml0aWFsaXNlcigpIHtcbiAgICAgICAgdmFyIHByb3BlcnRpZXMgPSBbXTtcblxuICAgICAgICBleHBlY3QoJ3snKTtcblxuICAgICAgICB3aGlsZSAoIW1hdGNoKCd9JykpIHtcbiAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChwYXJzZU9iamVjdFByb3BlcnR5KCkpO1xuXG4gICAgICAgICAgICBpZiAoIW1hdGNoKCd9JykpIHtcbiAgICAgICAgICAgICAgICBleHBlY3QoJywnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGV4cGVjdCgnfScpO1xuXG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZS5jcmVhdGVPYmplY3RFeHByZXNzaW9uKHByb3BlcnRpZXMpO1xuICAgIH1cblxuICAgIC8vIDExLjEuNiBUaGUgR3JvdXBpbmcgT3BlcmF0b3JcblxuICAgIGZ1bmN0aW9uIHBhcnNlR3JvdXBFeHByZXNzaW9uKCkge1xuICAgICAgICB2YXIgZXhwcjtcblxuICAgICAgICBleHBlY3QoJygnKTtcblxuICAgICAgICBleHByID0gcGFyc2VFeHByZXNzaW9uKCk7XG5cbiAgICAgICAgZXhwZWN0KCcpJyk7XG5cbiAgICAgICAgcmV0dXJuIGV4cHI7XG4gICAgfVxuXG5cbiAgICAvLyAxMS4xIFByaW1hcnkgRXhwcmVzc2lvbnNcblxuICAgIGZ1bmN0aW9uIHBhcnNlUHJpbWFyeUV4cHJlc3Npb24oKSB7XG4gICAgICAgIHZhciB0eXBlLCB0b2tlbiwgZXhwcjtcblxuICAgICAgICBpZiAobWF0Y2goJygnKSkge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlR3JvdXBFeHByZXNzaW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0eXBlID0gbG9va2FoZWFkLnR5cGU7XG5cbiAgICAgICAgaWYgKHR5cGUgPT09IFRva2VuLklkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVJZGVudGlmaWVyKGxleCgpLnZhbHVlKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBUb2tlbi5TdHJpbmdMaXRlcmFsIHx8IHR5cGUgPT09IFRva2VuLk51bWVyaWNMaXRlcmFsKSB7XG4gICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlTGl0ZXJhbChsZXgoKSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gVG9rZW4uS2V5d29yZCkge1xuICAgICAgICAgICAgaWYgKG1hdGNoS2V5d29yZCgndGhpcycpKSB7XG4gICAgICAgICAgICAgICAgbGV4KCk7XG4gICAgICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZVRoaXNFeHByZXNzaW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gVG9rZW4uQm9vbGVhbkxpdGVyYWwpIHtcbiAgICAgICAgICAgIHRva2VuID0gbGV4KCk7XG4gICAgICAgICAgICB0b2tlbi52YWx1ZSA9ICh0b2tlbi52YWx1ZSA9PT0gJ3RydWUnKTtcbiAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVMaXRlcmFsKHRva2VuKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBUb2tlbi5OdWxsTGl0ZXJhbCkge1xuICAgICAgICAgICAgdG9rZW4gPSBsZXgoKTtcbiAgICAgICAgICAgIHRva2VuLnZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVMaXRlcmFsKHRva2VuKTtcbiAgICAgICAgfSBlbHNlIGlmIChtYXRjaCgnWycpKSB7XG4gICAgICAgICAgICBleHByID0gcGFyc2VBcnJheUluaXRpYWxpc2VyKCk7XG4gICAgICAgIH0gZWxzZSBpZiAobWF0Y2goJ3snKSkge1xuICAgICAgICAgICAgZXhwciA9IHBhcnNlT2JqZWN0SW5pdGlhbGlzZXIoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChleHByKSB7XG4gICAgICAgICAgICByZXR1cm4gZXhwcjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRocm93VW5leHBlY3RlZChsZXgoKSk7XG4gICAgfVxuXG4gICAgLy8gMTEuMiBMZWZ0LUhhbmQtU2lkZSBFeHByZXNzaW9uc1xuXG4gICAgZnVuY3Rpb24gcGFyc2VBcmd1bWVudHMoKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG5cbiAgICAgICAgZXhwZWN0KCcoJyk7XG5cbiAgICAgICAgaWYgKCFtYXRjaCgnKScpKSB7XG4gICAgICAgICAgICB3aGlsZSAoaW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBhcmdzLnB1c2gocGFyc2VFeHByZXNzaW9uKCkpO1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaCgnKScpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBleHBlY3QoJywnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGV4cGVjdCgnKScpO1xuXG4gICAgICAgIHJldHVybiBhcmdzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlTm9uQ29tcHV0ZWRQcm9wZXJ0eSgpIHtcbiAgICAgICAgdmFyIHRva2VuO1xuXG4gICAgICAgIHRva2VuID0gbGV4KCk7XG5cbiAgICAgICAgaWYgKCFpc0lkZW50aWZpZXJOYW1lKHRva2VuKSkge1xuICAgICAgICAgICAgdGhyb3dVbmV4cGVjdGVkKHRva2VuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZS5jcmVhdGVJZGVudGlmaWVyKHRva2VuLnZhbHVlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZU5vbkNvbXB1dGVkTWVtYmVyKCkge1xuICAgICAgICBleHBlY3QoJy4nKTtcblxuICAgICAgICByZXR1cm4gcGFyc2VOb25Db21wdXRlZFByb3BlcnR5KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VDb21wdXRlZE1lbWJlcigpIHtcbiAgICAgICAgdmFyIGV4cHI7XG5cbiAgICAgICAgZXhwZWN0KCdbJyk7XG5cbiAgICAgICAgZXhwciA9IHBhcnNlRXhwcmVzc2lvbigpO1xuXG4gICAgICAgIGV4cGVjdCgnXScpO1xuXG4gICAgICAgIHJldHVybiBleHByO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlTGVmdEhhbmRTaWRlRXhwcmVzc2lvbigpIHtcbiAgICAgICAgdmFyIGV4cHIsIGFyZ3MsIHByb3BlcnR5O1xuXG4gICAgICAgIGV4cHIgPSBwYXJzZVByaW1hcnlFeHByZXNzaW9uKCk7XG5cbiAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgIGlmIChtYXRjaCgnWycpKSB7XG4gICAgICAgICAgICAgICAgcHJvcGVydHkgPSBwYXJzZUNvbXB1dGVkTWVtYmVyKCk7XG4gICAgICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZU1lbWJlckV4cHJlc3Npb24oJ1snLCBleHByLCBwcm9wZXJ0eSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoKCcuJykpIHtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eSA9IHBhcnNlTm9uQ29tcHV0ZWRNZW1iZXIoKTtcbiAgICAgICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlTWVtYmVyRXhwcmVzc2lvbignLicsIGV4cHIsIHByb3BlcnR5KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2goJygnKSkge1xuICAgICAgICAgICAgICAgIGFyZ3MgPSBwYXJzZUFyZ3VtZW50cygpO1xuICAgICAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVDYWxsRXhwcmVzc2lvbihleHByLCBhcmdzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZXhwcjtcbiAgICB9XG5cbiAgICAvLyAxMS4zIFBvc3RmaXggRXhwcmVzc2lvbnNcblxuICAgIHZhciBwYXJzZVBvc3RmaXhFeHByZXNzaW9uID0gcGFyc2VMZWZ0SGFuZFNpZGVFeHByZXNzaW9uO1xuXG4gICAgLy8gMTEuNCBVbmFyeSBPcGVyYXRvcnNcblxuICAgIGZ1bmN0aW9uIHBhcnNlVW5hcnlFeHByZXNzaW9uKCkge1xuICAgICAgICB2YXIgdG9rZW4sIGV4cHI7XG5cbiAgICAgICAgaWYgKGxvb2thaGVhZC50eXBlICE9PSBUb2tlbi5QdW5jdHVhdG9yICYmIGxvb2thaGVhZC50eXBlICE9PSBUb2tlbi5LZXl3b3JkKSB7XG4gICAgICAgICAgICBleHByID0gcGFyc2VQb3N0Zml4RXhwcmVzc2lvbigpO1xuICAgICAgICB9IGVsc2UgaWYgKG1hdGNoKCcrJykgfHwgbWF0Y2goJy0nKSB8fCBtYXRjaCgnIScpKSB7XG4gICAgICAgICAgICB0b2tlbiA9IGxleCgpO1xuICAgICAgICAgICAgZXhwciA9IHBhcnNlVW5hcnlFeHByZXNzaW9uKCk7XG4gICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlVW5hcnlFeHByZXNzaW9uKHRva2VuLnZhbHVlLCBleHByKTtcbiAgICAgICAgfSBlbHNlIGlmIChtYXRjaEtleXdvcmQoJ2RlbGV0ZScpIHx8IG1hdGNoS2V5d29yZCgndm9pZCcpIHx8IG1hdGNoS2V5d29yZCgndHlwZW9mJykpIHtcbiAgICAgICAgICAgIHRocm93RXJyb3Ioe30sIE1lc3NhZ2VzLlVuZXhwZWN0ZWRUb2tlbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBleHByID0gcGFyc2VQb3N0Zml4RXhwcmVzc2lvbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGV4cHI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYmluYXJ5UHJlY2VkZW5jZSh0b2tlbikge1xuICAgICAgICB2YXIgcHJlYyA9IDA7XG5cbiAgICAgICAgaWYgKHRva2VuLnR5cGUgIT09IFRva2VuLlB1bmN0dWF0b3IgJiYgdG9rZW4udHlwZSAhPT0gVG9rZW4uS2V5d29yZCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cblxuICAgICAgICBzd2l0Y2ggKHRva2VuLnZhbHVlKSB7XG4gICAgICAgICAgICBjYXNlICd8fCc6XG4gICAgICAgICAgICAgICAgcHJlYyA9IDE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJyYmJzpcbiAgICAgICAgICAgICAgICBwcmVjID0gMjtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnPT0nOlxuICAgICAgICAgICAgY2FzZSAnIT0nOlxuICAgICAgICAgICAgY2FzZSAnPT09JzpcbiAgICAgICAgICAgIGNhc2UgJyE9PSc6XG4gICAgICAgICAgICAgICAgcHJlYyA9IDY7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJzwnOlxuICAgICAgICAgICAgY2FzZSAnPic6XG4gICAgICAgICAgICBjYXNlICc8PSc6XG4gICAgICAgICAgICBjYXNlICc+PSc6XG4gICAgICAgICAgICBjYXNlICdpbnN0YW5jZW9mJzpcbiAgICAgICAgICAgICAgICBwcmVjID0gNztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnaW4nOlxuICAgICAgICAgICAgICAgIHByZWMgPSA3O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICcrJzpcbiAgICAgICAgICAgIGNhc2UgJy0nOlxuICAgICAgICAgICAgICAgIHByZWMgPSA5O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICcqJzpcbiAgICAgICAgICAgIGNhc2UgJy8nOlxuICAgICAgICAgICAgY2FzZSAnJSc6XG4gICAgICAgICAgICAgICAgcHJlYyA9IDExO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHByZWM7XG4gICAgfVxuXG4gICAgLy8gMTEuNSBNdWx0aXBsaWNhdGl2ZSBPcGVyYXRvcnNcbiAgICAvLyAxMS42IEFkZGl0aXZlIE9wZXJhdG9yc1xuICAgIC8vIDExLjcgQml0d2lzZSBTaGlmdCBPcGVyYXRvcnNcbiAgICAvLyAxMS44IFJlbGF0aW9uYWwgT3BlcmF0b3JzXG4gICAgLy8gMTEuOSBFcXVhbGl0eSBPcGVyYXRvcnNcbiAgICAvLyAxMS4xMCBCaW5hcnkgQml0d2lzZSBPcGVyYXRvcnNcbiAgICAvLyAxMS4xMSBCaW5hcnkgTG9naWNhbCBPcGVyYXRvcnNcblxuICAgIGZ1bmN0aW9uIHBhcnNlQmluYXJ5RXhwcmVzc2lvbigpIHtcbiAgICAgICAgdmFyIGV4cHIsIHRva2VuLCBwcmVjLCBzdGFjaywgcmlnaHQsIG9wZXJhdG9yLCBsZWZ0LCBpO1xuXG4gICAgICAgIGxlZnQgPSBwYXJzZVVuYXJ5RXhwcmVzc2lvbigpO1xuXG4gICAgICAgIHRva2VuID0gbG9va2FoZWFkO1xuICAgICAgICBwcmVjID0gYmluYXJ5UHJlY2VkZW5jZSh0b2tlbik7XG4gICAgICAgIGlmIChwcmVjID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbGVmdDtcbiAgICAgICAgfVxuICAgICAgICB0b2tlbi5wcmVjID0gcHJlYztcbiAgICAgICAgbGV4KCk7XG5cbiAgICAgICAgcmlnaHQgPSBwYXJzZVVuYXJ5RXhwcmVzc2lvbigpO1xuXG4gICAgICAgIHN0YWNrID0gW2xlZnQsIHRva2VuLCByaWdodF07XG5cbiAgICAgICAgd2hpbGUgKChwcmVjID0gYmluYXJ5UHJlY2VkZW5jZShsb29rYWhlYWQpKSA+IDApIHtcblxuICAgICAgICAgICAgLy8gUmVkdWNlOiBtYWtlIGEgYmluYXJ5IGV4cHJlc3Npb24gZnJvbSB0aGUgdGhyZWUgdG9wbW9zdCBlbnRyaWVzLlxuICAgICAgICAgICAgd2hpbGUgKChzdGFjay5sZW5ndGggPiAyKSAmJiAocHJlYyA8PSBzdGFja1tzdGFjay5sZW5ndGggLSAyXS5wcmVjKSkge1xuICAgICAgICAgICAgICAgIHJpZ2h0ID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgICAgICAgb3BlcmF0b3IgPSBzdGFjay5wb3AoKS52YWx1ZTtcbiAgICAgICAgICAgICAgICBsZWZ0ID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUJpbmFyeUV4cHJlc3Npb24ob3BlcmF0b3IsIGxlZnQsIHJpZ2h0KTtcbiAgICAgICAgICAgICAgICBzdGFjay5wdXNoKGV4cHIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTaGlmdC5cbiAgICAgICAgICAgIHRva2VuID0gbGV4KCk7XG4gICAgICAgICAgICB0b2tlbi5wcmVjID0gcHJlYztcbiAgICAgICAgICAgIHN0YWNrLnB1c2godG9rZW4pO1xuICAgICAgICAgICAgZXhwciA9IHBhcnNlVW5hcnlFeHByZXNzaW9uKCk7XG4gICAgICAgICAgICBzdGFjay5wdXNoKGV4cHIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRmluYWwgcmVkdWNlIHRvIGNsZWFuLXVwIHRoZSBzdGFjay5cbiAgICAgICAgaSA9IHN0YWNrLmxlbmd0aCAtIDE7XG4gICAgICAgIGV4cHIgPSBzdGFja1tpXTtcbiAgICAgICAgd2hpbGUgKGkgPiAxKSB7XG4gICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlQmluYXJ5RXhwcmVzc2lvbihzdGFja1tpIC0gMV0udmFsdWUsIHN0YWNrW2kgLSAyXSwgZXhwcik7XG4gICAgICAgICAgICBpIC09IDI7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZXhwcjtcbiAgICB9XG5cblxuICAgIC8vIDExLjEyIENvbmRpdGlvbmFsIE9wZXJhdG9yXG5cbiAgICBmdW5jdGlvbiBwYXJzZUNvbmRpdGlvbmFsRXhwcmVzc2lvbigpIHtcbiAgICAgICAgdmFyIGV4cHIsIGNvbnNlcXVlbnQsIGFsdGVybmF0ZTtcblxuICAgICAgICBleHByID0gcGFyc2VCaW5hcnlFeHByZXNzaW9uKCk7XG5cbiAgICAgICAgaWYgKG1hdGNoKCc/JykpIHtcbiAgICAgICAgICAgIGxleCgpO1xuICAgICAgICAgICAgY29uc2VxdWVudCA9IHBhcnNlQ29uZGl0aW9uYWxFeHByZXNzaW9uKCk7XG4gICAgICAgICAgICBleHBlY3QoJzonKTtcbiAgICAgICAgICAgIGFsdGVybmF0ZSA9IHBhcnNlQ29uZGl0aW9uYWxFeHByZXNzaW9uKCk7XG5cbiAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVDb25kaXRpb25hbEV4cHJlc3Npb24oZXhwciwgY29uc2VxdWVudCwgYWx0ZXJuYXRlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBleHByO1xuICAgIH1cblxuICAgIC8vIFNpbXBsaWZpY2F0aW9uIHNpbmNlIHdlIGRvIG5vdCBzdXBwb3J0IEFzc2lnbm1lbnRFeHByZXNzaW9uLlxuICAgIHZhciBwYXJzZUV4cHJlc3Npb24gPSBwYXJzZUNvbmRpdGlvbmFsRXhwcmVzc2lvbjtcblxuICAgIC8vIFBvbHltZXIgU3ludGF4IGV4dGVuc2lvbnNcblxuICAgIC8vIEZpbHRlciA6OlxuICAgIC8vICAgSWRlbnRpZmllclxuICAgIC8vICAgSWRlbnRpZmllciBcIihcIiBcIilcIlxuICAgIC8vICAgSWRlbnRpZmllciBcIihcIiBGaWx0ZXJBcmd1bWVudHMgXCIpXCJcblxuICAgIGZ1bmN0aW9uIHBhcnNlRmlsdGVyKCkge1xuICAgICAgICB2YXIgaWRlbnRpZmllciwgYXJncztcblxuICAgICAgICBpZGVudGlmaWVyID0gbGV4KCk7XG5cbiAgICAgICAgaWYgKGlkZW50aWZpZXIudHlwZSAhPT0gVG9rZW4uSWRlbnRpZmllcikge1xuICAgICAgICAgICAgdGhyb3dVbmV4cGVjdGVkKGlkZW50aWZpZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgYXJncyA9IG1hdGNoKCcoJykgPyBwYXJzZUFyZ3VtZW50cygpIDogW107XG5cbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmNyZWF0ZUZpbHRlcihpZGVudGlmaWVyLnZhbHVlLCBhcmdzKTtcbiAgICB9XG5cbiAgICAvLyBGaWx0ZXJzIDo6XG4gICAgLy8gICBcInxcIiBGaWx0ZXJcbiAgICAvLyAgIEZpbHRlcnMgXCJ8XCIgRmlsdGVyXG5cbiAgICBmdW5jdGlvbiBwYXJzZUZpbHRlcnMoKSB7XG4gICAgICAgIHdoaWxlIChtYXRjaCgnfCcpKSB7XG4gICAgICAgICAgICBsZXgoKTtcbiAgICAgICAgICAgIHBhcnNlRmlsdGVyKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUb3BMZXZlbCA6OlxuICAgIC8vICAgTGFiZWxsZWRFeHByZXNzaW9uc1xuICAgIC8vICAgQXNFeHByZXNzaW9uXG4gICAgLy8gICBJbkV4cHJlc3Npb25cbiAgICAvLyAgIEZpbHRlckV4cHJlc3Npb25cblxuICAgIC8vIEFzRXhwcmVzc2lvbiA6OlxuICAgIC8vICAgRmlsdGVyRXhwcmVzc2lvbiBhcyBJZGVudGlmaWVyXG5cbiAgICAvLyBJbkV4cHJlc3Npb24gOjpcbiAgICAvLyAgIElkZW50aWZpZXIsIElkZW50aWZpZXIgaW4gRmlsdGVyRXhwcmVzc2lvblxuICAgIC8vICAgSWRlbnRpZmllciBpbiBGaWx0ZXJFeHByZXNzaW9uXG5cbiAgICAvLyBGaWx0ZXJFeHByZXNzaW9uIDo6XG4gICAgLy8gICBFeHByZXNzaW9uXG4gICAgLy8gICBFeHByZXNzaW9uIEZpbHRlcnNcblxuICAgIGZ1bmN0aW9uIHBhcnNlVG9wTGV2ZWwoKSB7XG4gICAgICAgIHNraXBXaGl0ZXNwYWNlKCk7XG4gICAgICAgIHBlZWsoKTtcblxuICAgICAgICB2YXIgZXhwciA9IHBhcnNlRXhwcmVzc2lvbigpO1xuICAgICAgICBpZiAoZXhwcikge1xuICAgICAgICAgICAgaWYgKGxvb2thaGVhZC52YWx1ZSA9PT0gJywnIHx8IGxvb2thaGVhZC52YWx1ZSA9PSAnaW4nICYmXG4gICAgICAgICAgICAgICAgICAgICAgIGV4cHIudHlwZSA9PT0gU3ludGF4LklkZW50aWZpZXIpIHtcbiAgICAgICAgICAgICAgICBwYXJzZUluRXhwcmVzc2lvbihleHByKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFyc2VGaWx0ZXJzKCk7XG4gICAgICAgICAgICAgICAgaWYgKGxvb2thaGVhZC52YWx1ZSA9PT0gJ2FzJykge1xuICAgICAgICAgICAgICAgICAgICBwYXJzZUFzRXhwcmVzc2lvbihleHByKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkZWxlZ2F0ZS5jcmVhdGVUb3BMZXZlbChleHByKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobG9va2FoZWFkLnR5cGUgIT09IFRva2VuLkVPRikge1xuICAgICAgICAgICAgdGhyb3dVbmV4cGVjdGVkKGxvb2thaGVhZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZUFzRXhwcmVzc2lvbihleHByKSB7XG4gICAgICAgIGxleCgpOyAgLy8gYXNcbiAgICAgICAgdmFyIGlkZW50aWZpZXIgPSBsZXgoKS52YWx1ZTtcbiAgICAgICAgZGVsZWdhdGUuY3JlYXRlQXNFeHByZXNzaW9uKGV4cHIsIGlkZW50aWZpZXIpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlSW5FeHByZXNzaW9uKGlkZW50aWZpZXIpIHtcbiAgICAgICAgdmFyIGluZGV4TmFtZTtcbiAgICAgICAgaWYgKGxvb2thaGVhZC52YWx1ZSA9PT0gJywnKSB7XG4gICAgICAgICAgICBsZXgoKTtcbiAgICAgICAgICAgIGlmIChsb29rYWhlYWQudHlwZSAhPT0gVG9rZW4uSWRlbnRpZmllcilcbiAgICAgICAgICAgICAgICB0aHJvd1VuZXhwZWN0ZWQobG9va2FoZWFkKTtcbiAgICAgICAgICAgIGluZGV4TmFtZSA9IGxleCgpLnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV4KCk7ICAvLyBpblxuICAgICAgICB2YXIgZXhwciA9IHBhcnNlRXhwcmVzc2lvbigpO1xuICAgICAgICBwYXJzZUZpbHRlcnMoKTtcbiAgICAgICAgZGVsZWdhdGUuY3JlYXRlSW5FeHByZXNzaW9uKGlkZW50aWZpZXIubmFtZSwgaW5kZXhOYW1lLCBleHByKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZShjb2RlLCBpbkRlbGVnYXRlKSB7XG4gICAgICAgIGRlbGVnYXRlID0gaW5EZWxlZ2F0ZTtcbiAgICAgICAgc291cmNlID0gY29kZTtcbiAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICBsZW5ndGggPSBzb3VyY2UubGVuZ3RoO1xuICAgICAgICBsb29rYWhlYWQgPSBudWxsO1xuICAgICAgICBzdGF0ZSA9IHtcbiAgICAgICAgICAgIGxhYmVsU2V0OiB7fVxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBwYXJzZVRvcExldmVsKCk7XG4gICAgfVxuXG4gICAgZ2xvYmFsLmVzcHJpbWEgPSB7XG4gICAgICAgIHBhcnNlOiBwYXJzZVxuICAgIH07XG59KShtb2R1bGUuZXhwb3J0cyk7Iiwi77u/LypcbiAqIENvcHlyaWdodCAoYykgMjAxNCBUaGUgUG9seW1lciBQcm9qZWN0IEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBUaGlzIGNvZGUgbWF5IG9ubHkgYmUgdXNlZCB1bmRlciB0aGUgQlNEIHN0eWxlIGxpY2Vuc2UgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0xJQ0VOU0UudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGF1dGhvcnMgbWF5IGJlIGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9BVVRIT1JTLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBjb250cmlidXRvcnMgbWF5IGJlIGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9DT05UUklCVVRPUlMudHh0XG4gKiBDb2RlIGRpc3RyaWJ1dGVkIGJ5IEdvb2dsZSBhcyBwYXJ0IG9mIHRoZSBwb2x5bWVyIHByb2plY3QgaXMgYWxzb1xuICogc3ViamVjdCB0byBhbiBhZGRpdGlvbmFsIElQIHJpZ2h0cyBncmFudCBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vUEFURU5UUy50eHRcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIGRldGVjdEV2YWwoKSB7XG4gICAgLy8gRG9uJ3QgdGVzdCBmb3IgZXZhbCBpZiB3ZSdyZSBydW5uaW5nIGluIGEgQ2hyb21lIEFwcCBlbnZpcm9ubWVudC5cbiAgICAvLyBXZSBjaGVjayBmb3IgQVBJcyBzZXQgdGhhdCBvbmx5IGV4aXN0IGluIGEgQ2hyb21lIEFwcCBjb250ZXh0LlxuICAgIGlmICh0eXBlb2YgY2hyb21lICE9PSAndW5kZWZpbmVkJyAmJiBjaHJvbWUuYXBwICYmIGNocm9tZS5hcHAucnVudGltZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gRmlyZWZveCBPUyBBcHBzIGRvIG5vdCBhbGxvdyBldmFsLiBUaGlzIGZlYXR1cmUgZGV0ZWN0aW9uIGlzIHZlcnkgaGFja3lcbiAgICAvLyBidXQgZXZlbiBpZiBzb21lIG90aGVyIHBsYXRmb3JtIGFkZHMgc3VwcG9ydCBmb3IgdGhpcyBmdW5jdGlvbiB0aGlzIGNvZGVcbiAgICAvLyB3aWxsIGNvbnRpbnVlIHRvIHdvcmsuXG4gICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgIT0gJ3VuZGVmaW5lZCcgJiYgbmF2aWdhdG9yLmdldERldmljZVN0b3JhZ2UpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAgIHZhciBmID0gbmV3IEZ1bmN0aW9uKCcnLCAncmV0dXJuIHRydWU7Jyk7XG4gICAgICAgIHJldHVybiBmKCk7XG4gICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cblxudmFyIGhhc0V2YWwgPSBkZXRlY3RFdmFsKCk7XG5cbmZ1bmN0aW9uIGlzSW5kZXgocykge1xuICAgIHJldHVybiArcyA9PT0gcyA+Pj4gMCAmJiBzICE9PSAnJztcbn1cblxuZnVuY3Rpb24gdG9OdW1iZXIocykge1xuICAgIHJldHVybiArcztcbn1cblxuZnVuY3Rpb24gaXNPYmplY3Qob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gT2JqZWN0KG9iaik7XG59XG5cbnZhciBudW1iZXJJc05hTiA9IE51bWJlci5pc05hTiB8fCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiBpc05hTih2YWx1ZSk7XG59XG5cbmZ1bmN0aW9uIGFyZVNhbWVWYWx1ZShsZWZ0LCByaWdodCkge1xuICAgIGlmIChsZWZ0ID09PSByaWdodClcbiAgICAgICAgcmV0dXJuIGxlZnQgIT09IDAgfHwgMSAvIGxlZnQgPT09IDEgLyByaWdodDtcbiAgICBpZiAobnVtYmVySXNOYU4obGVmdCkgJiYgbnVtYmVySXNOYU4ocmlnaHQpKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgIHJldHVybiBsZWZ0ICE9PSBsZWZ0ICYmIHJpZ2h0ICE9PSByaWdodDtcbn1cblxudmFyIGNyZWF0ZU9iamVjdCA9ICgnX19wcm90b19fJyBpbiB7fSkgP1xuICBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmo7IH0gOlxuICBmdW5jdGlvbiAob2JqKSB7XG4gICAgICB2YXIgcHJvdG8gPSBvYmouX19wcm90b19fO1xuICAgICAgaWYgKCFwcm90bylcbiAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgdmFyIG5ld09iamVjdCA9IE9iamVjdC5jcmVhdGUocHJvdG8pO1xuICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMob2JqKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iamVjdCwgbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwgbmFtZSkpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gbmV3T2JqZWN0O1xuICB9O1xuXG52YXIgaWRlbnRTdGFydCA9ICdbXFwkX2EtekEtWl0nO1xudmFyIGlkZW50UGFydCA9ICdbXFwkX2EtekEtWjAtOV0nO1xudmFyIGlkZW50UmVnRXhwID0gbmV3IFJlZ0V4cCgnXicgKyBpZGVudFN0YXJ0ICsgJysnICsgaWRlbnRQYXJ0ICsgJyonICsgJyQnKTtcblxuZnVuY3Rpb24gZ2V0UGF0aENoYXJUeXBlKGNoYXIpIHtcbiAgICBpZiAoY2hhciA9PT0gdW5kZWZpbmVkKVxuICAgICAgICByZXR1cm4gJ2VvZic7XG5cbiAgICB2YXIgY29kZSA9IGNoYXIuY2hhckNvZGVBdCgwKTtcblxuICAgIHN3aXRjaCAoY29kZSkge1xuICAgICAgICBjYXNlIDB4NUI6IC8vIFtcbiAgICAgICAgY2FzZSAweDVEOiAvLyBdXG4gICAgICAgIGNhc2UgMHgyRTogLy8gLlxuICAgICAgICBjYXNlIDB4MjI6IC8vIFwiXG4gICAgICAgIGNhc2UgMHgyNzogLy8gJ1xuICAgICAgICBjYXNlIDB4MzA6IC8vIDBcbiAgICAgICAgICAgIHJldHVybiBjaGFyO1xuXG4gICAgICAgIGNhc2UgMHg1RjogLy8gX1xuICAgICAgICBjYXNlIDB4MjQ6IC8vICRcbiAgICAgICAgICAgIHJldHVybiAnaWRlbnQnO1xuXG4gICAgICAgIGNhc2UgMHgyMDogLy8gU3BhY2VcbiAgICAgICAgY2FzZSAweDA5OiAvLyBUYWJcbiAgICAgICAgY2FzZSAweDBBOiAvLyBOZXdsaW5lXG4gICAgICAgIGNhc2UgMHgwRDogLy8gUmV0dXJuXG4gICAgICAgIGNhc2UgMHhBMDogIC8vIE5vLWJyZWFrIHNwYWNlXG4gICAgICAgIGNhc2UgMHhGRUZGOiAgLy8gQnl0ZSBPcmRlciBNYXJrXG4gICAgICAgIGNhc2UgMHgyMDI4OiAgLy8gTGluZSBTZXBhcmF0b3JcbiAgICAgICAgY2FzZSAweDIwMjk6ICAvLyBQYXJhZ3JhcGggU2VwYXJhdG9yXG4gICAgICAgICAgICByZXR1cm4gJ3dzJztcbiAgICB9XG5cbiAgICAvLyBhLXosIEEtWlxuICAgIGlmICgoMHg2MSA8PSBjb2RlICYmIGNvZGUgPD0gMHg3QSkgfHwgKDB4NDEgPD0gY29kZSAmJiBjb2RlIDw9IDB4NUEpKVxuICAgICAgICByZXR1cm4gJ2lkZW50JztcblxuICAgIC8vIDEtOVxuICAgIGlmICgweDMxIDw9IGNvZGUgJiYgY29kZSA8PSAweDM5KVxuICAgICAgICByZXR1cm4gJ251bWJlcic7XG5cbiAgICByZXR1cm4gJ2Vsc2UnO1xufVxuXG52YXIgcGF0aFN0YXRlTWFjaGluZSA9IHtcbiAgICAnYmVmb3JlUGF0aCc6IHtcbiAgICAgICAgJ3dzJzogWydiZWZvcmVQYXRoJ10sXG4gICAgICAgICdpZGVudCc6IFsnaW5JZGVudCcsICdhcHBlbmQnXSxcbiAgICAgICAgJ1snOiBbJ2JlZm9yZUVsZW1lbnQnXSxcbiAgICAgICAgJ2VvZic6IFsnYWZ0ZXJQYXRoJ11cbiAgICB9LFxuXG4gICAgJ2luUGF0aCc6IHtcbiAgICAgICAgJ3dzJzogWydpblBhdGgnXSxcbiAgICAgICAgJy4nOiBbJ2JlZm9yZUlkZW50J10sXG4gICAgICAgICdbJzogWydiZWZvcmVFbGVtZW50J10sXG4gICAgICAgICdlb2YnOiBbJ2FmdGVyUGF0aCddXG4gICAgfSxcblxuICAgICdiZWZvcmVJZGVudCc6IHtcbiAgICAgICAgJ3dzJzogWydiZWZvcmVJZGVudCddLFxuICAgICAgICAnaWRlbnQnOiBbJ2luSWRlbnQnLCAnYXBwZW5kJ11cbiAgICB9LFxuXG4gICAgJ2luSWRlbnQnOiB7XG4gICAgICAgICdpZGVudCc6IFsnaW5JZGVudCcsICdhcHBlbmQnXSxcbiAgICAgICAgJzAnOiBbJ2luSWRlbnQnLCAnYXBwZW5kJ10sXG4gICAgICAgICdudW1iZXInOiBbJ2luSWRlbnQnLCAnYXBwZW5kJ10sXG4gICAgICAgICd3cyc6IFsnaW5QYXRoJywgJ3B1c2gnXSxcbiAgICAgICAgJy4nOiBbJ2JlZm9yZUlkZW50JywgJ3B1c2gnXSxcbiAgICAgICAgJ1snOiBbJ2JlZm9yZUVsZW1lbnQnLCAncHVzaCddLFxuICAgICAgICAnZW9mJzogWydhZnRlclBhdGgnLCAncHVzaCddXG4gICAgfSxcblxuICAgICdiZWZvcmVFbGVtZW50Jzoge1xuICAgICAgICAnd3MnOiBbJ2JlZm9yZUVsZW1lbnQnXSxcbiAgICAgICAgJzAnOiBbJ2FmdGVyWmVybycsICdhcHBlbmQnXSxcbiAgICAgICAgJ251bWJlcic6IFsnaW5JbmRleCcsICdhcHBlbmQnXSxcbiAgICAgICAgXCInXCI6IFsnaW5TaW5nbGVRdW90ZScsICdhcHBlbmQnLCAnJ10sXG4gICAgICAgICdcIic6IFsnaW5Eb3VibGVRdW90ZScsICdhcHBlbmQnLCAnJ11cbiAgICB9LFxuXG4gICAgJ2FmdGVyWmVybyc6IHtcbiAgICAgICAgJ3dzJzogWydhZnRlckVsZW1lbnQnLCAncHVzaCddLFxuICAgICAgICAnXSc6IFsnaW5QYXRoJywgJ3B1c2gnXVxuICAgIH0sXG5cbiAgICAnaW5JbmRleCc6IHtcbiAgICAgICAgJzAnOiBbJ2luSW5kZXgnLCAnYXBwZW5kJ10sXG4gICAgICAgICdudW1iZXInOiBbJ2luSW5kZXgnLCAnYXBwZW5kJ10sXG4gICAgICAgICd3cyc6IFsnYWZ0ZXJFbGVtZW50J10sXG4gICAgICAgICddJzogWydpblBhdGgnLCAncHVzaCddXG4gICAgfSxcblxuICAgICdpblNpbmdsZVF1b3RlJzoge1xuICAgICAgICBcIidcIjogWydhZnRlckVsZW1lbnQnXSxcbiAgICAgICAgJ2VvZic6IFsnZXJyb3InXSxcbiAgICAgICAgJ2Vsc2UnOiBbJ2luU2luZ2xlUXVvdGUnLCAnYXBwZW5kJ11cbiAgICB9LFxuXG4gICAgJ2luRG91YmxlUXVvdGUnOiB7XG4gICAgICAgICdcIic6IFsnYWZ0ZXJFbGVtZW50J10sXG4gICAgICAgICdlb2YnOiBbJ2Vycm9yJ10sXG4gICAgICAgICdlbHNlJzogWydpbkRvdWJsZVF1b3RlJywgJ2FwcGVuZCddXG4gICAgfSxcblxuICAgICdhZnRlckVsZW1lbnQnOiB7XG4gICAgICAgICd3cyc6IFsnYWZ0ZXJFbGVtZW50J10sXG4gICAgICAgICddJzogWydpblBhdGgnLCAncHVzaCddXG4gICAgfVxufVxuXG5mdW5jdGlvbiBub29wKCkgeyB9XG5cbmZ1bmN0aW9uIHBhcnNlUGF0aChwYXRoKSB7XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICB2YXIgaW5kZXggPSAtMTtcbiAgICB2YXIgYywgbmV3Q2hhciwga2V5LCB0eXBlLCB0cmFuc2l0aW9uLCBhY3Rpb24sIHR5cGVNYXAsIG1vZGUgPSAnYmVmb3JlUGF0aCc7XG5cbiAgICB2YXIgYWN0aW9ucyA9IHtcbiAgICAgICAgcHVzaDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGtleSA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAga2V5cy5wdXNoKGtleSk7XG4gICAgICAgICAgICBrZXkgPSB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYXBwZW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAga2V5ID0gbmV3Q2hhclxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGtleSArPSBuZXdDaGFyO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIG1heWJlVW5lc2NhcGVRdW90ZSgpIHtcbiAgICAgICAgaWYgKGluZGV4ID49IHBhdGgubGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIHZhciBuZXh0Q2hhciA9IHBhdGhbaW5kZXggKyAxXTtcbiAgICAgICAgaWYgKChtb2RlID09ICdpblNpbmdsZVF1b3RlJyAmJiBuZXh0Q2hhciA9PSBcIidcIikgfHxcbiAgICAgICAgICAgIChtb2RlID09ICdpbkRvdWJsZVF1b3RlJyAmJiBuZXh0Q2hhciA9PSAnXCInKSkge1xuICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIG5ld0NoYXIgPSBuZXh0Q2hhcjtcbiAgICAgICAgICAgIGFjdGlvbnMuYXBwZW5kKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHdoaWxlIChtb2RlKSB7XG4gICAgICAgIGluZGV4Kys7XG4gICAgICAgIGMgPSBwYXRoW2luZGV4XTtcblxuICAgICAgICBpZiAoYyA9PSAnXFxcXCcgJiYgbWF5YmVVbmVzY2FwZVF1b3RlKG1vZGUpKVxuICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgdHlwZSA9IGdldFBhdGhDaGFyVHlwZShjKTtcbiAgICAgICAgdHlwZU1hcCA9IHBhdGhTdGF0ZU1hY2hpbmVbbW9kZV07XG4gICAgICAgIHRyYW5zaXRpb24gPSB0eXBlTWFwW3R5cGVdIHx8IHR5cGVNYXBbJ2Vsc2UnXSB8fCAnZXJyb3InO1xuXG4gICAgICAgIGlmICh0cmFuc2l0aW9uID09ICdlcnJvcicpXG4gICAgICAgICAgICByZXR1cm47IC8vIHBhcnNlIGVycm9yO1xuXG4gICAgICAgIG1vZGUgPSB0cmFuc2l0aW9uWzBdO1xuICAgICAgICBhY3Rpb24gPSBhY3Rpb25zW3RyYW5zaXRpb25bMV1dIHx8IG5vb3A7XG4gICAgICAgIG5ld0NoYXIgPSB0cmFuc2l0aW9uWzJdID09PSB1bmRlZmluZWQgPyBjIDogdHJhbnNpdGlvblsyXTtcbiAgICAgICAgYWN0aW9uKCk7XG5cbiAgICAgICAgaWYgKG1vZGUgPT09ICdhZnRlclBhdGgnKSB7XG4gICAgICAgICAgICByZXR1cm4ga2V5cztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybjsgLy8gcGFyc2UgZXJyb3Jcbn1cblxuZnVuY3Rpb24gaXNJZGVudChzKSB7XG4gICAgcmV0dXJuIGlkZW50UmVnRXhwLnRlc3Qocyk7XG59XG5cbnZhciBjb25zdHJ1Y3RvcklzUHJpdmF0ZSA9IHt9O1xuXG5mdW5jdGlvbiBQYXRoKHBhcnRzLCBwcml2YXRlVG9rZW4pIHtcbiAgICBpZiAocHJpdmF0ZVRva2VuICE9PSBjb25zdHJ1Y3RvcklzUHJpdmF0ZSlcbiAgICAgICAgdGhyb3cgRXJyb3IoJ1VzZSBQYXRoLmdldCB0byByZXRyaWV2ZSBwYXRoIG9iamVjdHMnKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFydHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5wdXNoKFN0cmluZyhwYXJ0c1tpXSkpO1xuICAgIH1cblxuICAgIGlmIChoYXNFdmFsICYmIHRoaXMubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuZ2V0VmFsdWVGcm9tID0gdGhpcy5jb21waWxlZEdldFZhbHVlRnJvbUZuKCk7XG4gICAgfVxufVxuXG4vLyBUT0RPKHJhZmFlbHcpOiBNYWtlIHNpbXBsZSBMUlUgY2FjaGVcbnZhciBwYXRoQ2FjaGUgPSB7fTtcblxuZnVuY3Rpb24gZ2V0UGF0aChwYXRoU3RyaW5nKSB7XG4gICAgaWYgKHBhdGhTdHJpbmcgaW5zdGFuY2VvZiBQYXRoKVxuICAgICAgICByZXR1cm4gcGF0aFN0cmluZztcblxuICAgIGlmIChwYXRoU3RyaW5nID09IG51bGwgfHwgcGF0aFN0cmluZy5sZW5ndGggPT0gMClcbiAgICAgICAgcGF0aFN0cmluZyA9ICcnO1xuXG4gICAgaWYgKHR5cGVvZiBwYXRoU3RyaW5nICE9ICdzdHJpbmcnKSB7XG4gICAgICAgIGlmIChpc0luZGV4KHBhdGhTdHJpbmcubGVuZ3RoKSkge1xuICAgICAgICAgICAgLy8gQ29uc3RydWN0ZWQgd2l0aCBhcnJheS1saWtlIChwcmUtcGFyc2VkKSBrZXlzXG4gICAgICAgICAgICByZXR1cm4gbmV3IFBhdGgocGF0aFN0cmluZywgY29uc3RydWN0b3JJc1ByaXZhdGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcGF0aFN0cmluZyA9IFN0cmluZyhwYXRoU3RyaW5nKTtcbiAgICB9XG5cbiAgICB2YXIgcGF0aCA9IHBhdGhDYWNoZVtwYXRoU3RyaW5nXTtcbiAgICBpZiAocGF0aClcbiAgICAgICAgcmV0dXJuIHBhdGg7XG5cbiAgICB2YXIgcGFydHMgPSBwYXJzZVBhdGgocGF0aFN0cmluZyk7XG4gICAgaWYgKCFwYXJ0cylcbiAgICAgICAgcmV0dXJuIGludmFsaWRQYXRoO1xuXG4gICAgdmFyIHBhdGggPSBuZXcgUGF0aChwYXJ0cywgY29uc3RydWN0b3JJc1ByaXZhdGUpO1xuICAgIHBhdGhDYWNoZVtwYXRoU3RyaW5nXSA9IHBhdGg7XG4gICAgcmV0dXJuIHBhdGg7XG59XG5cblBhdGguZ2V0ID0gZ2V0UGF0aDtcblxuZnVuY3Rpb24gZm9ybWF0QWNjZXNzb3Ioa2V5KSB7XG4gICAgaWYgKGlzSW5kZXgoa2V5KSkge1xuICAgICAgICByZXR1cm4gJ1snICsga2V5ICsgJ10nO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAnW1wiJyArIGtleS5yZXBsYWNlKC9cIi9nLCAnXFxcXFwiJykgKyAnXCJdJztcbiAgICB9XG59XG5cblBhdGgucHJvdG90eXBlID0gY3JlYXRlT2JqZWN0KHtcbiAgICBfX3Byb3RvX186IFtdLFxuICAgIHZhbGlkOiB0cnVlLFxuXG4gICAgdG9TdHJpbmc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhdGhTdHJpbmcgPSAnJztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0gdGhpc1tpXTtcbiAgICAgICAgICAgIGlmIChpc0lkZW50KGtleSkpIHtcbiAgICAgICAgICAgICAgICBwYXRoU3RyaW5nICs9IGkgPyAnLicgKyBrZXkgOiBrZXk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBhdGhTdHJpbmcgKz0gZm9ybWF0QWNjZXNzb3Ioa2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwYXRoU3RyaW5nO1xuICAgIH0sXG5cbiAgICBnZXRWYWx1ZUZyb206IGZ1bmN0aW9uIChvYmosIGRpcmVjdE9ic2VydmVyKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKG9iaiA9PSBudWxsKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIG9iaiA9IG9ialt0aGlzW2ldXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH0sXG5cbiAgICBpdGVyYXRlT2JqZWN0czogZnVuY3Rpb24gKG9iaiwgb2JzZXJ2ZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpKVxuICAgICAgICAgICAgICAgIG9iaiA9IG9ialt0aGlzW2kgLSAxXV07XG4gICAgICAgICAgICBpZiAoIWlzT2JqZWN0KG9iaikpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgb2JzZXJ2ZShvYmosIHRoaXNbaV0pO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNvbXBpbGVkR2V0VmFsdWVGcm9tRm46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0ciA9ICcnO1xuICAgICAgICB2YXIgcGF0aFN0cmluZyA9ICdvYmonO1xuICAgICAgICBzdHIgKz0gJ2lmIChvYmogIT0gbnVsbCc7XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgdmFyIGtleTtcbiAgICAgICAgZm9yICg7IGkgPCAodGhpcy5sZW5ndGggLSAxKSA7IGkrKykge1xuICAgICAgICAgICAga2V5ID0gdGhpc1tpXTtcbiAgICAgICAgICAgIHBhdGhTdHJpbmcgKz0gaXNJZGVudChrZXkpID8gJy4nICsga2V5IDogZm9ybWF0QWNjZXNzb3Ioa2V5KTtcbiAgICAgICAgICAgIHN0ciArPSAnICYmXFxuICAgICAnICsgcGF0aFN0cmluZyArICcgIT0gbnVsbCc7XG4gICAgICAgIH1cbiAgICAgICAgc3RyICs9ICcpXFxuJztcblxuICAgICAgICB2YXIga2V5ID0gdGhpc1tpXTtcbiAgICAgICAgcGF0aFN0cmluZyArPSBpc0lkZW50KGtleSkgPyAnLicgKyBrZXkgOiBmb3JtYXRBY2Nlc3NvcihrZXkpO1xuXG4gICAgICAgIHN0ciArPSAnICByZXR1cm4gJyArIHBhdGhTdHJpbmcgKyAnO1xcbmVsc2VcXG4gIHJldHVybiB1bmRlZmluZWQ7JztcbiAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbignb2JqJywgc3RyKTtcbiAgICB9LFxuXG4gICAgc2V0VmFsdWVGcm9tOiBmdW5jdGlvbiAob2JqLCB2YWx1ZSkge1xuICAgICAgICBpZiAoIXRoaXMubGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgIGlmICghaXNPYmplY3Qob2JqKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBvYmogPSBvYmpbdGhpc1tpXV07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWlzT2JqZWN0KG9iaikpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgb2JqW3RoaXNbaV1dID0gdmFsdWU7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn0pO1xuXG52YXIgaW52YWxpZFBhdGggPSBuZXcgUGF0aCgnJywgY29uc3RydWN0b3JJc1ByaXZhdGUpO1xuaW52YWxpZFBhdGgudmFsaWQgPSBmYWxzZTtcbmludmFsaWRQYXRoLmdldFZhbHVlRnJvbSA9IGludmFsaWRQYXRoLnNldFZhbHVlRnJvbSA9IGZ1bmN0aW9uICgpIHsgfTtcblxuZXhwb3J0cy5QYXRoID0gUGF0aDtcbiIsIu+7vy8vIENvcHlyaWdodCAoYykgMjAxNCBUaGUgUG9seW1lciBQcm9qZWN0IEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBUaGlzIGNvZGUgbWF5IG9ubHkgYmUgdXNlZCB1bmRlciB0aGUgQlNEIHN0eWxlIGxpY2Vuc2UgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0xJQ0VOU0UudHh0XG4vLyBUaGUgY29tcGxldGUgc2V0IG9mIGF1dGhvcnMgbWF5IGJlIGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9BVVRIT1JTLnR4dFxuLy8gVGhlIGNvbXBsZXRlIHNldCBvZiBjb250cmlidXRvcnMgbWF5IGJlIGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9DT05UUklCVVRPUlMudHh0XG4vLyBDb2RlIGRpc3RyaWJ1dGVkIGJ5IEdvb2dsZSBhcyBwYXJ0IG9mIHRoZSBwb2x5bWVyIHByb2plY3QgaXMgYWxzb1xuLy8gc3ViamVjdCB0byBhbiBhZGRpdGlvbmFsIElQIHJpZ2h0cyBncmFudCBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vUEFURU5UUy50eHRcblxudmFyIGVzcHJpbWEgPSByZXF1aXJlKFwianMtbGlicy9lc3ByaW1hXCIpLmVzcHJpbWE7XG52YXIgUGF0aCA9IHJlcXVpcmUoXCJqcy1saWJzL3BvbHltZXItZXhwcmVzc2lvbnMvcGF0aC1wYXJzZXJcIikuUGF0aDtcblxuKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvLyBUT0RPKHJhZmFlbHcpOiBJbXBsZW1lbnQgc2ltcGxlIExSVS5cbiAgICB2YXIgZXhwcmVzc2lvblBhcnNlQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXG4gICAgZnVuY3Rpb24gZ2V0RXhwcmVzc2lvbihleHByZXNzaW9uVGV4dCkge1xuICAgICAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25QYXJzZUNhY2hlW2V4cHJlc3Npb25UZXh0XTtcbiAgICAgICAgaWYgKCFleHByZXNzaW9uKSB7XG4gICAgICAgICAgICB2YXIgZGVsZWdhdGUgPSBuZXcgQVNURGVsZWdhdGUoKTtcbiAgICAgICAgICAgIGVzcHJpbWEucGFyc2UoZXhwcmVzc2lvblRleHQsIGRlbGVnYXRlKTtcbiAgICAgICAgICAgIGV4cHJlc3Npb24gPSBuZXcgRXhwcmVzc2lvbihkZWxlZ2F0ZSk7XG4gICAgICAgICAgICBleHByZXNzaW9uUGFyc2VDYWNoZVtleHByZXNzaW9uVGV4dF0gPSBleHByZXNzaW9uO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIExpdGVyYWwodmFsdWUpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnZhbHVlRm5fID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIExpdGVyYWwucHJvdG90eXBlID0ge1xuICAgICAgICB2YWx1ZUZuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmFsdWVGbl8pIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVGbl8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlRm5fO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gSWRlbnRQYXRoKG5hbWUpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5wYXRoID0gUGF0aC5nZXQobmFtZSk7XG4gICAgfVxuXG4gICAgSWRlbnRQYXRoLnByb3RvdHlwZSA9IHtcbiAgICAgICAgdmFsdWVGbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZhbHVlRm5fKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSB0aGlzLm5hbWU7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGggPSB0aGlzLnBhdGg7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZUZuXyA9IGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGNoYW5nZWRNb2RlbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5hZGRQYXRoKG1vZGVsLCBwYXRoKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdlZE1vZGVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gcGF0aC5nZXRWYWx1ZUZyb20oY2hhbmdlZE1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGF0aC5nZXRWYWx1ZUZyb20obW9kZWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVGbl87XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0VmFsdWU6IGZ1bmN0aW9uIChtb2RlbCwgbmV3VmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhdGgubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgICAgICBtb2RlbCA9IGZpbmRTY29wZShtb2RlbCwgdGhpcy5wYXRoWzBdKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGF0aC5zZXRWYWx1ZUZyb20obW9kZWwsIG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBNZW1iZXJFeHByZXNzaW9uKG9iamVjdCwgcHJvcGVydHksIGFjY2Vzc29yKSB7XG4gICAgICAgIHRoaXMuY29tcHV0ZWQgPSBhY2Nlc3NvciA9PSAnWyc7XG5cbiAgICAgICAgdGhpcy5keW5hbWljRGVwcyA9IHR5cGVvZiBvYmplY3QgPT0gJ2Z1bmN0aW9uJyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0LmR5bmFtaWNEZXBzIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAodGhpcy5jb21wdXRlZCAmJiAhKHByb3BlcnR5IGluc3RhbmNlb2YgTGl0ZXJhbCkpO1xuXG4gICAgICAgIHRoaXMuc2ltcGxlUGF0aCA9XG4gICAgICAgICAgICAhdGhpcy5keW5hbWljRGVwcyAmJlxuICAgICAgICAgICAgKHByb3BlcnR5IGluc3RhbmNlb2YgSWRlbnRQYXRoIHx8IHByb3BlcnR5IGluc3RhbmNlb2YgTGl0ZXJhbCkgJiZcbiAgICAgICAgICAgIChvYmplY3QgaW5zdGFuY2VvZiBNZW1iZXJFeHByZXNzaW9uIHx8IG9iamVjdCBpbnN0YW5jZW9mIElkZW50UGF0aCk7XG5cbiAgICAgICAgdGhpcy5vYmplY3QgPSB0aGlzLnNpbXBsZVBhdGggPyBvYmplY3QgOiBnZXRGbihvYmplY3QpO1xuICAgICAgICB0aGlzLnByb3BlcnR5ID0gIXRoaXMuY29tcHV0ZWQgfHwgdGhpcy5zaW1wbGVQYXRoID9cbiAgICAgICAgICAgIHByb3BlcnR5IDogZ2V0Rm4ocHJvcGVydHkpO1xuICAgIH1cblxuICAgIE1lbWJlckV4cHJlc3Npb24ucHJvdG90eXBlID0ge1xuICAgICAgICBnZXQgZnVsbFBhdGgoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuZnVsbFBhdGhfKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGFydHMgPSB0aGlzLm9iamVjdCBpbnN0YW5jZW9mIE1lbWJlckV4cHJlc3Npb24gP1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9iamVjdC5mdWxsUGF0aC5zbGljZSgpIDogW3RoaXMub2JqZWN0Lm5hbWVdO1xuICAgICAgICAgICAgICAgIHBhcnRzLnB1c2godGhpcy5wcm9wZXJ0eSBpbnN0YW5jZW9mIElkZW50UGF0aCA/XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydHkubmFtZSA6IHRoaXMucHJvcGVydHkudmFsdWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuZnVsbFBhdGhfID0gUGF0aC5nZXQocGFydHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mdWxsUGF0aF87XG4gICAgICAgIH0sXG5cbiAgICAgICAgdmFsdWVGbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZhbHVlRm5fKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9iamVjdCA9IHRoaXMub2JqZWN0O1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2ltcGxlUGF0aCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IHRoaXMuZnVsbFBhdGg7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZUZuXyA9IGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYnNlcnZlcilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5hZGRQYXRoKG1vZGVsLCBwYXRoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhdGguZ2V0VmFsdWVGcm9tKG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLmNvbXB1dGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gUGF0aC5nZXQodGhpcy5wcm9wZXJ0eS5uYW1lKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlRm5fID0gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZXh0ID0gb2JqZWN0KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuYWRkUGF0aChjb250ZXh0LCBwYXRoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhdGguZ2V0VmFsdWVGcm9tKGNvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ29tcHV0ZWQgcHJvcGVydHkuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9wZXJ0eSA9IHRoaXMucHJvcGVydHk7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZUZuXyA9IGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IG9iamVjdChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9wTmFtZSA9IHByb3BlcnR5KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmFkZFBhdGgoY29udGV4dCwgW3Byb3BOYW1lXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0ID8gY29udGV4dFtwcm9wTmFtZV0gOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVGbl87XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0VmFsdWU6IGZ1bmN0aW9uIChtb2RlbCwgbmV3VmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNpbXBsZVBhdGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZ1bGxQYXRoLnNldFZhbHVlRnJvbShtb2RlbCwgbmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXdWYWx1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG9iamVjdCA9IHRoaXMub2JqZWN0KG1vZGVsKTtcbiAgICAgICAgICAgIHZhciBwcm9wTmFtZSA9IHRoaXMucHJvcGVydHkgaW5zdGFuY2VvZiBJZGVudFBhdGggPyB0aGlzLnByb3BlcnR5Lm5hbWUgOlxuICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydHkobW9kZWwpO1xuICAgICAgICAgICAgcmV0dXJuIG9iamVjdFtwcm9wTmFtZV0gPSBuZXdWYWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBGaWx0ZXIobmFtZSwgYXJncykge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLmFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLmFyZ3NbaV0gPSBnZXRGbihhcmdzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIEZpbHRlci5wcm90b3R5cGUgPSB7XG4gICAgICAgIHRyYW5zZm9ybTogZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnksIHRvTW9kZWxEaXJlY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhbEFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBmbiA9IGZpbHRlclJlZ2lzdHJ5W3RoaXMubmFtZV07XG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IG1vZGVsO1xuICAgICAgICAgICAgaWYgKGZuKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm4gPSBjb250ZXh0W3RoaXMubmFtZV07XG4gICAgICAgICAgICAgICAgaWYgKCFmbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDYW5ub3QgZmluZCBmdW5jdGlvbiBvciBmaWx0ZXI6ICcgKyB0aGlzLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJZiB0b01vZGVsRGlyZWN0aW9uIGlzIGZhbHNleSwgdGhlbiB0aGUgXCJub3JtYWxcIiAoZG9tLWJvdW5kKSBkaXJlY3Rpb25cbiAgICAgICAgICAgIC8vIGlzIHVzZWQuIE90aGVyd2lzZSwgaXQgbG9va3MgZm9yIGEgJ3RvTW9kZWwnIHByb3BlcnR5IGZ1bmN0aW9uIG9uIHRoZVxuICAgICAgICAgICAgLy8gb2JqZWN0LlxuICAgICAgICAgICAgaWYgKHRvTW9kZWxEaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBmbiA9IGZuLnRvTW9kZWw7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBmbi50b1ZpZXcgPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGZuID0gZm4udG9WaWV3O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGZuICE9ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDYW5ub3QgZmluZCBmdW5jdGlvbiBvciBmaWx0ZXI6ICcgKyB0aGlzLm5hbWUpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBpbml0aWFsQXJncyB8fCBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5hcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJncy5wdXNoKGdldEZuKHRoaXMuYXJnc1tpXSkobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gbm90SW1wbGVtZW50ZWQoKSB7IHRocm93IEVycm9yKCdOb3QgSW1wbGVtZW50ZWQnKTsgfVxuXG4gICAgdmFyIHVuYXJ5T3BlcmF0b3JzID0ge1xuICAgICAgICAnKyc6IGZ1bmN0aW9uICh2KSB7IHJldHVybiArdjsgfSxcbiAgICAgICAgJy0nOiBmdW5jdGlvbiAodikgeyByZXR1cm4gLXY7IH0sXG4gICAgICAgICchJzogZnVuY3Rpb24gKHYpIHsgcmV0dXJuICF2OyB9XG4gICAgfTtcblxuICAgIHZhciBiaW5hcnlPcGVyYXRvcnMgPSB7XG4gICAgICAgICcrJzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgKyByOyB9LFxuICAgICAgICAnLSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsIC0gcjsgfSxcbiAgICAgICAgJyonOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCAqIHI7IH0sXG4gICAgICAgICcvJzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgLyByOyB9LFxuICAgICAgICAnJSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsICUgcjsgfSxcbiAgICAgICAgJzwnOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCA8IHI7IH0sXG4gICAgICAgICc+JzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgPiByOyB9LFxuICAgICAgICAnPD0nOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCA8PSByOyB9LFxuICAgICAgICAnPj0nOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCA+PSByOyB9LFxuICAgICAgICAnPT0nOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCA9PSByOyB9LFxuICAgICAgICAnIT0nOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCAhPSByOyB9LFxuICAgICAgICAnPT09JzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgPT09IHI7IH0sXG4gICAgICAgICchPT0nOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCAhPT0gcjsgfSxcbiAgICAgICAgJyYmJzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgJiYgcjsgfSxcbiAgICAgICAgJ3x8JzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgfHwgcjsgfSxcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gZ2V0Rm4oYXJnKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgYXJnID09ICdmdW5jdGlvbicgPyBhcmcgOiBhcmcudmFsdWVGbigpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIEFTVERlbGVnYXRlKCkge1xuICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBudWxsO1xuICAgICAgICB0aGlzLmZpbHRlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5kZXBzID0ge307XG4gICAgICAgIHRoaXMuY3VycmVudFBhdGggPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc2NvcGVJZGVudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5pbmRleElkZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmR5bmFtaWNEZXBzID0gZmFsc2U7XG4gICAgfVxuXG4gICAgQVNURGVsZWdhdGUucHJvdG90eXBlID0ge1xuICAgICAgICBjcmVhdGVVbmFyeUV4cHJlc3Npb246IGZ1bmN0aW9uIChvcCwgYXJndW1lbnQpIHtcbiAgICAgICAgICAgIGlmICghdW5hcnlPcGVyYXRvcnNbb3BdKVxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKCdEaXNhbGxvd2VkIG9wZXJhdG9yOiAnICsgb3ApO1xuXG4gICAgICAgICAgICBhcmd1bWVudCA9IGdldEZuKGFyZ3VtZW50KTtcblxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuYXJ5T3BlcmF0b3JzW29wXShhcmd1bWVudChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZUJpbmFyeUV4cHJlc3Npb246IGZ1bmN0aW9uIChvcCwgbGVmdCwgcmlnaHQpIHtcbiAgICAgICAgICAgIGlmICghYmluYXJ5T3BlcmF0b3JzW29wXSlcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcignRGlzYWxsb3dlZCBvcGVyYXRvcjogJyArIG9wKTtcblxuICAgICAgICAgICAgbGVmdCA9IGdldEZuKGxlZnQpO1xuICAgICAgICAgICAgcmlnaHQgPSBnZXRGbihyaWdodCk7XG5cbiAgICAgICAgICAgIHN3aXRjaCAob3ApIHtcbiAgICAgICAgICAgICAgICBjYXNlICd8fCc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZHluYW1pY0RlcHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsZWZ0KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY2FzZSAnJiYnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmR5bmFtaWNEZXBzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGVmdChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYmluYXJ5T3BlcmF0b3JzW29wXShsZWZ0KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlQ29uZGl0aW9uYWxFeHByZXNzaW9uOiBmdW5jdGlvbiAodGVzdCwgY29uc2VxdWVudCwgYWx0ZXJuYXRlKSB7XG4gICAgICAgICAgICB0ZXN0ID0gZ2V0Rm4odGVzdCk7XG4gICAgICAgICAgICBjb25zZXF1ZW50ID0gZ2V0Rm4oY29uc2VxdWVudCk7XG4gICAgICAgICAgICBhbHRlcm5hdGUgPSBnZXRGbihhbHRlcm5hdGUpO1xuXG4gICAgICAgICAgICB0aGlzLmR5bmFtaWNEZXBzID0gdHJ1ZTtcblxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRlc3QobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkgP1xuICAgICAgICAgICAgICAgICAgICBjb25zZXF1ZW50KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIDpcbiAgICAgICAgICAgICAgICAgICAgYWx0ZXJuYXRlKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZUlkZW50aWZpZXI6IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICB2YXIgaWRlbnQgPSBuZXcgSWRlbnRQYXRoKG5hbWUpO1xuICAgICAgICAgICAgaWRlbnQudHlwZSA9ICdJZGVudGlmaWVyJztcbiAgICAgICAgICAgIHJldHVybiBpZGVudDtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVNZW1iZXJFeHByZXNzaW9uOiBmdW5jdGlvbiAoYWNjZXNzb3IsIG9iamVjdCwgcHJvcGVydHkpIHtcbiAgICAgICAgICAgIHZhciBleCA9IG5ldyBNZW1iZXJFeHByZXNzaW9uKG9iamVjdCwgcHJvcGVydHksIGFjY2Vzc29yKTtcbiAgICAgICAgICAgIGlmIChleC5keW5hbWljRGVwcylcbiAgICAgICAgICAgICAgICB0aGlzLmR5bmFtaWNEZXBzID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBleDtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVDYWxsRXhwcmVzc2lvbjogZnVuY3Rpb24gKGV4cHJlc3Npb24sIGFyZ3MpIHtcbiAgICAgICAgICAgIGlmICghKGV4cHJlc3Npb24gaW5zdGFuY2VvZiBJZGVudFBhdGgpKVxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKCdPbmx5IGlkZW50aWZpZXIgZnVuY3Rpb24gaW52b2NhdGlvbnMgYXJlIGFsbG93ZWQnKTtcblxuICAgICAgICAgICAgdmFyIGZpbHRlciA9IG5ldyBGaWx0ZXIoZXhwcmVzc2lvbi5uYW1lLCBhcmdzKTtcblxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlci50cmFuc2Zvcm0obW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSwgZmFsc2UpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVMaXRlcmFsOiBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTGl0ZXJhbCh0b2tlbi52YWx1ZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlQXJyYXlFeHByZXNzaW9uOiBmdW5jdGlvbiAoZWxlbWVudHMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAgZWxlbWVudHNbaV0gPSBnZXRGbihlbGVtZW50c1tpXSk7XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgIHZhciBhcnIgPSBbXVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAgICAgIGFyci5wdXNoKGVsZW1lbnRzW2ldKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXJyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZVByb3BlcnR5OiBmdW5jdGlvbiAoa2luZCwga2V5LCB2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBrZXk6IGtleSBpbnN0YW5jZW9mIElkZW50UGF0aCA/IGtleS5uYW1lIDoga2V5LnZhbHVlLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVPYmplY3RFeHByZXNzaW9uOiBmdW5jdGlvbiAocHJvcGVydGllcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXNbaV0udmFsdWUgPSBnZXRGbihwcm9wZXJ0aWVzW2ldLnZhbHVlKTtcblxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSB7XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcGVydGllcy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICAgICAgb2JqW3Byb3BlcnRpZXNbaV0ua2V5XSA9XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzW2ldLnZhbHVlKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlRmlsdGVyOiBmdW5jdGlvbiAobmFtZSwgYXJncykge1xuICAgICAgICAgICAgdGhpcy5maWx0ZXJzLnB1c2gobmV3IEZpbHRlcihuYW1lLCBhcmdzKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlQXNFeHByZXNzaW9uOiBmdW5jdGlvbiAoZXhwcmVzc2lvbiwgc2NvcGVJZGVudCkge1xuICAgICAgICAgICAgdGhpcy5leHByZXNzaW9uID0gZXhwcmVzc2lvbjtcbiAgICAgICAgICAgIHRoaXMuc2NvcGVJZGVudCA9IHNjb3BlSWRlbnQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlSW5FeHByZXNzaW9uOiBmdW5jdGlvbiAoc2NvcGVJZGVudCwgaW5kZXhJZGVudCwgZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgdGhpcy5leHByZXNzaW9uID0gZXhwcmVzc2lvbjtcbiAgICAgICAgICAgIHRoaXMuc2NvcGVJZGVudCA9IHNjb3BlSWRlbnQ7XG4gICAgICAgICAgICB0aGlzLmluZGV4SWRlbnQgPSBpbmRleElkZW50O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZVRvcExldmVsOiBmdW5jdGlvbiAoZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgdGhpcy5leHByZXNzaW9uID0gZXhwcmVzc2lvbjtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVUaGlzRXhwcmVzc2lvbjogbm90SW1wbGVtZW50ZWRcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBFeHByZXNzaW9uKGRlbGVnYXRlKSB7XG4gICAgICAgIHRoaXMuc2NvcGVJZGVudCA9IGRlbGVnYXRlLnNjb3BlSWRlbnQ7XG4gICAgICAgIHRoaXMuaW5kZXhJZGVudCA9IGRlbGVnYXRlLmluZGV4SWRlbnQ7XG5cbiAgICAgICAgaWYgKCFkZWxlZ2F0ZS5leHByZXNzaW9uKVxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ05vIGV4cHJlc3Npb24gZm91bmQuJyk7XG5cbiAgICAgICAgdGhpcy5leHByZXNzaW9uID0gZGVsZWdhdGUuZXhwcmVzc2lvbjtcbiAgICAgICAgZ2V0Rm4odGhpcy5leHByZXNzaW9uKTsgLy8gZm9yY2VzIGVudW1lcmF0aW9uIG9mIHBhdGggZGVwZW5kZW5jaWVzXG5cbiAgICAgICAgdGhpcy5maWx0ZXJzID0gZGVsZWdhdGUuZmlsdGVycztcbiAgICAgICAgdGhpcy5keW5hbWljRGVwcyA9IGRlbGVnYXRlLmR5bmFtaWNEZXBzO1xuICAgIH1cblxuICAgIEV4cHJlc3Npb24ucHJvdG90eXBlID0ge1xuICAgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24gKG1vZGVsLCBpc0JhY2tDb252ZXJ0LCBjaGFuZ2VkTW9kZWwsIG9ic2VydmVyKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBnZXRGbih0aGlzLmV4cHJlc3Npb24pKG1vZGVsLmNvbnRleHQsIG9ic2VydmVyLCBjaGFuZ2VkTW9kZWwpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmZpbHRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuZmlsdGVyc1tpXS50cmFuc2Zvcm0obW9kZWwuY29udGV4dCwgb2JzZXJ2ZXIsIG1vZGVsLmNvbnRleHQsIGlzQmFja0NvbnZlcnQsIFt2YWx1ZV0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0VmFsdWU6IGZ1bmN0aW9uIChtb2RlbCwgbmV3VmFsdWUsIGZpbHRlclJlZ2lzdHJ5KSB7XG4gICAgICAgICAgICB2YXIgY291bnQgPSB0aGlzLmZpbHRlcnMgPyB0aGlzLmZpbHRlcnMubGVuZ3RoIDogMDtcbiAgICAgICAgICAgIHdoaWxlIChjb3VudC0tID4gMCkge1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gdGhpcy5maWx0ZXJzW2NvdW50XS50cmFuc2Zvcm0obW9kZWwsIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyUmVnaXN0cnksIHRydWUsIFtuZXdWYWx1ZV0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5leHByZXNzaW9uLnNldFZhbHVlKVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmV4cHJlc3Npb24uc2V0VmFsdWUobW9kZWwsIG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGEgc3R5bGUgcHJvcGVydHkgbmFtZSB0byBhIGNzcyBwcm9wZXJ0eSBuYW1lLiBGb3IgZXhhbXBsZTpcbiAgICAgKiBcIldlYmtpdFVzZXJTZWxlY3RcIiB0byBcIi13ZWJraXQtdXNlci1zZWxlY3RcIlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbnZlcnRTdHlsZVByb3BlcnR5TmFtZShuYW1lKSB7XG4gICAgICAgIHJldHVybiBTdHJpbmcobmFtZSkucmVwbGFjZSgvW0EtWl0vZywgZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgIHJldHVybiAnLScgKyBjLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHZhciBwYXJlbnRTY29wZU5hbWUgPSAnQCcgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyKTtcblxuICAgIC8vIFNpbmdsZSBpZGVudCBwYXRocyBtdXN0IGJpbmQgZGlyZWN0bHkgdG8gdGhlIGFwcHJvcHJpYXRlIHNjb3BlIG9iamVjdC5cbiAgICAvLyBJLmUuIFB1c2hlZCB2YWx1ZXMgaW4gdHdvLWJpbmRpbmdzIG5lZWQgdG8gYmUgYXNzaWduZWQgdG8gdGhlIGFjdHVhbCBtb2RlbFxuICAgIC8vIG9iamVjdC5cbiAgICBmdW5jdGlvbiBmaW5kU2NvcGUobW9kZWwsIHByb3ApIHtcbiAgICAgICAgd2hpbGUgKG1vZGVsW3BhcmVudFNjb3BlTmFtZV0gJiZcbiAgICAgICAgICAgICAgICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kZWwsIHByb3ApKSB7XG4gICAgICAgICAgICBtb2RlbCA9IG1vZGVsW3BhcmVudFNjb3BlTmFtZV07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbW9kZWw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNMaXRlcmFsRXhwcmVzc2lvbihwYXRoU3RyaW5nKSB7XG4gICAgICAgIHN3aXRjaCAocGF0aFN0cmluZykge1xuICAgICAgICAgICAgY2FzZSAnJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIGNhc2UgJ2ZhbHNlJzpcbiAgICAgICAgICAgIGNhc2UgJ251bGwnOlxuICAgICAgICAgICAgY2FzZSAndHJ1ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWlzTmFOKE51bWJlcihwYXRoU3RyaW5nKSkpXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFBvbHltZXJFeHByZXNzaW9ucygpIHsgfVxuXG4gICAgUG9seW1lckV4cHJlc3Npb25zLnByb3RvdHlwZSA9IHtcbiAgICAgICAgLy8gXCJidWlsdC1pblwiIGZpbHRlcnNcbiAgICAgICAgc3R5bGVPYmplY3Q6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHBhcnRzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBwYXJ0cy5wdXNoKGNvbnZlcnRTdHlsZVByb3BlcnR5TmFtZShrZXkpICsgJzogJyArIHZhbHVlW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJzsgJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdG9rZW5MaXN0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciB0b2tlbnMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZVtrZXldKVxuICAgICAgICAgICAgICAgICAgICB0b2tlbnMucHVzaChrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRva2Vucy5qb2luKCcgJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gYmluZGluZyBkZWxlZ2F0ZSBBUElcbiAgICAgICAgcHJlcGFyZUluc3RhbmNlUG9zaXRpb25DaGFuZ2VkOiBmdW5jdGlvbiAodGVtcGxhdGUpIHtcbiAgICAgICAgICAgIHZhciBpbmRleElkZW50ID0gdGVtcGxhdGUucG9seW1lckV4cHJlc3Npb25JbmRleElkZW50XztcbiAgICAgICAgICAgIGlmICghaW5kZXhJZGVudClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAodGVtcGxhdGVJbnN0YW5jZSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZUluc3RhbmNlLm1vZGVsW2luZGV4SWRlbnRdID0gaW5kZXg7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIHByZXBhcmVJbnN0YW5jZU1vZGVsOiBmdW5jdGlvbiAodGVtcGxhdGUpIHtcbiAgICAgICAgICAgIHZhciBzY29wZU5hbWUgPSB0ZW1wbGF0ZS5wb2x5bWVyRXhwcmVzc2lvblNjb3BlSWRlbnRfO1xuICAgICAgICAgICAgaWYgKCFzY29wZU5hbWUpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB2YXIgcGFyZW50U2NvcGUgPSB0ZW1wbGF0ZS50ZW1wbGF0ZUluc3RhbmNlID9cbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZS50ZW1wbGF0ZUluc3RhbmNlLm1vZGVsIDpcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZS5tb2RlbDtcblxuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IHRlbXBsYXRlLnBvbHltZXJFeHByZXNzaW9uSW5kZXhJZGVudF87XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlU2NvcGVPYmplY3QocGFyZW50U2NvcGUsIG1vZGVsLCBzY29wZU5hbWUsIGluZGV4TmFtZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHZhciBjcmVhdGVTY29wZU9iamVjdCA9ICgnX19wcm90b19fJyBpbiB7fSkgP1xuICAgICAgZnVuY3Rpb24gKHBhcmVudFNjb3BlLCBtb2RlbCwgc2NvcGVOYW1lLCBpbmRleE5hbWUpIHtcbiAgICAgICAgICB2YXIgc2NvcGUgPSB7fTtcbiAgICAgICAgICBzY29wZVtzY29wZU5hbWVdID0gbW9kZWw7XG4gICAgICAgICAgc2NvcGVbaW5kZXhOYW1lXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICBzY29wZVtwYXJlbnRTY29wZU5hbWVdID0gcGFyZW50U2NvcGU7XG4gICAgICAgICAgc2NvcGUuX19wcm90b19fID0gcGFyZW50U2NvcGU7XG4gICAgICAgICAgcmV0dXJuIHNjb3BlO1xuICAgICAgfSA6XG4gICAgICBmdW5jdGlvbiAocGFyZW50U2NvcGUsIG1vZGVsLCBzY29wZU5hbWUsIGluZGV4TmFtZSkge1xuICAgICAgICAgIHZhciBzY29wZSA9IE9iamVjdC5jcmVhdGUocGFyZW50U2NvcGUpO1xuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzY29wZSwgc2NvcGVOYW1lLFxuICAgICAgICAgICAgICB7IHZhbHVlOiBtb2RlbCwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTtcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2NvcGUsIGluZGV4TmFtZSxcbiAgICAgICAgICAgICAgeyB2YWx1ZTogdW5kZWZpbmVkLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pO1xuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzY29wZSwgcGFyZW50U2NvcGVOYW1lLFxuICAgICAgICAgICAgICB7IHZhbHVlOiBwYXJlbnRTY29wZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTtcbiAgICAgICAgICByZXR1cm4gc2NvcGU7XG4gICAgICB9O1xuXG4gICAgZ2xvYmFsLlBvbHltZXJFeHByZXNzaW9ucyA9IFBvbHltZXJFeHByZXNzaW9ucztcbiAgICBQb2x5bWVyRXhwcmVzc2lvbnMuZ2V0RXhwcmVzc2lvbiA9IGdldEV4cHJlc3Npb247XG59KShtb2R1bGUuZXhwb3J0cyk7IiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIG51bWJlcl91dGlsc18xID0gcmVxdWlyZShcIi4uL3V0aWxzL251bWJlci11dGlsc1wiKTtcbmV4cG9ydHMuZ2V0VHJhbnNmb3JtTWF0cml4ID0gZnVuY3Rpb24gKF9hKSB7XG4gICAgdmFyIHByb3BlcnR5ID0gX2EucHJvcGVydHksIHZhbHVlID0gX2EudmFsdWU7XG4gICAgcmV0dXJuIFRSQU5TRk9STV9NQVRSSVhFU1twcm9wZXJ0eV0odmFsdWUpO1xufTtcbnZhciBUUkFOU0ZPUk1fTUFUUklYRVMgPSB7XG4gICAgXCJzY2FsZVwiOiBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIHggPSBfYS54LCB5ID0gX2EueTtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHgsIDAsIDAsXG4gICAgICAgICAgICAwLCB5LCAwLFxuICAgICAgICAgICAgMCwgMCwgMSxcbiAgICAgICAgXTtcbiAgICB9LFxuICAgIFwidHJhbnNsYXRlXCI6IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgeCA9IF9hLngsIHkgPSBfYS55O1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgMSwgMCwgeCxcbiAgICAgICAgICAgIDAsIDEsIHksXG4gICAgICAgICAgICAwLCAwLCAxLFxuICAgICAgICBdO1xuICAgIH0sXG4gICAgXCJyb3RhdGVcIjogZnVuY3Rpb24gKGFuZ2xlSW5EZWcpIHtcbiAgICAgICAgdmFyIGFuZ2xlSW5SYWQgPSBudW1iZXJfdXRpbHNfMS5kZWdyZWVzVG9SYWRpYW5zKGFuZ2xlSW5EZWcpO1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgTWF0aC5jb3MoYW5nbGVJblJhZCksIC1NYXRoLnNpbihhbmdsZUluUmFkKSwgMCxcbiAgICAgICAgICAgIE1hdGguc2luKGFuZ2xlSW5SYWQpLCBNYXRoLmNvcyhhbmdsZUluUmFkKSwgMCxcbiAgICAgICAgICAgIDAsIDAsIDEsXG4gICAgICAgIF07XG4gICAgfSxcbn07XG5leHBvcnRzLm1hdHJpeEFycmF5VG9Dc3NNYXRyaXggPSBmdW5jdGlvbiAobSkgeyByZXR1cm4gW1xuICAgIG1bMF0sIG1bM10sIG1bMV0sXG4gICAgbVs0XSwgbVsyXSwgbVs1XSxcbl07IH07XG5mdW5jdGlvbiBtdWx0aXBseUFmZmluZTJkKG0xLCBtMikge1xuICAgIHJldHVybiBbXG4gICAgICAgIG0xWzBdICogbTJbMF0gKyBtMVsxXSAqIG0yWzNdLFxuICAgICAgICBtMVswXSAqIG0yWzFdICsgbTFbMV0gKiBtMls0XSxcbiAgICAgICAgbTFbMF0gKiBtMlsyXSArIG0xWzFdICogbTJbNV0gKyBtMVsyXSxcbiAgICAgICAgbTFbM10gKiBtMlswXSArIG0xWzRdICogbTJbM10sXG4gICAgICAgIG0xWzNdICogbTJbMV0gKyBtMVs0XSAqIG0yWzRdLFxuICAgICAgICBtMVszXSAqIG0yWzJdICsgbTFbNF0gKiBtMls1XSArIG0xWzVdXG4gICAgXTtcbn1cbmV4cG9ydHMubXVsdGlwbHlBZmZpbmUyZCA9IG11bHRpcGx5QWZmaW5lMmQ7XG5mdW5jdGlvbiBkZWNvbXBvc2UyRFRyYW5zZm9ybU1hdHJpeChtYXRyaXgpIHtcbiAgICB2ZXJpZnlUcmFuc2Zvcm1NYXRyaXgobWF0cml4KTtcbiAgICB2YXIgX2EgPSBfX3NwcmVhZEFycmF5cyhtYXRyaXgpLCBBID0gX2FbMF0sIEIgPSBfYVsxXSwgQyA9IF9hWzJdLCBEID0gX2FbM10sIEUgPSBfYVs0XSwgRiA9IF9hWzVdO1xuICAgIHZhciBkZXRlcm1pbmFudCA9IEEgKiBEIC0gQiAqIEM7XG4gICAgdmFyIHRyYW5zbGF0ZSA9IHsgeDogRSB8fCAwLCB5OiBGIHx8IDAgfTtcbiAgICB2YXIgcm90YXRlID0gMDtcbiAgICB2YXIgc2NhbGUgPSB7IHg6IDEsIHk6IDEgfTtcbiAgICBpZiAoQSB8fCBCKSB7XG4gICAgICAgIHZhciBSID0gTWF0aC5zcXJ0KEEgKiBBICsgQiAqIEIpO1xuICAgICAgICByb3RhdGUgPSBCID4gMCA/IE1hdGguYWNvcyhBIC8gUikgOiAtTWF0aC5hY29zKEEgLyBSKTtcbiAgICAgICAgc2NhbGUgPSB7IHg6IFIsIHk6IGRldGVybWluYW50IC8gUiB9O1xuICAgIH1cbiAgICBlbHNlIGlmIChDIHx8IEQpIHtcbiAgICAgICAgdmFyIFIgPSBNYXRoLnNxcnQoQyAqIEMgKyBEICogRCk7XG4gICAgICAgIHJvdGF0ZSA9IE1hdGguUEkgLyAyIC0gKEQgPiAwID8gTWF0aC5hY29zKC1DIC8gUikgOiAtTWF0aC5hY29zKEMgLyBSKSk7XG4gICAgICAgIHNjYWxlID0geyB4OiBkZXRlcm1pbmFudCAvIFIsIHk6IFIgfTtcbiAgICB9XG4gICAgcm90YXRlID0gbnVtYmVyX3V0aWxzXzEucmFkaWFuc1RvRGVncmVlcyhyb3RhdGUpO1xuICAgIHJldHVybiB7IHRyYW5zbGF0ZTogdHJhbnNsYXRlLCByb3RhdGU6IHJvdGF0ZSwgc2NhbGU6IHNjYWxlIH07XG59XG5leHBvcnRzLmRlY29tcG9zZTJEVHJhbnNmb3JtTWF0cml4ID0gZGVjb21wb3NlMkRUcmFuc2Zvcm1NYXRyaXg7XG5mdW5jdGlvbiB2ZXJpZnlUcmFuc2Zvcm1NYXRyaXgobWF0cml4KSB7XG4gICAgaWYgKG1hdHJpeC5sZW5ndGggPCA2KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyYW5zZm9ybSBtYXRyaXggc2hvdWxkIGJlIDJ4My5cIik7XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWF0cml4LmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uL3BsYXRmb3JtL3BsYXRmb3JtXCIpO1xudmFyIGFwcENvbW1vbk1vZHVsZSA9IHJlcXVpcmUoXCIuLi9hcHBsaWNhdGlvbi9hcHBsaWNhdGlvbi1jb21tb25cIik7XG52YXIgcXVhbGlmaWVyX21hdGNoZXJfMSA9IHJlcXVpcmUoXCIuL3F1YWxpZmllci1tYXRjaGVyXCIpO1xudmFyIG5vbl9idW5kbGVfd29ya2Zsb3dfY29tcGF0XzEgPSByZXF1aXJlKFwiLi9ub24tYnVuZGxlLXdvcmtmbG93LWNvbXBhdFwiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uL3RyYWNlXCIpO1xudmFyIE1vZHVsZU5hbWVSZXNvbHZlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTW9kdWxlTmFtZVJlc29sdmVyKGNvbnRleHQsIG1vZHVsZUxpc3RQcm92aWRlcikge1xuICAgICAgICBpZiAobW9kdWxlTGlzdFByb3ZpZGVyID09PSB2b2lkIDApIHsgbW9kdWxlTGlzdFByb3ZpZGVyID0gZ2xvYmFsLmdldFJlZ2lzdGVyZWRNb2R1bGVzOyB9XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMubW9kdWxlTGlzdFByb3ZpZGVyID0gbW9kdWxlTGlzdFByb3ZpZGVyO1xuICAgICAgICB0aGlzLl9jYWNoZSA9IHt9O1xuICAgIH1cbiAgICBNb2R1bGVOYW1lUmVzb2x2ZXIucHJvdG90eXBlLnJlc29sdmVNb2R1bGVOYW1lID0gZnVuY3Rpb24gKHBhdGgsIGV4dCkge1xuICAgICAgICB2YXIga2V5ID0gcGF0aCArIGV4dDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuX2NhY2hlW2tleV07XG4gICAgICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5yZXNvbHZlTW9kdWxlTmFtZUltcGwocGF0aCwgZXh0KTtcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlW2tleV0gPSByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJwYXRoOiAnXCIgKyBwYXRoICsgXCInIHdpdGggZXh0OiAnXCIgKyBleHQgKyBcIicgcmVzb2x2ZWQ6ICdcIiArIHJlc3VsdCArIFwiJ1wiLCB0cmFjZV8xLmNhdGVnb3JpZXMuTW9kdWxlTmFtZVJlc29sdmVyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgTW9kdWxlTmFtZVJlc29sdmVyLnByb3RvdHlwZS5jbGVhckNhY2hlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jYWNoZSA9IHt9O1xuICAgIH07XG4gICAgTW9kdWxlTmFtZVJlc29sdmVyLnByb3RvdHlwZS5yZXNvbHZlTW9kdWxlTmFtZUltcGwgPSBmdW5jdGlvbiAocGF0aCwgZXh0KSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBudWxsO1xuICAgICAgICBleHQgPSBleHQgPyBcIi5cIiArIGV4dCA6IFwiXCI7XG4gICAgICAgIGlmICghZ2xvYmFsLlROU19XRUJQQUNLKSB7XG4gICAgICAgICAgICBub25fYnVuZGxlX3dvcmtmbG93X2NvbXBhdF8xLnJlZ2lzdGVyTW9kdWxlc0Zyb21GaWxlU3lzdGVtKHBhdGgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjYW5kaWRhdGVzID0gdGhpcy5nZXRDYW5kaWRhdGVzKHBhdGgsIGV4dCk7XG4gICAgICAgIHJlc3VsdCA9IHF1YWxpZmllcl9tYXRjaGVyXzEuZmluZE1hdGNoKHBhdGgsIGV4dCwgY2FuZGlkYXRlcywgdGhpcy5jb250ZXh0KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIE1vZHVsZU5hbWVSZXNvbHZlci5wcm90b3R5cGUuZ2V0Q2FuZGlkYXRlcyA9IGZ1bmN0aW9uIChwYXRoLCBleHQpIHtcbiAgICAgICAgdmFyIGNhbmRpZGF0ZXMgPSB0aGlzLm1vZHVsZUxpc3RQcm92aWRlcigpXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChtb2R1bGVOYW1lKSB7IHJldHVybiBtb2R1bGVOYW1lLnN0YXJ0c1dpdGgocGF0aCkgJiYgKCFleHQgfHwgbW9kdWxlTmFtZS5lbmRzV2l0aChleHQpKTsgfSk7XG4gICAgICAgIHJldHVybiBjYW5kaWRhdGVzO1xuICAgIH07XG4gICAgcmV0dXJuIE1vZHVsZU5hbWVSZXNvbHZlcjtcbn0oKSk7XG5leHBvcnRzLk1vZHVsZU5hbWVSZXNvbHZlciA9IE1vZHVsZU5hbWVSZXNvbHZlcjtcbnZhciByZXNvbHZlckluc3RhbmNlO1xuZnVuY3Rpb24gcmVzb2x2ZU1vZHVsZU5hbWUocGF0aCwgZXh0KSB7XG4gICAgaWYgKGdsb2JhbC5fX3NuYXBzaG90KSB7XG4gICAgICAgIHJldHVybiByZXNvbHZlTW9kdWxlU25hcHNob3QocGF0aCwgZXh0KTtcbiAgICB9XG4gICAgaWYgKCFyZXNvbHZlckluc3RhbmNlKSB7XG4gICAgICAgIHJlc29sdmVySW5zdGFuY2UgPSBuZXcgTW9kdWxlTmFtZVJlc29sdmVyKHtcbiAgICAgICAgICAgIHdpZHRoOiBwbGF0Zm9ybV8xLnNjcmVlbi5tYWluU2NyZWVuLndpZHRoRElQcyxcbiAgICAgICAgICAgIGhlaWdodDogcGxhdGZvcm1fMS5zY3JlZW4ubWFpblNjcmVlbi5oZWlnaHRESVBzLFxuICAgICAgICAgICAgb3M6IHBsYXRmb3JtXzEuZGV2aWNlLm9zLFxuICAgICAgICAgICAgZGV2aWNlVHlwZTogcGxhdGZvcm1fMS5kZXZpY2UuZGV2aWNlVHlwZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc29sdmVySW5zdGFuY2UucmVzb2x2ZU1vZHVsZU5hbWUocGF0aCwgZXh0KTtcbn1cbmV4cG9ydHMucmVzb2x2ZU1vZHVsZU5hbWUgPSByZXNvbHZlTW9kdWxlTmFtZTtcbmZ1bmN0aW9uIHJlc29sdmVNb2R1bGVTbmFwc2hvdChwYXRoLCBleHQpIHtcbiAgICB0cmFjZV8xLndyaXRlKFwiUmVzb2x2aW5nIG1vZHVsZSBpbiBTTkFQU0hPVCBjb250ZXh0IC0gcGF0aDogJ1wiICsgcGF0aCArIFwiJyB3aXRoIGV4dDogJ1wiICsgZXh0ICsgXCInXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5Nb2R1bGVOYW1lUmVzb2x2ZXIpO1xuICAgIHJldHVybiBuZXcgTW9kdWxlTmFtZVJlc29sdmVyKHtcbiAgICAgICAgd2lkdGg6IDQwMCxcbiAgICAgICAgaGVpZ2h0OiA4MDAsXG4gICAgICAgIG9zOiBcIkFuZHJvaWRcIixcbiAgICAgICAgZGV2aWNlVHlwZTogXCJQaG9uZVwiXG4gICAgfSkucmVzb2x2ZU1vZHVsZU5hbWUocGF0aCwgZXh0KTtcbn1cbmZ1bmN0aW9uIGNsZWFyQ2FjaGUoKSB7XG4gICAgaWYgKHJlc29sdmVySW5zdGFuY2UpIHtcbiAgICAgICAgcmVzb2x2ZXJJbnN0YW5jZS5jbGVhckNhY2hlKCk7XG4gICAgfVxufVxuZXhwb3J0cy5jbGVhckNhY2hlID0gY2xlYXJDYWNoZTtcbmZ1bmN0aW9uIF9zZXRSZXNvbHZlcihyZXNvbHZlcikge1xuICAgIHJlc29sdmVySW5zdGFuY2UgPSByZXNvbHZlcjtcbn1cbmV4cG9ydHMuX3NldFJlc29sdmVyID0gX3NldFJlc29sdmVyO1xuYXBwQ29tbW9uTW9kdWxlLm9uKFwibGl2ZXN5bmNcIiwgZnVuY3Rpb24gKGFyZ3MpIHsgcmV0dXJuIGNsZWFyQ2FjaGUoKTsgfSk7XG5hcHBDb21tb25Nb2R1bGUub24oXCJvcmllbnRhdGlvbkNoYW5nZWRcIiwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICByZXNvbHZlckluc3RhbmNlID0gdW5kZWZpbmVkO1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUtbmFtZS1yZXNvbHZlci5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZnMgPSByZXF1aXJlKFwiLi4vZmlsZS1zeXN0ZW0vZmlsZS1zeXN0ZW1cIik7XG52YXIgYXBwQ29tbW9uTW9kdWxlID0gcmVxdWlyZShcIi4uL2FwcGxpY2F0aW9uL2FwcGxpY2F0aW9uLWNvbW1vblwiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uL3RyYWNlXCIpO1xudmFyIGNhY2hlID0gbmV3IFNldCgpO1xudmFyIGluaXRpYWxpemVkID0gZmFsc2U7XG5mdW5jdGlvbiByZWdpc3RlcihuYW1lLCBsb2FkZXIpIHtcbiAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICB0cmFjZV8xLndyaXRlKFwiW0NvbXBhdF0gUmVnaXN0ZXIgbW9kdWxlOiBcIiArIG5hbWUsIHRyYWNlXzEuY2F0ZWdvcmllcy5Nb2R1bGVOYW1lUmVzb2x2ZXIpO1xuICAgIH1cbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUobmFtZSwgbG9hZGVyKTtcbiAgICBpZiAobmFtZS5zdGFydHNXaXRoKFwidG5zX21vZHVsZXNcIikpIHtcbiAgICAgICAgdmFyIG5vblRuc01vZHVsZXNOYW1lID0gbmFtZS5zdWJzdHIoXCJ0bnNfbW9kdWxlc1wiLmxlbmd0aCArIDEpO1xuICAgICAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIltDb21wYXRdIFJlZ2lzdGVyIG1vZHVsZTogXCIgKyBub25UbnNNb2R1bGVzTmFtZSwgdHJhY2VfMS5jYXRlZ29yaWVzLk1vZHVsZU5hbWVSZXNvbHZlcik7XG4gICAgICAgIH1cbiAgICAgICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKG5vblRuc01vZHVsZXNOYW1lLCBsb2FkZXIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHByb2Nlc3NGaWxlKGZpbGUpIHtcbiAgICB2YXIgZmlsZVBhdGhSZWxhdGl2ZVRvQXBwID0gZmlsZS5wYXRoLnN1YnN0cihmcy5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgubGVuZ3RoICsgMSk7XG4gICAgdmFyIGxvYWRDb250ZW50ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZmlsZS5yZWFkVGV4dFN5bmMoKTsgfTtcbiAgICBzd2l0Y2ggKGZpbGUuZXh0ZW5zaW9uLnRvTG9jYWxlTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgY2FzZSBcIi5qc1wiOlxuICAgICAgICAgICAgdmFyIG5vRXh0UGF0aCA9IGZpbGVQYXRoUmVsYXRpdmVUb0FwcC5zdWJzdHIoMCwgZmlsZVBhdGhSZWxhdGl2ZVRvQXBwLmxlbmd0aCAtIFwiLmpzXCIubGVuZ3RoKTtcbiAgICAgICAgICAgIHJlZ2lzdGVyKGZpbGVQYXRoUmVsYXRpdmVUb0FwcCwgZnVuY3Rpb24gKCkgeyByZXR1cm4gZ2xvYmFsLnJlcXVpcmUoZmlsZS5wYXRoKTsgfSk7XG4gICAgICAgICAgICByZWdpc3Rlcihub0V4dFBhdGgsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdsb2JhbC5yZXF1aXJlKGZpbGUucGF0aCk7IH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCIuY3NzXCI6XG4gICAgICAgICAgICByZWdpc3RlcihmaWxlUGF0aFJlbGF0aXZlVG9BcHAsIGxvYWRDb250ZW50KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiLnhtbFwiOlxuICAgICAgICAgICAgcmVnaXN0ZXIoZmlsZVBhdGhSZWxhdGl2ZVRvQXBwLCBsb2FkQ29udGVudCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKGZpbGUubmFtZSA9PT0gXCJwYWNrYWdlLmpzb25cIikge1xuICAgICAgICB2YXIganNvbiA9IGdsb2JhbC5yZXF1aXJlKGZpbGUucGF0aCk7XG4gICAgICAgIGlmIChqc29uLm1haW4pIHtcbiAgICAgICAgICAgIHZhciBuYW1lXzEgPSBmaWxlUGF0aFJlbGF0aXZlVG9BcHAuc3Vic3RyKDAsIGZpbGVQYXRoUmVsYXRpdmVUb0FwcC5sZW5ndGggLSBcInBhY2thZ2UuanNvblwiLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgdmFyIHJlcXVpcmVQYXRoXzEgPSBmcy5wYXRoLmpvaW4oZmlsZS5wYXJlbnQucGF0aCwganNvbi5tYWluKTtcbiAgICAgICAgICAgIHJlZ2lzdGVyKG5hbWVfMSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gZ2xvYmFsLnJlcXVpcmUocmVxdWlyZVBhdGhfMSk7IH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gcHJvY2Vzc0ZvbGRlcihwYXRoKSB7XG4gICAgaWYgKGNhY2hlLmhhcyhwYXRoKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgY2FjaGUuYWRkKHBhdGgpO1xuICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgIHRyYWNlXzEud3JpdGUoXCJbQ29tcGF0XSBQcm9jZXNzaW5nIGZvbGRlcjogXCIgKyBwYXRoLCB0cmFjZV8xLmNhdGVnb3JpZXMuTW9kdWxlTmFtZVJlc29sdmVyKTtcbiAgICB9XG4gICAgdmFyIGZvbGRlckVtcHR5ID0gdHJ1ZTtcbiAgICBpZiAoZnMuRm9sZGVyLmV4aXN0cyhwYXRoKSkge1xuICAgICAgICB2YXIgZm9sZGVyID0gZnMuRm9sZGVyLmZyb21QYXRoKHBhdGgpO1xuICAgICAgICBmb2xkZXIuZWFjaEVudGl0eShmdW5jdGlvbiAoZmlsZSkge1xuICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBmcy5GaWxlKSB7XG4gICAgICAgICAgICAgICAgcHJvY2Vzc0ZpbGUoZmlsZSk7XG4gICAgICAgICAgICAgICAgZm9sZGVyRW1wdHkgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuICFmb2xkZXJFbXB0eTtcbn1cbmZ1bmN0aW9uIHJlZ2lzdGVyTW9kdWxlc0Zyb21GaWxlU3lzdGVtKG1vZHVsZU5hbWUpIHtcbiAgICBpbml0aWFsaXplKCk7XG4gICAgdmFyIGZvbGRlclByb2Nlc3NlZCA9IGZhbHNlO1xuICAgIHZhciBwYXJlbnRGb2xkZXJQcm9jZXNzZWQgPSBmYWxzZTtcbiAgICB2YXIgcGF0aCA9IGZzLnBhdGguam9pbihmcy5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgsIG1vZHVsZU5hbWUpO1xuICAgIGlmIChmcy5Gb2xkZXIuZXhpc3RzKHBhdGgpKSB7XG4gICAgICAgIGZvbGRlclByb2Nlc3NlZCA9IHByb2Nlc3NGb2xkZXIocGF0aCk7XG4gICAgfVxuICAgIHZhciBwYXJlbnROYW1lID0gbW9kdWxlTmFtZS5zdWJzdHIoMCwgbW9kdWxlTmFtZS5sYXN0SW5kZXhPZihmcy5wYXRoLnNlcGFyYXRvcikpO1xuICAgIHZhciBwYXJlbnRGb2xkZXJQYXRoID0gZnMucGF0aC5qb2luKGZzLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCwgcGFyZW50TmFtZSk7XG4gICAgaWYgKGZzLkZvbGRlci5leGlzdHMocGFyZW50Rm9sZGVyUGF0aCkpIHtcbiAgICAgICAgcGFyZW50Rm9sZGVyUHJvY2Vzc2VkID0gcHJvY2Vzc0ZvbGRlcihwYXJlbnRGb2xkZXJQYXRoKTtcbiAgICB9XG4gICAgaWYgKGZvbGRlclByb2Nlc3NlZCB8fCAocGFyZW50Rm9sZGVyUHJvY2Vzc2VkICYmIHBhcmVudE5hbWUpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRuc01vZHVsZXNQYXRoID0gZnMucGF0aC5qb2luKGZzLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCwgXCJ0bnNfbW9kdWxlc1wiLCBtb2R1bGVOYW1lKTtcbiAgICBpZiAoZnMuRm9sZGVyLmV4aXN0cyh0bnNNb2R1bGVzUGF0aCkpIHtcbiAgICAgICAgcHJvY2Vzc0ZvbGRlcih0bnNNb2R1bGVzUGF0aCk7XG4gICAgfVxuICAgIGlmIChwYXJlbnROYW1lKSB7XG4gICAgICAgIHZhciB0bnNQYXJlbnRGb2xkZXJQYXRoID0gZnMucGF0aC5qb2luKGZzLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCwgXCJ0bnNfbW9kdWxlc1wiLCBwYXJlbnROYW1lKTtcbiAgICAgICAgaWYgKGZzLkZvbGRlci5leGlzdHModG5zUGFyZW50Rm9sZGVyUGF0aCkpIHtcbiAgICAgICAgICAgIHByb2Nlc3NGb2xkZXIodG5zUGFyZW50Rm9sZGVyUGF0aCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLnJlZ2lzdGVyTW9kdWxlc0Zyb21GaWxlU3lzdGVtID0gcmVnaXN0ZXJNb2R1bGVzRnJvbUZpbGVTeXN0ZW07XG5mdW5jdGlvbiBpbml0aWFsaXplKCkge1xuICAgIGlmICghaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgYXBwQ29tbW9uTW9kdWxlLm9uKFwibGl2ZXN5bmNcIiwgZnVuY3Rpb24gKGFyZ3MpIHsgcmV0dXJuIGNhY2hlLmNsZWFyKCk7IH0pO1xuICAgICAgICBpbml0aWFsaXplZCA9IHRydWU7XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bm9uLWJ1bmRsZS13b3JrZmxvdy1jb21wYXQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIE1JTl9XSCA9IFwibWluV0hcIjtcbnZhciBNSU5fVyA9IFwibWluV1wiO1xudmFyIE1JTl9IID0gXCJtaW5IXCI7XG52YXIgUFJJT1JJVFlfU1RFUCA9IDEwMDAwO1xudmFyIG1pbldpZHRoSGVpZ2h0UXVhbGlmaWVyID0ge1xuICAgIGlzTWF0Y2g6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUuaW5kZXhPZihNSU5fV0gpID09PSAwO1xuICAgIH0sXG4gICAgZ2V0TWF0Y2hWYWx1ZTogZnVuY3Rpb24gKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgICAgIHZhciBudW1WYWwgPSBwYXJzZUludCh2YWx1ZS5zdWJzdHIoTUlOX1dILmxlbmd0aCkpO1xuICAgICAgICBpZiAoaXNOYU4obnVtVmFsKSkge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhY3R1YWxMZW5ndGggPSBNYXRoLm1pbihjb250ZXh0LndpZHRoLCBjb250ZXh0LmhlaWdodCk7XG4gICAgICAgIGlmIChhY3R1YWxMZW5ndGggPCBudW1WYWwpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUFJJT1JJVFlfU1RFUCAtIChhY3R1YWxMZW5ndGggLSBudW1WYWwpO1xuICAgIH1cbn07XG52YXIgbWluV2lkdGhRdWFsaWZpZXIgPSB7XG4gICAgaXNNYXRjaDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZS5pbmRleE9mKE1JTl9XKSA9PT0gMCAmJiB2YWx1ZS5pbmRleE9mKE1JTl9XSCkgPCAwO1xuICAgIH0sXG4gICAgZ2V0TWF0Y2hWYWx1ZTogZnVuY3Rpb24gKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgICAgIHZhciBudW1WYWwgPSBwYXJzZUludCh2YWx1ZS5zdWJzdHIoTUlOX1cubGVuZ3RoKSk7XG4gICAgICAgIGlmIChpc05hTihudW1WYWwpKSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFjdHVhbFdpZHRoID0gY29udGV4dC53aWR0aDtcbiAgICAgICAgaWYgKGFjdHVhbFdpZHRoIDwgbnVtVmFsKSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFBSSU9SSVRZX1NURVAgLSAoYWN0dWFsV2lkdGggLSBudW1WYWwpO1xuICAgIH1cbn07XG52YXIgbWluSGVpZ2h0UXVhbGlmaWVyID0ge1xuICAgIGlzTWF0Y2g6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUuaW5kZXhPZihNSU5fSCkgPT09IDAgJiYgdmFsdWUuaW5kZXhPZihNSU5fV0gpIDwgMDtcbiAgICB9LFxuICAgIGdldE1hdGNoVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICB2YXIgbnVtVmFsID0gcGFyc2VJbnQodmFsdWUuc3Vic3RyKE1JTl9ILmxlbmd0aCkpO1xuICAgICAgICBpZiAoaXNOYU4obnVtVmFsKSkge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhY3R1YWxIZWlnaHQgPSBjb250ZXh0LmhlaWdodDtcbiAgICAgICAgaWYgKGFjdHVhbEhlaWdodCA8IG51bVZhbCkge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQUklPUklUWV9TVEVQIC0gKGFjdHVhbEhlaWdodCAtIG51bVZhbCk7XG4gICAgfVxufTtcbnZhciBwbGF0Zm9ybVF1YWxpZmllciA9IHtcbiAgICBpc01hdGNoOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlID09PSBcImFuZHJvaWRcIiB8fFxuICAgICAgICAgICAgdmFsdWUgPT09IFwiaW9zXCI7XG4gICAgfSxcbiAgICBnZXRNYXRjaFZhbHVlOiBmdW5jdGlvbiAodmFsdWUsIGNvbnRleHQpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlID09PSBjb250ZXh0Lm9zLnRvTG93ZXJDYXNlKCkgPyAxIDogLTE7XG4gICAgfVxufTtcbnZhciBvcmllbnRhdGlvblF1YWxpZmllciA9IHtcbiAgICBpc01hdGNoOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlID09PSBcImxhbmRcIiB8fFxuICAgICAgICAgICAgdmFsdWUgPT09IFwicG9ydFwiO1xuICAgIH0sXG4gICAgZ2V0TWF0Y2hWYWx1ZTogZnVuY3Rpb24gKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgICAgIHZhciBpc0xhbmRzY2FwZSA9IChjb250ZXh0LndpZHRoID4gY29udGV4dC5oZWlnaHQpID8gMSA6IC0xO1xuICAgICAgICByZXR1cm4gKHZhbHVlID09PSBcImxhbmRcIikgPyBpc0xhbmRzY2FwZSA6IC1pc0xhbmRzY2FwZTtcbiAgICB9XG59O1xudmFyIHN1cHBvcnRlZFF1YWxpZmllcnMgPSBbXG4gICAgbWluV2lkdGhIZWlnaHRRdWFsaWZpZXIsXG4gICAgbWluV2lkdGhRdWFsaWZpZXIsXG4gICAgbWluSGVpZ2h0UXVhbGlmaWVyLFxuICAgIG9yaWVudGF0aW9uUXVhbGlmaWVyLFxuICAgIHBsYXRmb3JtUXVhbGlmaWVyXG5dO1xuZnVuY3Rpb24gY2hlY2tRdWFsaWZpZXJzKHF1YWxpZmllcnMsIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0ID0gMDtcbiAgICB2YXIgdmFsdWU7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWFsaWZpZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChxdWFsaWZpZXJzW2ldKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IGNoZWNrUXVhbGlmaWVyKHF1YWxpZmllcnNbaV0sIGNvbnRleHQpO1xuICAgICAgICAgICAgaWYgKHZhbHVlIDwgMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc3VsdCArPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gY2hlY2tRdWFsaWZpZXIodmFsdWUsIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3VwcG9ydGVkUXVhbGlmaWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoc3VwcG9ydGVkUXVhbGlmaWVyc1tpXS5pc01hdGNoKHZhbHVlKSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gc3VwcG9ydGVkUXVhbGlmaWVyc1tpXS5nZXRNYXRjaFZhbHVlKHZhbHVlLCBjb250ZXh0KTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPiAwKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9IChzdXBwb3J0ZWRRdWFsaWZpZXJzLmxlbmd0aCAtIGkpICogUFJJT1JJVFlfU1RFUDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIC0xO1xufVxuZnVuY3Rpb24gZmluZE1hdGNoKHBhdGgsIGV4dCwgY2FuZGlkYXRlcywgY29udGV4dCkge1xuICAgIHZhciBiZXN0VmFsdWUgPSAtMTtcbiAgICB2YXIgcmVzdWx0ID0gbnVsbDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhbmRpZGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGZpbGVQYXRoID0gY2FuZGlkYXRlc1tpXTtcbiAgICAgICAgdmFyIHF1YWxpZmllcnNTdHIgPSBmaWxlUGF0aC5zdWJzdHIocGF0aC5sZW5ndGgsIGZpbGVQYXRoLmxlbmd0aCAtIHBhdGgubGVuZ3RoIC0gKGV4dCA/IGV4dC5sZW5ndGggOiAwKSk7XG4gICAgICAgIHZhciBxdWFsaWZpZXJzID0gcXVhbGlmaWVyc1N0ci5zcGxpdChcIi5cIik7XG4gICAgICAgIHZhciB2YWx1ZSA9IGNoZWNrUXVhbGlmaWVycyhxdWFsaWZpZXJzLCBjb250ZXh0KTtcbiAgICAgICAgaWYgKHZhbHVlID49IDAgJiYgdmFsdWUgPiBiZXN0VmFsdWUpIHtcbiAgICAgICAgICAgIGJlc3RWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgcmVzdWx0ID0gY2FuZGlkYXRlc1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZXhwb3J0cy5maW5kTWF0Y2ggPSBmaW5kTWF0Y2g7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1xdWFsaWZpZXItbWF0Y2hlci5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYXBwTW9kdWxlID0gcmVxdWlyZShcIi4uL2FwcGxpY2F0aW9uXCIpO1xudmFyIE1JTl9UQUJMRVRfUElYRUxTID0gNjAwO1xudmFyIHBsYXRmb3JtTmFtZXM7XG4oZnVuY3Rpb24gKHBsYXRmb3JtTmFtZXMpIHtcbiAgICBwbGF0Zm9ybU5hbWVzLmFuZHJvaWQgPSBcIkFuZHJvaWRcIjtcbiAgICBwbGF0Zm9ybU5hbWVzLmlvcyA9IFwiaU9TXCI7XG59KShwbGF0Zm9ybU5hbWVzID0gZXhwb3J0cy5wbGF0Zm9ybU5hbWVzIHx8IChleHBvcnRzLnBsYXRmb3JtTmFtZXMgPSB7fSkpO1xudmFyIERldmljZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGV2aWNlKCkge1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJtYW51ZmFjdHVyZXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fbWFudWZhY3R1cmVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWFudWZhY3R1cmVyID0gYW5kcm9pZC5vcy5CdWlsZC5NQU5VRkFDVFVSRVI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWFudWZhY3R1cmVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHBsYXRmb3JtTmFtZXMuYW5kcm9pZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERldmljZS5wcm90b3R5cGUsIFwib3NWZXJzaW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX29zVmVyc2lvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuX29zVmVyc2lvbiA9IGFuZHJvaWQub3MuQnVpbGQuVkVSU0lPTi5SRUxFQVNFO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29zVmVyc2lvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERldmljZS5wcm90b3R5cGUsIFwibW9kZWxcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fbW9kZWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tb2RlbCA9IGFuZHJvaWQub3MuQnVpbGQuTU9ERUw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbW9kZWw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZXZpY2UucHJvdG90eXBlLCBcInNka1ZlcnNpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fc2RrVmVyc2lvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Nka1ZlcnNpb24gPSBhbmRyb2lkLm9zLkJ1aWxkLlZFUlNJT04uU0RLO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Nka1ZlcnNpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZXZpY2UucHJvdG90eXBlLCBcImRldmljZVR5cGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fZGV2aWNlVHlwZSkge1xuICAgICAgICAgICAgICAgIHZhciBkaXBzID0gTWF0aC5taW4oc2NyZWVuLm1haW5TY3JlZW4ud2lkdGhQaXhlbHMsIHNjcmVlbi5tYWluU2NyZWVuLmhlaWdodFBpeGVscykgLyBzY3JlZW4ubWFpblNjcmVlbi5zY2FsZTtcbiAgICAgICAgICAgICAgICBpZiAoZGlwcyA+PSBNSU5fVEFCTEVUX1BJWEVMUykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZXZpY2VUeXBlID0gXCJUYWJsZXRcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RldmljZVR5cGUgPSBcIlBob25lXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RldmljZVR5cGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZXZpY2UucHJvdG90eXBlLCBcInV1aWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fdXVpZCkge1xuICAgICAgICAgICAgICAgIHZhciBuYXRpdmVBcHAgPSBhcHBNb2R1bGUuYW5kcm9pZC5uYXRpdmVBcHA7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXVpZCA9IGFuZHJvaWQucHJvdmlkZXIuU2V0dGluZ3MuU2VjdXJlLmdldFN0cmluZyhuYXRpdmVBcHAuZ2V0Q29udGVudFJlc29sdmVyKCksIGFuZHJvaWQucHJvdmlkZXIuU2V0dGluZ3MuU2VjdXJlLkFORFJPSURfSUQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3V1aWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZXZpY2UucHJvdG90eXBlLCBcImxhbmd1YWdlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2xhbmd1YWdlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGFuZ3VhZ2UgPSBqYXZhLnV0aWwuTG9jYWxlLmdldERlZmF1bHQoKS5nZXRMYW5ndWFnZSgpLnJlcGxhY2UoXCJfXCIsIFwiLVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sYW5ndWFnZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERldmljZS5wcm90b3R5cGUsIFwicmVnaW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3JlZ2lvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlZ2lvbiA9IGphdmEudXRpbC5Mb2NhbGUuZ2V0RGVmYXVsdCgpLmdldENvdW50cnkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWdpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBEZXZpY2U7XG59KCkpO1xudmFyIE1haW5TY3JlZW4gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1haW5TY3JlZW4oKSB7XG4gICAgfVxuICAgIE1haW5TY3JlZW4ucHJvdG90eXBlLnJlaW5pdE1ldHJpY3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fbWV0cmljcykge1xuICAgICAgICAgICAgdGhpcy5fbWV0cmljcyA9IG5ldyBhbmRyb2lkLnV0aWwuRGlzcGxheU1ldHJpY3MoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluaXRNZXRyaWNzKCk7XG4gICAgfTtcbiAgICBNYWluU2NyZWVuLnByb3RvdHlwZS5pbml0TWV0cmljcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZUFwcCA9IGFwcE1vZHVsZS5nZXROYXRpdmVBcHBsaWNhdGlvbigpO1xuICAgICAgICBuYXRpdmVBcHAuZ2V0U3lzdGVtU2VydmljZShhbmRyb2lkLmNvbnRlbnQuQ29udGV4dC5XSU5ET1dfU0VSVklDRSkuZ2V0RGVmYXVsdERpc3BsYXkoKS5nZXRSZWFsTWV0cmljcyh0aGlzLl9tZXRyaWNzKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNYWluU2NyZWVuLnByb3RvdHlwZSwgXCJtZXRyaWNzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX21ldHJpY3MpIHtcbiAgICAgICAgICAgICAgICBhcHBNb2R1bGUub24oXCJjc3NDaGFuZ2VkXCIsIHRoaXMucmVpbml0TWV0cmljcywgdGhpcyk7XG4gICAgICAgICAgICAgICAgYXBwTW9kdWxlLm9uKGFwcE1vZHVsZS5vcmllbnRhdGlvbkNoYW5nZWRFdmVudCwgdGhpcy5yZWluaXRNZXRyaWNzLCB0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZXRyaWNzID0gbmV3IGFuZHJvaWQudXRpbC5EaXNwbGF5TWV0cmljcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdE1ldHJpY3MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZXRyaWNzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwid2lkdGhQaXhlbHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1ldHJpY3Mud2lkdGhQaXhlbHM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNYWluU2NyZWVuLnByb3RvdHlwZSwgXCJoZWlnaHRQaXhlbHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1ldHJpY3MuaGVpZ2h0UGl4ZWxzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwic2NhbGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1ldHJpY3MuZGVuc2l0eTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1haW5TY3JlZW4ucHJvdG90eXBlLCBcIndpZHRoRElQc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWV0cmljcy53aWR0aFBpeGVscyAvIHRoaXMubWV0cmljcy5kZW5zaXR5O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwiaGVpZ2h0RElQc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWV0cmljcy5oZWlnaHRQaXhlbHMgLyB0aGlzLm1ldHJpY3MuZGVuc2l0eTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIE1haW5TY3JlZW47XG59KCkpO1xuZXhwb3J0cy5kZXZpY2UgPSBuZXcgRGV2aWNlKCk7XG52YXIgc2NyZWVuO1xuKGZ1bmN0aW9uIChzY3JlZW4pIHtcbiAgICBzY3JlZW4ubWFpblNjcmVlbiA9IG5ldyBNYWluU2NyZWVuKCk7XG59KShzY3JlZW4gPSBleHBvcnRzLnNjcmVlbiB8fCAoZXhwb3J0cy5zY3JlZW4gPSB7fSkpO1xuZXhwb3J0cy5pc0FuZHJvaWQgPSB0cnVlO1xuZXhwb3J0cy5pc0lPUyA9IGZhbHNlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGxhdGZvcm0uYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiB1cHRpbWUoKSB7XG4gICAgcmV0dXJuIGdsb2JhbC5hbmRyb2lkID8gb3JnLm5hdGl2ZXNjcmlwdC5Qcm9jZXNzLmdldFVwVGltZSgpIDogZ2xvYmFsLl9fdG5zX3VwdGltZSgpO1xufVxuZXhwb3J0cy51cHRpbWUgPSB1cHRpbWU7XG5mdW5jdGlvbiBsb2cobWVzc2FnZSkge1xuICAgIGlmIChnbG9iYWwuX19uc2xvZykge1xuICAgICAgICBnbG9iYWwuX19uc2xvZyhcIkNPTlNPTEUgTE9HOiBcIiArIG1lc3NhZ2UpO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTtcbn1cbmV4cG9ydHMubG9nID0gbG9nO1xudmFyIHRpbWVycyA9IHt9O1xudmFyIGFueUdsb2JhbCA9IGdsb2JhbDtcbnZhciBwcm9maWxlTmFtZXMgPSBbXTtcbmV4cG9ydHMudGltZSA9IGdsb2JhbC5fX3RpbWUgfHwgRGF0ZS5ub3c7XG5mdW5jdGlvbiBzdGFydChuYW1lKSB7XG4gICAgdmFyIGluZm8gPSB0aW1lcnNbbmFtZV07XG4gICAgaWYgKGluZm8pIHtcbiAgICAgICAgaW5mby5jdXJyZW50U3RhcnQgPSBleHBvcnRzLnRpbWUoKTtcbiAgICAgICAgaW5mby5ydW5Db3VudCsrO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaW5mbyA9IHtcbiAgICAgICAgICAgIHRvdGFsVGltZTogMCxcbiAgICAgICAgICAgIGNvdW50OiAwLFxuICAgICAgICAgICAgY3VycmVudFN0YXJ0OiBleHBvcnRzLnRpbWUoKSxcbiAgICAgICAgICAgIHJ1bkNvdW50OiAxXG4gICAgICAgIH07XG4gICAgICAgIHRpbWVyc1tuYW1lXSA9IGluZm87XG4gICAgICAgIHByb2ZpbGVOYW1lcy5wdXNoKG5hbWUpO1xuICAgIH1cbn1cbmV4cG9ydHMuc3RhcnQgPSBzdGFydDtcbmZ1bmN0aW9uIHN0b3AobmFtZSkge1xuICAgIHZhciBpbmZvID0gdGltZXJzW25hbWVdO1xuICAgIGlmICghaW5mbykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyB0aW1lciBzdGFydGVkOiBcIiArIG5hbWUpO1xuICAgIH1cbiAgICBpZiAoaW5mby5ydW5Db3VudCkge1xuICAgICAgICBpbmZvLnJ1bkNvdW50LS07XG4gICAgICAgIGlmIChpbmZvLnJ1bkNvdW50KSB7XG4gICAgICAgICAgICBpbmZvLmNvdW50Kys7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpbmZvLmxhc3RUaW1lID0gZXhwb3J0cy50aW1lKCkgLSBpbmZvLmN1cnJlbnRTdGFydDtcbiAgICAgICAgICAgIGluZm8udG90YWxUaW1lICs9IGluZm8ubGFzdFRpbWU7XG4gICAgICAgICAgICBpbmZvLmNvdW50Kys7XG4gICAgICAgICAgICBpbmZvLmN1cnJlbnRTdGFydCA9IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRpbWVyIFwiICsgbmFtZSArIFwiIHBhdXNlZCBtb3JlIHRpbWVzIHRoYW4gc3RhcnRlZC5cIik7XG4gICAgfVxuICAgIHJldHVybiBpbmZvO1xufVxuZXhwb3J0cy5zdG9wID0gc3RvcDtcbmZ1bmN0aW9uIHRpbWVyKG5hbWUpIHtcbiAgICByZXR1cm4gdGltZXJzW25hbWVdO1xufVxuZXhwb3J0cy50aW1lciA9IHRpbWVyO1xuZnVuY3Rpb24gcHJpbnQobmFtZSkge1xuICAgIHZhciBpbmZvID0gdGltZXJzW25hbWVdO1xuICAgIGlmICghaW5mbykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyB0aW1lciBzdGFydGVkOiBcIiArIG5hbWUpO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhcIi0tLS0gW1wiICsgbmFtZSArIFwiXSBTVE9QIHRvdGFsOiBcIiArIGluZm8udG90YWxUaW1lICsgXCIgY291bnQ6XCIgKyBpbmZvLmNvdW50KTtcbiAgICByZXR1cm4gaW5mbztcbn1cbmV4cG9ydHMucHJpbnQgPSBwcmludDtcbmZ1bmN0aW9uIGlzUnVubmluZyhuYW1lKSB7XG4gICAgdmFyIGluZm8gPSB0aW1lcnNbbmFtZV07XG4gICAgcmV0dXJuICEhKGluZm8gJiYgaW5mby5ydW5Db3VudCk7XG59XG5leHBvcnRzLmlzUnVubmluZyA9IGlzUnVubmluZztcbmZ1bmN0aW9uIGNvdW50ZXJzUHJvZmlsZUZ1bmN0aW9uRmFjdG9yeShmbiwgbmFtZSwgdHlwZSkge1xuICAgIGlmICh0eXBlID09PSB2b2lkIDApIHsgdHlwZSA9IDE7IH1cbiAgICBwcm9maWxlTmFtZXMucHVzaChuYW1lKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICBzdGFydChuYW1lKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgc3RvcChuYW1lKTtcbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiB0aW1lbGluZVByb2ZpbGVGdW5jdGlvbkZhY3RvcnkoZm4sIG5hbWUsIHR5cGUpIHtcbiAgICBpZiAodHlwZSA9PT0gdm9pZCAwKSB7IHR5cGUgPSAxOyB9XG4gICAgcmV0dXJuIHR5cGUgPT09IDEgPyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdGFydCA9IGV4cG9ydHMudGltZSgpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB2YXIgZW5kID0gZXhwb3J0cy50aW1lKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRpbWVsaW5lOiBNb2R1bGVzOiBcIiArIG5hbWUgKyBcIiBcIiArIHRoaXMgKyBcIiAgKFwiICsgc3RhcnQgKyBcIm1zLiAtIFwiICsgZW5kICsgXCJtcy4pXCIpO1xuICAgICAgICB9XG4gICAgfSA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gZXhwb3J0cy50aW1lKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHZhciBlbmQgPSBleHBvcnRzLnRpbWUoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGltZWxpbmU6IE1vZHVsZXM6IFwiICsgbmFtZSArIFwiICAoXCIgKyBzdGFydCArIFwibXMuIC0gXCIgKyBlbmQgKyBcIm1zLilcIik7XG4gICAgICAgIH1cbiAgICB9O1xufVxudmFyIExldmVsO1xuKGZ1bmN0aW9uIChMZXZlbCkge1xuICAgIExldmVsW0xldmVsW1wibm9uZVwiXSA9IDBdID0gXCJub25lXCI7XG4gICAgTGV2ZWxbTGV2ZWxbXCJsaWZlY3ljbGVcIl0gPSAxXSA9IFwibGlmZWN5Y2xlXCI7XG4gICAgTGV2ZWxbTGV2ZWxbXCJ0aW1lbGluZVwiXSA9IDJdID0gXCJ0aW1lbGluZVwiO1xufSkoTGV2ZWwgPSBleHBvcnRzLkxldmVsIHx8IChleHBvcnRzLkxldmVsID0ge30pKTtcbnZhciB0cmFjaW5nTGV2ZWwgPSBMZXZlbC5ub25lO1xudmFyIHByb2ZpbGVGdW5jdGlvbkZhY3Rvcnk7XG5mdW5jdGlvbiBlbmFibGUobW9kZSkge1xuICAgIGlmIChtb2RlID09PSB2b2lkIDApIHsgbW9kZSA9IFwiY291bnRlcnNcIjsgfVxuICAgIHByb2ZpbGVGdW5jdGlvbkZhY3RvcnkgPSBtb2RlICYmIHtcbiAgICAgICAgY291bnRlcnM6IGNvdW50ZXJzUHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSxcbiAgICAgICAgdGltZWxpbmU6IHRpbWVsaW5lUHJvZmlsZUZ1bmN0aW9uRmFjdG9yeVxuICAgIH1bbW9kZV07XG4gICAgdHJhY2luZ0xldmVsID0ge1xuICAgICAgICBsaWZlY3ljbGU6IExldmVsLmxpZmVjeWNsZSxcbiAgICAgICAgdGltZWxpbmU6IExldmVsLnRpbWVsaW5lLFxuICAgIH1bbW9kZV0gfHwgTGV2ZWwubm9uZTtcbn1cbmV4cG9ydHMuZW5hYmxlID0gZW5hYmxlO1xudHJ5IHtcbiAgICB2YXIgYXBwQ29uZmlnID0gcmVxdWlyZShcIn4vcGFja2FnZS5qc29uXCIpO1xuICAgIGlmIChhcHBDb25maWcgJiYgYXBwQ29uZmlnLnByb2ZpbGluZykge1xuICAgICAgICBlbmFibGUoYXBwQ29uZmlnLnByb2ZpbGluZyk7XG4gICAgfVxufVxuY2F0Y2ggKGUxKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJQcm9maWxpbmcgc3RhcnR1cCBmYWlsZWQgdG8gZmlndXJlIG91dCBkZWZhdWx0cyBmcm9tIHBhY2thZ2UuanNvbiwgZXJyb3I6IFwiICsgZTEpO1xuICAgIH1cbiAgICBjYXRjaCAoZTIpIHtcbiAgICB9XG59XG5mdW5jdGlvbiBkaXNhYmxlKCkge1xuICAgIHByb2ZpbGVGdW5jdGlvbkZhY3RvcnkgPSB1bmRlZmluZWQ7XG59XG5leHBvcnRzLmRpc2FibGUgPSBkaXNhYmxlO1xuZnVuY3Rpb24gcHJvZmlsZUZ1bmN0aW9uKGZuLCBjdXN0b21OYW1lKSB7XG4gICAgcmV0dXJuIHByb2ZpbGVGdW5jdGlvbkZhY3RvcnkoZm4sIGN1c3RvbU5hbWUgfHwgZm4ubmFtZSk7XG59XG52YXIgcHJvZmlsZU1ldGhvZFVubmFtZWQgPSBmdW5jdGlvbiAodGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IpIHtcbiAgICBpZiAoZGVzY3JpcHRvciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGRlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KTtcbiAgICB9XG4gICAgdmFyIG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICB2YXIgY2xhc3NOYW1lID0gXCJcIjtcbiAgICBpZiAodGFyZ2V0ICYmIHRhcmdldC5jb25zdHJ1Y3RvciAmJiB0YXJnZXQuY29uc3RydWN0b3IubmFtZSkge1xuICAgICAgICBjbGFzc05hbWUgPSB0YXJnZXQuY29uc3RydWN0b3IubmFtZSArIFwiLlwiO1xuICAgIH1cbiAgICB2YXIgbmFtZSA9IGNsYXNzTmFtZSArIGtleTtcbiAgICBkZXNjcmlwdG9yLnZhbHVlID0gcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeShvcmlnaW5hbE1ldGhvZCwgbmFtZSwgMSk7XG4gICAgcmV0dXJuIGRlc2NyaXB0b3I7XG59O1xudmFyIHByb2ZpbGVTdGF0aWNNZXRob2RVbm5hbWVkID0gZnVuY3Rpb24gKGN0b3IsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIGlmIChkZXNjcmlwdG9yID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoY3Rvciwga2V5KTtcbiAgICB9XG4gICAgdmFyIG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICB2YXIgY2xhc3NOYW1lID0gXCJcIjtcbiAgICBpZiAoY3RvciAmJiBjdG9yLm5hbWUpIHtcbiAgICAgICAgY2xhc3NOYW1lID0gY3Rvci5uYW1lICsgXCIuXCI7XG4gICAgfVxuICAgIHZhciBuYW1lID0gY2xhc3NOYW1lICsga2V5O1xuICAgIGRlc2NyaXB0b3IudmFsdWUgPSBwcm9maWxlRnVuY3Rpb25GYWN0b3J5KG9yaWdpbmFsTWV0aG9kLCBuYW1lLCAwKTtcbiAgICByZXR1cm4gZGVzY3JpcHRvcjtcbn07XG5mdW5jdGlvbiBwcm9maWxlTWV0aG9kTmFtZWQobmFtZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IpIHtcbiAgICAgICAgaWYgKGRlc2NyaXB0b3IgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XG4gICAgICAgIGRlc2NyaXB0b3IudmFsdWUgPSBwcm9maWxlRnVuY3Rpb25GYWN0b3J5KG9yaWdpbmFsTWV0aG9kLCBuYW1lKTtcbiAgICAgICAgcmV0dXJuIGRlc2NyaXB0b3I7XG4gICAgfTtcbn1cbnZhciB2b2lkTWV0aG9kRGVjb3JhdG9yID0gZnVuY3Rpb24gKCkge1xufTtcbmZ1bmN0aW9uIHByb2ZpbGUobmFtZUZuT3JUYXJnZXQsIGZuT3JLZXksIGRlc2NyaXB0b3IpIHtcbiAgICBpZiAodHlwZW9mIG5hbWVGbk9yVGFyZ2V0ID09PSBcIm9iamVjdFwiICYmICh0eXBlb2YgZm5PcktleSA9PT0gXCJzdHJpbmdcIiB8fCB0eXBlb2YgZm5PcktleSA9PT0gXCJzeW1ib2xcIikpIHtcbiAgICAgICAgaWYgKCFwcm9maWxlRnVuY3Rpb25GYWN0b3J5KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb2ZpbGVNZXRob2RVbm5hbWVkKG5hbWVGbk9yVGFyZ2V0LCBmbk9yS2V5LCBkZXNjcmlwdG9yKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIG5hbWVGbk9yVGFyZ2V0ID09PSBcImZ1bmN0aW9uXCIgJiYgKHR5cGVvZiBmbk9yS2V5ID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBmbk9yS2V5ID09PSBcInN5bWJvbFwiKSkge1xuICAgICAgICBpZiAoIXByb2ZpbGVGdW5jdGlvbkZhY3RvcnkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvZmlsZVN0YXRpY01ldGhvZFVubmFtZWQobmFtZUZuT3JUYXJnZXQsIGZuT3JLZXksIGRlc2NyaXB0b3IpO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgbmFtZUZuT3JUYXJnZXQgPT09IFwic3RyaW5nXCIgJiYgdHlwZW9mIGZuT3JLZXkgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBpZiAoIXByb2ZpbGVGdW5jdGlvbkZhY3RvcnkpIHtcbiAgICAgICAgICAgIHJldHVybiBmbk9yS2V5O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9maWxlRnVuY3Rpb24oZm5PcktleSwgbmFtZUZuT3JUYXJnZXQpO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgbmFtZUZuT3JUYXJnZXQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBpZiAoIXByb2ZpbGVGdW5jdGlvbkZhY3RvcnkpIHtcbiAgICAgICAgICAgIHJldHVybiBuYW1lRm5PclRhcmdldDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvZmlsZUZ1bmN0aW9uKG5hbWVGbk9yVGFyZ2V0KTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIG5hbWVGbk9yVGFyZ2V0ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGlmICghcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSkge1xuICAgICAgICAgICAgcmV0dXJuIHZvaWRNZXRob2REZWNvcmF0b3I7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb2ZpbGVNZXRob2ROYW1lZChuYW1lRm5PclRhcmdldCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoIXByb2ZpbGVGdW5jdGlvbkZhY3RvcnkpIHtcbiAgICAgICAgICAgIHJldHVybiB2b2lkTWV0aG9kRGVjb3JhdG9yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9maWxlTWV0aG9kVW5uYW1lZDtcbiAgICB9XG59XG5leHBvcnRzLnByb2ZpbGUgPSBwcm9maWxlO1xuZnVuY3Rpb24gZHVtcFByb2ZpbGVzKCkge1xuICAgIHByb2ZpbGVOYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBpbmZvID0gdGltZXJzW25hbWVdO1xuICAgICAgICBpZiAoaW5mbykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCItLS0tIFtcIiArIG5hbWUgKyBcIl0gU1RPUCB0b3RhbDogXCIgKyBpbmZvLnRvdGFsVGltZSArIFwiIGNvdW50OlwiICsgaW5mby5jb3VudCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIi0tLS0gW1wiICsgbmFtZSArIFwiXSBOZXZlciBjYWxsZWRcIik7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmV4cG9ydHMuZHVtcFByb2ZpbGVzID0gZHVtcFByb2ZpbGVzO1xuZnVuY3Rpb24gcmVzZXRQcm9maWxlcygpIHtcbiAgICBwcm9maWxlTmFtZXMuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgaW5mbyA9IHRpbWVyc1tuYW1lXTtcbiAgICAgICAgaWYgKGluZm8pIHtcbiAgICAgICAgICAgIGlmIChpbmZvLnJ1bkNvdW50KSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCItLS0tIHRpbWVyIHdpdGggbmFtZSBbXCIgKyBuYW1lICsgXCJdIGlzIGN1cnJlbnRseSBydW5uaW5nIGFuZCB3b24ndCBiZSByZXNldFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRpbWVyc1tuYW1lXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0cy5yZXNldFByb2ZpbGVzID0gcmVzZXRQcm9maWxlcztcbmZ1bmN0aW9uIHN0YXJ0Q1BVUHJvZmlsZShuYW1lKSB7XG4gICAgaWYgKGFueUdsb2JhbC5hbmRyb2lkKSB7XG4gICAgICAgIF9fc3RhcnRDUFVQcm9maWxlcihuYW1lKTtcbiAgICB9XG59XG5leHBvcnRzLnN0YXJ0Q1BVUHJvZmlsZSA9IHN0YXJ0Q1BVUHJvZmlsZTtcbmZ1bmN0aW9uIHN0b3BDUFVQcm9maWxlKG5hbWUpIHtcbiAgICBpZiAoYW55R2xvYmFsLmFuZHJvaWQpIHtcbiAgICAgICAgX19zdG9wQ1BVUHJvZmlsZXIobmFtZSk7XG4gICAgfVxufVxuZXhwb3J0cy5zdG9wQ1BVUHJvZmlsZSA9IHN0b3BDUFVQcm9maWxlO1xuZnVuY3Rpb24gbGV2ZWwoKSB7XG4gICAgcmV0dXJuIHRyYWNpbmdMZXZlbDtcbn1cbmV4cG9ydHMubGV2ZWwgPSBsZXZlbDtcbmZ1bmN0aW9uIHRyYWNlKG1lc3NhZ2UsIHN0YXJ0LCBlbmQpIHtcbiAgICBsb2coXCJUaW1lbGluZTogTW9kdWxlczogXCIgKyBtZXNzYWdlICsgXCIgIChcIiArIHN0YXJ0ICsgXCJtcy4gLSBcIiArIGVuZCArIFwibXMuKVwiKTtcbn1cbmV4cG9ydHMudHJhY2UgPSB0cmFjZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByb2ZpbGluZy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgc3Bhbl8xID0gcmVxdWlyZShcIi4vc3BhblwiKTtcbmV4cG9ydHMuU3BhbiA9IHNwYW5fMS5TcGFuO1xudmFyIG9ic2VydmFibGVfMSA9IHJlcXVpcmUoXCIuLi9kYXRhL29ic2VydmFibGVcIik7XG52YXIgb2JzZXJ2YWJsZV9hcnJheV8xID0gcmVxdWlyZShcIi4uL2RhdGEvb2JzZXJ2YWJsZS1hcnJheVwiKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vdWkvY29yZS92aWV3XCIpO1xudmFyIGtub3duQ29sbGVjdGlvbnM7XG4oZnVuY3Rpb24gKGtub3duQ29sbGVjdGlvbnMpIHtcbiAgICBrbm93bkNvbGxlY3Rpb25zLnNwYW5zID0gXCJzcGFuc1wiO1xufSkoa25vd25Db2xsZWN0aW9ucyA9IGV4cG9ydHMua25vd25Db2xsZWN0aW9ucyB8fCAoZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zID0ge30pKTtcbnZhciBGb3JtYXR0ZWRTdHJpbmcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGb3JtYXR0ZWRTdHJpbmcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRm9ybWF0dGVkU3RyaW5nKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fc3BhbnMgPSBuZXcgb2JzZXJ2YWJsZV9hcnJheV8xLk9ic2VydmFibGVBcnJheSgpO1xuICAgICAgICBfdGhpcy5fc3BhbnMuYWRkRXZlbnRMaXN0ZW5lcihvYnNlcnZhYmxlX2FycmF5XzEuT2JzZXJ2YWJsZUFycmF5LmNoYW5nZUV2ZW50LCBfdGhpcy5vblNwYW5zQ29sbGVjdGlvbkNoYW5nZWQsIF90aGlzKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZSwgXCJmb250RmFtaWx5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250RmFtaWx5O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250RmFtaWx5ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLCBcImZvbnRTaXplXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250U2l6ZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFNpemUgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUsIFwiZm9udFN0eWxlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250U3R5bGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRTdHlsZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZSwgXCJmb250V2VpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250V2VpZ2h0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250V2VpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLCBcInRleHREZWNvcmF0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50ZXh0RGVjb3JhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudGV4dERlY29yYXRpb24gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUsIFwiY29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmNvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5jb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kQ29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLCBcInNwYW5zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3NwYW5zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3BhbnMgPSBuZXcgb2JzZXJ2YWJsZV9hcnJheV8xLk9ic2VydmFibGVBcnJheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NwYW5zO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gXCJcIjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdGhpcy5fc3BhbnMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICAgICAgcmVzdWx0ICs9IHRoaXMuX3NwYW5zLmdldEl0ZW0oaSkudGV4dDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZS5fYWRkQXJyYXlGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0ga25vd25Db2xsZWN0aW9ucy5zcGFucykge1xuICAgICAgICAgICAgdGhpcy5zcGFucy5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBzcGFuXzEuU3Bhbikge1xuICAgICAgICAgICAgdGhpcy5zcGFucy5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZS5vblNwYW5zQ29sbGVjdGlvbkNoYW5nZWQgPSBmdW5jdGlvbiAoZXZlbnREYXRhKSB7XG4gICAgICAgIGlmIChldmVudERhdGEuYWRkZWRDb3VudCA+IDApIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXZlbnREYXRhLmFkZGVkQ291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBzcGFuID0gZXZlbnREYXRhLm9iamVjdC5nZXRJdGVtKGV2ZW50RGF0YS5pbmRleCArIGkpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcoc3Bhbik7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRQcm9wZXJ0eUNoYW5nZUhhbmRsZXIoc3Bhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50RGF0YS5yZW1vdmVkICYmIGV2ZW50RGF0YS5yZW1vdmVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAodmFyIHAgPSAwOyBwIDwgZXZlbnREYXRhLnJlbW92ZWQubGVuZ3RoOyBwKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgc3BhbiA9IGV2ZW50RGF0YS5yZW1vdmVkW3BdO1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlUHJvcGVydHlDaGFuZ2VIYW5kbGVyKHNwYW4pO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVZpZXcoc3Bhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ub3RpZnlQcm9wZXJ0eUNoYW5nZShcIi5cIiwgdGhpcyk7XG4gICAgfTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLmFkZFByb3BlcnR5Q2hhbmdlSGFuZGxlciA9IGZ1bmN0aW9uIChzcGFuKSB7XG4gICAgICAgIHZhciBzdHlsZSA9IHNwYW4uc3R5bGU7XG4gICAgICAgIHNwYW4ub24ob2JzZXJ2YWJsZV8xLk9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub24oXCJmb250RmFtaWx5Q2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9uKFwiZm9udFNpemVDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub24oXCJmb250U3R5bGVDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub24oXCJmb250V2VpZ2h0Q2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9uKFwidGV4dERlY29yYXRpb25DaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub24oXCJjb2xvckNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vbihcImJhY2tncm91bmRDb2xvckNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgIH07XG4gICAgRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZS5yZW1vdmVQcm9wZXJ0eUNoYW5nZUhhbmRsZXIgPSBmdW5jdGlvbiAoc3Bhbikge1xuICAgICAgICB2YXIgc3R5bGUgPSBzcGFuLnN0eWxlO1xuICAgICAgICBzcGFuLm9mZihvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm9wZXJ0eUNoYW5nZUV2ZW50LCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vZmYoXCJmb250RmFtaWx5Q2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9mZihcImZvbnRTaXplQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9mZihcImZvbnRTdHlsZUNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vZmYoXCJmb250V2VpZ2h0Q2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9mZihcInRleHREZWNvcmF0aW9uQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9mZihcImNvbG9yQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9mZihcImJhY2tncm91bmRDb2xvckNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgIH07XG4gICAgRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZS5vblByb3BlcnR5Q2hhbmdlID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdGhpcy5ub3RpZnlQcm9wZXJ0eUNoYW5nZShkYXRhLnByb3BlcnR5TmFtZSwgdGhpcyk7XG4gICAgfTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLmVhY2hDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLnNwYW5zLmZvckVhY2goZnVuY3Rpb24gKHYsIGksIGFycikgeyByZXR1cm4gY2FsbGJhY2sodik7IH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEZvcm1hdHRlZFN0cmluZztcbn0odmlld18xLlZpZXdCYXNlKSk7XG5leHBvcnRzLkZvcm1hdHRlZFN0cmluZyA9IEZvcm1hdHRlZFN0cmluZztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZvcm1hdHRlZC1zdHJpbmcuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi91aS9jb3JlL3ZpZXdcIik7XG52YXIgU3BhbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNwYW4sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3BhbigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3Bhbi5wcm90b3R5cGUsIFwiZm9udEZhbWlseVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udEZhbWlseTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udEZhbWlseSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3Bhbi5wcm90b3R5cGUsIFwiZm9udFNpemVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRTaXplO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250U2l6ZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3Bhbi5wcm90b3R5cGUsIFwiZm9udFN0eWxlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250U3R5bGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRTdHlsZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3Bhbi5wcm90b3R5cGUsIFwiZm9udFdlaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udFdlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFdlaWdodCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3Bhbi5wcm90b3R5cGUsIFwidGV4dERlY29yYXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRleHREZWNvcmF0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50ZXh0RGVjb3JhdGlvbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3Bhbi5wcm90b3R5cGUsIFwiY29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmNvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5jb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3Bhbi5wcm90b3R5cGUsIFwiYmFja2dyb3VuZENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3Bhbi5wcm90b3R5cGUsIFwidGV4dFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RleHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fdGV4dCAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90ZXh0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlQcm9wZXJ0eUNoYW5nZShcInRleHRcIiwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTcGFuLnByb3RvdHlwZS5fc2V0VGV4dEludGVybmFsID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3RleHQgPSB2YWx1ZTtcbiAgICB9O1xuICAgIHJldHVybiBTcGFuO1xufSh2aWV3XzEuVmlld0Jhc2UpKTtcbmV4cG9ydHMuU3BhbiA9IFNwYW47XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zcGFuLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlbmNvZGluZztcbihmdW5jdGlvbiAoZW5jb2RpbmcpIHtcbiAgICBlbmNvZGluZy5JU09fODg1OV8xID0gXCJJU08tODg1OS0xXCI7XG4gICAgZW5jb2RpbmcuVVNfQVNDSUkgPSBcIlVTLUFTQ0lJXCI7XG4gICAgZW5jb2RpbmcuVVRGXzE2ID0gXCJVVEYtMTZcIjtcbiAgICBlbmNvZGluZy5VVEZfMTZCRSA9IFwiVVRGLTE2QkVcIjtcbiAgICBlbmNvZGluZy5VVEZfMTZMRSA9IFwiVVRGLTE2TEVcIjtcbiAgICBlbmNvZGluZy5VVEZfOCA9IFwiVVRGLThcIjtcbn0pKGVuY29kaW5nID0gZXhwb3J0cy5lbmNvZGluZyB8fCAoZXhwb3J0cy5lbmNvZGluZyA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10ZXh0LmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRpbWVvdXRIYW5kbGVyO1xudmFyIHRpbWVvdXRDYWxsYmFja3MgPSB7fTtcbnZhciB0aW1lcklkID0gMDtcbmZ1bmN0aW9uIGNyZWF0ZUhhbmRsZXJBbmRHZXRJZCgpIHtcbiAgICBpZiAoIXRpbWVvdXRIYW5kbGVyKSB7XG4gICAgICAgIHRpbWVvdXRIYW5kbGVyID0gbmV3IGFuZHJvaWQub3MuSGFuZGxlcihhbmRyb2lkLm9zLkxvb3Blci5teUxvb3BlcigpKTtcbiAgICB9XG4gICAgdGltZXJJZCsrO1xuICAgIHJldHVybiB0aW1lcklkO1xufVxuZnVuY3Rpb24gc2V0VGltZW91dChjYWxsYmFjaywgbWlsbGlzZWNvbmRzKSB7XG4gICAgaWYgKG1pbGxpc2Vjb25kcyA9PT0gdm9pZCAwKSB7IG1pbGxpc2Vjb25kcyA9IDA7IH1cbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIGFyZ3NbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIG1pbGxpc2Vjb25kcyArPSAwO1xuICAgIHZhciBpZCA9IGNyZWF0ZUhhbmRsZXJBbmRHZXRJZCgpO1xuICAgIHZhciBpbnZva2UgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBjYWxsYmFjay5hcHBseSh2b2lkIDAsIGFyZ3MpOyB9O1xuICAgIHZhciB6b25lQm91bmQgPSB6b25lZENhbGxiYWNrKGludm9rZSk7XG4gICAgdmFyIHJ1bm5hYmxlID0gbmV3IGphdmEubGFuZy5SdW5uYWJsZSh7XG4gICAgICAgIHJ1bjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgem9uZUJvdW5kKCk7XG4gICAgICAgICAgICBpZiAodGltZW91dENhbGxiYWNrc1tpZF0pIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGltZW91dENhbGxiYWNrc1tpZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoIXRpbWVvdXRDYWxsYmFja3NbaWRdKSB7XG4gICAgICAgIHRpbWVvdXRDYWxsYmFja3NbaWRdID0gcnVubmFibGU7XG4gICAgfVxuICAgIHRpbWVvdXRIYW5kbGVyLnBvc3REZWxheWVkKHJ1bm5hYmxlLCBsb25nKG1pbGxpc2Vjb25kcykpO1xuICAgIHJldHVybiBpZDtcbn1cbmV4cG9ydHMuc2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG5mdW5jdGlvbiBjbGVhclRpbWVvdXQoaWQpIHtcbiAgICB2YXIgaW5kZXggPSBpZDtcbiAgICBpZiAodGltZW91dENhbGxiYWNrc1tpbmRleF0pIHtcbiAgICAgICAgdGltZW91dEhhbmRsZXIucmVtb3ZlQ2FsbGJhY2tzKHRpbWVvdXRDYWxsYmFja3NbaW5kZXhdKTtcbiAgICAgICAgZGVsZXRlIHRpbWVvdXRDYWxsYmFja3NbaW5kZXhdO1xuICAgIH1cbn1cbmV4cG9ydHMuY2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuZnVuY3Rpb24gc2V0SW50ZXJ2YWwoY2FsbGJhY2ssIG1pbGxpc2Vjb25kcykge1xuICAgIGlmIChtaWxsaXNlY29uZHMgPT09IHZvaWQgMCkgeyBtaWxsaXNlY29uZHMgPSAwOyB9XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICBtaWxsaXNlY29uZHMgKz0gMDtcbiAgICB2YXIgaWQgPSBjcmVhdGVIYW5kbGVyQW5kR2V0SWQoKTtcbiAgICB2YXIgaGFuZGxlciA9IHRpbWVvdXRIYW5kbGVyO1xuICAgIHZhciBpbnZva2UgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBjYWxsYmFjay5hcHBseSh2b2lkIDAsIGFyZ3MpOyB9O1xuICAgIHZhciB6b25lQm91bmQgPSB6b25lZENhbGxiYWNrKGludm9rZSk7XG4gICAgdmFyIHJ1bm5hYmxlID0gbmV3IGphdmEubGFuZy5SdW5uYWJsZSh7XG4gICAgICAgIHJ1bjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgem9uZUJvdW5kKCk7XG4gICAgICAgICAgICBpZiAodGltZW91dENhbGxiYWNrc1tpZF0pIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLnBvc3REZWxheWVkKHJ1bm5hYmxlLCBsb25nKG1pbGxpc2Vjb25kcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKCF0aW1lb3V0Q2FsbGJhY2tzW2lkXSkge1xuICAgICAgICB0aW1lb3V0Q2FsbGJhY2tzW2lkXSA9IHJ1bm5hYmxlO1xuICAgIH1cbiAgICB0aW1lb3V0SGFuZGxlci5wb3N0RGVsYXllZChydW5uYWJsZSwgbG9uZyhtaWxsaXNlY29uZHMpKTtcbiAgICByZXR1cm4gaWQ7XG59XG5leHBvcnRzLnNldEludGVydmFsID0gc2V0SW50ZXJ2YWw7XG5leHBvcnRzLmNsZWFySW50ZXJ2YWwgPSBjbGVhclRpbWVvdXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10aW1lci5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlbmFibGVkID0gZmFsc2U7XG52YXIgX2NhdGVnb3JpZXMgPSB7fTtcbnZhciBfd3JpdGVycyA9IFtdO1xudmFyIF9ldmVudExpc3RlbmVycyA9IFtdO1xudmFyIF9lcnJvckhhbmRsZXI7XG5mdW5jdGlvbiBlbmFibGUoKSB7XG4gICAgZW5hYmxlZCA9IHRydWU7XG59XG5leHBvcnRzLmVuYWJsZSA9IGVuYWJsZTtcbmZ1bmN0aW9uIGRpc2FibGUoKSB7XG4gICAgZW5hYmxlZCA9IGZhbHNlO1xufVxuZXhwb3J0cy5kaXNhYmxlID0gZGlzYWJsZTtcbmZ1bmN0aW9uIGlzRW5hYmxlZCgpIHtcbiAgICByZXR1cm4gZW5hYmxlZDtcbn1cbmV4cG9ydHMuaXNFbmFibGVkID0gaXNFbmFibGVkO1xuZnVuY3Rpb24gaXNDYXRlZ29yeVNldChjYXRlZ29yeSkge1xuICAgIHJldHVybiBjYXRlZ29yeSBpbiBfY2F0ZWdvcmllcztcbn1cbmV4cG9ydHMuaXNDYXRlZ29yeVNldCA9IGlzQ2F0ZWdvcnlTZXQ7XG5mdW5jdGlvbiBhZGRXcml0ZXIod3JpdGVyKSB7XG4gICAgX3dyaXRlcnMucHVzaCh3cml0ZXIpO1xufVxuZXhwb3J0cy5hZGRXcml0ZXIgPSBhZGRXcml0ZXI7XG5mdW5jdGlvbiByZW1vdmVXcml0ZXIod3JpdGVyKSB7XG4gICAgdmFyIGluZGV4ID0gX3dyaXRlcnMuaW5kZXhPZih3cml0ZXIpO1xuICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgIF93cml0ZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxufVxuZXhwb3J0cy5yZW1vdmVXcml0ZXIgPSByZW1vdmVXcml0ZXI7XG5mdW5jdGlvbiBjbGVhcldyaXRlcnMoKSB7XG4gICAgaWYgKF93cml0ZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgX3dyaXRlcnMuc3BsaWNlKDAsIF93cml0ZXJzLmxlbmd0aCk7XG4gICAgfVxufVxuZXhwb3J0cy5jbGVhcldyaXRlcnMgPSBjbGVhcldyaXRlcnM7XG5mdW5jdGlvbiBzZXRDYXRlZ29yaWVzKGNhdGVnb3JpZXMpIHtcbiAgICBfY2F0ZWdvcmllcyA9IHt9O1xuICAgIGFkZENhdGVnb3JpZXMoY2F0ZWdvcmllcyk7XG59XG5leHBvcnRzLnNldENhdGVnb3JpZXMgPSBzZXRDYXRlZ29yaWVzO1xuZnVuY3Rpb24gYWRkQ2F0ZWdvcmllcyhjYXRlZ29yaWVzKSB7XG4gICAgdmFyIHNwbGl0ID0gY2F0ZWdvcmllcy5zcGxpdChcIixcIik7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzcGxpdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBfY2F0ZWdvcmllc1tzcGxpdFtpXS50cmltKCldID0gdHJ1ZTtcbiAgICB9XG59XG5leHBvcnRzLmFkZENhdGVnb3JpZXMgPSBhZGRDYXRlZ29yaWVzO1xuZnVuY3Rpb24gd3JpdGUobWVzc2FnZSwgY2F0ZWdvcnksIHR5cGUpIHtcbiAgICB2YXIgaTtcbiAgICBpZiAodHlwZSA9PT0gbWVzc2FnZVR5cGUuZXJyb3IpIHtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IF93cml0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBfd3JpdGVyc1tpXS53cml0ZShtZXNzYWdlLCBjYXRlZ29yeSwgdHlwZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIWVuYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIShjYXRlZ29yeSBpbiBfY2F0ZWdvcmllcykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKGkgPSAwOyBpIDwgX3dyaXRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgX3dyaXRlcnNbaV0ud3JpdGUobWVzc2FnZSwgY2F0ZWdvcnksIHR5cGUpO1xuICAgIH1cbn1cbmV4cG9ydHMud3JpdGUgPSB3cml0ZTtcbmZ1bmN0aW9uIG5vdGlmeUV2ZW50KG9iamVjdCwgbmFtZSwgZGF0YSkge1xuICAgIGlmICghZW5hYmxlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBpLCBsaXN0ZW5lciwgZmlsdGVycztcbiAgICBmb3IgKGkgPSAwOyBpIDwgX2V2ZW50TGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxpc3RlbmVyID0gX2V2ZW50TGlzdGVuZXJzW2ldO1xuICAgICAgICBpZiAobGlzdGVuZXIuZmlsdGVyKSB7XG4gICAgICAgICAgICBmaWx0ZXJzID0gbGlzdGVuZXIuZmlsdGVyLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgICAgIGZpbHRlcnMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUudHJpbSgpID09PSBuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RlbmVyLm9uKG9iamVjdCwgbmFtZSwgZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsaXN0ZW5lci5vbihvYmplY3QsIG5hbWUsIGRhdGEpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5ub3RpZnlFdmVudCA9IG5vdGlmeUV2ZW50O1xuZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgIF9ldmVudExpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcbn1cbmV4cG9ydHMuYWRkRXZlbnRMaXN0ZW5lciA9IGFkZEV2ZW50TGlzdGVuZXI7XG5mdW5jdGlvbiByZW1vdmVFdmVudExpc3RlbmVyKGxpc3RlbmVyKSB7XG4gICAgdmFyIGluZGV4ID0gX2V2ZW50TGlzdGVuZXJzLmluZGV4T2YobGlzdGVuZXIpO1xuICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgIF9ldmVudExpc3RlbmVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cbn1cbmV4cG9ydHMucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IHJlbW92ZUV2ZW50TGlzdGVuZXI7XG52YXIgbWVzc2FnZVR5cGU7XG4oZnVuY3Rpb24gKG1lc3NhZ2VUeXBlKSB7XG4gICAgbWVzc2FnZVR5cGUubG9nID0gMDtcbiAgICBtZXNzYWdlVHlwZS5pbmZvID0gMTtcbiAgICBtZXNzYWdlVHlwZS53YXJuID0gMjtcbiAgICBtZXNzYWdlVHlwZS5lcnJvciA9IDM7XG59KShtZXNzYWdlVHlwZSA9IGV4cG9ydHMubWVzc2FnZVR5cGUgfHwgKGV4cG9ydHMubWVzc2FnZVR5cGUgPSB7fSkpO1xudmFyIGNhdGVnb3JpZXM7XG4oZnVuY3Rpb24gKGNhdGVnb3JpZXMpIHtcbiAgICBjYXRlZ29yaWVzLlZpc3VhbFRyZWVFdmVudHMgPSBcIlZpc3VhbFRyZWVFdmVudHNcIjtcbiAgICBjYXRlZ29yaWVzLkxheW91dCA9IFwiTGF5b3V0XCI7XG4gICAgY2F0ZWdvcmllcy5TdHlsZSA9IFwiU3R5bGVcIjtcbiAgICBjYXRlZ29yaWVzLlZpZXdIaWVyYXJjaHkgPSBcIlZpZXdIaWVyYXJjaHlcIjtcbiAgICBjYXRlZ29yaWVzLk5hdGl2ZUxpZmVjeWNsZSA9IFwiTmF0aXZlTGlmZWN5Y2xlXCI7XG4gICAgY2F0ZWdvcmllcy5EZWJ1ZyA9IFwiRGVidWdcIjtcbiAgICBjYXRlZ29yaWVzLk5hdmlnYXRpb24gPSBcIk5hdmlnYXRpb25cIjtcbiAgICBjYXRlZ29yaWVzLlRlc3QgPSBcIlRlc3RcIjtcbiAgICBjYXRlZ29yaWVzLkJpbmRpbmcgPSBcIkJpbmRpbmdcIjtcbiAgICBjYXRlZ29yaWVzLkJpbmRpbmdFcnJvciA9IFwiQmluZGluZ0Vycm9yXCI7XG4gICAgY2F0ZWdvcmllcy5FcnJvciA9IFwiRXJyb3JcIjtcbiAgICBjYXRlZ29yaWVzLkFuaW1hdGlvbiA9IFwiQW5pbWF0aW9uXCI7XG4gICAgY2F0ZWdvcmllcy5UcmFuc2l0aW9uID0gXCJUcmFuc2l0aW9uXCI7XG4gICAgY2F0ZWdvcmllcy5MaXZlc3luYyA9IFwiTGl2ZXN5bmNcIjtcbiAgICBjYXRlZ29yaWVzLk1vZHVsZU5hbWVSZXNvbHZlciA9IFwiTW9kdWxlTmFtZVJlc29sdmVyXCI7XG4gICAgY2F0ZWdvcmllcy5zZXBhcmF0b3IgPSBcIixcIjtcbiAgICBjYXRlZ29yaWVzLkFsbCA9IFtcbiAgICAgICAgY2F0ZWdvcmllcy5WaXN1YWxUcmVlRXZlbnRzLCBjYXRlZ29yaWVzLkxheW91dCwgY2F0ZWdvcmllcy5TdHlsZSxcbiAgICAgICAgY2F0ZWdvcmllcy5WaWV3SGllcmFyY2h5LCBjYXRlZ29yaWVzLk5hdGl2ZUxpZmVjeWNsZSxcbiAgICAgICAgY2F0ZWdvcmllcy5EZWJ1ZywgY2F0ZWdvcmllcy5OYXZpZ2F0aW9uLCBjYXRlZ29yaWVzLlRlc3QsIGNhdGVnb3JpZXMuQmluZGluZyxcbiAgICAgICAgY2F0ZWdvcmllcy5FcnJvciwgY2F0ZWdvcmllcy5BbmltYXRpb24sIGNhdGVnb3JpZXMuVHJhbnNpdGlvbiwgY2F0ZWdvcmllcy5MaXZlc3luYyxcbiAgICAgICAgY2F0ZWdvcmllcy5Nb2R1bGVOYW1lUmVzb2x2ZXJcbiAgICBdXG4gICAgICAgIC5qb2luKGNhdGVnb3JpZXMuc2VwYXJhdG9yKTtcbiAgICBmdW5jdGlvbiBjb25jYXQoKSB7XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoY2F0ZWdvcmllcy5zZXBhcmF0b3IsIGFyZ3VtZW50c1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgY2F0ZWdvcmllcy5jb25jYXQgPSBjb25jYXQ7XG59KShjYXRlZ29yaWVzID0gZXhwb3J0cy5jYXRlZ29yaWVzIHx8IChleHBvcnRzLmNhdGVnb3JpZXMgPSB7fSkpO1xudmFyIENvbnNvbGVXcml0ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENvbnNvbGVXcml0ZXIoKSB7XG4gICAgfVxuICAgIENvbnNvbGVXcml0ZXIucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKG1lc3NhZ2UsIGNhdGVnb3J5LCB0eXBlKSB7XG4gICAgICAgIGlmICghY29uc29sZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtc2dUeXBlO1xuICAgICAgICBpZiAodHlwZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBtc2dUeXBlID0gbWVzc2FnZVR5cGUubG9nO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbXNnVHlwZSA9IHR5cGU7XG4gICAgICAgIH1cbiAgICAgICAgc3dpdGNoIChtc2dUeXBlKSB7XG4gICAgICAgICAgICBjYXNlIG1lc3NhZ2VUeXBlLmxvZzpcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjYXRlZ29yeSArIFwiOiBcIiArIG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBtZXNzYWdlVHlwZS5pbmZvOlxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhjYXRlZ29yeSArIFwiOiBcIiArIG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBtZXNzYWdlVHlwZS53YXJuOlxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihjYXRlZ29yeSArIFwiOiBcIiArIG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBtZXNzYWdlVHlwZS5lcnJvcjpcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGNhdGVnb3J5ICsgXCI6IFwiICsgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBDb25zb2xlV3JpdGVyO1xufSgpKTtcbmFkZFdyaXRlcihuZXcgQ29uc29sZVdyaXRlcigpKTtcbnZhciBEZWZhdWx0RXJyb3JIYW5kbGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBEZWZhdWx0RXJyb3JIYW5kbGVyKCkge1xuICAgIH1cbiAgICBEZWZhdWx0RXJyb3JIYW5kbGVyLnByb3RvdHlwZS5oYW5kbGVyRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfTtcbiAgICByZXR1cm4gRGVmYXVsdEVycm9ySGFuZGxlcjtcbn0oKSk7XG5leHBvcnRzLkRlZmF1bHRFcnJvckhhbmRsZXIgPSBEZWZhdWx0RXJyb3JIYW5kbGVyO1xuc2V0RXJyb3JIYW5kbGVyKG5ldyBEZWZhdWx0RXJyb3JIYW5kbGVyKCkpO1xuZnVuY3Rpb24gZ2V0RXJyb3JIYW5kbGVyKCkge1xuICAgIHJldHVybiBfZXJyb3JIYW5kbGVyO1xufVxuZXhwb3J0cy5nZXRFcnJvckhhbmRsZXIgPSBnZXRFcnJvckhhbmRsZXI7XG5mdW5jdGlvbiBzZXRFcnJvckhhbmRsZXIoaGFuZGxlcikge1xuICAgIF9lcnJvckhhbmRsZXIgPSBoYW5kbGVyO1xufVxuZXhwb3J0cy5zZXRFcnJvckhhbmRsZXIgPSBzZXRFcnJvckhhbmRsZXI7XG5mdW5jdGlvbiBlcnJvcihlcnJvcikge1xuICAgIGlmICghX2Vycm9ySGFuZGxlcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZXJyb3IgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgZXJyb3IgPSBuZXcgRXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgICBfZXJyb3JIYW5kbGVyLmhhbmRsZXJFcnJvcihlcnJvcik7XG59XG5leHBvcnRzLmVycm9yID0gZXJyb3I7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10cmFjZS5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG52YXIga25vd25Db2xsZWN0aW9ucztcbihmdW5jdGlvbiAoa25vd25Db2xsZWN0aW9ucykge1xuICAgIGtub3duQ29sbGVjdGlvbnMuYWN0aW9uSXRlbXMgPSBcImFjdGlvbkl0ZW1zXCI7XG59KShrbm93bkNvbGxlY3Rpb25zID0gZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zIHx8IChleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgPSB7fSkpO1xudmFyIEFjdGlvbkJhckJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhBY3Rpb25CYXJCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFjdGlvbkJhckJhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9hY3Rpb25JdGVtcyA9IG5ldyBBY3Rpb25JdGVtcyhfdGhpcyk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGlvbkJhckJhc2UucHJvdG90eXBlLCBcIm5hdmlnYXRpb25CdXR0b25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uYXZpZ2F0aW9uQnV0dG9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX25hdmlnYXRpb25CdXR0b24gIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX25hdmlnYXRpb25CdXR0b24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlVmlldyh0aGlzLl9uYXZpZ2F0aW9uQnV0dG9uKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbmF2aWdhdGlvbkJ1dHRvbi5hY3Rpb25CYXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX25hdmlnYXRpb25CdXR0b24gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbmF2aWdhdGlvbkJ1dHRvbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uQnV0dG9uLmFjdGlvbkJhciA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodGhpcy5fbmF2aWdhdGlvbkJ1dHRvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25CYXJCYXNlLnByb3RvdHlwZSwgXCJhY3Rpb25JdGVtc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FjdGlvbkl0ZW1zO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYWN0aW9uSXRlbXMgcHJvcGVydHkgaXMgcmVhZC1vbmx5XCIpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWN0aW9uQmFyQmFzZS5wcm90b3R5cGUsIFwidGl0bGVWaWV3XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGl0bGVWaWV3O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3RpdGxlVmlldyAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fdGl0bGVWaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVZpZXcodGhpcy5fdGl0bGVWaWV3KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGl0bGVWaWV3LnN0eWxlW3ZpZXdfMS5ob3Jpem9udGFsQWxpZ25tZW50UHJvcGVydHkuY3NzTmFtZV0gPSB2aWV3XzEudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGl0bGVWaWV3LnN0eWxlW3ZpZXdfMS52ZXJ0aWNhbEFsaWdubWVudFByb3BlcnR5LmNzc05hbWVdID0gdmlld18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3RpdGxlVmlldyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0eWxlID0gdmFsdWUuc3R5bGU7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdmlld18xLmhvcml6b250YWxBbGlnbm1lbnRQcm9wZXJ0eS5pc1NldChzdHlsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlW3ZpZXdfMS5ob3Jpem9udGFsQWxpZ25tZW50UHJvcGVydHkuY3NzTmFtZV0gPSBcImNlbnRlclwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghdmlld18xLnZlcnRpY2FsQWxpZ25tZW50UHJvcGVydHkuaXNTZXQoc3R5bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZVt2aWV3XzEudmVydGljYWxBbGlnbm1lbnRQcm9wZXJ0eS5jc3NOYW1lXSA9IFwibWlkZGxlXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGlvbkJhckJhc2UucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGlvbkJhckJhc2UucHJvdG90eXBlLCBcImFuZHJvaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25CYXJCYXNlLnByb3RvdHlwZSwgXCJfY2hpbGRyZW5Db3VudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFjdGlvblZpZXdzQ291bnQgPSAwO1xuICAgICAgICAgICAgdGhpcy5fYWN0aW9uSXRlbXMuZ2V0SXRlbXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChhY3Rpb25JdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFjdGlvbkl0ZW0uYWN0aW9uVmlldykge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25WaWV3c0NvdW50Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gYWN0aW9uVmlld3NDb3VudCArICh0aGlzLnRpdGxlVmlldyA/IDEgOiAwKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQWN0aW9uQmFyQmFzZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgQWN0aW9uQmFyQmFzZS5wcm90b3R5cGUuX29uVGl0bGVQcm9wZXJ0eUNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBBY3Rpb25CYXJCYXNlLnByb3RvdHlwZS5fYWRkQXJyYXlGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJhY3Rpb25JdGVtc1wiKSB7XG4gICAgICAgICAgICB0aGlzLmFjdGlvbkl0ZW1zLnNldEl0ZW1zKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uQmFyQmFzZS5wcm90b3R5cGUuZWFjaENoaWxkVmlldyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgdGl0bGVWaWV3ID0gdGhpcy50aXRsZVZpZXc7XG4gICAgICAgIGlmICh0aXRsZVZpZXcpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRpdGxlVmlldyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGlvbkJhckJhc2UucHJvdG90eXBlLmVhY2hDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgdGl0bGVWaWV3ID0gdGhpcy50aXRsZVZpZXc7XG4gICAgICAgIGlmICh0aXRsZVZpZXcpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRpdGxlVmlldyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdmlnYXRpb25CdXR0b24gPSB0aGlzLl9uYXZpZ2F0aW9uQnV0dG9uO1xuICAgICAgICBpZiAobmF2aWdhdGlvbkJ1dHRvbikge1xuICAgICAgICAgICAgY2FsbGJhY2sobmF2aWdhdGlvbkJ1dHRvbik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hY3Rpb25JdGVtcy5nZXRJdGVtcygpLmZvckVhY2goZnVuY3Rpb24gKGFjdGlvbkl0ZW0pIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGFjdGlvbkl0ZW0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEFjdGlvbkJhckJhc2UucHJvdG90eXBlLl9pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50aXRsZSB8fFxuICAgICAgICAgICAgdGhpcy50aXRsZVZpZXcgfHxcbiAgICAgICAgICAgICh0aGlzLmFuZHJvaWQgJiYgdGhpcy5hbmRyb2lkLmljb24pIHx8XG4gICAgICAgICAgICB0aGlzLm5hdmlnYXRpb25CdXR0b24gfHxcbiAgICAgICAgICAgIHRoaXMuYWN0aW9uSXRlbXMuZ2V0SXRlbXMoKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBBY3Rpb25CYXJCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiQWN0aW9uQmFyXCIpXG4gICAgXSwgQWN0aW9uQmFyQmFzZSk7XG4gICAgcmV0dXJuIEFjdGlvbkJhckJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLkFjdGlvbkJhckJhc2UgPSBBY3Rpb25CYXJCYXNlO1xudmFyIEFjdGlvbkl0ZW1zID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBY3Rpb25JdGVtcyhhY3Rpb25CYXIpIHtcbiAgICAgICAgdGhpcy5faXRlbXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdGhpcy5fYWN0aW9uQmFyID0gYWN0aW9uQmFyO1xuICAgIH1cbiAgICBBY3Rpb25JdGVtcy5wcm90b3R5cGUuYWRkSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGlmICghaXRlbSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGFkZCBlbXB0eSBpdGVtXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2l0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgIGl0ZW0uYWN0aW9uQmFyID0gdGhpcy5fYWN0aW9uQmFyO1xuICAgICAgICB0aGlzLl9hY3Rpb25CYXIuX2FkZFZpZXcoaXRlbSk7XG4gICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgQWN0aW9uSXRlbXMucHJvdG90eXBlLnJlbW92ZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICBpZiAoIWl0ZW0pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCByZW1vdmUgZW1wdHkgaXRlbVwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXRlbUluZGV4ID0gdGhpcy5faXRlbXMuaW5kZXhPZihpdGVtKTtcbiAgICAgICAgaWYgKGl0ZW1JbmRleCA8IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIGl0ZW0gdG8gcmVtb3ZlXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2l0ZW1zLnNwbGljZShpdGVtSW5kZXgsIDEpO1xuICAgICAgICB0aGlzLl9hY3Rpb25CYXIuX3JlbW92ZVZpZXcoaXRlbSk7XG4gICAgICAgIGl0ZW0uYWN0aW9uQmFyID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEFjdGlvbkl0ZW1zLnByb3RvdHlwZS5nZXRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1zLnNsaWNlKCk7XG4gICAgfTtcbiAgICBBY3Rpb25JdGVtcy5wcm90b3R5cGUuZ2V0VmlzaWJsZUl0ZW1zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlzaWJsZUl0ZW1zID0gW107XG4gICAgICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIGlmIChpc1Zpc2libGUoaXRlbSkpIHtcbiAgICAgICAgICAgICAgICB2aXNpYmxlSXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB2aXNpYmxlSXRlbXM7XG4gICAgfTtcbiAgICBBY3Rpb25JdGVtcy5wcm90b3R5cGUuZ2V0SXRlbUF0ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gdGhpcy5faXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9pdGVtc1tpbmRleF07XG4gICAgfTtcbiAgICBBY3Rpb25JdGVtcy5wcm90b3R5cGUuc2V0SXRlbXMgPSBmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgd2hpbGUgKHRoaXMuX2l0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlSXRlbSh0aGlzLl9pdGVtc1t0aGlzLl9pdGVtcy5sZW5ndGggLSAxXSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5hZGRJdGVtKGl0ZW1zW2ldKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEFjdGlvbkl0ZW1zLnByb3RvdHlwZS5pbnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fYWN0aW9uQmFyKSB7XG4gICAgICAgICAgICB0aGlzLl9hY3Rpb25CYXIudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBBY3Rpb25JdGVtcztcbn0oKSk7XG5leHBvcnRzLkFjdGlvbkl0ZW1zID0gQWN0aW9uSXRlbXM7XG52YXIgQWN0aW9uSXRlbUJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhBY3Rpb25JdGVtQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBY3Rpb25JdGVtQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWN0aW9uSXRlbUJhc2UucHJvdG90eXBlLCBcImFjdGlvblZpZXdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hY3Rpb25WaWV3O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2FjdGlvblZpZXcgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FjdGlvblZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWN0aW9uVmlldy5zdHlsZVt2aWV3XzEuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5LmNzc05hbWVdID0gdmlld18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvblZpZXcuc3R5bGVbdmlld18xLnZlcnRpY2FsQWxpZ25tZW50UHJvcGVydHkuY3NzTmFtZV0gPSB2aWV3XzEudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlVmlldyh0aGlzLl9hY3Rpb25WaWV3KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fYWN0aW9uVmlldyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hY3Rpb25WaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodGhpcy5fYWN0aW9uVmlldyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hY3Rpb25CYXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWN0aW9uQmFyLnVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGlvbkl0ZW1CYXNlLnByb3RvdHlwZSwgXCJhY3Rpb25CYXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hY3Rpb25CYXI7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgIT09IHRoaXMuX2FjdGlvbkJhcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvbkJhciA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBY3Rpb25JdGVtQmFzZS5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9hY3Rpb25WaWV3KSB7XG4gICAgICAgICAgICB0aGlzLl9hY3Rpb25WaWV3LnN0eWxlW3ZpZXdfMS5ob3Jpem9udGFsQWxpZ25tZW50UHJvcGVydHkuY3NzTmFtZV0gPSBcImNlbnRlclwiO1xuICAgICAgICAgICAgdGhpcy5fYWN0aW9uVmlldy5zdHlsZVt2aWV3XzEudmVydGljYWxBbGlnbm1lbnRQcm9wZXJ0eS5jc3NOYW1lXSA9IFwibWlkZGxlXCI7XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgQWN0aW9uSXRlbUJhc2UucHJvdG90eXBlLl9yYWlzZVRhcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZW1pdChBY3Rpb25JdGVtQmFzZS50YXBFdmVudCk7XG4gICAgfTtcbiAgICBBY3Rpb25JdGVtQmFzZS5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5hY3Rpb25WaWV3ID0gdmFsdWU7XG4gICAgfTtcbiAgICBBY3Rpb25JdGVtQmFzZS5wcm90b3R5cGUuX29uVmlzaWJpbGl0eUNoYW5nZWQgPSBmdW5jdGlvbiAodmlzaWJpbGl0eSkge1xuICAgICAgICBpZiAodGhpcy5hY3Rpb25CYXIpIHtcbiAgICAgICAgICAgIHRoaXMuYWN0aW9uQmFyLnVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY3Rpb25JdGVtQmFzZS5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0aGlzLl9hY3Rpb25WaWV3KSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aGlzLl9hY3Rpb25WaWV3KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uSXRlbUJhc2UudGFwRXZlbnQgPSBcInRhcFwiO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQWN0aW9uSXRlbUJhc2UucHJvdG90eXBlLCBcIm9uTG9hZGVkXCIsIG51bGwpO1xuICAgIHJldHVybiBBY3Rpb25JdGVtQmFzZTtcbn0odmlld18xLlZpZXdCYXNlKSk7XG5leHBvcnRzLkFjdGlvbkl0ZW1CYXNlID0gQWN0aW9uSXRlbUJhc2U7XG5mdW5jdGlvbiBpc1Zpc2libGUoaXRlbSkge1xuICAgIHJldHVybiBpdGVtLnZpc2liaWxpdHkgPT09IFwidmlzaWJsZVwiO1xufVxuZXhwb3J0cy5pc1Zpc2libGUgPSBpc1Zpc2libGU7XG5mdW5jdGlvbiBvblRpdGxlUHJvcGVydHlDaGFuZ2VkKGFjdGlvbkJhciwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgYWN0aW9uQmFyLl9vblRpdGxlUHJvcGVydHlDaGFuZ2VkKCk7XG59XG5leHBvcnRzLnRpdGxlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJ0aXRsZVwiLCB2YWx1ZUNoYW5nZWQ6IG9uVGl0bGVQcm9wZXJ0eUNoYW5nZWQgfSk7XG5leHBvcnRzLnRpdGxlUHJvcGVydHkucmVnaXN0ZXIoQWN0aW9uQmFyQmFzZSk7XG5mdW5jdGlvbiBvbkl0ZW1DaGFuZ2VkKGl0ZW0sIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgIGlmIChpdGVtLmFjdGlvbkJhcikge1xuICAgICAgICBpdGVtLmFjdGlvbkJhci51cGRhdGUoKTtcbiAgICB9XG59XG5mdW5jdGlvbiBvblZpc2liaWxpdHlDaGFuZ2VkKGl0ZW0sIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgIGl0ZW0uX29uVmlzaWJpbGl0eUNoYW5nZWQobmV3VmFsdWUpO1xufVxuZnVuY3Rpb24gdHJhY2VNaXNzaW5nSWNvbihpY29uKSB7XG4gICAgdmlld18xLnRyYWNlV3JpdGUoXCJDb3VsZCBub3QgbG9hZCBhY3Rpb24gYmFyIGljb246IFwiICsgaWNvbiwgdmlld18xLnRyYWNlQ2F0ZWdvcmllcy5FcnJvciwgdmlld18xLnRyYWNlTWVzc2FnZVR5cGUuZXJyb3IpO1xufVxuZXhwb3J0cy50cmFjZU1pc3NpbmdJY29uID0gdHJhY2VNaXNzaW5nSWNvbjtcbmV4cG9ydHMuaW9zSWNvblJlbmRlcmluZ01vZGVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImlvc0ljb25SZW5kZXJpbmdNb2RlXCIsIGRlZmF1bHRWYWx1ZTogXCJhbHdheXNPcmlnaW5hbFwiIH0pO1xuZXhwb3J0cy5pb3NJY29uUmVuZGVyaW5nTW9kZVByb3BlcnR5LnJlZ2lzdGVyKEFjdGlvbkJhckJhc2UpO1xuZXhwb3J0cy50ZXh0UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJ0ZXh0XCIsIGRlZmF1bHRWYWx1ZTogXCJcIiwgdmFsdWVDaGFuZ2VkOiBvbkl0ZW1DaGFuZ2VkIH0pO1xuZXhwb3J0cy50ZXh0UHJvcGVydHkucmVnaXN0ZXIoQWN0aW9uSXRlbUJhc2UpO1xuZXhwb3J0cy5pY29uUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJpY29uXCIsIHZhbHVlQ2hhbmdlZDogb25JdGVtQ2hhbmdlZCB9KTtcbmV4cG9ydHMuaWNvblByb3BlcnR5LnJlZ2lzdGVyKEFjdGlvbkl0ZW1CYXNlKTtcbmV4cG9ydHMudmlzaWJpbGl0eVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwidmlzaWJpbGl0eVwiLCBkZWZhdWx0VmFsdWU6IFwidmlzaWJsZVwiLCB2YWx1ZUNoYW5nZWQ6IG9uVmlzaWJpbGl0eUNoYW5nZWQgfSk7XG5leHBvcnRzLnZpc2liaWxpdHlQcm9wZXJ0eS5yZWdpc3RlcihBY3Rpb25JdGVtQmFzZSk7XG5leHBvcnRzLmZsYXRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImZsYXRcIiwgZGVmYXVsdFZhbHVlOiBmYWxzZSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5mbGF0UHJvcGVydHkucmVnaXN0ZXIoQWN0aW9uQmFyQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hY3Rpb24tYmFyLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGFjdGlvbl9iYXJfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9hY3Rpb24tYmFyLWNvbW1vblwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3V0aWxzXCIpO1xudmFyIGltYWdlX3NvdXJjZV8xID0gcmVxdWlyZShcIi4uLy4uL2ltYWdlLXNvdXJjZVwiKTtcbnZhciBhcHBsaWNhdGlvbiA9IHJlcXVpcmUoXCIuLi8uLi9hcHBsaWNhdGlvblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2FjdGlvbi1iYXItY29tbW9uXCIpKTtcbnZhciBSX0lEX0hPTUUgPSAweDAxMDIwMDJjO1xudmFyIEFDVElPTl9JVEVNX0lEX09GRlNFVCA9IDEwMDAwO1xudmFyIERFRkFVTFRfRUxFVkFUSU9OID0gNDtcbnZhciBBcHBDb21wYXRUZXh0VmlldztcbnZhciBhY3Rpb25JdGVtSWRHZW5lcmF0b3IgPSBBQ1RJT05fSVRFTV9JRF9PRkZTRVQ7XG5mdW5jdGlvbiBnZW5lcmF0ZUl0ZW1JZCgpIHtcbiAgICBhY3Rpb25JdGVtSWRHZW5lcmF0b3IrKztcbiAgICByZXR1cm4gYWN0aW9uSXRlbUlkR2VuZXJhdG9yO1xufVxudmFyIGFwcFJlc291cmNlcztcbnZhciBNZW51SXRlbUNsaWNrTGlzdGVuZXI7XG5mdW5jdGlvbiBpbml0aWFsaXplTWVudUl0ZW1DbGlja0xpc3RlbmVyKCkge1xuICAgIGlmIChNZW51SXRlbUNsaWNrTGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBBcHBDb21wYXRUZXh0VmlldyA9IGFuZHJvaWR4LmFwcGNvbXBhdC53aWRnZXQuQXBwQ29tcGF0VGV4dFZpZXc7XG4gICAgdmFyIE1lbnVJdGVtQ2xpY2tMaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoTWVudUl0ZW1DbGlja0xpc3RlbmVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gTWVudUl0ZW1DbGlja0xpc3RlbmVySW1wbChvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBNZW51SXRlbUNsaWNrTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vbk1lbnVJdGVtQ2xpY2sgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgdmFyIGl0ZW1JZCA9IGl0ZW0uZ2V0SXRlbUlkKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vd25lci5fb25BbmRyb2lkSXRlbVNlbGVjdGVkKGl0ZW1JZCk7XG4gICAgICAgIH07XG4gICAgICAgIE1lbnVJdGVtQ2xpY2tMaXN0ZW5lckltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWR4LmFwcGNvbXBhdC53aWRnZXQuVG9vbGJhci5Pbk1lbnVJdGVtQ2xpY2tMaXN0ZW5lcl0pXG4gICAgICAgIF0sIE1lbnVJdGVtQ2xpY2tMaXN0ZW5lckltcGwpO1xuICAgICAgICByZXR1cm4gTWVudUl0ZW1DbGlja0xpc3RlbmVySW1wbDtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICBNZW51SXRlbUNsaWNrTGlzdGVuZXIgPSBNZW51SXRlbUNsaWNrTGlzdGVuZXJJbXBsO1xuICAgIGFwcFJlc291cmNlcyA9IGFwcGxpY2F0aW9uLmFuZHJvaWQuY29udGV4dC5nZXRSZXNvdXJjZXMoKTtcbn1cbnZhciBBY3Rpb25JdGVtID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQWN0aW9uSXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBY3Rpb25JdGVtKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fYW5kcm9pZFBvc2l0aW9uID0ge1xuICAgICAgICAgICAgcG9zaXRpb246IFwiYWN0aW9uQmFyXCIsXG4gICAgICAgICAgICBzeXN0ZW1JY29uOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuX2l0ZW1JZCA9IGdlbmVyYXRlSXRlbUlkKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGlvbkl0ZW0ucHJvdG90eXBlLCBcImFuZHJvaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hbmRyb2lkUG9zaXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBY3Rpb25JdGVtLmFuZHJvaWQgaXMgcmVhZC1vbmx5XCIpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBY3Rpb25JdGVtLnByb3RvdHlwZS5fZ2V0SXRlbUlkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faXRlbUlkO1xuICAgIH07XG4gICAgcmV0dXJuIEFjdGlvbkl0ZW07XG59KGFjdGlvbl9iYXJfY29tbW9uXzEuQWN0aW9uSXRlbUJhc2UpKTtcbmV4cG9ydHMuQWN0aW9uSXRlbSA9IEFjdGlvbkl0ZW07XG52YXIgQW5kcm9pZEFjdGlvbkJhclNldHRpbmdzID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBbmRyb2lkQWN0aW9uQmFyU2V0dGluZ3MoYWN0aW9uQmFyKSB7XG4gICAgICAgIHRoaXMuX2ljb25WaXNpYmlsaXR5ID0gXCJhdXRvXCI7XG4gICAgICAgIHRoaXMuX2FjdGlvbkJhciA9IGFjdGlvbkJhcjtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFuZHJvaWRBY3Rpb25CYXJTZXR0aW5ncy5wcm90b3R5cGUsIFwiaWNvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ljb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgIT09IHRoaXMuX2ljb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pY29uID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWN0aW9uQmFyLl9vbkljb25Qcm9wZXJ0eUNoYW5nZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFuZHJvaWRBY3Rpb25CYXJTZXR0aW5ncy5wcm90b3R5cGUsIFwiaWNvblZpc2liaWxpdHlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pY29uVmlzaWJpbGl0eTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdGhpcy5faWNvblZpc2liaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pY29uVmlzaWJpbGl0eSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvbkJhci5fb25JY29uUHJvcGVydHlDaGFuZ2VkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBBbmRyb2lkQWN0aW9uQmFyU2V0dGluZ3M7XG59KCkpO1xuZXhwb3J0cy5BbmRyb2lkQWN0aW9uQmFyU2V0dGluZ3MgPSBBbmRyb2lkQWN0aW9uQmFyU2V0dGluZ3M7XG52YXIgTmF2aWdhdGlvbkJ1dHRvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE5hdmlnYXRpb25CdXR0b24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTmF2aWdhdGlvbkJ1dHRvbigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICByZXR1cm4gTmF2aWdhdGlvbkJ1dHRvbjtcbn0oQWN0aW9uSXRlbSkpO1xuZXhwb3J0cy5OYXZpZ2F0aW9uQnV0dG9uID0gTmF2aWdhdGlvbkJ1dHRvbjtcbnZhciBBY3Rpb25CYXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhBY3Rpb25CYXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQWN0aW9uQmFyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fYW5kcm9pZCA9IG5ldyBBbmRyb2lkQWN0aW9uQmFyU2V0dGluZ3MoX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25CYXIucHJvdG90eXBlLCBcImFuZHJvaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hbmRyb2lkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE5hdmlnYXRpb25CdXR0b24pIHtcbiAgICAgICAgICAgIHRoaXMubmF2aWdhdGlvbkJ1dHRvbiA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgQWN0aW9uSXRlbSkge1xuICAgICAgICAgICAgdGhpcy5hY3Rpb25JdGVtcy5hZGRJdGVtKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGFjdGlvbl9iYXJfY29tbW9uXzEuVmlldykge1xuICAgICAgICAgICAgdGhpcy50aXRsZVZpZXcgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IGFuZHJvaWR4LmFwcGNvbXBhdC53aWRnZXQuVG9vbGJhcih0aGlzLl9jb250ZXh0KTtcbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGluaXRpYWxpemVNZW51SXRlbUNsaWNrTGlzdGVuZXIoKTtcbiAgICAgICAgdmFyIG1lbnVJdGVtQ2xpY2tMaXN0ZW5lciA9IG5ldyBNZW51SXRlbUNsaWNrTGlzdGVuZXIodGhpcyk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0T25NZW51SXRlbUNsaWNrTGlzdGVuZXIobWVudUl0ZW1DbGlja0xpc3RlbmVyKTtcbiAgICAgICAgbmF0aXZlVmlldy5tZW51SXRlbUNsaWNrTGlzdGVuZXIgPSBtZW51SXRlbUNsaWNrTGlzdGVuZXI7XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQubWVudUl0ZW1DbGlja0xpc3RlbmVyLm93bmVyID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBhZ2UgPSB0aGlzLnBhZ2U7XG4gICAgICAgIGlmICghcGFnZS5mcmFtZSB8fCAhcGFnZS5mcmFtZS5fZ2V0TmF2QmFyVmlzaWJsZShwYWdlKSkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFZpc2liaWxpdHkoYW5kcm9pZC52aWV3LlZpZXcuR09ORSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFZpc2liaWxpdHkoYW5kcm9pZC52aWV3LlZpZXcuVklTSUJMRSk7XG4gICAgICAgIHRoaXMuX2FkZEFjdGlvbkl0ZW1zKCk7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVRpdGxlQW5kVGl0bGVWaWV3KCk7XG4gICAgICAgIHRoaXMuX3VwZGF0ZUljb24oKTtcbiAgICAgICAgdGhpcy5fdXBkYXRlTmF2aWdhdGlvbkJ1dHRvbigpO1xuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5fb25BbmRyb2lkSXRlbVNlbGVjdGVkID0gZnVuY3Rpb24gKGl0ZW1JZCkge1xuICAgICAgICBpZiAodGhpcy5uYXZpZ2F0aW9uQnV0dG9uICYmIGl0ZW1JZCA9PT0gUl9JRF9IT01FKSB7XG4gICAgICAgICAgICB0aGlzLm5hdmlnYXRpb25CdXR0b24uX3JhaXNlVGFwKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWVudUl0ZW0gPSB1bmRlZmluZWQ7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuYWN0aW9uSXRlbXMuZ2V0SXRlbXMoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGl0ZW1zW2ldLl9nZXRJdGVtSWQoKSA9PT0gaXRlbUlkKSB7XG4gICAgICAgICAgICAgICAgbWVudUl0ZW0gPSBpdGVtc1tpXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobWVudUl0ZW0pIHtcbiAgICAgICAgICAgIG1lbnVJdGVtLl9yYWlzZVRhcCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5fdXBkYXRlTmF2aWdhdGlvbkJ1dHRvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdkJ1dHRvbiA9IHRoaXMubmF2aWdhdGlvbkJ1dHRvbjtcbiAgICAgICAgaWYgKG5hdkJ1dHRvbiAmJiBhY3Rpb25fYmFyX2NvbW1vbl8xLmlzVmlzaWJsZShuYXZCdXR0b24pKSB7XG4gICAgICAgICAgICB2YXIgc3lzdGVtSWNvbiA9IG5hdkJ1dHRvbi5hbmRyb2lkLnN5c3RlbUljb247XG4gICAgICAgICAgICBpZiAoc3lzdGVtSWNvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN5c3RlbVJlc291cmNlSWQgPSBnZXRTeXN0ZW1SZXNvdXJjZUlkKHN5c3RlbUljb24pO1xuICAgICAgICAgICAgICAgIGlmIChzeXN0ZW1SZXNvdXJjZUlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXROYXZpZ2F0aW9uSWNvbihzeXN0ZW1SZXNvdXJjZUlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChuYXZCdXR0b24uaWNvbikge1xuICAgICAgICAgICAgICAgIHZhciBkcmF3YWJsZU9ySWQgPSBnZXREcmF3YWJsZU9yUmVzb3VyY2VJZChuYXZCdXR0b24uaWNvbiwgYXBwUmVzb3VyY2VzKTtcbiAgICAgICAgICAgICAgICBpZiAoZHJhd2FibGVPcklkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXROYXZpZ2F0aW9uSWNvbihkcmF3YWJsZU9ySWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXROYXZpZ2F0aW9uQ29udGVudERlc2NyaXB0aW9uKG5hdkJ1dHRvbi50ZXh0IHx8IG51bGwpO1xuICAgICAgICAgICAgdmFyIG5hdkJ0bl8xID0gbmV3IFdlYWtSZWYobmF2QnV0dG9uKTtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXROYXZpZ2F0aW9uT25DbGlja0xpc3RlbmVyKG5ldyBhbmRyb2lkLnZpZXcuVmlldy5PbkNsaWNrTGlzdGVuZXIoe1xuICAgICAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvd25lciA9IG5hdkJ0bl8xLmdldCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG93bmVyLl9yYWlzZVRhcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldE5hdmlnYXRpb25JY29uKG51bGwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLl91cGRhdGVJY29uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlzaWJpbGl0eSA9IGdldEljb25WaXNpYmlsaXR5KHRoaXMuYW5kcm9pZC5pY29uVmlzaWJpbGl0eSk7XG4gICAgICAgIGlmICh2aXNpYmlsaXR5KSB7XG4gICAgICAgICAgICB2YXIgaWNvbiA9IHRoaXMuYW5kcm9pZC5pY29uO1xuICAgICAgICAgICAgaWYgKGljb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHZhciBkcmF3YWJsZU9ySWQgPSBnZXREcmF3YWJsZU9yUmVzb3VyY2VJZChpY29uLCBhcHBSZXNvdXJjZXMpO1xuICAgICAgICAgICAgICAgIGlmIChkcmF3YWJsZU9ySWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldExvZ28oZHJhd2FibGVPcklkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdEljb24gPSBhcHBsaWNhdGlvbi5hbmRyb2lkLm5hdGl2ZUFwcC5nZXRBcHBsaWNhdGlvbkluZm8oKS5pY29uO1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRMb2dvKGRlZmF1bHRJY29uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRMb2dvKG51bGwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLl91cGRhdGVUaXRsZUFuZFRpdGxlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRpdGxlVmlldykge1xuICAgICAgICAgICAgdmFyIHRpdGxlID0gdGhpcy50aXRsZTtcbiAgICAgICAgICAgIGlmICh0aXRsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFRpdGxlKHRpdGxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBhcHBDb250ZXh0ID0gYXBwbGljYXRpb24uYW5kcm9pZC5jb250ZXh0O1xuICAgICAgICAgICAgICAgIHZhciBhcHBJbmZvID0gYXBwQ29udGV4dC5nZXRBcHBsaWNhdGlvbkluZm8oKTtcbiAgICAgICAgICAgICAgICB2YXIgYXBwTGFiZWwgPSBhcHBDb250ZXh0LmdldFBhY2thZ2VNYW5hZ2VyKCkuZ2V0QXBwbGljYXRpb25MYWJlbChhcHBJbmZvKTtcbiAgICAgICAgICAgICAgICBpZiAoYXBwTGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFRpdGxlKGFwcExhYmVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUuX2FkZEFjdGlvbkl0ZW1zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbWVudSA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRNZW51KCk7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuYWN0aW9uSXRlbXMuZ2V0VmlzaWJsZUl0ZW1zKCk7XG4gICAgICAgIG1lbnUuY2xlYXIoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc1tpXTtcbiAgICAgICAgICAgIHZhciBtZW51SXRlbSA9IG1lbnUuYWRkKGFuZHJvaWQudmlldy5NZW51Lk5PTkUsIGl0ZW0uX2dldEl0ZW1JZCgpLCBhbmRyb2lkLnZpZXcuTWVudS5OT05FLCBpdGVtLnRleHQgKyBcIlwiKTtcbiAgICAgICAgICAgIGlmIChpdGVtLmFjdGlvblZpZXcgJiYgaXRlbS5hY3Rpb25WaWV3LmFuZHJvaWQpIHtcbiAgICAgICAgICAgICAgICBpdGVtLmFuZHJvaWQucG9zaXRpb24gPSBcImFjdGlvbkJhclwiO1xuICAgICAgICAgICAgICAgIG1lbnVJdGVtLnNldEFjdGlvblZpZXcoaXRlbS5hY3Rpb25WaWV3LmFuZHJvaWQpO1xuICAgICAgICAgICAgICAgIEFjdGlvbkJhci5fc2V0T25DbGlja0xpc3RlbmVyKGl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaXRlbS5hbmRyb2lkLnN5c3RlbUljb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgc3lzdGVtUmVzb3VyY2VJZCA9IGdldFN5c3RlbVJlc291cmNlSWQoaXRlbS5hbmRyb2lkLnN5c3RlbUljb24pO1xuICAgICAgICAgICAgICAgIGlmIChzeXN0ZW1SZXNvdXJjZUlkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lbnVJdGVtLnNldEljb24oc3lzdGVtUmVzb3VyY2VJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaXRlbS5pY29uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHV0aWxzXzEuaXNGb250SWNvblVSSShpdGVtLmljb24pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmb250SWNvbkNvZGUgPSBpdGVtLmljb24uc3BsaXQoXCIvL1wiKVsxXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvbnQgPSBpdGVtLnN0eWxlLmZvbnRJbnRlcm5hbDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9yID0gaXRlbS5zdHlsZS5jb2xvcjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzID0gaW1hZ2Vfc291cmNlXzEuZnJvbUZvbnRJY29uQ29kZShmb250SWNvbkNvZGUsIGZvbnQsIGNvbG9yKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzICYmIGlzLmFuZHJvaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkcmF3YWJsZSA9IG5ldyBhbmRyb2lkLmdyYXBoaWNzLmRyYXdhYmxlLkJpdG1hcERyYXdhYmxlKGFwcFJlc291cmNlcywgaXMuYW5kcm9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZW51SXRlbS5zZXRJY29uKGRyYXdhYmxlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRyYXdhYmxlT3JJZCA9IGdldERyYXdhYmxlT3JSZXNvdXJjZUlkKGl0ZW0uaWNvbiwgYXBwUmVzb3VyY2VzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRyYXdhYmxlT3JJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVudUl0ZW0uc2V0SWNvbihkcmF3YWJsZU9ySWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNob3dBc0FjdGlvbiA9IGdldFNob3dBc0FjdGlvbihpdGVtKTtcbiAgICAgICAgICAgIG1lbnVJdGVtLnNldFNob3dBc0FjdGlvbihzaG93QXNBY3Rpb24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY3Rpb25CYXIuX3NldE9uQ2xpY2tMaXN0ZW5lciA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHZhciB3ZWFrUmVmID0gbmV3IFdlYWtSZWYoaXRlbSk7XG4gICAgICAgIGl0ZW0uYWN0aW9uVmlldy5hbmRyb2lkLnNldE9uQ2xpY2tMaXN0ZW5lcihuZXcgYW5kcm9pZC52aWV3LlZpZXcuT25DbGlja0xpc3RlbmVyKHtcbiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICAgICAgdmFyIG93bmVyID0gd2Vha1JlZi5nZXQoKTtcbiAgICAgICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXIuX3JhaXNlVGFwKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLl9vblRpdGxlUHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVUaXRsZUFuZFRpdGxlVmlldygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLl9vbkljb25Qcm9wZXJ0eUNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUljb24oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZSA9IGZ1bmN0aW9uIChjaGlsZCwgYXRJbmRleCkge1xuICAgICAgICBpZiAoYXRJbmRleCA9PT0gdm9pZCAwKSB7IGF0SW5kZXggPSBOdW1iZXIuTUFYX1ZBTFVFOyB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUuY2FsbCh0aGlzLCBjaGlsZCk7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgJiYgY2hpbGQubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgaWYgKGF0SW5kZXggPj0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldENoaWxkQ291bnQoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5hZGRWaWV3KGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmFkZFZpZXcoY2hpbGQubmF0aXZlVmlld1Byb3RlY3RlZCwgYXRJbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLl9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlLmNhbGwodGhpcywgY2hpbGQpO1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkICYmIGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5yZW1vdmVWaWV3KGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlW2FjdGlvbl9iYXJfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmICghZGVmYXVsdFRpdGxlVGV4dENvbG9yKSB7XG4gICAgICAgICAgICB2YXIgdHYgPSBnZXRBcHBDb21wYXRUZXh0VmlldyhuYXRpdmVWaWV3KTtcbiAgICAgICAgICAgIGlmICghdHYpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBuYXRpdmVWaWV3LmdldFRpdGxlKCk7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRUaXRsZShcIlwiKTtcbiAgICAgICAgICAgICAgICB0diA9IGdldEFwcENvbXBhdFRleHRWaWV3KG5hdGl2ZVZpZXcpO1xuICAgICAgICAgICAgICAgIGlmICh0aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnNldFRpdGxlKHRpdGxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0VGl0bGVUZXh0Q29sb3IgPSB0diA/IHR2LmdldFRleHRDb2xvcnMoKS5nZXREZWZhdWx0Q29sb3IoKSA6IC01NzA0MjUzNDQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlZmF1bHRUaXRsZVRleHRDb2xvcjtcbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGVbYWN0aW9uX2Jhcl9jb21tb25fMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBhY3Rpb25fYmFyX2NvbW1vbl8xLkNvbG9yID8gdmFsdWUuYW5kcm9pZCA6IHZhbHVlO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VGl0bGVUZXh0Q29sb3IoY29sb3IpO1xuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZVthY3Rpb25fYmFyX2NvbW1vbl8xLmZsYXRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb21wYXQgPSBhbmRyb2lkeC5jb3JlLnZpZXcuVmlld0NvbXBhdDtcbiAgICAgICAgaWYgKGNvbXBhdC5zZXRFbGV2YXRpb24pIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGNvbXBhdC5zZXRFbGV2YXRpb24odGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciB2YWwgPSBERUZBVUxUX0VMRVZBVElPTiAqIGFjdGlvbl9iYXJfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgICAgICAgICAgY29tcGF0LnNldEVsZXZhdGlvbih0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIHZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBBY3Rpb25CYXI7XG59KGFjdGlvbl9iYXJfY29tbW9uXzEuQWN0aW9uQmFyQmFzZSkpO1xuZXhwb3J0cy5BY3Rpb25CYXIgPSBBY3Rpb25CYXI7XG5mdW5jdGlvbiBnZXRBcHBDb21wYXRUZXh0Vmlldyh0b29sYmFyKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGNvdW50ID0gdG9vbGJhci5nZXRDaGlsZENvdW50KCk7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICAgIHZhciBjaGlsZCA9IHRvb2xiYXIuZ2V0Q2hpbGRBdChpKTtcbiAgICAgICAgaWYgKGNoaWxkIGluc3RhbmNlb2YgQXBwQ29tcGF0VGV4dFZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiBjaGlsZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbkFjdGlvbkJhci5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbnZhciBkZWZhdWx0VGl0bGVUZXh0Q29sb3I7XG5mdW5jdGlvbiBnZXREcmF3YWJsZU9yUmVzb3VyY2VJZChpY29uLCByZXNvdXJjZXMpIHtcbiAgICBpZiAodHlwZW9mIGljb24gIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgdmFyIHJlc3VsdCA9IHVuZGVmaW5lZDtcbiAgICBpZiAoaWNvbi5pbmRleE9mKHV0aWxzXzEuUkVTT1VSQ0VfUFJFRklYKSA9PT0gMCkge1xuICAgICAgICB2YXIgcmVzb3VyY2VJZCA9IHJlc291cmNlcy5nZXRJZGVudGlmaWVyKGljb24uc3Vic3RyKHV0aWxzXzEuUkVTT1VSQ0VfUFJFRklYLmxlbmd0aCksIFwiZHJhd2FibGVcIiwgYXBwbGljYXRpb24uYW5kcm9pZC5wYWNrYWdlTmFtZSk7XG4gICAgICAgIGlmIChyZXNvdXJjZUlkID4gMCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gcmVzb3VyY2VJZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGRyYXdhYmxlID0gdm9pZCAwO1xuICAgICAgICB2YXIgaXMgPSBpbWFnZV9zb3VyY2VfMS5mcm9tRmlsZU9yUmVzb3VyY2UoaWNvbik7XG4gICAgICAgIGlmIChpcykge1xuICAgICAgICAgICAgZHJhd2FibGUgPSBuZXcgYW5kcm9pZC5ncmFwaGljcy5kcmF3YWJsZS5CaXRtYXBEcmF3YWJsZShhcHBSZXNvdXJjZXMsIGlzLmFuZHJvaWQpO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCA9IGRyYXdhYmxlO1xuICAgIH1cbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICBhY3Rpb25fYmFyX2NvbW1vbl8xLnRyYWNlTWlzc2luZ0ljb24oaWNvbik7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBnZXRTaG93QXNBY3Rpb24obWVudUl0ZW0pIHtcbiAgICBzd2l0Y2ggKG1lbnVJdGVtLmFuZHJvaWQucG9zaXRpb24pIHtcbiAgICAgICAgY2FzZSBcImFjdGlvbkJhcklmUm9vbVwiOlxuICAgICAgICAgICAgcmV0dXJuIGFuZHJvaWQudmlldy5NZW51SXRlbS5TSE9XX0FTX0FDVElPTl9JRl9ST09NO1xuICAgICAgICBjYXNlIFwicG9wdXBcIjpcbiAgICAgICAgICAgIHJldHVybiBhbmRyb2lkLnZpZXcuTWVudUl0ZW0uU0hPV19BU19BQ1RJT05fTkVWRVI7XG4gICAgICAgIGNhc2UgXCJhY3Rpb25CYXJcIjpcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBhbmRyb2lkLnZpZXcuTWVudUl0ZW0uU0hPV19BU19BQ1RJT05fQUxXQVlTO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldEljb25WaXNpYmlsaXR5KGljb25WaXNpYmlsaXR5KSB7XG4gICAgc3dpdGNoIChpY29uVmlzaWJpbGl0eSkge1xuICAgICAgICBjYXNlIFwiYWx3YXlzXCI6XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgY2FzZSBcImF1dG9cIjpcbiAgICAgICAgY2FzZSBcIm5ldmVyXCI6XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0U3lzdGVtUmVzb3VyY2VJZChzeXN0ZW1JY29uKSB7XG4gICAgcmV0dXJuIGFuZHJvaWQuY29udGVudC5yZXMuUmVzb3VyY2VzLmdldFN5c3RlbSgpLmdldElkZW50aWZpZXIoc3lzdGVtSWNvbiwgXCJkcmF3YWJsZVwiLCBcImFuZHJvaWRcIik7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hY3Rpb24tYmFyLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgQWN0aXZpdHlJbmRpY2F0b3JCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQWN0aXZpdHlJbmRpY2F0b3JCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFjdGl2aXR5SW5kaWNhdG9yQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBBY3Rpdml0eUluZGljYXRvckJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJBY3Rpdml0eUluZGljYXRvclwiKVxuICAgIF0sIEFjdGl2aXR5SW5kaWNhdG9yQmFzZSk7XG4gICAgcmV0dXJuIEFjdGl2aXR5SW5kaWNhdG9yQmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuQWN0aXZpdHlJbmRpY2F0b3JCYXNlID0gQWN0aXZpdHlJbmRpY2F0b3JCYXNlO1xuQWN0aXZpdHlJbmRpY2F0b3JCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy5idXN5UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJidXN5XCIsIGRlZmF1bHRWYWx1ZTogZmFsc2UsIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuYnVzeVByb3BlcnR5LnJlZ2lzdGVyKEFjdGl2aXR5SW5kaWNhdG9yQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hY3Rpdml0eS1pbmRpY2F0b3ItY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vYWN0aXZpdHktaW5kaWNhdG9yLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2FjdGl2aXR5LWluZGljYXRvci1jb21tb25cIikpO1xudmFyIEFjdGl2aXR5SW5kaWNhdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQWN0aXZpdHlJbmRpY2F0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQWN0aXZpdHlJbmRpY2F0b3IoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQWN0aXZpdHlJbmRpY2F0b3IucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwcm9ncmVzc0JhciA9IG5ldyBhbmRyb2lkLndpZGdldC5Qcm9ncmVzc0Jhcih0aGlzLl9jb250ZXh0KTtcbiAgICAgICAgcHJvZ3Jlc3NCYXIuc2V0VmlzaWJpbGl0eShhbmRyb2lkLnZpZXcuVmlldy5JTlZJU0lCTEUpO1xuICAgICAgICBwcm9ncmVzc0Jhci5zZXRJbmRldGVybWluYXRlKHRydWUpO1xuICAgICAgICByZXR1cm4gcHJvZ3Jlc3NCYXI7XG4gICAgfTtcbiAgICBBY3Rpdml0eUluZGljYXRvci5wcm90b3R5cGVbYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLmJ1c3lQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgQWN0aXZpdHlJbmRpY2F0b3IucHJvdG90eXBlW2FjdGl2aXR5X2luZGljYXRvcl9jb21tb25fMS5idXN5UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy52aXNpYmlsaXR5ID09PSBhY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuVmlzaWJpbGl0eS5WSVNJQkxFKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VmlzaWJpbGl0eSh2YWx1ZSA/IGFuZHJvaWQudmlldy5WaWV3LlZJU0lCTEUgOiBhbmRyb2lkLnZpZXcuVmlldy5JTlZJU0lCTEUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY3Rpdml0eUluZGljYXRvci5wcm90b3R5cGVbYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLnZpc2liaWxpdHlQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGFjdGl2aXR5X2luZGljYXRvcl9jb21tb25fMS5WaXNpYmlsaXR5LkhJRERFTjtcbiAgICB9O1xuICAgIEFjdGl2aXR5SW5kaWNhdG9yLnByb3RvdHlwZVthY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEudmlzaWJpbGl0eVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBhY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuVmlzaWJpbGl0eS5WSVNJQkxFOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRWaXNpYmlsaXR5KHRoaXMuYnVzeSA/IGFuZHJvaWQudmlldy5WaWV3LlZJU0lCTEUgOiBhbmRyb2lkLnZpZXcuVmlldy5JTlZJU0lCTEUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuVmlzaWJpbGl0eS5ISURERU46XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFZpc2liaWxpdHkoYW5kcm9pZC52aWV3LlZpZXcuSU5WSVNJQkxFKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLlZpc2liaWxpdHkuQ09MTEFQU0U6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFZpc2liaWxpdHkoYW5kcm9pZC52aWV3LlZpZXcuR09ORSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmlzaWJpbGl0eSB2YWx1ZTogXCIgKyB2YWx1ZSArIFwiLiBWYWxpZCB2YWx1ZXMgYXJlOiBcXFwiXCIgKyBhY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuVmlzaWJpbGl0eS5WSVNJQkxFICsgXCJcXFwiLCBcXFwiXCIgKyBhY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuVmlzaWJpbGl0eS5ISURERU4gKyBcIlxcXCIsIFxcXCJcIiArIGFjdGl2aXR5X2luZGljYXRvcl9jb21tb25fMS5WaXNpYmlsaXR5LkNPTExBUFNFICsgXCJcXFwiLlwiKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aXZpdHlJbmRpY2F0b3IucHJvdG90eXBlW2FjdGl2aXR5X2luZGljYXRvcl9jb21tb25fMS5jb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfTtcbiAgICBBY3Rpdml0eUluZGljYXRvci5wcm90b3R5cGVbYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBhY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuQ29sb3IpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRJbmRldGVybWluYXRlRHJhd2FibGUoKS5zZXRDb2xvckZpbHRlcih2YWx1ZS5hbmRyb2lkLCBhbmRyb2lkLmdyYXBoaWNzLlBvcnRlckR1ZmYuTW9kZS5TUkNfSU4pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldEluZGV0ZXJtaW5hdGVEcmF3YWJsZSgpLmNsZWFyQ29sb3JGaWx0ZXIoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEFjdGl2aXR5SW5kaWNhdG9yO1xufShhY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuQWN0aXZpdHlJbmRpY2F0b3JCYXNlKSk7XG5leHBvcnRzLkFjdGl2aXR5SW5kaWNhdG9yID0gQWN0aXZpdHlJbmRpY2F0b3I7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hY3Rpdml0eS1pbmRpY2F0b3IuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29sb3JfMSA9IHJlcXVpcmUoXCIuLi8uLi9jb2xvclwiKTtcbmV4cG9ydHMuQ29sb3IgPSBjb2xvcl8xLkNvbG9yO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vdHJhY2VcIik7XG5leHBvcnRzLnRyYWNlRW5hYmxlZCA9IHRyYWNlXzEuaXNFbmFibGVkO1xuZXhwb3J0cy50cmFjZVdyaXRlID0gdHJhY2VfMS53cml0ZTtcbmV4cG9ydHMudHJhY2VDYXRlZ29yaWVzID0gdHJhY2VfMS5jYXRlZ29yaWVzO1xuZXhwb3J0cy50cmFjZVR5cGUgPSB0cmFjZV8xLm1lc3NhZ2VUeXBlO1xudmFyIHN0eWxlX3Byb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9zdHlsaW5nL3N0eWxlLXByb3BlcnRpZXNcIik7XG52YXIgUHJvcGVydGllcztcbihmdW5jdGlvbiAoUHJvcGVydGllcykge1xuICAgIFByb3BlcnRpZXMub3BhY2l0eSA9IFwib3BhY2l0eVwiO1xuICAgIFByb3BlcnRpZXMuYmFja2dyb3VuZENvbG9yID0gXCJiYWNrZ3JvdW5kQ29sb3JcIjtcbiAgICBQcm9wZXJ0aWVzLnRyYW5zbGF0ZSA9IFwidHJhbnNsYXRlXCI7XG4gICAgUHJvcGVydGllcy5yb3RhdGUgPSBcInJvdGF0ZVwiO1xuICAgIFByb3BlcnRpZXMuc2NhbGUgPSBcInNjYWxlXCI7XG4gICAgUHJvcGVydGllcy5oZWlnaHQgPSBcImhlaWdodFwiO1xuICAgIFByb3BlcnRpZXMud2lkdGggPSBcIndpZHRoXCI7XG59KShQcm9wZXJ0aWVzID0gZXhwb3J0cy5Qcm9wZXJ0aWVzIHx8IChleHBvcnRzLlByb3BlcnRpZXMgPSB7fSkpO1xudmFyIEN1YmljQmV6aWVyQW5pbWF0aW9uQ3VydmUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEN1YmljQmV6aWVyQW5pbWF0aW9uQ3VydmUoeDEsIHkxLCB4MiwgeTIpIHtcbiAgICAgICAgdGhpcy54MSA9IHgxO1xuICAgICAgICB0aGlzLnkxID0geTE7XG4gICAgICAgIHRoaXMueDIgPSB4MjtcbiAgICAgICAgdGhpcy55MiA9IHkyO1xuICAgIH1cbiAgICByZXR1cm4gQ3ViaWNCZXppZXJBbmltYXRpb25DdXJ2ZTtcbn0oKSk7XG5leHBvcnRzLkN1YmljQmV6aWVyQW5pbWF0aW9uQ3VydmUgPSBDdWJpY0JlemllckFuaW1hdGlvbkN1cnZlO1xudmFyIEFuaW1hdGlvbkJhc2UgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFuaW1hdGlvbkJhc2UoYW5pbWF0aW9uRGVmaW5pdGlvbnMsIHBsYXlTZXF1ZW50aWFsbHkpIHtcbiAgICAgICAgaWYgKCFhbmltYXRpb25EZWZpbml0aW9ucyB8fCBhbmltYXRpb25EZWZpbml0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIGFuaW1hdGlvbiBkZWZpbml0aW9ucyBzcGVjaWZpZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJBbmFseXppbmcgXCIgKyBhbmltYXRpb25EZWZpbml0aW9ucy5sZW5ndGggKyBcIiBhbmltYXRpb24gZGVmaW5pdGlvbnMuLi5cIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcHJvcGVydHlBbmltYXRpb25zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGFuaW1hdGlvbkRlZmluaXRpb25zLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChhbmltYXRpb25EZWZpbml0aW9uc1tpXS5jdXJ2ZSkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkRlZmluaXRpb25zW2ldLmN1cnZlID0gdGhpcy5fcmVzb2x2ZUFuaW1hdGlvbkN1cnZlKGFuaW1hdGlvbkRlZmluaXRpb25zW2ldLmN1cnZlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucyA9IHRoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucy5jb25jYXQoQW5pbWF0aW9uQmFzZS5fY3JlYXRlUHJvcGVydHlBbmltYXRpb25zKGFuaW1hdGlvbkRlZmluaXRpb25zW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vdGhpbmcgdG8gYW5pbWF0ZS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDcmVhdGVkIFwiICsgdGhpcy5fcHJvcGVydHlBbmltYXRpb25zLmxlbmd0aCArIFwiIGluZGl2aWR1YWwgcHJvcGVydHkgYW5pbWF0aW9ucy5cIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcGxheVNlcXVlbnRpYWxseSA9IHBsYXlTZXF1ZW50aWFsbHk7XG4gICAgfVxuICAgIEFuaW1hdGlvbkJhc2UucHJvdG90eXBlLl9yZWplY3RBbHJlYWR5UGxheWluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlYXNvbiA9IFwiQW5pbWF0aW9uIGlzIGFscmVhZHkgcGxheWluZy5cIjtcbiAgICAgICAgdHJhY2VfMS53cml0ZShyZWFzb24sIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICByZWplY3QocmVhc29uKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBbmltYXRpb25CYXNlLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXNfMSA9IHRoaXM7XG4gICAgICAgIHZhciBhbmltYXRpb25GaW5pc2hlZFByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBfdGhpc18xLl9yZXNvbHZlID0gcmVzb2x2ZTtcbiAgICAgICAgICAgIF90aGlzXzEuX3JlamVjdCA9IHJlamVjdDtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZml4dXBBbmltYXRpb25Qcm9taXNlKGFuaW1hdGlvbkZpbmlzaGVkUHJvbWlzZSk7XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IHRydWU7XG4gICAgICAgIHJldHVybiBhbmltYXRpb25GaW5pc2hlZFByb21pc2U7XG4gICAgfTtcbiAgICBBbmltYXRpb25CYXNlLnByb3RvdHlwZS5maXh1cEFuaW1hdGlvblByb21pc2UgPSBmdW5jdGlvbiAocHJvbWlzZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBwcm9taXNlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLmNhbmNlbCgpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgX3RoZW4gPSBwcm9taXNlLnRoZW47XG4gICAgICAgIHByb21pc2UudGhlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByID0gX3RoZW4uYXBwbHkocHJvbWlzZSwgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIF90aGlzLmZpeHVwQW5pbWF0aW9uUHJvbWlzZShyKTtcbiAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgX2NhdGNoID0gcHJvbWlzZS5jYXRjaDtcbiAgICAgICAgcHJvbWlzZS5jYXRjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByID0gX2NhdGNoLmFwcGx5KHByb21pc2UsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICBfdGhpcy5maXh1cEFuaW1hdGlvblByb21pc2Uocik7XG4gICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbkJhc2UucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbmltYXRpb25CYXNlLnByb3RvdHlwZSwgXCJpc1BsYXlpbmdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc1BsYXlpbmc7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEFuaW1hdGlvbkJhc2UucHJvdG90eXBlLl9yZXNvbHZlQW5pbWF0aW9uRmluaXNoZWRQcm9taXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9pc1BsYXlpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fcmVzb2x2ZSgpO1xuICAgIH07XG4gICAgQW5pbWF0aW9uQmFzZS5wcm90b3R5cGUuX3JlamVjdEFuaW1hdGlvbkZpbmlzaGVkUHJvbWlzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5faXNQbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3JlamVjdChuZXcgRXJyb3IoXCJBbmltYXRpb24gY2FuY2VsbGVkLlwiKSk7XG4gICAgfTtcbiAgICBBbmltYXRpb25CYXNlLl9jcmVhdGVQcm9wZXJ0eUFuaW1hdGlvbnMgPSBmdW5jdGlvbiAoYW5pbWF0aW9uRGVmaW5pdGlvbikge1xuICAgICAgICBpZiAoIWFuaW1hdGlvbkRlZmluaXRpb24udGFyZ2V0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBhbmltYXRpb24gdGFyZ2V0IHNwZWNpZmllZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaXRlbSBpbiBhbmltYXRpb25EZWZpbml0aW9uKSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKGl0ZW0gPT09IFByb3BlcnRpZXMub3BhY2l0eSB8fFxuICAgICAgICAgICAgICAgIGl0ZW0gPT09IFByb3BlcnRpZXMucm90YXRlIHx8XG4gICAgICAgICAgICAgICAgaXRlbSA9PT0gXCJkdXJhdGlvblwiIHx8XG4gICAgICAgICAgICAgICAgaXRlbSA9PT0gXCJkZWxheVwiIHx8XG4gICAgICAgICAgICAgICAgaXRlbSA9PT0gXCJpdGVyYXRpb25zXCIpICYmIHR5cGVvZiBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgXCIgKyBpdGVtICsgXCIgbXVzdCBiZSB2YWxpZCBudW1iZXIuIFZhbHVlOiBcIiArIGFuaW1hdGlvbkRlZmluaXRpb25baXRlbV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoKGl0ZW0gPT09IFByb3BlcnRpZXMuc2NhbGUgfHwgaXRlbSA9PT0gUHJvcGVydGllcy50cmFuc2xhdGUpICYmXG4gICAgICAgICAgICAgICAgKHR5cGVvZiBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dLnggIT09IFwibnVtYmVyXCIgfHwgdHlwZW9mIGFuaW1hdGlvbkRlZmluaXRpb25baXRlbV0ueSAhPT0gXCJudW1iZXJcIikpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcm9wZXJ0eSBcIiArIGl0ZW0gKyBcIiBtdXN0IGJlIHZhbGlkIFBhaXIuIFZhbHVlOiBcIiArIGFuaW1hdGlvbkRlZmluaXRpb25baXRlbV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaXRlbSA9PT0gUHJvcGVydGllcy5iYWNrZ3JvdW5kQ29sb3IgJiYgIWNvbG9yXzEuQ29sb3IuaXNWYWxpZChhbmltYXRpb25EZWZpbml0aW9uLmJhY2tncm91bmRDb2xvcikpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcm9wZXJ0eSBcIiArIGl0ZW0gKyBcIiBtdXN0IGJlIHZhbGlkIGNvbG9yLiBWYWx1ZTogXCIgKyBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGl0ZW0gPT09IFByb3BlcnRpZXMud2lkdGggfHwgaXRlbSA9PT0gUHJvcGVydGllcy5oZWlnaHQpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dID0gc3R5bGVfcHJvcGVydGllc18xLlBlcmNlbnRMZW5ndGgucGFyc2UoYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByb3BlcnR5QW5pbWF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbi5vcGFjaXR5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IGFuaW1hdGlvbkRlZmluaXRpb24udGFyZ2V0LFxuICAgICAgICAgICAgICAgIHByb3BlcnR5OiBQcm9wZXJ0aWVzLm9wYWNpdHksXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24ub3BhY2l0eSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogYW5pbWF0aW9uRGVmaW5pdGlvbi5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICBkZWxheTogYW5pbWF0aW9uRGVmaW5pdGlvbi5kZWxheSxcbiAgICAgICAgICAgICAgICBpdGVyYXRpb25zOiBhbmltYXRpb25EZWZpbml0aW9uLml0ZXJhdGlvbnMsXG4gICAgICAgICAgICAgICAgY3VydmU6IGFuaW1hdGlvbkRlZmluaXRpb24uY3VydmVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbmltYXRpb25EZWZpbml0aW9uLmJhY2tncm91bmRDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHR5cGVvZiBhbmltYXRpb25EZWZpbml0aW9uLmJhY2tncm91bmRDb2xvciA9PT0gXCJzdHJpbmdcIiA/XG4gICAgICAgICAgICAgICAgICAgIG5ldyBjb2xvcl8xLkNvbG9yKGFuaW1hdGlvbkRlZmluaXRpb24uYmFja2dyb3VuZENvbG9yKSA6IGFuaW1hdGlvbkRlZmluaXRpb24uYmFja2dyb3VuZENvbG9yLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBhbmltYXRpb25EZWZpbml0aW9uLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgIGRlbGF5OiBhbmltYXRpb25EZWZpbml0aW9uLmRlbGF5LFxuICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGFuaW1hdGlvbkRlZmluaXRpb24uaXRlcmF0aW9ucyxcbiAgICAgICAgICAgICAgICBjdXJ2ZTogYW5pbWF0aW9uRGVmaW5pdGlvbi5jdXJ2ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb24udHJhbnNsYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IGFuaW1hdGlvbkRlZmluaXRpb24udGFyZ2V0LFxuICAgICAgICAgICAgICAgIHByb3BlcnR5OiBQcm9wZXJ0aWVzLnRyYW5zbGF0ZSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogYW5pbWF0aW9uRGVmaW5pdGlvbi50cmFuc2xhdGUsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGFuaW1hdGlvbkRlZmluaXRpb24uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbkRlZmluaXRpb24uZGVsYXksXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogYW5pbWF0aW9uRGVmaW5pdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBhbmltYXRpb25EZWZpbml0aW9uLmN1cnZlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbi5zY2FsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy5zY2FsZSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogYW5pbWF0aW9uRGVmaW5pdGlvbi5zY2FsZSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogYW5pbWF0aW9uRGVmaW5pdGlvbi5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICBkZWxheTogYW5pbWF0aW9uRGVmaW5pdGlvbi5kZWxheSxcbiAgICAgICAgICAgICAgICBpdGVyYXRpb25zOiBhbmltYXRpb25EZWZpbml0aW9uLml0ZXJhdGlvbnMsXG4gICAgICAgICAgICAgICAgY3VydmU6IGFuaW1hdGlvbkRlZmluaXRpb24uY3VydmVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbmltYXRpb25EZWZpbml0aW9uLnJvdGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy5yb3RhdGUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24ucm90YXRlLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBhbmltYXRpb25EZWZpbml0aW9uLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgIGRlbGF5OiBhbmltYXRpb25EZWZpbml0aW9uLmRlbGF5LFxuICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGFuaW1hdGlvbkRlZmluaXRpb24uaXRlcmF0aW9ucyxcbiAgICAgICAgICAgICAgICBjdXJ2ZTogYW5pbWF0aW9uRGVmaW5pdGlvbi5jdXJ2ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb24uaGVpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IGFuaW1hdGlvbkRlZmluaXRpb24udGFyZ2V0LFxuICAgICAgICAgICAgICAgIHByb3BlcnR5OiBQcm9wZXJ0aWVzLmhlaWdodCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogYW5pbWF0aW9uRGVmaW5pdGlvbi5oZWlnaHQsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGFuaW1hdGlvbkRlZmluaXRpb24uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbkRlZmluaXRpb24uZGVsYXksXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogYW5pbWF0aW9uRGVmaW5pdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBhbmltYXRpb25EZWZpbml0aW9uLmN1cnZlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbi53aWR0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy53aWR0aCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogYW5pbWF0aW9uRGVmaW5pdGlvbi53aWR0aCxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogYW5pbWF0aW9uRGVmaW5pdGlvbi5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICBkZWxheTogYW5pbWF0aW9uRGVmaW5pdGlvbi5kZWxheSxcbiAgICAgICAgICAgICAgICBpdGVyYXRpb25zOiBhbmltYXRpb25EZWZpbml0aW9uLml0ZXJhdGlvbnMsXG4gICAgICAgICAgICAgICAgY3VydmU6IGFuaW1hdGlvbkRlZmluaXRpb24uY3VydmVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBrbm93biBhbmltYXRpb24gcHJvcGVydGllcyBzcGVjaWZpZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb3BlcnR5QW5pbWF0aW9ucztcbiAgICB9O1xuICAgIEFuaW1hdGlvbkJhc2UuX2dldEFuaW1hdGlvbkluZm8gPSBmdW5jdGlvbiAoYW5pbWF0aW9uKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICB0YXJnZXQ6IGFuaW1hdGlvbi50YXJnZXQuaWQsXG4gICAgICAgICAgICBwcm9wZXJ0eTogYW5pbWF0aW9uLnByb3BlcnR5LFxuICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbi52YWx1ZSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiBhbmltYXRpb24uZHVyYXRpb24sXG4gICAgICAgICAgICBkZWxheTogYW5pbWF0aW9uLmRlbGF5LFxuICAgICAgICAgICAgaXRlcmF0aW9uczogYW5pbWF0aW9uLml0ZXJhdGlvbnMsXG4gICAgICAgICAgICBjdXJ2ZTogYW5pbWF0aW9uLmN1cnZlXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEFuaW1hdGlvbkJhc2U7XG59KCkpO1xuZXhwb3J0cy5BbmltYXRpb25CYXNlID0gQW5pbWF0aW9uQmFzZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFuaW1hdGlvbi1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBhbmltYXRpb25fY29tbW9uXzEgPSByZXF1aXJlKFwiLi9hbmltYXRpb24tY29tbW9uXCIpO1xudmFyIHN0eWxlX3Byb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9zdHlsaW5nL3N0eWxlLXByb3BlcnRpZXNcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtXCIpO1xudmFyIGxhenlfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy9sYXp5XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vYW5pbWF0aW9uLWNvbW1vblwiKSk7XG52YXIgYXJnYkV2YWx1YXRvcjtcbmZ1bmN0aW9uIGVuc3VyZUFyZ2JFdmFsdWF0b3IoKSB7XG4gICAgaWYgKCFhcmdiRXZhbHVhdG9yKSB7XG4gICAgICAgIGFyZ2JFdmFsdWF0b3IgPSBuZXcgYW5kcm9pZC5hbmltYXRpb24uQXJnYkV2YWx1YXRvcigpO1xuICAgIH1cbn1cbnZhciBlYXNlSW4gPSBsYXp5XzEuZGVmYXVsdChmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgYW5kcm9pZC52aWV3LmFuaW1hdGlvbi5BY2NlbGVyYXRlSW50ZXJwb2xhdG9yKDEpOyB9KTtcbnZhciBlYXNlT3V0ID0gbGF6eV8xLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IGFuZHJvaWQudmlldy5hbmltYXRpb24uRGVjZWxlcmF0ZUludGVycG9sYXRvcigxKTsgfSk7XG52YXIgZWFzZUluT3V0ID0gbGF6eV8xLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IGFuZHJvaWQudmlldy5hbmltYXRpb24uQWNjZWxlcmF0ZURlY2VsZXJhdGVJbnRlcnBvbGF0b3IoKTsgfSk7XG52YXIgbGluZWFyID0gbGF6eV8xLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IGFuZHJvaWQudmlldy5hbmltYXRpb24uTGluZWFySW50ZXJwb2xhdG9yKCk7IH0pO1xudmFyIGJvdW5jZSA9IGxhenlfMS5kZWZhdWx0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBhbmRyb2lkLnZpZXcuYW5pbWF0aW9uLkJvdW5jZUludGVycG9sYXRvcigpOyB9KTtcbnZhciBrZXlQcmVmaXggPSBcInVpLmFuaW1hdGlvbi5cIjtcbnZhciBwcm9wZXJ0eUtleXMgPSB7fTtcbnByb3BlcnR5S2V5c1thbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5iYWNrZ3JvdW5kQ29sb3JdID0gU3ltYm9sKGtleVByZWZpeCArIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLmJhY2tncm91bmRDb2xvcik7XG5wcm9wZXJ0eUtleXNbYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMub3BhY2l0eV0gPSBTeW1ib2woa2V5UHJlZml4ICsgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMub3BhY2l0eSk7XG5wcm9wZXJ0eUtleXNbYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMucm90YXRlXSA9IFN5bWJvbChrZXlQcmVmaXggKyBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5yb3RhdGUpO1xucHJvcGVydHlLZXlzW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnNjYWxlXSA9IFN5bWJvbChrZXlQcmVmaXggKyBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5zY2FsZSk7XG5wcm9wZXJ0eUtleXNbYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMudHJhbnNsYXRlXSA9IFN5bWJvbChrZXlQcmVmaXggKyBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGUpO1xucHJvcGVydHlLZXlzW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLmhlaWdodF0gPSBTeW1ib2woa2V5UHJlZml4ICsgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuaGVpZ2h0KTtcbnByb3BlcnR5S2V5c1thbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy53aWR0aF0gPSBTeW1ib2woa2V5UHJlZml4ICsgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMud2lkdGgpO1xuZnVuY3Rpb24gX3Jlc29sdmVBbmltYXRpb25DdXJ2ZShjdXJ2ZSkge1xuICAgIHN3aXRjaCAoY3VydmUpIHtcbiAgICAgICAgY2FzZSBcImVhc2VJblwiOlxuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiQW5pbWF0aW9uIGN1cnZlIHJlc29sdmVkIHRvIGFuZHJvaWQudmlldy5hbmltYXRpb24uQWNjZWxlcmF0ZUludGVycG9sYXRvcigxKS5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGVhc2VJbigpO1xuICAgICAgICBjYXNlIFwiZWFzZU91dFwiOlxuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiQW5pbWF0aW9uIGN1cnZlIHJlc29sdmVkIHRvIGFuZHJvaWQudmlldy5hbmltYXRpb24uRGVjZWxlcmF0ZUludGVycG9sYXRvcigxKS5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGVhc2VPdXQoKTtcbiAgICAgICAgY2FzZSBcImVhc2VJbk91dFwiOlxuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiQW5pbWF0aW9uIGN1cnZlIHJlc29sdmVkIHRvIGFuZHJvaWQudmlldy5hbmltYXRpb24uQWNjZWxlcmF0ZURlY2VsZXJhdGVJbnRlcnBvbGF0b3IoKS5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGVhc2VJbk91dCgpO1xuICAgICAgICBjYXNlIFwibGluZWFyXCI6XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJBbmltYXRpb24gY3VydmUgcmVzb2x2ZWQgdG8gYW5kcm9pZC52aWV3LmFuaW1hdGlvbi5MaW5lYXJJbnRlcnBvbGF0b3IoKS5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGxpbmVhcigpO1xuICAgICAgICBjYXNlIFwic3ByaW5nXCI6XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJBbmltYXRpb24gY3VydmUgcmVzb2x2ZWQgdG8gYW5kcm9pZC52aWV3LmFuaW1hdGlvbi5Cb3VuY2VJbnRlcnBvbGF0b3IoKS5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGJvdW5jZSgpO1xuICAgICAgICBjYXNlIFwiZWFzZVwiOlxuICAgICAgICAgICAgcmV0dXJuIGFuZHJvaWR4LmNvcmUudmlldy5hbmltYXRpb24uUGF0aEludGVycG9sYXRvckNvbXBhdC5jcmVhdGUoMC4yNSwgMC4xLCAwLjI1LCAxLjApO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiQW5pbWF0aW9uIGN1cnZlIHJlc29sdmVkIHRvIG9yaWdpbmFsOiBcIiArIGN1cnZlLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY3VydmUgaW5zdGFuY2VvZiBhbmltYXRpb25fY29tbW9uXzEuQ3ViaWNCZXppZXJBbmltYXRpb25DdXJ2ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhbmRyb2lkeC5jb3JlLnZpZXcuYW5pbWF0aW9uLlBhdGhJbnRlcnBvbGF0b3JDb21wYXQuY3JlYXRlKGN1cnZlLngxLCBjdXJ2ZS55MSwgY3VydmUueDIsIGN1cnZlLnkyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGN1cnZlICYmIGN1cnZlLmdldEludGVycG9sYXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3VydmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjdXJ2ZSBpbnN0YW5jZW9mIGFuZHJvaWQudmlldy5hbmltYXRpb24uTGluZWFySW50ZXJwb2xhdG9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnZlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhbmltYXRpb24gY3VydmU6IFwiICsgY3VydmUpO1xuICAgICAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMuX3Jlc29sdmVBbmltYXRpb25DdXJ2ZSA9IF9yZXNvbHZlQW5pbWF0aW9uQ3VydmU7XG52YXIgQW5pbWF0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQW5pbWF0aW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFuaW1hdGlvbihhbmltYXRpb25EZWZpbml0aW9ucywgcGxheVNlcXVlbnRpYWxseSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBhbmltYXRpb25EZWZpbml0aW9ucywgcGxheVNlcXVlbnRpYWxseSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3Jlc2V0T25GaW5pc2ggPSB0cnVlO1xuICAgICAgICBfdGhpcy5fdmFsdWVTb3VyY2UgPSBcImFuaW1hdGlvblwiO1xuICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbnMubGVuZ3RoID4gMCAmJiBhbmltYXRpb25EZWZpbml0aW9uc1swXS52YWx1ZVNvdXJjZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBfdGhpcy5fdmFsdWVTb3VyY2UgPSBhbmltYXRpb25EZWZpbml0aW9uc1swXS52YWx1ZVNvdXJjZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGhhdCA9IG5ldyBXZWFrUmVmKF90aGlzKTtcbiAgICAgICAgX3RoaXMuX2FuaW1hdG9yTGlzdGVuZXIgPSBuZXcgYW5kcm9pZC5hbmltYXRpb24uQW5pbWF0b3IuQW5pbWF0b3JMaXN0ZW5lcih7XG4gICAgICAgICAgICBvbkFuaW1hdGlvblN0YXJ0OiBmdW5jdGlvbiAoYW5pbWF0b3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiTWFpbkFuaW1hdG9yTGlzdGVuZXIub25BbmRyb2lkQW5pbWF0aW9uU3RhcnQoXCIgKyBhbmltYXRvciArIFwiKVwiLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uQW5pbWF0aW9uUmVwZWF0OiBmdW5jdGlvbiAoYW5pbWF0b3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiTWFpbkFuaW1hdG9yTGlzdGVuZXIub25BbmltYXRpb25SZXBlYXQoXCIgKyBhbmltYXRvciArIFwiKVwiLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uQW5pbWF0aW9uRW5kOiBmdW5jdGlvbiAoYW5pbWF0b3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiTWFpbkFuaW1hdG9yTGlzdGVuZXIub25BbmltYXRpb25FbmQoXCIgKyBhbmltYXRvciArIFwiKVwiLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciB0aGlzUmVmID0gdGhhdC5nZXQoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpc1JlZikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzUmVmLl9vbkFuZHJvaWRBbmltYXRpb25FbmQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25BbmltYXRpb25DYW5jZWw6IGZ1bmN0aW9uIChhbmltYXRvcikge1xuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJNYWluQW5pbWF0b3JMaXN0ZW5lci5vbkFuaW1hdGlvbkNhbmNlbChcIiArIGFuaW1hdG9yICsgXCIpXCIsIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHRoaXNSZWYgPSB0aGF0LmdldCgpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzUmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNSZWYuX29uQW5kcm9pZEFuaW1hdGlvbkNhbmNlbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgQW5pbWF0aW9uLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24gKHJlc2V0T25GaW5pc2gpIHtcbiAgICAgICAgaWYgKHJlc2V0T25GaW5pc2ggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5fcmVzZXRPbkZpbmlzaCA9IHJlc2V0T25GaW5pc2g7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXNQbGF5aW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVqZWN0QWxyZWFkeVBsYXlpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fYW5pbWF0b3JTZXQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wbGF5KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYW5pbWF0b3JzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMuX3Byb3BlcnR5VXBkYXRlQ2FsbGJhY2tzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMuX3Byb3BlcnR5UmVzZXRDYWxsYmFja3MgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdGhpcy5fcHJvcGVydHlBbmltYXRpb25zLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZUFuaW1hdG9ycyh0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbnNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX25hdGl2ZUFuaW1hdG9yc0FycmF5ID0gQXJyYXkuY3JlYXRlKGFuZHJvaWQuYW5pbWF0aW9uLkFuaW1hdG9yLCB0aGlzLl9hbmltYXRvcnMubGVuZ3RoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8yID0gdGhpcy5fYW5pbWF0b3JzLmxlbmd0aDsgaSA8IGxlbmd0aF8yOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuX25hdGl2ZUFuaW1hdG9yc0FycmF5W2ldID0gdGhpcy5fYW5pbWF0b3JzW2ldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FuaW1hdG9yU2V0ID0gbmV3IGFuZHJvaWQuYW5pbWF0aW9uLkFuaW1hdG9yU2V0KCk7XG4gICAgICAgIHRoaXMuX2FuaW1hdG9yU2V0LmFkZExpc3RlbmVyKHRoaXMuX2FuaW1hdG9yTGlzdGVuZXIpO1xuICAgICAgICByZXR1cm4gdGhpcy5fcGxheSgpO1xuICAgIH07XG4gICAgQW5pbWF0aW9uLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1BsYXlpbmcpIHtcbiAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiQW5pbWF0aW9uIGlzIG5vdCBjdXJyZW50bHkgcGxheWluZy5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24sIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVR5cGUud2Fybik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJDYW5jZWxsaW5nIEFuaW1hdG9yU2V0LlwiLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgIHRoaXMuX2FuaW1hdG9yU2V0LmNhbmNlbCgpO1xuICAgIH07XG4gICAgQW5pbWF0aW9uLnByb3RvdHlwZS5fcmVzb2x2ZUFuaW1hdGlvbkN1cnZlID0gZnVuY3Rpb24gKGN1cnZlKSB7XG4gICAgICAgIHJldHVybiBfcmVzb2x2ZUFuaW1hdGlvbkN1cnZlKGN1cnZlKTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbi5wcm90b3R5cGUuX3BsYXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhbmltYXRpb25GaW5pc2hlZFByb21pc2UgPSBfc3VwZXIucHJvdG90eXBlLnBsYXkuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuZGV2aWNlLnNka1ZlcnNpb24gPD0gXCIyM1wiKSB7XG4gICAgICAgICAgICB0aGlzLl9hbmltYXRvclNldCA9IG5ldyBhbmRyb2lkLmFuaW1hdGlvbi5BbmltYXRvclNldCgpO1xuICAgICAgICAgICAgdGhpcy5fYW5pbWF0b3JTZXQuYWRkTGlzdGVuZXIodGhpcy5fYW5pbWF0b3JMaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2FuaW1hdG9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcGxheVNlcXVlbnRpYWxseSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FuaW1hdG9yU2V0LnBsYXlTZXF1ZW50aWFsbHkodGhpcy5fbmF0aXZlQW5pbWF0b3JzQXJyYXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYW5pbWF0b3JTZXQucGxheVRvZ2V0aGVyKHRoaXMuX25hdGl2ZUFuaW1hdG9yc0FycmF5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIlN0YXJ0aW5nIFwiICsgdGhpcy5fbmF0aXZlQW5pbWF0b3JzQXJyYXkubGVuZ3RoICsgXCIgYW5pbWF0aW9ucyBcIiArICh0aGlzLl9wbGF5U2VxdWVudGlhbGx5ID8gXCJzZXF1ZW50aWFsbHkuXCIgOiBcInRvZ2V0aGVyLlwiKSwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FuaW1hdG9yU2V0LnNldHVwU3RhcnRWYWx1ZXMoKTtcbiAgICAgICAgdGhpcy5fYW5pbWF0b3JTZXQuc3RhcnQoKTtcbiAgICAgICAgcmV0dXJuIGFuaW1hdGlvbkZpbmlzaGVkUHJvbWlzZTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbi5wcm90b3R5cGUuX29uQW5kcm9pZEFuaW1hdGlvbkVuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUGxheWluZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Byb3BlcnR5VXBkYXRlQ2FsbGJhY2tzLmZvckVhY2goZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHYoKTsgfSk7XG4gICAgICAgIHRoaXMuX3Jlc29sdmVBbmltYXRpb25GaW5pc2hlZFByb21pc2UoKTtcbiAgICAgICAgaWYgKHRoaXMuX3Jlc2V0T25GaW5pc2ggJiYgdGhpcy5fdGFyZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLl90YXJnZXQuX3JlbW92ZUFuaW1hdGlvbih0aGlzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQW5pbWF0aW9uLnByb3RvdHlwZS5fb25BbmRyb2lkQW5pbWF0aW9uQ2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2tzLmZvckVhY2goZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHYoKTsgfSk7XG4gICAgICAgIHRoaXMuX3JlamVjdEFuaW1hdGlvbkZpbmlzaGVkUHJvbWlzZSgpO1xuICAgICAgICBpZiAodGhpcy5fdGFyZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLl90YXJnZXQuX3JlbW92ZUFuaW1hdGlvbih0aGlzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQW5pbWF0aW9uLnByb3RvdHlwZS5fY3JlYXRlQW5pbWF0b3JzID0gZnVuY3Rpb24gKHByb3BlcnR5QW5pbWF0aW9uKSB7XG4gICAgICAgIGlmICghcHJvcGVydHlBbmltYXRpb24udGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIkNyZWF0aW5nIE9iamVjdEFuaW1hdG9yKHMpIGZvciBhbmltYXRpb246IFwiICsgQW5pbWF0aW9uLl9nZXRBbmltYXRpb25JbmZvKHByb3BlcnR5QW5pbWF0aW9uKSArIFwiLi4uXCIsIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJvcGVydHlBbmltYXRpb24udGFyZ2V0ID09PSBudWxsIHx8IHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBbmltYXRpb24gdGFyZ2V0IGNhbm5vdCBiZSBudWxsIG9yIHVuZGVmaW5lZDsgcHJvcGVydHk6IFwiICsgcHJvcGVydHlBbmltYXRpb24ucHJvcGVydHkgKyBcIjsgdmFsdWU6IFwiICsgcHJvcGVydHlBbmltYXRpb24udmFsdWUgKyBcIjtcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLnByb3BlcnR5ID09PSBudWxsIHx8IHByb3BlcnR5QW5pbWF0aW9uLnByb3BlcnR5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFuaW1hdGlvbiBwcm9wZXJ0eSBjYW5ub3QgYmUgbnVsbCBvciB1bmRlZmluZWQ7IHRhcmdldDogXCIgKyBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQgKyBcIjsgdmFsdWU6IFwiICsgcHJvcGVydHlBbmltYXRpb24udmFsdWUgKyBcIjtcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlID09PSBudWxsIHx8IHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFuaW1hdGlvbiB2YWx1ZSBjYW5ub3QgYmUgbnVsbCBvciB1bmRlZmluZWQ7IHRhcmdldDogXCIgKyBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQgKyBcIjsgcHJvcGVydHk6IFwiICsgcHJvcGVydHlBbmltYXRpb24ucHJvcGVydHkgKyBcIjtcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gcHJvcGVydHlBbmltYXRpb24udGFyZ2V0O1xuICAgICAgICB2YXIgbmF0aXZlQXJyYXk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gcHJvcGVydHlBbmltYXRpb24udGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBhbmltYXRvcnMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdmFyIHByb3BlcnR5VXBkYXRlQ2FsbGJhY2tzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHZhciBwcm9wZXJ0eVJlc2V0Q2FsbGJhY2tzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHZhciBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgdmFyIG9yaWdpbmFsVmFsdWUyO1xuICAgICAgICB2YXIgZGVuc2l0eSA9IHV0aWxzXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgIHZhciB4eU9iamVjdEFuaW1hdG9ycztcbiAgICAgICAgdmFyIGFuaW1hdG9yU2V0O1xuICAgICAgICB2YXIga2V5ID0gcHJvcGVydHlLZXlzW3Byb3BlcnR5QW5pbWF0aW9uLnByb3BlcnR5XTtcbiAgICAgICAgaWYgKGtleSkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0W2tleV0gPSBwcm9wZXJ0eUFuaW1hdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjaGVja0FuaW1hdGlvbihjYikge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAocHJvcGVydHlBbmltYXRpb24udGFyZ2V0W2tleV0gPT09IHByb3BlcnR5QW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXRba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZXRMb2NhbCA9IHRoaXMuX3ZhbHVlU291cmNlID09PSBcImFuaW1hdGlvblwiO1xuICAgICAgICB2YXIgc3R5bGUgPSBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGU7XG4gICAgICAgIHN3aXRjaCAocHJvcGVydHlBbmltYXRpb24ucHJvcGVydHkpIHtcbiAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMub3BhY2l0eTpcbiAgICAgICAgICAgICAgICBzdHlsZV9wcm9wZXJ0aWVzXzEub3BhY2l0eVByb3BlcnR5Ll9pbml0RGVmYXVsdE5hdGl2ZVZhbHVlKHN0eWxlKTtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFZhbHVlMSA9IG5hdGl2ZVZpZXcuZ2V0QWxwaGEoKTtcbiAgICAgICAgICAgICAgICBuYXRpdmVBcnJheSA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDEpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5WzBdID0gcHJvcGVydHlBbmltYXRpb24udmFsdWU7XG4gICAgICAgICAgICAgICAgcHJvcGVydHlVcGRhdGVDYWxsYmFja3MucHVzaChjaGVja0FuaW1hdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydHlBbmltYXRpb24udmFsdWU7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIHByb3BlcnR5UmVzZXRDYWxsYmFja3MucHVzaChjaGVja0FuaW1hdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXRMb2NhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkubmFtZV0gPSBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEub3BhY2l0eVByb3BlcnR5LmtleWZyYW1lXSA9IG9yaWdpbmFsVmFsdWUxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0W3N0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkuc2V0TmF0aXZlXShwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGUub3BhY2l0eSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JzLnB1c2goYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChuYXRpdmVWaWV3LCBcImFscGhhXCIsIG5hdGl2ZUFycmF5KSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLmJhY2tncm91bmRDb2xvcjpcbiAgICAgICAgICAgICAgICBzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuX2luaXREZWZhdWx0TmF0aXZlVmFsdWUoc3R5bGUpO1xuICAgICAgICAgICAgICAgIGVuc3VyZUFyZ2JFdmFsdWF0b3IoKTtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFZhbHVlMSA9IHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgICAgICAgICAgbmF0aXZlQXJyYXkgPSBBcnJheS5jcmVhdGUoamF2YS5sYW5nLk9iamVjdCwgMik7XG4gICAgICAgICAgICAgICAgbmF0aXZlQXJyYXlbMF0gPSBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuYmFja2dyb3VuZENvbG9yID8gamF2YS5sYW5nLkludGVnZXIudmFsdWVPZihwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuYmFja2dyb3VuZENvbG9yLmFyZ2IpIDogamF2YS5sYW5nLkludGVnZXIudmFsdWVPZigtMSk7XG4gICAgICAgICAgICAgICAgbmF0aXZlQXJyYXlbMV0gPSBqYXZhLmxhbmcuSW50ZWdlci52YWx1ZU9mKHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlLmFyZ2IpO1xuICAgICAgICAgICAgICAgIHZhciBhbmltYXRvciA9IGFuZHJvaWQuYW5pbWF0aW9uLlZhbHVlQW5pbWF0b3Iub2ZPYmplY3QoYXJnYkV2YWx1YXRvciwgbmF0aXZlQXJyYXkpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLmFkZFVwZGF0ZUxpc3RlbmVyKG5ldyBhbmRyb2lkLmFuaW1hdGlvbi5WYWx1ZUFuaW1hdG9yLkFuaW1hdG9yVXBkYXRlTGlzdGVuZXIoe1xuICAgICAgICAgICAgICAgICAgICBvbkFuaW1hdGlvblVwZGF0ZTogZnVuY3Rpb24gKGFuaW1hdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJnYiA9IGFuaW1hdG9yLmdldEFuaW1hdGVkVmFsdWUoKS5pbnRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkua2V5ZnJhbWVdID0gbmV3IGFuaW1hdGlvbl9jb21tb25fMS5Db2xvcihhcmdiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eVVwZGF0ZUNhbGxiYWNrcy5wdXNoKGNoZWNrQW5pbWF0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydHlBbmltYXRpb24udmFsdWU7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIHByb3BlcnR5UmVzZXRDYWxsYmFja3MucHVzaChjaGVja0FuaW1hdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXRMb2NhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5uYW1lXSA9IG9yaWdpbmFsVmFsdWUxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5rZXlmcmFtZV0gPSBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocHJvcGVydHlBbmltYXRpb24udGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQgJiYgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0W3N0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXRbc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0ocHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlLmJhY2tncm91bmRDb2xvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JzLnB1c2goYW5pbWF0b3IpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGU6XG4gICAgICAgICAgICAgICAgc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5faW5pdERlZmF1bHROYXRpdmVWYWx1ZShzdHlsZSk7XG4gICAgICAgICAgICAgICAgc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5faW5pdERlZmF1bHROYXRpdmVWYWx1ZShzdHlsZSk7XG4gICAgICAgICAgICAgICAgeHlPYmplY3RBbmltYXRvcnMgPSBBcnJheS5jcmVhdGUoYW5kcm9pZC5hbmltYXRpb24uQW5pbWF0b3IsIDIpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5ID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMSk7XG4gICAgICAgICAgICAgICAgbmF0aXZlQXJyYXlbMF0gPSBwcm9wZXJ0eUFuaW1hdGlvbi52YWx1ZS54ICogZGVuc2l0eTtcbiAgICAgICAgICAgICAgICB4eU9iamVjdEFuaW1hdG9yc1swXSA9IGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yLm9mRmxvYXQobmF0aXZlVmlldywgXCJ0cmFuc2xhdGlvblhcIiwgbmF0aXZlQXJyYXkpO1xuICAgICAgICAgICAgICAgIHh5T2JqZWN0QW5pbWF0b3JzWzBdLnNldFJlcGVhdENvdW50KEFuaW1hdGlvbi5fZ2V0QW5kcm9pZFJlcGVhdENvdW50KHByb3BlcnR5QW5pbWF0aW9uLml0ZXJhdGlvbnMpKTtcbiAgICAgICAgICAgICAgICBuYXRpdmVBcnJheSA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDEpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5WzBdID0gcHJvcGVydHlBbmltYXRpb24udmFsdWUueSAqIGRlbnNpdHk7XG4gICAgICAgICAgICAgICAgeHlPYmplY3RBbmltYXRvcnNbMV0gPSBhbmRyb2lkLmFuaW1hdGlvbi5PYmplY3RBbmltYXRvci5vZkZsb2F0KG5hdGl2ZVZpZXcsIFwidHJhbnNsYXRpb25ZXCIsIG5hdGl2ZUFycmF5KTtcbiAgICAgICAgICAgICAgICB4eU9iamVjdEFuaW1hdG9yc1sxXS5zZXRSZXBlYXRDb3VudChBbmltYXRpb24uX2dldEFuZHJvaWRSZXBlYXRDb3VudChwcm9wZXJ0eUFuaW1hdGlvbi5pdGVyYXRpb25zKSk7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxWYWx1ZTEgPSBuYXRpdmVWaWV3LmdldFRyYW5zbGF0aW9uWCgpIC8gZGVuc2l0eTtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFZhbHVlMiA9IG5hdGl2ZVZpZXcuZ2V0VHJhbnNsYXRpb25ZKCkgLyBkZW5zaXR5O1xuICAgICAgICAgICAgICAgIHByb3BlcnR5VXBkYXRlQ2FsbGJhY2tzLnB1c2goY2hlY2tBbmltYXRpb24oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlLng7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVZUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVZUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydHlBbmltYXRpb24udmFsdWUueTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgcHJvcGVydHlSZXNldENhbGxiYWNrcy5wdXNoKGNoZWNrQW5pbWF0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNldExvY2FsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5uYW1lXSA9IG9yaWdpbmFsVmFsdWUxO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVZUHJvcGVydHkubmFtZV0gPSBvcmlnaW5hbFZhbHVlMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5LmtleWZyYW1lXSA9IG9yaWdpbmFsVmFsdWUxO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVZUHJvcGVydHkua2V5ZnJhbWVdID0gb3JpZ2luYWxWYWx1ZTI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXRbc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5zZXROYXRpdmVdKHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZS50cmFuc2xhdGVYKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldFtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5LnNldE5hdGl2ZV0ocHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlLnRyYW5zbGF0ZVkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yU2V0ID0gbmV3IGFuZHJvaWQuYW5pbWF0aW9uLkFuaW1hdG9yU2V0KCk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JTZXQucGxheVRvZ2V0aGVyKHh5T2JqZWN0QW5pbWF0b3JzKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvclNldC5zZXR1cFN0YXJ0VmFsdWVzKCk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JzLnB1c2goYW5pbWF0b3JTZXQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5zY2FsZTpcbiAgICAgICAgICAgICAgICBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVYUHJvcGVydHkuX2luaXREZWZhdWx0TmF0aXZlVmFsdWUoc3R5bGUpO1xuICAgICAgICAgICAgICAgIHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5faW5pdERlZmF1bHROYXRpdmVWYWx1ZShzdHlsZSk7XG4gICAgICAgICAgICAgICAgeHlPYmplY3RBbmltYXRvcnMgPSBBcnJheS5jcmVhdGUoYW5kcm9pZC5hbmltYXRpb24uQW5pbWF0b3IsIDIpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5ID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMSk7XG4gICAgICAgICAgICAgICAgbmF0aXZlQXJyYXlbMF0gPSBwcm9wZXJ0eUFuaW1hdGlvbi52YWx1ZS54O1xuICAgICAgICAgICAgICAgIHh5T2JqZWN0QW5pbWF0b3JzWzBdID0gYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChuYXRpdmVWaWV3LCBcInNjYWxlWFwiLCBuYXRpdmVBcnJheSk7XG4gICAgICAgICAgICAgICAgeHlPYmplY3RBbmltYXRvcnNbMF0uc2V0UmVwZWF0Q291bnQoQW5pbWF0aW9uLl9nZXRBbmRyb2lkUmVwZWF0Q291bnQocHJvcGVydHlBbmltYXRpb24uaXRlcmF0aW9ucykpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5ID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMSk7XG4gICAgICAgICAgICAgICAgbmF0aXZlQXJyYXlbMF0gPSBwcm9wZXJ0eUFuaW1hdGlvbi52YWx1ZS55O1xuICAgICAgICAgICAgICAgIHh5T2JqZWN0QW5pbWF0b3JzWzFdID0gYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChuYXRpdmVWaWV3LCBcInNjYWxlWVwiLCBuYXRpdmVBcnJheSk7XG4gICAgICAgICAgICAgICAgeHlPYmplY3RBbmltYXRvcnNbMV0uc2V0UmVwZWF0Q291bnQoQW5pbWF0aW9uLl9nZXRBbmRyb2lkUmVwZWF0Q291bnQocHJvcGVydHlBbmltYXRpb24uaXRlcmF0aW9ucykpO1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsVmFsdWUxID0gbmF0aXZlVmlldy5nZXRTY2FsZVgoKTtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFZhbHVlMiA9IG5hdGl2ZVZpZXcuZ2V0U2NhbGVZKCk7XG4gICAgICAgICAgICAgICAgcHJvcGVydHlVcGRhdGVDYWxsYmFja3MucHVzaChjaGVja0FuaW1hdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlLng7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWVByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlLnk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIHByb3BlcnR5UmVzZXRDYWxsYmFja3MucHVzaChjaGVja0FuaW1hdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXRMb2NhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5uYW1lXSA9IG9yaWdpbmFsVmFsdWUxO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5uYW1lXSA9IG9yaWdpbmFsVmFsdWUyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkua2V5ZnJhbWVdID0gb3JpZ2luYWxWYWx1ZTI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXRbc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LnNldE5hdGl2ZV0ocHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlLnNjYWxlWCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXRbc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWVByb3BlcnR5LnNldE5hdGl2ZV0ocHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlLnNjYWxlWSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JTZXQgPSBuZXcgYW5kcm9pZC5hbmltYXRpb24uQW5pbWF0b3JTZXQoKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvclNldC5wbGF5VG9nZXRoZXIoeHlPYmplY3RBbmltYXRvcnMpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yU2V0LnNldHVwU3RhcnRWYWx1ZXMoKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvcnMucHVzaChhbmltYXRvclNldCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnJvdGF0ZTpcbiAgICAgICAgICAgICAgICBzdHlsZV9wcm9wZXJ0aWVzXzEucm90YXRlUHJvcGVydHkuX2luaXREZWZhdWx0TmF0aXZlVmFsdWUoc3R5bGUpO1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsVmFsdWUxID0gbmF0aXZlVmlldy5nZXRSb3RhdGlvbigpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5ID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMSk7XG4gICAgICAgICAgICAgICAgbmF0aXZlQXJyYXlbMF0gPSBwcm9wZXJ0eUFuaW1hdGlvbi52YWx1ZTtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eVVwZGF0ZUNhbGxiYWNrcy5wdXNoKGNoZWNrQW5pbWF0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnJvdGF0ZVByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEucm90YXRlUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydHlBbmltYXRpb24udmFsdWU7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIHByb3BlcnR5UmVzZXRDYWxsYmFja3MucHVzaChjaGVja0FuaW1hdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXRMb2NhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5yb3RhdGVQcm9wZXJ0eS5uYW1lXSA9IG9yaWdpbmFsVmFsdWUxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5yb3RhdGVQcm9wZXJ0eS5rZXlmcmFtZV0gPSBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocHJvcGVydHlBbmltYXRpb24udGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldFtzdHlsZV9wcm9wZXJ0aWVzXzEucm90YXRlUHJvcGVydHkuc2V0TmF0aXZlXShwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGUucm90YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvcnMucHVzaChhbmRyb2lkLmFuaW1hdGlvbi5PYmplY3RBbmltYXRvci5vZkZsb2F0KG5hdGl2ZVZpZXcsIFwicm90YXRpb25cIiwgbmF0aXZlQXJyYXkpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMud2lkdGg6XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLmhlaWdodDoge1xuICAgICAgICAgICAgICAgIHZhciBpc1ZlcnRpY2FsID0gcHJvcGVydHlBbmltYXRpb24ucHJvcGVydHkgPT09IFwiaGVpZ2h0XCI7XG4gICAgICAgICAgICAgICAgdmFyIGV4dGVudFByb3BlcnR5XzEgPSBpc1ZlcnRpY2FsID8gc3R5bGVfcHJvcGVydGllc18xLmhlaWdodFByb3BlcnR5IDogc3R5bGVfcHJvcGVydGllc18xLndpZHRoUHJvcGVydHk7XG4gICAgICAgICAgICAgICAgZXh0ZW50UHJvcGVydHlfMS5faW5pdERlZmF1bHROYXRpdmVWYWx1ZShzdHlsZSk7XG4gICAgICAgICAgICAgICAgbmF0aXZlQXJyYXkgPSBBcnJheS5jcmVhdGUoXCJmbG9hdFwiLCAyKTtcbiAgICAgICAgICAgICAgICB2YXIgdG9WYWx1ZSA9IHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnRfMSA9IHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgaWYgKCFwYXJlbnRfMSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjYW5ub3QgYW5pbWF0ZSBcIiArIHByb3BlcnR5QW5pbWF0aW9uLnByb3BlcnR5ICsgXCIgb24gcm9vdCB2aWV3XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50RXh0ZW50ID0gaXNWZXJ0aWNhbCA/IHBhcmVudF8xLmdldE1lYXN1cmVkSGVpZ2h0KCkgOiBwYXJlbnRfMS5nZXRNZWFzdXJlZFdpZHRoKCk7XG4gICAgICAgICAgICAgICAgdG9WYWx1ZSA9IHN0eWxlX3Byb3BlcnRpZXNfMS5QZXJjZW50TGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHRvVmFsdWUsIHBhcmVudEV4dGVudCwgcGFyZW50RXh0ZW50KSAvIHBsYXRmb3JtXzEuc2NyZWVuLm1haW5TY3JlZW4uc2NhbGU7XG4gICAgICAgICAgICAgICAgdmFyIG5hdGl2ZUhlaWdodCA9IGlzVmVydGljYWwgPyBuYXRpdmVWaWV3LmdldEhlaWdodCgpIDogbmF0aXZlVmlldy5nZXRXaWR0aCgpO1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRTdHlsZV8xID0gc2V0TG9jYWwgPyBleHRlbnRQcm9wZXJ0eV8xLm5hbWUgOiBleHRlbnRQcm9wZXJ0eV8xLmtleWZyYW1lO1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsVmFsdWUxID0gbmF0aXZlSGVpZ2h0IC8gcGxhdGZvcm1fMS5zY3JlZW4ubWFpblNjcmVlbi5zY2FsZTtcbiAgICAgICAgICAgICAgICBuYXRpdmVBcnJheVswXSA9IG9yaWdpbmFsVmFsdWUxO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5WzFdID0gdG9WYWx1ZTtcbiAgICAgICAgICAgICAgICB2YXIgZXh0ZW50QW5pbWF0b3IgPSBhbmRyb2lkLmFuaW1hdGlvbi5WYWx1ZUFuaW1hdG9yLm9mRmxvYXQobmF0aXZlQXJyYXkpO1xuICAgICAgICAgICAgICAgIGV4dGVudEFuaW1hdG9yLmFkZFVwZGF0ZUxpc3RlbmVyKG5ldyBhbmRyb2lkLmFuaW1hdGlvbi5WYWx1ZUFuaW1hdG9yLkFuaW1hdG9yVXBkYXRlTGlzdGVuZXIoe1xuICAgICAgICAgICAgICAgICAgICBvbkFuaW1hdGlvblVwZGF0ZTogZnVuY3Rpb24gKGFuaW1hdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJnYiA9IGFuaW1hdG9yLmdldEFuaW1hdGVkVmFsdWUoKS5mbG9hdFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBleHRlbnRQcm9wZXJ0eV8xLm5hbWUgOiBleHRlbnRQcm9wZXJ0eV8xLmtleWZyYW1lXSA9IGFyZ2I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgcHJvcGVydHlVcGRhdGVDYWxsYmFja3MucHVzaChjaGVja0FuaW1hdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVt0YXJnZXRTdHlsZV8xXSA9IHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eVJlc2V0Q2FsbGJhY2tzLnB1c2goY2hlY2tBbmltYXRpb24oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbdGFyZ2V0U3R5bGVfMV0gPSBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2V0dGVyID0gcHJvcGVydHlBbmltYXRpb24udGFyZ2V0W2V4dGVudFByb3BlcnR5XzEuc2V0TmF0aXZlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRlcihwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbcHJvcGVydHlBbmltYXRpb24ucHJvcGVydHldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvcnMucHVzaChleHRlbnRBbmltYXRvcik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFuaW1hdGluZyBwcm9wZXJ0eSAnXCIgKyBwcm9wZXJ0eUFuaW1hdGlvbi5wcm9wZXJ0eSArIFwiJyBpcyB1bnN1cHBvcnRlZFwiKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzMgPSBhbmltYXRvcnMubGVuZ3RoOyBpIDwgbGVuZ3RoXzM7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLmR1cmF0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRvcnNbaV0uc2V0RHVyYXRpb24ocHJvcGVydHlBbmltYXRpb24uZHVyYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLmRlbGF5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRvcnNbaV0uc2V0U3RhcnREZWxheShwcm9wZXJ0eUFuaW1hdGlvbi5kZWxheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocHJvcGVydHlBbmltYXRpb24uaXRlcmF0aW9ucyAhPT0gdW5kZWZpbmVkICYmIGFuaW1hdG9yc1tpXSBpbnN0YW5jZW9mIGFuZHJvaWQuYW5pbWF0aW9uLlZhbHVlQW5pbWF0b3IpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRvcnNbaV0uc2V0UmVwZWF0Q291bnQoQW5pbWF0aW9uLl9nZXRBbmRyb2lkUmVwZWF0Q291bnQocHJvcGVydHlBbmltYXRpb24uaXRlcmF0aW9ucykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLmN1cnZlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRvcnNbaV0uc2V0SW50ZXJwb2xhdG9yKHByb3BlcnR5QW5pbWF0aW9uLmN1cnZlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIkFuaW1hdG9yIGNyZWF0ZWQ6IFwiICsgYW5pbWF0b3JzW2ldLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYW5pbWF0b3JzID0gdGhpcy5fYW5pbWF0b3JzLmNvbmNhdChhbmltYXRvcnMpO1xuICAgICAgICB0aGlzLl9wcm9wZXJ0eVVwZGF0ZUNhbGxiYWNrcyA9IHRoaXMuX3Byb3BlcnR5VXBkYXRlQ2FsbGJhY2tzLmNvbmNhdChwcm9wZXJ0eVVwZGF0ZUNhbGxiYWNrcyk7XG4gICAgICAgIHRoaXMuX3Byb3BlcnR5UmVzZXRDYWxsYmFja3MgPSB0aGlzLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2tzLmNvbmNhdChwcm9wZXJ0eVJlc2V0Q2FsbGJhY2tzKTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbi5fZ2V0QW5kcm9pZFJlcGVhdENvdW50ID0gZnVuY3Rpb24gKGl0ZXJhdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIChpdGVyYXRpb25zID09PSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpID8gYW5kcm9pZC52aWV3LmFuaW1hdGlvbi5BbmltYXRpb24uSU5GSU5JVEUgOiBpdGVyYXRpb25zIC0gMTtcbiAgICB9O1xuICAgIHJldHVybiBBbmltYXRpb247XG59KGFuaW1hdGlvbl9jb21tb25fMS5BbmltYXRpb25CYXNlKSk7XG5leHBvcnRzLkFuaW1hdGlvbiA9IEFuaW1hdGlvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFuaW1hdGlvbi5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlbnVtc18xID0gcmVxdWlyZShcIi4uL2VudW1zXCIpO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vdHJhY2VcIik7XG52YXIgcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL2NvcmUvcHJvcGVydGllc1wiKTtcbnZhciBhbmltYXRpb25fMSA9IHJlcXVpcmUoXCIuL2FuaW1hdGlvblwiKTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIEtleWZyYW1lcyA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gS2V5ZnJhbWVzKCkge1xuICAgIH1cbiAgICByZXR1cm4gS2V5ZnJhbWVzO1xufSgpKTtcbmV4cG9ydHMuS2V5ZnJhbWVzID0gS2V5ZnJhbWVzO1xudmFyIFVucGFyc2VkS2V5ZnJhbWUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFVucGFyc2VkS2V5ZnJhbWUoKSB7XG4gICAgfVxuICAgIHJldHVybiBVbnBhcnNlZEtleWZyYW1lO1xufSgpKTtcbmV4cG9ydHMuVW5wYXJzZWRLZXlmcmFtZSA9IFVucGFyc2VkS2V5ZnJhbWU7XG52YXIgS2V5ZnJhbWVEZWNsYXJhdGlvbiA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gS2V5ZnJhbWVEZWNsYXJhdGlvbigpIHtcbiAgICB9XG4gICAgcmV0dXJuIEtleWZyYW1lRGVjbGFyYXRpb247XG59KCkpO1xuZXhwb3J0cy5LZXlmcmFtZURlY2xhcmF0aW9uID0gS2V5ZnJhbWVEZWNsYXJhdGlvbjtcbnZhciBLZXlmcmFtZUluZm8gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEtleWZyYW1lSW5mbygpIHtcbiAgICAgICAgdGhpcy5jdXJ2ZSA9IGVudW1zXzEuQW5pbWF0aW9uQ3VydmUuZWFzZTtcbiAgICB9XG4gICAgcmV0dXJuIEtleWZyYW1lSW5mbztcbn0oKSk7XG5leHBvcnRzLktleWZyYW1lSW5mbyA9IEtleWZyYW1lSW5mbztcbnZhciBLZXlmcmFtZUFuaW1hdGlvbkluZm8gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEtleWZyYW1lQW5pbWF0aW9uSW5mbygpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gXCJcIjtcbiAgICAgICAgdGhpcy5kdXJhdGlvbiA9IDAuMztcbiAgICAgICAgdGhpcy5kZWxheSA9IDA7XG4gICAgICAgIHRoaXMuaXRlcmF0aW9ucyA9IDE7XG4gICAgICAgIHRoaXMuY3VydmUgPSBcImVhc2VcIjtcbiAgICAgICAgdGhpcy5pc0ZvcndhcmRzID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNSZXZlcnNlID0gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBLZXlmcmFtZUFuaW1hdGlvbkluZm87XG59KCkpO1xuZXhwb3J0cy5LZXlmcmFtZUFuaW1hdGlvbkluZm8gPSBLZXlmcmFtZUFuaW1hdGlvbkluZm87XG52YXIgS2V5ZnJhbWVBbmltYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEtleWZyYW1lQW5pbWF0aW9uKCkge1xuICAgICAgICB0aGlzLmRlbGF5ID0gMDtcbiAgICAgICAgdGhpcy5pdGVyYXRpb25zID0gMTtcbiAgICB9XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ua2V5ZnJhbWVBbmltYXRpb25Gcm9tSW5mbyA9IGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSBpbmZvLmtleWZyYW1lcy5sZW5ndGg7XG4gICAgICAgIHZhciBhbmltYXRpb25zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHZhciBzdGFydER1cmF0aW9uID0gMDtcbiAgICAgICAgaWYgKGluZm8uaXNSZXZlcnNlKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpbmRleF8xID0gbGVuZ3RoIC0gMTsgaW5kZXhfMSA+PSAwOyBpbmRleF8xLS0pIHtcbiAgICAgICAgICAgICAgICB2YXIga2V5ZnJhbWUgPSBpbmZvLmtleWZyYW1lc1tpbmRleF8xXTtcbiAgICAgICAgICAgICAgICBzdGFydER1cmF0aW9uID0gS2V5ZnJhbWVBbmltYXRpb24ucGFyc2VLZXlmcmFtZShpbmZvLCBrZXlmcmFtZSwgYW5pbWF0aW9ucywgc3RhcnREdXJhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpbmRleF8yID0gMDsgaW5kZXhfMiA8IGxlbmd0aDsgaW5kZXhfMisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGtleWZyYW1lID0gaW5mby5rZXlmcmFtZXNbaW5kZXhfMl07XG4gICAgICAgICAgICAgICAgc3RhcnREdXJhdGlvbiA9IEtleWZyYW1lQW5pbWF0aW9uLnBhcnNlS2V5ZnJhbWUoaW5mbywga2V5ZnJhbWUsIGFuaW1hdGlvbnMsIHN0YXJ0RHVyYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaW5kZXhfMyA9IGxlbmd0aCAtIDE7IGluZGV4XzMgPiAwOyBpbmRleF8zLS0pIHtcbiAgICAgICAgICAgICAgICB2YXIgYTEgPSBhbmltYXRpb25zW2luZGV4XzNdO1xuICAgICAgICAgICAgICAgIHZhciBhMiA9IGFuaW1hdGlvbnNbaW5kZXhfMyAtIDFdO1xuICAgICAgICAgICAgICAgIGlmIChhMltcImN1cnZlXCJdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYTFbXCJjdXJ2ZVwiXSA9IGEyW1wiY3VydmVcIl07XG4gICAgICAgICAgICAgICAgICAgIGEyW1wiY3VydmVcIl0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGFuaW1hdGlvbnMubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiBhW1wiY3VydmVcIl0gPyBhIDogT2JqZWN0LmFzc2lnbihhLCB7IGN1cnZlOiBpbmZvLmN1cnZlIH0pOyB9KTtcbiAgICAgICAgdmFyIGFuaW1hdGlvbiA9IG5ldyBLZXlmcmFtZUFuaW1hdGlvbigpO1xuICAgICAgICBhbmltYXRpb24uZGVsYXkgPSBpbmZvLmRlbGF5O1xuICAgICAgICBhbmltYXRpb24uaXRlcmF0aW9ucyA9IGluZm8uaXRlcmF0aW9ucztcbiAgICAgICAgYW5pbWF0aW9uLmFuaW1hdGlvbnMgPSBhbmltYXRpb25zO1xuICAgICAgICBhbmltYXRpb24uX2lzRm9yd2FyZHMgPSBpbmZvLmlzRm9yd2FyZHM7XG4gICAgICAgIHJldHVybiBhbmltYXRpb247XG4gICAgfTtcbiAgICBLZXlmcmFtZUFuaW1hdGlvbi5wYXJzZUtleWZyYW1lID0gZnVuY3Rpb24gKGluZm8sIGtleWZyYW1lLCBhbmltYXRpb25zLCBzdGFydER1cmF0aW9uKSB7XG4gICAgICAgIHZhciBhbmltYXRpb24gPSB7fTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGtleWZyYW1lLmRlY2xhcmF0aW9uczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBkZWNsYXJhdGlvbiA9IF9hW19pXTtcbiAgICAgICAgICAgIGFuaW1hdGlvbltkZWNsYXJhdGlvbi5wcm9wZXJ0eV0gPSBkZWNsYXJhdGlvbi52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZHVyYXRpb24gPSBrZXlmcmFtZS5kdXJhdGlvbjtcbiAgICAgICAgaWYgKGR1cmF0aW9uID09PSAwKSB7XG4gICAgICAgICAgICBkdXJhdGlvbiA9IDAuMDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkdXJhdGlvbiA9IChpbmZvLmR1cmF0aW9uICogZHVyYXRpb24pIC0gc3RhcnREdXJhdGlvbjtcbiAgICAgICAgICAgIHN0YXJ0RHVyYXRpb24gKz0gZHVyYXRpb247XG4gICAgICAgIH1cbiAgICAgICAgYW5pbWF0aW9uLmR1cmF0aW9uID0gaW5mby5pc1JldmVyc2UgPyBpbmZvLmR1cmF0aW9uIC0gZHVyYXRpb24gOiBkdXJhdGlvbjtcbiAgICAgICAgYW5pbWF0aW9uLmN1cnZlID0ga2V5ZnJhbWUuY3VydmU7XG4gICAgICAgIGFuaW1hdGlvbi5mb3JjZUxheWVyID0gdHJ1ZTtcbiAgICAgICAgYW5pbWF0aW9uLnZhbHVlU291cmNlID0gXCJrZXlmcmFtZVwiO1xuICAgICAgICBhbmltYXRpb25zLnB1c2goYW5pbWF0aW9uKTtcbiAgICAgICAgcmV0dXJuIHN0YXJ0RHVyYXRpb247XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoS2V5ZnJhbWVBbmltYXRpb24ucHJvdG90eXBlLCBcImlzUGxheWluZ1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lzUGxheWluZztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUGxheWluZykge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIktleWZyYW1lIGFuaW1hdGlvbiBpcyBhbHJlYWR5IHBsYXlpbmcuXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faXNQbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLl9uYXRpdmVBbmltYXRpb25zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgYW5pbWF0aW9uID0gdGhpcy5fbmF0aXZlQW5pbWF0aW9uc1tpXTtcbiAgICAgICAgICAgIGlmIChhbmltYXRpb24uaXNQbGF5aW5nKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLmNhbmNlbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9uYXRpdmVBbmltYXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBhbmltYXRpb24gPSB0aGlzLl9uYXRpdmVBbmltYXRpb25zWzBdO1xuICAgICAgICAgICAgdGhpcy5fcmVzZXRBbmltYXRpb25WYWx1ZXModGhpcy5fdGFyZ2V0LCBhbmltYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Jlc2V0QW5pbWF0aW9ucygpO1xuICAgIH07XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5faXNQbGF5aW5nKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiS2V5ZnJhbWUgYW5pbWF0aW9uIGlzIGFscmVhZHkgcGxheWluZy5cIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbiwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhbmltYXRpb25GaW5pc2hlZFByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgX3RoaXMuX3Jlc29sdmUgPSByZXNvbHZlO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5faXNQbGF5aW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fbmF0aXZlQW5pbWF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB0aGlzLl90YXJnZXQgPSB2aWV3O1xuICAgICAgICBpZiAodGhpcy5kZWxheSAhPT0gMCkge1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5hbmltYXRlKHZpZXcsIDAsIF90aGlzLml0ZXJhdGlvbnMpOyB9LCB0aGlzLmRlbGF5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0ZSh2aWV3LCAwLCB0aGlzLml0ZXJhdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhbmltYXRpb25GaW5pc2hlZFByb21pc2U7XG4gICAgfTtcbiAgICBLZXlmcmFtZUFuaW1hdGlvbi5wcm90b3R5cGUuYW5pbWF0ZSA9IGZ1bmN0aW9uICh2aWV3LCBpbmRleCwgaXRlcmF0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMuX2lzUGxheWluZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IHRoaXMuYW5pbWF0aW9uc1swXTtcbiAgICAgICAgICAgIGlmIChcImJhY2tncm91bmRDb2xvclwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoXCJzY2FsZVwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi5zY2FsZS54O1xuICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWVByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi5zY2FsZS55O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFwidHJhbnNsYXRlXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi50cmFuc2xhdGUueDtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVZUHJvcGVydHkua2V5ZnJhbWVdID0gYW5pbWF0aW9uLnRyYW5zbGF0ZS55O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFwicm90YXRlXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEucm90YXRlUHJvcGVydHkua2V5ZnJhbWVdID0gYW5pbWF0aW9uLnJvdGF0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcIm9wYWNpdHlcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkua2V5ZnJhbWVdID0gYW5pbWF0aW9uLm9wYWNpdHk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoXCJoZWlnaHRcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5oZWlnaHRQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24uaGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFwid2lkdGhcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS53aWR0aFByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi53aWR0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuYW5pbWF0ZSh2aWV3LCAxLCBpdGVyYXRpb25zKTsgfSwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IHRoaXMuYW5pbWF0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGl0ZXJhdGlvbnMgLT0gMTtcbiAgICAgICAgICAgIGlmIChpdGVyYXRpb25zID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0ZSh2aWV3LCAwLCBpdGVyYXRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc0ZvcndhcmRzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW5pbWF0aW9uID0gdGhpcy5hbmltYXRpb25zW3RoaXMuYW5pbWF0aW9ucy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzZXRBbmltYXRpb25WYWx1ZXModmlldywgYW5pbWF0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZUFuaW1hdGlvbkZpbmlzaGVkUHJvbWlzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IHZvaWQgMDtcbiAgICAgICAgICAgIHZhciBjYWNoZWRBbmltYXRpb24gPSB0aGlzLl9uYXRpdmVBbmltYXRpb25zW2luZGV4IC0gMV07XG4gICAgICAgICAgICBpZiAoY2FjaGVkQW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gY2FjaGVkQW5pbWF0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGFuaW1hdGlvbkRlZiA9IHRoaXMuYW5pbWF0aW9uc1tpbmRleF07XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uRGVmLnRhcmdldCA9IHZpZXc7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gbmV3IGFuaW1hdGlvbl8xLkFuaW1hdGlvbihbYW5pbWF0aW9uRGVmXSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbmF0aXZlQW5pbWF0aW9ucy5wdXNoKGFuaW1hdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaXNMYXN0SXRlcmF0aW9uID0gaXRlcmF0aW9ucyAtIDEgPD0gMDtcbiAgICAgICAgICAgIGFuaW1hdGlvbi5wbGF5KGlzTGFzdEl0ZXJhdGlvbikudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuYW5pbWF0ZSh2aWV3LCBpbmRleCArIDEsIGl0ZXJhdGlvbnMpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZSh0eXBlb2YgZXJyb3IgPT09IFwic3RyaW5nXCIgPyBlcnJvciA6IGVycm9yLm1lc3NhZ2UsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKHR5cGVvZiBlcnJvciA9PT0gXCJzdHJpbmdcIiA/IGVycm9yIDogZXJyb3IubWVzc2FnZSwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbiwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBLZXlmcmFtZUFuaW1hdGlvbi5wcm90b3R5cGUuX3Jlc29sdmVBbmltYXRpb25GaW5pc2hlZFByb21pc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX25hdGl2ZUFuaW1hdGlvbnMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdGhpcy5faXNQbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3RhcmdldCA9IG51bGw7XG4gICAgICAgIHRoaXMuX3Jlc29sdmUoKTtcbiAgICB9O1xuICAgIEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZS5fcmVzZXRBbmltYXRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9uYXRpdmVBbmltYXRpb25zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl90YXJnZXQgPSBudWxsO1xuICAgIH07XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ucHJvdG90eXBlLl9yZXNldEFuaW1hdGlvblZhbHVlcyA9IGZ1bmN0aW9uICh2aWV3LCBhbmltYXRpb24pIHtcbiAgICAgICAgaWYgKFwiYmFja2dyb3VuZENvbG9yXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJzY2FsZVwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVYUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJ0cmFuc2xhdGVcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJyb3RhdGVcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnJvdGF0ZVByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChcIm9wYWNpdHlcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLm9wYWNpdHlQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJoZWlnaHRcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLmhlaWdodFByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChcIndpZHRoXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS53aWR0aFByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gS2V5ZnJhbWVBbmltYXRpb247XG59KCkpO1xuZXhwb3J0cy5LZXlmcmFtZUFuaW1hdGlvbiA9IEtleWZyYW1lQW5pbWF0aW9uO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2V5ZnJhbWUtYW5pbWF0aW9uLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBjb250ZW50X3ZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb250ZW50LXZpZXdcIik7XG52YXIgQm9yZGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQm9yZGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEJvcmRlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQm9yZGVyLnByb3RvdHlwZSwgXCJjb3JuZXJSYWRpdXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5ib3JkZXJSYWRpdXMgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJSYWRpdXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuYm9yZGVyUmFkaXVzID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEJvcmRlci5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciB3aWR0aCA9IGNvbnRlbnRfdmlld18xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aE1vZGUgPSBjb250ZW50X3ZpZXdfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gY29udGVudF92aWV3XzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHRNb2RlID0gY29udGVudF92aWV3XzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBob3Jpem9udGFsQm9yZGVyTGVuZ3RoID0gdGhpcy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggKyB0aGlzLmVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGg7XG4gICAgICAgIHZhciB2ZXJ0aWNhbEJvcmRlckxlbmd0aCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGggKyB0aGlzLmVmZmVjdGl2ZUJvcmRlckJvdHRvbVdpZHRoO1xuICAgICAgICB2YXIgcmVzdWx0ID0gY29udGVudF92aWV3XzEuVmlldy5tZWFzdXJlQ2hpbGQodGhpcywgdGhpcy5sYXlvdXRWaWV3LCBjb250ZW50X3ZpZXdfMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKHdpZHRoIC0gaG9yaXpvbnRhbEJvcmRlckxlbmd0aCwgd2lkdGhNb2RlKSwgY29udGVudF92aWV3XzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhoZWlnaHQgLSB2ZXJ0aWNhbEJvcmRlckxlbmd0aCwgaGVpZ2h0TW9kZSkpO1xuICAgICAgICB2YXIgd2lkdGhBbmRTdGF0ZSA9IGNvbnRlbnRfdmlld18xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShyZXN1bHQubWVhc3VyZWRXaWR0aCArIGhvcml6b250YWxCb3JkZXJMZW5ndGgsIHdpZHRoLCB3aWR0aE1vZGUsIDApO1xuICAgICAgICB2YXIgaGVpZ2h0QW5kU3RhdGUgPSBjb250ZW50X3ZpZXdfMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUocmVzdWx0Lm1lYXN1cmVkSGVpZ2h0ICsgdmVydGljYWxCb3JkZXJMZW5ndGgsIGhlaWdodCwgaGVpZ2h0TW9kZSwgMCk7XG4gICAgICAgIHRoaXMuc2V0TWVhc3VyZWREaW1lbnNpb24od2lkdGhBbmRTdGF0ZSwgaGVpZ2h0QW5kU3RhdGUpO1xuICAgIH07XG4gICAgQm9yZGVyLnByb3RvdHlwZS5vbkxheW91dCA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgdmFyIGhvcml6b250YWxCb3JkZXJMZW5ndGggPSB0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyUmlnaHRXaWR0aDtcbiAgICAgICAgdmFyIHZlcnRpY2FsQm9yZGVyTGVuZ3RoID0gdGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGg7XG4gICAgICAgIGNvbnRlbnRfdmlld18xLlZpZXcubGF5b3V0Q2hpbGQodGhpcywgdGhpcy5sYXlvdXRWaWV3LCB0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCwgdGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCwgcmlnaHQgLSBsZWZ0IC0gaG9yaXpvbnRhbEJvcmRlckxlbmd0aCwgYm90dG9tIC0gdG9wIC0gdmVydGljYWxCb3JkZXJMZW5ndGgpO1xuICAgIH07XG4gICAgQm9yZGVyID0gX19kZWNvcmF0ZShbXG4gICAgICAgIERlcHJlY2F0ZWQsXG4gICAgICAgIGNvbnRlbnRfdmlld18xLkNTU1R5cGUoXCJCb3JkZXJcIilcbiAgICBdLCBCb3JkZXIpO1xuICAgIHJldHVybiBCb3JkZXI7XG59KGNvbnRlbnRfdmlld18xLkNvbnRlbnRWaWV3KSk7XG5leHBvcnRzLkJvcmRlciA9IEJvcmRlcjtcbkJvcmRlci5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJvcmRlci5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRhYl9zdHJpcF8xID0gcmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwXCIpO1xudmFyIHRhYl9zdHJpcF9pdGVtXzEgPSByZXF1aXJlKFwiLi4vdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXAtaXRlbVwiKTtcbnZhciBhcHBsaWNhdGlvbiA9IHJlcXVpcmUoXCIuLi8uLi9hcHBsaWNhdGlvblwiKTtcbnZhciBpbWFnZV9zb3VyY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi9pbWFnZS1zb3VyY2VcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIGZyYW1lXzEgPSByZXF1aXJlKFwiLi4vZnJhbWVcIik7XG52YXIgdGFiX25hdmlnYXRpb25fYmFzZV8xID0gcmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLW5hdmlnYXRpb24tYmFzZVwiKTtcbnZhciB0ZXh0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGFiLW5hdmlnYXRpb24tYmFzZS90YWItY29udGVudC1pdGVtXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1uYXZpZ2F0aW9uLWJhc2VcIikpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcC1pdGVtXCIpKTtcbnZhciBQUklNQVJZX0NPTE9SID0gXCJjb2xvclByaW1hcnlcIjtcbnZhciBERUZBVUxUX0VMRVZBVElPTiA9IDg7XG52YXIgVEFCSUQgPSBcIl90YWJJZFwiO1xudmFyIElOREVYID0gXCJfaW5kZXhcIjtcbnZhciBvd25lclN5bWJvbCA9IFN5bWJvbChcIl9vd25lclwiKTtcbnZhciBUYWJGcmFnbWVudDtcbnZhciBCb3R0b21OYXZpZ2F0aW9uQmFyO1xudmFyIEF0dGFjaFN0YXRlQ2hhbmdlTGlzdGVuZXI7XG5mdW5jdGlvbiBtYWtlRnJhZ21lbnROYW1lKHZpZXdJZCwgaWQpIHtcbiAgICByZXR1cm4gXCJhbmRyb2lkOmJvdHRvbW5hdmlnYXRpb246XCIgKyB2aWV3SWQgKyBcIjpcIiArIGlkO1xufVxuZnVuY3Rpb24gZ2V0VGFiQnlJZChpZCkge1xuICAgIHZhciByZWYgPSBleHBvcnRzLnRhYnMuZmluZChmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgIHZhciB0YWIgPSByZWYuZ2V0KCk7XG4gICAgICAgIHJldHVybiB0YWIgJiYgdGFiLl9kb21JZCA9PT0gaWQ7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlZiAmJiByZWYuZ2V0KCk7XG59XG5mdW5jdGlvbiBpbml0aWFsaXplTmF0aXZlQ2xhc3NlcygpIHtcbiAgICBpZiAoQm90dG9tTmF2aWdhdGlvbkJhcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24sIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbi5uZXdJbnN0YW5jZSA9IGZ1bmN0aW9uICh0YWJJZCwgaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gbmV3IGFuZHJvaWQub3MuQnVuZGxlKCk7XG4gICAgICAgICAgICBhcmdzLnB1dEludChUQUJJRCwgdGFiSWQpO1xuICAgICAgICAgICAgYXJncy5wdXRJbnQoSU5ERVgsIGluZGV4KTtcbiAgICAgICAgICAgIHZhciBmcmFnbWVudCA9IG5ldyBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uKCk7XG4gICAgICAgICAgICBmcmFnbWVudC5zZXRBcmd1bWVudHMoYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gZnJhZ21lbnQ7XG4gICAgICAgIH07XG4gICAgICAgIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uQ3JlYXRlID0gZnVuY3Rpb24gKHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkNyZWF0ZS5jYWxsKHRoaXMsIHNhdmVkSW5zdGFuY2VTdGF0ZSk7XG4gICAgICAgICAgICB2YXIgYXJncyA9IHRoaXMuZ2V0QXJndW1lbnRzKCk7XG4gICAgICAgICAgICB0aGlzLnRhYiA9IGdldFRhYkJ5SWQoYXJncy5nZXRJbnQoVEFCSUQpKTtcbiAgICAgICAgICAgIHRoaXMuaW5kZXggPSBhcmdzLmdldEludChJTkRFWCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMudGFiKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgQm90dG9tTmF2aWdhdGlvblwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25DcmVhdGVWaWV3ID0gZnVuY3Rpb24gKGluZmxhdGVyLCBjb250YWluZXIsIHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICAgICAgdmFyIHRhYkl0ZW0gPSB0aGlzLnRhYi5pdGVtc1t0aGlzLmluZGV4XTtcbiAgICAgICAgICAgIHJldHVybiB0YWJJdGVtLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uO1xuICAgIH0ob3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkZyYWdtZW50QmFzZSkpO1xuICAgIHZhciBCb3R0b21OYXZpZ2F0aW9uQmFySW1wbGVtZW50YXRpb24gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoQm90dG9tTmF2aWdhdGlvbkJhckltcGxlbWVudGF0aW9uLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBCb3R0b21OYXZpZ2F0aW9uQmFySW1wbGVtZW50YXRpb24oY29udGV4dCwgb3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGNvbnRleHQpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgQm90dG9tTmF2aWdhdGlvbkJhckltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vblNlbGVjdGVkUG9zaXRpb25DaGFuZ2UgPSBmdW5jdGlvbiAocG9zaXRpb24sIHByZXZQb3NpdGlvbikge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIGlmICghb3duZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvd25lci5jaGFuZ2VUYWIocG9zaXRpb24pO1xuICAgICAgICAgICAgdmFyIHRhYlN0cmlwSXRlbXMgPSBvd25lci50YWJTdHJpcCAmJiBvd25lci50YWJTdHJpcC5pdGVtcztcbiAgICAgICAgICAgIGlmIChwb3NpdGlvbiA+PSAwICYmIHRhYlN0cmlwSXRlbXMgJiYgdGFiU3RyaXBJdGVtc1twb3NpdGlvbl0pIHtcbiAgICAgICAgICAgICAgICB0YWJTdHJpcEl0ZW1zW3Bvc2l0aW9uXS5fZW1pdCh0YWJfc3RyaXBfaXRlbV8xLlRhYlN0cmlwSXRlbS5zZWxlY3RFdmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocHJldlBvc2l0aW9uID49IDAgJiYgdGFiU3RyaXBJdGVtcyAmJiB0YWJTdHJpcEl0ZW1zW3ByZXZQb3NpdGlvbl0pIHtcbiAgICAgICAgICAgICAgICB0YWJTdHJpcEl0ZW1zW3ByZXZQb3NpdGlvbl0uX2VtaXQodGFiX3N0cmlwX2l0ZW1fMS5UYWJTdHJpcEl0ZW0udW5zZWxlY3RFdmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvd25lci5zZWxlY3RlZEluZGV4ID0gcG9zaXRpb247XG4gICAgICAgIH07XG4gICAgICAgIEJvdHRvbU5hdmlnYXRpb25CYXJJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25UYXAgPSBmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAoIW93bmVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRhYlN0cmlwID0gb3duZXIudGFiU3RyaXA7XG4gICAgICAgICAgICB2YXIgdGFiU3RyaXBJdGVtcyA9IHRhYlN0cmlwICYmIHRhYlN0cmlwLml0ZW1zO1xuICAgICAgICAgICAgaWYgKHBvc2l0aW9uID49IDAgJiYgdGFiU3RyaXBJdGVtc1twb3NpdGlvbl0pIHtcbiAgICAgICAgICAgICAgICB0YWJTdHJpcEl0ZW1zW3Bvc2l0aW9uXS5fZW1pdCh0YWJfc3RyaXBfaXRlbV8xLlRhYlN0cmlwSXRlbS50YXBFdmVudCk7XG4gICAgICAgICAgICAgICAgdGFiU3RyaXAubm90aWZ5KHsgZXZlbnROYW1lOiB0YWJfc3RyaXBfMS5UYWJTdHJpcC5pdGVtVGFwRXZlbnQsIG9iamVjdDogdGFiU3RyaXAsIGluZGV4OiBwb3NpdGlvbiB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghb3duZXIuaXRlbXNbcG9zaXRpb25dKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBCb3R0b21OYXZpZ2F0aW9uQmFySW1wbGVtZW50YXRpb247XG4gICAgfShvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQm90dG9tTmF2aWdhdGlvbkJhcikpO1xuICAgIHZhciBBdHRhY2hMaXN0ZW5lciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhBdHRhY2hMaXN0ZW5lciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gQXR0YWNoTGlzdGVuZXIoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgQXR0YWNoTGlzdGVuZXIucHJvdG90eXBlLm9uVmlld0F0dGFjaGVkVG9XaW5kb3cgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdmlld1tvd25lclN5bWJvbF07XG4gICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICBvd25lci5fb25BdHRhY2hlZFRvV2luZG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEF0dGFjaExpc3RlbmVyLnByb3RvdHlwZS5vblZpZXdEZXRhY2hlZEZyb21XaW5kb3cgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdmlld1tvd25lclN5bWJvbF07XG4gICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICBvd25lci5fb25EZXRhY2hlZEZyb21XaW5kb3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQXR0YWNoTGlzdGVuZXIgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWQudmlldy5WaWV3Lk9uQXR0YWNoU3RhdGVDaGFuZ2VMaXN0ZW5lcl0pXG4gICAgICAgIF0sIEF0dGFjaExpc3RlbmVyKTtcbiAgICAgICAgcmV0dXJuIEF0dGFjaExpc3RlbmVyO1xuICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgIFRhYkZyYWdtZW50ID0gVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbjtcbiAgICBCb3R0b21OYXZpZ2F0aW9uQmFyID0gQm90dG9tTmF2aWdhdGlvbkJhckltcGxlbWVudGF0aW9uO1xuICAgIEF0dGFjaFN0YXRlQ2hhbmdlTGlzdGVuZXIgPSBuZXcgQXR0YWNoTGlzdGVuZXIoKTtcbn1cbmZ1bmN0aW9uIHNldEVsZXZhdGlvbihib3R0b21OYXZpZ2F0aW9uQmFyKSB7XG4gICAgdmFyIGNvbXBhdCA9IGFuZHJvaWR4LmNvcmUudmlldy5WaWV3Q29tcGF0O1xuICAgIGlmIChjb21wYXQuc2V0RWxldmF0aW9uKSB7XG4gICAgICAgIHZhciB2YWwgPSBERUZBVUxUX0VMRVZBVElPTiAqIHV0aWxzXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgIGNvbXBhdC5zZXRFbGV2YXRpb24oYm90dG9tTmF2aWdhdGlvbkJhciwgdmFsKTtcbiAgICB9XG59XG5leHBvcnRzLnRhYnMgPSBuZXcgQXJyYXkoKTtcbmZ1bmN0aW9uIGl0ZXJhdGVJbmRleFJhbmdlKGluZGV4LCBlcHMsIGxhc3RJbmRleCwgY2FsbGJhY2spIHtcbiAgICB2YXIgcmFuZ2VTdGFydCA9IE1hdGgubWF4KDAsIGluZGV4IC0gZXBzKTtcbiAgICB2YXIgcmFuZ2VFbmQgPSBNYXRoLm1pbihpbmRleCArIGVwcywgbGFzdEluZGV4KTtcbiAgICBmb3IgKHZhciBpID0gcmFuZ2VTdGFydDsgaSA8PSByYW5nZUVuZDsgaSsrKSB7XG4gICAgICAgIGNhbGxiYWNrKGkpO1xuICAgIH1cbn1cbnZhciBCb3R0b21OYXZpZ2F0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQm90dG9tTmF2aWdhdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBCb3R0b21OYXZpZ2F0aW9uKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fY29udGVudFZpZXdJZCA9IC0xO1xuICAgICAgICBfdGhpcy5fYXR0YWNoZWRUb1dpbmRvdyA9IGZhbHNlO1xuICAgICAgICBleHBvcnRzLnRhYnMucHVzaChuZXcgV2Vha1JlZihfdGhpcykpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZSwgXCJfaGFzRnJhZ21lbnRzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUub25JdGVtc0NoYW5nZWQgPSBmdW5jdGlvbiAob2xkSXRlbXMsIG5ld0l0ZW1zKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25JdGVtc0NoYW5nZWQuY2FsbCh0aGlzLCBvbGRJdGVtcywgbmV3SXRlbXMpO1xuICAgICAgICBpZiAob2xkSXRlbXMpIHtcbiAgICAgICAgICAgIG9sZEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGksIGFycikge1xuICAgICAgICAgICAgICAgIGl0ZW0uaW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIGl0ZW0udGFiSXRlbVNwZWMgPSBudWxsO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0TmF0aXZlVmlldyhudWxsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpbml0aWFsaXplTmF0aXZlQ2xhc3NlcygpO1xuICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuX2NvbnRleHQ7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkTGF5b3V0KGNvbnRleHQpO1xuICAgICAgICBuYXRpdmVWaWV3LmFkZFJvdyhuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkl0ZW1TcGVjKDEsIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkVW5pdFR5cGUuc3RhcikpO1xuICAgICAgICBuYXRpdmVWaWV3LmFkZFJvdyhuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkl0ZW1TcGVjKDEsIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkVW5pdFR5cGUuYXV0bykpO1xuICAgICAgICB2YXIgY29udGVudFZpZXcgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbnRlbnRMYXlvdXQodGhpcy5fY29udGV4dCk7XG4gICAgICAgIHZhciBjb250ZW50Vmlld0xheW91dFBhcmFtcyA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ29tbW9uTGF5b3V0UGFyYW1zKCk7XG4gICAgICAgIGNvbnRlbnRWaWV3TGF5b3V0UGFyYW1zLnJvdyA9IDA7XG4gICAgICAgIGNvbnRlbnRWaWV3LnNldExheW91dFBhcmFtcyhjb250ZW50Vmlld0xheW91dFBhcmFtcyk7XG4gICAgICAgIG5hdGl2ZVZpZXcuYWRkVmlldyhjb250ZW50Vmlldyk7XG4gICAgICAgIG5hdGl2ZVZpZXcuY29udGVudFZpZXcgPSBjb250ZW50VmlldztcbiAgICAgICAgdmFyIGJvdHRvbU5hdmlnYXRpb25CYXIgPSBuZXcgQm90dG9tTmF2aWdhdGlvbkJhcihjb250ZXh0LCB0aGlzKTtcbiAgICAgICAgdmFyIGJvdHRvbU5hdmlnYXRpb25CYXJMYXlvdXRQYXJhbXMgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbW1vbkxheW91dFBhcmFtcygpO1xuICAgICAgICBib3R0b21OYXZpZ2F0aW9uQmFyTGF5b3V0UGFyYW1zLnJvdyA9IDE7XG4gICAgICAgIGJvdHRvbU5hdmlnYXRpb25CYXIuc2V0TGF5b3V0UGFyYW1zKGJvdHRvbU5hdmlnYXRpb25CYXJMYXlvdXRQYXJhbXMpO1xuICAgICAgICBuYXRpdmVWaWV3LmFkZFZpZXcoYm90dG9tTmF2aWdhdGlvbkJhcik7XG4gICAgICAgIG5hdGl2ZVZpZXcuYm90dG9tTmF2aWdhdGlvbkJhciA9IGJvdHRvbU5hdmlnYXRpb25CYXI7XG4gICAgICAgIHNldEVsZXZhdGlvbihib3R0b21OYXZpZ2F0aW9uQmFyKTtcbiAgICAgICAgdmFyIHByaW1hcnlDb2xvciA9IHV0aWxzXzEuYWQucmVzb3VyY2VzLmdldFBhbGV0dGVDb2xvcihQUklNQVJZX0NPTE9SLCBjb250ZXh0KTtcbiAgICAgICAgaWYgKHByaW1hcnlDb2xvcikge1xuICAgICAgICAgICAgYm90dG9tTmF2aWdhdGlvbkJhci5zZXRCYWNrZ3JvdW5kQ29sb3IocHJpbWFyeUNvbG9yKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmF0aXZlVmlldztcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLl9jb250ZW50Vmlld0lkIDwgMCkge1xuICAgICAgICAgICAgdGhpcy5fY29udGVudFZpZXdJZCA9IGFuZHJvaWQudmlldy5WaWV3LmdlbmVyYXRlVmlld0lkKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIG5hdGl2ZVZpZXcuYWRkT25BdHRhY2hTdGF0ZUNoYW5nZUxpc3RlbmVyKEF0dGFjaFN0YXRlQ2hhbmdlTGlzdGVuZXIpO1xuICAgICAgICBuYXRpdmVWaWV3W293bmVyU3ltYm9sXSA9IHRoaXM7XG4gICAgICAgIHRoaXMuX2NvbnRlbnRWaWV3ID0gbmF0aXZlVmlldy5jb250ZW50VmlldztcbiAgICAgICAgdGhpcy5fY29udGVudFZpZXcuc2V0SWQodGhpcy5fY29udGVudFZpZXdJZCk7XG4gICAgICAgIHRoaXMuX2JvdHRvbU5hdmlnYXRpb25CYXIgPSBuYXRpdmVWaWV3LmJvdHRvbU5hdmlnYXRpb25CYXI7XG4gICAgICAgIHRoaXMuX2JvdHRvbU5hdmlnYXRpb25CYXIub3duZXIgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy50YWJTdHJpcCkge1xuICAgICAgICAgICAgdGhpcy50YWJTdHJpcC5zZXROYXRpdmVWaWV3KHRoaXMuX2JvdHRvbU5hdmlnYXRpb25CYXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5fbG9hZFVubG9hZFRhYkl0ZW1zID0gZnVuY3Rpb24gKG5ld0luZGV4KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIHZhciBsYXN0SW5kZXggPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7XG4gICAgICAgIHZhciBvZmZzaWRlSXRlbXMgPSAwO1xuICAgICAgICB2YXIgdG9VbmxvYWQgPSBbXTtcbiAgICAgICAgdmFyIHRvTG9hZCA9IFtdO1xuICAgICAgICBpdGVyYXRlSW5kZXhSYW5nZShuZXdJbmRleCwgb2Zmc2lkZUl0ZW1zLCBsYXN0SW5kZXgsIGZ1bmN0aW9uIChpKSB7IHJldHVybiB0b0xvYWQucHVzaChpKTsgfSk7XG4gICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGkpIHtcbiAgICAgICAgICAgIHZhciBpbmRleE9mSSA9IHRvTG9hZC5pbmRleE9mKGkpO1xuICAgICAgICAgICAgaWYgKGluZGV4T2ZJIDwgMCkge1xuICAgICAgICAgICAgICAgIHRvVW5sb2FkLnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0b1VubG9hZC5mb3JFYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc1tpbmRleF07XG4gICAgICAgICAgICBpZiAoaXRlbXNbaW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgaXRlbS51bmxvYWRWaWV3KGl0ZW0uY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgbmV3SXRlbSA9IGl0ZW1zW25ld0luZGV4XTtcbiAgICAgICAgdmFyIHNlbGVjdGVkVmlldyA9IG5ld0l0ZW0gJiYgbmV3SXRlbS5jb250ZW50O1xuICAgICAgICBpZiAoc2VsZWN0ZWRWaWV3IGluc3RhbmNlb2YgZnJhbWVfMS5GcmFtZSkge1xuICAgICAgICAgICAgc2VsZWN0ZWRWaWV3Ll9wdXNoSW5GcmFtZVN0YWNrUmVjdXJzaXZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdG9Mb2FkLmZvckVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGl0ZW1zW2luZGV4XTtcbiAgICAgICAgICAgIGlmIChfdGhpcy5pc0xvYWRlZCAmJiBpdGVtc1tpbmRleF0pIHtcbiAgICAgICAgICAgICAgICBpdGVtLmxvYWRWaWV3KGl0ZW0uY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMudGFiU3RyaXApIHtcbiAgICAgICAgICAgIHRoaXMuc2V0VGFiU3RyaXBJdGVtcyh0aGlzLnRhYlN0cmlwLml0ZW1zKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2JvdHRvbU5hdmlnYXRpb25CYXIuc2V0VmlzaWJpbGl0eShhbmRyb2lkLnZpZXcuVmlldy5HT05FKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fYXR0YWNoZWRUb1dpbmRvdykge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VUYWIodGhpcy5zZWxlY3RlZEluZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuX29uQXR0YWNoZWRUb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fb25BdHRhY2hlZFRvV2luZG93LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuX2F0dGFjaGVkVG9XaW5kb3cgPSB0cnVlO1xuICAgICAgICB0aGlzLmNoYW5nZVRhYih0aGlzLnNlbGVjdGVkSW5kZXgpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuX29uRGV0YWNoZWRGcm9tV2luZG93ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9vbkRldGFjaGVkRnJvbVdpbmRvdy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9hdHRhY2hlZFRvV2luZG93ID0gZmFsc2U7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5vblVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uVW5sb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMudGFiU3RyaXApIHtcbiAgICAgICAgICAgIHRoaXMuc2V0VGFiU3RyaXBJdGVtcyhudWxsKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZnJhZ21lbnRUb0RldGFjaCA9IHRoaXMuX2N1cnJlbnRGcmFnbWVudDtcbiAgICAgICAgaWYgKGZyYWdtZW50VG9EZXRhY2gpIHtcbiAgICAgICAgICAgIHRoaXMuZGVzdHJveUl0ZW0oZnJhZ21lbnRUb0RldGFjaC5pbmRleCwgZnJhZ21lbnRUb0RldGFjaCk7XG4gICAgICAgICAgICB0aGlzLmNvbW1pdEN1cnJlbnRUcmFuc2FjdGlvbigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fYm90dG9tTmF2aWdhdGlvbkJhci5zZXRJdGVtcyhudWxsKTtcbiAgICAgICAgdGhpcy5fYm90dG9tTmF2aWdhdGlvbkJhciA9IG51bGw7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5yZW1vdmVPbkF0dGFjaFN0YXRlQ2hhbmdlTGlzdGVuZXIoQXR0YWNoU3RhdGVDaGFuZ2VMaXN0ZW5lcik7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZFtvd25lclN5bWJvbF0gPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5fb25Sb290Vmlld1Jlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9vblJvb3RWaWV3UmVzZXQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5kaXNwb3NlVGFiRnJhZ21lbnRzKCk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5kaXNwb3NlVGFiRnJhZ21lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZnJhZ21lbnRNYW5hZ2VyID0gdGhpcy5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IGZyYWdtZW50TWFuYWdlci5iZWdpblRyYW5zYWN0aW9uKCk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBmcmFnbWVudE1hbmFnZXIuZ2V0RnJhZ21lbnRzKCkudG9BcnJheSgpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGZyYWdtZW50ID0gX2FbX2ldO1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24ucmVtb3ZlKGZyYWdtZW50KTtcbiAgICAgICAgfVxuICAgICAgICB0cmFuc2FjdGlvbi5jb21taXROb3dBbGxvd2luZ1N0YXRlTG9zcygpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLCBcImN1cnJlbnRUcmFuc2FjdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9jdXJyZW50VHJhbnNhY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJhZ21lbnRNYW5hZ2VyID0gdGhpcy5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudFRyYW5zYWN0aW9uID0gZnJhZ21lbnRNYW5hZ2VyLmJlZ2luVHJhbnNhY3Rpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50VHJhbnNhY3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLmNvbW1pdEN1cnJlbnRUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRUcmFuc2FjdGlvbikge1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFRyYW5zYWN0aW9uLmNvbW1pdE5vd0FsbG93aW5nU3RhdGVMb3NzKCk7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50VHJhbnNhY3Rpb24gPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5jaGFuZ2VUYWIgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmcmFnbWVudFRvRGV0YWNoID0gdGhpcy5fY3VycmVudEZyYWdtZW50O1xuICAgICAgICBpZiAoZnJhZ21lbnRUb0RldGFjaCkge1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95SXRlbShmcmFnbWVudFRvRGV0YWNoLmluZGV4LCBmcmFnbWVudFRvRGV0YWNoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZnJhZ21lbnQgPSB0aGlzLmluc3RhbnRpYXRlSXRlbSh0aGlzLl9jb250ZW50VmlldywgaW5kZXgpO1xuICAgICAgICB0aGlzLnNldFByaW1hcnlJdGVtKGluZGV4LCBmcmFnbWVudCk7XG4gICAgICAgIHRoaXMuY29tbWl0Q3VycmVudFRyYW5zYWN0aW9uKCk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5pbnN0YW50aWF0ZUl0ZW0gPSBmdW5jdGlvbiAoY29udGFpbmVyLCBwb3NpdGlvbikge1xuICAgICAgICB2YXIgbmFtZSA9IG1ha2VGcmFnbWVudE5hbWUoY29udGFpbmVyLmdldElkKCksIHBvc2l0aW9uKTtcbiAgICAgICAgdmFyIGZyYWdtZW50TWFuYWdlciA9IHRoaXMuX2dldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICB2YXIgZnJhZ21lbnQgPSBmcmFnbWVudE1hbmFnZXIuZmluZEZyYWdtZW50QnlUYWcobmFtZSk7XG4gICAgICAgIGlmIChmcmFnbWVudCAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUcmFuc2FjdGlvbi5hdHRhY2goZnJhZ21lbnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZnJhZ21lbnQgPSBUYWJGcmFnbWVudC5uZXdJbnN0YW5jZSh0aGlzLl9kb21JZCwgcG9zaXRpb24pO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50VHJhbnNhY3Rpb24uYWRkKGNvbnRhaW5lci5nZXRJZCgpLCBmcmFnbWVudCwgbmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZyYWdtZW50ICE9PSB0aGlzLl9jdXJyZW50RnJhZ21lbnQpIHtcbiAgICAgICAgICAgIGZyYWdtZW50LnNldE1lbnVWaXNpYmlsaXR5KGZhbHNlKTtcbiAgICAgICAgICAgIGZyYWdtZW50LnNldFVzZXJWaXNpYmxlSGludChmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZyYWdtZW50O1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuc2V0UHJpbWFyeUl0ZW0gPSBmdW5jdGlvbiAocG9zaXRpb24sIGZyYWdtZW50KSB7XG4gICAgICAgIGlmIChmcmFnbWVudCAhPT0gdGhpcy5fY3VycmVudEZyYWdtZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY3VycmVudEZyYWdtZW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50RnJhZ21lbnQuc2V0TWVudVZpc2liaWxpdHkoZmFsc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRGcmFnbWVudC5zZXRVc2VyVmlzaWJsZUhpbnQoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZyYWdtZW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBmcmFnbWVudC5zZXRNZW51VmlzaWJpbGl0eSh0cnVlKTtcbiAgICAgICAgICAgICAgICBmcmFnbWVudC5zZXRVc2VyVmlzaWJsZUhpbnQodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50RnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICAgICAgICAgIHZhciB0YWJJdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgICAgICB2YXIgdGFiSXRlbSA9IHRhYkl0ZW1zID8gdGFiSXRlbXNbcG9zaXRpb25dIDogbnVsbDtcbiAgICAgICAgICAgIGlmICh0YWJJdGVtKSB7XG4gICAgICAgICAgICAgICAgdGFiSXRlbS5jYW5CZUxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZFVubG9hZFRhYkl0ZW1zKHBvc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuZGVzdHJveUl0ZW0gPSBmdW5jdGlvbiAocG9zaXRpb24sIGZyYWdtZW50KSB7XG4gICAgICAgIGlmIChmcmFnbWVudCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50VHJhbnNhY3Rpb24uZGV0YWNoKGZyYWdtZW50KTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jdXJyZW50RnJhZ21lbnQgPT09IGZyYWdtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudEZyYWdtZW50ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pdGVtcyAmJiB0aGlzLml0ZW1zW3Bvc2l0aW9uXSkge1xuICAgICAgICAgICAgdGhpcy5pdGVtc1twb3NpdGlvbl0uY2FuQmVMb2FkZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuc2V0VGFiU3RyaXBJdGVtcyA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMudGFiU3RyaXAgfHwgIWl0ZW1zKSB7XG4gICAgICAgICAgICB0aGlzLl9ib3R0b21OYXZpZ2F0aW9uQmFyLnNldEl0ZW1zKG51bGwpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0YWJJdGVtcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpLCBhcnIpIHtcbiAgICAgICAgICAgIGl0ZW0uaW5kZXggPSBpO1xuICAgICAgICAgICAgaWYgKGl0ZW1zW2ldKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRhYkl0ZW1TcGVjID0gX3RoaXMuY3JlYXRlVGFiSXRlbVNwZWMoaXRlbXNbaV0pO1xuICAgICAgICAgICAgICAgIHRhYkl0ZW1zLnB1c2godGFiSXRlbVNwZWMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fYm90dG9tTmF2aWdhdGlvbkJhci5zZXRJdGVtcyh0YWJJdGVtcyk7XG4gICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGksIGFycikge1xuICAgICAgICAgICAgdmFyIHRleHRWaWV3ID0gX3RoaXMuX2JvdHRvbU5hdmlnYXRpb25CYXIuZ2V0VGV4dFZpZXdGb3JJdGVtQXQoaSk7XG4gICAgICAgICAgICBpdGVtLnNldE5hdGl2ZVZpZXcodGV4dFZpZXcpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLmNyZWF0ZVRhYkl0ZW1TcGVjID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSkge1xuICAgICAgICB2YXIgdGFiSXRlbVNwZWMgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlRhYkl0ZW1TcGVjKCk7XG4gICAgICAgIGlmICh0YWJTdHJpcEl0ZW0uaXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHZhciB0aXRsZUxhYmVsID0gdGFiU3RyaXBJdGVtLmxhYmVsO1xuICAgICAgICAgICAgdmFyIHRpdGxlID0gdGl0bGVMYWJlbC50ZXh0O1xuICAgICAgICAgICAgdmFyIHRleHRUcmFuc2Zvcm0gPSB0aXRsZUxhYmVsLnN0eWxlLnRleHRUcmFuc2Zvcm07XG4gICAgICAgICAgICBpZiAodGV4dFRyYW5zZm9ybSkge1xuICAgICAgICAgICAgICAgIHRpdGxlID0gdGV4dF9iYXNlXzEuZ2V0VHJhbnNmb3JtZWRUZXh0KHRpdGxlLCB0ZXh0VHJhbnNmb3JtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhYkl0ZW1TcGVjLnRpdGxlID0gdGl0bGU7XG4gICAgICAgICAgICB2YXIgYmFja2dyb3VuZENvbG9yID0gdGFiU3RyaXBJdGVtLnN0eWxlLmJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgICAgIGlmIChiYWNrZ3JvdW5kQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0YWJJdGVtU3BlYy5iYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kQ29sb3IuYW5kcm9pZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjb2xvciA9IHRpdGxlTGFiZWwuc3R5bGUuY29sb3I7XG4gICAgICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgICAgICB0YWJJdGVtU3BlYy5jb2xvciA9IGNvbG9yLmFuZHJvaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZm9udEludGVybmFsID0gdGl0bGVMYWJlbC5zdHlsZS5mb250SW50ZXJuYWw7XG4gICAgICAgICAgICBpZiAoZm9udEludGVybmFsKSB7XG4gICAgICAgICAgICAgICAgdGFiSXRlbVNwZWMuZm9udFNpemUgPSBmb250SW50ZXJuYWwuZm9udFNpemU7XG4gICAgICAgICAgICAgICAgdGFiSXRlbVNwZWMudHlwZUZhY2UgPSBmb250SW50ZXJuYWwuZ2V0QW5kcm9pZFR5cGVmYWNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaWNvblNvdXJjZSA9IHRhYlN0cmlwSXRlbS5pbWFnZSAmJiB0YWJTdHJpcEl0ZW0uaW1hZ2Uuc3JjO1xuICAgICAgICAgICAgaWYgKGljb25Tb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgaWNvbiA9IHRoaXMuZ2V0SWNvbih0YWJTdHJpcEl0ZW0pO1xuICAgICAgICAgICAgICAgIGlmIChpY29uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYkl0ZW1TcGVjLmljb25EcmF3YWJsZSA9IGljb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGFiSXRlbVNwZWM7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5nZXRJY29uID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSkge1xuICAgICAgICB2YXIgaWNvblNvdXJjZSA9IHRhYlN0cmlwSXRlbS5pbWFnZSAmJiB0YWJTdHJpcEl0ZW0uaW1hZ2Uuc3JjO1xuICAgICAgICB2YXIgaXM7XG4gICAgICAgIGlmICh1dGlsc18xLmlzRm9udEljb25VUkkoaWNvblNvdXJjZSkpIHtcbiAgICAgICAgICAgIHZhciBmb250SWNvbkNvZGUgPSBpY29uU291cmNlLnNwbGl0KFwiLy9cIilbMV07XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGFiU3RyaXBJdGVtLmltYWdlID8gdGFiU3RyaXBJdGVtLmltYWdlIDogdGFiU3RyaXBJdGVtO1xuICAgICAgICAgICAgdmFyIGZvbnQgPSB0YXJnZXQuc3R5bGUuZm9udEludGVybmFsO1xuICAgICAgICAgICAgdmFyIGNvbG9yID0gdGFyZ2V0LnN0eWxlLmNvbG9yO1xuICAgICAgICAgICAgaXMgPSBpbWFnZV9zb3VyY2VfMS5mcm9tRm9udEljb25Db2RlKGZvbnRJY29uQ29kZSwgZm9udCwgY29sb3IpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaXMgPSBpbWFnZV9zb3VyY2VfMS5mcm9tRmlsZU9yUmVzb3VyY2UoaWNvblNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGltYWdlRHJhd2FibGU7XG4gICAgICAgIGlmIChpcyAmJiBpcy5hbmRyb2lkKSB7XG4gICAgICAgICAgICB2YXIgaW1hZ2UgPSBpcy5hbmRyb2lkO1xuICAgICAgICAgICAgaWYgKHRoaXMudGFiU3RyaXAgJiYgdGhpcy50YWJTdHJpcC5pc0ljb25TaXplRml4ZWQpIHtcbiAgICAgICAgICAgICAgICBpbWFnZSA9IHRoaXMuZ2V0Rml4ZWRTaXplSWNvbihpbWFnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbWFnZURyYXdhYmxlID0gbmV3IGFuZHJvaWQuZ3JhcGhpY3MuZHJhd2FibGUuQml0bWFwRHJhd2FibGUoYXBwbGljYXRpb24uYW5kcm9pZC5jb250ZXh0LmdldFJlc291cmNlcygpLCBpbWFnZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGltYWdlRHJhd2FibGU7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5nZXRGaXhlZFNpemVJY29uID0gZnVuY3Rpb24gKGltYWdlKSB7XG4gICAgICAgIHZhciBpbldpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTtcbiAgICAgICAgdmFyIGluSGVpZ2h0ID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7XG4gICAgICAgIHZhciBpY29uU3BlY1NpemUgPSB0YWJfbmF2aWdhdGlvbl9iYXNlXzEuZ2V0SWNvblNwZWNTaXplKHsgd2lkdGg6IGluV2lkdGgsIGhlaWdodDogaW5IZWlnaHQgfSk7XG4gICAgICAgIHZhciB3aWR0aFBpeGVscyA9IGljb25TcGVjU2l6ZS53aWR0aCAqIHV0aWxzXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgIHZhciBoZWlnaHRQaXhlbHMgPSBpY29uU3BlY1NpemUuaGVpZ2h0ICogdXRpbHNfMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICAgICAgdmFyIHNjYWxlZEltYWdlID0gYW5kcm9pZC5ncmFwaGljcy5CaXRtYXAuY3JlYXRlU2NhbGVkQml0bWFwKGltYWdlLCB3aWR0aFBpeGVscywgaGVpZ2h0UGl4ZWxzLCB0cnVlKTtcbiAgICAgICAgcmV0dXJuIHNjYWxlZEltYWdlO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUudXBkYXRlQW5kcm9pZEl0ZW1BdCA9IGZ1bmN0aW9uIChpbmRleCwgc3BlYykge1xuICAgICAgICB0aGlzLl9ib3R0b21OYXZpZ2F0aW9uQmFyLnVwZGF0ZUl0ZW1BdChpbmRleCwgc3BlYyk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5nZXRUYWJCYXJCYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ib3R0b21OYXZpZ2F0aW9uQmFyLmdldEJhY2tncm91bmQoKTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLnNldFRhYkJhckJhY2tncm91bmRDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiB2aWV3XzEuQ29sb3IpIHtcbiAgICAgICAgICAgIHRoaXMuX2JvdHRvbU5hdmlnYXRpb25CYXIuc2V0QmFja2dyb3VuZENvbG9yKHZhbHVlLmFuZHJvaWQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fYm90dG9tTmF2aWdhdGlvbkJhci5zZXRCYWNrZ3JvdW5kKHRyeUNsb25lRHJhd2FibGUodmFsdWUsIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRSZXNvdXJjZXMpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuc2V0VGFiQmFySXRlbVRpdGxlID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIHRhYlN0cmlwSXRlbUluZGV4ID0gdGhpcy50YWJTdHJpcC5pdGVtcy5pbmRleE9mKHRhYlN0cmlwSXRlbSk7XG4gICAgICAgIHZhciB0YWJJdGVtU3BlYyA9IHRoaXMuY3JlYXRlVGFiSXRlbVNwZWModGFiU3RyaXBJdGVtKTtcbiAgICAgICAgdGhpcy51cGRhdGVBbmRyb2lkSXRlbUF0KHRhYlN0cmlwSXRlbUluZGV4LCB0YWJJdGVtU3BlYyk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtQmFja2dyb3VuZENvbG9yID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIHRhYlN0cmlwSXRlbUluZGV4ID0gdGhpcy50YWJTdHJpcC5pdGVtcy5pbmRleE9mKHRhYlN0cmlwSXRlbSk7XG4gICAgICAgIHZhciB0YWJJdGVtU3BlYyA9IHRoaXMuY3JlYXRlVGFiSXRlbVNwZWModGFiU3RyaXBJdGVtKTtcbiAgICAgICAgdGhpcy51cGRhdGVBbmRyb2lkSXRlbUF0KHRhYlN0cmlwSXRlbUluZGV4LCB0YWJJdGVtU3BlYyk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtQ29sb3IgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICB0YWJTdHJpcEl0ZW0ubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUZXh0Q29sb3IodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGFiU3RyaXBJdGVtLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VGV4dENvbG9yKHZhbHVlLmFuZHJvaWQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5zZXRUYWJCYXJJY29uQ29sb3IgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgICAgICB2YXIgaW5kZXggPSB0YWJTdHJpcEl0ZW0uaW5kZXg7XG4gICAgICAgIHZhciB0YWJCYXJJdGVtID0gdGhpcy5fYm90dG9tTmF2aWdhdGlvbkJhci5nZXRWaWV3Rm9ySXRlbUF0KGluZGV4KTtcbiAgICAgICAgdmFyIGltZ1ZpZXcgPSB0YWJCYXJJdGVtLmdldENoaWxkQXQoMCk7XG4gICAgICAgIHZhciBkcmF3YWJsZSA9IHRoaXMuZ2V0SWNvbih0YWJTdHJpcEl0ZW0pO1xuICAgICAgICBpbWdWaWV3LnNldEltYWdlRHJhd2FibGUoZHJhd2FibGUpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuc2V0VGFiQmFySXRlbUZvbnRJbnRlcm5hbCA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgICAgIHRhYlN0cmlwSXRlbS5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFRleHRTaXplKHZhbHVlLmZvbnRTaXplKTtcbiAgICAgICAgdGFiU3RyaXBJdGVtLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VHlwZWZhY2UodmFsdWUuZ2V0QW5kcm9pZFR5cGVmYWNlKCkpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuc2V0VGFiQmFySXRlbVRleHRUcmFuc2Zvcm0gPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgICAgICB2YXIgdGl0bGVMYWJlbCA9IHRhYlN0cmlwSXRlbS5sYWJlbDtcbiAgICAgICAgdmFyIHRpdGxlID0gdGV4dF9iYXNlXzEuZ2V0VHJhbnNmb3JtZWRUZXh0KHRpdGxlTGFiZWwudGV4dCwgdmFsdWUpO1xuICAgICAgICB0YWJTdHJpcEl0ZW0ubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUZXh0KHRpdGxlKTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy50YWJTdHJpcCkge1xuICAgICAgICAgICAgdGhpcy5fYm90dG9tTmF2aWdhdGlvbkJhci5zZXRTZWxlY3RlZFBvc2l0aW9uKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlVGFiKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGVbdGFiX25hdmlnYXRpb25fYmFzZV8xLml0ZW1zUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGVbdGFiX25hdmlnYXRpb25fYmFzZV8xLml0ZW1zUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhbHVlLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGkpIHtcbiAgICAgICAgICAgICAgICBpdGVtLmluZGV4ID0gaTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuY29lcmNlKHRoaXMpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGVbdGFiX25hdmlnYXRpb25fYmFzZV8xLnRhYlN0cmlwUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGVbdGFiX25hdmlnYXRpb25fYmFzZV8xLnRhYlN0cmlwUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLnRhYlN0cmlwID8gdGhpcy50YWJTdHJpcC5pdGVtcyA6IG51bGw7XG4gICAgICAgIHRoaXMuc2V0VGFiU3RyaXBJdGVtcyhpdGVtcyk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiQm90dG9tTmF2aWdhdGlvblwiKVxuICAgIF0sIEJvdHRvbU5hdmlnYXRpb24pO1xuICAgIHJldHVybiBCb3R0b21OYXZpZ2F0aW9uO1xufSh0YWJfbmF2aWdhdGlvbl9iYXNlXzEuVGFiTmF2aWdhdGlvbkJhc2UpKTtcbmV4cG9ydHMuQm90dG9tTmF2aWdhdGlvbiA9IEJvdHRvbU5hdmlnYXRpb247XG5mdW5jdGlvbiB0cnlDbG9uZURyYXdhYmxlKHZhbHVlLCByZXNvdXJjZXMpIHtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNvbnN0YW50U3RhdGUgPSB2YWx1ZS5nZXRDb25zdGFudFN0YXRlKCk7XG4gICAgICAgIGlmIChjb25zdGFudFN0YXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gY29uc3RhbnRTdGF0ZS5uZXdEcmF3YWJsZShyZXNvdXJjZXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJvdHRvbS1uYXZpZ2F0aW9uLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGV4cHJlc3Npb25TeW1ib2xzUmVnZXggPSAvW1xcK1xcLVxcKlxcLyVcXD86PD49IVxcfCZcXChcXClefl0vO1xudmFyIGJpbmRpbmdDb25zdGFudHM7XG4oZnVuY3Rpb24gKGJpbmRpbmdDb25zdGFudHMpIHtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLnNvdXJjZVByb3BlcnR5ID0gXCJzb3VyY2VQcm9wZXJ0eVwiO1xuICAgIGJpbmRpbmdDb25zdGFudHMudGFyZ2V0UHJvcGVydHkgPSBcInRhcmdldFByb3BlcnR5XCI7XG4gICAgYmluZGluZ0NvbnN0YW50cy5leHByZXNzaW9uID0gXCJleHByZXNzaW9uXCI7XG4gICAgYmluZGluZ0NvbnN0YW50cy50d29XYXkgPSBcInR3b1dheVwiO1xuICAgIGJpbmRpbmdDb25zdGFudHMuc291cmNlID0gXCJzb3VyY2VcIjtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLmJpbmRpbmdWYWx1ZUtleSA9IFwiJHZhbHVlXCI7XG4gICAgYmluZGluZ0NvbnN0YW50cy5wYXJlbnRWYWx1ZUtleSA9IFwiJHBhcmVudFwiO1xuICAgIGJpbmRpbmdDb25zdGFudHMucGFyZW50c1ZhbHVlS2V5ID0gXCIkcGFyZW50c1wiO1xuICAgIGJpbmRpbmdDb25zdGFudHMubmV3UHJvcGVydHlWYWx1ZUtleSA9IFwiJG5ld1Byb3BlcnR5VmFsdWVcIjtcbn0pKGJpbmRpbmdDb25zdGFudHMgPSBleHBvcnRzLmJpbmRpbmdDb25zdGFudHMgfHwgKGV4cG9ydHMuYmluZGluZ0NvbnN0YW50cyA9IHt9KSk7XG52YXIgaGFzRXF1YWxTaWduUmVnZXggPSAvPSsvO1xudmFyIGVxdWFsU2lnbkNvbXBhcmlzaW9uT3BlcmF0b3JzUmVnZXggPSAvKD09fD09PXw+PXw8PXwhPXwhPT0pLztcbmV4cG9ydHMucGFyZW50c1JlZ2V4ID0gL1xcJHBhcmVudHNcXHMqXFxbXFxzKihbJ1wiXSopXFx3KlxcMVxccypcXF0vZztcbmZ1bmN0aW9uIGlzTmFtZWRQYXJhbSh2YWx1ZSkge1xuICAgIHZhciBlcXVhbFNpZ25JbmRleCA9IHZhbHVlLnNlYXJjaChoYXNFcXVhbFNpZ25SZWdleCk7XG4gICAgaWYgKGVxdWFsU2lnbkluZGV4ID4gLTEpIHtcbiAgICAgICAgdmFyIGVxdWFsU2lnblN1cnJvdW5kID0gdmFsdWUuc3Vic3RyKGVxdWFsU2lnbkluZGV4ID4gMCA/IGVxdWFsU2lnbkluZGV4IC0gMSA6IDAsIDMpO1xuICAgICAgICBpZiAoZXF1YWxTaWduU3Vycm91bmQuc2VhcmNoKGVxdWFsU2lnbkNvbXBhcmlzaW9uT3BlcmF0b3JzUmVnZXgpID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gYXJlTmFtZWRQYXJhbXMocGFyYW1zKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJhbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGlzTmFtZWRQYXJhbShwYXJhbXNbaV0pKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG52YXIgbmFtZWRQYXJhbUNvbnN0YW50cyA9IHtcbiAgICBwcm9wTmFtZTogXCJwcm9wTmFtZVwiLFxuICAgIHByb3BWYWx1ZTogXCJwcm9wVmFsdWVcIlxufTtcbmZ1bmN0aW9uIGdldFByb3BlcnR5TmFtZVZhbHVlUGFpcihwYXJhbSwga25vd25PcHRpb25zLCBjYWxsYmFjaykge1xuICAgIHZhciBuYW1lVmFsdWVQYWlyID0ge307XG4gICAgdmFyIHByb3BlcnR5TmFtZSA9IHBhcmFtLnN1YnN0cigwLCBwYXJhbS5pbmRleE9mKFwiPVwiKSkudHJpbSgpO1xuICAgIHZhciBwcm9wZXJ0eVZhbHVlID0gcGFyYW0uc3Vic3RyKHBhcmFtLmluZGV4T2YoXCI9XCIpICsgMSkudHJpbSgpO1xuICAgIGlmIChrbm93bk9wdGlvbnMpIHtcbiAgICAgICAgaWYgKCFwcm9wZXJ0eU5hbWUpIHtcbiAgICAgICAgICAgIHByb3BlcnR5TmFtZSA9IGtub3duT3B0aW9ucy5kZWZhdWx0UHJvcGVydHk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwcm9wZXJ0eU5hbWUgPSBwcm9wZXJ0eU5hbWUgaW4ga25vd25PcHRpb25zID8gcHJvcGVydHlOYW1lIDogbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAocHJvcGVydHlOYW1lKSB7XG4gICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgbmFtZVZhbHVlUGFpciA9IGNhbGxiYWNrKHByb3BlcnR5TmFtZSwgcHJvcGVydHlWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuYW1lVmFsdWVQYWlyW25hbWVkUGFyYW1Db25zdGFudHMucHJvcE5hbWVdID0gcHJvcGVydHlOYW1lO1xuICAgICAgICAgICAgbmFtZVZhbHVlUGFpcltuYW1lZFBhcmFtQ29uc3RhbnRzLnByb3BWYWx1ZV0gPSBwcm9wZXJ0eVZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuYW1lVmFsdWVQYWlyO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmZ1bmN0aW9uIHBhcnNlTmFtZWRQcm9wZXJ0aWVzKHBhcmFtZXRlckxpc3QsIGtub3duT3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgdmFyIG5hbWVWYWx1ZVBhaXI7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJhbWV0ZXJMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIG5hbWVWYWx1ZVBhaXIgPSBnZXRQcm9wZXJ0eU5hbWVWYWx1ZVBhaXIocGFyYW1ldGVyTGlzdFtpXSwga25vd25PcHRpb25zLCBjYWxsYmFjayk7XG4gICAgICAgIGlmIChuYW1lVmFsdWVQYWlyKSB7XG4gICAgICAgICAgICByZXN1bHRbbmFtZVZhbHVlUGFpcltuYW1lZFBhcmFtQ29uc3RhbnRzLnByb3BOYW1lXV0gPSBuYW1lVmFsdWVQYWlyW25hbWVkUGFyYW1Db25zdGFudHMucHJvcFZhbHVlXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gZ2V0UGFyYW1zQXJyYXkodmFsdWUpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgdmFyIHNraXBDb21tYSA9IDA7XG4gICAgdmFyIGluZGV4UmVhY2hlZCA9IDA7XG4gICAgdmFyIHNpbmdsZVF1b3RlQmxvY2sgPSBmYWxzZTtcbiAgICB2YXIgZG91YmxlUXVvdGVCbG9jayA9IGZhbHNlO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFsdWUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHZhbHVlW2ldID09PSBcIlxcXCJcIikge1xuICAgICAgICAgICAgZG91YmxlUXVvdGVCbG9jayA9ICFkb3VibGVRdW90ZUJsb2NrO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZVtpXSA9PT0gXCInXCIpIHtcbiAgICAgICAgICAgIHNpbmdsZVF1b3RlQmxvY2sgPSAhc2luZ2xlUXVvdGVCbG9jaztcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWVbaV0gPT09IFwiKFwiIHx8IHZhbHVlW2ldID09PSBcIltcIikge1xuICAgICAgICAgICAgc2tpcENvbW1hKys7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlW2ldID09PSBcIilcIiB8fCB2YWx1ZVtpXSA9PT0gXCJdXCIpIHtcbiAgICAgICAgICAgIHNraXBDb21tYS0tO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZVtpXSA9PT0gXCIsXCIgJiYgc2tpcENvbW1hID09PSAwICYmICEoc2luZ2xlUXVvdGVCbG9jayB8fCBkb3VibGVRdW90ZUJsb2NrKSkge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2godmFsdWUuc3Vic3RyKGluZGV4UmVhY2hlZCwgaSAtIGluZGV4UmVhY2hlZCkpO1xuICAgICAgICAgICAgaW5kZXhSZWFjaGVkID0gaSArIDE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVzdWx0LnB1c2godmFsdWUuc3Vic3RyKGluZGV4UmVhY2hlZCkpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBpc0V4cHJlc3Npb24oZXhwcmVzc2lvbikge1xuICAgIGlmIChleHByZXNzaW9uLnNlYXJjaChleHByZXNzaW9uU3ltYm9sc1JlZ2V4KSA+IC0xKSB7XG4gICAgICAgIHZhciBwYXJlbnRzTWF0Y2hlcyA9IGV4cHJlc3Npb24ubWF0Y2goZXhwb3J0cy5wYXJlbnRzUmVnZXgpO1xuICAgICAgICBpZiAocGFyZW50c01hdGNoZXMpIHtcbiAgICAgICAgICAgIHZhciByZXN0T2ZFeHByZXNzaW9uID0gZXhwcmVzc2lvbi5zdWJzdHIoZXhwcmVzc2lvbi5pbmRleE9mKHBhcmVudHNNYXRjaGVzWzBdKSArIHBhcmVudHNNYXRjaGVzWzBdLmxlbmd0aCk7XG4gICAgICAgICAgICBpZiAoIShyZXN0T2ZFeHByZXNzaW9uLnNlYXJjaChleHByZXNzaW9uU3ltYm9sc1JlZ2V4KSA+IC0xKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gZ2V0QmluZGluZ09wdGlvbnMobmFtZSwgdmFsdWUpIHtcbiAgICB2YXIgbmFtZWRQYXJhbXMgPSBbXTtcbiAgICB2YXIgcGFyYW1zID0gZ2V0UGFyYW1zQXJyYXkodmFsdWUpO1xuICAgIGlmICghYXJlTmFtZWRQYXJhbXMocGFyYW1zKSkge1xuICAgICAgICBpZiAocGFyYW1zLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgdmFyIHRyaW1tZWRWYWx1ZSA9IHBhcmFtc1swXS50cmltKCk7XG4gICAgICAgICAgICB2YXIgc291cmNlUHJvcCA9IHZvaWQgMDtcbiAgICAgICAgICAgIGlmIChpc0V4cHJlc3Npb24odHJpbW1lZFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHNvdXJjZVByb3AgPSBiaW5kaW5nQ29uc3RhbnRzLmJpbmRpbmdWYWx1ZUtleTtcbiAgICAgICAgICAgICAgICBuYW1lZFBhcmFtcy5wdXNoKGJpbmRpbmdDb25zdGFudHMuZXhwcmVzc2lvbiArIFwiID0gXCIgKyB0cmltbWVkVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc291cmNlUHJvcCA9IHRyaW1tZWRWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5hbWVkUGFyYW1zLnB1c2goYmluZGluZ0NvbnN0YW50cy5zb3VyY2VQcm9wZXJ0eSArIFwiID0gXCIgKyBzb3VyY2VQcm9wKTtcbiAgICAgICAgICAgIG5hbWVkUGFyYW1zLnB1c2goYmluZGluZ0NvbnN0YW50cy50d29XYXkgKyBcIiA9IHRydWVcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuYW1lZFBhcmFtcy5wdXNoKGJpbmRpbmdDb25zdGFudHMuc291cmNlUHJvcGVydHkgKyBcIiA9IFwiICsgcGFyYW1zWzBdLnRyaW0oKSk7XG4gICAgICAgICAgICBuYW1lZFBhcmFtcy5wdXNoKGJpbmRpbmdDb25zdGFudHMuZXhwcmVzc2lvbiArIFwiID0gXCIgKyBwYXJhbXNbMV0udHJpbSgpKTtcbiAgICAgICAgICAgIHZhciB0d29XYXkgPSBwYXJhbXNbMl0gPyBwYXJhbXNbMl0udG9Mb3dlckNhc2UoKS50cmltKCkgPT09IFwidHJ1ZVwiIDogdHJ1ZTtcbiAgICAgICAgICAgIG5hbWVkUGFyYW1zLnB1c2goYmluZGluZ0NvbnN0YW50cy50d29XYXkgKyBcIiA9IFwiICsgdHdvV2F5KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbmFtZWRQYXJhbXMgPSBwYXJhbXM7XG4gICAgfVxuICAgIHZhciBiaW5kaW5nUHJvcGVydHlIYW5kbGVyID0gZnVuY3Rpb24gKHByb3AsIHZhbHVlKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgcmVzdWx0W25hbWVkUGFyYW1Db25zdGFudHMucHJvcE5hbWVdID0gcHJvcDtcbiAgICAgICAgaWYgKHByb3AgPT09IGJpbmRpbmdDb25zdGFudHMudHdvV2F5KSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IFwidHJ1ZVwiKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W25hbWVkUGFyYW1Db25zdGFudHMucHJvcFZhbHVlXSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbbmFtZWRQYXJhbUNvbnN0YW50cy5wcm9wVmFsdWVdID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXN1bHRbbmFtZWRQYXJhbUNvbnN0YW50cy5wcm9wVmFsdWVdID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIHZhciBiaW5kaW5nT3B0aW9uc1BhcmFtZXRlcnMgPSBwYXJzZU5hbWVkUHJvcGVydGllcyhuYW1lZFBhcmFtcywgeG1sQmluZGluZ1Byb3BlcnRpZXMsIGJpbmRpbmdQcm9wZXJ0eUhhbmRsZXIpO1xuICAgIHZhciBiaW5kT3B0aW9ucyA9IHtcbiAgICAgICAgdGFyZ2V0UHJvcGVydHk6IG5hbWVcbiAgICB9O1xuICAgIGZvciAodmFyIHByb3AgaW4gYmluZGluZ09wdGlvbnNQYXJhbWV0ZXJzKSB7XG4gICAgICAgIGlmIChiaW5kaW5nT3B0aW9uc1BhcmFtZXRlcnMuaGFzT3duUHJvcGVydHkocHJvcCkpIHtcbiAgICAgICAgICAgIGJpbmRPcHRpb25zW3Byb3BdID0gYmluZGluZ09wdGlvbnNQYXJhbWV0ZXJzW3Byb3BdO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChiaW5kT3B0aW9uc1tiaW5kaW5nQ29uc3RhbnRzLnR3b1dheV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBiaW5kT3B0aW9uc1tiaW5kaW5nQ29uc3RhbnRzLnR3b1dheV0gPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gYmluZE9wdGlvbnM7XG59XG5leHBvcnRzLmdldEJpbmRpbmdPcHRpb25zID0gZ2V0QmluZGluZ09wdGlvbnM7XG52YXIgeG1sQmluZGluZ1Byb3BlcnRpZXMgPSB7XG4gICAgc291cmNlUHJvcGVydHk6IHRydWUsXG4gICAgZXhwcmVzc2lvbjogdHJ1ZSxcbiAgICB0d29XYXk6IHRydWUsXG4gICAgc291cmNlOiB0cnVlLFxuICAgIGRlZmF1bHRQcm9wZXJ0eTogYmluZGluZ0NvbnN0YW50cy5zb3VyY2VQcm9wZXJ0eVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJpbmRpbmctYnVpbGRlci5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZGVidWdfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy9kZWJ1Z1wiKTtcbnZhciB4bWwgPSByZXF1aXJlKFwiLi4vLi4veG1sXCIpO1xudmFyIHR5cGVzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdHlwZXNcIik7XG52YXIgY29tcG9uZW50X2J1aWxkZXJfMSA9IHJlcXVpcmUoXCIuL2NvbXBvbmVudC1idWlsZGVyXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vcGxhdGZvcm1cIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vcHJvZmlsaW5nXCIpO1xudmFyIG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xID0gcmVxdWlyZShcIi4vbW9kdWxlLW5hbWUtc2FuaXRpemVyXCIpO1xudmFyIG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEgPSByZXF1aXJlKFwiLi4vLi4vbW9kdWxlLW5hbWUtcmVzb2x2ZXJcIik7XG52YXIgaW9zID0gcGxhdGZvcm1fMS5wbGF0Zm9ybU5hbWVzLmlvcy50b0xvd2VyQ2FzZSgpO1xudmFyIGFuZHJvaWQgPSBwbGF0Zm9ybV8xLnBsYXRmb3JtTmFtZXMuYW5kcm9pZC50b0xvd2VyQ2FzZSgpO1xudmFyIGRlZmF1bHROYW1lU3BhY2VNYXRjaGVyID0gL3Ruc1xcLnhzZCQvaTtcbmZ1bmN0aW9uIHBhcnNlKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSgpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGV4cG9ydHNfMSA9IGNvbnRleHQgPyBnZXRFeHBvcnRzKGNvbnRleHQpIDogdW5kZWZpbmVkO1xuICAgICAgICB2YXIgY29tcG9uZW50TW9kdWxlID0gcGFyc2VJbnRlcm5hbCh2YWx1ZSwgZXhwb3J0c18xKTtcbiAgICAgICAgcmV0dXJuIGNvbXBvbmVudE1vZHVsZSAmJiBjb21wb25lbnRNb2R1bGUuY29tcG9uZW50O1xuICAgIH1cbn1cbmV4cG9ydHMucGFyc2UgPSBwYXJzZTtcbmZ1bmN0aW9uIHBhcnNlTXVsdGlwbGVUZW1wbGF0ZXModmFsdWUsIGNvbnRleHQpIHtcbiAgICB2YXIgZHVtbXlDb21wb25lbnQgPSBcIjxMaXN0Vmlldz48TGlzdFZpZXcuaXRlbVRlbXBsYXRlcz5cIiArIHZhbHVlICsgXCI8L0xpc3RWaWV3Lml0ZW1UZW1wbGF0ZXM+PC9MaXN0Vmlldz5cIjtcbiAgICByZXR1cm4gcGFyc2VJbnRlcm5hbChkdW1teUNvbXBvbmVudCwgY29udGV4dCkuY29tcG9uZW50W1wiaXRlbVRlbXBsYXRlc1wiXTtcbn1cbmV4cG9ydHMucGFyc2VNdWx0aXBsZVRlbXBsYXRlcyA9IHBhcnNlTXVsdGlwbGVUZW1wbGF0ZXM7XG5mdW5jdGlvbiBsb2FkKHBhdGhPck9wdGlvbnMsIGNvbnRleHQpIHtcbiAgICB2YXIgY29tcG9uZW50TW9kdWxlO1xuICAgIGlmICh0eXBlb2YgcGF0aE9yT3B0aW9ucyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB2YXIgbW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShwYXRoT3JPcHRpb25zKTtcbiAgICAgICAgY29tcG9uZW50TW9kdWxlID0gbG9hZEludGVybmFsKG1vZHVsZU5hbWUsIGNvbnRleHQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29tcG9uZW50TW9kdWxlID0gbG9hZEN1c3RvbUNvbXBvbmVudChwYXRoT3JPcHRpb25zLnBhdGgsIHBhdGhPck9wdGlvbnMubmFtZSwgcGF0aE9yT3B0aW9ucy5hdHRyaWJ1dGVzLCBwYXRoT3JPcHRpb25zLmV4cG9ydHMsIHBhdGhPck9wdGlvbnMucGFnZSwgdHJ1ZSk7XG4gICAgfVxuICAgIHJldHVybiBjb21wb25lbnRNb2R1bGUgJiYgY29tcG9uZW50TW9kdWxlLmNvbXBvbmVudDtcbn1cbmV4cG9ydHMubG9hZCA9IGxvYWQ7XG5leHBvcnRzLmNyZWF0ZVZpZXdGcm9tRW50cnkgPSBwcm9maWxpbmdfMS5wcm9maWxlKFwiY3JlYXRlVmlld0Zyb21FbnRyeVwiLCBmdW5jdGlvbiAoZW50cnkpIHtcbiAgICBpZiAoZW50cnkuY3JlYXRlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gZW50cnkuY3JlYXRlKCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBWaWV3IHdpdGggZW50cnkuY3JlYXRlKCkgZnVuY3Rpb24uXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2aWV3O1xuICAgIH1cbiAgICBlbHNlIGlmIChlbnRyeS5tb2R1bGVOYW1lKSB7XG4gICAgICAgIHZhciBtb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfc2FuaXRpemVyXzEuc2FuaXRpemVNb2R1bGVOYW1lKGVudHJ5Lm1vZHVsZU5hbWUpO1xuICAgICAgICB2YXIgcmVzb2x2ZWRDb2RlTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSwgXCJcIik7XG4gICAgICAgIHZhciBtb2R1bGVFeHBvcnRzID0gcmVzb2x2ZWRDb2RlTW9kdWxlTmFtZSA/IGdsb2JhbC5sb2FkTW9kdWxlKHJlc29sdmVkQ29kZU1vZHVsZU5hbWUsIHRydWUpIDogbnVsbDtcbiAgICAgICAgaWYgKG1vZHVsZUV4cG9ydHMgJiYgbW9kdWxlRXhwb3J0cy5jcmVhdGVQYWdlKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IG1vZHVsZUV4cG9ydHMuY3JlYXRlUGFnZSgpO1xuICAgICAgICAgICAgdmFyIHJlc29sdmVkQ3NzTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSwgXCJjc3NcIik7XG4gICAgICAgICAgICBpZiAocmVzb2x2ZWRDc3NNb2R1bGVOYW1lKSB7XG4gICAgICAgICAgICAgICAgdmlldy5hZGRDc3NGaWxlKHJlc29sdmVkQ3NzTW9kdWxlTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmlldztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBjb21wb25lbnRNb2R1bGUgPSBsb2FkSW50ZXJuYWwobW9kdWxlTmFtZSwgbW9kdWxlRXhwb3J0cyk7XG4gICAgICAgICAgICB2YXIgY29tcG9uZW50VmlldyA9IGNvbXBvbmVudE1vZHVsZSAmJiBjb21wb25lbnRNb2R1bGUuY29tcG9uZW50O1xuICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudFZpZXc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGxvYWQgcGFnZSBYTUwgZmlsZSBmb3IgbW9kdWxlOiBcIiArIGVudHJ5Lm1vZHVsZU5hbWUpO1xufSk7XG5mdW5jdGlvbiBsb2FkSW50ZXJuYWwobW9kdWxlTmFtZSwgbW9kdWxlRXhwb3J0cykge1xuICAgIHZhciBjb21wb25lbnRNb2R1bGU7XG4gICAgdmFyIHJlc29sdmVkWG1sTW9kdWxlID0gbW9kdWxlX25hbWVfcmVzb2x2ZXJfMS5yZXNvbHZlTW9kdWxlTmFtZShtb2R1bGVOYW1lLCBcInhtbFwiKTtcbiAgICBpZiAocmVzb2x2ZWRYbWxNb2R1bGUpIHtcbiAgICAgICAgdmFyIHRleHQgPSBnbG9iYWwubG9hZE1vZHVsZShyZXNvbHZlZFhtbE1vZHVsZSwgdHJ1ZSk7XG4gICAgICAgIGNvbXBvbmVudE1vZHVsZSA9IHBhcnNlSW50ZXJuYWwodGV4dCwgbW9kdWxlRXhwb3J0cywgcmVzb2x2ZWRYbWxNb2R1bGUsIG1vZHVsZU5hbWUpO1xuICAgIH1cbiAgICB2YXIgY29tcG9uZW50VmlldyA9IGNvbXBvbmVudE1vZHVsZSAmJiBjb21wb25lbnRNb2R1bGUuY29tcG9uZW50O1xuICAgIGlmIChjb21wb25lbnRWaWV3KSB7XG4gICAgICAgIGNvbXBvbmVudFZpZXcuZXhwb3J0cyA9IG1vZHVsZUV4cG9ydHM7XG4gICAgICAgIGNvbXBvbmVudFZpZXcuX21vZHVsZU5hbWUgPSBtb2R1bGVOYW1lO1xuICAgIH1cbiAgICBpZiAoIWNvbXBvbmVudE1vZHVsZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBjb21wb25lbnQgZnJvbSBtb2R1bGU6IFwiICsgbW9kdWxlTmFtZSk7XG4gICAgfVxuICAgIHJldHVybiBjb21wb25lbnRNb2R1bGU7XG59XG5mdW5jdGlvbiBsb2FkQ3VzdG9tQ29tcG9uZW50KGNvbXBvbmVudE5hbWVzcGFjZSwgY29tcG9uZW50TmFtZSwgYXR0cmlidXRlcywgY29udGV4dCwgcGFyZW50UGFnZSwgaXNSb290Q29tcG9uZW50LCBtb2R1bGVOYW1lUGF0aCkge1xuICAgIGlmIChpc1Jvb3RDb21wb25lbnQgPT09IHZvaWQgMCkgeyBpc1Jvb3RDb21wb25lbnQgPSB0cnVlOyB9XG4gICAgaWYgKCFwYXJlbnRQYWdlICYmIGNvbnRleHQpIHtcbiAgICAgICAgcGFyZW50UGFnZSA9IGNvbnRleHRbXCJfcGFyZW50UGFnZVwiXTtcbiAgICAgICAgZGVsZXRlIGNvbnRleHRbXCJfcGFyZW50UGFnZVwiXTtcbiAgICB9XG4gICAgdmFyIHJlc3VsdDtcbiAgICBjb21wb25lbnROYW1lc3BhY2UgPSBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMS5zYW5pdGl6ZU1vZHVsZU5hbWUoY29tcG9uZW50TmFtZXNwYWNlKTtcbiAgICB2YXIgbW9kdWxlTmFtZSA9IGNvbXBvbmVudE5hbWVzcGFjZSArIFwiL1wiICsgY29tcG9uZW50TmFtZTtcbiAgICB2YXIgcmVzb2x2ZWRDb2RlTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSwgXCJcIik7XG4gICAgdmFyIHJlc29sdmVkWG1sTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSwgXCJ4bWxcIik7XG4gICAgdmFyIHJlc29sdmVkQ3NzTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSwgXCJjc3NcIik7XG4gICAgaWYgKHJlc29sdmVkWG1sTW9kdWxlTmFtZSkge1xuICAgICAgICB2YXIgc3ViRXhwb3J0cyA9IGNvbnRleHQ7XG4gICAgICAgIGlmIChyZXNvbHZlZENvZGVNb2R1bGVOYW1lKSB7XG4gICAgICAgICAgICBzdWJFeHBvcnRzID0gZ2xvYmFsLmxvYWRNb2R1bGUocmVzb2x2ZWRDb2RlTW9kdWxlTmFtZSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzdWJFeHBvcnRzKSB7XG4gICAgICAgICAgICBzdWJFeHBvcnRzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgc3ViRXhwb3J0c1tcIl9wYXJlbnRQYWdlXCJdID0gcGFyZW50UGFnZTtcbiAgICAgICAgcmVzdWx0ID0gbG9hZEludGVybmFsKG1vZHVsZU5hbWUsIHN1YkV4cG9ydHMpO1xuICAgICAgICBpZiAodHlwZXNfMS5pc0RlZmluZWQocmVzdWx0KSAmJiB0eXBlc18xLmlzRGVmaW5lZChyZXN1bHQuY29tcG9uZW50KSAmJiB0eXBlc18xLmlzRGVmaW5lZChhdHRyaWJ1dGVzKSkge1xuICAgICAgICAgICAgZm9yICh2YXIgYXR0ciBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50X2J1aWxkZXJfMS5zZXRQcm9wZXJ0eVZhbHVlKHJlc3VsdC5jb21wb25lbnQsIHN1YkV4cG9ydHMsIGNvbnRleHQsIGF0dHIsIGF0dHJpYnV0ZXNbYXR0cl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBjb21wb25lbnRfYnVpbGRlcl8xLmdldENvbXBvbmVudE1vZHVsZShjb21wb25lbnROYW1lLCBjb21wb25lbnROYW1lc3BhY2UsIGF0dHJpYnV0ZXMsIGNvbnRleHQsIG1vZHVsZU5hbWVQYXRoLCBpc1Jvb3RDb21wb25lbnQpO1xuICAgICAgICBpZiAoIXJlc29sdmVkQ3NzTW9kdWxlTmFtZSkge1xuICAgICAgICAgICAgcmVzb2x2ZWRDc3NNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfcmVzb2x2ZXJfMS5yZXNvbHZlTW9kdWxlTmFtZShjb21wb25lbnROYW1lc3BhY2UsIFwiY3NzXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChwYXJlbnRQYWdlICYmIHJlc29sdmVkQ3NzTW9kdWxlTmFtZSkge1xuICAgICAgICBwYXJlbnRQYWdlLmFkZENzc0ZpbGUocmVzb2x2ZWRDc3NNb2R1bGVOYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGdldEV4cG9ydHMoaW5zdGFuY2UpIHtcbiAgICB2YXIgaXNWaWV3ID0gISFpbnN0YW5jZS5fZG9tSWQ7XG4gICAgaWYgKCFpc1ZpZXcpIHtcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlLmV4cG9ydHMgfHwgaW5zdGFuY2U7XG4gICAgfVxuICAgIHZhciBleHBvcnRPYmplY3QgPSBpbnN0YW5jZS5leHBvcnRzO1xuICAgIHZhciBwYXJlbnQgPSBpbnN0YW5jZS5wYXJlbnQ7XG4gICAgd2hpbGUgKGV4cG9ydE9iamVjdCA9PT0gdW5kZWZpbmVkICYmIHBhcmVudCkge1xuICAgICAgICBleHBvcnRPYmplY3QgPSBwYXJlbnQuZXhwb3J0cztcbiAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDtcbiAgICB9XG4gICAgcmV0dXJuIGV4cG9ydE9iamVjdDtcbn1cbmZ1bmN0aW9uIHBhcnNlSW50ZXJuYWwodmFsdWUsIGNvbnRleHQsIHhtbE1vZHVsZSwgbW9kdWxlTmFtZSkge1xuICAgIHZhciBzdGFydDtcbiAgICB2YXIgdWk7XG4gICAgdmFyIGVycm9yRm9ybWF0ID0gKGRlYnVnXzEuZGVidWcgJiYgeG1sTW9kdWxlKSA/IHhtbDJ1aS5Tb3VyY2VFcnJvckZvcm1hdCh4bWxNb2R1bGUpIDogeG1sMnVpLlBvc2l0aW9uRXJyb3JGb3JtYXQ7XG4gICAgdmFyIGNvbXBvbmVudFNvdXJjZVRyYWNrZXIgPSAoZGVidWdfMS5kZWJ1ZyAmJiB4bWxNb2R1bGUpID8geG1sMnVpLkNvbXBvbmVudFNvdXJjZVRyYWNrZXIoeG1sTW9kdWxlKSA6IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIChzdGFydCA9IG5ldyB4bWwydWkuWG1sU3RyaW5nUGFyc2VyKGVycm9yRm9ybWF0KSlcbiAgICAgICAgLnBpcGUobmV3IHhtbDJ1aS5QbGF0Zm9ybUZpbHRlcigpKVxuICAgICAgICAucGlwZShuZXcgeG1sMnVpLlhtbFN0YXRlUGFyc2VyKHVpID0gbmV3IHhtbDJ1aS5Db21wb25lbnRQYXJzZXIoY29udGV4dCwgZXJyb3JGb3JtYXQsIGNvbXBvbmVudFNvdXJjZVRyYWNrZXIsIG1vZHVsZU5hbWUpKSk7XG4gICAgc3RhcnQucGFyc2UodmFsdWUpO1xuICAgIHJldHVybiB1aS5yb290Q29tcG9uZW50TW9kdWxlO1xufVxudmFyIHhtbDJ1aTtcbihmdW5jdGlvbiAoeG1sMnVpKSB7XG4gICAgdmFyIFhtbFByb2R1Y2VyQmFzZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhtbFByb2R1Y2VyQmFzZSgpIHtcbiAgICAgICAgfVxuICAgICAgICBYbWxQcm9kdWNlckJhc2UucHJvdG90eXBlLnBpcGUgPSBmdW5jdGlvbiAobmV4dCkge1xuICAgICAgICAgICAgdGhpcy5fbmV4dCA9IG5leHQ7XG4gICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfTtcbiAgICAgICAgWG1sUHJvZHVjZXJCYXNlLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIHRoaXMuX25leHQucGFyc2UoYXJncyk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBYbWxQcm9kdWNlckJhc2U7XG4gICAgfSgpKTtcbiAgICB4bWwydWkuWG1sUHJvZHVjZXJCYXNlID0gWG1sUHJvZHVjZXJCYXNlO1xuICAgIHZhciBYbWxTdHJpbmdQYXJzZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoWG1sU3RyaW5nUGFyc2VyLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBYbWxTdHJpbmdQYXJzZXIoZXJyb3IpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5lcnJvciA9IGVycm9yIHx8IFBvc2l0aW9uRXJyb3JGb3JtYXQ7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgWG1sU3RyaW5nUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHZhciB4bWxQYXJzZXIgPSBuZXcgeG1sLlhtbFBhcnNlcihmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm5leHQoYXJncyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IF90aGlzLmVycm9yKGUsIGFyZ3MucG9zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlLCBwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgX3RoaXMuZXJyb3IoZSwgcCk7XG4gICAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHhtbFBhcnNlci5wYXJzZSh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBYbWxTdHJpbmdQYXJzZXI7XG4gICAgfShYbWxQcm9kdWNlckJhc2UpKTtcbiAgICB4bWwydWkuWG1sU3RyaW5nUGFyc2VyID0gWG1sU3RyaW5nUGFyc2VyO1xuICAgIGZ1bmN0aW9uIFBvc2l0aW9uRXJyb3JGb3JtYXQoZSwgcCkge1xuICAgICAgICByZXR1cm4gbmV3IGRlYnVnXzEuU2NvcGVFcnJvcihlLCBcIlBhcnNpbmcgWE1MIGF0IFwiICsgcC5saW5lICsgXCI6XCIgKyBwLmNvbHVtbik7XG4gICAgfVxuICAgIHhtbDJ1aS5Qb3NpdGlvbkVycm9yRm9ybWF0ID0gUG9zaXRpb25FcnJvckZvcm1hdDtcbiAgICBmdW5jdGlvbiBTb3VyY2VFcnJvckZvcm1hdCh1cmkpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlLCBwKSB7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gcCA/IG5ldyBkZWJ1Z18xLlNvdXJjZSh1cmksIHAubGluZSwgcC5jb2x1bW4pIDogbmV3IGRlYnVnXzEuU291cmNlKHVyaSwgLTEsIC0xKTtcbiAgICAgICAgICAgIGUgPSBuZXcgZGVidWdfMS5Tb3VyY2VFcnJvcihlLCBzb3VyY2UsIFwiQnVpbGRpbmcgVUkgZnJvbSBYTUwuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGU7XG4gICAgICAgIH07XG4gICAgfVxuICAgIHhtbDJ1aS5Tb3VyY2VFcnJvckZvcm1hdCA9IFNvdXJjZUVycm9yRm9ybWF0O1xuICAgIGZ1bmN0aW9uIENvbXBvbmVudFNvdXJjZVRyYWNrZXIodXJpKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoY29tcG9uZW50LCBwKSB7XG4gICAgICAgICAgICBpZiAoIWRlYnVnXzEuU291cmNlLmdldChjb21wb25lbnQpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IHAgPyBuZXcgZGVidWdfMS5Tb3VyY2UodXJpLCBwLmxpbmUsIHAuY29sdW1uKSA6IG5ldyBkZWJ1Z18xLlNvdXJjZSh1cmksIC0xLCAtMSk7XG4gICAgICAgICAgICAgICAgZGVidWdfMS5Tb3VyY2Uuc2V0KGNvbXBvbmVudCwgc291cmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgeG1sMnVpLkNvbXBvbmVudFNvdXJjZVRyYWNrZXIgPSBDb21wb25lbnRTb3VyY2VUcmFja2VyO1xuICAgIHZhciBQbGF0Zm9ybUZpbHRlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhQbGF0Zm9ybUZpbHRlciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gUGxhdGZvcm1GaWx0ZXIoKSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgUGxhdGZvcm1GaWx0ZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIGlmIChhcmdzLmV2ZW50VHlwZSA9PT0geG1sLlBhcnNlckV2ZW50VHlwZS5TdGFydEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoUGxhdGZvcm1GaWx0ZXIuaXNQbGF0Zm9ybShhcmdzLmVsZW1lbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UGxhdGZvcm1Db250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBbHJlYWR5IGluICdcIiArIHRoaXMuY3VycmVudFBsYXRmb3JtQ29udGV4dCArIFwiJyBwbGF0Zm9ybSBjb250ZXh0IGFuZCBjYW5ub3Qgc3dpdGNoIHRvICdcIiArIGFyZ3MuZWxlbWVudE5hbWUgKyBcIicgcGxhdGZvcm0hIFBsYXRmb3JtIHRhZ3MgY2Fubm90IGJlIG5lc3RlZC5cIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGxhdGZvcm1Db250ZXh0ID0gYXJncy5lbGVtZW50TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcmdzLmV2ZW50VHlwZSA9PT0geG1sLlBhcnNlckV2ZW50VHlwZS5FbmRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKFBsYXRmb3JtRmlsdGVyLmlzUGxhdGZvcm0oYXJncy5lbGVtZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGxhdGZvcm1Db250ZXh0ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBsYXRmb3JtQ29udGV4dCAmJiAhUGxhdGZvcm1GaWx0ZXIuaXNDdXJlbnRQbGF0Zm9ybSh0aGlzLmN1cnJlbnRQbGF0Zm9ybUNvbnRleHQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5uZXh0KGFyZ3MpO1xuICAgICAgICB9O1xuICAgICAgICBQbGF0Zm9ybUZpbHRlci5pc1BsYXRmb3JtID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9Mb3dlciA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRvTG93ZXIgPT09IGFuZHJvaWQgfHwgdG9Mb3dlciA9PT0gaW9zO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9O1xuICAgICAgICBQbGF0Zm9ybUZpbHRlci5pc0N1cmVudFBsYXRmb3JtID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWUgJiYgdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gcGxhdGZvcm1fMS5kZXZpY2Uub3MudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFBsYXRmb3JtRmlsdGVyO1xuICAgIH0oWG1sUHJvZHVjZXJCYXNlKSk7XG4gICAgeG1sMnVpLlBsYXRmb3JtRmlsdGVyID0gUGxhdGZvcm1GaWx0ZXI7XG4gICAgdmFyIFhtbEFyZ3NSZXBsYXkgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoWG1sQXJnc1JlcGxheSwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gWG1sQXJnc1JlcGxheShhcmdzLCBlcnJvckZvcm1hdCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLmFyZ3MgPSBhcmdzO1xuICAgICAgICAgICAgX3RoaXMuZXJyb3IgPSBlcnJvckZvcm1hdDtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICBYbWxBcmdzUmVwbGF5LnByb3RvdHlwZS5yZXBsYXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5hcmdzLmZvckVhY2goZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5uZXh0KGFyZ3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBfdGhpcy5lcnJvcihlLCBhcmdzLnBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFhtbEFyZ3NSZXBsYXk7XG4gICAgfShYbWxQcm9kdWNlckJhc2UpKTtcbiAgICB4bWwydWkuWG1sQXJnc1JlcGxheSA9IFhtbEFyZ3NSZXBsYXk7XG4gICAgdmFyIFhtbFN0YXRlUGFyc2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gWG1sU3RhdGVQYXJzZXIoc3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgfVxuICAgICAgICBYbWxTdGF0ZVBhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IHRoaXMuc3RhdGUucGFyc2UoYXJncyk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBYbWxTdGF0ZVBhcnNlcjtcbiAgICB9KCkpO1xuICAgIHhtbDJ1aS5YbWxTdGF0ZVBhcnNlciA9IFhtbFN0YXRlUGFyc2VyO1xuICAgIHZhciBUZW1wbGF0ZVBhcnNlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFRlbXBsYXRlUGFyc2VyKHBhcmVudCwgdGVtcGxhdGVQcm9wZXJ0eSwgc2V0VGVtcGxhdGVQcm9wZXJ0eSkge1xuICAgICAgICAgICAgaWYgKHNldFRlbXBsYXRlUHJvcGVydHkgPT09IHZvaWQgMCkgeyBzZXRUZW1wbGF0ZVByb3BlcnR5ID0gdHJ1ZTsgfVxuICAgICAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0ID0gdGVtcGxhdGVQcm9wZXJ0eS5jb250ZXh0O1xuICAgICAgICAgICAgdGhpcy5fcmVjb3JkZWRYbWxTdHJlYW0gPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgICAgIHRoaXMuX3RlbXBsYXRlUHJvcGVydHkgPSB0ZW1wbGF0ZVByb3BlcnR5O1xuICAgICAgICAgICAgdGhpcy5fbmVzdGluZ0xldmVsID0gMDtcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gMDtcbiAgICAgICAgICAgIHRoaXMuX3NldFRlbXBsYXRlUHJvcGVydHkgPSBzZXRUZW1wbGF0ZVByb3BlcnR5O1xuICAgICAgICB9XG4gICAgICAgIFRlbXBsYXRlUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuU3RhcnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJzZVN0YXJ0RWxlbWVudChhcmdzLnByZWZpeCwgYXJncy5uYW1lc3BhY2UsIGFyZ3MuZWxlbWVudE5hbWUsIGFyZ3MuYXR0cmlidXRlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhcmdzLmV2ZW50VHlwZSA9PT0geG1sLlBhcnNlckV2ZW50VHlwZS5FbmRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJzZUVuZEVsZW1lbnQoYXJncy5wcmVmaXgsIGFyZ3MuZWxlbWVudE5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcmVjb3JkZWRYbWxTdHJlYW0ucHVzaChhcmdzKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdGF0ZSA9PT0gMiA/IHRoaXMucGFyZW50IDogdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRlbXBsYXRlUGFyc2VyLnByb3RvdHlwZSwgXCJlbGVtZW50TmFtZVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdGVtcGxhdGVQcm9wZXJ0eS5lbGVtZW50TmFtZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBUZW1wbGF0ZVBhcnNlci5wcm90b3R5cGUucGFyc2VTdGFydEVsZW1lbnQgPSBmdW5jdGlvbiAocHJlZml4LCBuYW1lc3BhY2UsIGVsZW1lbnROYW1lLCBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdGUgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLl9zdGF0ZSA9PT0gMikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRlbXBsYXRlIG11c3QgaGF2ZSBleGFjdGx5IG9uZSByb290IGVsZW1lbnQgYnV0IG11bHRpcGxlIGVsZW1lbnRzIHdlcmUgZm91bmQuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fbmVzdGluZ0xldmVsKys7XG4gICAgICAgIH07XG4gICAgICAgIFRlbXBsYXRlUGFyc2VyLnByb3RvdHlwZS5wYXJzZUVuZEVsZW1lbnQgPSBmdW5jdGlvbiAocHJlZml4LCBlbGVtZW50TmFtZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGVtcGxhdGUgbXVzdCBoYXZlIGV4YWN0bHkgb25lIHJvb3QgZWxlbWVudCBidXQgbm9uZSB3YXMgZm91bmQuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5fc3RhdGUgPT09IDIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBtb3JlIGNsb3NpbmcgZWxlbWVudHMgZXhwZWN0ZWQgZm9yIHRoaXMgdGVtcGxhdGUuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fbmVzdGluZ0xldmVsLS07XG4gICAgICAgICAgICBpZiAodGhpcy5fbmVzdGluZ0xldmVsID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSAyO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zZXRUZW1wbGF0ZVByb3BlcnR5ICYmIHRoaXMuX3RlbXBsYXRlUHJvcGVydHkubmFtZSBpbiB0aGlzLl90ZW1wbGF0ZVByb3BlcnR5LnBhcmVudC5jb21wb25lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gdGhpcy5idWlsZFRlbXBsYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RlbXBsYXRlUHJvcGVydHkucGFyZW50LmNvbXBvbmVudFt0aGlzLl90ZW1wbGF0ZVByb3BlcnR5Lm5hbWVdID0gdGVtcGxhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBUZW1wbGF0ZVBhcnNlci5wcm90b3R5cGUuYnVpbGRUZW1wbGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuX2NvbnRleHQ7XG4gICAgICAgICAgICB2YXIgZXJyb3JGb3JtYXQgPSB0aGlzLl90ZW1wbGF0ZVByb3BlcnR5LmVycm9yRm9ybWF0O1xuICAgICAgICAgICAgdmFyIHNvdXJjZVRyYWNrZXIgPSB0aGlzLl90ZW1wbGF0ZVByb3BlcnR5LnNvdXJjZVRyYWNrZXI7XG4gICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSBwcm9maWxpbmdfMS5wcm9maWxlKFwiVGVtcGxhdGUoKVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0O1xuICAgICAgICAgICAgICAgIHZhciB1aTtcbiAgICAgICAgICAgICAgICAoc3RhcnQgPSBuZXcgeG1sMnVpLlhtbEFyZ3NSZXBsYXkoX3RoaXMuX3JlY29yZGVkWG1sU3RyZWFtLCBlcnJvckZvcm1hdCkpXG4gICAgICAgICAgICAgICAgICAgIC5waXBlKG5ldyBYbWxTdGF0ZVBhcnNlcih1aSA9IG5ldyBDb21wb25lbnRQYXJzZXIoY29udGV4dCwgZXJyb3JGb3JtYXQsIHNvdXJjZVRyYWNrZXIpKSk7XG4gICAgICAgICAgICAgICAgc3RhcnQucmVwbGF5KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVpLnJvb3RDb21wb25lbnRNb2R1bGUuY29tcG9uZW50O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGVtcGxhdGU7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBUZW1wbGF0ZVBhcnNlcjtcbiAgICB9KCkpO1xuICAgIHhtbDJ1aS5UZW1wbGF0ZVBhcnNlciA9IFRlbXBsYXRlUGFyc2VyO1xuICAgIHZhciBNdWx0aVRlbXBsYXRlUGFyc2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gTXVsdGlUZW1wbGF0ZVBhcnNlcihwYXJlbnQsIHRlbXBsYXRlUHJvcGVydHkpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZVByb3BlcnR5ID0gdGVtcGxhdGVQcm9wZXJ0eTtcbiAgICAgICAgICAgIHRoaXMuX2NoaWxkUGFyc2VycyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB9XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNdWx0aVRlbXBsYXRlUGFyc2VyLnByb3RvdHlwZSwgXCJ2YWx1ZVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX3ZhbHVlOyB9LFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgTXVsdGlUZW1wbGF0ZVBhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgaWYgKGFyZ3MuZXZlbnRUeXBlID09PSB4bWwuUGFyc2VyRXZlbnRUeXBlLlN0YXJ0RWxlbWVudCAmJiBhcmdzLmVsZW1lbnROYW1lID09PSBcInRlbXBsYXRlXCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRQYXJzZXIgPSBuZXcgVGVtcGxhdGVQYXJzZXIodGhpcywgdGhpcy50ZW1wbGF0ZVByb3BlcnR5LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgY2hpbGRQYXJzZXJbXCJrZXlcIl0gPSBhcmdzLmF0dHJpYnV0ZXNbXCJrZXlcIl07XG4gICAgICAgICAgICAgICAgdGhpcy5fY2hpbGRQYXJzZXJzLnB1c2goY2hpbGRQYXJzZXIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZFBhcnNlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcmdzLmV2ZW50VHlwZSA9PT0geG1sLlBhcnNlckV2ZW50VHlwZS5FbmRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWVfMSA9IENvbXBvbmVudFBhcnNlci5nZXRDb21wbGV4UHJvcGVydHlOYW1lKGFyZ3MuZWxlbWVudE5hbWUpO1xuICAgICAgICAgICAgICAgIGlmIChuYW1lXzEgPT09IHRoaXMudGVtcGxhdGVQcm9wZXJ0eS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9jaGlsZFBhcnNlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IHRoaXMuX2NoaWxkUGFyc2Vyc1tpXVtcImtleVwiXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVWaWV3OiB0aGlzLl9jaGlsZFBhcnNlcnNbaV0uYnVpbGRUZW1wbGF0ZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl92YWx1ZSA9IHRlbXBsYXRlcztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50LnBhcnNlKGFyZ3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gTXVsdGlUZW1wbGF0ZVBhcnNlcjtcbiAgICB9KCkpO1xuICAgIHhtbDJ1aS5NdWx0aVRlbXBsYXRlUGFyc2VyID0gTXVsdGlUZW1wbGF0ZVBhcnNlcjtcbiAgICB2YXIgQ29tcG9uZW50UGFyc2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gQ29tcG9uZW50UGFyc2VyKGNvbnRleHQsIGVycm9yRm9ybWF0LCBzb3VyY2VUcmFja2VyLCBtb2R1bGVOYW1lKSB7XG4gICAgICAgICAgICB0aGlzLm1vZHVsZU5hbWUgPSBtb2R1bGVOYW1lO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnRzID0gbmV3IEFycmF5KCk7XG4gICAgICAgICAgICB0aGlzLmNvbXBsZXhQcm9wZXJ0aWVzID0gbmV3IEFycmF5KCk7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yRm9ybWF0O1xuICAgICAgICAgICAgdGhpcy5zb3VyY2VUcmFja2VyID0gc291cmNlVHJhY2tlcjtcbiAgICAgICAgfVxuICAgICAgICBDb21wb25lbnRQYXJzZXIucHJvdG90eXBlLmJ1aWxkQ29tcG9uZW50ID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIGlmIChhcmdzLnByZWZpeCAmJiBhcmdzLm5hbWVzcGFjZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkQ3VzdG9tQ29tcG9uZW50KGFyZ3MubmFtZXNwYWNlLCBhcmdzLmVsZW1lbnROYW1lLCBhcmdzLmF0dHJpYnV0ZXMsIHRoaXMuY29udGV4dCwgdGhpcy5jdXJyZW50Um9vdFZpZXcsICF0aGlzLmN1cnJlbnRSb290VmlldywgdGhpcy5tb2R1bGVOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBuYW1lc3BhY2UgPSBhcmdzLm5hbWVzcGFjZTtcbiAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdE5hbWVTcGFjZU1hdGNoZXIudGVzdChuYW1lc3BhY2UgfHwgXCJcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9uZW50X2J1aWxkZXJfMS5nZXRDb21wb25lbnRNb2R1bGUoYXJncy5lbGVtZW50TmFtZSwgbmFtZXNwYWNlLCBhcmdzLmF0dHJpYnV0ZXMsIHRoaXMuY29udGV4dCwgdGhpcy5tb2R1bGVOYW1lLCAhdGhpcy5jdXJyZW50Um9vdFZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBDb21wb25lbnRQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudHNbdGhpcy5wYXJlbnRzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgdmFyIGNvbXBsZXhQcm9wZXJ0eSA9IHRoaXMuY29tcGxleFByb3BlcnRpZXNbdGhpcy5jb21wbGV4UHJvcGVydGllcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGlmIChhcmdzLmV2ZW50VHlwZSA9PT0geG1sLlBhcnNlckV2ZW50VHlwZS5TdGFydEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoQ29tcG9uZW50UGFyc2VyLmlzQ29tcGxleFByb3BlcnR5KGFyZ3MuZWxlbWVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lXzIgPSBDb21wb25lbnRQYXJzZXIuZ2V0Q29tcGxleFByb3BlcnR5TmFtZShhcmdzLmVsZW1lbnROYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBsZXhQcm9wZXJ0eV8xID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBwYXJlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lXzIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogW11cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wbGV4UHJvcGVydGllcy5wdXNoKGNvbXBsZXhQcm9wZXJ0eV8xKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKENvbXBvbmVudFBhcnNlci5pc0tub3duVGVtcGxhdGUobmFtZV8yLCBwYXJlbnQuZXhwb3J0cykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVGVtcGxhdGVQYXJzZXIodGhpcywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQ6IChwYXJlbnQgPyBnZXRFeHBvcnRzKHBhcmVudC5jb21wb25lbnQpIDogbnVsbCkgfHwgdGhpcy5jb250ZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogcGFyZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWVfMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50TmFtZTogYXJncy5lbGVtZW50TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZUl0ZW1zOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckZvcm1hdDogdGhpcy5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VUcmFja2VyOiB0aGlzLnNvdXJjZVRyYWNrZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChDb21wb25lbnRQYXJzZXIuaXNLbm93bk11bHRpVGVtcGxhdGUobmFtZV8yLCBwYXJlbnQuZXhwb3J0cykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgTXVsdGlUZW1wbGF0ZVBhcnNlcih0aGlzLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dDogKHBhcmVudCA/IGdldEV4cG9ydHMocGFyZW50LmNvbXBvbmVudCkgOiBudWxsKSB8fCB0aGlzLmNvbnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBwYXJlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZV8yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnROYW1lOiBhcmdzLmVsZW1lbnROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlSXRlbXM6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yRm9ybWF0OiB0aGlzLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVRyYWNrZXI6IHRoaXMuc291cmNlVHJhY2tlclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV4UHJvcGVydHlfMS5wYXJzZXIgPSBwYXJzZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29tcG9uZW50TW9kdWxlID0gdGhpcy5idWlsZENvbXBvbmVudChhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBvbmVudE1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zb3VyY2VUcmFja2VyKGNvbXBvbmVudE1vZHVsZS5jb21wb25lbnQsIGFyZ3MucG9zaXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wbGV4UHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29tcG9uZW50UGFyc2VyLmFkZFRvQ29tcGxleFByb3BlcnR5KHBhcmVudCwgY29tcGxleFByb3BlcnR5LCBjb21wb25lbnRNb2R1bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChwYXJlbnQuY29tcG9uZW50Ll9hZGRDaGlsZEZyb21CdWlsZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5jb21wb25lbnQuX2FkZENoaWxkRnJvbUJ1aWxkZXIoYXJncy5lbGVtZW50TmFtZSwgY29tcG9uZW50TW9kdWxlLmNvbXBvbmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wYXJlbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucm9vdENvbXBvbmVudE1vZHVsZSA9IGNvbXBvbmVudE1vZHVsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yb290Q29tcG9uZW50TW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvb3RWaWV3ID0gdGhpcy5yb290Q29tcG9uZW50TW9kdWxlLmNvbXBvbmVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFJvb3RWaWV3LmV4cG9ydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dCA9IHRoaXMuY3VycmVudFJvb3RWaWV3LmV4cG9ydHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudHMucHVzaChjb21wb25lbnRNb2R1bGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuRW5kRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChDb21wb25lbnRQYXJzZXIuaXNDb21wbGV4UHJvcGVydHkoYXJncy5lbGVtZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBsZXhQcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBsZXhQcm9wZXJ0eS5wYXJzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuY29tcG9uZW50W2NvbXBsZXhQcm9wZXJ0eS5uYW1lXSA9IGNvbXBsZXhQcm9wZXJ0eS5wYXJzZXIudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChwYXJlbnQgJiYgcGFyZW50LmNvbXBvbmVudC5fYWRkQXJyYXlGcm9tQnVpbGRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5jb21wb25lbnQuX2FkZEFycmF5RnJvbUJ1aWxkZXIoY29tcGxleFByb3BlcnR5Lm5hbWUsIGNvbXBsZXhQcm9wZXJ0eS5pdGVtcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxleFByb3BlcnR5Lml0ZW1zID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wbGV4UHJvcGVydGllcy5wb3AoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50cy5wb3AoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLmlzQ29tcGxleFByb3BlcnR5ID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB0eXBlc18xLmlzU3RyaW5nKG5hbWUpICYmIG5hbWUuaW5kZXhPZihcIi5cIikgIT09IC0xO1xuICAgICAgICB9O1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuZ2V0Q29tcGxleFByb3BlcnR5TmFtZSA9IGZ1bmN0aW9uIChmdWxsTmFtZSkge1xuICAgICAgICAgICAgdmFyIG5hbWU7XG4gICAgICAgICAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhmdWxsTmFtZSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZXMgPSBmdWxsTmFtZS5zcGxpdChcIi5cIik7XG4gICAgICAgICAgICAgICAgbmFtZSA9IG5hbWVzW25hbWVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5hbWU7XG4gICAgICAgIH07XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5pc0tub3duVGVtcGxhdGUgPSBmdW5jdGlvbiAobmFtZSwgZXhwb3J0cykge1xuICAgICAgICAgICAgcmV0dXJuIENvbXBvbmVudFBhcnNlci5LTk9XTlRFTVBMQVRFUyBpbiBleHBvcnRzICYmIGV4cG9ydHNbQ29tcG9uZW50UGFyc2VyLktOT1dOVEVNUExBVEVTXSAmJiBuYW1lIGluIGV4cG9ydHNbQ29tcG9uZW50UGFyc2VyLktOT1dOVEVNUExBVEVTXTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLmlzS25vd25NdWx0aVRlbXBsYXRlID0gZnVuY3Rpb24gKG5hbWUsIGV4cG9ydHMpIHtcbiAgICAgICAgICAgIHJldHVybiBDb21wb25lbnRQYXJzZXIuS05PV05NVUxUSVRFTVBMQVRFUyBpbiBleHBvcnRzICYmIGV4cG9ydHNbQ29tcG9uZW50UGFyc2VyLktOT1dOTVVMVElURU1QTEFURVNdICYmIG5hbWUgaW4gZXhwb3J0c1tDb21wb25lbnRQYXJzZXIuS05PV05NVUxUSVRFTVBMQVRFU107XG4gICAgICAgIH07XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5hZGRUb0NvbXBsZXhQcm9wZXJ0eSA9IGZ1bmN0aW9uIChwYXJlbnQsIGNvbXBsZXhQcm9wZXJ0eSwgZWxlbWVudE1vZHVsZSkge1xuICAgICAgICAgICAgdmFyIHBhcmVudENvbXBvbmVudCA9IHBhcmVudC5jb21wb25lbnQ7XG4gICAgICAgICAgICBpZiAoQ29tcG9uZW50UGFyc2VyLmlzS25vd25Db2xsZWN0aW9uKGNvbXBsZXhQcm9wZXJ0eS5uYW1lLCBwYXJlbnQuZXhwb3J0cykpIHtcbiAgICAgICAgICAgICAgICBjb21wbGV4UHJvcGVydHkuaXRlbXMucHVzaChlbGVtZW50TW9kdWxlLmNvbXBvbmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwYXJlbnRDb21wb25lbnQuX2FkZENoaWxkRnJvbUJ1aWxkZXIpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRDb21wb25lbnQuX2FkZENoaWxkRnJvbUJ1aWxkZXIoY29tcGxleFByb3BlcnR5Lm5hbWUsIGVsZW1lbnRNb2R1bGUuY29tcG9uZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHBhcmVudENvbXBvbmVudFtjb21wbGV4UHJvcGVydHkubmFtZV0gPSBlbGVtZW50TW9kdWxlLmNvbXBvbmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLmlzS25vd25Db2xsZWN0aW9uID0gZnVuY3Rpb24gKG5hbWUsIGNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBDb21wb25lbnRQYXJzZXIuS05PV05DT0xMRUNUSU9OUyBpbiBjb250ZXh0ICYmIGNvbnRleHRbQ29tcG9uZW50UGFyc2VyLktOT1dOQ09MTEVDVElPTlNdICYmIG5hbWUgaW4gY29udGV4dFtDb21wb25lbnRQYXJzZXIuS05PV05DT0xMRUNUSU9OU107XG4gICAgICAgIH07XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5LTk9XTkNPTExFQ1RJT05TID0gXCJrbm93bkNvbGxlY3Rpb25zXCI7XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5LTk9XTlRFTVBMQVRFUyA9IFwia25vd25UZW1wbGF0ZXNcIjtcbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLktOT1dOTVVMVElURU1QTEFURVMgPSBcImtub3duTXVsdGlUZW1wbGF0ZXNcIjtcbiAgICAgICAgX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgICAgIF0sIENvbXBvbmVudFBhcnNlci5wcm90b3R5cGUsIFwiYnVpbGRDb21wb25lbnRcIiwgbnVsbCk7XG4gICAgICAgIHJldHVybiBDb21wb25lbnRQYXJzZXI7XG4gICAgfSgpKTtcbiAgICB4bWwydWkuQ29tcG9uZW50UGFyc2VyID0gQ29tcG9uZW50UGFyc2VyO1xufSkoeG1sMnVpIHx8ICh4bWwydWkgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YnVpbGRlci5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYmluZGFibGVfMSA9IHJlcXVpcmUoXCIuLi8uLi9jb3JlL2JpbmRhYmxlXCIpO1xudmFyIGJpbmRpbmdfYnVpbGRlcl8xID0gcmVxdWlyZShcIi4uL2JpbmRpbmctYnVpbGRlclwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9wcm9maWxpbmdcIik7XG52YXIgcGxhdGZvcm0gPSByZXF1aXJlKFwiLi4vLi4vLi4vcGxhdGZvcm1cIik7XG52YXIgbW9kdWxlX25hbWVfc2FuaXRpemVyXzEgPSByZXF1aXJlKFwiLi4vbW9kdWxlLW5hbWUtc2FuaXRpemVyXCIpO1xudmFyIG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vbW9kdWxlLW5hbWUtcmVzb2x2ZXJcIik7XG52YXIgVUlfUEFUSCA9IFwidWkvXCI7XG52YXIgTU9EVUxFUyA9IHtcbiAgICBcIlRhYlZpZXdJdGVtXCI6IFwidWkvdGFiLXZpZXdcIixcbiAgICBcIlRhYlN0cmlwXCI6IFwidWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXBcIixcbiAgICBcIlRhYlN0cmlwSXRlbVwiOiBcInVpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwLWl0ZW1cIixcbiAgICBcIlRhYkNvbnRlbnRJdGVtXCI6IFwidWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItY29udGVudC1pdGVtXCIsXG4gICAgXCJGb3JtYXR0ZWRTdHJpbmdcIjogXCJ0ZXh0L2Zvcm1hdHRlZC1zdHJpbmdcIixcbiAgICBcIlNwYW5cIjogXCJ0ZXh0L3NwYW5cIixcbiAgICBcIkFjdGlvbkl0ZW1cIjogXCJ1aS9hY3Rpb24tYmFyXCIsXG4gICAgXCJOYXZpZ2F0aW9uQnV0dG9uXCI6IFwidWkvYWN0aW9uLWJhclwiLFxuICAgIFwiU2VnbWVudGVkQmFySXRlbVwiOiBcInVpL3NlZ21lbnRlZC1iYXJcIixcbn07XG52YXIgQ09ERV9GSUxFID0gXCJjb2RlRmlsZVwiO1xudmFyIENTU19GSUxFID0gXCJjc3NGaWxlXCI7XG52YXIgSU1QT1JUID0gXCJpbXBvcnRcIjtcbnZhciBjcmVhdGVDb21wb25lbnRJbnN0YW5jZSA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJjcmVhdGVDb21wb25lbnRJbnN0YW5jZVwiLCBmdW5jdGlvbiAoZWxlbWVudE5hbWUsIG5hbWVzcGFjZSkge1xuICAgIHZhciBpbnN0YW5jZTtcbiAgICB2YXIgaW5zdGFuY2VNb2R1bGU7XG4gICAgdmFyIHJlc29sdmVkTW9kdWxlTmFtZTtcbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIG5hbWVzcGFjZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgcmVzb2x2ZWRNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfcmVzb2x2ZXJfMS5yZXNvbHZlTW9kdWxlTmFtZShuYW1lc3BhY2UsIFwiXCIpO1xuICAgICAgICAgICAgaW5zdGFuY2VNb2R1bGUgPSBnbG9iYWwubG9hZE1vZHVsZShyZXNvbHZlZE1vZHVsZU5hbWUsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZWRNb2R1bGVOYW1lID0gTU9EVUxFU1tlbGVtZW50TmFtZV0gfHwgVUlfUEFUSCArXG4gICAgICAgICAgICAgICAgKGVsZW1lbnROYW1lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihcImxheW91dFwiKSAhPT0gLTEgPyBcImxheW91dHMvXCIgOiBcIlwiKSArXG4gICAgICAgICAgICAgICAgZWxlbWVudE5hbWUuc3BsaXQoLyg/PVtBLVpdKS8pLmpvaW4oXCItXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBpbnN0YW5jZU1vZHVsZSA9IGdsb2JhbC5sb2FkTW9kdWxlKHJlc29sdmVkTW9kdWxlTmFtZSwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnN0YW5jZVR5cGUgPSBpbnN0YW5jZU1vZHVsZVtlbGVtZW50TmFtZV0gfHwgT2JqZWN0O1xuICAgICAgICBpbnN0YW5jZSA9IG5ldyBpbnN0YW5jZVR5cGUoKTtcbiAgICB9XG4gICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgIHZhciBkZWJ1ZyA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy9kZWJ1Z1wiKTtcbiAgICAgICAgdGhyb3cgbmV3IGRlYnVnLlNjb3BlRXJyb3IoZXgsIFwiTW9kdWxlICdcIiArIHJlc29sdmVkTW9kdWxlTmFtZSArIFwiJyBub3QgZm91bmQgZm9yIGVsZW1lbnQgJ1wiICsgKG5hbWVzcGFjZSA/IG5hbWVzcGFjZSArIFwiOlwiIDogXCJcIikgKyBlbGVtZW50TmFtZSArIFwiJy5cIik7XG4gICAgfVxuICAgIHJldHVybiB7IGluc3RhbmNlOiBpbnN0YW5jZSwgaW5zdGFuY2VNb2R1bGU6IGluc3RhbmNlTW9kdWxlIH07XG59KTtcbnZhciBnZXRDb21wb25lbnRNb2R1bGVFeHBvcnRzID0gcHJvZmlsaW5nXzEucHJvZmlsZShcImdldENvbXBvbmVudE1vZHVsZUV4cG9ydHNcIiwgZnVuY3Rpb24gKGluc3RhbmNlLCBtb2R1bGVFeHBvcnRzLCBhdHRyaWJ1dGVzKSB7XG4gICAgaWYgKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgdmFyIGNvZGVGaWxlQXR0cmlidXRlID0gYXR0cmlidXRlc1tDT0RFX0ZJTEVdIHx8IGF0dHJpYnV0ZXNbSU1QT1JUXTtcbiAgICAgICAgaWYgKGNvZGVGaWxlQXR0cmlidXRlKSB7XG4gICAgICAgICAgICB2YXIgcmVzb2x2ZWRDb2RlRmlsZU1vZHVsZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobW9kdWxlX25hbWVfc2FuaXRpemVyXzEuc2FuaXRpemVNb2R1bGVOYW1lKGNvZGVGaWxlQXR0cmlidXRlKSwgXCJcIik7XG4gICAgICAgICAgICBpZiAocmVzb2x2ZWRDb2RlRmlsZU1vZHVsZSkge1xuICAgICAgICAgICAgICAgIG1vZHVsZUV4cG9ydHMgPSBnbG9iYWwubG9hZE1vZHVsZShyZXNvbHZlZENvZGVGaWxlTW9kdWxlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5leHBvcnRzID0gbW9kdWxlRXhwb3J0cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvZGUgZmlsZSB3aXRoIHBhdGggXFxcIlwiICsgY29kZUZpbGVBdHRyaWJ1dGUgKyBcIlxcXCIgY2Fubm90IGJlIGZvdW5kISBMb29raW5nIGZvciB3ZWJwYWNrIG1vZHVsZSB3aXRoIG5hbWUgXFxcIlwiICsgcmVzb2x2ZWRDb2RlRmlsZU1vZHVsZSArIFwiXFxcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbW9kdWxlRXhwb3J0cztcbn0pO1xudmFyIGFwcGx5Q29tcG9uZW50Q3NzID0gcHJvZmlsaW5nXzEucHJvZmlsZShcImFwcGx5Q29tcG9uZW50Q3NzXCIsIGZ1bmN0aW9uIChpbnN0YW5jZSwgbW9kdWxlTmFtZSwgYXR0cmlidXRlcykge1xuICAgIHZhciBjc3NBcHBsaWVkID0gZmFsc2U7XG4gICAgaWYgKGF0dHJpYnV0ZXMgJiYgYXR0cmlidXRlc1tDU1NfRklMRV0pIHtcbiAgICAgICAgdmFyIHJlc29sdmVkQ3NzTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobW9kdWxlX25hbWVfc2FuaXRpemVyXzEuc2FuaXRpemVNb2R1bGVOYW1lKGF0dHJpYnV0ZXNbQ1NTX0ZJTEVdKSwgXCJjc3NcIik7XG4gICAgICAgIGlmIChyZXNvbHZlZENzc01vZHVsZU5hbWUpIHtcbiAgICAgICAgICAgIGluc3RhbmNlLmFkZENzc0ZpbGUocmVzb2x2ZWRDc3NNb2R1bGVOYW1lKTtcbiAgICAgICAgICAgIGNzc0FwcGxpZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ3NzIGZpbGUgd2l0aCBwYXRoIFxcXCJcIiArIGF0dHJpYnV0ZXNbQ1NTX0ZJTEVdICsgXCJcXFwiIGNhbm5vdCBiZSBmb3VuZCEgTG9va2luZyBmb3Igd2VicGFjayBtb2R1bGUgd2l0aCBuYW1lIFxcXCJcIiArIHJlc29sdmVkQ3NzTW9kdWxlTmFtZSArIFwiXFxcIlwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAobW9kdWxlTmFtZSAmJiAhY3NzQXBwbGllZCkge1xuICAgICAgICB2YXIgcmVzb2x2ZWRDc3NNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfcmVzb2x2ZXJfMS5yZXNvbHZlTW9kdWxlTmFtZShtb2R1bGVOYW1lLCBcImNzc1wiKTtcbiAgICAgICAgaWYgKHJlc29sdmVkQ3NzTW9kdWxlTmFtZSkge1xuICAgICAgICAgICAgaW5zdGFuY2UuYWRkQ3NzRmlsZShyZXNvbHZlZENzc01vZHVsZU5hbWUpO1xuICAgICAgICB9XG4gICAgfVxufSk7XG52YXIgYXBwbHlDb21wb25lbnRBdHRyaWJ1dGVzID0gcHJvZmlsaW5nXzEucHJvZmlsZShcImFwcGx5Q29tcG9uZW50QXR0cmlidXRlc1wiLCBmdW5jdGlvbiAoaW5zdGFuY2UsIGluc3RhbmNlTW9kdWxlLCBtb2R1bGVFeHBvcnRzLCBhdHRyaWJ1dGVzKSB7XG4gICAgaWYgKGluc3RhbmNlICYmIGluc3RhbmNlTW9kdWxlKSB7XG4gICAgICAgIGZvciAodmFyIGF0dHIgaW4gYXR0cmlidXRlcykge1xuICAgICAgICAgICAgdmFyIGF0dHJWYWx1ZSA9IGF0dHJpYnV0ZXNbYXR0cl07XG4gICAgICAgICAgICBpZiAoYXR0ci5pbmRleE9mKFwiOlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGxhdGZvcm1OYW1lID0gYXR0ci5zcGxpdChcIjpcIilbMF0udHJpbSgpO1xuICAgICAgICAgICAgICAgIGlmIChwbGF0Zm9ybU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gcGxhdGZvcm0uZGV2aWNlLm9zLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0ciA9IGF0dHIuc3BsaXQoXCI6XCIpWzFdLnRyaW0oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhdHRyLmluZGV4T2YoXCIuXCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHZhciBzdWJPYmogPSBpbnN0YW5jZTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvcGVydGllcyA9IGF0dHIuc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9wTmFtZSA9IHByb3BlcnRpZXNbcHJvcGVydGllcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BlcnRpZXMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJPYmogIT09IHVuZGVmaW5lZCAmJiBzdWJPYmogIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Yk9iaiA9IHN1Yk9ialtwcm9wZXJ0aWVzW2ldXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc3ViT2JqICE9PSB1bmRlZmluZWQgJiYgc3ViT2JqICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFByb3BlcnR5VmFsdWUoc3ViT2JqLCBpbnN0YW5jZU1vZHVsZSwgbW9kdWxlRXhwb3J0cywgc3ViUHJvcE5hbWUsIGF0dHJWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2V0UHJvcGVydHlWYWx1ZShpbnN0YW5jZSwgaW5zdGFuY2VNb2R1bGUsIG1vZHVsZUV4cG9ydHMsIGF0dHIsIGF0dHJWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcbmZ1bmN0aW9uIGdldENvbXBvbmVudE1vZHVsZShlbGVtZW50TmFtZSwgbmFtZXNwYWNlLCBhdHRyaWJ1dGVzLCBtb2R1bGVFeHBvcnRzLCBtb2R1bGVOYW1lUGF0aCwgaXNSb290Q29tcG9uZW50KSB7XG4gICAgZWxlbWVudE5hbWUgPSBlbGVtZW50TmFtZS5zcGxpdChcIi1cIikubWFwKGZ1bmN0aW9uIChzKSB7IHJldHVybiBzWzBdLnRvVXBwZXJDYXNlKCkgKyBzLnN1YnN0cmluZygxKTsgfSkuam9pbihcIlwiKTtcbiAgICB2YXIgX2EgPSBjcmVhdGVDb21wb25lbnRJbnN0YW5jZShlbGVtZW50TmFtZSwgbmFtZXNwYWNlKSwgaW5zdGFuY2UgPSBfYS5pbnN0YW5jZSwgaW5zdGFuY2VNb2R1bGUgPSBfYS5pbnN0YW5jZU1vZHVsZTtcbiAgICBtb2R1bGVFeHBvcnRzID0gZ2V0Q29tcG9uZW50TW9kdWxlRXhwb3J0cyhpbnN0YW5jZSwgbW9kdWxlRXhwb3J0cywgYXR0cmlidXRlcyk7XG4gICAgaWYgKGlzUm9vdENvbXBvbmVudCkge1xuICAgICAgICBhcHBseUNvbXBvbmVudENzcyhpbnN0YW5jZSwgbW9kdWxlTmFtZVBhdGgsIGF0dHJpYnV0ZXMpO1xuICAgIH1cbiAgICBhcHBseUNvbXBvbmVudEF0dHJpYnV0ZXMoaW5zdGFuY2UsIGluc3RhbmNlTW9kdWxlLCBtb2R1bGVFeHBvcnRzLCBhdHRyaWJ1dGVzKTtcbiAgICB2YXIgY29tcG9uZW50TW9kdWxlO1xuICAgIGlmIChpbnN0YW5jZSAmJiBpbnN0YW5jZU1vZHVsZSkge1xuICAgICAgICBjb21wb25lbnRNb2R1bGUgPSB7IGNvbXBvbmVudDogaW5zdGFuY2UsIGV4cG9ydHM6IGluc3RhbmNlTW9kdWxlIH07XG4gICAgfVxuICAgIHJldHVybiBjb21wb25lbnRNb2R1bGU7XG59XG5leHBvcnRzLmdldENvbXBvbmVudE1vZHVsZSA9IGdldENvbXBvbmVudE1vZHVsZTtcbmZ1bmN0aW9uIHNldFByb3BlcnR5VmFsdWUoaW5zdGFuY2UsIGluc3RhbmNlTW9kdWxlLCBleHBvcnRzLCBwcm9wZXJ0eU5hbWUsIHByb3BlcnR5VmFsdWUpIHtcbiAgICBpZiAoaXNCaW5kaW5nKHByb3BlcnR5VmFsdWUpICYmIGluc3RhbmNlLmJpbmQpIHtcbiAgICAgICAgdmFyIGJpbmRPcHRpb25zID0gYmluZGluZ19idWlsZGVyXzEuZ2V0QmluZGluZ09wdGlvbnMocHJvcGVydHlOYW1lLCBnZXRCaW5kaW5nRXhwcmVzc2lvbkZyb21BdHRyaWJ1dGUocHJvcGVydHlWYWx1ZSkpO1xuICAgICAgICBpbnN0YW5jZS5iaW5kKHtcbiAgICAgICAgICAgIHNvdXJjZVByb3BlcnR5OiBiaW5kT3B0aW9uc1tiaW5kaW5nX2J1aWxkZXJfMS5iaW5kaW5nQ29uc3RhbnRzLnNvdXJjZVByb3BlcnR5XSxcbiAgICAgICAgICAgIHRhcmdldFByb3BlcnR5OiBiaW5kT3B0aW9uc1tiaW5kaW5nX2J1aWxkZXJfMS5iaW5kaW5nQ29uc3RhbnRzLnRhcmdldFByb3BlcnR5XSxcbiAgICAgICAgICAgIGV4cHJlc3Npb246IGJpbmRPcHRpb25zW2JpbmRpbmdfYnVpbGRlcl8xLmJpbmRpbmdDb25zdGFudHMuZXhwcmVzc2lvbl0sXG4gICAgICAgICAgICB0d29XYXk6IGJpbmRPcHRpb25zW2JpbmRpbmdfYnVpbGRlcl8xLmJpbmRpbmdDb25zdGFudHMudHdvV2F5XVxuICAgICAgICB9LCBiaW5kT3B0aW9uc1tiaW5kaW5nX2J1aWxkZXJfMS5iaW5kaW5nQ29uc3RhbnRzLnNvdXJjZV0pO1xuICAgIH1cbiAgICBlbHNlIGlmIChiaW5kYWJsZV8xLmlzRXZlbnRPckdlc3R1cmUocHJvcGVydHlOYW1lLCBpbnN0YW5jZSkpIHtcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBleHBvcnRzICYmIGV4cG9ydHNbcHJvcGVydHlWYWx1ZV07XG4gICAgICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICBpbnN0YW5jZS5vbihwcm9wZXJ0eU5hbWUsIGhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGlzS25vd25GdW5jdGlvbihwcm9wZXJ0eU5hbWUsIGluc3RhbmNlKSAmJiBleHBvcnRzICYmIHR5cGVvZiBleHBvcnRzW3Byb3BlcnR5VmFsdWVdID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgaW5zdGFuY2VbcHJvcGVydHlOYW1lXSA9IGV4cG9ydHNbcHJvcGVydHlWYWx1ZV07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpbnN0YW5jZVtwcm9wZXJ0eU5hbWVdID0gcHJvcGVydHlWYWx1ZTtcbiAgICB9XG59XG5leHBvcnRzLnNldFByb3BlcnR5VmFsdWUgPSBzZXRQcm9wZXJ0eVZhbHVlO1xuZnVuY3Rpb24gZ2V0QmluZGluZ0V4cHJlc3Npb25Gcm9tQXR0cmlidXRlKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoXCJ7e1wiLCBcIlwiKS5yZXBsYWNlKFwifX1cIiwgXCJcIikudHJpbSgpO1xufVxuZnVuY3Rpb24gaXNCaW5kaW5nKHZhbHVlKSB7XG4gICAgdmFyIGlzQmluZGluZztcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHZhciBzdHIgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgIGlzQmluZGluZyA9IHN0ci5pbmRleE9mKFwie3tcIikgPT09IDAgJiYgc3RyLmxhc3RJbmRleE9mKFwifX1cIikgPT09IHN0ci5sZW5ndGggLSAyO1xuICAgIH1cbiAgICByZXR1cm4gaXNCaW5kaW5nO1xufVxudmFyIEtOT1dOX0ZVTkNUSU9OUyA9IFwia25vd25GdW5jdGlvbnNcIjtcbmZ1bmN0aW9uIGlzS25vd25GdW5jdGlvbihuYW1lLCBpbnN0YW5jZSkge1xuICAgIHJldHVybiBpbnN0YW5jZS5jb25zdHJ1Y3RvclxuICAgICAgICAmJiBLTk9XTl9GVU5DVElPTlMgaW4gaW5zdGFuY2UuY29uc3RydWN0b3JcbiAgICAgICAgJiYgaW5zdGFuY2UuY29uc3RydWN0b3JbS05PV05fRlVOQ1RJT05TXS5pbmRleE9mKG5hbWUpICE9PSAtMTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbXBvbmVudC1idWlsZGVyLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIHNhbml0aXplTW9kdWxlTmFtZShtb2R1bGVOYW1lLCByZW1vdmVFeHRlbnNpb24pIHtcbiAgICBpZiAocmVtb3ZlRXh0ZW5zaW9uID09PSB2b2lkIDApIHsgcmVtb3ZlRXh0ZW5zaW9uID0gdHJ1ZTsgfVxuICAgIG1vZHVsZU5hbWUgPSBtb2R1bGVOYW1lLnRyaW0oKTtcbiAgICBpZiAobW9kdWxlTmFtZS5zdGFydHNXaXRoKFwifi9cIikpIHtcbiAgICAgICAgbW9kdWxlTmFtZSA9IG1vZHVsZU5hbWUuc3Vic3RyaW5nKDIpO1xuICAgIH1cbiAgICBlbHNlIGlmIChtb2R1bGVOYW1lLnN0YXJ0c1dpdGgoXCJ+XCIpKSB7XG4gICAgICAgIG1vZHVsZU5hbWUgPSBtb2R1bGVOYW1lLnN1YnN0cmluZygxKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobW9kdWxlTmFtZS5zdGFydHNXaXRoKFwiL1wiKSkge1xuICAgICAgICBtb2R1bGVOYW1lID0gbW9kdWxlTmFtZS5zdWJzdHJpbmcoMSk7XG4gICAgfVxuICAgIGlmIChyZW1vdmVFeHRlbnNpb24pIHtcbiAgICAgICAgdmFyIGV4dFRvUmVtb3ZlID0gW1wianNcIiwgXCJ0c1wiLCBcInhtbFwiLCBcImh0bWxcIiwgXCJjc3NcIiwgXCJzY3NzXCJdO1xuICAgICAgICB2YXIgZXh0ZW5zaW9uUmVnRXggPSBuZXcgUmVnRXhwKFwiKC4qKVxcXFwuKD86XCIgKyBleHRUb1JlbW92ZS5qb2luKFwifFwiKSArIFwiKVwiLCBcImlcIik7XG4gICAgICAgIG1vZHVsZU5hbWUgPSBtb2R1bGVOYW1lLnJlcGxhY2UoZXh0ZW5zaW9uUmVnRXgsIFwiJDFcIik7XG4gICAgfVxuICAgIHJldHVybiBtb2R1bGVOYW1lO1xufVxuZXhwb3J0cy5zYW5pdGl6ZU1vZHVsZU5hbWUgPSBzYW5pdGl6ZU1vZHVsZU5hbWU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUtbmFtZS1zYW5pdGl6ZXIuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0ZXh0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpKTtcbnZhciBCdXR0b25CYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQnV0dG9uQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBCdXR0b25CYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdXR0b25CYXNlLnByb3RvdHlwZSwgXCJ0ZXh0V3JhcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUud2hpdGVTcGFjZSA9PT0gXCJub3JtYWxcIjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRleHRfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdHlsZS53aGl0ZVNwYWNlID0gdmFsdWUgPyBcIm5vcm1hbFwiIDogXCJub3dyYXBcIjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQnV0dG9uQmFzZS50YXBFdmVudCA9IFwidGFwXCI7XG4gICAgQnV0dG9uQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB0ZXh0X2Jhc2VfMS5DU1NUeXBlKFwiQnV0dG9uXCIpXG4gICAgXSwgQnV0dG9uQmFzZSk7XG4gICAgcmV0dXJuIEJ1dHRvbkJhc2U7XG59KHRleHRfYmFzZV8xLlRleHRCYXNlKSk7XG5leHBvcnRzLkJ1dHRvbkJhc2UgPSBCdXR0b25CYXNlO1xuQnV0dG9uQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJ1dHRvbi1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBidXR0b25fY29tbW9uXzEgPSByZXF1aXJlKFwiLi9idXR0b24tY29tbW9uXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbnZhciBnZXN0dXJlc18xID0gcmVxdWlyZShcIi4uL2dlc3R1cmVzXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vcGxhdGZvcm1cIik7XG52YXIgbGF6eV8xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL2xhenlcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9idXR0b24tY29tbW9uXCIpKTtcbnZhciBzZGtWZXJzaW9uID0gbGF6eV8xLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcGFyc2VJbnQocGxhdGZvcm1fMS5kZXZpY2Uuc2RrVmVyc2lvbik7IH0pO1xudmFyIENsaWNrTGlzdGVuZXI7XG52YXIgQVBJTEVWRUw7XG52YXIgQW5kcm9pZEJ1dHRvbjtcbmZ1bmN0aW9uIGluaXRpYWxpemVDbGlja0xpc3RlbmVyKCkge1xuICAgIGlmIChDbGlja0xpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIENsaWNrTGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKENsaWNrTGlzdGVuZXJJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBDbGlja0xpc3RlbmVySW1wbChvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBDbGlja0xpc3RlbmVySW1wbC5wcm90b3R5cGUub25DbGljayA9IGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICAgICAgb3duZXIuX2VtaXQoYnV0dG9uX2NvbW1vbl8xLkJ1dHRvbkJhc2UudGFwRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBDbGlja0xpc3RlbmVySW1wbCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgSW50ZXJmYWNlcyhbYW5kcm9pZC52aWV3LlZpZXcuT25DbGlja0xpc3RlbmVyXSlcbiAgICAgICAgXSwgQ2xpY2tMaXN0ZW5lckltcGwpO1xuICAgICAgICByZXR1cm4gQ2xpY2tMaXN0ZW5lckltcGw7XG4gICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgQ2xpY2tMaXN0ZW5lciA9IENsaWNrTGlzdGVuZXJJbXBsO1xufVxudmFyIEJ1dHRvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEJ1dHRvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBCdXR0b24oKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIGlmICghQVBJTEVWRUwpIHtcbiAgICAgICAgICAgIEFQSUxFVkVMID0gYW5kcm9pZC5vcy5CdWlsZC5WRVJTSU9OLlNES19JTlQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBCdXR0b24ucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghQW5kcm9pZEJ1dHRvbikge1xuICAgICAgICAgICAgQW5kcm9pZEJ1dHRvbiA9IGFuZHJvaWQud2lkZ2V0LkJ1dHRvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IEFuZHJvaWRCdXR0b24odGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpbml0aWFsaXplQ2xpY2tMaXN0ZW5lcigpO1xuICAgICAgICB2YXIgY2xpY2tMaXN0ZW5lciA9IG5ldyBDbGlja0xpc3RlbmVyKHRoaXMpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldE9uQ2xpY2tMaXN0ZW5lcihjbGlja0xpc3RlbmVyKTtcbiAgICAgICAgbmF0aXZlVmlldy5jbGlja0xpc3RlbmVyID0gY2xpY2tMaXN0ZW5lcjtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jbGlja0xpc3RlbmVyLm93bmVyID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlTGlzdEFuaW1hdG9yICYmIEFQSUxFVkVMID49IDIxKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0U3RhdGVMaXN0QW5pbWF0b3IodGhpcy5fc3RhdGVMaXN0QW5pbWF0b3IpO1xuICAgICAgICAgICAgdGhpcy5fc3RhdGVMaXN0QW5pbWF0b3IgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGUuX3VwZGF0ZUJ1dHRvblN0YXRlQ2hhbmdlSGFuZGxlciA9IGZ1bmN0aW9uIChzdWJzY3JpYmUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHN1YnNjcmliZSkge1xuICAgICAgICAgICAgdGhpcy5faGlnaGxpZ2h0ZWRIYW5kbGVyID0gdGhpcy5faGlnaGxpZ2h0ZWRIYW5kbGVyIHx8IChmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoYXJncy5hY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBnZXN0dXJlc18xLlRvdWNoQWN0aW9uLnVwOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIGdlc3R1cmVzXzEuVG91Y2hBY3Rpb24uY2FuY2VsOlxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2dvVG9WaXN1YWxTdGF0ZShcIm5vcm1hbFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIGdlc3R1cmVzXzEuVG91Y2hBY3Rpb24uZG93bjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9nb1RvVmlzdWFsU3RhdGUoXCJoaWdobGlnaHRlZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5vbihnZXN0dXJlc18xLkdlc3R1cmVUeXBlcy50b3VjaCwgdGhpcy5faGlnaGxpZ2h0ZWRIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMub2ZmKGdlc3R1cmVzXzEuR2VzdHVyZVR5cGVzLnRvdWNoLCB0aGlzLl9oaWdobGlnaHRlZEhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5wYWRkaW5nVG9wUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IHZhbHVlOiB0aGlzLl9kZWZhdWx0UGFkZGluZ1RvcCwgdW5pdDogXCJweFwiIH07XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5wYWRkaW5nVG9wUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRQYWRkaW5nVG9wKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgYnV0dG9uX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgMCkgKyBidXR0b25fY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHRoaXMuc3R5bGUuYm9yZGVyVG9wV2lkdGgsIDApKTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnBhZGRpbmdSaWdodFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4geyB2YWx1ZTogdGhpcy5fZGVmYXVsdFBhZGRpbmdSaWdodCwgdW5pdDogXCJweFwiIH07XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldFBhZGRpbmdSaWdodCh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIGJ1dHRvbl9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModmFsdWUsIDApICsgYnV0dG9uX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh0aGlzLnN0eWxlLmJvcmRlclJpZ2h0V2lkdGgsIDApKTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHRoaXMuX2RlZmF1bHRQYWRkaW5nQm90dG9tLCB1bml0OiBcInB4XCIgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldFBhZGRpbmdCb3R0b20odGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCBidXR0b25fY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHZhbHVlLCAwKSArIGJ1dHRvbl9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModGhpcy5zdHlsZS5ib3JkZXJCb3R0b21XaWR0aCwgMCkpO1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEucGFkZGluZ0xlZnRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHRoaXMuX2RlZmF1bHRQYWRkaW5nTGVmdCwgdW5pdDogXCJweFwiIH07XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5wYWRkaW5nTGVmdFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0UGFkZGluZ0xlZnQodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCBidXR0b25fY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHZhbHVlLCAwKSArIGJ1dHRvbl9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModGhpcy5zdHlsZS5ib3JkZXJMZWZ0V2lkdGgsIDApKTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnpJbmRleFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKEFQSUxFVkVMID49IDIxKSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgICAgIGlmICghdGhpcy5fc3RhdGVMaXN0QW5pbWF0b3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZUxpc3RBbmltYXRvciA9IG5hdGl2ZVZpZXcuZ2V0U3RhdGVMaXN0QW5pbWF0b3IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0U3RhdGVMaXN0QW5pbWF0b3IobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0WkluZGV4KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgdmFsdWUpO1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEudGV4dEFsaWdubWVudFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5ld1ZhbHVlID0gdmFsdWUgPT09IFwiaW5pdGlhbFwiID8gXCJjZW50ZXJcIiA6IHZhbHVlO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS50ZXh0QWxpZ25tZW50UHJvcGVydHkuc2V0TmF0aXZlXS5jYWxsKHRoaXMsIG5ld1ZhbHVlKTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGUuZ2V0RGVmYXVsdEVsZXZhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHNka1ZlcnNpb24oKSA8IDIxKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMjtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGUuZ2V0RGVmYXVsdER5bmFtaWNFbGV2YXRpb25PZmZzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChzZGtWZXJzaW9uKCkgPCAyMSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDQ7XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEJ1dHRvbi5wcm90b3R5cGUsIFwiY3JlYXRlTmF0aXZlVmlld1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgYnV0dG9uX2NvbW1vbl8xLlBzZXVkb0NsYXNzSGFuZGxlcihcIm5vcm1hbFwiLCBcImhpZ2hsaWdodGVkXCIsIFwicHJlc3NlZFwiLCBcImFjdGl2ZVwiKVxuICAgIF0sIEJ1dHRvbi5wcm90b3R5cGUsIFwiX3VwZGF0ZUJ1dHRvblN0YXRlQ2hhbmdlSGFuZGxlclwiLCBudWxsKTtcbiAgICByZXR1cm4gQnV0dG9uO1xufShidXR0b25fY29tbW9uXzEuQnV0dG9uQmFzZSkpO1xuZXhwb3J0cy5CdXR0b24gPSBCdXR0b247XG4vLyMgc291cmNlTWFwcGluZ1VSTD1idXR0b24uYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBDb250ZW50VmlldyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENvbnRlbnRWaWV3LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENvbnRlbnRWaWV3KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb250ZW50Vmlldy5wcm90b3R5cGUsIFwiY29udGVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRlbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgb2xkVmlldyA9IHRoaXMuX2NvbnRlbnQ7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVZpZXcodGhpcy5fY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9jb250ZW50ID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodGhpcy5fY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9vbkNvbnRlbnRDaGFuZ2VkKG9sZFZpZXcsIHZhbHVlKTtcbiAgICAgICAgICAgIGlmICh2aWV3XzEuaXNJT1MgJiYgb2xkVmlldyAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnRlbnRWaWV3LnByb3RvdHlwZSwgXCJsYXlvdXRWaWV3XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3RfMSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udGVudC5fZWFjaExheW91dFZpZXcoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdF8xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJzdF8xID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBjaGlsZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1vcmUgdGhhbiBvbmUgbGF5b3V0IGNoaWxkIGluc2lkZSBhIENvbnRlbnRWaWV3XCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29udGVudFZpZXcucHJvdG90eXBlLCBcIl9jaGlsZHJlbkNvdW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGVudCA/IDEgOiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBDb250ZW50Vmlldy5wcm90b3R5cGUuX29uQ29udGVudENoYW5nZWQgPSBmdW5jdGlvbiAob2xkVmlldywgbmV3Vmlldykge1xuICAgIH07XG4gICAgQ29udGVudFZpZXcucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHZpZXdfMS5WaWV3KSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29udGVudFZpZXcucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSB0aGlzLl9jb250ZW50O1xuICAgICAgICBpZiAoY29udGVudCkge1xuICAgICAgICAgICAgY2FsbGJhY2soY29udGVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbnRlbnRWaWV3LnByb3RvdHlwZS5vbk1lYXN1cmUgPSBmdW5jdGlvbiAod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHZpZXdfMS5WaWV3Lm1lYXN1cmVDaGlsZCh0aGlzLCB0aGlzLmxheW91dFZpZXcsIHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoID0gdmlld18xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aE1vZGUgPSB2aWV3XzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodCA9IHZpZXdfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodE1vZGUgPSB2aWV3XzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBtZWFzdXJlV2lkdGggPSBNYXRoLm1heChyZXN1bHQubWVhc3VyZWRXaWR0aCwgdGhpcy5lZmZlY3RpdmVNaW5XaWR0aCk7XG4gICAgICAgIHZhciBtZWFzdXJlSGVpZ2h0ID0gTWF0aC5tYXgocmVzdWx0Lm1lYXN1cmVkSGVpZ2h0LCB0aGlzLmVmZmVjdGl2ZU1pbkhlaWdodCk7XG4gICAgICAgIHZhciB3aWR0aEFuZFN0YXRlID0gdmlld18xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShtZWFzdXJlV2lkdGgsIHdpZHRoLCB3aWR0aE1vZGUsIDApO1xuICAgICAgICB2YXIgaGVpZ2h0QW5kU3RhdGUgPSB2aWV3XzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKG1lYXN1cmVIZWlnaHQsIGhlaWdodCwgaGVpZ2h0TW9kZSwgMCk7XG4gICAgICAgIHRoaXMuc2V0TWVhc3VyZWREaW1lbnNpb24od2lkdGhBbmRTdGF0ZSwgaGVpZ2h0QW5kU3RhdGUpO1xuICAgIH07XG4gICAgQ29udGVudFZpZXcucHJvdG90eXBlLm9uTGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICB2aWV3XzEuVmlldy5sYXlvdXRDaGlsZCh0aGlzLCB0aGlzLmxheW91dFZpZXcsIDAsIDAsIHJpZ2h0IC0gbGVmdCwgYm90dG9tIC0gdG9wKTtcbiAgICB9O1xuICAgIHJldHVybiBDb250ZW50Vmlldztcbn0odmlld18xLkN1c3RvbUxheW91dFZpZXcpKTtcbmV4cG9ydHMuQ29udGVudFZpZXcgPSBDb250ZW50VmlldztcbkNvbnRlbnRWaWV3LnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29udGVudC12aWV3LmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vcHJvcGVydGllc1wiKTtcbnZhciBvYnNlcnZhYmxlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vZGF0YS9vYnNlcnZhYmxlXCIpO1xuZXhwb3J0cy5PYnNlcnZhYmxlID0gb2JzZXJ2YWJsZV8xLk9ic2VydmFibGU7XG5leHBvcnRzLldyYXBwZWRWYWx1ZSA9IG9ic2VydmFibGVfMS5XcmFwcGVkVmFsdWU7XG52YXIgd2Vha19ldmVudF9saXN0ZW5lcl8xID0gcmVxdWlyZShcIi4uL3dlYWstZXZlbnQtbGlzdGVuZXJcIik7XG52YXIgYmluZGluZ19idWlsZGVyXzEgPSByZXF1aXJlKFwiLi4vLi4vYnVpbGRlci9iaW5kaW5nLWJ1aWxkZXJcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uLy4uL3RyYWNlXCIpO1xuZXhwb3J0cy50cmFjZUVuYWJsZWQgPSB0cmFjZV8xLmlzRW5hYmxlZDtcbmV4cG9ydHMudHJhY2VXcml0ZSA9IHRyYWNlXzEud3JpdGU7XG5leHBvcnRzLnRyYWNlRXJyb3IgPSB0cmFjZV8xLmVycm9yO1xuZXhwb3J0cy50cmFjZUNhdGVnb3JpZXMgPSB0cmFjZV8xLmNhdGVnb3JpZXM7XG5leHBvcnRzLnRyYWNlTm90aWZ5RXZlbnQgPSB0cmFjZV8xLm5vdGlmeUV2ZW50O1xuZXhwb3J0cy5pc0NhdGVnb3J5U2V0ID0gdHJhY2VfMS5pc0NhdGVnb3J5U2V0O1xuZXhwb3J0cy50cmFjZU1lc3NhZ2VUeXBlID0gdHJhY2VfMS5tZXNzYWdlVHlwZTtcbnZhciB0eXBlcyA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy90eXBlc1wiKTtcbnZhciBhcHBsaWNhdGlvbkNvbW1vbiA9IHJlcXVpcmUoXCIuLi8uLi8uLi9hcHBsaWNhdGlvbi9hcHBsaWNhdGlvbi1jb21tb25cIik7XG52YXIgcG9seW1lckV4cHJlc3Npb25zID0gcmVxdWlyZShcIi4uLy4uLy4uL2pzLWxpYnMvcG9seW1lci1leHByZXNzaW9uc1wiKTtcbnZhciBjb250ZXh0S2V5ID0gXCJjb250ZXh0XCI7XG52YXIgcGFyYW1zUmVnZXggPSAvXFxbXFxzKihbJ1wiXSkqKFxcdyopXFwxXFxzKlxcXS87XG52YXIgYmMgPSBiaW5kaW5nX2J1aWxkZXJfMS5iaW5kaW5nQ29uc3RhbnRzO1xudmFyIGVtcHR5QXJyYXkgPSBbXTtcbnZhciBwcm9wZXJ0aWVzQ2FjaGUgPSB7fTtcbmZ1bmN0aW9uIGdldFByb3BlcnRpZXMocHJvcGVydHkpIHtcbiAgICBpZiAoIXByb3BlcnR5KSB7XG4gICAgICAgIHJldHVybiBlbXB0eUFycmF5O1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gcHJvcGVydGllc0NhY2hlW3Byb3BlcnR5XTtcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHZhciBwYXJlbnRzTWF0Y2hlcyA9IHByb3BlcnR5Lm1hdGNoKGJpbmRpbmdfYnVpbGRlcl8xLnBhcmVudHNSZWdleCk7XG4gICAgcmVzdWx0ID0gcHJvcGVydHkucmVwbGFjZShiaW5kaW5nX2J1aWxkZXJfMS5wYXJlbnRzUmVnZXgsIFwicGFyZW50c01hdGNoXCIpXG4gICAgICAgIC5yZXBsYWNlKC9cXF0vZywgXCJcIilcbiAgICAgICAgLnNwbGl0KC9cXC58XFxbLyk7XG4gICAgdmFyIHBhcmVudHNNYXRjaGVzQ291bnRlciA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDAsIHJlc3VsdExlbmd0aCA9IHJlc3VsdC5sZW5ndGg7IGkgPCByZXN1bHRMZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocmVzdWx0W2ldID09PSBcInBhcmVudHNNYXRjaFwiKSB7XG4gICAgICAgICAgICByZXN1bHRbaV0gPSBwYXJlbnRzTWF0Y2hlc1twYXJlbnRzTWF0Y2hlc0NvdW50ZXIrK107XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvcGVydGllc0NhY2hlW3Byb3BlcnR5XSA9IHJlc3VsdDtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gZ2V0RXZlbnRPckdlc3R1cmVOYW1lKG5hbWUpIHtcbiAgICByZXR1cm4gbmFtZS5pbmRleE9mKFwib25cIikgPT09IDAgPyBuYW1lLnN1YnN0cigyLCBuYW1lLmxlbmd0aCAtIDIpIDogbmFtZTtcbn1cbmV4cG9ydHMuZ2V0RXZlbnRPckdlc3R1cmVOYW1lID0gZ2V0RXZlbnRPckdlc3R1cmVOYW1lO1xuZnVuY3Rpb24gaXNHZXN0dXJlKGV2ZW50T3JHZXN0dXJlTmFtZSkge1xuICAgIHZhciB0ID0gZXZlbnRPckdlc3R1cmVOYW1lLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiB0ID09PSBcInRhcFwiXG4gICAgICAgIHx8IHQgPT09IFwiZG91YmxldGFwXCJcbiAgICAgICAgfHwgdCA9PT0gXCJwaW5jaFwiXG4gICAgICAgIHx8IHQgPT09IFwicGFuXCJcbiAgICAgICAgfHwgdCA9PT0gXCJzd2lwZVwiXG4gICAgICAgIHx8IHQgPT09IFwicm90YXRpb25cIlxuICAgICAgICB8fCB0ID09PSBcImxvbmdwcmVzc1wiXG4gICAgICAgIHx8IHQgPT09IFwidG91Y2hcIjtcbn1cbmV4cG9ydHMuaXNHZXN0dXJlID0gaXNHZXN0dXJlO1xuZnVuY3Rpb24gaXNFdmVudE9yR2VzdHVyZShuYW1lLCB2aWV3KSB7XG4gICAgaWYgKHR5cGVvZiBuYW1lID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHZhciBldmVudE9yR2VzdHVyZU5hbWUgPSBnZXRFdmVudE9yR2VzdHVyZU5hbWUobmFtZSk7XG4gICAgICAgIHZhciBldnQgPSBldmVudE9yR2VzdHVyZU5hbWUgKyBcIkV2ZW50XCI7XG4gICAgICAgIHJldHVybiB2aWV3LmNvbnN0cnVjdG9yICYmIGV2dCBpbiB2aWV3LmNvbnN0cnVjdG9yIHx8IGlzR2VzdHVyZShldmVudE9yR2VzdHVyZU5hbWUudG9Mb3dlckNhc2UoKSk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmV4cG9ydHMuaXNFdmVudE9yR2VzdHVyZSA9IGlzRXZlbnRPckdlc3R1cmU7XG52YXIgQmluZGluZyA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQmluZGluZyh0YXJnZXQsIG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy50YXJnZXQgPSBuZXcgV2Vha1JlZih0YXJnZXQpO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLnNvdXJjZVByb3BlcnRpZXMgPSBnZXRQcm9wZXJ0aWVzKG9wdGlvbnMuc291cmNlUHJvcGVydHkpO1xuICAgICAgICB0aGlzLnRhcmdldE9wdGlvbnMgPSB0aGlzLnJlc29sdmVPcHRpb25zKHRhcmdldCwgZ2V0UHJvcGVydGllcyhvcHRpb25zLnRhcmdldFByb3BlcnR5KSk7XG4gICAgICAgIGlmICghdGhpcy50YXJnZXRPcHRpb25zKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHByb3BlcnR5OiBcIiArIG9wdGlvbnMudGFyZ2V0UHJvcGVydHkgKyBcIiBmb3IgdGFyZ2V0OiBcIiArIHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMudHdvV2F5KSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0XzEgPSB0aGlzLnRhcmdldE9wdGlvbnMuaW5zdGFuY2UuZ2V0KCk7XG4gICAgICAgICAgICBpZiAodGFyZ2V0XzEgaW5zdGFuY2VvZiBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSkge1xuICAgICAgICAgICAgICAgIHRhcmdldF8xLm9uKHRoaXMudGFyZ2V0T3B0aW9ucy5wcm9wZXJ0eSArIFwiQ2hhbmdlXCIsIHRoaXMub25UYXJnZXRQcm9wZXJ0eUNoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIEJpbmRpbmcucHJvdG90eXBlLm9uVGFyZ2V0UHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdGhpcy51cGRhdGVUd29XYXkoZGF0YS52YWx1ZSk7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5sb2FkZWRIYW5kbGVyVmlzdWFsVHJlZUJpbmRpbmcgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gYXJncy5vYmplY3Q7XG4gICAgICAgIHRhcmdldC5vZmYoXCJsb2FkZWRcIiwgdGhpcy5sb2FkZWRIYW5kbGVyVmlzdWFsVHJlZUJpbmRpbmcsIHRoaXMpO1xuICAgICAgICB2YXIgY29udGV4dCA9IHRhcmdldC5iaW5kaW5nQ29udGV4dDtcbiAgICAgICAgaWYgKGNvbnRleHQgIT09IHVuZGVmaW5lZCAmJiBjb250ZXh0ICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZShjb250ZXh0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUuY2xlYXJTb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAob2JzZXJ2YWJsZSwgaW5kZXgsIG1hcCkge1xuICAgICAgICAgICAgd2Vha19ldmVudF9saXN0ZW5lcl8xLnJlbW92ZVdlYWtFdmVudExpc3RlbmVyKG9ic2VydmFibGUsIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIF90aGlzLm9uU291cmNlUHJvcGVydHlDaGFuZ2VkLCBfdGhpcyk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmNsZWFyKCk7XG4gICAgICAgIGlmICh0aGlzLnNvdXJjZSkge1xuICAgICAgICAgICAgdGhpcy5zb3VyY2UuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zb3VyY2VPcHRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZU9wdGlvbnMuaW5zdGFuY2UuY2xlYXIoKTtcbiAgICAgICAgICAgIHRoaXMuc291cmNlT3B0aW9ucyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUuc291cmNlQXNPYmplY3QgPSBmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICAgIHZhciBvYmplY3RUeXBlID0gdHlwZW9mIHNvdXJjZTtcbiAgICAgICAgaWYgKG9iamVjdFR5cGUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHNvdXJjZSA9IG5ldyBOdW1iZXIoc291cmNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChvYmplY3RUeXBlID09PSBcImJvb2xlYW5cIikge1xuICAgICAgICAgICAgc291cmNlID0gbmV3IEJvb2xlYW4oc291cmNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChvYmplY3RUeXBlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBzb3VyY2UgPSBuZXcgU3RyaW5nKHNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdXJjZTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLmJpbmRpbmdDb250ZXh0Q2hhbmdlZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLnRhcmdldE9wdGlvbnMuaW5zdGFuY2UuZ2V0KCk7XG4gICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLnVuYmluZCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2YWx1ZSA9IGRhdGEudmFsdWU7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFyQmluZGluZygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXRPcHRpb25zLmluc3RhbmNlLmdldCgpO1xuICAgICAgICBpZiAodGhpcy5zb3VyY2VJc0JpbmRpbmdDb250ZXh0ICYmIHRhcmdldCBpbnN0YW5jZW9mIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlICYmIHRoaXMudGFyZ2V0T3B0aW9ucy5wcm9wZXJ0eSAhPT0gXCJiaW5kaW5nQ29udGV4dFwiKSB7XG4gICAgICAgICAgICB0YXJnZXQub24oXCJiaW5kaW5nQ29udGV4dENoYW5nZVwiLCB0aGlzLmJpbmRpbmdDb250ZXh0Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGUoc291cmNlKTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgICAgdGhpcy5jbGVhclNvdXJjZSgpO1xuICAgICAgICBzb3VyY2UgPSB0aGlzLnNvdXJjZUFzT2JqZWN0KHNvdXJjZSk7XG4gICAgICAgIGlmICghdHlwZXMuaXNOdWxsT3JVbmRlZmluZWQoc291cmNlKSkge1xuICAgICAgICAgICAgdGhpcy5zb3VyY2UgPSBuZXcgV2Vha1JlZihzb3VyY2UpO1xuICAgICAgICAgICAgdGhpcy5zb3VyY2VPcHRpb25zID0gdGhpcy5yZXNvbHZlT3B0aW9ucyhzb3VyY2UsIHRoaXMuc291cmNlUHJvcGVydGllcyk7XG4gICAgICAgICAgICB2YXIgc291cmNlVmFsdWUgPSB0aGlzLmdldFNvdXJjZVByb3BlcnR5VmFsdWUoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KHNvdXJjZVZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuYWRkUHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnModGhpcy5zb3VyY2UsIHRoaXMuc291cmNlUHJvcGVydGllcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIXRoaXMuc291cmNlSXNCaW5kaW5nQ29udGV4dCkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZVZhbHVlID0gdGhpcy5nZXRTb3VyY2VQcm9wZXJ0eVZhbHVlKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVRhcmdldChzb3VyY2VWYWx1ZSA/IHNvdXJjZVZhbHVlIDogc291cmNlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXRPcHRpb25zLmluc3RhbmNlLmdldCgpO1xuICAgICAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2Ygb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMudHdvV2F5KSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0Lm9mZih0aGlzLnRhcmdldE9wdGlvbnMucHJvcGVydHkgKyBcIkNoYW5nZVwiLCB0aGlzLm9uVGFyZ2V0UHJvcGVydHlDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnNvdXJjZUlzQmluZGluZ0NvbnRleHQgJiYgdGhpcy50YXJnZXRPcHRpb25zLnByb3BlcnR5ICE9PSBcImJpbmRpbmdDb250ZXh0XCIpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQub2ZmKFwiYmluZGluZ0NvbnRleHRDaGFuZ2VcIiwgdGhpcy5iaW5kaW5nQ29udGV4dENoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnRhcmdldE9wdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0T3B0aW9ucyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNvdXJjZVByb3BlcnRpZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmICghdGhpcy5zb3VyY2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNsZWFyU291cmNlKCk7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5yZXNvbHZlT2JqZWN0c0FuZFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoc291cmNlLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgdmFyIGN1cnJlbnRPYmplY3QgPSBzb3VyY2U7XG4gICAgICAgIHZhciBjdXJyZW50T2JqZWN0Q2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgcHJvcHNBcnJheUxlbmd0aCA9IHByb3BlcnRpZXMubGVuZ3RoOyBpIDwgcHJvcHNBcnJheUxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcHJvcGVydHkgPSBwcm9wZXJ0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKHByb3BlcnR5ID09PSBiYy5iaW5kaW5nVmFsdWVLZXkpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50T2JqZWN0Q2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocHJvcGVydHkgPT09IGJjLnBhcmVudFZhbHVlS2V5IHx8IHByb3BlcnR5LmluZGV4T2YoYmMucGFyZW50c1ZhbHVlS2V5KSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnRWaWV3ID0gdGhpcy5nZXRQYXJlbnRWaWV3KHRoaXMudGFyZ2V0LmdldCgpLCBwcm9wZXJ0eSkudmlldztcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50Vmlldykge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50T2JqZWN0ID0gcGFyZW50Vmlldy5iaW5kaW5nQ29udGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRJbnN0YW5jZSA9IHRoaXMudGFyZ2V0LmdldCgpO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRJbnN0YW5jZS5vZmYoXCJsb2FkZWRcIiwgdGhpcy5sb2FkZWRIYW5kbGVyVmlzdWFsVHJlZUJpbmRpbmcsIHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRJbnN0YW5jZS5vbihcImxvYWRlZFwiLCB0aGlzLmxvYWRlZEhhbmRsZXJWaXN1YWxUcmVlQmluZGluZywgdGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGN1cnJlbnRPYmplY3RDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjdXJyZW50T2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goeyBpbnN0YW5jZTogY3VycmVudE9iamVjdCwgcHJvcGVydHk6IHByb3BlcnR5IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRPYmplY3RDaGFuZ2VkICYmIChpIDwgcHJvcHNBcnJheUxlbmd0aCAtIDEpKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudE9iamVjdCA9IGN1cnJlbnRPYmplY3QgPyBjdXJyZW50T2JqZWN0W3Byb3BlcnRpZXNbaV1dIDogbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnRPYmplY3RDaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLmFkZFByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzID0gZnVuY3Rpb24gKHNvdXJjZSwgc291cmNlUHJvcGVydHksIHBhcmVudFByb3Blcmllcykge1xuICAgICAgICB2YXIgb2JqZWN0c0FuZFByb3BlcnRpZXMgPSB0aGlzLnJlc29sdmVPYmplY3RzQW5kUHJvcGVydGllcyhzb3VyY2UuZ2V0KCksIHNvdXJjZVByb3BlcnR5KTtcbiAgICAgICAgdmFyIHByb3AgPSBwYXJlbnRQcm9wZXJpZXMgfHwgXCJcIjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gb2JqZWN0c0FuZFByb3BlcnRpZXMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICAgICAgdmFyIHByb3BOYW1lID0gb2JqZWN0c0FuZFByb3BlcnRpZXNbaV0ucHJvcGVydHk7XG4gICAgICAgICAgICBwcm9wICs9IFwiJFwiICsgcHJvcE5hbWU7XG4gICAgICAgICAgICB2YXIgY3VycmVudE9iamVjdCA9IG9iamVjdHNBbmRQcm9wZXJ0aWVzW2ldLmluc3RhbmNlO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmhhcyhwcm9wKSAmJiBjdXJyZW50T2JqZWN0IGluc3RhbmNlb2Ygb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUgJiYgY3VycmVudE9iamVjdC5faXNWaWV3QmFzZSkge1xuICAgICAgICAgICAgICAgIHdlYWtfZXZlbnRfbGlzdGVuZXJfMS5hZGRXZWFrRXZlbnRMaXN0ZW5lcihjdXJyZW50T2JqZWN0LCBwcm9wTmFtZSArIFwiQ2hhbmdlXCIsIHRoaXMub25Tb3VyY2VQcm9wZXJ0eUNoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHdlYWtfZXZlbnRfbGlzdGVuZXJfMS5hZGRXZWFrRXZlbnRMaXN0ZW5lcihjdXJyZW50T2JqZWN0LCBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm9wZXJ0eUNoYW5nZUV2ZW50LCB0aGlzLm9uU291cmNlUHJvcGVydHlDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLnNldChwcm9wLCBjdXJyZW50T2JqZWN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCF0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmhhcyhwcm9wKSAmJiBjdXJyZW50T2JqZWN0IGluc3RhbmNlb2Ygb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpIHtcbiAgICAgICAgICAgICAgICB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEuYWRkV2Vha0V2ZW50TGlzdGVuZXIoY3VycmVudE9iamVjdCwgb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCwgdGhpcy5vblNvdXJjZVByb3BlcnR5Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5zZXQocHJvcCwgY3VycmVudE9iamVjdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnByZXBhcmVFeHByZXNzaW9uRm9yVXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZXNjYXBlZFNvdXJjZVByb3BlcnR5ID0gdXRpbHNfMS5lc2NhcGVSZWdleFN5bWJvbHModGhpcy5vcHRpb25zLnNvdXJjZVByb3BlcnR5KTtcbiAgICAgICAgdmFyIGV4cFJlZ2V4ID0gbmV3IFJlZ0V4cChlc2NhcGVkU291cmNlUHJvcGVydHksIFwiZ1wiKTtcbiAgICAgICAgdmFyIHJlc3VsdEV4cCA9IHRoaXMub3B0aW9ucy5leHByZXNzaW9uLnJlcGxhY2UoZXhwUmVnZXgsIGJjLm5ld1Byb3BlcnR5VmFsdWVLZXkpO1xuICAgICAgICByZXR1cm4gcmVzdWx0RXhwO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUudXBkYXRlVHdvV2F5ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnVwZGF0aW5nIHx8ICF0aGlzLm9wdGlvbnMudHdvV2F5KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5ld1ZhbHVlID0gdmFsdWU7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgdmFyIGNoYW5nZWRNb2RlbCA9IHt9O1xuICAgICAgICAgICAgY2hhbmdlZE1vZGVsW2JjLmJpbmRpbmdWYWx1ZUtleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIGNoYW5nZWRNb2RlbFtiYy5uZXdQcm9wZXJ0eVZhbHVlS2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgdmFyIHNvdXJjZVByb3BlcnR5TmFtZSA9IFwiXCI7XG4gICAgICAgICAgICBpZiAodGhpcy5zb3VyY2VPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgc291cmNlUHJvcGVydHlOYW1lID0gdGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHRoaXMub3B0aW9ucy5zb3VyY2VQcm9wZXJ0eSA9PT0gXCJzdHJpbmdcIiAmJiB0aGlzLm9wdGlvbnMuc291cmNlUHJvcGVydHkuaW5kZXhPZihcIi5cIikgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgc291cmNlUHJvcGVydHlOYW1lID0gdGhpcy5vcHRpb25zLnNvdXJjZVByb3BlcnR5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNvdXJjZVByb3BlcnR5TmFtZSAhPT0gXCJcIikge1xuICAgICAgICAgICAgICAgIGNoYW5nZWRNb2RlbFtzb3VyY2VQcm9wZXJ0eU5hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdXBkYXRlRXhwcmVzc2lvbiA9IHRoaXMucHJlcGFyZUV4cHJlc3Npb25Gb3JVcGRhdGUoKTtcbiAgICAgICAgICAgIHRoaXMucHJlcGFyZUNvbnRleHRGb3JFeHByZXNzaW9uKGNoYW5nZWRNb2RlbCwgdXBkYXRlRXhwcmVzc2lvbiwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIHZhciBleHByZXNzaW9uVmFsdWUgPSB0aGlzLl9nZXRFeHByZXNzaW9uVmFsdWUodXBkYXRlRXhwcmVzc2lvbiwgdHJ1ZSwgY2hhbmdlZE1vZGVsKTtcbiAgICAgICAgICAgIGlmIChleHByZXNzaW9uVmFsdWUgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoZXhwcmVzc2lvblZhbHVlLm1lc3NhZ2UsIHRyYWNlXzEuY2F0ZWdvcmllcy5CaW5kaW5nLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld1ZhbHVlID0gZXhwcmVzc2lvblZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlU291cmNlKG5ld1ZhbHVlKTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLl9nZXRFeHByZXNzaW9uVmFsdWUgPSBmdW5jdGlvbiAoZXhwcmVzc2lvbiwgaXNCYWNrQ29udmVydCwgY2hhbmdlZE1vZGVsKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgZXhwXzEgPSBwb2x5bWVyRXhwcmVzc2lvbnMuUG9seW1lckV4cHJlc3Npb25zLmdldEV4cHJlc3Npb24oZXhwcmVzc2lvbik7XG4gICAgICAgICAgICBpZiAoZXhwXzEpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udGV4dF8xID0gdGhpcy5zb3VyY2UgJiYgdGhpcy5zb3VyY2UuZ2V0ICYmIHRoaXMuc291cmNlLmdldCgpIHx8IGdsb2JhbDtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSB7fTtcbiAgICAgICAgICAgICAgICB2YXIgYWRkZWRQcm9wcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciByZXNvdXJjZXMgPSBhcHBsaWNhdGlvbkNvbW1vbi5nZXRSZXNvdXJjZXMoKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBwcm9wIGluIHJlc291cmNlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2VzLmhhc093blByb3BlcnR5KHByb3ApICYmICFjb250ZXh0XzEuaGFzT3duUHJvcGVydHkocHJvcCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHRfMVtwcm9wXSA9IHJlc291cmNlc1twcm9wXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZGVkUHJvcHMucHVzaChwcm9wKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnByZXBhcmVDb250ZXh0Rm9yRXhwcmVzc2lvbihjb250ZXh0XzEsIGV4cHJlc3Npb24sIGFkZGVkUHJvcHMpO1xuICAgICAgICAgICAgICAgIG1vZGVsW2NvbnRleHRLZXldID0gY29udGV4dF8xO1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBleHBfMS5nZXRWYWx1ZShtb2RlbCwgaXNCYWNrQ29udmVydCwgY2hhbmdlZE1vZGVsID8gY2hhbmdlZE1vZGVsIDogbW9kZWwpO1xuICAgICAgICAgICAgICAgIHZhciBhZGRlZFByb3BzTGVuZ3RoID0gYWRkZWRQcm9wcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhZGRlZFByb3BzTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNvbnRleHRfMVthZGRlZFByb3BzW2ldXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYWRkZWRQcm9wcy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKGV4cHJlc3Npb24gKyBcIiBpcyBub3QgYSB2YWxpZCBleHByZXNzaW9uLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IFwiUnVuLXRpbWUgZXJyb3Igb2NjdXJlZCBpbiBmaWxlOiBcIiArIGUuc291cmNlVVJMICsgXCIgYXQgbGluZTogXCIgKyBlLmxpbmUgKyBcIiBhbmQgY29sdW1uOiBcIiArIGUuY29sdW1uO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5vblNvdXJjZVByb3BlcnR5Q2hhbmdlZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBzb3VyY2VQcm9wcyA9IHRoaXMuc291cmNlUHJvcGVydGllcztcbiAgICAgICAgdmFyIHNvdXJjZVByb3BzTGVuZ3RoID0gc291cmNlUHJvcHMubGVuZ3RoO1xuICAgICAgICB2YXIgY2hhbmdlZFByb3BlcnR5SW5kZXggPSBzb3VyY2VQcm9wcy5pbmRleE9mKGRhdGEucHJvcGVydHlOYW1lKTtcbiAgICAgICAgdmFyIHBhcmVudFByb3BzID0gXCJcIjtcbiAgICAgICAgaWYgKGNoYW5nZWRQcm9wZXJ0eUluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgIHBhcmVudFByb3BzID0gXCIkXCIgKyBzb3VyY2VQcm9wcy5zbGljZSgwLCBjaGFuZ2VkUHJvcGVydHlJbmRleCArIDEpLmpvaW4oXCIkXCIpO1xuICAgICAgICAgICAgd2hpbGUgKHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuZ2V0KHBhcmVudFByb3BzKSAhPT0gZGF0YS5vYmplY3QpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VkUHJvcGVydHlJbmRleCArPSBzb3VyY2VQcm9wcy5zbGljZShjaGFuZ2VkUHJvcGVydHlJbmRleCArIDEpLmluZGV4T2YoZGF0YS5wcm9wZXJ0eU5hbWUpICsgMTtcbiAgICAgICAgICAgICAgICBwYXJlbnRQcm9wcyA9IFwiJFwiICsgc291cmNlUHJvcHMuc2xpY2UoMCwgY2hhbmdlZFByb3BlcnR5SW5kZXggKyAxKS5qb2luKFwiJFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIHZhciBleHByZXNzaW9uVmFsdWUgPSB0aGlzLl9nZXRFeHByZXNzaW9uVmFsdWUodGhpcy5vcHRpb25zLmV4cHJlc3Npb24sIGZhbHNlLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgaWYgKGV4cHJlc3Npb25WYWx1ZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShleHByZXNzaW9uVmFsdWUubWVzc2FnZSwgdHJhY2VfMS5jYXRlZ29yaWVzLkJpbmRpbmcsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUYXJnZXQoZXhwcmVzc2lvblZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkUHJvcGVydHlJbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByb3BzID0gc291cmNlUHJvcHMuc2xpY2UoY2hhbmdlZFByb3BlcnR5SW5kZXggKyAxKTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvcHNMZW5ndGggPSBwcm9wcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgaWYgKHByb3BzTGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBkYXRhLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVbcHJvcHNbaV1dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZGF0YS5wcm9wZXJ0eU5hbWUgPT09IHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRhcmdldChkYXRhLnZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNoYW5nZWRQcm9wZXJ0eUluZGV4ID4gLTEgJiYgY2hhbmdlZFByb3BlcnR5SW5kZXggPCBzb3VyY2VQcm9wc0xlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIHZhciBwcm9iYWJseUNoYW5nZWRPYmplY3QgPSB0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmdldChwYXJlbnRQcm9wcyk7XG4gICAgICAgICAgICBpZiAocHJvYmFibHlDaGFuZ2VkT2JqZWN0ICYmXG4gICAgICAgICAgICAgICAgcHJvYmFibHlDaGFuZ2VkT2JqZWN0ICE9PSBkYXRhLm9iamVjdFtzb3VyY2VQcm9wc1tjaGFuZ2VkUHJvcGVydHlJbmRleF1dKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IHNvdXJjZVByb3BzTGVuZ3RoIC0gMTsgaSA+IGNoYW5nZWRQcm9wZXJ0eUluZGV4OyBpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3AgPSBcIiRcIiArIHNvdXJjZVByb3BzLnNsaWNlKDAsIGkgKyAxKS5qb2luKFwiJFwiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuaGFzKHByb3ApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEucmVtb3ZlV2Vha0V2ZW50TGlzdGVuZXIodGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5nZXQocHJvcCksIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIHRoaXMub25Tb3VyY2VQcm9wZXJ0eUNoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5kZWxldGUocHJvcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld1Byb3BzID0gc291cmNlUHJvcHMuc2xpY2UoY2hhbmdlZFByb3BlcnR5SW5kZXggKyAxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3T2JqZWN0ID0gZGF0YS5vYmplY3Rbc291cmNlUHJvcHNbY2hhbmdlZFByb3BlcnR5SW5kZXhdXTtcbiAgICAgICAgICAgICAgICBpZiAoIXR5cGVzLmlzTnVsbE9yVW5kZWZpbmVkKG5ld09iamVjdCkgJiYgdHlwZW9mIG5ld09iamVjdCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzKG5ldyBXZWFrUmVmKG5ld09iamVjdCksIG5ld1Byb3BzLCBwYXJlbnRQcm9wcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5wcmVwYXJlQ29udGV4dEZvckV4cHJlc3Npb24gPSBmdW5jdGlvbiAobW9kZWwsIGV4cHJlc3Npb24sIG5ld1Byb3BzKSB7XG4gICAgICAgIHZhciBwYXJlbnRWaWV3QW5kSW5kZXg7XG4gICAgICAgIHZhciBwYXJlbnRWaWV3O1xuICAgICAgICB2YXIgYWRkZWRQcm9wcyA9IG5ld1Byb3BzIHx8IFtdO1xuICAgICAgICBpZiAoZXhwcmVzc2lvbi5pbmRleE9mKGJjLmJpbmRpbmdWYWx1ZUtleSkgPiAtMSkge1xuICAgICAgICAgICAgbW9kZWxbYmMuYmluZGluZ1ZhbHVlS2V5XSA9IG1vZGVsO1xuICAgICAgICAgICAgYWRkZWRQcm9wcy5wdXNoKGJjLmJpbmRpbmdWYWx1ZUtleSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV4cHJlc3Npb24uaW5kZXhPZihiYy5wYXJlbnRWYWx1ZUtleSkgPiAtMSkge1xuICAgICAgICAgICAgcGFyZW50VmlldyA9IHRoaXMuZ2V0UGFyZW50Vmlldyh0aGlzLnRhcmdldC5nZXQoKSwgYmMucGFyZW50VmFsdWVLZXkpLnZpZXc7XG4gICAgICAgICAgICBpZiAocGFyZW50Vmlldykge1xuICAgICAgICAgICAgICAgIG1vZGVsW2JjLnBhcmVudFZhbHVlS2V5XSA9IHBhcmVudFZpZXcuYmluZGluZ0NvbnRleHQ7XG4gICAgICAgICAgICAgICAgYWRkZWRQcm9wcy5wdXNoKGJjLnBhcmVudFZhbHVlS2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyZW50c0FycmF5ID0gZXhwcmVzc2lvbi5tYXRjaChiaW5kaW5nX2J1aWxkZXJfMS5wYXJlbnRzUmVnZXgpO1xuICAgICAgICBpZiAocGFyZW50c0FycmF5KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmVudHNBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHBhcmVudFZpZXdBbmRJbmRleCA9IHRoaXMuZ2V0UGFyZW50Vmlldyh0aGlzLnRhcmdldC5nZXQoKSwgcGFyZW50c0FycmF5W2ldKTtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50Vmlld0FuZEluZGV4LnZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxbYmMucGFyZW50c1ZhbHVlS2V5XSA9IG1vZGVsW2JjLnBhcmVudHNWYWx1ZUtleV0gfHwge307XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsW2JjLnBhcmVudHNWYWx1ZUtleV1bcGFyZW50Vmlld0FuZEluZGV4LmluZGV4XSA9IHBhcmVudFZpZXdBbmRJbmRleC52aWV3LmJpbmRpbmdDb250ZXh0O1xuICAgICAgICAgICAgICAgICAgICBhZGRlZFByb3BzLnB1c2goYmMucGFyZW50c1ZhbHVlS2V5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLmdldFNvdXJjZVByb3BlcnR5VmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgdmFyIGNoYW5nZWRNb2RlbCA9IHt9O1xuICAgICAgICAgICAgY2hhbmdlZE1vZGVsW2JjLmJpbmRpbmdWYWx1ZUtleV0gPSB0aGlzLnNvdXJjZSA/IHRoaXMuc291cmNlLmdldCgpIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgdmFyIGV4cHJlc3Npb25WYWx1ZSA9IHRoaXMuX2dldEV4cHJlc3Npb25WYWx1ZSh0aGlzLm9wdGlvbnMuZXhwcmVzc2lvbiwgZmFsc2UsIGNoYW5nZWRNb2RlbCk7XG4gICAgICAgICAgICBpZiAoZXhwcmVzc2lvblZhbHVlIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKGV4cHJlc3Npb25WYWx1ZS5tZXNzYWdlLCB0cmFjZV8xLmNhdGVnb3JpZXMuQmluZGluZywgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXhwcmVzc2lvblZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNvdXJjZU9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2VPcHRpb25zSW5zdGFuY2UgPSB0aGlzLnNvdXJjZU9wdGlvbnMuaW5zdGFuY2UuZ2V0KCk7XG4gICAgICAgICAgICBpZiAodGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5ID09PSBiYy5iaW5kaW5nVmFsdWVLZXkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlT3B0aW9uc0luc3RhbmNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoKHNvdXJjZU9wdGlvbnNJbnN0YW5jZSBpbnN0YW5jZW9mIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlKSAmJiAodGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5ICYmIHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eSAhPT0gXCJcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlT3B0aW9uc0luc3RhbmNlLmdldCh0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc291cmNlT3B0aW9uc0luc3RhbmNlICYmIHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eSAmJiB0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkgIT09IFwiXCIgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkgaW4gc291cmNlT3B0aW9uc0luc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNvdXJjZU9wdGlvbnNJbnN0YW5jZVt0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIlByb3BlcnR5OiAnXCIgKyB0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkgKyBcIicgaXMgaW52YWxpZCBvciBkb2VzIG5vdCBleGlzdC4gU291cmNlUHJvcGVydHk6ICdcIiArIHRoaXMub3B0aW9ucy5zb3VyY2VQcm9wZXJ0eSArIFwiJ1wiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQmluZGluZywgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5jbGVhckJpbmRpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2xlYXJTb3VyY2UoKTtcbiAgICAgICAgdGhpcy51cGRhdGVUYXJnZXQocHJvcGVydGllc18xLnVuc2V0VmFsdWUpO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUudXBkYXRlVGFyZ2V0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnVwZGF0aW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVPcHRpb25zKHRoaXMudGFyZ2V0T3B0aW9ucywgdHlwZXMuaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpID8gcHJvcGVydGllc18xLnVuc2V0VmFsdWUgOiB2YWx1ZSk7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS51cGRhdGVTb3VyY2UgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMudXBkYXRpbmcgfHwgIXRoaXMuc291cmNlIHx8ICF0aGlzLnNvdXJjZS5nZXQoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlT3B0aW9ucyh0aGlzLnNvdXJjZU9wdGlvbnMsIHZhbHVlKTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLmdldFBhcmVudFZpZXcgPSBmdW5jdGlvbiAodGFyZ2V0LCBwcm9wZXJ0eSkge1xuICAgICAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgdmlldzogbnVsbCwgaW5kZXg6IG51bGwgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBpZiAocHJvcGVydHkgPT09IGJjLnBhcmVudFZhbHVlS2V5KSB7XG4gICAgICAgICAgICByZXN1bHQgPSB0YXJnZXQucGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbmRleCA9IG51bGw7XG4gICAgICAgIGlmIChwcm9wZXJ0eS5pbmRleE9mKGJjLnBhcmVudHNWYWx1ZUtleSkgPT09IDApIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHRhcmdldC5wYXJlbnQ7XG4gICAgICAgICAgICB2YXIgaW5kZXhQYXJhbXMgPSBwYXJhbXNSZWdleC5leGVjKHByb3BlcnR5KTtcbiAgICAgICAgICAgIGlmIChpbmRleFBhcmFtcyAmJiBpbmRleFBhcmFtcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgaW5kZXggPSBpbmRleFBhcmFtc1syXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNOYU4oaW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4QXNJbnQgPSBwYXJzZUludChpbmRleCk7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGluZGV4QXNJbnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4QXNJbnQtLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlcy5pc1N0cmluZyhpbmRleCkpIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAocmVzdWx0ICYmIHJlc3VsdC50eXBlTmFtZSAhPT0gaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnBhcmVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgdmlldzogcmVzdWx0LCBpbmRleDogaW5kZXggfTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnJlc29sdmVPcHRpb25zID0gZnVuY3Rpb24gKG9iaiwgcHJvcGVydGllcykge1xuICAgICAgICB2YXIgb2JqZWN0c0FuZFByb3BlcnRpZXMgPSB0aGlzLnJlc29sdmVPYmplY3RzQW5kUHJvcGVydGllcyhvYmosIHByb3BlcnRpZXMpO1xuICAgICAgICBpZiAob2JqZWN0c0FuZFByb3BlcnRpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIHJlc29sdmVkT2JqID0gb2JqZWN0c0FuZFByb3BlcnRpZXNbb2JqZWN0c0FuZFByb3BlcnRpZXMubGVuZ3RoIC0gMV0uaW5zdGFuY2U7XG4gICAgICAgICAgICB2YXIgcHJvcCA9IG9iamVjdHNBbmRQcm9wZXJ0aWVzW29iamVjdHNBbmRQcm9wZXJ0aWVzLmxlbmd0aCAtIDFdLnByb3BlcnR5O1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZTogbmV3IFdlYWtSZWYodGhpcy5zb3VyY2VBc09iamVjdChyZXNvbHZlZE9iaikpLFxuICAgICAgICAgICAgICAgIHByb3BlcnR5OiBwcm9wXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUudXBkYXRlT3B0aW9ucyA9IGZ1bmN0aW9uIChvcHRpb25zLCB2YWx1ZSkge1xuICAgICAgICB2YXIgb3B0aW9uc0luc3RhbmNlO1xuICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmluc3RhbmNlKSB7XG4gICAgICAgICAgICBvcHRpb25zSW5zdGFuY2UgPSBvcHRpb25zLmluc3RhbmNlLmdldCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghb3B0aW9uc0luc3RhbmNlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGluZyA9IHRydWU7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoaXNFdmVudE9yR2VzdHVyZShvcHRpb25zLnByb3BlcnR5LCBvcHRpb25zSW5zdGFuY2UpICYmXG4gICAgICAgICAgICAgICAgdHlwZXMuaXNGdW5jdGlvbih2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zSW5zdGFuY2Uub2ZmKG9wdGlvbnMucHJvcGVydHksIG51bGwsIG9wdGlvbnNJbnN0YW5jZS5iaW5kaW5nQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgb3B0aW9uc0luc3RhbmNlLm9uKG9wdGlvbnMucHJvcGVydHksIHZhbHVlLCBvcHRpb25zSW5zdGFuY2UuYmluZGluZ0NvbnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAob3B0aW9uc0luc3RhbmNlIGluc3RhbmNlb2Ygb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zSW5zdGFuY2Uuc2V0KG9wdGlvbnMucHJvcGVydHksIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG9wdGlvbnNJbnN0YW5jZVtvcHRpb25zLnByb3BlcnR5XSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkJpbmRpbmcgZXJyb3Igd2hpbGUgc2V0dGluZyBwcm9wZXJ0eSBcIiArIG9wdGlvbnMucHJvcGVydHkgKyBcIiBvZiBcIiArIG9wdGlvbnNJbnN0YW5jZSArIFwiOiBcIiArIGV4LCB0cmFjZV8xLmNhdGVnb3JpZXMuQmluZGluZywgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGluZyA9IGZhbHNlO1xuICAgIH07XG4gICAgcmV0dXJuIEJpbmRpbmc7XG59KCkpO1xuZXhwb3J0cy5CaW5kaW5nID0gQmluZGluZztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJpbmRhYmxlLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciByZWR1Y2VDU1NDYWxjID0gcmVxdWlyZShcInJlZHVjZS1jc3MtY2FsY1wiKTtcbnZhciBvYnNlcnZhYmxlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vZGF0YS9vYnNlcnZhYmxlXCIpO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdHJhY2VcIik7XG52YXIgc3R5bGVfMSA9IHJlcXVpcmUoXCIuLi8uLi9zdHlsaW5nL3N0eWxlXCIpO1xuZXhwb3J0cy5TdHlsZSA9IHN0eWxlXzEuU3R5bGU7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vcHJvZmlsaW5nXCIpO1xuZXhwb3J0cy51bnNldFZhbHVlID0gbmV3IE9iamVjdCgpO1xudmFyIGNzc1Byb3BlcnR5TmFtZXMgPSBbXTtcbnZhciBzeW1ib2xQcm9wZXJ0eU1hcCA9IHt9O1xudmFyIGNzc1N5bWJvbFByb3BlcnR5TWFwID0ge307XG52YXIgaW5oZXJpdGFibGVQcm9wZXJ0aWVzID0gbmV3IEFycmF5KCk7XG52YXIgaW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzID0gbmV3IEFycmF5KCk7XG5mdW5jdGlvbiBwcmludChtYXApIHtcbiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMobWFwKTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIHN5bWJvbHNfMSA9IHN5bWJvbHM7IF9pIDwgc3ltYm9sc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgc3ltYm9sID0gc3ltYm9sc18xW19pXTtcbiAgICAgICAgdmFyIHByb3AgPSBtYXBbc3ltYm9sXTtcbiAgICAgICAgaWYgKCFwcm9wLnJlZ2lzdGVyZWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUHJvcGVydHkgXCIgKyBwcm9wLm5hbWUgKyBcIiBub3QgUmVnaXN0ZXJlZCEhISEhXCIpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gX3ByaW50VW5yZWdpc3RlcmVkUHJvcGVydGllcygpIHtcbiAgICBwcmludChzeW1ib2xQcm9wZXJ0eU1hcCk7XG4gICAgcHJpbnQoY3NzU3ltYm9sUHJvcGVydHlNYXApO1xufVxuZXhwb3J0cy5fcHJpbnRVbnJlZ2lzdGVyZWRQcm9wZXJ0aWVzID0gX3ByaW50VW5yZWdpc3RlcmVkUHJvcGVydGllcztcbmZ1bmN0aW9uIF9nZXRQcm9wZXJ0aWVzKCkge1xuICAgIHJldHVybiBnZXRQcm9wZXJ0aWVzRnJvbU1hcChzeW1ib2xQcm9wZXJ0eU1hcCk7XG59XG5leHBvcnRzLl9nZXRQcm9wZXJ0aWVzID0gX2dldFByb3BlcnRpZXM7XG5mdW5jdGlvbiBfZ2V0U3R5bGVQcm9wZXJ0aWVzKCkge1xuICAgIHJldHVybiBnZXRQcm9wZXJ0aWVzRnJvbU1hcChjc3NTeW1ib2xQcm9wZXJ0eU1hcCk7XG59XG5leHBvcnRzLl9nZXRTdHlsZVByb3BlcnRpZXMgPSBfZ2V0U3R5bGVQcm9wZXJ0aWVzO1xudmFyIGNzc1ZhcmlhYmxlRXhwcmVzc2lvblJlZ2V4cCA9IC9cXGJ2YXJcXChcXHMqKC0tW14sXFxzXSs/KSg/OlxccyosXFxzKiguKykpP1xccypcXCkvO1xudmFyIGNzc1ZhcmlhYmxlQWxsRXhwcmVzc2lvbnNSZWdleHAgPSAvXFxidmFyXFwoXFxzKigtLVteLFxcc10rPykoPzpcXHMqLFxccyooLispKT9cXHMqXFwpL2c7XG5mdW5jdGlvbiBpc0Nzc1ZhcmlhYmxlKHByb3BlcnR5KSB7XG4gICAgcmV0dXJuIC9eLS1bXixcXHNdKz8kLy50ZXN0KHByb3BlcnR5KTtcbn1cbmV4cG9ydHMuaXNDc3NWYXJpYWJsZSA9IGlzQ3NzVmFyaWFibGU7XG5mdW5jdGlvbiBpc0Nzc0NhbGNFeHByZXNzaW9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIC9cXGJjYWxjXFwoLy50ZXN0KHZhbHVlKTtcbn1cbmV4cG9ydHMuaXNDc3NDYWxjRXhwcmVzc2lvbiA9IGlzQ3NzQ2FsY0V4cHJlc3Npb247XG5mdW5jdGlvbiBpc0Nzc1ZhcmlhYmxlRXhwcmVzc2lvbih2YWx1ZSkge1xuICAgIHJldHVybiBjc3NWYXJpYWJsZUV4cHJlc3Npb25SZWdleHAudGVzdCh2YWx1ZSk7XG59XG5leHBvcnRzLmlzQ3NzVmFyaWFibGVFeHByZXNzaW9uID0gaXNDc3NWYXJpYWJsZUV4cHJlc3Npb247XG5mdW5jdGlvbiBfZXZhbHVhdGVDc3NWYXJpYWJsZUV4cHJlc3Npb24odmlldywgY3NzTmFtZSwgdmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgaWYgKCFpc0Nzc1ZhcmlhYmxlRXhwcmVzc2lvbih2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICB2YXIgb3V0cHV0ID0gdmFsdWUudHJpbSgpO1xuICAgIHZhciBsYXN0VmFsdWU7XG4gICAgd2hpbGUgKGxhc3RWYWx1ZSAhPT0gb3V0cHV0KSB7XG4gICAgICAgIGxhc3RWYWx1ZSA9IG91dHB1dDtcbiAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoY3NzVmFyaWFibGVBbGxFeHByZXNzaW9uc1JlZ2V4cCwgZnVuY3Rpb24gKG1hdGNoU3RyLCBjc3NWYXJpYWJsZU5hbWUsIGZhbGxiYWNrU3RyKSB7XG4gICAgICAgICAgICB2YXIgY3NzVmFyaWFibGVWYWx1ZSA9IHZpZXcuc3R5bGUuZ2V0Q3NzVmFyaWFibGUoY3NzVmFyaWFibGVOYW1lKTtcbiAgICAgICAgICAgIGlmIChjc3NWYXJpYWJsZVZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNzc1ZhcmlhYmxlVmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmFsbGJhY2tTdHIpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmFsbGJhY2tPdXRwdXQgPSBfZXZhbHVhdGVDc3NWYXJpYWJsZUV4cHJlc3Npb24odmlldywgY3NzTmFtZSwgZmFsbGJhY2tTdHIpO1xuICAgICAgICAgICAgICAgIGlmIChmYWxsYmFja091dHB1dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsbGJhY2tPdXRwdXQuc3BsaXQoXCIsXCIpWzBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJGYWlsZWQgdG8gZ2V0IHZhbHVlIGZvciBjc3MtdmFyaWFibGUgXFxcIlwiICsgY3NzVmFyaWFibGVOYW1lICsgXCJcXFwiIHVzZWQgaW4gXFxcIlwiICsgY3NzTmFtZSArIFwiXFxcIj1bXCIgKyB2YWx1ZSArIFwiXSB0byBcIiArIHZpZXcsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gXCJ1bnNldFwiO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG91dHB1dDtcbn1cbmV4cG9ydHMuX2V2YWx1YXRlQ3NzVmFyaWFibGVFeHByZXNzaW9uID0gX2V2YWx1YXRlQ3NzVmFyaWFibGVFeHByZXNzaW9uO1xuZnVuY3Rpb24gX2V2YWx1YXRlQ3NzQ2FsY0V4cHJlc3Npb24odmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgaWYgKGlzQ3NzQ2FsY0V4cHJlc3Npb24odmFsdWUpKSB7XG4gICAgICAgIHJldHVybiByZWR1Y2VDU1NDYWxjKHZhbHVlLnJlcGxhY2UoLyhbMC05XSsoXFwuWzAtOV0rKT8pZGlwXFxiL2csIFwiJDFcIikpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbn1cbmV4cG9ydHMuX2V2YWx1YXRlQ3NzQ2FsY0V4cHJlc3Npb24gPSBfZXZhbHVhdGVDc3NDYWxjRXhwcmVzc2lvbjtcbmZ1bmN0aW9uIGdldFByb3BlcnRpZXNGcm9tTWFwKG1hcCkge1xuICAgIHZhciBwcm9wcyA9IFtdO1xuICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMobWFwKS5mb3JFYWNoKGZ1bmN0aW9uIChzeW1ib2wpIHsgcmV0dXJuIHByb3BzLnB1c2gobWFwW3N5bWJvbF0pOyB9KTtcbiAgICByZXR1cm4gcHJvcHM7XG59XG52YXIgUHJvcGVydHkgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFByb3BlcnR5KG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5lbnVtZXJhYmxlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgICAgICB2YXIgcHJvcGVydHlOYW1lID0gb3B0aW9ucy5uYW1lO1xuICAgICAgICB0aGlzLm5hbWUgPSBwcm9wZXJ0eU5hbWU7XG4gICAgICAgIHZhciBrZXkgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6cHJvcGVydHlLZXlcIik7XG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xuICAgICAgICB2YXIgZ2V0RGVmYXVsdCA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpnZXREZWZhdWx0XCIpO1xuICAgICAgICB0aGlzLmdldERlZmF1bHQgPSBnZXREZWZhdWx0O1xuICAgICAgICB2YXIgc2V0TmF0aXZlID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOnNldE5hdGl2ZVwiKTtcbiAgICAgICAgdGhpcy5zZXROYXRpdmUgPSBzZXROYXRpdmU7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWVLZXkgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6bmF0aXZlRGVmYXVsdFZhbHVlXCIpO1xuICAgICAgICB0aGlzLmRlZmF1bHRWYWx1ZUtleSA9IGRlZmF1bHRWYWx1ZUtleTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZSA9IG9wdGlvbnMuZGVmYXVsdFZhbHVlO1xuICAgICAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdmFyIGV2ZW50TmFtZSA9IHByb3BlcnR5TmFtZSArIFwiQ2hhbmdlXCI7XG4gICAgICAgIHZhciBlcXVhbGl0eUNvbXBhcmVyID0gb3B0aW9ucy5lcXVhbGl0eUNvbXBhcmVyO1xuICAgICAgICB2YXIgYWZmZWN0c0xheW91dCA9IG9wdGlvbnMuYWZmZWN0c0xheW91dDtcbiAgICAgICAgdmFyIHZhbHVlQ2hhbmdlZCA9IG9wdGlvbnMudmFsdWVDaGFuZ2VkO1xuICAgICAgICB2YXIgdmFsdWVDb252ZXJ0ZXIgPSBvcHRpb25zLnZhbHVlQ29udmVydGVyO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSB0aGlzO1xuICAgICAgICB0aGlzLnNldCA9IGZ1bmN0aW9uIChib3hlZFZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgcmVzZXQgPSBib3hlZFZhbHVlID09PSBleHBvcnRzLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2YXIgdmFsdWU7XG4gICAgICAgICAgICB2YXIgd3JhcHBlZDtcbiAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgd3JhcHBlZCA9IGJveGVkVmFsdWUgJiYgYm94ZWRWYWx1ZS53cmFwcGVkO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gd3JhcHBlZCA/IG9ic2VydmFibGVfMS5XcmFwcGVkVmFsdWUudW53cmFwKGJveGVkVmFsdWUpIDogYm94ZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVDb252ZXJ0ZXIgJiYgdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVDb252ZXJ0ZXIodmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IGtleSBpbiB0aGlzID8gdGhpc1trZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBlcXVhbGl0eUNvbXBhcmVyID8gIWVxdWFsaXR5Q29tcGFyZXIob2xkVmFsdWUsIHZhbHVlKSA6IG9sZFZhbHVlICE9PSB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh3cmFwcGVkIHx8IGNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWZmZWN0c0xheW91dCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzW3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbc2V0TmF0aXZlXSh0aGlzW2RlZmF1bHRWYWx1ZUtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tkZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tzZXROYXRpdmVdKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tkZWZhdWx0VmFsdWVLZXldID0gdGhpc1tnZXREZWZhdWx0XSA/IHRoaXNbZ2V0RGVmYXVsdF0oKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tzZXROYXRpdmVdKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNMaXN0ZW5lcnMoZXZlbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeSh7IG9iamVjdDogdGhpcywgZXZlbnROYW1lOiBldmVudE5hbWUsIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lLCB2YWx1ZTogdmFsdWUsIG9sZFZhbHVlOiBvbGRWYWx1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9tTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tTm9kZS5hdHRyaWJ1dGVSZW1vdmVkKHByb3BlcnR5TmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbU5vZGUuYXR0cmlidXRlTW9kaWZpZWQocHJvcGVydHlOYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGtleSBpbiB0aGlzID8gdGhpc1trZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm5hdGl2ZVZhbHVlQ2hhbmdlID0gZnVuY3Rpb24gKG93bmVyLCB2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIG9sZFZhbHVlID0ga2V5IGluIG93bmVyID8gb3duZXJba2V5XSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkID0gZXF1YWxpdHlDb21wYXJlciA/ICFlcXVhbGl0eUNvbXBhcmVyKG9sZFZhbHVlLCB2YWx1ZSkgOiBvbGRWYWx1ZSAhPT0gdmFsdWU7XG4gICAgICAgICAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIG93bmVyW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZChvd25lciwgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG93bmVyLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgJiYgIShkZWZhdWx0VmFsdWVLZXkgaW4gb3duZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIG93bmVyW2RlZmF1bHRWYWx1ZUtleV0gPSBvd25lcltnZXREZWZhdWx0XSA/IG93bmVyW2dldERlZmF1bHRdKCkgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChvd25lci5oYXNMaXN0ZW5lcnMoZXZlbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBvd25lci5ub3RpZnkoeyBvYmplY3Q6IG93bmVyLCBldmVudE5hbWU6IGV2ZW50TmFtZSwgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsIHZhbHVlOiB2YWx1ZSwgb2xkVmFsdWU6IG9sZFZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWZmZWN0c0xheW91dCkge1xuICAgICAgICAgICAgICAgICAgICBvd25lci5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChvd25lci5kb21Ob2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIG93bmVyLmRvbU5vZGUuYXR0cmlidXRlTW9kaWZpZWQocHJvcGVydHlOYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBzeW1ib2xQcm9wZXJ0eU1hcFtrZXldID0gdGhpcztcbiAgICB9XG4gICAgUHJvcGVydHkucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKGNscykge1xuICAgICAgICBpZiAodGhpcy5yZWdpc3RlcmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcm9wZXJ0eSBcIiArIHRoaXMubmFtZSArIFwiIGFscmVhZHkgcmVnaXN0ZXJlZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZWdpc3RlcmVkID0gdHJ1ZTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIHRoaXMubmFtZSwgdGhpcyk7XG4gICAgfTtcbiAgICBQcm9wZXJ0eS5wcm90b3R5cGUuaXNTZXQgPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMua2V5IGluIGluc3RhbmNlO1xuICAgIH07XG4gICAgcmV0dXJuIFByb3BlcnR5O1xufSgpKTtcbmV4cG9ydHMuUHJvcGVydHkgPSBQcm9wZXJ0eTtcblByb3BlcnR5LnByb3RvdHlwZS5pc1N0eWxlUHJvcGVydHkgPSBmYWxzZTtcbnZhciBDb2VyY2libGVQcm9wZXJ0eSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENvZXJjaWJsZVByb3BlcnR5LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENvZXJjaWJsZVByb3BlcnR5KG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgb3B0aW9ucykgfHwgdGhpcztcbiAgICAgICAgdmFyIHByb3BlcnR5TmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgdmFyIGtleSA9IF90aGlzLmtleTtcbiAgICAgICAgdmFyIGdldERlZmF1bHQgPSBfdGhpcy5nZXREZWZhdWx0O1xuICAgICAgICB2YXIgc2V0TmF0aXZlID0gX3RoaXMuc2V0TmF0aXZlO1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlS2V5ID0gX3RoaXMuZGVmYXVsdFZhbHVlS2V5O1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlID0gX3RoaXMuZGVmYXVsdFZhbHVlO1xuICAgICAgICB2YXIgY29lcmNlS2V5ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOmNvZXJjZUtleVwiKTtcbiAgICAgICAgdmFyIGV2ZW50TmFtZSA9IHByb3BlcnR5TmFtZSArIFwiQ2hhbmdlXCI7XG4gICAgICAgIHZhciBhZmZlY3RzTGF5b3V0ID0gb3B0aW9ucy5hZmZlY3RzTGF5b3V0O1xuICAgICAgICB2YXIgZXF1YWxpdHlDb21wYXJlciA9IG9wdGlvbnMuZXF1YWxpdHlDb21wYXJlcjtcbiAgICAgICAgdmFyIHZhbHVlQ2hhbmdlZCA9IG9wdGlvbnMudmFsdWVDaGFuZ2VkO1xuICAgICAgICB2YXIgdmFsdWVDb252ZXJ0ZXIgPSBvcHRpb25zLnZhbHVlQ29udmVydGVyO1xuICAgICAgICB2YXIgY29lcmNlQ2FsbGJhY2sgPSBvcHRpb25zLmNvZXJjZVZhbHVlO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBfdGhpcztcbiAgICAgICAgX3RoaXMuY29lcmNlID0gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgICAgICAgdmFyIG9yaWdpbmFsVmFsdWUgPSBjb2VyY2VLZXkgaW4gdGFyZ2V0ID8gdGFyZ2V0W2NvZXJjZUtleV0gOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB0YXJnZXRbcHJvcGVydHlOYW1lXSA9IG9yaWdpbmFsVmFsdWU7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLnNldCA9IGZ1bmN0aW9uIChib3hlZFZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgcmVzZXQgPSBib3hlZFZhbHVlID09PSBleHBvcnRzLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2YXIgdmFsdWU7XG4gICAgICAgICAgICB2YXIgd3JhcHBlZDtcbiAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2NvZXJjZUtleV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB3cmFwcGVkID0gYm94ZWRWYWx1ZSAmJiBib3hlZFZhbHVlLndyYXBwZWQ7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB3cmFwcGVkID8gb2JzZXJ2YWJsZV8xLldyYXBwZWRWYWx1ZS51bndyYXAoYm94ZWRWYWx1ZSkgOiBib3hlZFZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNvbnZlcnRlciAmJiB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZUNvbnZlcnRlcih2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNbY29lcmNlS2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gY29lcmNlQ2FsbGJhY2sodGhpcywgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9sZFZhbHVlID0ga2V5IGluIHRoaXMgPyB0aGlzW2tleV0gOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB2YXIgY2hhbmdlZCA9IGVxdWFsaXR5Q29tcGFyZXIgPyAhZXF1YWxpdHlDb21wYXJlcihvbGRWYWx1ZSwgdmFsdWUpIDogb2xkVmFsdWUgIT09IHZhbHVlO1xuICAgICAgICAgICAgaWYgKHdyYXBwZWQgfHwgY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1trZXldO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1tzZXROYXRpdmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3NldE5hdGl2ZV0odGhpc1tkZWZhdWx0VmFsdWVLZXldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbZGVmYXVsdFZhbHVlS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbc2V0TmF0aXZlXShkZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzW3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbZGVmYXVsdFZhbHVlS2V5XSA9IHRoaXNbZ2V0RGVmYXVsdF0gPyB0aGlzW2dldERlZmF1bHRdKCkgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzTGlzdGVuZXJzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoeyBvYmplY3Q6IHRoaXMsIGV2ZW50TmFtZTogZXZlbnROYW1lLCBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSwgdmFsdWU6IHZhbHVlLCBvbGRWYWx1ZTogb2xkVmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhZmZlY3RzTGF5b3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVxdWVzdExheW91dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kb21Ob2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb21Ob2RlLmF0dHJpYnV0ZVJlbW92ZWQocHJvcGVydHlOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tTm9kZS5hdHRyaWJ1dGVNb2RpZmllZChwcm9wZXJ0eU5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICByZXR1cm4gQ29lcmNpYmxlUHJvcGVydHk7XG59KFByb3BlcnR5KSk7XG5leHBvcnRzLkNvZXJjaWJsZVByb3BlcnR5ID0gQ29lcmNpYmxlUHJvcGVydHk7XG52YXIgSW5oZXJpdGVkUHJvcGVydHkgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJbmhlcml0ZWRQcm9wZXJ0eSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBJbmhlcml0ZWRQcm9wZXJ0eShvcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgICAgIHZhciBuYW1lID0gb3B0aW9ucy5uYW1lO1xuICAgICAgICB2YXIga2V5ID0gX3RoaXMua2V5O1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlID0gb3B0aW9ucy5kZWZhdWx0VmFsdWU7XG4gICAgICAgIHZhciBzb3VyY2VLZXkgPSBTeW1ib2wobmFtZSArIFwiOnZhbHVlU291cmNlS2V5XCIpO1xuICAgICAgICBfdGhpcy5zb3VyY2VLZXkgPSBzb3VyY2VLZXk7XG4gICAgICAgIHZhciBzZXRCYXNlID0gX3RoaXMuc2V0O1xuICAgICAgICB2YXIgc2V0RnVuYyA9IGZ1bmN0aW9uICh2YWx1ZVNvdXJjZSkgeyByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgdW5ib3hlZFZhbHVlO1xuICAgICAgICAgICAgdmFyIG5ld1ZhbHVlU291cmNlO1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBleHBvcnRzLnVuc2V0VmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50XzEgPSB0aGF0LnBhcmVudDtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50XzEgJiYgcGFyZW50XzFbc291cmNlS2V5XSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB1bmJveGVkVmFsdWUgPSBwYXJlbnRfMVtuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWVTb3VyY2UgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdW5ib3hlZFZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZVNvdXJjZSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdW5ib3hlZFZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgbmV3VmFsdWVTb3VyY2UgPSB2YWx1ZVNvdXJjZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSB0aGF0W2tleV07XG4gICAgICAgICAgICBzZXRCYXNlLmNhbGwodGhhdCwgdW5ib3hlZFZhbHVlKTtcbiAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IHRoYXRba2V5XTtcbiAgICAgICAgICAgIHRoYXRbc291cmNlS2V5XSA9IG5ld1ZhbHVlU291cmNlO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSAhPT0gbmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzZXRfMSA9IG5ld1ZhbHVlU291cmNlID09PSAwO1xuICAgICAgICAgICAgICAgIHRoYXQuZWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRWYWx1ZVNvdXJjZSA9IGNoaWxkW3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc2V0XzEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZFZhbHVlU291cmNlID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0RnVuYy5jYWxsKGNoaWxkLCBleHBvcnRzLnVuc2V0VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkVmFsdWVTb3VyY2UgPD0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEluaGVyaXRlZFZhbHVlLmNhbGwoY2hpbGQsIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTsgfTtcbiAgICAgICAgdmFyIHNldEluaGVyaXRlZFZhbHVlID0gc2V0RnVuYygxKTtcbiAgICAgICAgX3RoaXMuc2V0SW5oZXJpdGVkVmFsdWUgPSBzZXRJbmhlcml0ZWRWYWx1ZTtcbiAgICAgICAgX3RoaXMuc2V0ID0gc2V0RnVuYygzKTtcbiAgICAgICAgaW5oZXJpdGFibGVQcm9wZXJ0aWVzLnB1c2goX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBJbmhlcml0ZWRQcm9wZXJ0eTtcbn0oUHJvcGVydHkpKTtcbmV4cG9ydHMuSW5oZXJpdGVkUHJvcGVydHkgPSBJbmhlcml0ZWRQcm9wZXJ0eTtcbnZhciBDc3NQcm9wZXJ0eSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ3NzUHJvcGVydHkob3B0aW9ucykge1xuICAgICAgICB2YXIgcHJvcGVydHlOYW1lID0gb3B0aW9ucy5uYW1lO1xuICAgICAgICB0aGlzLm5hbWUgPSBwcm9wZXJ0eU5hbWU7XG4gICAgICAgIGNzc1Byb3BlcnR5TmFtZXMucHVzaChvcHRpb25zLmNzc05hbWUpO1xuICAgICAgICB0aGlzLmNzc05hbWUgPSBcImNzczpcIiArIG9wdGlvbnMuY3NzTmFtZTtcbiAgICAgICAgdGhpcy5jc3NMb2NhbE5hbWUgPSBvcHRpb25zLmNzc05hbWU7XG4gICAgICAgIHZhciBrZXkgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6cHJvcGVydHlLZXlcIik7XG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOnZhbHVlU291cmNlS2V5XCIpO1xuICAgICAgICB0aGlzLnNvdXJjZUtleSA9IHNvdXJjZUtleTtcbiAgICAgICAgdmFyIGdldERlZmF1bHQgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6Z2V0RGVmYXVsdFwiKTtcbiAgICAgICAgdGhpcy5nZXREZWZhdWx0ID0gZ2V0RGVmYXVsdDtcbiAgICAgICAgdmFyIHNldE5hdGl2ZSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpzZXROYXRpdmVcIik7XG4gICAgICAgIHRoaXMuc2V0TmF0aXZlID0gc2V0TmF0aXZlO1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlS2V5ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOm5hdGl2ZURlZmF1bHRWYWx1ZVwiKTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWVLZXkgPSBkZWZhdWx0VmFsdWVLZXk7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWUgPSBvcHRpb25zLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgIHZhciBldmVudE5hbWUgPSBwcm9wZXJ0eU5hbWUgKyBcIkNoYW5nZVwiO1xuICAgICAgICB2YXIgYWZmZWN0c0xheW91dCA9IG9wdGlvbnMuYWZmZWN0c0xheW91dDtcbiAgICAgICAgdmFyIGVxdWFsaXR5Q29tcGFyZXIgPSBvcHRpb25zLmVxdWFsaXR5Q29tcGFyZXI7XG4gICAgICAgIHZhciB2YWx1ZUNoYW5nZWQgPSBvcHRpb25zLnZhbHVlQ2hhbmdlZDtcbiAgICAgICAgdmFyIHZhbHVlQ29udmVydGVyID0gb3B0aW9ucy52YWx1ZUNvbnZlcnRlcjtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gc2V0TG9jYWxWYWx1ZShuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVzZXQgPSBuZXdWYWx1ZSA9PT0gZXhwb3J0cy51bnNldFZhbHVlIHx8IG5ld1ZhbHVlID09PSBcIlwiO1xuICAgICAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbc291cmNlS2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXNbc291cmNlS2V5XSA9IDM7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSAodmFsdWVDb252ZXJ0ZXIgJiYgdHlwZW9mIG5ld1ZhbHVlID09PSBcInN0cmluZ1wiKSA/XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlQ29udmVydGVyKG5ld1ZhbHVlKSA6XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9sZFZhbHVlID0ga2V5IGluIHRoaXMgPyB0aGlzW2tleV0gOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB2YXIgY2hhbmdlZCA9IGVxdWFsaXR5Q29tcGFyZXIgPyAhZXF1YWxpdHlDb21wYXJlcihvbGRWYWx1ZSwgdmFsdWUpIDogb2xkVmFsdWUgIT09IHZhbHVlO1xuICAgICAgICAgICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKHRoaXNbZGVmYXVsdFZhbHVlS2V5XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2RlZmF1bHRWYWx1ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0oZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodmlld1tzZXROYXRpdmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2RlZmF1bHRWYWx1ZUtleV0gPSB2aWV3W2dldERlZmF1bHRdID8gdmlld1tnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0odmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc0xpc3RlbmVycyhldmVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KHsgb2JqZWN0OiB0aGlzLCBldmVudE5hbWU6IGV2ZW50TmFtZSwgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsIHZhbHVlOiB2YWx1ZSwgb2xkVmFsdWU6IG9sZFZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWZmZWN0c0xheW91dCkge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2V0Q3NzVmFsdWUobmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldyBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZVNvdXJjZSA9IHRoaXNbc291cmNlS2V5XSB8fCAwO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZVNvdXJjZSA9PT0gMykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZXNldCA9IG5ld1ZhbHVlID09PSBleHBvcnRzLnVuc2V0VmFsdWUgfHwgbmV3VmFsdWUgPT09IFwiXCI7XG4gICAgICAgICAgICB2YXIgdmFsdWU7XG4gICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tzb3VyY2VLZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZUNvbnZlcnRlciAmJiB0eXBlb2YgbmV3VmFsdWUgPT09IFwic3RyaW5nXCIgP1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZUNvbnZlcnRlcihuZXdWYWx1ZSkgOlxuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzW3NvdXJjZUtleV0gPSAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9sZFZhbHVlID0ga2V5IGluIHRoaXMgPyB0aGlzW2tleV0gOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB2YXIgY2hhbmdlZCA9IGVxdWFsaXR5Q29tcGFyZXIgPyAhZXF1YWxpdHlDb21wYXJlcihvbGRWYWx1ZSwgdmFsdWUpIDogb2xkVmFsdWUgIT09IHZhbHVlO1xuICAgICAgICAgICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKHRoaXNbZGVmYXVsdFZhbHVlS2V5XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2RlZmF1bHRWYWx1ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0oZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodmlld1tzZXROYXRpdmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2RlZmF1bHRWYWx1ZUtleV0gPSB2aWV3W2dldERlZmF1bHRdID8gdmlld1tnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0odmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc0xpc3RlbmVycyhldmVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KHsgb2JqZWN0OiB0aGlzLCBldmVudE5hbWU6IGV2ZW50TmFtZSwgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsIHZhbHVlOiB2YWx1ZSwgb2xkVmFsdWU6IG9sZFZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWZmZWN0c0xheW91dCkge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIGtleSBpbiB0aGlzID8gdGhpc1trZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY3NzVmFsdWVEZXNjcmlwdG9yID0ge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZ2V0LFxuICAgICAgICAgICAgc2V0OiBzZXRDc3NWYWx1ZVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmxvY2FsVmFsdWVEZXNjcmlwdG9yID0ge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogZ2V0LFxuICAgICAgICAgICAgc2V0OiBzZXRMb2NhbFZhbHVlXG4gICAgICAgIH07XG4gICAgICAgIGNzc1N5bWJvbFByb3BlcnR5TWFwW2tleV0gPSB0aGlzO1xuICAgIH1cbiAgICBDc3NQcm9wZXJ0eS5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiAoY2xzKSB7XG4gICAgICAgIGlmICh0aGlzLnJlZ2lzdGVyZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlByb3BlcnR5IFwiICsgdGhpcy5uYW1lICsgXCIgYWxyZWFkeSByZWdpc3RlcmVkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZ2lzdGVyZWQgPSB0cnVlO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgdGhpcy5uYW1lLCB0aGlzLmxvY2FsVmFsdWVEZXNjcmlwdG9yKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIHRoaXMuY3NzTmFtZSwgdGhpcy5jc3NWYWx1ZURlc2NyaXB0b3IpO1xuICAgICAgICBpZiAodGhpcy5jc3NMb2NhbE5hbWUgIT09IHRoaXMuY3NzTmFtZSkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIHRoaXMuY3NzTG9jYWxOYW1lLCB0aGlzLmxvY2FsVmFsdWVEZXNjcmlwdG9yKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ3NzUHJvcGVydHkucHJvdG90eXBlLmlzU2V0ID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleSBpbiBpbnN0YW5jZTtcbiAgICB9O1xuICAgIHJldHVybiBDc3NQcm9wZXJ0eTtcbn0oKSk7XG5leHBvcnRzLkNzc1Byb3BlcnR5ID0gQ3NzUHJvcGVydHk7XG5Dc3NQcm9wZXJ0eS5wcm90b3R5cGUuaXNTdHlsZVByb3BlcnR5ID0gdHJ1ZTtcbnZhciBDc3NBbmltYXRpb25Qcm9wZXJ0eSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ3NzQW5pbWF0aW9uUHJvcGVydHkob3B0aW9ucykge1xuICAgICAgICB2YXIgdmFsdWVDb252ZXJ0ZXIgPSBvcHRpb25zLnZhbHVlQ29udmVydGVyLCBlcXVhbGl0eUNvbXBhcmVyID0gb3B0aW9ucy5lcXVhbGl0eUNvbXBhcmVyLCB2YWx1ZUNoYW5nZWQgPSBvcHRpb25zLnZhbHVlQ2hhbmdlZCwgZGVmYXVsdFZhbHVlID0gb3B0aW9ucy5kZWZhdWx0VmFsdWU7XG4gICAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSBvcHRpb25zLm5hbWU7XG4gICAgICAgIHRoaXMubmFtZSA9IHByb3BlcnR5TmFtZTtcbiAgICAgICAgY3NzUHJvcGVydHlOYW1lcy5wdXNoKG9wdGlvbnMuY3NzTmFtZSk7XG4gICAgICAgIENzc0FuaW1hdGlvblByb3BlcnR5LnByb3BlcnRpZXNbcHJvcGVydHlOYW1lXSA9IHRoaXM7XG4gICAgICAgIGlmIChvcHRpb25zLmNzc05hbWUgJiYgb3B0aW9ucy5jc3NOYW1lICE9PSBwcm9wZXJ0eU5hbWUpIHtcbiAgICAgICAgICAgIENzc0FuaW1hdGlvblByb3BlcnR5LnByb3BlcnRpZXNbb3B0aW9ucy5jc3NOYW1lXSA9IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdmFsdWVDb252ZXJ0ZXIgPSBvcHRpb25zLnZhbHVlQ29udmVydGVyO1xuICAgICAgICB2YXIgY3NzTG9jYWxOYW1lID0gKG9wdGlvbnMuY3NzTmFtZSB8fCBwcm9wZXJ0eU5hbWUpO1xuICAgICAgICB0aGlzLmNzc0xvY2FsTmFtZSA9IGNzc0xvY2FsTmFtZTtcbiAgICAgICAgdmFyIGNzc05hbWUgPSBcImNzczpcIiArIGNzc0xvY2FsTmFtZTtcbiAgICAgICAgdGhpcy5jc3NOYW1lID0gY3NzTmFtZTtcbiAgICAgICAgdmFyIGtleWZyYW1lTmFtZSA9IFwia2V5ZnJhbWU6XCIgKyBwcm9wZXJ0eU5hbWU7XG4gICAgICAgIHRoaXMua2V5ZnJhbWUgPSBrZXlmcmFtZU5hbWU7XG4gICAgICAgIHZhciBkZWZhdWx0TmFtZSA9IFwiZGVmYXVsdDpcIiArIHByb3BlcnR5TmFtZTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZUtleSA9IFN5bWJvbChkZWZhdWx0TmFtZSk7XG4gICAgICAgIHRoaXMuZGVmYXVsdFZhbHVlS2V5ID0gZGVmYXVsdFZhbHVlS2V5O1xuICAgICAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdmFyIGNzc1ZhbHVlID0gU3ltYm9sKGNzc05hbWUpO1xuICAgICAgICB2YXIgc3R5bGVWYWx1ZSA9IFN5bWJvbChcImxvY2FsOlwiICsgcHJvcGVydHlOYW1lKTtcbiAgICAgICAgdmFyIGtleWZyYW1lVmFsdWUgPSBTeW1ib2woa2V5ZnJhbWVOYW1lKTtcbiAgICAgICAgdmFyIGNvbXB1dGVkVmFsdWUgPSBTeW1ib2woXCJjb21wdXRlZC12YWx1ZTpcIiArIHByb3BlcnR5TmFtZSk7XG4gICAgICAgIHRoaXMua2V5ID0gY29tcHV0ZWRWYWx1ZTtcbiAgICAgICAgdmFyIGNvbXB1dGVkU291cmNlID0gU3ltYm9sKFwiY29tcHV0ZWQtc291cmNlOlwiICsgcHJvcGVydHlOYW1lKTtcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBjb21wdXRlZFNvdXJjZTtcbiAgICAgICAgdGhpcy5nZXREZWZhdWx0ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOmdldERlZmF1bHRcIik7XG4gICAgICAgIHZhciBnZXREZWZhdWx0ID0gdGhpcy5nZXREZWZhdWx0O1xuICAgICAgICB2YXIgc2V0TmF0aXZlID0gdGhpcy5zZXROYXRpdmUgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6c2V0TmF0aXZlXCIpO1xuICAgICAgICB2YXIgZXZlbnROYW1lID0gcHJvcGVydHlOYW1lICsgXCJDaGFuZ2VcIjtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gdGhpcztcbiAgICAgICAgZnVuY3Rpb24gZGVzY3JpcHRvcihzeW1ib2wsIHByb3BlcnR5U291cmNlLCBlbnVtZXJhYmxlLCBjb25maWd1cmFibGUsIGdldHNDb21wdXRlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBlbnVtZXJhYmxlLCBjb25maWd1cmFibGU6IGNvbmZpZ3VyYWJsZSxcbiAgICAgICAgICAgICAgICBnZXQ6IGdldHNDb21wdXRlZCA/IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXNbY29tcHV0ZWRWYWx1ZV07IH0gOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzW3N5bWJvbF07IH0sXG4gICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAoYm94ZWRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKGJveGVkVmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbiwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkVmFsdWUgPSB0aGlzW2NvbXB1dGVkVmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkU291cmNlID0gdGhpc1tjb21wdXRlZFNvdXJjZV07XG4gICAgICAgICAgICAgICAgICAgIHZhciB3YXNTZXQgPSBvbGRTb3VyY2UgIT09IDA7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXNldCA9IGJveGVkVmFsdWUgPT09IGV4cG9ydHMudW5zZXRWYWx1ZSB8fCBib3hlZFZhbHVlID09PSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbc3ltYm9sXSA9IGV4cG9ydHMudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzW2NvbXB1dGVkU291cmNlXSA9PT0gcHJvcGVydHlTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1tzdHlsZVZhbHVlXSAhPT0gZXhwb3J0cy51bnNldFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbY29tcHV0ZWRTb3VyY2VdID0gMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tjb21wdXRlZFZhbHVlXSA9IHRoaXNbc3R5bGVWYWx1ZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXNbY3NzVmFsdWVdICE9PSBleHBvcnRzLnVuc2V0VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tjb21wdXRlZFNvdXJjZV0gPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2NvbXB1dGVkVmFsdWVdID0gdGhpc1tjc3NWYWx1ZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tjb21wdXRlZFNvdXJjZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2NvbXB1dGVkVmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNvbnZlcnRlciAmJiB0eXBlb2YgYm94ZWRWYWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJveGVkVmFsdWUgPSB2YWx1ZUNvbnZlcnRlcihib3hlZFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbc3ltYm9sXSA9IGJveGVkVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1tjb21wdXRlZFNvdXJjZV0gPD0gcHJvcGVydHlTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2NvbXB1dGVkU291cmNlXSA9IHByb3BlcnR5U291cmNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbY29tcHV0ZWRWYWx1ZV0gPSBib3hlZFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXNbY29tcHV0ZWRWYWx1ZV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzW2NvbXB1dGVkU291cmNlXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzU2V0ID0gc291cmNlICE9PSAwO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29tcHV0ZWRWYWx1ZUNoYW5nZWQgPSBvbGRWYWx1ZSAhPT0gdmFsdWUgJiYgKCFlcXVhbGl0eUNvbXBhcmVyIHx8ICFlcXVhbGl0eUNvbXBhcmVyKG9sZFZhbHVlLCB2YWx1ZSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29tcHV0ZWRWYWx1ZUNoYW5nZWQgJiYgdmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodmlld1tzZXROYXRpdmVdICYmIChjb21wdXRlZFZhbHVlQ2hhbmdlZCB8fCBpc1NldCAhPT0gd2FzU2V0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNTZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF3YXNTZXQgJiYgIShkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbZ2V0RGVmYXVsdF0gPyB2aWV3W2dldERlZmF1bHRdKCkgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAod2FzU2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKHRoaXNbZGVmYXVsdFZhbHVlS2V5XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0oZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tcHV0ZWRWYWx1ZUNoYW5nZWQgJiYgdGhpcy5oYXNMaXN0ZW5lcnMoZXZlbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoeyBvYmplY3Q6IHRoaXMsIGV2ZW50TmFtZTogZXZlbnROYW1lLCBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSwgdmFsdWU6IHZhbHVlLCBvbGRWYWx1ZTogb2xkVmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBkZWZhdWx0UHJvcGVydHlEZXNjcmlwdG9yID0gZGVzY3JpcHRvcihkZWZhdWx0VmFsdWVLZXksIDAsIGZhbHNlLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgICB2YXIgY3NzUHJvcGVydHlEZXNjcmlwdG9yID0gZGVzY3JpcHRvcihjc3NWYWx1ZSwgMiwgZmFsc2UsIGZhbHNlLCBmYWxzZSk7XG4gICAgICAgIHZhciBzdHlsZVByb3BlcnR5RGVzY3JpcHRvciA9IGRlc2NyaXB0b3Ioc3R5bGVWYWx1ZSwgMywgdHJ1ZSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgIHZhciBrZXlmcmFtZVByb3BlcnR5RGVzY3JpcHRvciA9IGRlc2NyaXB0b3Ioa2V5ZnJhbWVWYWx1ZSwgNCwgZmFsc2UsIGZhbHNlLCBmYWxzZSk7XG4gICAgICAgIHN5bWJvbFByb3BlcnR5TWFwW2NvbXB1dGVkVmFsdWVdID0gdGhpcztcbiAgICAgICAgY3NzU3ltYm9sUHJvcGVydHlNYXBbY29tcHV0ZWRWYWx1ZV0gPSB0aGlzO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyID0gZnVuY3Rpb24gKGNscykge1xuICAgICAgICAgICAgY2xzLnByb3RvdHlwZVtjb21wdXRlZFZhbHVlXSA9IG9wdGlvbnMuZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgY2xzLnByb3RvdHlwZVtjb21wdXRlZFNvdXJjZV0gPSAwO1xuICAgICAgICAgICAgY2xzLnByb3RvdHlwZVtjc3NWYWx1ZV0gPSBleHBvcnRzLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICBjbHMucHJvdG90eXBlW3N0eWxlVmFsdWVdID0gZXhwb3J0cy51bnNldFZhbHVlO1xuICAgICAgICAgICAgY2xzLnByb3RvdHlwZVtrZXlmcmFtZVZhbHVlXSA9IGV4cG9ydHMudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCBkZWZhdWx0TmFtZSwgZGVmYXVsdFByb3BlcnR5RGVzY3JpcHRvcik7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgY3NzTmFtZSwgY3NzUHJvcGVydHlEZXNjcmlwdG9yKTtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCBwcm9wZXJ0eU5hbWUsIHN0eWxlUHJvcGVydHlEZXNjcmlwdG9yKTtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmNzc05hbWUgJiYgb3B0aW9ucy5jc3NOYW1lICE9PSBvcHRpb25zLm5hbWUpIHtcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgb3B0aW9ucy5jc3NOYW1lLCBzdHlsZVByb3BlcnR5RGVzY3JpcHRvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwga2V5ZnJhbWVOYW1lLCBrZXlmcmFtZVByb3BlcnR5RGVzY3JpcHRvcik7XG4gICAgICAgIH07XG4gICAgfVxuICAgIENzc0FuaW1hdGlvblByb3BlcnR5LnByb3RvdHlwZS5faW5pdERlZmF1bHROYXRpdmVWYWx1ZSA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiX2luaXREZWZhdWx0TmF0aXZlVmFsdWUgbm90IGV4ZWN1dGVkIHRvIHZpZXcgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbiwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlS2V5ID0gdGhpcy5kZWZhdWx0VmFsdWVLZXk7XG4gICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiB0YXJnZXQpKSB7XG4gICAgICAgICAgICB2YXIgZ2V0RGVmYXVsdCA9IHRoaXMuZ2V0RGVmYXVsdDtcbiAgICAgICAgICAgIHRhcmdldFtkZWZhdWx0VmFsdWVLZXldID0gdmlld1tnZXREZWZhdWx0XSA/IHZpZXdbZ2V0RGVmYXVsdF0oKSA6IHRoaXMuZGVmYXVsdFZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDc3NBbmltYXRpb25Qcm9wZXJ0eS5fZ2V0QnlDc3NOYW1lID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllc1tuYW1lXTtcbiAgICB9O1xuICAgIENzc0FuaW1hdGlvblByb3BlcnR5Ll9nZXRQcm9wZXJ0eU5hbWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoQ3NzQW5pbWF0aW9uUHJvcGVydHkucHJvcGVydGllcyk7XG4gICAgfTtcbiAgICBDc3NBbmltYXRpb25Qcm9wZXJ0eS5wcm90b3R5cGUuaXNTZXQgPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlW3RoaXMuc291cmNlXSAhPT0gMDtcbiAgICB9O1xuICAgIENzc0FuaW1hdGlvblByb3BlcnR5LnByb3BlcnRpZXMgPSB7fTtcbiAgICByZXR1cm4gQ3NzQW5pbWF0aW9uUHJvcGVydHk7XG59KCkpO1xuZXhwb3J0cy5Dc3NBbmltYXRpb25Qcm9wZXJ0eSA9IENzc0FuaW1hdGlvblByb3BlcnR5O1xuQ3NzQW5pbWF0aW9uUHJvcGVydHkucHJvdG90eXBlLmlzU3R5bGVQcm9wZXJ0eSA9IHRydWU7XG52YXIgSW5oZXJpdGVkQ3NzUHJvcGVydHkgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJbmhlcml0ZWRDc3NQcm9wZXJ0eSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBJbmhlcml0ZWRDc3NQcm9wZXJ0eShvcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSBvcHRpb25zLm5hbWU7XG4gICAgICAgIHZhciBrZXkgPSBfdGhpcy5rZXk7XG4gICAgICAgIHZhciBzb3VyY2VLZXkgPSBfdGhpcy5zb3VyY2VLZXk7XG4gICAgICAgIHZhciBnZXREZWZhdWx0ID0gX3RoaXMuZ2V0RGVmYXVsdDtcbiAgICAgICAgdmFyIHNldE5hdGl2ZSA9IF90aGlzLnNldE5hdGl2ZTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZUtleSA9IF90aGlzLmRlZmF1bHRWYWx1ZUtleTtcbiAgICAgICAgdmFyIGV2ZW50TmFtZSA9IHByb3BlcnR5TmFtZSArIFwiQ2hhbmdlXCI7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWUgPSBvcHRpb25zLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdmFyIGFmZmVjdHNMYXlvdXQgPSBvcHRpb25zLmFmZmVjdHNMYXlvdXQ7XG4gICAgICAgIHZhciBlcXVhbGl0eUNvbXBhcmVyID0gb3B0aW9ucy5lcXVhbGl0eUNvbXBhcmVyO1xuICAgICAgICB2YXIgdmFsdWVDaGFuZ2VkID0gb3B0aW9ucy52YWx1ZUNoYW5nZWQ7XG4gICAgICAgIHZhciB2YWx1ZUNvbnZlcnRlciA9IG9wdGlvbnMudmFsdWVDb252ZXJ0ZXI7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IF90aGlzO1xuICAgICAgICB2YXIgc2V0RnVuYyA9IGZ1bmN0aW9uICh2YWx1ZVNvdXJjZSkgeyByZXR1cm4gZnVuY3Rpb24gKGJveGVkVmFsdWUpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShib3hlZFZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZXNldCA9IGJveGVkVmFsdWUgPT09IGV4cG9ydHMudW5zZXRWYWx1ZSB8fCBib3hlZFZhbHVlID09PSBcIlwiO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZVNvdXJjZSA9IHRoaXNbc291cmNlS2V5XSB8fCAwO1xuICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlU291cmNlID09PSAyICYmIGN1cnJlbnRWYWx1ZVNvdXJjZSA9PT0gMykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZVNvdXJjZSA+IHZhbHVlU291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb2xkVmFsdWUgPSBrZXkgaW4gdGhpcyA/IHRoaXNba2V5XSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgIHZhciB1bnNldE5hdGl2ZVZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50XzIgPSB2aWV3LnBhcmVudDtcbiAgICAgICAgICAgICAgICB2YXIgc3R5bGUgPSBwYXJlbnRfMiA/IHBhcmVudF8yLnN0eWxlIDogbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoc3R5bGUgJiYgc3R5bGVbc291cmNlS2V5XSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBzdHlsZVtwcm9wZXJ0eU5hbWVdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzW3NvdXJjZUtleV0gPSAxO1xuICAgICAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tzb3VyY2VLZXldO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1trZXldO1xuICAgICAgICAgICAgICAgICAgICB1bnNldE5hdGl2ZVZhbHVlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzW3NvdXJjZUtleV0gPSB2YWx1ZVNvdXJjZTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVDb252ZXJ0ZXIgJiYgdHlwZW9mIGJveGVkVmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZUNvbnZlcnRlcihib3hlZFZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gYm94ZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY2hhbmdlZCA9IGVxdWFsaXR5Q29tcGFyZXIgPyAhZXF1YWxpdHlDb21wYXJlcihvbGRWYWx1ZSwgdmFsdWUpIDogb2xkVmFsdWUgIT09IHZhbHVlO1xuICAgICAgICAgICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodmlld1tzZXROYXRpdmVdKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVuc2V0TmF0aXZlVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKHRoaXNbZGVmYXVsdFZhbHVlS2V5XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2RlZmF1bHRWYWx1ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0oZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tkZWZhdWx0VmFsdWVLZXldID0gdmlld1tnZXREZWZhdWx0XSA/IHZpZXdbZ2V0RGVmYXVsdF0oKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNMaXN0ZW5lcnMoZXZlbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeSh7IG9iamVjdDogdGhpcywgZXZlbnROYW1lOiBldmVudE5hbWUsIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lLCB2YWx1ZTogdmFsdWUsIG9sZFZhbHVlOiBvbGRWYWx1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFmZmVjdHNMYXlvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZpZXcuZWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRTdHlsZSA9IGNoaWxkLnN0eWxlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRWYWx1ZVNvdXJjZSA9IGNoaWxkU3R5bGVbc291cmNlS2V5XSB8fCAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZFZhbHVlU291cmNlID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0RGVmYXVsdEZ1bmMuY2FsbChjaGlsZFN0eWxlLCBleHBvcnRzLnVuc2V0VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkVmFsdWVTb3VyY2UgPD0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEluaGVyaXRlZEZ1bmMuY2FsbChjaGlsZFN0eWxlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07IH07XG4gICAgICAgIHZhciBzZXREZWZhdWx0RnVuYyA9IHNldEZ1bmMoMCk7XG4gICAgICAgIHZhciBzZXRJbmhlcml0ZWRGdW5jID0gc2V0RnVuYygxKTtcbiAgICAgICAgX3RoaXMuc2V0SW5oZXJpdGVkVmFsdWUgPSBzZXRJbmhlcml0ZWRGdW5jO1xuICAgICAgICBfdGhpcy5jc3NWYWx1ZURlc2NyaXB0b3Iuc2V0ID0gc2V0RnVuYygyKTtcbiAgICAgICAgX3RoaXMubG9jYWxWYWx1ZURlc2NyaXB0b3Iuc2V0ID0gc2V0RnVuYygzKTtcbiAgICAgICAgaW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzLnB1c2goX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBJbmhlcml0ZWRDc3NQcm9wZXJ0eTtcbn0oQ3NzUHJvcGVydHkpKTtcbmV4cG9ydHMuSW5oZXJpdGVkQ3NzUHJvcGVydHkgPSBJbmhlcml0ZWRDc3NQcm9wZXJ0eTtcbnZhciBTaG9ydGhhbmRQcm9wZXJ0eSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2hvcnRoYW5kUHJvcGVydHkob3B0aW9ucykge1xuICAgICAgICB0aGlzLm5hbWUgPSBvcHRpb25zLm5hbWU7XG4gICAgICAgIHZhciBrZXkgPSBTeW1ib2wodGhpcy5uYW1lICsgXCI6cHJvcGVydHlLZXlcIik7XG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xuICAgICAgICB0aGlzLmNzc05hbWUgPSBcImNzczpcIiArIG9wdGlvbnMuY3NzTmFtZTtcbiAgICAgICAgdGhpcy5jc3NMb2NhbE5hbWUgPSBcIlwiICsgb3B0aW9ucy5jc3NOYW1lO1xuICAgICAgICB2YXIgY29udmVydGVyID0gb3B0aW9ucy5jb252ZXJ0ZXI7XG4gICAgICAgIGZ1bmN0aW9uIHNldExvY2FsVmFsdWUodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJzZXRMb2NhbFZhbHVlIG5vdCBleGVjdXRlZCB0byB2aWV3IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmlldy5fYmF0Y2hVcGRhdGUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBjb252ZXJ0ZXIodmFsdWUpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2IgPSBfYVtfaV0sIHAgPSBfYlswXSwgdiA9IF9iWzFdO1xuICAgICAgICAgICAgICAgICAgICBfdGhpc1twLm5hbWVdID0gdjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzZXRDc3NWYWx1ZSh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcInNldENzc1ZhbHVlIG5vdCBleGVjdXRlZCB0byB2aWV3IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmlldy5fYmF0Y2hVcGRhdGUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBjb252ZXJ0ZXIodmFsdWUpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2IgPSBfYVtfaV0sIHAgPSBfYlswXSwgdiA9IF9iWzFdO1xuICAgICAgICAgICAgICAgICAgICBfdGhpc1twLmNzc05hbWVdID0gdjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNzc1ZhbHVlRGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IG9wdGlvbnMuZ2V0dGVyLFxuICAgICAgICAgICAgc2V0OiBzZXRDc3NWYWx1ZVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmxvY2FsVmFsdWVEZXNjcmlwdG9yID0ge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogb3B0aW9ucy5nZXR0ZXIsXG4gICAgICAgICAgICBzZXQ6IHNldExvY2FsVmFsdWVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5wcm9wZXJ0eUJhZ0Rlc2NyaXB0b3IgPSB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgICAgICBjb252ZXJ0ZXIodmFsdWUpLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9wZXJ0eSA9IF9hWzBdLCB2YWx1ZSA9IF9hWzFdO1xuICAgICAgICAgICAgICAgICAgICBfdGhpc1twcm9wZXJ0eS5jc3NMb2NhbE5hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNzc1N5bWJvbFByb3BlcnR5TWFwW2tleV0gPSB0aGlzO1xuICAgIH1cbiAgICBTaG9ydGhhbmRQcm9wZXJ0eS5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiAoY2xzKSB7XG4gICAgICAgIGlmICh0aGlzLnJlZ2lzdGVyZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlByb3BlcnR5IFwiICsgdGhpcy5uYW1lICsgXCIgYWxyZWFkeSByZWdpc3RlcmVkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZ2lzdGVyZWQgPSB0cnVlO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgdGhpcy5uYW1lLCB0aGlzLmxvY2FsVmFsdWVEZXNjcmlwdG9yKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIHRoaXMuY3NzTmFtZSwgdGhpcy5jc3NWYWx1ZURlc2NyaXB0b3IpO1xuICAgICAgICBpZiAodGhpcy5jc3NMb2NhbE5hbWUgIT09IHRoaXMuY3NzTmFtZSkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIHRoaXMuY3NzTG9jYWxOYW1lLCB0aGlzLmxvY2FsVmFsdWVEZXNjcmlwdG9yKTtcbiAgICAgICAgfVxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZS5Qcm9wZXJ0eUJhZywgdGhpcy5jc3NMb2NhbE5hbWUsIHRoaXMucHJvcGVydHlCYWdEZXNjcmlwdG9yKTtcbiAgICB9O1xuICAgIHJldHVybiBTaG9ydGhhbmRQcm9wZXJ0eTtcbn0oKSk7XG5leHBvcnRzLlNob3J0aGFuZFByb3BlcnR5ID0gU2hvcnRoYW5kUHJvcGVydHk7XG5mdW5jdGlvbiBpbmhlcml0YWJsZVByb3BlcnR5VmFsdWVzT24odmlldykge1xuICAgIHZhciBhcnJheSA9IG5ldyBBcnJheSgpO1xuICAgIGZvciAodmFyIF9pID0gMCwgaW5oZXJpdGFibGVQcm9wZXJ0aWVzXzEgPSBpbmhlcml0YWJsZVByb3BlcnRpZXM7IF9pIDwgaW5oZXJpdGFibGVQcm9wZXJ0aWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBwcm9wID0gaW5oZXJpdGFibGVQcm9wZXJ0aWVzXzFbX2ldO1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gcHJvcC5zb3VyY2VLZXk7XG4gICAgICAgIHZhciB2YWx1ZVNvdXJjZSA9IHZpZXdbc291cmNlS2V5XSB8fCAwO1xuICAgICAgICBpZiAodmFsdWVTb3VyY2UgIT09IDApIHtcbiAgICAgICAgICAgIGFycmF5LnB1c2goeyBwcm9wZXJ0eTogcHJvcCwgdmFsdWU6IHZpZXdbcHJvcC5uYW1lXSB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXk7XG59XG5mdW5jdGlvbiBpbmhlcml0YWJsZUNzc1Byb3BlcnR5VmFsdWVzT24oc3R5bGUpIHtcbiAgICB2YXIgYXJyYXkgPSBuZXcgQXJyYXkoKTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGluaGVyaXRhYmxlQ3NzUHJvcGVydGllc18xID0gaW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzOyBfaSA8IGluaGVyaXRhYmxlQ3NzUHJvcGVydGllc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgcHJvcCA9IGluaGVyaXRhYmxlQ3NzUHJvcGVydGllc18xW19pXTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IHByb3Auc291cmNlS2V5O1xuICAgICAgICB2YXIgdmFsdWVTb3VyY2UgPSBzdHlsZVtzb3VyY2VLZXldIHx8IDA7XG4gICAgICAgIGlmICh2YWx1ZVNvdXJjZSAhPT0gMCkge1xuICAgICAgICAgICAgYXJyYXkucHVzaCh7IHByb3BlcnR5OiBwcm9wLCB2YWx1ZTogc3R5bGVbcHJvcC5uYW1lXSB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXk7XG59XG5leHBvcnRzLmluaXROYXRpdmVWaWV3ID0gcHJvZmlsaW5nXzEucHJvZmlsZShcIlxcXCJwcm9wZXJ0aWVzXFxcIi5pbml0TmF0aXZlVmlld1wiLCBmdW5jdGlvbiBpbml0TmF0aXZlVmlldyh2aWV3KSB7XG4gICAgaWYgKHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgYXBwbHlQZW5kaW5nTmF0aXZlU2V0dGVycyh2aWV3KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGFwcGx5QWxsTmF0aXZlU2V0dGVycyh2aWV3KTtcbiAgICB9XG4gICAgdmlldy5fc3VzcGVuZGVkVXBkYXRlcyA9IHt9O1xufSk7XG5mdW5jdGlvbiBhcHBseVBlbmRpbmdOYXRpdmVTZXR0ZXJzKHZpZXcpIHtcbiAgICB2YXIgc3VzcGVuZGVkVXBkYXRlcyA9IHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXM7XG4gICAgZm9yICh2YXIgcHJvcGVydHlOYW1lIGluIHN1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdO1xuICAgICAgICB2YXIgc2V0TmF0aXZlID0gcHJvcGVydHkuc2V0TmF0aXZlO1xuICAgICAgICBpZiAodmlld1tzZXROYXRpdmVdKSB7XG4gICAgICAgICAgICB2YXIgZ2V0RGVmYXVsdCA9IHByb3BlcnR5LmdldERlZmF1bHQsIGlzU3R5bGVQcm9wZXJ0eSA9IHByb3BlcnR5LmlzU3R5bGVQcm9wZXJ0eSwgZGVmYXVsdFZhbHVlS2V5ID0gcHJvcGVydHkuZGVmYXVsdFZhbHVlS2V5LCBkZWZhdWx0VmFsdWUgPSBwcm9wZXJ0eS5kZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB2b2lkIDA7XG4gICAgICAgICAgICBpZiAoaXNTdHlsZVByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0eWxlID0gdmlldy5zdHlsZTtcbiAgICAgICAgICAgICAgICBpZiAocHJvcGVydHkuaXNTZXQodmlldy5zdHlsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHN0eWxlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGVbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbZ2V0RGVmYXVsdF0gPyB2aWV3W2dldERlZmF1bHRdKCkgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2aWV3LnN0eWxlW3Byb3BlcnR5TmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHN0eWxlW2RlZmF1bHRWYWx1ZUtleV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5LmlzU2V0KHZpZXcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiB2aWV3KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tkZWZhdWx0VmFsdWVLZXldID0gdmlld1tnZXREZWZhdWx0XSA/IHZpZXdbZ2V0RGVmYXVsdF0oKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZpZXdbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmlld1tkZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLmFwcGx5UGVuZGluZ05hdGl2ZVNldHRlcnMgPSBhcHBseVBlbmRpbmdOYXRpdmVTZXR0ZXJzO1xuZnVuY3Rpb24gYXBwbHlBbGxOYXRpdmVTZXR0ZXJzKHZpZXcpIHtcbiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHModmlldyk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBzeW1ib2xzXzIgPSBzeW1ib2xzOyBfaSA8IHN5bWJvbHNfMi5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHN5bWJvbCA9IHN5bWJvbHNfMltfaV07XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IHN5bWJvbFByb3BlcnR5TWFwW3N5bWJvbF07XG4gICAgICAgIGlmICghcHJvcGVydHkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZXROYXRpdmUgPSBwcm9wZXJ0eS5zZXROYXRpdmU7XG4gICAgICAgIHZhciBnZXREZWZhdWx0ID0gcHJvcGVydHkuZ2V0RGVmYXVsdDtcbiAgICAgICAgaWYgKHNldE5hdGl2ZSBpbiB2aWV3KSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdFZhbHVlS2V5ID0gcHJvcGVydHkuZGVmYXVsdFZhbHVlS2V5O1xuICAgICAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHZpZXcpKSB7XG4gICAgICAgICAgICAgICAgdmlld1tkZWZhdWx0VmFsdWVLZXldID0gdmlld1tnZXREZWZhdWx0XSA/IHZpZXdbZ2V0RGVmYXVsdF0oKSA6IHByb3BlcnR5LmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHZpZXdbc3ltYm9sXTtcbiAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHN0eWxlID0gdmlldy5zdHlsZTtcbiAgICBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzdHlsZSk7XG4gICAgZm9yICh2YXIgX2EgPSAwLCBzeW1ib2xzXzMgPSBzeW1ib2xzOyBfYSA8IHN5bWJvbHNfMy5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgdmFyIHN5bWJvbCA9IHN5bWJvbHNfM1tfYV07XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IGNzc1N5bWJvbFByb3BlcnR5TWFwW3N5bWJvbF07XG4gICAgICAgIGlmICghcHJvcGVydHkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3W3Byb3BlcnR5LnNldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0VmFsdWVLZXkgPSBwcm9wZXJ0eS5kZWZhdWx0VmFsdWVLZXk7XG4gICAgICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gc3R5bGUpKSB7XG4gICAgICAgICAgICAgICAgc3R5bGVbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbcHJvcGVydHkuZ2V0RGVmYXVsdF0gPyB2aWV3W3Byb3BlcnR5LmdldERlZmF1bHRdKCkgOiBwcm9wZXJ0eS5kZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBzdHlsZVtzeW1ib2xdO1xuICAgICAgICAgICAgdmlld1twcm9wZXJ0eS5zZXROYXRpdmVdKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMuYXBwbHlBbGxOYXRpdmVTZXR0ZXJzID0gYXBwbHlBbGxOYXRpdmVTZXR0ZXJzO1xuZnVuY3Rpb24gcmVzZXROYXRpdmVWaWV3KHZpZXcpIHtcbiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHModmlldyk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBzeW1ib2xzXzQgPSBzeW1ib2xzOyBfaSA8IHN5bWJvbHNfNC5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHN5bWJvbCA9IHN5bWJvbHNfNFtfaV07XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IHN5bWJvbFByb3BlcnR5TWFwW3N5bWJvbF07XG4gICAgICAgIGlmICghcHJvcGVydHkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3W3Byb3BlcnR5LnNldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eS5kZWZhdWx0VmFsdWVLZXkgaW4gdmlldykge1xuICAgICAgICAgICAgICAgIHZpZXdbcHJvcGVydHkuc2V0TmF0aXZlXSh2aWV3W3Byb3BlcnR5LmRlZmF1bHRWYWx1ZUtleV0pO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB2aWV3W3Byb3BlcnR5LmRlZmF1bHRWYWx1ZUtleV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2aWV3W3Byb3BlcnR5LnNldE5hdGl2ZV0ocHJvcGVydHkuZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgc3R5bGUgPSB2aWV3LnN0eWxlO1xuICAgIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHN0eWxlKTtcbiAgICBmb3IgKHZhciBfYSA9IDAsIHN5bWJvbHNfNSA9IHN5bWJvbHM7IF9hIDwgc3ltYm9sc181Lmxlbmd0aDsgX2ErKykge1xuICAgICAgICB2YXIgc3ltYm9sID0gc3ltYm9sc181W19hXTtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gY3NzU3ltYm9sUHJvcGVydHlNYXBbc3ltYm9sXTtcbiAgICAgICAgaWYgKCFwcm9wZXJ0eSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXdbcHJvcGVydHkuc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgaWYgKHByb3BlcnR5LmRlZmF1bHRWYWx1ZUtleSBpbiBzdHlsZSkge1xuICAgICAgICAgICAgICAgIHZpZXdbcHJvcGVydHkuc2V0TmF0aXZlXShzdHlsZVtwcm9wZXJ0eS5kZWZhdWx0VmFsdWVLZXldKTtcbiAgICAgICAgICAgICAgICBkZWxldGUgc3R5bGVbcHJvcGVydHkuZGVmYXVsdFZhbHVlS2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZpZXdbcHJvcGVydHkuc2V0TmF0aXZlXShwcm9wZXJ0eS5kZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5yZXNldE5hdGl2ZVZpZXcgPSByZXNldE5hdGl2ZVZpZXc7XG5mdW5jdGlvbiBjbGVhckluaGVyaXRlZFByb3BlcnRpZXModmlldykge1xuICAgIGZvciAodmFyIF9pID0gMCwgaW5oZXJpdGFibGVQcm9wZXJ0aWVzXzIgPSBpbmhlcml0YWJsZVByb3BlcnRpZXM7IF9pIDwgaW5oZXJpdGFibGVQcm9wZXJ0aWVzXzIubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBwcm9wID0gaW5oZXJpdGFibGVQcm9wZXJ0aWVzXzJbX2ldO1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gcHJvcC5zb3VyY2VLZXk7XG4gICAgICAgIGlmICh2aWV3W3NvdXJjZUtleV0gPT09IDEpIHtcbiAgICAgICAgICAgIHByb3Auc2V0LmNhbGwodmlldywgZXhwb3J0cy51bnNldFZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgc3R5bGUgPSB2aWV3LnN0eWxlO1xuICAgIGZvciAodmFyIF9hID0gMCwgaW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzXzIgPSBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXM7IF9hIDwgaW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzXzIubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgIHZhciBwcm9wID0gaW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzXzJbX2FdO1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gcHJvcC5zb3VyY2VLZXk7XG4gICAgICAgIGlmIChzdHlsZVtzb3VyY2VLZXldID09PSAxKSB7XG4gICAgICAgICAgICBwcm9wLnNldEluaGVyaXRlZFZhbHVlLmNhbGwoc3R5bGUsIGV4cG9ydHMudW5zZXRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLmNsZWFySW5oZXJpdGVkUHJvcGVydGllcyA9IGNsZWFySW5oZXJpdGVkUHJvcGVydGllcztcbmZ1bmN0aW9uIHJlc2V0Q1NTUHJvcGVydGllcyhzdHlsZSkge1xuICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzdHlsZSk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBzeW1ib2xzXzYgPSBzeW1ib2xzOyBfaSA8IHN5bWJvbHNfNi5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHN5bWJvbCA9IHN5bWJvbHNfNltfaV07XG4gICAgICAgIHZhciBjc3NQcm9wZXJ0eSA9IHZvaWQgMDtcbiAgICAgICAgaWYgKGNzc1Byb3BlcnR5ID0gY3NzU3ltYm9sUHJvcGVydHlNYXBbc3ltYm9sXSkge1xuICAgICAgICAgICAgc3R5bGVbY3NzUHJvcGVydHkuY3NzTmFtZV0gPSBleHBvcnRzLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICBpZiAoY3NzUHJvcGVydHkgaW5zdGFuY2VvZiBDc3NBbmltYXRpb25Qcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgIHN0eWxlW2Nzc1Byb3BlcnR5LmtleWZyYW1lXSA9IGV4cG9ydHMudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMucmVzZXRDU1NQcm9wZXJ0aWVzID0gcmVzZXRDU1NQcm9wZXJ0aWVzO1xuZnVuY3Rpb24gcHJvcGFnYXRlSW5oZXJpdGFibGVQcm9wZXJ0aWVzKHZpZXcsIGNoaWxkKSB7XG4gICAgdmFyIGluaGVyaXRhYmxlUHJvcGVydHlWYWx1ZXMgPSBpbmhlcml0YWJsZVByb3BlcnR5VmFsdWVzT24odmlldyk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBpbmhlcml0YWJsZVByb3BlcnR5VmFsdWVzXzEgPSBpbmhlcml0YWJsZVByb3BlcnR5VmFsdWVzOyBfaSA8IGluaGVyaXRhYmxlUHJvcGVydHlWYWx1ZXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHBhaXIgPSBpbmhlcml0YWJsZVByb3BlcnR5VmFsdWVzXzFbX2ldO1xuICAgICAgICB2YXIgcHJvcCA9IHBhaXIucHJvcGVydHk7XG4gICAgICAgIHZhciBzb3VyY2VLZXkgPSBwcm9wLnNvdXJjZUtleTtcbiAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZVNvdXJjZSA9IGNoaWxkW3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZVNvdXJjZSA8PSAxKSB7XG4gICAgICAgICAgICBwcm9wLnNldEluaGVyaXRlZFZhbHVlLmNhbGwoY2hpbGQsIHBhaXIudmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5wcm9wYWdhdGVJbmhlcml0YWJsZVByb3BlcnRpZXMgPSBwcm9wYWdhdGVJbmhlcml0YWJsZVByb3BlcnRpZXM7XG5mdW5jdGlvbiBwcm9wYWdhdGVJbmhlcml0YWJsZUNzc1Byb3BlcnRpZXMocGFyZW50U3R5bGUsIGNoaWxkU3R5bGUpIHtcbiAgICB2YXIgaW5oZXJpdGFibGVDc3NQcm9wZXJ0eVZhbHVlcyA9IGluaGVyaXRhYmxlQ3NzUHJvcGVydHlWYWx1ZXNPbihwYXJlbnRTdHlsZSk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBpbmhlcml0YWJsZUNzc1Byb3BlcnR5VmFsdWVzXzEgPSBpbmhlcml0YWJsZUNzc1Byb3BlcnR5VmFsdWVzOyBfaSA8IGluaGVyaXRhYmxlQ3NzUHJvcGVydHlWYWx1ZXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHBhaXIgPSBpbmhlcml0YWJsZUNzc1Byb3BlcnR5VmFsdWVzXzFbX2ldO1xuICAgICAgICB2YXIgcHJvcCA9IHBhaXIucHJvcGVydHk7XG4gICAgICAgIHZhciBzb3VyY2VLZXkgPSBwcm9wLnNvdXJjZUtleTtcbiAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZVNvdXJjZSA9IGNoaWxkU3R5bGVbc291cmNlS2V5XSB8fCAwO1xuICAgICAgICBpZiAoY3VycmVudFZhbHVlU291cmNlIDw9IDEpIHtcbiAgICAgICAgICAgIHByb3Auc2V0SW5oZXJpdGVkVmFsdWUuY2FsbChjaGlsZFN0eWxlLCBwYWlyLnZhbHVlLCAxKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMucHJvcGFnYXRlSW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzID0gcHJvcGFnYXRlSW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzO1xuZnVuY3Rpb24gbWFrZVZhbGlkYXRvcigpIHtcbiAgICB2YXIgdmFsdWVzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFsdWVzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHZhciBzZXQgPSBuZXcgU2V0KHZhbHVlcyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gc2V0Lmhhcyh2YWx1ZSk7IH07XG59XG5leHBvcnRzLm1ha2VWYWxpZGF0b3IgPSBtYWtlVmFsaWRhdG9yO1xuZnVuY3Rpb24gbWFrZVBhcnNlcihpc1ZhbGlkKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbG93ZXIgPSB2YWx1ZSAmJiB2YWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAoaXNWYWxpZChsb3dlcikpIHtcbiAgICAgICAgICAgIHJldHVybiBsb3dlcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWU6IFwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbn1cbmV4cG9ydHMubWFrZVBhcnNlciA9IG1ha2VQYXJzZXI7XG5mdW5jdGlvbiBnZXRTZXRQcm9wZXJ0aWVzKHZpZXcpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModmlldykuZm9yRWFjaChmdW5jdGlvbiAocHJvcCkge1xuICAgICAgICByZXN1bHQucHVzaChbcHJvcCwgdmlld1twcm9wXV0pO1xuICAgIH0pO1xuICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyh2aWV3KTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIHN5bWJvbHNfNyA9IHN5bWJvbHM7IF9pIDwgc3ltYm9sc183Lmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgc3ltYm9sID0gc3ltYm9sc183W19pXTtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gc3ltYm9sUHJvcGVydHlNYXBbc3ltYm9sXTtcbiAgICAgICAgaWYgKCFwcm9wZXJ0eSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZhbHVlID0gdmlld1twcm9wZXJ0eS5rZXldO1xuICAgICAgICByZXN1bHQucHVzaChbcHJvcGVydHkubmFtZSwgdmFsdWVdKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuZ2V0U2V0UHJvcGVydGllcyA9IGdldFNldFByb3BlcnRpZXM7XG5mdW5jdGlvbiBnZXRDb21wdXRlZENzc1ZhbHVlcyh2aWV3KSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIHZhciBzdHlsZSA9IHZpZXcuc3R5bGU7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBjc3NQcm9wZXJ0eU5hbWVzXzEgPSBjc3NQcm9wZXJ0eU5hbWVzOyBfaSA8IGNzc1Byb3BlcnR5TmFtZXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHByb3AgPSBjc3NQcm9wZXJ0eU5hbWVzXzFbX2ldO1xuICAgICAgICByZXN1bHQucHVzaChbcHJvcCwgc3R5bGVbcHJvcF1dKTtcbiAgICB9XG4gICAgcmVzdWx0LnB1c2goW1widG9wXCIsIFwiYXV0b1wiXSk7XG4gICAgcmVzdWx0LnB1c2goW1wibGVmdFwiLCBcImF1dG9cIl0pO1xuICAgIHJlc3VsdC5wdXNoKFtcImJvdHRvbVwiLCBcImF1dG9cIl0pO1xuICAgIHJlc3VsdC5wdXNoKFtcInJpZ2h0XCIsIFwiYXV0b1wiXSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuZ2V0Q29tcHV0ZWRDc3NWYWx1ZXMgPSBnZXRDb21wdXRlZENzc1ZhbHVlcztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByb3BlcnRpZXMuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vcHJvcGVydGllc1wiKTtcbnZhciBzeXN0ZW1fY2xhc3Nlc18xID0gcmVxdWlyZShcIi4uLy4uLy4uL2Nzcy9zeXN0ZW0tY2xhc3Nlc1wiKTtcbnZhciBkZWJ1Z18xID0gcmVxdWlyZShcIi4uLy4uLy4uL3V0aWxzL2RlYnVnXCIpO1xudmFyIGJpbmRhYmxlXzEgPSByZXF1aXJlKFwiLi4vYmluZGFibGVcIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9wbGF0Zm9ybVwiKTtcbmV4cG9ydHMuaXNJT1MgPSBwbGF0Zm9ybV8xLmlzSU9TO1xuZXhwb3J0cy5pc0FuZHJvaWQgPSBwbGF0Zm9ybV8xLmlzQW5kcm9pZDtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uLy4uLy4uL3V0aWxzL3V0aWxzXCIpO1xuZXhwb3J0cy5sYXlvdXQgPSB1dGlsc18xLmxheW91dDtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIHR5cGVzID0gcmVxdWlyZShcIi4uLy4uLy4uL3V0aWxzL3R5cGVzXCIpO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vY29sb3JcIik7XG5leHBvcnRzLkNvbG9yID0gY29sb3JfMS5Db2xvcjtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9wcm9maWxpbmdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vYmluZGFibGVcIikpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL3Byb3BlcnRpZXNcIikpO1xudmFyIHNzbSA9IHJlcXVpcmUoXCIuLi8uLi9zdHlsaW5nL3N0eWxlLXNjb3BlXCIpO1xudmFyIGRvbU5vZGVNb2R1bGU7XG5mdW5jdGlvbiBlbnN1cmVkb21Ob2RlTW9kdWxlKCkge1xuICAgIGlmICghZG9tTm9kZU1vZHVsZSkge1xuICAgICAgICBkb21Ob2RlTW9kdWxlID0gcmVxdWlyZShcIi4uLy4uLy4uL2RlYnVnZ2VyL2RvbS1ub2RlXCIpO1xuICAgIH1cbn1cbnZhciBzdHlsZVNjb3BlTW9kdWxlO1xuZnVuY3Rpb24gZW5zdXJlU3R5bGVTY29wZU1vZHVsZSgpIHtcbiAgICBpZiAoIXN0eWxlU2NvcGVNb2R1bGUpIHtcbiAgICAgICAgc3R5bGVTY29wZU1vZHVsZSA9IHJlcXVpcmUoXCIuLi8uLi9zdHlsaW5nL3N0eWxlLXNjb3BlXCIpO1xuICAgIH1cbn1cbnZhciBkZWZhdWx0QmluZGluZ1NvdXJjZSA9IHt9O1xuZnVuY3Rpb24gZ2V0QW5jZXN0b3IodmlldywgY3JpdGVyaW9uKSB7XG4gICAgdmFyIG1hdGNoZXIgPSBudWxsO1xuICAgIGlmICh0eXBlb2YgY3JpdGVyaW9uID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIG1hdGNoZXIgPSBmdW5jdGlvbiAodmlldykgeyByZXR1cm4gdmlldy50eXBlTmFtZSA9PT0gY3JpdGVyaW9uOyB9O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbWF0Y2hlciA9IGZ1bmN0aW9uICh2aWV3KSB7IHJldHVybiB2aWV3IGluc3RhbmNlb2YgY3JpdGVyaW9uOyB9O1xuICAgIH1cbiAgICBmb3IgKHZhciBwYXJlbnRfMSA9IHZpZXcucGFyZW50OyBwYXJlbnRfMSAhPSBudWxsOyBwYXJlbnRfMSA9IHBhcmVudF8xLnBhcmVudCkge1xuICAgICAgICBpZiAobWF0Y2hlcihwYXJlbnRfMSkpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJlbnRfMTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydHMuZ2V0QW5jZXN0b3IgPSBnZXRBbmNlc3RvcjtcbmZ1bmN0aW9uIGdldFZpZXdCeUlkKHZpZXcsIGlkKSB7XG4gICAgaWYgKCF2aWV3KSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGlmICh2aWV3LmlkID09PSBpZCkge1xuICAgICAgICByZXR1cm4gdmlldztcbiAgICB9XG4gICAgdmFyIHJldFZhbDtcbiAgICB2YXIgZGVzY2VuZGFudHNDYWxsYmFjayA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICBpZiAoY2hpbGQuaWQgPT09IGlkKSB7XG4gICAgICAgICAgICByZXRWYWwgPSBjaGlsZDtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIGVhY2hEZXNjZW5kYW50KHZpZXcsIGRlc2NlbmRhbnRzQ2FsbGJhY2spO1xuICAgIHJldHVybiByZXRWYWw7XG59XG5leHBvcnRzLmdldFZpZXdCeUlkID0gZ2V0Vmlld0J5SWQ7XG5mdW5jdGlvbiBlYWNoRGVzY2VuZGFudCh2aWV3LCBjYWxsYmFjaykge1xuICAgIGlmICghY2FsbGJhY2sgfHwgIXZpZXcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgY29udGludWVJdGVyYXRpb247XG4gICAgdmFyIGxvY2FsQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgY29udGludWVJdGVyYXRpb24gPSBjYWxsYmFjayhjaGlsZCk7XG4gICAgICAgIGlmIChjb250aW51ZUl0ZXJhdGlvbikge1xuICAgICAgICAgICAgY2hpbGQuZWFjaENoaWxkKGxvY2FsQ2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb250aW51ZUl0ZXJhdGlvbjtcbiAgICB9O1xuICAgIHZpZXcuZWFjaENoaWxkKGxvY2FsQ2FsbGJhY2spO1xufVxuZXhwb3J0cy5lYWNoRGVzY2VuZGFudCA9IGVhY2hEZXNjZW5kYW50O1xudmFyIHZpZXdJZENvdW50ZXIgPSAxO1xudmFyIEZsYWdzO1xuKGZ1bmN0aW9uIChGbGFncykge1xuICAgIEZsYWdzW1wic3VwZXJPbkxvYWRlZENhbGxlZFwiXSA9IFwiTG9hZGVkXCI7XG4gICAgRmxhZ3NbXCJzdXBlck9uVW5sb2FkZWRDYWxsZWRcIl0gPSBcIlVubG9hZGVkXCI7XG59KShGbGFncyB8fCAoRmxhZ3MgPSB7fSkpO1xudmFyIFN1c3BlbmRUeXBlO1xuKGZ1bmN0aW9uIChTdXNwZW5kVHlwZSkge1xuICAgIFN1c3BlbmRUeXBlW1N1c3BlbmRUeXBlW1wiSW5jcmVtZW50YWxcIl0gPSAwXSA9IFwiSW5jcmVtZW50YWxcIjtcbiAgICBTdXNwZW5kVHlwZVtTdXNwZW5kVHlwZVtcIkxvYWRlZFwiXSA9IDEwNDg1NzZdID0gXCJMb2FkZWRcIjtcbiAgICBTdXNwZW5kVHlwZVtTdXNwZW5kVHlwZVtcIk5hdGl2ZVZpZXdcIl0gPSAyMDk3MTUyXSA9IFwiTmF0aXZlVmlld1wiO1xuICAgIFN1c3BlbmRUeXBlW1N1c3BlbmRUeXBlW1wiVUlTZXR1cFwiXSA9IDQxOTQzMDRdID0gXCJVSVNldHVwXCI7XG4gICAgU3VzcGVuZFR5cGVbU3VzcGVuZFR5cGVbXCJJbmNyZW1lbnRhbENvdW50TWFza1wiXSA9IC03MzQwMDMzXSA9IFwiSW5jcmVtZW50YWxDb3VudE1hc2tcIjtcbn0pKFN1c3BlbmRUeXBlIHx8IChTdXNwZW5kVHlwZSA9IHt9KSk7XG4oZnVuY3Rpb24gKFN1c3BlbmRUeXBlKSB7XG4gICAgZnVuY3Rpb24gdG9TdHJpbmcodHlwZSkge1xuICAgICAgICByZXR1cm4gKHR5cGUgPyBcInN1c3BlbmRlZFwiIDogXCJyZXN1bWVkXCIpICsgXCIoXCIgK1xuICAgICAgICAgICAgXCJJbmNyZW1lbnRhbDogXCIgKyAodHlwZSAmIFN1c3BlbmRUeXBlLkluY3JlbWVudGFsQ291bnRNYXNrKSArIFwiLCBcIiArXG4gICAgICAgICAgICBcIkxvYWRlZDogXCIgKyAhKHR5cGUgJiBTdXNwZW5kVHlwZS5Mb2FkZWQpICsgXCIsIFwiICtcbiAgICAgICAgICAgIFwiTmF0aXZlVmlldzogXCIgKyAhKHR5cGUgJiBTdXNwZW5kVHlwZS5OYXRpdmVWaWV3KSArIFwiLCBcIiArXG4gICAgICAgICAgICBcIlVJU2V0dXA6IFwiICsgISh0eXBlICYgU3VzcGVuZFR5cGUuVUlTZXR1cCkgK1xuICAgICAgICAgICAgXCIpXCI7XG4gICAgfVxuICAgIFN1c3BlbmRUeXBlLnRvU3RyaW5nID0gdG9TdHJpbmc7XG59KShTdXNwZW5kVHlwZSB8fCAoU3VzcGVuZFR5cGUgPSB7fSkpO1xudmFyIFZpZXdCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVmlld0Jhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVmlld0Jhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9vbkxvYWRlZENhbGxlZCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5fb25VbmxvYWRlZENhbGxlZCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5fY3NzU3RhdGUgPSBuZXcgc3NtLkNzc1N0YXRlKG5ldyBXZWFrUmVmKF90aGlzKSk7XG4gICAgICAgIF90aGlzLnBzZXVkb0NsYXNzQWxpYXNlcyA9IHtcbiAgICAgICAgICAgIFwiaGlnaGxpZ2h0ZWRcIjogW1xuICAgICAgICAgICAgICAgIFwiYWN0aXZlXCIsXG4gICAgICAgICAgICAgICAgXCJwcmVzc2VkXCJcbiAgICAgICAgICAgIF1cbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuY3NzQ2xhc3NlcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgX3RoaXMuY3NzUHNldWRvQ2xhc3NlcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgX3RoaXMuX2RvbUlkID0gdmlld0lkQ291bnRlcisrO1xuICAgICAgICBfdGhpcy5fc3R5bGUgPSBuZXcgcHJvcGVydGllc18xLlN0eWxlKG5ldyBXZWFrUmVmKF90aGlzKSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdCYXNlLnByb3RvdHlwZSwgXCJwYXJlbnROb2RlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGVtcGxhdGVQYXJlbnQgfHwgdGhpcy5wYXJlbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3RlbXBsYXRlUGFyZW50ID0gbm9kZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdCYXNlLnByb3RvdHlwZSwgXCJuYXRpdmVWaWV3XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zZXROYXRpdmVWaWV3KHZhbHVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdCYXNlLnByb3RvdHlwZSwgXCJ0eXBlTmFtZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHR5cGVzLmdldENsYXNzKHRoaXMpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0Jhc2UucHJvdG90eXBlLCBcInN0eWxlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3R5bGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGlubGluZVN0eWxlKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGlubGluZVN0eWxlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRJbmxpbmVTdHlsZShpbmxpbmVTdHlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWaWV3LnN0eWxlIHByb3BlcnR5IGlzIHJlYWQtb25seS5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwiYW5kcm9pZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FuZHJvaWRWaWV3O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0Jhc2UucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lvc1ZpZXc7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwiaXNMb2FkZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc0xvYWRlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdCYXNlLnByb3RvdHlwZSwgXCJjbGFzc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xhc3NOYW1lO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICB0aGlzLmNsYXNzTmFtZSA9IHY7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5nZXRWaWV3QnlJZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICByZXR1cm4gZ2V0Vmlld0J5SWQodGhpcywgaWQpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdCYXNlLnByb3RvdHlwZSwgXCJwYWdlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQucGFnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuZW5zdXJlRG9tTm9kZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRvbU5vZGUpIHtcbiAgICAgICAgICAgIGVuc3VyZWRvbU5vZGVNb2R1bGUoKTtcbiAgICAgICAgICAgIHRoaXMuZG9tTm9kZSA9IG5ldyBkb21Ob2RlTW9kdWxlLkRPTU5vZGUodGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdGhpc1tuYW1lXSA9IGJpbmRhYmxlXzEuV3JhcHBlZFZhbHVlLnVud3JhcCh2YWx1ZSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc2V0RmxhZyhGbGFncy5zdXBlck9uTG9hZGVkQ2FsbGVkLCB0cnVlKTtcbiAgICAgICAgaWYgKHRoaXMuX2lzTG9hZGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faXNMb2FkZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLl9jc3NTdGF0ZS5vbkxvYWRlZCgpO1xuICAgICAgICB0aGlzLl9yZXN1bWVOYXRpdmVVcGRhdGVzKFN1c3BlbmRUeXBlLkxvYWRlZCk7XG4gICAgICAgIHRoaXMuZWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgX3RoaXMubG9hZFZpZXcoY2hpbGQpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9lbWl0KFwibG9hZGVkXCIpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLm9uVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc2V0RmxhZyhGbGFncy5zdXBlck9uVW5sb2FkZWRDYWxsZWQsIHRydWUpO1xuICAgICAgICBpZiAoIXRoaXMuX2lzTG9hZGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXMoU3VzcGVuZFR5cGUuTG9hZGVkKTtcbiAgICAgICAgdGhpcy5lYWNoQ2hpbGQoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICBfdGhpcy51bmxvYWRWaWV3KGNoaWxkKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5faXNMb2FkZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY3NzU3RhdGUub25VbmxvYWRlZCgpO1xuICAgICAgICB0aGlzLl9lbWl0KFwidW5sb2FkZWRcIik7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX3N1c3BlbmROYXRpdmVVcGRhdGVzID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQgPSB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50IHwgdHlwZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQrKztcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9yZXN1bWVOYXRpdmVVcGRhdGVzID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQgPSB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50ICYgfnR5cGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoKHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQgJiBTdXNwZW5kVHlwZS5JbmNyZW1lbnRhbENvdW50TWFzaykgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGNhbGwgdG8gXCIgKyB0aGlzICsgXCIuX3Jlc3VtZU5hdGl2ZVVwZGF0ZXNcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50LS07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICB0aGlzLm9uUmVzdW1lTmF0aXZlVXBkYXRlcygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX2JhdGNoVXBkYXRlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlcyhTdXNwZW5kVHlwZS5JbmNyZW1lbnRhbCk7XG4gICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc3VtZU5hdGl2ZVVwZGF0ZXMoU3VzcGVuZFR5cGUuSW5jcmVtZW50YWwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuc2V0RmxhZyA9IGZ1bmN0aW9uIChmbGFnLCB2YWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKGZsYWcpIHtcbiAgICAgICAgICAgIGNhc2UgRmxhZ3Muc3VwZXJPbkxvYWRlZENhbGxlZDpcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkxvYWRlZENhbGxlZCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBGbGFncy5zdXBlck9uVW5sb2FkZWRDYWxsZWQ6XG4gICAgICAgICAgICAgICAgdGhpcy5fb25VbmxvYWRlZENhbGxlZCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuaXNGbGFnU2V0ID0gZnVuY3Rpb24gKGZsYWcpIHtcbiAgICAgICAgc3dpdGNoIChmbGFnKSB7XG4gICAgICAgICAgICBjYXNlIEZsYWdzLnN1cGVyT25Mb2FkZWRDYWxsZWQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uTG9hZGVkQ2FsbGVkO1xuICAgICAgICAgICAgY2FzZSBGbGFncy5zdXBlck9uVW5sb2FkZWRDYWxsZWQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uVW5sb2FkZWRDYWxsZWQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5jYWxsRnVuY3Rpb25XaXRoU3VwZXIgPSBmdW5jdGlvbiAoZmxhZywgZnVuYykge1xuICAgICAgICB0aGlzLnNldEZsYWcoZmxhZywgZmFsc2UpO1xuICAgICAgICBmdW5jKCk7XG4gICAgICAgIGlmICghdGhpcy5pc0ZsYWdTZXQoZmxhZykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInN1cGVyLlwiICsgZmxhZyArIFwiIG5vdCBjYWxsZWQgaW4gXCIgKyB0aGlzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmNhbGxMb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuY2FsbEZ1bmN0aW9uV2l0aFN1cGVyKEZsYWdzLnN1cGVyT25Mb2FkZWRDYWxsZWQsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLm9uTG9hZGVkKCk7IH0pO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmNhbGxVbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5jYWxsRnVuY3Rpb25XaXRoU3VwZXIoRmxhZ3Muc3VwZXJPblVubG9hZGVkQ2FsbGVkLCBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5vblVubG9hZGVkKCk7IH0pO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLm5vdGlmeVBzZXVkb0NsYXNzQ2hhbmdlZCA9IGZ1bmN0aW9uIChwc2V1ZG9DbGFzcykge1xuICAgICAgICB0aGlzLm5vdGlmeSh7IGV2ZW50TmFtZTogXCI6XCIgKyBwc2V1ZG9DbGFzcywgb2JqZWN0OiB0aGlzIH0pO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmdldEFsbEFsaWFzZWRTdGF0ZXMgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgYWxsU3RhdGVzID0gW107XG4gICAgICAgIGFsbFN0YXRlcy5wdXNoKG5hbWUpO1xuICAgICAgICBpZiAobmFtZSBpbiB0aGlzLnBzZXVkb0NsYXNzQWxpYXNlcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBzZXVkb0NsYXNzQWxpYXNlc1tuYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGFsbFN0YXRlcy5wdXNoKHRoaXMucHNldWRvQ2xhc3NBbGlhc2VzW25hbWVdW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWxsU3RhdGVzO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmFkZFBzZXVkb0NsYXNzID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIGFsbFN0YXRlcyA9IHRoaXMuZ2V0QWxsQWxpYXNlZFN0YXRlcyhuYW1lKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbGxTdGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5jc3NQc2V1ZG9DbGFzc2VzLmhhcyhhbGxTdGF0ZXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jc3NQc2V1ZG9DbGFzc2VzLmFkZChhbGxTdGF0ZXNbaV0pO1xuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5UHNldWRvQ2xhc3NDaGFuZ2VkKGFsbFN0YXRlc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5kZWxldGVQc2V1ZG9DbGFzcyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBhbGxTdGF0ZXMgPSB0aGlzLmdldEFsbEFsaWFzZWRTdGF0ZXMobmFtZSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYWxsU3RhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jc3NQc2V1ZG9DbGFzc2VzLmhhcyhhbGxTdGF0ZXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jc3NQc2V1ZG9DbGFzc2VzLmRlbGV0ZShhbGxTdGF0ZXNbaV0pO1xuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5UHNldWRvQ2xhc3NDaGFuZ2VkKGFsbFN0YXRlc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5iaW5kaW5nQ29udGV4dENoYW5nZWQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0aGlzLmJpbmRpbmdzLmdldChcImJpbmRpbmdDb250ZXh0XCIpLmJpbmQoZGF0YS52YWx1ZSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChvcHRpb25zLCBzb3VyY2UpIHtcbiAgICAgICAgaWYgKHNvdXJjZSA9PT0gdm9pZCAwKSB7IHNvdXJjZSA9IGRlZmF1bHRCaW5kaW5nU291cmNlOyB9XG4gICAgICAgIHZhciB0YXJnZXRQcm9wZXJ0eSA9IG9wdGlvbnMudGFyZ2V0UHJvcGVydHk7XG4gICAgICAgIHRoaXMudW5iaW5kKHRhcmdldFByb3BlcnR5KTtcbiAgICAgICAgaWYgKCF0aGlzLmJpbmRpbmdzKSB7XG4gICAgICAgICAgICB0aGlzLmJpbmRpbmdzID0gbmV3IE1hcCgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiaW5kaW5nID0gbmV3IGJpbmRhYmxlXzEuQmluZGluZyh0aGlzLCBvcHRpb25zKTtcbiAgICAgICAgdGhpcy5iaW5kaW5ncy5zZXQodGFyZ2V0UHJvcGVydHksIGJpbmRpbmcpO1xuICAgICAgICB2YXIgYmluZGluZ1NvdXJjZSA9IHNvdXJjZTtcbiAgICAgICAgaWYgKGJpbmRpbmdTb3VyY2UgPT09IGRlZmF1bHRCaW5kaW5nU291cmNlKSB7XG4gICAgICAgICAgICBiaW5kaW5nU291cmNlID0gdGhpcy5iaW5kaW5nQ29udGV4dDtcbiAgICAgICAgICAgIGJpbmRpbmcuc291cmNlSXNCaW5kaW5nQ29udGV4dCA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGFyZ2V0UHJvcGVydHkgPT09IFwiYmluZGluZ0NvbnRleHRcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuYmluZGluZ0NvbnRleHRCb3VuZFRvUGFyZW50QmluZGluZ0NvbnRleHRDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50XzIgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50XzIpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50XzIub24oXCJiaW5kaW5nQ29udGV4dENoYW5nZVwiLCB0aGlzLmJpbmRpbmdDb250ZXh0Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3VsZEFkZEhhbmRsZXJUb1BhcmVudEJpbmRpbmdDb250ZXh0Q2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJpbmRpbmcuYmluZChiaW5kaW5nU291cmNlKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAocHJvcGVydHkpIHtcbiAgICAgICAgdmFyIGJpbmRpbmdzID0gdGhpcy5iaW5kaW5ncztcbiAgICAgICAgaWYgKCFiaW5kaW5ncykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiaW5kaW5nID0gYmluZGluZ3MuZ2V0KHByb3BlcnR5KTtcbiAgICAgICAgaWYgKGJpbmRpbmcpIHtcbiAgICAgICAgICAgIGJpbmRpbmcudW5iaW5kKCk7XG4gICAgICAgICAgICBiaW5kaW5ncy5kZWxldGUocHJvcGVydHkpO1xuICAgICAgICAgICAgaWYgKGJpbmRpbmcuc291cmNlSXNCaW5kaW5nQ29udGV4dCkge1xuICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eSA9PT0gXCJiaW5kaW5nQ29udGV4dFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdWxkQWRkSGFuZGxlclRvUGFyZW50QmluZGluZ0NvbnRleHRDaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmluZGluZ0NvbnRleHRCb3VuZFRvUGFyZW50QmluZGluZ0NvbnRleHRDaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRfMyA9IHRoaXMucGFyZW50O1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50XzMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudF8zLm9mZihcImJpbmRpbmdDb250ZXh0Q2hhbmdlXCIsIHRoaXMuYmluZGluZ0NvbnRleHRDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnJlcXVlc3RMYXlvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgICAgcGFyZW50LnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmVhY2hDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9hZGRWaWV3ID0gZnVuY3Rpb24gKHZpZXcsIGF0SW5kZXgpIHtcbiAgICAgICAgaWYgKGJpbmRhYmxlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGJpbmRhYmxlXzEudHJhY2VXcml0ZSh0aGlzICsgXCIuX2FkZFZpZXcoXCIgKyB2aWV3ICsgXCIsIFwiICsgYXRJbmRleCArIFwiKVwiLCBiaW5kYWJsZV8xLnRyYWNlQ2F0ZWdvcmllcy5WaWV3SGllcmFyY2h5KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV4cGVjdGluZyBhIHZhbGlkIFZpZXcgaW5zdGFuY2UuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghKHZpZXcgaW5zdGFuY2VvZiBWaWV3QmFzZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcih2aWV3ICsgXCIgaXMgbm90IGEgdmFsaWQgVmlldyBpbnN0YW5jZS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXcucGFyZW50KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWaWV3IGFscmVhZHkgaGFzIGEgcGFyZW50LiBWaWV3OiBcIiArIHZpZXcgKyBcIiBQYXJlbnQ6IFwiICsgdmlldy5wYXJlbnQpO1xuICAgICAgICB9XG4gICAgICAgIHZpZXcucGFyZW50ID0gdGhpcztcbiAgICAgICAgdGhpcy5fYWRkVmlld0NvcmUodmlldywgYXRJbmRleCk7XG4gICAgICAgIHZpZXcuX3BhcmVudENoYW5nZWQobnVsbCk7XG4gICAgICAgIGlmICh0aGlzLmRvbU5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuZG9tTm9kZS5vbkNoaWxkQWRkZWQodmlldyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fYWRkVmlld0NvcmUgPSBmdW5jdGlvbiAodmlldywgYXRJbmRleCkge1xuICAgICAgICBwcm9wZXJ0aWVzXzEucHJvcGFnYXRlSW5oZXJpdGFibGVQcm9wZXJ0aWVzKHRoaXMsIHZpZXcpO1xuICAgICAgICB2aWV3Ll9pbmhlcml0U3R5bGVTY29wZSh0aGlzLl9zdHlsZVNjb3BlKTtcbiAgICAgICAgcHJvcGVydGllc18xLnByb3BhZ2F0ZUluaGVyaXRhYmxlQ3NzUHJvcGVydGllcyh0aGlzLnN0eWxlLCB2aWV3LnN0eWxlKTtcbiAgICAgICAgaWYgKHRoaXMuX2NvbnRleHQpIHtcbiAgICAgICAgICAgIHZpZXcuX3NldHVwVUkodGhpcy5fY29udGV4dCwgYXRJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2lzTG9hZGVkKSB7XG4gICAgICAgICAgICB0aGlzLmxvYWRWaWV3KHZpZXcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUubG9hZFZpZXcgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICBpZiAodmlldyAmJiAhdmlldy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgdmlldy5jYWxsTG9hZGVkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS51bmxvYWRWaWV3ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgaWYgKHZpZXcgJiYgdmlldy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgdmlldy5jYWxsVW5sb2FkZWQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9yZW1vdmVWaWV3ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgaWYgKGJpbmRhYmxlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGJpbmRhYmxlXzEudHJhY2VXcml0ZSh0aGlzICsgXCIuX3JlbW92ZVZpZXcoXCIgKyB2aWV3ICsgXCIpXCIsIGJpbmRhYmxlXzEudHJhY2VDYXRlZ29yaWVzLlZpZXdIaWVyYXJjaHkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3LnBhcmVudCAhPT0gdGhpcykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmlldyBub3QgYWRkZWQgdG8gdGhpcyBpbnN0YW5jZS4gVmlldzogXCIgKyB2aWV3ICsgXCIgQ3VycmVudFBhcmVudDogXCIgKyB2aWV3LnBhcmVudCArIFwiIEV4cGVjdGVkUGFyZW50OiBcIiArIHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmRvbU5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuZG9tTm9kZS5vbkNoaWxkUmVtb3ZlZCh2aWV3KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yZW1vdmVWaWV3Q29yZSh2aWV3KTtcbiAgICAgICAgdmlldy5wYXJlbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHZpZXcuX3BhcmVudENoYW5nZWQodGhpcyk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX3JlbW92ZVZpZXdDb3JlID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdGhpcy51bmxvYWRWaWV3KHZpZXcpO1xuICAgICAgICBpZiAodmlldy5fY29udGV4dCkge1xuICAgICAgICAgICAgdmlldy5fdGVhckRvd25VSSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3SW50ZXJuYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX3NldHVwQXNSb290VmlldyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgIHRoaXMuX3NldHVwVUkoY29udGV4dCk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX3NldHVwVUkgPSBmdW5jdGlvbiAoY29udGV4dCwgYXRJbmRleCwgcGFyZW50SXNMb2FkZWQpIHtcbiAgICAgICAgaWYgKHRoaXMuX2NvbnRleHQgPT09IGNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9jb250ZXh0KSB7XG4gICAgICAgICAgICB0aGlzLl90ZWFyRG93blVJKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKCFuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3ID0gdGhpcy5jcmVhdGVOYXRpdmVWaWV3KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuaXNBbmRyb2lkKSB7XG4gICAgICAgICAgICB0aGlzLl9hbmRyb2lkVmlldyA9IG5hdGl2ZVZpZXc7XG4gICAgICAgICAgICBpZiAobmF0aXZlVmlldykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc1BhZGRpbmdSZWxhdGl2ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2lzUGFkZGluZ1JlbGF0aXZlID0gbmF0aXZlVmlldy5pc1BhZGRpbmdSZWxhdGl2ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gbmF0aXZlVmlldy5kZWZhdWx0UGFkZGluZ3M7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLmdldFBhZGRpbmcobmF0aXZlVmlldyk7XG4gICAgICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuZGVmYXVsdFBhZGRpbmdzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9kZWZhdWx0UGFkZGluZ1RvcCA9IHJlc3VsdC50b3A7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVmYXVsdFBhZGRpbmdSaWdodCA9IHJlc3VsdC5yaWdodDtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZWZhdWx0UGFkZGluZ0JvdHRvbSA9IHJlc3VsdC5ib3R0b207XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVmYXVsdFBhZGRpbmdMZWZ0ID0gcmVzdWx0LmxlZnQ7XG4gICAgICAgICAgICAgICAgdmFyIHN0eWxlID0gdGhpcy5zdHlsZTtcbiAgICAgICAgICAgICAgICBpZiAoIXN0eWxlX3Byb3BlcnRpZXNfMS5wYWRkaW5nVG9wUHJvcGVydHkuaXNTZXQoc3R5bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1RvcCA9IHRoaXMuX2RlZmF1bHRQYWRkaW5nVG9wO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXN0eWxlX3Byb3BlcnRpZXNfMS5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5pc1NldChzdHlsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQgPSB0aGlzLl9kZWZhdWx0UGFkZGluZ1JpZ2h0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXN0eWxlX3Byb3BlcnRpZXNfMS5wYWRkaW5nQm90dG9tUHJvcGVydHkuaXNTZXQoc3R5bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSA9IHRoaXMuX2RlZmF1bHRQYWRkaW5nQm90dG9tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXN0eWxlX3Byb3BlcnRpZXNfMS5wYWRkaW5nTGVmdFByb3BlcnR5LmlzU2V0KHN0eWxlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdMZWZ0ID0gdGhpcy5fZGVmYXVsdFBhZGRpbmdMZWZ0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2lvc1ZpZXcgPSBuYXRpdmVWaWV3O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0TmF0aXZlVmlldyhuYXRpdmVWaWV3KTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlSW5kZXggPSB0aGlzLnBhcmVudC5fY2hpbGRJbmRleFRvTmF0aXZlQ2hpbGRJbmRleChhdEluZGV4KTtcbiAgICAgICAgICAgIHRoaXMuX2lzQWRkZWRUb05hdGl2ZVZpc3VhbFRyZWUgPSB0aGlzLnBhcmVudC5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZSh0aGlzLCBuYXRpdmVJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcmVzdW1lTmF0aXZlVXBkYXRlcyhTdXNwZW5kVHlwZS5VSVNldHVwKTtcbiAgICAgICAgdGhpcy5lYWNoQ2hpbGQoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICBjaGlsZC5fc2V0dXBVSShjb250ZXh0KTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5zZXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLl9fbmF0aXZlVmlldyA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fX25hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzKFN1c3BlbmRUeXBlLk5hdGl2ZVZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX19uYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkID0gdmFsdWU7XG4gICAgICAgIGlmICh0aGlzLl9fbmF0aXZlVmlldykge1xuICAgICAgICAgICAgdGhpcy5fc3VzcGVuZGVkVXBkYXRlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMuaW5pdE5hdGl2ZVZpZXcoKTtcbiAgICAgICAgICAgIHRoaXMuX3Jlc3VtZU5hdGl2ZVVwZGF0ZXMoU3VzcGVuZFR5cGUuTmF0aXZlVmlldyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fdGVhckRvd25VSSA9IGZ1bmN0aW9uIChmb3JjZSkge1xuICAgICAgICBpZiAoIXRoaXMuX2NvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlc2V0TmF0aXZlVmlld0ludGVybmFsKCk7XG4gICAgICAgIHRoaXMuZWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgY2hpbGQuX3RlYXJEb3duVUkoZm9yY2UpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Ll9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kaXNwb3NlTmF0aXZlVmlldygpO1xuICAgICAgICB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlcyhTdXNwZW5kVHlwZS5VSVNldHVwKTtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuaXNBbmRyb2lkKSB7XG4gICAgICAgICAgICB0aGlzLnNldE5hdGl2ZVZpZXcobnVsbCk7XG4gICAgICAgICAgICB0aGlzLl9hbmRyb2lkVmlldyA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY29udGV4dCA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLmRvbU5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuZG9tTm9kZS5kaXNwb3NlKCk7XG4gICAgICAgICAgICB0aGlzLmRvbU5vZGUgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fY2hpbGRJbmRleFRvTmF0aXZlQ2hpbGRJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAodmlldywgYXRJbmRleCkge1xuICAgICAgICBpZiAodmlldy5faXNBZGRlZFRvTmF0aXZlVmlzdWFsVHJlZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2hpbGQgYWxyZWFkeSBhZGRlZCB0byB0aGUgbmF0aXZlIHZpc3VhbCB0cmVlLlwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdmlldy5faXNBZGRlZFRvTmF0aXZlVmlzdWFsVHJlZSA9IGZhbHNlO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9nb1RvVmlzdWFsU3RhdGUgPSBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgaWYgKGJpbmRhYmxlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGJpbmRhYmxlXzEudHJhY2VXcml0ZSh0aGlzICsgXCIgZ29pbmcgdG8gc3RhdGU6IFwiICsgc3RhdGUsIGJpbmRhYmxlXzEudHJhY2VDYXRlZ29yaWVzLlN0eWxlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RhdGUgPT09IHRoaXMuX3Zpc3VhbFN0YXRlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kZWxldGVQc2V1ZG9DbGFzcyh0aGlzLl92aXN1YWxTdGF0ZSk7XG4gICAgICAgIHRoaXMuX3Zpc3VhbFN0YXRlID0gc3RhdGU7XG4gICAgICAgIHRoaXMuYWRkUHNldWRvQ2xhc3Moc3RhdGUpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9hcHBseVhtbEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiVmlld0Jhc2UuX2FwcGx5WG1sQXR0cmlidXRlKC4uLikgaXMgZGVwcmVjYXRlZDsgc2V0IGF0dHJpYnV0ZXMgYXMgcGxhaW4gcHJvcGVydGllcyBpbnN0ZWFkXCIpO1xuICAgICAgICBpZiAoYXR0cmlidXRlID09PSBcInN0eWxlXCIgfHwgYXR0cmlidXRlID09PSBcInJvd3NcIiB8fCBhdHRyaWJ1dGUgPT09IFwiY29sdW1uc1wiIHx8IGF0dHJpYnV0ZSA9PT0gXCJmb250QXR0cmlidXRlc1wiKSB7XG4gICAgICAgICAgICB0aGlzW2F0dHJpYnV0ZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5zZXRJbmxpbmVTdHlsZSA9IGZ1bmN0aW9uIChzdHlsZSkge1xuICAgICAgICBpZiAodHlwZW9mIHN0eWxlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXJhbWV0ZXIgc2hvdWxkIGJlIHZhbGlkIENTUyBzdHJpbmchXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVuc3VyZVN0eWxlU2NvcGVNb2R1bGUoKTtcbiAgICAgICAgc3R5bGVTY29wZU1vZHVsZS5hcHBseUlubGluZVN0eWxlKHRoaXMsIHN0eWxlKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fcGFyZW50Q2hhbmdlZCA9IGZ1bmN0aW9uIChvbGRQYXJlbnQpIHtcbiAgICAgICAgdmFyIG5ld1BhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAob2xkUGFyZW50KSB7XG4gICAgICAgICAgICBwcm9wZXJ0aWVzXzEuY2xlYXJJbmhlcml0ZWRQcm9wZXJ0aWVzKHRoaXMpO1xuICAgICAgICAgICAgaWYgKHRoaXMuYmluZGluZ0NvbnRleHRCb3VuZFRvUGFyZW50QmluZGluZ0NvbnRleHRDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgb2xkUGFyZW50Lm9mZihcImJpbmRpbmdDb250ZXh0Q2hhbmdlXCIsIHRoaXMuYmluZGluZ0NvbnRleHRDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnNob3VsZEFkZEhhbmRsZXJUb1BhcmVudEJpbmRpbmdDb250ZXh0Q2hhbmdlZCkge1xuICAgICAgICAgICAgbmV3UGFyZW50Lm9uKFwiYmluZGluZ0NvbnRleHRDaGFuZ2VcIiwgdGhpcy5iaW5kaW5nQ29udGV4dENoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5iaW5kaW5ncy5nZXQoXCJiaW5kaW5nQ29udGV4dFwiKS5iaW5kKG5ld1BhcmVudC5iaW5kaW5nQ29udGV4dCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5vblJlc3VtZU5hdGl2ZVVwZGF0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHByb3BlcnRpZXNfMS5pbml0TmF0aXZlVmlldyh0aGlzKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0ciA9IHRoaXMudHlwZU5hbWU7XG4gICAgICAgIGlmICh0aGlzLmlkKSB7XG4gICAgICAgICAgICBzdHIgKz0gXCI8XCIgKyB0aGlzLmlkICsgXCI+XCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzdHIgKz0gXCIoXCIgKyB0aGlzLl9kb21JZCArIFwiKVwiO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzb3VyY2UgPSBkZWJ1Z18xLlNvdXJjZS5nZXQodGhpcyk7XG4gICAgICAgIGlmIChzb3VyY2UpIHtcbiAgICAgICAgICAgIHN0ciArPSBcIkBcIiArIHNvdXJjZSArIFwiO1wiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX29uQ3NzU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2Nzc1N0YXRlLm9uQ2hhbmdlKCk7XG4gICAgICAgIGVhY2hEZXNjZW5kYW50KHRoaXMsIGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgY2hpbGQuX2Nzc1N0YXRlLm9uQ2hhbmdlKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX2luaGVyaXRTdHlsZVNjb3BlID0gZnVuY3Rpb24gKHN0eWxlU2NvcGUpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzU3R5bGVTY29wZUhvc3QpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fc3R5bGVTY29wZSAhPT0gc3R5bGVTY29wZSkge1xuICAgICAgICAgICAgdGhpcy5fc3R5bGVTY29wZSA9IHN0eWxlU2NvcGU7XG4gICAgICAgICAgICB0aGlzLl9vbkNzc1N0YXRlQ2hhbmdlKCk7XG4gICAgICAgICAgICB0aGlzLmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICBjaGlsZC5faW5oZXJpdFN0eWxlU2NvcGUoc3R5bGVTY29wZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnNob3dNb2RhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50LnNob3dNb2RhbC5hcHBseShwYXJlbnQsIGFyZ3MpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmNsb3NlTW9kYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICBwYXJlbnQuY2xvc2VNb2RhbC5hcHBseShwYXJlbnQsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX2RpYWxvZ0Nsb3NlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZWFjaERlc2NlbmRhbnQodGhpcywgZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICBjaGlsZC5fZGlhbG9nQ2xvc2VkKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX29uUm9vdFZpZXdSZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZWFjaERlc2NlbmRhbnQodGhpcywgZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICBjaGlsZC5fb25Sb290Vmlld1Jlc2V0KCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5sb2FkZWRFdmVudCA9IFwibG9hZGVkXCI7XG4gICAgVmlld0Jhc2UudW5sb2FkZWRFdmVudCA9IFwidW5sb2FkZWRcIjtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXdCYXNlLnByb3RvdHlwZSwgXCJvbkxvYWRlZFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXdCYXNlLnByb3RvdHlwZSwgXCJvblVubG9hZGVkXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlld0Jhc2UucHJvdG90eXBlLCBcImFkZFBzZXVkb0NsYXNzXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlld0Jhc2UucHJvdG90eXBlLCBcImRlbGV0ZVBzZXVkb0NsYXNzXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlld0Jhc2UucHJvdG90eXBlLCBcInJlcXVlc3RMYXlvdXRcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3QmFzZS5wcm90b3R5cGUsIFwiX2FkZFZpZXdcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3QmFzZS5wcm90b3R5cGUsIFwiX3NldHVwVUlcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3QmFzZS5wcm90b3R5cGUsIFwiX3RlYXJEb3duVUlcIiwgbnVsbCk7XG4gICAgcmV0dXJuIFZpZXdCYXNlO1xufShiaW5kYWJsZV8xLk9ic2VydmFibGUpKTtcbmV4cG9ydHMuVmlld0Jhc2UgPSBWaWV3QmFzZTtcblZpZXdCYXNlLnByb3RvdHlwZS5pc0NvbGxhcHNlZCA9IGZhbHNlO1xuVmlld0Jhc2UucHJvdG90eXBlLl9vbGRMZWZ0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5fb2xkVG9wID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5fb2xkUmlnaHQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLl9vbGRCb3R0b20gPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZU1pbldpZHRoID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVNaW5IZWlnaHQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZVdpZHRoID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVIZWlnaHQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZU1hcmdpblRvcCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlTWFyZ2luUmlnaHQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlTWFyZ2luTGVmdCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlUGFkZGluZ1RvcCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVQYWRkaW5nQm90dG9tID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVQYWRkaW5nTGVmdCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGggPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGggPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZUJvcmRlckJvdHRvbVdpZHRoID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLl9kZWZhdWx0UGFkZGluZ1RvcCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuX2RlZmF1bHRQYWRkaW5nUmlnaHQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLl9kZWZhdWx0UGFkZGluZ0JvdHRvbSA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuX2RlZmF1bHRQYWRkaW5nTGVmdCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuX2lzVmlld0Jhc2UgPSB0cnVlO1xuVmlld0Jhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJuZXZlclwiO1xuVmlld0Jhc2UucHJvdG90eXBlLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50ID1cbiAgICBTdXNwZW5kVHlwZS5Mb2FkZWQgfFxuICAgICAgICBTdXNwZW5kVHlwZS5OYXRpdmVWaWV3IHxcbiAgICAgICAgU3VzcGVuZFR5cGUuVUlTZXR1cDtcbmV4cG9ydHMuYmluZGluZ0NvbnRleHRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuSW5oZXJpdGVkUHJvcGVydHkoeyBuYW1lOiBcImJpbmRpbmdDb250ZXh0XCIgfSk7XG5leHBvcnRzLmJpbmRpbmdDb250ZXh0UHJvcGVydHkucmVnaXN0ZXIoVmlld0Jhc2UpO1xuZXhwb3J0cy5jbGFzc05hbWVQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiY2xhc3NOYW1lXCIsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodmlldywgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBjc3NDbGFzc2VzID0gdmlldy5jc3NDbGFzc2VzO1xuICAgICAgICB2YXIgbW9kYWxWaWV3Q3NzQ2xhc3MgPSBzeXN0ZW1fY2xhc3Nlc18xLmdldE1vZGFsUm9vdFZpZXdDc3NDbGFzcygpO1xuICAgICAgICB2YXIgcm9vdFZpZXdDc3NDbGFzc2VzID0gc3lzdGVtX2NsYXNzZXNfMS5nZXRSb290Vmlld0Nzc0NsYXNzZXMoKTtcbiAgICAgICAgdmFyIHNob3VsZEFkZE1vZGFsUm9vdFZpZXdDc3NDbGFzcyA9IGNzc0NsYXNzZXMuaGFzKG1vZGFsVmlld0Nzc0NsYXNzKTtcbiAgICAgICAgdmFyIHNob3VsZEFkZFJvb3RWaWV3Q3NzQ2xhc3NlcyA9IGNzc0NsYXNzZXMuaGFzKHJvb3RWaWV3Q3NzQ2xhc3Nlc1swXSk7XG4gICAgICAgIGNzc0NsYXNzZXMuY2xlYXIoKTtcbiAgICAgICAgaWYgKHNob3VsZEFkZE1vZGFsUm9vdFZpZXdDc3NDbGFzcykge1xuICAgICAgICAgICAgY3NzQ2xhc3Nlcy5hZGQobW9kYWxWaWV3Q3NzQ2xhc3MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNob3VsZEFkZFJvb3RWaWV3Q3NzQ2xhc3Nlcykge1xuICAgICAgICAgICAgcm9vdFZpZXdDc3NDbGFzc2VzLmZvckVhY2goZnVuY3Rpb24gKGMpIHsgcmV0dXJuIGNzc0NsYXNzZXMuYWRkKGMpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIG5ld1ZhbHVlID09PSBcInN0cmluZ1wiICYmIG5ld1ZhbHVlICE9PSBcIlwiKSB7XG4gICAgICAgICAgICBuZXdWYWx1ZS5zcGxpdChcIiBcIikuZm9yRWFjaChmdW5jdGlvbiAoYykgeyByZXR1cm4gY3NzQ2xhc3Nlcy5hZGQoYyk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIHZpZXcuX29uQ3NzU3RhdGVDaGFuZ2UoKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuY2xhc3NOYW1lUHJvcGVydHkucmVnaXN0ZXIoVmlld0Jhc2UpO1xuZXhwb3J0cy5pZFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaWRcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodmlldywgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7IHJldHVybiB2aWV3Ll9vbkNzc1N0YXRlQ2hhbmdlKCk7IH0gfSk7XG5leHBvcnRzLmlkUHJvcGVydHkucmVnaXN0ZXIoVmlld0Jhc2UpO1xuZnVuY3Rpb24gYm9vbGVhbkNvbnZlcnRlcih2KSB7XG4gICAgdmFyIGxvd2VyY2FzZSA9ICh2ICsgXCJcIikudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAobG93ZXJjYXNlID09PSBcInRydWVcIikge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSBpZiAobG93ZXJjYXNlID09PSBcImZhbHNlXCIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGJvb2xlYW46IFwiICsgdik7XG59XG5leHBvcnRzLmJvb2xlYW5Db252ZXJ0ZXIgPSBib29sZWFuQ29udmVydGVyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dmlldy1iYXNlLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld19iYXNlXzEgPSByZXF1aXJlKFwiLi4vdmlldy1iYXNlXCIpO1xudmFyIHN0eWxlX3Byb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi9zdHlsaW5nL3N0eWxlLXByb3BlcnRpZXNcIik7XG52YXIgZ2VzdHVyZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi9nZXN0dXJlc1wiKTtcbnZhciBzeXN0ZW1fY2xhc3Nlc18xID0gcmVxdWlyZShcIi4uLy4uLy4uL2Nzcy9zeXN0ZW0tY2xhc3Nlc1wiKTtcbnZhciBidWlsZGVyXzEgPSByZXF1aXJlKFwiLi4vLi4vYnVpbGRlclwiKTtcbnZhciBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMSA9IHJlcXVpcmUoXCIuLi8uLi9idWlsZGVyL21vZHVsZS1uYW1lLXNhbml0aXplclwiKTtcbnZhciBzdHlsZV9zY29wZV8xID0gcmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvc3R5bGUtc2NvcGVcIik7XG52YXIgbGluZWFyX2dyYWRpZW50XzEgPSByZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9saW5lYXItZ3JhZGllbnRcIik7XG5leHBvcnRzLkxpbmVhckdyYWRpZW50ID0gbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQ7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi92aWV3LWJhc2VcIikpO1xudmFyIGFuaW1hdGlvbk1vZHVsZTtcbmZ1bmN0aW9uIGVuc3VyZUFuaW1hdGlvbk1vZHVsZSgpIHtcbiAgICBpZiAoIWFuaW1hdGlvbk1vZHVsZSkge1xuICAgICAgICBhbmltYXRpb25Nb2R1bGUgPSByZXF1aXJlKFwiLi4vLi4vYW5pbWF0aW9uXCIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIENTU1R5cGUodHlwZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoY2xzKSB7XG4gICAgICAgIGNscy5wcm90b3R5cGUuY3NzVHlwZSA9IHR5cGU7XG4gICAgfTtcbn1cbmV4cG9ydHMuQ1NTVHlwZSA9IENTU1R5cGU7XG5mdW5jdGlvbiB2aWV3TWF0Y2hlc01vZHVsZUNvbnRleHQodmlldywgY29udGV4dCwgdHlwZXMpIHtcbiAgICByZXR1cm4gY29udGV4dCAmJlxuICAgICAgICB2aWV3Ll9tb2R1bGVOYW1lICYmXG4gICAgICAgIGNvbnRleHQudHlwZSAmJlxuICAgICAgICB0eXBlcy5zb21lKGZ1bmN0aW9uICh0eXBlKSB7IHJldHVybiB0eXBlID09PSBjb250ZXh0LnR5cGU7IH0pICYmXG4gICAgICAgIGNvbnRleHQucGF0aCAmJlxuICAgICAgICBjb250ZXh0LnBhdGguaW5jbHVkZXModmlldy5fbW9kdWxlTmFtZSk7XG59XG5leHBvcnRzLnZpZXdNYXRjaGVzTW9kdWxlQ29udGV4dCA9IHZpZXdNYXRjaGVzTW9kdWxlQ29udGV4dDtcbmZ1bmN0aW9uIFBzZXVkb0NsYXNzSGFuZGxlcigpIHtcbiAgICB2YXIgcHNldWRvQ2xhc3NlcyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHBzZXVkb0NsYXNzZXNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgdmFyIHN0YXRlRXZlbnROYW1lcyA9IHBzZXVkb0NsYXNzZXMubWFwKGZ1bmN0aW9uIChzKSB7IHJldHVybiBcIjpcIiArIHM7IH0pO1xuICAgIHZhciBsaXN0ZW5lcnMgPSBTeW1ib2woXCJsaXN0ZW5lcnNcIik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIHByb3BlcnR5S2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZShjaGFuZ2UpIHtcbiAgICAgICAgICAgIHZhciBwcmV2ID0gdGhpc1tsaXN0ZW5lcnNdIHx8IDA7XG4gICAgICAgICAgICB2YXIgbmV4dCA9IHByZXYgKyBjaGFuZ2U7XG4gICAgICAgICAgICBpZiAocHJldiA8PSAwICYmIG5leHQgPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpc1twcm9wZXJ0eUtleV0odHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwcmV2ID4gMCAmJiBuZXh0IDw9IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzW3Byb3BlcnR5S2V5XShmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc3RhdGVFdmVudE5hbWVzLmZvckVhY2goZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHRhcmdldFtzXSA9IHVwZGF0ZTsgfSk7XG4gICAgfTtcbn1cbmV4cG9ydHMuUHNldWRvQ2xhc3NIYW5kbGVyID0gUHNldWRvQ2xhc3NIYW5kbGVyO1xuZXhwb3J0cy5fcm9vdE1vZGFsVmlld3MgPSBuZXcgQXJyYXkoKTtcbnZhciBWaWV3Q29tbW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVmlld0NvbW1vbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBWaWV3Q29tbW9uKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2dlc3R1cmVPYnNlcnZlcnMgPSB7fTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiY3NzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc2NvcGUgPSB0aGlzLl9zdHlsZVNjb3BlO1xuICAgICAgICAgICAgcmV0dXJuIHNjb3BlICYmIHNjb3BlLmNzcztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVN0eWxlU2NvcGUodW5kZWZpbmVkLCB1bmRlZmluZWQsIHZhbHVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuYWRkQ3NzID0gZnVuY3Rpb24gKGNzc1N0cmluZykge1xuICAgICAgICB0aGlzLl91cGRhdGVTdHlsZVNjb3BlKHVuZGVmaW5lZCwgY3NzU3RyaW5nKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmFkZENzc0ZpbGUgPSBmdW5jdGlvbiAoY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlU3R5bGVTY29wZShjc3NGaWxlTmFtZSk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5jaGFuZ2VDc3NGaWxlID0gZnVuY3Rpb24gKGNzc0ZpbGVOYW1lKSB7XG4gICAgICAgIHZhciBzY29wZSA9IHRoaXMuX3N0eWxlU2NvcGU7XG4gICAgICAgIGlmIChzY29wZSAmJiBjc3NGaWxlTmFtZSkge1xuICAgICAgICAgICAgc2NvcGUuY2hhbmdlQ3NzRmlsZShjc3NGaWxlTmFtZSk7XG4gICAgICAgICAgICB0aGlzLl9vbkNzc1N0YXRlQ2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl91cGRhdGVTdHlsZVNjb3BlID0gZnVuY3Rpb24gKGNzc0ZpbGVOYW1lLCBjc3NTdHJpbmcsIGNzcykge1xuICAgICAgICB2YXIgc2NvcGUgPSB0aGlzLl9zdHlsZVNjb3BlO1xuICAgICAgICBpZiAoIXNjb3BlKSB7XG4gICAgICAgICAgICBzY29wZSA9IG5ldyBzdHlsZV9zY29wZV8xLlN0eWxlU2NvcGUoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U2NvcGVQcm9wZXJ0eShzY29wZSwgY3NzRmlsZU5hbWUsIGNzc1N0cmluZywgY3NzKTtcbiAgICAgICAgICAgIHRoaXMuX2luaGVyaXRTdHlsZVNjb3BlKHNjb3BlKTtcbiAgICAgICAgICAgIHRoaXMuX2lzU3R5bGVTY29wZUhvc3QgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXRTY29wZVByb3BlcnR5KHNjb3BlLCBjc3NGaWxlTmFtZSwgY3NzU3RyaW5nLCBjc3MpO1xuICAgICAgICAgICAgdGhpcy5fb25Dc3NTdGF0ZUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5zZXRTY29wZVByb3BlcnR5ID0gZnVuY3Rpb24gKHNjb3BlLCBjc3NGaWxlTmFtZSwgY3NzU3RyaW5nLCBjc3MpIHtcbiAgICAgICAgaWYgKGNzc0ZpbGVOYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNjb3BlLmFkZENzc0ZpbGUoY3NzRmlsZU5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNzc1N0cmluZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzY29wZS5hZGRDc3MoY3NzU3RyaW5nKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjc3MgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2NvcGUuY3NzID0gY3NzO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fY2xvc2VBbGxNb2RhbFZpZXdzSW50ZXJuYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChleHBvcnRzLl9yb290TW9kYWxWaWV3cyAmJiBleHBvcnRzLl9yb290TW9kYWxWaWV3cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBleHBvcnRzLl9yb290TW9kYWxWaWV3cy5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICAgICAgdi5jbG9zZU1vZGFsKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9nZXRSb290TW9kYWxWaWV3cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGV4cG9ydHMuX3Jvb3RNb2RhbFZpZXdzO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX29uTGl2ZXN5bmMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfYmFzZV8xLnRyYWNlV3JpdGUodGhpcyArIFwiLl9vbkxpdmVzeW5jKFwiICsgSlNPTi5zdHJpbmdpZnkoY29udGV4dCkgKyBcIilcIiwgdmlld19iYXNlXzEudHJhY2VDYXRlZ29yaWVzLkxpdmVzeW5jKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fY2xvc2VBbGxNb2RhbFZpZXdzSW50ZXJuYWwoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2hhbmRsZUxpdmVzeW5jKGNvbnRleHQpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaGFuZGxlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmVhY2hDaGlsZFZpZXcoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICBpZiAoY2hpbGQuX29uTGl2ZXN5bmMoY29udGV4dCkpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gaGFuZGxlZDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9oYW5kbGVMaXZlc3luYyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgIGlmICh2aWV3X2Jhc2VfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdmlld19iYXNlXzEudHJhY2VXcml0ZSh0aGlzICsgXCIuX2hhbmRsZUxpdmVzeW5jKFwiICsgSlNPTi5zdHJpbmdpZnkoY29udGV4dCkgKyBcIilcIiwgdmlld19iYXNlXzEudHJhY2VDYXRlZ29yaWVzLkxpdmVzeW5jKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmlld01hdGNoZXNNb2R1bGVDb250ZXh0KHRoaXMsIGNvbnRleHQsIFtcInN0eWxlXCJdKSkge1xuICAgICAgICAgICAgaWYgKHZpZXdfYmFzZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgdmlld19iYXNlXzEudHJhY2VXcml0ZShcIkNoYW5nZSBIYW5kbGVkOiBDaGFuZ2luZyBDU1MgZm9yIFwiICsgdGhpcywgdmlld19iYXNlXzEudHJhY2VDYXRlZ29yaWVzLkxpdmVzeW5jKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjc3NNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfc2FuaXRpemVyXzEuc2FuaXRpemVNb2R1bGVOYW1lKGNvbnRleHQucGF0aCkgKyBcIi5jc3NcIjtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlQ3NzRmlsZShjc3NNb2R1bGVOYW1lKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3TWF0Y2hlc01vZHVsZUNvbnRleHQodGhpcywgY29udGV4dCwgW1wibWFya3VwXCIsIFwic2NyaXB0XCJdKSAmJlxuICAgICAgICAgICAgdGhpcy5wYWdlICYmXG4gICAgICAgICAgICB0aGlzLnBhZ2UuZnJhbWUpIHtcbiAgICAgICAgICAgIGlmICh2aWV3X2Jhc2VfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHZpZXdfYmFzZV8xLnRyYWNlV3JpdGUoXCJDaGFuZ2UgSGFuZGxlZDogQ2hhbmdpbmcgXCIgKyBjb250ZXh0LnR5cGUgKyBcIiBmb3IgXCIgKyB0aGlzICsgXCIgaW5zaWRlIFwiICsgdGhpcy5wYWdlLCB2aWV3X2Jhc2VfMS50cmFjZUNhdGVnb3JpZXMuTGl2ZXN5bmMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFnZS5mcmFtZS5faGFuZGxlTGl2ZXN5bmMoeyB0eXBlOiBjb250ZXh0LnR5cGUsIHBhdGg6IHRoaXMucGFnZS5fbW9kdWxlTmFtZSB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fc2V0dXBBc1Jvb3RWaWV3ID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc2V0dXBBc1Jvb3RWaWV3LmNhbGwodGhpcywgY29udGV4dCk7XG4gICAgICAgIGlmICghdGhpcy5fc3R5bGVTY29wZSkge1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlU3R5bGVTY29wZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fb2JzZXJ2ZSA9IGZ1bmN0aW9uICh0eXBlLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBpZiAoIXRoaXMuX2dlc3R1cmVPYnNlcnZlcnNbdHlwZV0pIHtcbiAgICAgICAgICAgIHRoaXMuX2dlc3R1cmVPYnNlcnZlcnNbdHlwZV0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9nZXN0dXJlT2JzZXJ2ZXJzW3R5cGVdLnB1c2goZ2VzdHVyZXNfMS5vYnNlcnZlKHRoaXMsIHR5cGUsIGNhbGxiYWNrLCB0aGlzQXJnKSk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRHZXN0dXJlT2JzZXJ2ZXJzID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dlc3R1cmVPYnNlcnZlcnNbdHlwZV07XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGFyZywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhcmcgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIGFyZyA9IHZpZXdfYmFzZV8xLmdldEV2ZW50T3JHZXN0dXJlTmFtZShhcmcpO1xuICAgICAgICAgICAgdmFyIGdlc3R1cmUgPSBnZXN0dXJlc18xLmZyb21TdHJpbmcoYXJnKTtcbiAgICAgICAgICAgIGlmIChnZXN0dXJlICYmICF0aGlzLl9pc0V2ZW50KGFyZykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vYnNlcnZlKGdlc3R1cmUsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBldmVudHMgPSAoYXJnKS5zcGxpdChcIixcIik7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXZlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXZ0ID0gZXZlbnRzW2ldLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnc3QgPSBnZXN0dXJlc18xLmZyb21TdHJpbmcoZXZ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnc3QgJiYgIXRoaXMuX2lzRXZlbnQoYXJnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29ic2VydmUoZ3N0LCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCBldnQsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyLmNhbGwodGhpcywgYXJnLCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBhcmcgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHRoaXMuX29ic2VydmUoYXJnLCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoYXJnLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBpZiAodHlwZW9mIGFyZyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIGdlc3R1cmUgPSBnZXN0dXJlc18xLmZyb21TdHJpbmcoYXJnKTtcbiAgICAgICAgICAgIGlmIChnZXN0dXJlICYmICF0aGlzLl9pc0V2ZW50KGFyZykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNjb25uZWN0R2VzdHVyZU9ic2VydmVycyhnZXN0dXJlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBldmVudHMgPSBhcmcuc3BsaXQoXCIsXCIpO1xuICAgICAgICAgICAgICAgIGlmIChldmVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV2ZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV2dCA9IGV2ZW50c1tpXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3N0ID0gZ2VzdHVyZXNfMS5mcm9tU3RyaW5nKGV2dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ3N0ICYmICF0aGlzLl9pc0V2ZW50KGFyZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kaXNjb25uZWN0R2VzdHVyZU9ic2VydmVycyhnc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyLmNhbGwodGhpcywgZXZ0LCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIGFyZywgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgYXJnID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICB0aGlzLl9kaXNjb25uZWN0R2VzdHVyZU9ic2VydmVycyhhcmcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5vbkJhY2tQcmVzc2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fZ2V0RnJhZ21lbnRNYW5hZ2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0TW9kYWxPcHRpb25zID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJzaG93TW9kYWwgd2l0aG91dCBwYXJhbWV0ZXJzIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSBjYWxsIHNob3dNb2RhbCBvbiBhIHZpZXcgaW5zdGFuY2UgaW5zdGVhZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IG51bGw7XG4gICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gYXJnc1sxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChhcmdzWzBdIGluc3RhbmNlb2YgVmlld0NvbW1vbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNob3dNb2RhbCh2aWV3OiBWaWV3QmFzZSwgY29udGV4dDogYW55LCBjbG9zZUNhbGxiYWNrOiBGdW5jdGlvbiwgZnVsbHNjcmVlbj86IGJvb2xlYW4sIGFuaW1hdGVkPzogYm9vbGVhbiwgc3RyZXRjaGVkPzogYm9vbGVhbikgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJpcyBkZXByZWNhdGVkLiBVc2Ugc2hvd01vZGFsKHZpZXc6IFZpZXdCYXNlLCBtb2RhbE9wdGlvbnM6IFNob3dNb2RhbE9wdGlvbnMpIGluc3RlYWQuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzaG93TW9kYWwobW9kdWxlTmFtZTogc3RyaW5nLCBjb250ZXh0OiBhbnksIGNsb3NlQ2FsbGJhY2s6IEZ1bmN0aW9uLCBmdWxsc2NyZWVuPzogYm9vbGVhbiwgYW5pbWF0ZWQ/OiBib29sZWFuLCBzdHJldGNoZWQ/OiBib29sZWFuKSBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcImlzIGRlcHJlY2F0ZWQuIFVzZSBzaG93TW9kYWwobW9kdWxlTmFtZTogc3RyaW5nLCBtb2RhbE9wdGlvbnM6IFNob3dNb2RhbE9wdGlvbnMpIGluc3RlYWQuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0OiBhcmdzWzFdLFxuICAgICAgICAgICAgICAgICAgICBjbG9zZUNhbGxiYWNrOiBhcmdzWzJdLFxuICAgICAgICAgICAgICAgICAgICBmdWxsc2NyZWVuOiBhcmdzWzNdLFxuICAgICAgICAgICAgICAgICAgICBhbmltYXRlZDogYXJnc1s0XSxcbiAgICAgICAgICAgICAgICAgICAgc3RyZXRjaGVkOiBhcmdzWzVdXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmaXJzdEFyZ3VtZW50ID0gYXJnc1swXTtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gZmlyc3RBcmd1bWVudCBpbnN0YW5jZW9mIFZpZXdDb21tb25cbiAgICAgICAgICAgICAgICA/IGZpcnN0QXJndW1lbnQgOiBidWlsZGVyXzEuY3JlYXRlVmlld0Zyb21FbnRyeSh7IG1vZHVsZU5hbWU6IGZpcnN0QXJndW1lbnQgfSk7XG4gICAgICAgICAgICByZXR1cm4geyB2aWV3OiB2aWV3LCBvcHRpb25zOiBvcHRpb25zIH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLnNob3dNb2RhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hID0gdGhpcy5nZXRNb2RhbE9wdGlvbnMoYXJndW1lbnRzKSwgdmlldyA9IF9hLnZpZXcsIG9wdGlvbnMgPSBfYS5vcHRpb25zO1xuICAgICAgICB2aWV3Ll9zaG93TmF0aXZlTW9kYWxWaWV3KHRoaXMsIG9wdGlvbnMpO1xuICAgICAgICByZXR1cm4gdmlldztcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmNsb3NlTW9kYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNsb3NlQ2FsbGJhY2sgPSB0aGlzLl9jbG9zZU1vZGFsQ2FsbGJhY2s7XG4gICAgICAgIGlmIChjbG9zZUNhbGxiYWNrKSB7XG4gICAgICAgICAgICBjbG9zZUNhbGxiYWNrLmFwcGx5KHVuZGVmaW5lZCwgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnRfMSA9IHRoaXMucGFyZW50O1xuICAgICAgICAgICAgaWYgKHBhcmVudF8xKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50XzEuY2xvc2VNb2RhbC5hcHBseShwYXJlbnRfMSwgYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtb2RhbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21vZGFsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fc2hvd05hdGl2ZU1vZGFsVmlldyA9IGZ1bmN0aW9uIChwYXJlbnQsIG9wdGlvbnMpIHtcbiAgICAgICAgZXhwb3J0cy5fcm9vdE1vZGFsVmlld3MucHVzaCh0aGlzKTtcbiAgICAgICAgdmFyIG1vZGFsUm9vdFZpZXdDc3NDbGFzcyA9IHN5c3RlbV9jbGFzc2VzXzEuZ2V0TW9kYWxSb290Vmlld0Nzc0NsYXNzKCk7XG4gICAgICAgIHRoaXMuY3NzQ2xhc3Nlcy5hZGQobW9kYWxSb290Vmlld0Nzc0NsYXNzKTtcbiAgICAgICAgcGFyZW50Ll9tb2RhbCA9IHRoaXM7XG4gICAgICAgIHRoaXMuX21vZGFsUGFyZW50ID0gcGFyZW50O1xuICAgICAgICB0aGlzLl9tb2RhbENvbnRleHQgPSBvcHRpb25zLmNvbnRleHQ7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgdGhpcy5fY2xvc2VNb2RhbENhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG9yaWdpbmFsQXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbEFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGF0Ll9jbG9zZU1vZGFsQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB2YXIgbW9kYWxJbmRleCA9IGV4cG9ydHMuX3Jvb3RNb2RhbFZpZXdzLmluZGV4T2YodGhhdCk7XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5fcm9vdE1vZGFsVmlld3Muc3BsaWNlKG1vZGFsSW5kZXgpO1xuICAgICAgICAgICAgICAgIHRoYXQuX21vZGFsUGFyZW50ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGF0Ll9tb2RhbENvbnRleHQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoYXQuX2Nsb3NlTW9kYWxDYWxsYmFjayA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhhdC5fZGlhbG9nQ2xvc2VkKCk7XG4gICAgICAgICAgICAgICAgcGFyZW50Ll9tb2RhbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdmFyIHdoZW5DbG9zZWRDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLmNsb3NlQ2FsbGJhY2sgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5jbG9zZUNhbGxiYWNrLmFwcGx5KHVuZGVmaW5lZCwgb3JpZ2luYWxBcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhhdC5faGlkZU5hdGl2ZU1vZGFsVmlldyhwYXJlbnQsIHdoZW5DbG9zZWRDYWxsYmFjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fcmFpc2VMYXlvdXRDaGFuZ2VkRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgZXZlbnROYW1lOiBWaWV3Q29tbW9uLmxheW91dENoYW5nZWRFdmVudCxcbiAgICAgICAgICAgIG9iamVjdDogdGhpc1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm5vdGlmeShhcmdzKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9yYWlzZVNob3duTW9kYWxseUV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogVmlld0NvbW1vbi5zaG93bk1vZGFsbHlFdmVudCxcbiAgICAgICAgICAgIG9iamVjdDogdGhpcyxcbiAgICAgICAgICAgIGNvbnRleHQ6IHRoaXMuX21vZGFsQ29udGV4dCxcbiAgICAgICAgICAgIGNsb3NlQ2FsbGJhY2s6IHRoaXMuX2Nsb3NlTW9kYWxDYWxsYmFja1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm5vdGlmeShhcmdzKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9yYWlzZVNob3dpbmdNb2RhbGx5RXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgZXZlbnROYW1lOiBWaWV3Q29tbW9uLnNob3dpbmdNb2RhbGx5RXZlbnQsXG4gICAgICAgICAgICBvYmplY3Q6IHRoaXMsXG4gICAgICAgICAgICBjb250ZXh0OiB0aGlzLl9tb2RhbENvbnRleHQsXG4gICAgICAgICAgICBjbG9zZUNhbGxiYWNrOiB0aGlzLl9jbG9zZU1vZGFsQ2FsbGJhY2tcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5ub3RpZnkoYXJncyk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5faXNFdmVudCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdG9yICYmIG5hbWUgKyBcIkV2ZW50XCIgaW4gdGhpcy5jb25zdHJ1Y3RvcjtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9kaXNjb25uZWN0R2VzdHVyZU9ic2VydmVycyA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHZhciBvYnNlcnZlcnMgPSB0aGlzLmdldEdlc3R1cmVPYnNlcnZlcnModHlwZSk7XG4gICAgICAgIGlmIChvYnNlcnZlcnMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JzZXJ2ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXJzW2ldLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlckNvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlclRvcENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJUb3BDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyVG9wQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlclJpZ2h0Q29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlclJpZ2h0Q29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlclJpZ2h0Q29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlckJvdHRvbUNvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJCb3R0b21Db2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlckxlZnRDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyTGVmdENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJMZWZ0Q29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlcldpZHRoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJXaWR0aDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyV2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlclRvcFdpZHRoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJUb3BXaWR0aDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyVG9wV2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlclJpZ2h0V2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlclJpZ2h0V2lkdGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlclJpZ2h0V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlckJvdHRvbVdpZHRoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJCb3R0b21XaWR0aDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tV2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlckxlZnRXaWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyTGVmdFdpZHRoO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJMZWZ0V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlclJhZGl1c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyUmFkaXVzO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJSYWRpdXMgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlclRvcExlZnRSYWRpdXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlclRvcExlZnRSYWRpdXM7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlclRvcExlZnRSYWRpdXMgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlclRvcFJpZ2h0UmFkaXVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJUb3BSaWdodFJhZGl1cztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyVG9wUmlnaHRSYWRpdXMgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJCb3R0b21SaWdodFJhZGl1cztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXMgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJvcmRlckJvdHRvbUxlZnRSYWRpdXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlckJvdHRvbUxlZnRSYWRpdXM7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlckJvdHRvbUxlZnRSYWRpdXMgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImNvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5jb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuY29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJhY2tncm91bmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJhY2tncm91bmQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJhY2tncm91bmQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJhY2tncm91bmRDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYmFja2dyb3VuZENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJhY2tncm91bmRJbWFnZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYmFja2dyb3VuZEltYWdlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJhY2tncm91bmRTaXplXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5iYWNrZ3JvdW5kU2l6ZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZFNpemUgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJhY2tncm91bmRQb3NpdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb24gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImJhY2tncm91bmRSZXBlYXRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJhY2tncm91bmRSZXBlYXQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJhY2tncm91bmRSZXBlYXQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcIm1pbldpZHRoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5taW5XaWR0aDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubWluV2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcIm1pbkhlaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUubWluSGVpZ2h0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5taW5IZWlnaHQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcIndpZHRoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS53aWR0aDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUud2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImhlaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuaGVpZ2h0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5oZWlnaHQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcIm1hcmdpblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUubWFyZ2luO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5tYXJnaW4gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcIm1hcmdpbkxlZnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm1hcmdpbkxlZnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLm1hcmdpbkxlZnQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcIm1hcmdpblRvcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUubWFyZ2luVG9wO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5tYXJnaW5Ub3AgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcIm1hcmdpblJpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5tYXJnaW5SaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubWFyZ2luUmlnaHQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcIm1hcmdpbkJvdHRvbVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUubWFyZ2luQm90dG9tO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5tYXJnaW5Cb3R0b20gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImhvcml6b250YWxBbGlnbm1lbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmhvcml6b250YWxBbGlnbm1lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmhvcml6b250YWxBbGlnbm1lbnQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcInZlcnRpY2FsQWxpZ25tZW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS52ZXJ0aWNhbEFsaWdubWVudDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudmVydGljYWxBbGlnbm1lbnQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcInZpc2liaWxpdHlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnZpc2liaWxpdHk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnZpc2liaWxpdHkgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcIm9wYWNpdHlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm9wYWNpdHk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLm9wYWNpdHkgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcInJvdGF0ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUucm90YXRlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5yb3RhdGUgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcInRyYW5zbGF0ZVhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRyYW5zbGF0ZVg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnRyYW5zbGF0ZVggPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcInRyYW5zbGF0ZVlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRyYW5zbGF0ZVk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnRyYW5zbGF0ZVkgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcInNjYWxlWFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuc2NhbGVYO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5zY2FsZVggPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcInNjYWxlWVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuc2NhbGVZO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5zY2FsZVkgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImFuZHJvaWRFbGV2YXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmFuZHJvaWRFbGV2YXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmFuZHJvaWRFbGV2YXRpb24gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImFuZHJvaWREeW5hbWljRWxldmF0aW9uT2Zmc2V0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5hbmRyb2lkRHluYW1pY0VsZXZhdGlvbk9mZnNldDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImlzTGF5b3V0VmFsaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc0xheW91dFZhbGlkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiY3NzVHlwZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9jc3NUeXBlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3NzVHlwZSA9IHRoaXMudHlwZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jc3NUeXBlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgICAgICB0aGlzLl9jc3NUeXBlID0gdHlwZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiaXNMYXlvdXRSZXF1aXJlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLm1lYXN1cmUgPSBmdW5jdGlvbiAod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdGhpcy5fc2V0Q3VycmVudE1lYXN1cmVTcGVjcyh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5sYXlvdXQgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgICAgIHRoaXMuX3NldEN1cnJlbnRMYXlvdXRCb3VuZHMobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldE1lYXN1cmVkV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tZWFzdXJlZFdpZHRoICYgdmlld19iYXNlXzEubGF5b3V0Lk1FQVNVUkVEX1NJWkVfTUFTSyB8fCAwO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0TWVhc3VyZWRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tZWFzdXJlZEhlaWdodCAmIHZpZXdfYmFzZV8xLmxheW91dC5NRUFTVVJFRF9TSVpFX01BU0sgfHwgMDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldE1lYXN1cmVkU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5fbWVhc3VyZWRXaWR0aCAmIHZpZXdfYmFzZV8xLmxheW91dC5NRUFTVVJFRF9TVEFURV9NQVNLKVxuICAgICAgICAgICAgfCAoKHRoaXMuX21lYXN1cmVkSGVpZ2h0ID4+IHZpZXdfYmFzZV8xLmxheW91dC5NRUFTVVJFRF9IRUlHSFRfU1RBVEVfU0hJRlQpXG4gICAgICAgICAgICAgICAgJiAodmlld19iYXNlXzEubGF5b3V0Lk1FQVNVUkVEX1NUQVRFX01BU0sgPj4gdmlld19iYXNlXzEubGF5b3V0Lk1FQVNVUkVEX0hFSUdIVF9TVEFURV9TSElGVCkpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuc2V0TWVhc3VyZWREaW1lbnNpb24gPSBmdW5jdGlvbiAobWVhc3VyZWRXaWR0aCwgbWVhc3VyZWRIZWlnaHQpIHtcbiAgICAgICAgdGhpcy5fbWVhc3VyZWRXaWR0aCA9IG1lYXN1cmVkV2lkdGg7XG4gICAgICAgIHRoaXMuX21lYXN1cmVkSGVpZ2h0ID0gbWVhc3VyZWRIZWlnaHQ7XG4gICAgICAgIGlmICh2aWV3X2Jhc2VfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdmlld19iYXNlXzEudHJhY2VXcml0ZSh0aGlzICsgXCIgOnNldE1lYXN1cmVkRGltZW5zaW9uOiBcIiArIG1lYXN1cmVkV2lkdGggKyBcIiwgXCIgKyBtZWFzdXJlZEhlaWdodCwgdmlld19iYXNlXzEudHJhY2VDYXRlZ29yaWVzLkxheW91dCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLnJlcXVlc3RMYXlvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2lzTGF5b3V0VmFsaWQgPSBmYWxzZTtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXF1ZXN0TGF5b3V0LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnJlc29sdmVTaXplQW5kU3RhdGUgPSBmdW5jdGlvbiAoc2l6ZSwgc3BlY1NpemUsIHNwZWNNb2RlLCBjaGlsZE1lYXN1cmVkU3RhdGUpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHNpemU7XG4gICAgICAgIHN3aXRjaCAoc3BlY01vZGUpIHtcbiAgICAgICAgICAgIGNhc2Ugdmlld19iYXNlXzEubGF5b3V0LlVOU1BFQ0lGSUVEOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGguY2VpbChzaXplKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2Ugdmlld19iYXNlXzEubGF5b3V0LkFUX01PU1Q6XG4gICAgICAgICAgICAgICAgaWYgKHNwZWNTaXplIDwgc2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLmNlaWwoc3BlY1NpemUpIHwgdmlld19iYXNlXzEubGF5b3V0Lk1FQVNVUkVEX1NUQVRFX1RPT19TTUFMTDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHZpZXdfYmFzZV8xLmxheW91dC5FWEFDVExZOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGguY2VpbChzcGVjU2l6ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdCB8IChjaGlsZE1lYXN1cmVkU3RhdGUgJiB2aWV3X2Jhc2VfMS5sYXlvdXQuTUVBU1VSRURfU1RBVEVfTUFTSyk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLmNvbWJpbmVNZWFzdXJlZFN0YXRlcyA9IGZ1bmN0aW9uIChjdXJTdGF0ZSwgbmV3U3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIGN1clN0YXRlIHwgbmV3U3RhdGU7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLmxheW91dENoaWxkID0gZnVuY3Rpb24gKHBhcmVudCwgY2hpbGQsIGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSwgc2V0RnJhbWUpIHtcbiAgICAgICAgaWYgKHNldEZyYW1lID09PSB2b2lkIDApIHsgc2V0RnJhbWUgPSB0cnVlOyB9XG4gICAgICAgIGlmICghY2hpbGQgfHwgY2hpbGQuaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hpbGRTdHlsZSA9IGNoaWxkLnN0eWxlO1xuICAgICAgICB2YXIgY2hpbGRUb3A7XG4gICAgICAgIHZhciBjaGlsZExlZnQ7XG4gICAgICAgIHZhciBjaGlsZFdpZHRoID0gY2hpbGQuZ2V0TWVhc3VyZWRXaWR0aCgpO1xuICAgICAgICB2YXIgY2hpbGRIZWlnaHQgPSBjaGlsZC5nZXRNZWFzdXJlZEhlaWdodCgpO1xuICAgICAgICB2YXIgZWZmZWN0aXZlTWFyZ2luVG9wID0gY2hpbGQuZWZmZWN0aXZlTWFyZ2luVG9wO1xuICAgICAgICB2YXIgZWZmZWN0aXZlTWFyZ2luQm90dG9tID0gY2hpbGQuZWZmZWN0aXZlTWFyZ2luQm90dG9tO1xuICAgICAgICB2YXIgdkFsaWdubWVudDtcbiAgICAgICAgaWYgKGNoaWxkLmVmZmVjdGl2ZUhlaWdodCA+PSAwICYmIGNoaWxkU3R5bGUudmVydGljYWxBbGlnbm1lbnQgPT09IFwic3RyZXRjaFwiKSB7XG4gICAgICAgICAgICB2QWxpZ25tZW50ID0gXCJtaWRkbGVcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZBbGlnbm1lbnQgPSBjaGlsZFN0eWxlLnZlcnRpY2FsQWxpZ25tZW50O1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAodkFsaWdubWVudCkge1xuICAgICAgICAgICAgY2FzZSBcInRvcFwiOlxuICAgICAgICAgICAgICAgIGNoaWxkVG9wID0gdG9wICsgZWZmZWN0aXZlTWFyZ2luVG9wO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIm1pZGRsZVwiOlxuICAgICAgICAgICAgICAgIGNoaWxkVG9wID0gdG9wICsgKGJvdHRvbSAtIHRvcCAtIGNoaWxkSGVpZ2h0ICsgKGVmZmVjdGl2ZU1hcmdpblRvcCAtIGVmZmVjdGl2ZU1hcmdpbkJvdHRvbSkpIC8gMjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJib3R0b21cIjpcbiAgICAgICAgICAgICAgICBjaGlsZFRvcCA9IGJvdHRvbSAtIGNoaWxkSGVpZ2h0IC0gZWZmZWN0aXZlTWFyZ2luQm90dG9tO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInN0cmV0Y2hcIjpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY2hpbGRUb3AgPSB0b3AgKyBlZmZlY3RpdmVNYXJnaW5Ub3A7XG4gICAgICAgICAgICAgICAgY2hpbGRIZWlnaHQgPSBib3R0b20gLSB0b3AgLSAoZWZmZWN0aXZlTWFyZ2luVG9wICsgZWZmZWN0aXZlTWFyZ2luQm90dG9tKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgZWZmZWN0aXZlTWFyZ2luTGVmdCA9IGNoaWxkLmVmZmVjdGl2ZU1hcmdpbkxlZnQ7XG4gICAgICAgIHZhciBlZmZlY3RpdmVNYXJnaW5SaWdodCA9IGNoaWxkLmVmZmVjdGl2ZU1hcmdpblJpZ2h0O1xuICAgICAgICB2YXIgaEFsaWdubWVudDtcbiAgICAgICAgaWYgKGNoaWxkLmVmZmVjdGl2ZVdpZHRoID49IDAgJiYgY2hpbGRTdHlsZS5ob3Jpem9udGFsQWxpZ25tZW50ID09PSBcInN0cmV0Y2hcIikge1xuICAgICAgICAgICAgaEFsaWdubWVudCA9IFwiY2VudGVyXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBoQWxpZ25tZW50ID0gY2hpbGRTdHlsZS5ob3Jpem9udGFsQWxpZ25tZW50O1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAoaEFsaWdubWVudCkge1xuICAgICAgICAgICAgY2FzZSBcImxlZnRcIjpcbiAgICAgICAgICAgICAgICBjaGlsZExlZnQgPSBsZWZ0ICsgZWZmZWN0aXZlTWFyZ2luTGVmdDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJjZW50ZXJcIjpcbiAgICAgICAgICAgICAgICBjaGlsZExlZnQgPSBsZWZ0ICsgKHJpZ2h0IC0gbGVmdCAtIGNoaWxkV2lkdGggKyAoZWZmZWN0aXZlTWFyZ2luTGVmdCAtIGVmZmVjdGl2ZU1hcmdpblJpZ2h0KSkgLyAyO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInJpZ2h0XCI6XG4gICAgICAgICAgICAgICAgY2hpbGRMZWZ0ID0gcmlnaHQgLSBjaGlsZFdpZHRoIC0gZWZmZWN0aXZlTWFyZ2luUmlnaHQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic3RyZXRjaFwiOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBjaGlsZExlZnQgPSBsZWZ0ICsgZWZmZWN0aXZlTWFyZ2luTGVmdDtcbiAgICAgICAgICAgICAgICBjaGlsZFdpZHRoID0gcmlnaHQgLSBsZWZ0IC0gKGVmZmVjdGl2ZU1hcmdpbkxlZnQgKyBlZmZlY3RpdmVNYXJnaW5SaWdodCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoaWxkUmlnaHQgPSBNYXRoLnJvdW5kKGNoaWxkTGVmdCArIGNoaWxkV2lkdGgpO1xuICAgICAgICB2YXIgY2hpbGRCb3R0b20gPSBNYXRoLnJvdW5kKGNoaWxkVG9wICsgY2hpbGRIZWlnaHQpO1xuICAgICAgICBjaGlsZExlZnQgPSBNYXRoLnJvdW5kKGNoaWxkTGVmdCk7XG4gICAgICAgIGNoaWxkVG9wID0gTWF0aC5yb3VuZChjaGlsZFRvcCk7XG4gICAgICAgIGlmICh2aWV3X2Jhc2VfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdmlld19iYXNlXzEudHJhY2VXcml0ZShjaGlsZC5wYXJlbnQgKyBcIiA6bGF5b3V0Q2hpbGQ6IFwiICsgY2hpbGQgKyBcIiBcIiArIGNoaWxkTGVmdCArIFwiLCBcIiArIGNoaWxkVG9wICsgXCIsIFwiICsgY2hpbGRSaWdodCArIFwiLCBcIiArIGNoaWxkQm90dG9tLCB2aWV3X2Jhc2VfMS50cmFjZUNhdGVnb3JpZXMuTGF5b3V0KTtcbiAgICAgICAgfVxuICAgICAgICBjaGlsZC5sYXlvdXQoY2hpbGRMZWZ0LCBjaGlsZFRvcCwgY2hpbGRSaWdodCwgY2hpbGRCb3R0b20sIHNldEZyYW1lKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ubWVhc3VyZUNoaWxkID0gZnVuY3Rpb24gKHBhcmVudCwgY2hpbGQsIHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciBtZWFzdXJlV2lkdGggPSAwO1xuICAgICAgICB2YXIgbWVhc3VyZUhlaWdodCA9IDA7XG4gICAgICAgIGlmIChjaGlsZCAmJiAhY2hpbGQuaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgIHZhciB3aWR0aFNwZWMgPSBwYXJlbnQgPyBwYXJlbnQuX2N1cnJlbnRXaWR0aE1lYXN1cmVTcGVjIDogd2lkdGhNZWFzdXJlU3BlYztcbiAgICAgICAgICAgIHZhciBoZWlnaHRTcGVjID0gcGFyZW50ID8gcGFyZW50Ll9jdXJyZW50SGVpZ2h0TWVhc3VyZVNwZWMgOiBoZWlnaHRNZWFzdXJlU3BlYztcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IHZpZXdfYmFzZV8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhTcGVjKTtcbiAgICAgICAgICAgIHZhciB3aWR0aE1vZGUgPSB2aWV3X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKHdpZHRoU3BlYyk7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gdmlld19iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRTcGVjKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHRNb2RlID0gdmlld19iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRTcGVjKTtcbiAgICAgICAgICAgIGNoaWxkLl91cGRhdGVFZmZlY3RpdmVMYXlvdXRWYWx1ZXMod2lkdGgsIHdpZHRoTW9kZSwgaGVpZ2h0LCBoZWlnaHRNb2RlKTtcbiAgICAgICAgICAgIHZhciBzdHlsZSA9IGNoaWxkLnN0eWxlO1xuICAgICAgICAgICAgdmFyIGhvcml6b250YWxNYXJnaW5zID0gY2hpbGQuZWZmZWN0aXZlTWFyZ2luTGVmdCArIGNoaWxkLmVmZmVjdGl2ZU1hcmdpblJpZ2h0O1xuICAgICAgICAgICAgdmFyIHZlcnRpY2FsTWFyZ2lucyA9IGNoaWxkLmVmZmVjdGl2ZU1hcmdpblRvcCArIGNoaWxkLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbTtcbiAgICAgICAgICAgIHZhciBjaGlsZFdpZHRoTWVhc3VyZVNwZWMgPSBWaWV3Q29tbW9uLmdldE1lYXN1cmVTcGVjKHdpZHRoTWVhc3VyZVNwZWMsIGhvcml6b250YWxNYXJnaW5zLCBjaGlsZC5lZmZlY3RpdmVXaWR0aCwgc3R5bGUuaG9yaXpvbnRhbEFsaWdubWVudCA9PT0gXCJzdHJldGNoXCIpO1xuICAgICAgICAgICAgdmFyIGNoaWxkSGVpZ2h0TWVhc3VyZVNwZWMgPSBWaWV3Q29tbW9uLmdldE1lYXN1cmVTcGVjKGhlaWdodE1lYXN1cmVTcGVjLCB2ZXJ0aWNhbE1hcmdpbnMsIGNoaWxkLmVmZmVjdGl2ZUhlaWdodCwgc3R5bGUudmVydGljYWxBbGlnbm1lbnQgPT09IFwic3RyZXRjaFwiKTtcbiAgICAgICAgICAgIGlmICh2aWV3X2Jhc2VfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHZpZXdfYmFzZV8xLnRyYWNlV3JpdGUoY2hpbGQucGFyZW50ICsgXCIgOm1lYXN1cmVDaGlsZDogXCIgKyBjaGlsZCArIFwiIFwiICsgdmlld19iYXNlXzEubGF5b3V0Lm1lYXN1cmVTcGVjVG9TdHJpbmcoY2hpbGRXaWR0aE1lYXN1cmVTcGVjKSArIFwiLCBcIiArIHZpZXdfYmFzZV8xLmxheW91dC5tZWFzdXJlU3BlY1RvU3RyaW5nKGNoaWxkSGVpZ2h0TWVhc3VyZVNwZWMpICsgXCJ9XCIsIHZpZXdfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5MYXlvdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hpbGQubWVhc3VyZShjaGlsZFdpZHRoTWVhc3VyZVNwZWMsIGNoaWxkSGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgbWVhc3VyZVdpZHRoID0gTWF0aC5yb3VuZChjaGlsZC5nZXRNZWFzdXJlZFdpZHRoKCkgKyBob3Jpem9udGFsTWFyZ2lucyk7XG4gICAgICAgICAgICBtZWFzdXJlSGVpZ2h0ID0gTWF0aC5yb3VuZChjaGlsZC5nZXRNZWFzdXJlZEhlaWdodCgpICsgdmVydGljYWxNYXJnaW5zKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBtZWFzdXJlZFdpZHRoOiBtZWFzdXJlV2lkdGgsIG1lYXN1cmVkSGVpZ2h0OiBtZWFzdXJlSGVpZ2h0IH07XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLmdldE1lYXN1cmVTcGVjID0gZnVuY3Rpb24gKHBhcmVudFNwZWMsIG1hcmdpbnMsIGNoaWxkTGVuZ3RoLCBzdHJldGNoZWQpIHtcbiAgICAgICAgdmFyIHBhcmVudExlbmd0aCA9IHZpZXdfYmFzZV8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUocGFyZW50U3BlYyk7XG4gICAgICAgIHZhciBwYXJlbnRTcGVjTW9kZSA9IHZpZXdfYmFzZV8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUocGFyZW50U3BlYyk7XG4gICAgICAgIHZhciByZXN1bHRTaXplO1xuICAgICAgICB2YXIgcmVzdWx0TW9kZTtcbiAgICAgICAgaWYgKGNoaWxkTGVuZ3RoID49IDApIHtcbiAgICAgICAgICAgIHJlc3VsdFNpemUgPSBwYXJlbnRTcGVjTW9kZSA9PT0gdmlld19iYXNlXzEubGF5b3V0LlVOU1BFQ0lGSUVEID8gY2hpbGRMZW5ndGggOiBNYXRoLm1pbihwYXJlbnRMZW5ndGgsIGNoaWxkTGVuZ3RoKTtcbiAgICAgICAgICAgIHJlc3VsdE1vZGUgPSB2aWV3X2Jhc2VfMS5sYXlvdXQuRVhBQ1RMWTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHN3aXRjaCAocGFyZW50U3BlY01vZGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIHZpZXdfYmFzZV8xLmxheW91dC5FWEFDVExZOlxuICAgICAgICAgICAgICAgICAgICByZXN1bHRTaXplID0gTWF0aC5tYXgoMCwgcGFyZW50TGVuZ3RoIC0gbWFyZ2lucyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdE1vZGUgPSBzdHJldGNoZWQgPyB2aWV3X2Jhc2VfMS5sYXlvdXQuRVhBQ1RMWSA6IHZpZXdfYmFzZV8xLmxheW91dC5BVF9NT1NUO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIHZpZXdfYmFzZV8xLmxheW91dC5BVF9NT1NUOlxuICAgICAgICAgICAgICAgICAgICByZXN1bHRTaXplID0gTWF0aC5tYXgoMCwgcGFyZW50TGVuZ3RoIC0gbWFyZ2lucyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdE1vZGUgPSB2aWV3X2Jhc2VfMS5sYXlvdXQuQVRfTU9TVDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSB2aWV3X2Jhc2VfMS5sYXlvdXQuVU5TUEVDSUZJRUQ6XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFNpemUgPSAwO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRNb2RlID0gdmlld19iYXNlXzEubGF5b3V0LlVOU1BFQ0lGSUVEO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmlld19iYXNlXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhyZXN1bHRTaXplLCByZXN1bHRNb2RlKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9zZXRDdXJyZW50TWVhc3VyZVNwZWNzID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciBjaGFuZ2VkID0gdGhpcy5fY3VycmVudFdpZHRoTWVhc3VyZVNwZWMgIT09IHdpZHRoTWVhc3VyZVNwZWMgfHwgdGhpcy5fY3VycmVudEhlaWdodE1lYXN1cmVTcGVjICE9PSBoZWlnaHRNZWFzdXJlU3BlYztcbiAgICAgICAgdGhpcy5fY3VycmVudFdpZHRoTWVhc3VyZVNwZWMgPSB3aWR0aE1lYXN1cmVTcGVjO1xuICAgICAgICB0aGlzLl9jdXJyZW50SGVpZ2h0TWVhc3VyZVNwZWMgPSBoZWlnaHRNZWFzdXJlU3BlYztcbiAgICAgICAgcmV0dXJuIGNoYW5nZWQ7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fZ2V0Q3VycmVudExheW91dEJvdW5kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgbGVmdDogMCwgdG9wOiAwLCByaWdodDogMCwgYm90dG9tOiAwIH07XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fc2V0Q3VycmVudExheW91dEJvdW5kcyA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgdGhpcy5faXNMYXlvdXRWYWxpZCA9IHRydWU7XG4gICAgICAgIHZhciBib3VuZHNDaGFuZ2VkID0gdGhpcy5fb2xkTGVmdCAhPT0gbGVmdCB8fCB0aGlzLl9vbGRUb3AgIT09IHRvcCB8fCB0aGlzLl9vbGRSaWdodCAhPT0gcmlnaHQgfHwgdGhpcy5fb2xkQm90dG9tICE9PSBib3R0b207XG4gICAgICAgIHZhciBzaXplQ2hhbmdlZCA9ICh0aGlzLl9vbGRSaWdodCAtIHRoaXMuX29sZExlZnQgIT09IHJpZ2h0IC0gbGVmdCkgfHwgKHRoaXMuX29sZEJvdHRvbSAtIHRoaXMuX29sZFRvcCAhPT0gYm90dG9tIC0gdG9wKTtcbiAgICAgICAgdGhpcy5fb2xkTGVmdCA9IGxlZnQ7XG4gICAgICAgIHRoaXMuX29sZFRvcCA9IHRvcDtcbiAgICAgICAgdGhpcy5fb2xkUmlnaHQgPSByaWdodDtcbiAgICAgICAgdGhpcy5fb2xkQm90dG9tID0gYm90dG9tO1xuICAgICAgICByZXR1cm4geyBib3VuZHNDaGFuZ2VkOiBib3VuZHNDaGFuZ2VkLCBzaXplQ2hhbmdlZDogc2l6ZUNoYW5nZWQgfTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmVhY2hDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmVhY2hDaGlsZFZpZXcoY2FsbGJhY2spO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZWFjaENoaWxkVmlldyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2dldE5hdGl2ZVZpZXdzQ291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc0FkZGVkVG9OYXRpdmVWaXN1YWxUcmVlID8gMSA6IDA7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fZWFjaExheW91dFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKHRoaXMpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZm9jdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRTYWZlQXJlYUluc2V0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgbGVmdDogMCwgdG9wOiAwLCByaWdodDogMCwgYm90dG9tOiAwIH07XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRMb2NhdGlvbkluV2luZG93ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0TG9jYXRpb25PblNjcmVlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldExvY2F0aW9uUmVsYXRpdmVUbyA9IGZ1bmN0aW9uIChvdGhlclZpZXcpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldEFjdHVhbFNpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjdXJyZW50Qm91bmRzID0gdGhpcy5fZ2V0Q3VycmVudExheW91dEJvdW5kcygpO1xuICAgICAgICBpZiAoIWN1cnJlbnRCb3VuZHMpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHdpZHRoOiB2aWV3X2Jhc2VfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhjdXJyZW50Qm91bmRzLnJpZ2h0IC0gY3VycmVudEJvdW5kcy5sZWZ0KSxcbiAgICAgICAgICAgIGhlaWdodDogdmlld19iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoY3VycmVudEJvdW5kcy5ib3R0b20gLSBjdXJyZW50Qm91bmRzLnRvcCksXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5hbmltYXRlID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVBbmltYXRpb24oYW5pbWF0aW9uKS5wbGF5KCk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5jcmVhdGVBbmltYXRpb24gPSBmdW5jdGlvbiAoYW5pbWF0aW9uKSB7XG4gICAgICAgIGVuc3VyZUFuaW1hdGlvbk1vZHVsZSgpO1xuICAgICAgICBpZiAoIXRoaXMuX2xvY2FsQW5pbWF0aW9ucykge1xuICAgICAgICAgICAgdGhpcy5fbG9jYWxBbmltYXRpb25zID0gbmV3IFNldCgpO1xuICAgICAgICB9XG4gICAgICAgIGFuaW1hdGlvbi50YXJnZXQgPSB0aGlzO1xuICAgICAgICB2YXIgYW5pbSA9IG5ldyBhbmltYXRpb25Nb2R1bGUuQW5pbWF0aW9uKFthbmltYXRpb25dKTtcbiAgICAgICAgdGhpcy5fbG9jYWxBbmltYXRpb25zLmFkZChhbmltKTtcbiAgICAgICAgcmV0dXJuIGFuaW07XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fcmVtb3ZlQW5pbWF0aW9uID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xuICAgICAgICB2YXIgbG9jYWxBbmltYXRpb25zID0gdGhpcy5fbG9jYWxBbmltYXRpb25zO1xuICAgICAgICBpZiAobG9jYWxBbmltYXRpb25zICYmIGxvY2FsQW5pbWF0aW9ucy5oYXMoYW5pbWF0aW9uKSkge1xuICAgICAgICAgICAgbG9jYWxBbmltYXRpb25zLmRlbGV0ZShhbmltYXRpb24pO1xuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbi5pc1BsYXlpbmcpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb24uY2FuY2VsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLl9sb2NhbEFuaW1hdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMuX2xvY2FsQW5pbWF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChhKSB7IHJldHVybiBfdGhpcy5fcmVtb3ZlQW5pbWF0aW9uKGEpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3NldE5hdGl2ZVZpZXdGcmFtZSA9IGZ1bmN0aW9uIChuYXRpdmVWaWV3LCBmcmFtZSkge1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2dldFZhbHVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgVmlldy5fZ2V0VmFsdWUgaXMgb2Jzb2xldGUuIFRoZXJlIGlzIGEgbmV3IHByb3BlcnR5IHN5c3RlbS5cIik7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fc2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBWaWV3Ll9zZXRWYWx1ZSBpcyBvYnNvbGV0ZS4gVGhlcmUgaXMgYSBuZXcgcHJvcGVydHkgc3lzdGVtLlwiKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl91cGRhdGVFZmZlY3RpdmVMYXlvdXRWYWx1ZXMgPSBmdW5jdGlvbiAocGFyZW50V2lkdGhNZWFzdXJlU2l6ZSwgcGFyZW50V2lkdGhNZWFzdXJlTW9kZSwgcGFyZW50SGVpZ2h0TWVhc3VyZVNpemUsIHBhcmVudEhlaWdodE1lYXN1cmVNb2RlKSB7XG4gICAgICAgIHZhciBzdHlsZSA9IHRoaXMuc3R5bGU7XG4gICAgICAgIHZhciBhdmFpbGFibGVXaWR0aCA9IHBhcmVudFdpZHRoTWVhc3VyZU1vZGUgPT09IHZpZXdfYmFzZV8xLmxheW91dC5VTlNQRUNJRklFRCA/IC0xIDogcGFyZW50V2lkdGhNZWFzdXJlU2l6ZTtcbiAgICAgICAgdGhpcy5lZmZlY3RpdmVXaWR0aCA9IHN0eWxlX3Byb3BlcnRpZXNfMS5QZXJjZW50TGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHN0eWxlLndpZHRoLCAtMiwgYXZhaWxhYmxlV2lkdGgpO1xuICAgICAgICB0aGlzLmVmZmVjdGl2ZU1hcmdpbkxlZnQgPSBzdHlsZV9wcm9wZXJ0aWVzXzEuUGVyY2VudExlbmd0aC50b0RldmljZVBpeGVscyhzdHlsZS5tYXJnaW5MZWZ0LCAwLCBhdmFpbGFibGVXaWR0aCk7XG4gICAgICAgIHRoaXMuZWZmZWN0aXZlTWFyZ2luUmlnaHQgPSBzdHlsZV9wcm9wZXJ0aWVzXzEuUGVyY2VudExlbmd0aC50b0RldmljZVBpeGVscyhzdHlsZS5tYXJnaW5SaWdodCwgMCwgYXZhaWxhYmxlV2lkdGgpO1xuICAgICAgICB2YXIgYXZhaWxhYmxlSGVpZ2h0ID0gcGFyZW50SGVpZ2h0TWVhc3VyZU1vZGUgPT09IHZpZXdfYmFzZV8xLmxheW91dC5VTlNQRUNJRklFRCA/IC0xIDogcGFyZW50SGVpZ2h0TWVhc3VyZVNpemU7XG4gICAgICAgIHRoaXMuZWZmZWN0aXZlSGVpZ2h0ID0gc3R5bGVfcHJvcGVydGllc18xLlBlcmNlbnRMZW5ndGgudG9EZXZpY2VQaXhlbHMoc3R5bGUuaGVpZ2h0LCAtMiwgYXZhaWxhYmxlSGVpZ2h0KTtcbiAgICAgICAgdGhpcy5lZmZlY3RpdmVNYXJnaW5Ub3AgPSBzdHlsZV9wcm9wZXJ0aWVzXzEuUGVyY2VudExlbmd0aC50b0RldmljZVBpeGVscyhzdHlsZS5tYXJnaW5Ub3AsIDAsIGF2YWlsYWJsZUhlaWdodCk7XG4gICAgICAgIHRoaXMuZWZmZWN0aXZlTWFyZ2luQm90dG9tID0gc3R5bGVfcHJvcGVydGllc18xLlBlcmNlbnRMZW5ndGgudG9EZXZpY2VQaXhlbHMoc3R5bGUubWFyZ2luQm90dG9tLCAwLCBhdmFpbGFibGVIZWlnaHQpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3NldE5hdGl2ZUNsaXBUb0JvdW5kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9yZWRyYXdOYXRpdmVCYWNrZ3JvdW5kID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fb25BdHRhY2hlZFRvV2luZG93ID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX29uRGV0YWNoZWRGcm9tV2luZG93ID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2hhc0FuY2VzdG9yVmlldyA9IGZ1bmN0aW9uIChhbmNlc3RvclZpZXcpIHtcbiAgICAgICAgdmFyIG1hdGNoZXIgPSBmdW5jdGlvbiAodmlldykgeyByZXR1cm4gdmlldyA9PT0gYW5jZXN0b3JWaWV3OyB9O1xuICAgICAgICBmb3IgKHZhciBwYXJlbnRfMiA9IHRoaXMucGFyZW50OyBwYXJlbnRfMiAhPSBudWxsOyBwYXJlbnRfMiA9IHBhcmVudF8yLnBhcmVudCkge1xuICAgICAgICAgICAgaWYgKG1hdGNoZXIocGFyZW50XzIpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5sYXlvdXRDaGFuZ2VkRXZlbnQgPSBcImxheW91dENoYW5nZWRcIjtcbiAgICBWaWV3Q29tbW9uLnNob3duTW9kYWxseUV2ZW50ID0gXCJzaG93bk1vZGFsbHlcIjtcbiAgICBWaWV3Q29tbW9uLnNob3dpbmdNb2RhbGx5RXZlbnQgPSBcInNob3dpbmdNb2RhbGx5XCI7XG4gICAgcmV0dXJuIFZpZXdDb21tb247XG59KHZpZXdfYmFzZV8xLlZpZXdCYXNlKSk7XG5leHBvcnRzLlZpZXdDb21tb24gPSBWaWV3Q29tbW9uO1xuZXhwb3J0cy5hdXRvbWF0aW9uVGV4dFByb3BlcnR5ID0gbmV3IHZpZXdfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJhdXRvbWF0aW9uVGV4dFwiIH0pO1xuZXhwb3J0cy5hdXRvbWF0aW9uVGV4dFByb3BlcnR5LnJlZ2lzdGVyKFZpZXdDb21tb24pO1xuZXhwb3J0cy5vcmlnaW5YUHJvcGVydHkgPSBuZXcgdmlld19iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcIm9yaWdpblhcIiwgZGVmYXVsdFZhbHVlOiAwLjUsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VGbG9hdCh2KTsgfSB9KTtcbmV4cG9ydHMub3JpZ2luWFByb3BlcnR5LnJlZ2lzdGVyKFZpZXdDb21tb24pO1xuZXhwb3J0cy5vcmlnaW5ZUHJvcGVydHkgPSBuZXcgdmlld19iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcIm9yaWdpbllcIiwgZGVmYXVsdFZhbHVlOiAwLjUsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VGbG9hdCh2KTsgfSB9KTtcbmV4cG9ydHMub3JpZ2luWVByb3BlcnR5LnJlZ2lzdGVyKFZpZXdDb21tb24pO1xuZXhwb3J0cy5pc0VuYWJsZWRQcm9wZXJ0eSA9IG5ldyB2aWV3X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpc0VuYWJsZWRcIixcbiAgICBkZWZhdWx0VmFsdWU6IHRydWUsXG4gICAgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0Ll9nb1RvVmlzdWFsU3RhdGUobmV3VmFsdWUgPyBcIm5vcm1hbFwiIDogXCJkaXNhYmxlZFwiKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuaXNFbmFibGVkUHJvcGVydHkucmVnaXN0ZXIoVmlld0NvbW1vbik7XG5leHBvcnRzLmlzVXNlckludGVyYWN0aW9uRW5hYmxlZFByb3BlcnR5ID0gbmV3IHZpZXdfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJpc1VzZXJJbnRlcmFjdGlvbkVuYWJsZWRcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLCB2YWx1ZUNvbnZlcnRlcjogdmlld19iYXNlXzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuaXNVc2VySW50ZXJhY3Rpb25FbmFibGVkUHJvcGVydHkucmVnaXN0ZXIoVmlld0NvbW1vbik7XG5leHBvcnRzLmlvc092ZXJmbG93U2FmZUFyZWFQcm9wZXJ0eSA9IG5ldyB2aWV3X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaW9zT3ZlcmZsb3dTYWZlQXJlYVwiLCBkZWZhdWx0VmFsdWU6IGZhbHNlLCB2YWx1ZUNvbnZlcnRlcjogdmlld19iYXNlXzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuaW9zT3ZlcmZsb3dTYWZlQXJlYVByb3BlcnR5LnJlZ2lzdGVyKFZpZXdDb21tb24pO1xuZXhwb3J0cy5pb3NPdmVyZmxvd1NhZmVBcmVhRW5hYmxlZFByb3BlcnR5ID0gbmV3IHZpZXdfYmFzZV8xLkluaGVyaXRlZFByb3BlcnR5KHsgbmFtZTogXCJpb3NPdmVyZmxvd1NhZmVBcmVhRW5hYmxlZFwiLCBkZWZhdWx0VmFsdWU6IHRydWUsIHZhbHVlQ29udmVydGVyOiB2aWV3X2Jhc2VfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5pb3NPdmVyZmxvd1NhZmVBcmVhRW5hYmxlZFByb3BlcnR5LnJlZ2lzdGVyKFZpZXdDb21tb24pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dmlldy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vdmlldy1jb21tb25cIik7XG52YXIgc3R5bGVfcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvc3R5bGUtcHJvcGVydGllc1wiKTtcbnZhciBiYWNrZ3JvdW5kXzEgPSByZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9iYWNrZ3JvdW5kXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uLy4uL3Byb2ZpbGluZ1wiKTtcbnZhciBmcmFtZV9zdGFja18xID0gcmVxdWlyZShcIi4uLy4uL2ZyYW1lL2ZyYW1lLXN0YWNrXCIpO1xudmFyIGFwcGxpY2F0aW9uXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vYXBwbGljYXRpb25cIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9wbGF0Zm9ybVwiKTtcbnZhciBsYXp5XzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbHMvbGF6eVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3ZpZXctY29tbW9uXCIpKTtcbnZhciBET01JRCA9IFwiX2RvbUlkXCI7XG52YXIgYW5kcm9pZEJhY2tQcmVzc2VkRXZlbnQgPSBcImFuZHJvaWRCYWNrUHJlc3NlZFwiO1xudmFyIHNob3J0QW5pbVRpbWUgPSAxNzY5NDcyMDtcbnZhciBzdGF0ZVByZXNzZWQgPSAxNjg0MjkxOTtcbnZhciBzdGF0ZUVuYWJsZWQgPSAxNjg0MjkxMDtcbnZhciBzZGtWZXJzaW9uID0gbGF6eV8xLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcGFyc2VJbnQocGxhdGZvcm1fMS5kZXZpY2Uuc2RrVmVyc2lvbik7IH0pO1xudmFyIG1vZGFsTWFwID0gbmV3IE1hcCgpO1xudmFyIFRvdWNoTGlzdGVuZXI7XG52YXIgRGlhbG9nRnJhZ21lbnQ7XG5mdW5jdGlvbiBpbml0aWFsaXplVG91Y2hMaXN0ZW5lcigpIHtcbiAgICBpZiAoVG91Y2hMaXN0ZW5lcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBUb3VjaExpc3RlbmVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhUb3VjaExpc3RlbmVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gVG91Y2hMaXN0ZW5lckltcGwob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG5ldyBXZWFrUmVmKG93bmVyKTtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFRvdWNoTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblRvdWNoID0gZnVuY3Rpb24gKHZpZXcsIGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyLmdldCgpO1xuICAgICAgICAgICAgaWYgKCFvd25lcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG93bmVyLmhhbmRsZUdlc3R1cmVUb3VjaChldmVudCk7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVmlldyA9IG93bmVyLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgICAgICBpZiAoIW5hdGl2ZVZpZXcgfHwgIW5hdGl2ZVZpZXcub25Ub3VjaEV2ZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXcub25Ub3VjaEV2ZW50KGV2ZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgVG91Y2hMaXN0ZW5lckltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWQudmlldy5WaWV3Lk9uVG91Y2hMaXN0ZW5lcl0pXG4gICAgICAgIF0sIFRvdWNoTGlzdGVuZXJJbXBsKTtcbiAgICAgICAgcmV0dXJuIFRvdWNoTGlzdGVuZXJJbXBsO1xuICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgIFRvdWNoTGlzdGVuZXIgPSBUb3VjaExpc3RlbmVySW1wbDtcbn1cbmZ1bmN0aW9uIGluaXRpYWxpemVEaWFsb2dGcmFnbWVudCgpIHtcbiAgICBpZiAoRGlhbG9nRnJhZ21lbnQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgRGlhbG9nSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhEaWFsb2dJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBEaWFsb2dJbXBsKGZyYWdtZW50LCBjb250ZXh0LCB0aGVtZVJlc0lkKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBjb250ZXh0LCB0aGVtZVJlc0lkKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIERpYWxvZ0ltcGwucHJvdG90eXBlLm9uRGV0YWNoZWRGcm9tV2luZG93ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkRldGFjaGVkRnJvbVdpbmRvdy5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5mcmFnbWVudCA9IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIERpYWxvZ0ltcGwucHJvdG90eXBlLm9uQmFja1ByZXNzZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMuZnJhZ21lbnQub3duZXI7XG4gICAgICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgICAgICBldmVudE5hbWU6IFwiYWN0aXZpdHlCYWNrUHJlc3NlZFwiLFxuICAgICAgICAgICAgICAgIG9iamVjdDogdmlldyxcbiAgICAgICAgICAgICAgICBhY3Rpdml0eTogdmlldy5fY29udGV4dCxcbiAgICAgICAgICAgICAgICBjYW5jZWw6IGZhbHNlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uXzEuYW5kcm9pZC5ub3RpZnkoYXJncyk7XG4gICAgICAgICAgICBpZiAoYXJncy5jYW5jZWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2aWV3Lm5vdGlmeShhcmdzKTtcbiAgICAgICAgICAgIGlmICghYXJncy5jYW5jZWwgJiYgIXZpZXcub25CYWNrUHJlc3NlZCgpKSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkJhY2tQcmVzc2VkLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBEaWFsb2dJbXBsO1xuICAgIH0oYW5kcm9pZC5hcHAuRGlhbG9nKSk7XG4gICAgdmFyIERpYWxvZ0ZyYWdtZW50SW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhEaWFsb2dGcmFnbWVudEltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIERpYWxvZ0ZyYWdtZW50SW1wbCgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBEaWFsb2dGcmFnbWVudEltcGwucHJvdG90eXBlLm9uQ3JlYXRlRGlhbG9nID0gZnVuY3Rpb24gKHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICAgICAgdmFyIG93bmVySWQgPSB0aGlzLmdldEFyZ3VtZW50cygpLmdldEludChET01JRCk7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IGdldE1vZGFsT3B0aW9ucyhvd25lcklkKTtcbiAgICAgICAgICAgIHRoaXMub3duZXIgPSBvcHRpb25zLm93bmVyO1xuICAgICAgICAgICAgdGhpcy5fZnVsbHNjcmVlbiA9IG9wdGlvbnMuZnVsbHNjcmVlbjtcbiAgICAgICAgICAgIHRoaXMuX2FuaW1hdGVkID0gb3B0aW9ucy5hbmltYXRlZDtcbiAgICAgICAgICAgIHRoaXMuX2NhbmNlbGFibGUgPSBvcHRpb25zLmNhbmNlbGFibGU7XG4gICAgICAgICAgICB0aGlzLl9zdHJldGNoZWQgPSBvcHRpb25zLnN0cmV0Y2hlZDtcbiAgICAgICAgICAgIHRoaXMuX2Rpc21pc3NDYWxsYmFjayA9IG9wdGlvbnMuZGlzbWlzc0NhbGxiYWNrO1xuICAgICAgICAgICAgdGhpcy5fc2hvd25DYWxsYmFjayA9IG9wdGlvbnMuc2hvd25DYWxsYmFjaztcbiAgICAgICAgICAgIHRoaXMuc2V0U3R5bGUoYW5kcm9pZHguZnJhZ21lbnQuYXBwLkRpYWxvZ0ZyYWdtZW50LlNUWUxFX05PX1RJVExFLCAwKTtcbiAgICAgICAgICAgIHZhciB0aGVtZSA9IHRoaXMuZ2V0VGhlbWUoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9mdWxsc2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgdGhlbWUgPSB0aGlzLmdldEFjdGl2aXR5KCkuZ2V0QXBwbGljYXRpb25JbmZvKCkudGhlbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGlhbG9nID0gbmV3IERpYWxvZ0ltcGwodGhpcywgdGhpcy5nZXRBY3Rpdml0eSgpLCB0aGVtZSk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2Z1bGxzY3JlZW4gJiYgIXRoaXMuX3N0cmV0Y2hlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMub3duZXIuaG9yaXpvbnRhbEFsaWdubWVudCA9IFwiY2VudGVyXCI7XG4gICAgICAgICAgICAgICAgdGhpcy5vd25lci52ZXJ0aWNhbEFsaWdubWVudCA9IFwibWlkZGxlXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm93bmVyLmhvcml6b250YWxBbGlnbm1lbnQgPSBcInN0cmV0Y2hcIjtcbiAgICAgICAgICAgICAgICB0aGlzLm93bmVyLnZlcnRpY2FsQWxpZ25tZW50ID0gXCJzdHJldGNoXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fYW5pbWF0ZWQpIHtcbiAgICAgICAgICAgICAgICBkaWFsb2dcbiAgICAgICAgICAgICAgICAgICAgLmdldFdpbmRvdygpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRXaW5kb3dBbmltYXRpb25zKGFuZHJvaWQuUi5zdHlsZS5BbmltYXRpb25fRGlhbG9nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRpYWxvZy5zZXRDYW5jZWxlZE9uVG91Y2hPdXRzaWRlKHRoaXMuX2NhbmNlbGFibGUpO1xuICAgICAgICAgICAgcmV0dXJuIGRpYWxvZztcbiAgICAgICAgfTtcbiAgICAgICAgRGlhbG9nRnJhZ21lbnRJbXBsLnByb3RvdHlwZS5vbkNyZWF0ZVZpZXcgPSBmdW5jdGlvbiAoaW5mbGF0ZXIsIGNvbnRhaW5lciwgc2F2ZWRJbnN0YW5jZVN0YXRlKSB7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgb3duZXIuX3NldHVwQXNSb290Vmlldyh0aGlzLmdldEFjdGl2aXR5KCkpO1xuICAgICAgICAgICAgb3duZXIuX2lzQWRkZWRUb05hdGl2ZVZpc3VhbFRyZWUgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIG93bmVyLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH07XG4gICAgICAgIERpYWxvZ0ZyYWdtZW50SW1wbC5wcm90b3R5cGUub25TdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUub25TdGFydC5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2Z1bGxzY3JlZW4pIHtcbiAgICAgICAgICAgICAgICB2YXIgd2luZG93XzEgPSB0aGlzLmdldERpYWxvZygpLmdldFdpbmRvdygpO1xuICAgICAgICAgICAgICAgIHZhciBsZW5ndGhfMSA9IGFuZHJvaWQudmlldy5WaWV3R3JvdXAuTGF5b3V0UGFyYW1zLk1BVENIX1BBUkVOVDtcbiAgICAgICAgICAgICAgICB3aW5kb3dfMS5zZXRMYXlvdXQobGVuZ3RoXzEsIGxlbmd0aF8xKTtcbiAgICAgICAgICAgICAgICB3aW5kb3dfMS5zZXRCYWNrZ3JvdW5kRHJhd2FibGUobmV3IGFuZHJvaWQuZ3JhcGhpY3MuZHJhd2FibGUuQ29sb3JEcmF3YWJsZShhbmRyb2lkLmdyYXBoaWNzLkNvbG9yLldISVRFKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgaWYgKG93bmVyICYmICFvd25lci5pc0xvYWRlZCkge1xuICAgICAgICAgICAgICAgIG93bmVyLmNhbGxMb2FkZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3Nob3duQ2FsbGJhY2soKTtcbiAgICAgICAgfTtcbiAgICAgICAgRGlhbG9nRnJhZ21lbnRJbXBsLnByb3RvdHlwZS5vbkRpc21pc3MgPSBmdW5jdGlvbiAoZGlhbG9nKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uRGlzbWlzcy5jYWxsKHRoaXMsIGRpYWxvZyk7XG4gICAgICAgICAgICB2YXIgbWFuYWdlciA9IHRoaXMuZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgICAgICBpZiAobWFuYWdlcikge1xuICAgICAgICAgICAgICAgIHJlbW92ZU1vZGFsKHRoaXMub3duZXIuX2RvbUlkKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNtaXNzQ2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAob3duZXIgJiYgb3duZXIuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICBvd25lci5jYWxsVW5sb2FkZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRGlhbG9nRnJhZ21lbnRJbXBsLnByb3RvdHlwZS5vbkRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uRGVzdHJveS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgICAgIGlmIChvd25lci5pc0xvYWRlZCkge1xuICAgICAgICAgICAgICAgICAgICBvd25lci5jYWxsVW5sb2FkZWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb3duZXIuX2lzQWRkZWRUb05hdGl2ZVZpc3VhbFRyZWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBvd25lci5fdGVhckRvd25VSSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIERpYWxvZ0ZyYWdtZW50SW1wbDtcbiAgICB9KGFuZHJvaWR4LmZyYWdtZW50LmFwcC5EaWFsb2dGcmFnbWVudCkpO1xuICAgIERpYWxvZ0ZyYWdtZW50ID0gRGlhbG9nRnJhZ21lbnRJbXBsO1xufVxuZnVuY3Rpb24gc2F2ZU1vZGFsKG9wdGlvbnMpIHtcbiAgICBtb2RhbE1hcC5zZXQob3B0aW9ucy5vd25lci5fZG9tSWQsIG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gcmVtb3ZlTW9kYWwoZG9tSWQpIHtcbiAgICBtb2RhbE1hcC5kZWxldGUoZG9tSWQpO1xufVxuZnVuY3Rpb24gZ2V0TW9kYWxPcHRpb25zKGRvbUlkKSB7XG4gICAgcmV0dXJuIG1vZGFsTWFwLmdldChkb21JZCk7XG59XG52YXIgVmlldyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFZpZXcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVmlldygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBWaWV3LnByb3RvdHlwZS5fb2JzZXJ2ZSA9IGZ1bmN0aW9uICh0eXBlLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9vYnNlcnZlLmNhbGwodGhpcywgdHlwZSwgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICBpZiAodGhpcy5pc0xvYWRlZCAmJiAhdGhpcy50b3VjaExpc3RlbmVySXNTZXQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0T25Ub3VjaExpc3RlbmVyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLm9uID0gZnVuY3Rpb24gKGV2ZW50TmFtZXMsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub24uY2FsbCh0aGlzLCBldmVudE5hbWVzLCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgIHZhciBpc0xheW91dEV2ZW50ID0gdHlwZW9mIGV2ZW50TmFtZXMgPT09IFwic3RyaW5nXCIgPyBldmVudE5hbWVzLmluZGV4T2Yodmlld19jb21tb25fMS5WaWV3Q29tbW9uLmxheW91dENoYW5nZWRFdmVudCkgIT09IC0xIDogZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLmlzTG9hZGVkICYmICF0aGlzLmxheW91dENoYW5nZUxpc3RlbmVySXNTZXQgJiYgaXNMYXlvdXRFdmVudCkge1xuICAgICAgICAgICAgdGhpcy5zZXRPbkxheW91dENoYW5nZUxpc3RlbmVyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIChldmVudE5hbWVzLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9mZi5jYWxsKHRoaXMsIGV2ZW50TmFtZXMsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgdmFyIGlzTGF5b3V0RXZlbnQgPSB0eXBlb2YgZXZlbnROYW1lcyA9PT0gXCJzdHJpbmdcIiA/IGV2ZW50TmFtZXMuaW5kZXhPZih2aWV3X2NvbW1vbl8xLlZpZXdDb21tb24ubGF5b3V0Q2hhbmdlZEV2ZW50KSAhPT0gLTEgOiBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMuaXNMb2FkZWQgJiYgdGhpcy5sYXlvdXRDaGFuZ2VMaXN0ZW5lcklzU2V0ICYmIGlzTGF5b3V0RXZlbnQgJiYgIXRoaXMuaGFzTGlzdGVuZXJzKHZpZXdfY29tbW9uXzEuVmlld0NvbW1vbi5sYXlvdXRDaGFuZ2VkRXZlbnQpKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQucmVtb3ZlT25MYXlvdXRDaGFuZ2VMaXN0ZW5lcih0aGlzLmxheW91dENoYW5nZUxpc3RlbmVyKTtcbiAgICAgICAgICAgIHRoaXMubGF5b3V0Q2hhbmdlTGlzdGVuZXJJc1NldCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5fZ2V0Q2hpbGRGcmFnbWVudE1hbmFnZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuX2dldFJvb3RGcmFnbWVudE1hbmFnZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fcm9vdE1hbmFnZXIgJiYgdGhpcy5fY29udGV4dCkge1xuICAgICAgICAgICAgdGhpcy5fcm9vdE1hbmFnZXIgPSB0aGlzLl9jb250ZXh0LmdldFN1cHBvcnRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fcm9vdE1hbmFnZXI7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5fZ2V0RnJhZ21lbnRNYW5hZ2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbWFuYWdlciA9IHRoaXMuX21hbmFnZXI7XG4gICAgICAgIGlmICghbWFuYWdlcikge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGZyYW1lT3JUYWJWaWV3SXRlbUZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICB3aGlsZSAodmlldykge1xuICAgICAgICAgICAgICAgIHZhciBkaWFsb2dGcmFnbWVudCA9IHZpZXcuX2RpYWxvZ0ZyYWdtZW50O1xuICAgICAgICAgICAgICAgIGlmIChkaWFsb2dGcmFnbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBtYW5hZ2VyID0gZGlhbG9nRnJhZ21lbnQuZ2V0Q2hpbGRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9oYXNGcmFnbWVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZyYW1lT3JUYWJWaWV3SXRlbUZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYW5hZ2VyID0gdmlldy5fZ2V0Q2hpbGRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZyYW1lT3JUYWJWaWV3SXRlbUZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmlldyA9IHZpZXcucGFyZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFtYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgbWFuYWdlciA9IHRoaXMuX2dldFJvb3RGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX21hbmFnZXIgPSBtYW5hZ2VyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtYW5hZ2VyO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX21hbmFnZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9yb290TWFuYWdlciA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5zZXRPblRvdWNoTGlzdGVuZXIoKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLm9uVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnRvdWNoTGlzdGVuZXJJc1NldCkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldE9uVG91Y2hMaXN0ZW5lcihudWxsKTtcbiAgICAgICAgICAgIHRoaXMudG91Y2hMaXN0ZW5lcklzU2V0ID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0Q2xpY2thYmxlKHRoaXMuX2lzQ2xpY2thYmxlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9tYW5hZ2VyID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcm9vdE1hbmFnZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uVW5sb2FkZWQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLm9uQmFja1ByZXNzZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3Btb3N0RnJhbWUgPSBmcmFtZV9zdGFja18xLnRvcG1vc3QoKTtcbiAgICAgICAgaWYgKHRvcG1vc3RGcmFtZSAmJiB0b3Btb3N0RnJhbWUuX2hhc0FuY2VzdG9yVmlldyh0aGlzKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRvcG1vc3RGcmFtZS5vbkJhY2tQcmVzc2VkKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuaGFuZGxlR2VzdHVyZVRvdWNoID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGZvciAodmFyIHR5cGUgaW4gdGhpcy5fZ2VzdHVyZU9ic2VydmVycykge1xuICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9nZXN0dXJlT2JzZXJ2ZXJzW3R5cGVdO1xuICAgICAgICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5hbmRyb2lkT25Ub3VjaEV2ZW50KGV2ZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudCBpbnN0YW5jZW9mIFZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmhhbmRsZUdlc3R1cmVUb3VjaChldmVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmhhc0dlc3R1cmVPYnNlcnZlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXN0dXJlT2JzZXJ2ZXJzICYmIE9iamVjdC5rZXlzKHRoaXMuX2dlc3R1cmVPYnNlcnZlcnMpLmxlbmd0aCA+IDA7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9pc0NsaWNrYWJsZSA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5pc0NsaWNrYWJsZSgpO1xuICAgICAgICBpZiAodGhpcy5oYXNMaXN0ZW5lcnModmlld19jb21tb25fMS5WaWV3Q29tbW9uLmxheW91dENoYW5nZWRFdmVudCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0T25MYXlvdXRDaGFuZ2VMaXN0ZW5lcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5sYXlvdXRDaGFuZ2VMaXN0ZW5lcklzU2V0KSB7XG4gICAgICAgICAgICB0aGlzLmxheW91dENoYW5nZUxpc3RlbmVySXNTZXQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5yZW1vdmVPbkxheW91dENoYW5nZUxpc3RlbmVyKHRoaXMubGF5b3V0Q2hhbmdlTGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5zZXRPblRvdWNoTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkIHx8ICF0aGlzLmhhc0dlc3R1cmVPYnNlcnZlcnMoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGluaXRpYWxpemVUb3VjaExpc3RlbmVyKCk7XG4gICAgICAgIHRoaXMudG91Y2hMaXN0ZW5lciA9IHRoaXMudG91Y2hMaXN0ZW5lciB8fCBuZXcgVG91Y2hMaXN0ZW5lcih0aGlzKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldE9uVG91Y2hMaXN0ZW5lcih0aGlzLnRvdWNoTGlzdGVuZXIpO1xuICAgICAgICB0aGlzLnRvdWNoTGlzdGVuZXJJc1NldCA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0Q2xpY2thYmxlKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0Q2xpY2thYmxlKHRoaXMuaXNVc2VySW50ZXJhY3Rpb25FbmFibGVkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuc2V0T25MYXlvdXRDaGFuZ2VMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdmFyIG93bmVyXzEgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5sYXlvdXRDaGFuZ2VMaXN0ZW5lcklzU2V0ID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubGF5b3V0Q2hhbmdlTGlzdGVuZXIgPSB0aGlzLmxheW91dENoYW5nZUxpc3RlbmVyIHx8IG5ldyBhbmRyb2lkLnZpZXcuVmlldy5PbkxheW91dENoYW5nZUxpc3RlbmVyKHtcbiAgICAgICAgICAgICAgICBvbkxheW91dENoYW5nZTogZnVuY3Rpb24gKHYsIGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSwgb2xkTGVmdCwgb2xkVG9wLCBvbGRSaWdodCwgb2xkQm90dG9tKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsZWZ0ICE9PSBvbGRMZWZ0IHx8IHRvcCAhPT0gb2xkVG9wIHx8IHJpZ2h0ICE9PSBvbGRSaWdodCB8fCBib3R0b20gIT09IG9sZEJvdHRvbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3duZXJfMS5fcmFpc2VMYXlvdXRDaGFuZ2VkRXZlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmFkZE9uTGF5b3V0Q2hhbmdlTGlzdGVuZXIodGhpcy5sYXlvdXRDaGFuZ2VMaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3LnByb3RvdHlwZSwgXCJpc0xheW91dFJlcXVpcmVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gIXRoaXMuaXNMYXlvdXRWYWxpZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXcucHJvdG90eXBlLCBcImlzTGF5b3V0VmFsaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gIXRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5pc0xheW91dFJlcXVlc3RlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlldy5wcm90b3R5cGUsIFwiX2hhc0ZyYWdtZW50c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBWaWV3LnByb3RvdHlwZS5sYXlvdXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQubGF5b3V0KGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLnJlcXVlc3RMYXlvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVxdWVzdExheW91dC5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQucmVxdWVzdExheW91dCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5tZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUubWVhc3VyZS5jYWxsKHRoaXMsIHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdGhpcy5vbk1lYXN1cmUod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUubGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmxheW91dC5jYWxsKHRoaXMsIGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgICAgIHRoaXMub25MYXlvdXQobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcubWVhc3VyZSh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICB0aGlzLnNldE1lYXN1cmVkRGltZW5zaW9uKHZpZXcuZ2V0TWVhc3VyZWRXaWR0aCgpLCB2aWV3LmdldE1lYXN1cmVkSGVpZ2h0KCkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5vbkxheW91dCA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB0aGlzLmxheW91dE5hdGl2ZVZpZXcobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuX2dldEN1cnJlbnRMYXlvdXRCb3VuZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgJiYgIXRoaXMuaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbGVmdDogdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldExlZnQoKSxcbiAgICAgICAgICAgICAgICB0b3A6IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRUb3AoKSxcbiAgICAgICAgICAgICAgICByaWdodDogdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFJpZ2h0KCksXG4gICAgICAgICAgICAgICAgYm90dG9tOiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0Qm90dG9tKClcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4geyBsZWZ0OiAwLCB0b3A6IDAsIHJpZ2h0OiAwLCBib3R0b206IDAgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuZ2V0TWVhc3VyZWRXaWR0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRNZWFzdXJlZFdpZHRoKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuZ2V0TWVhc3VyZWRXaWR0aC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuZ2V0TWVhc3VyZWRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0TWVhc3VyZWRIZWlnaHQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5nZXRNZWFzdXJlZEhlaWdodC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuZm9jdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQucmVxdWVzdEZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuZ2V0TG9jYXRpb25JbldpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgfHwgIXRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRXaW5kb3dUb2tlbigpKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXRpdmVBcnJheSA9IEFycmF5LmNyZWF0ZShcImludFwiLCAyKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldExvY2F0aW9uSW5XaW5kb3cobmF0aXZlQXJyYXkpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhuYXRpdmVBcnJheVswXSksXG4gICAgICAgICAgICB5OiB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKG5hdGl2ZUFycmF5WzFdKSxcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmdldExvY2F0aW9uT25TY3JlZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkIHx8ICF0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0V2luZG93VG9rZW4oKSkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmF0aXZlQXJyYXkgPSBBcnJheS5jcmVhdGUoXCJpbnRcIiwgMik7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRMb2NhdGlvbk9uU2NyZWVuKG5hdGl2ZUFycmF5KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMobmF0aXZlQXJyYXlbMF0pLFxuICAgICAgICAgICAgeTogdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhuYXRpdmVBcnJheVsxXSksXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5nZXRMb2NhdGlvblJlbGF0aXZlVG8gPSBmdW5jdGlvbiAob3RoZXJWaWV3KSB7XG4gICAgICAgIGlmICghdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkIHx8ICF0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0V2luZG93VG9rZW4oKSB8fFxuICAgICAgICAgICAgIW90aGVyVmlldyB8fCAhb3RoZXJWaWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQgfHwgIW90aGVyVmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFdpbmRvd1Rva2VuKCkgfHxcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRXaW5kb3dUb2tlbigpICE9PSBvdGhlclZpZXcubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRXaW5kb3dUb2tlbigpKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBteUFycmF5ID0gQXJyYXkuY3JlYXRlKFwiaW50XCIsIDIpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0TG9jYXRpb25PblNjcmVlbihteUFycmF5KTtcbiAgICAgICAgdmFyIG90aGVyQXJyYXkgPSBBcnJheS5jcmVhdGUoXCJpbnRcIiwgMik7XG4gICAgICAgIG90aGVyVmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldExvY2F0aW9uT25TY3JlZW4ob3RoZXJBcnJheSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKG15QXJyYXlbMF0gLSBvdGhlckFycmF5WzBdKSxcbiAgICAgICAgICAgIHk6IHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMobXlBcnJheVsxXSAtIG90aGVyQXJyYXlbMV0pLFxuICAgICAgICB9O1xuICAgIH07XG4gICAgVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlID0gZnVuY3Rpb24gKHNpemUsIHNwZWNTaXplLCBzcGVjTW9kZSwgY2hpbGRNZWFzdXJlZFN0YXRlKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBzaXplO1xuICAgICAgICBzd2l0Y2ggKHNwZWNNb2RlKSB7XG4gICAgICAgICAgICBjYXNlIHZpZXdfY29tbW9uXzEubGF5b3V0LlVOU1BFQ0lGSUVEOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNpemU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHZpZXdfY29tbW9uXzEubGF5b3V0LkFUX01PU1Q6XG4gICAgICAgICAgICAgICAgaWYgKHNwZWNTaXplIDwgc2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBzcGVjU2l6ZSB8IHZpZXdfY29tbW9uXzEubGF5b3V0Lk1FQVNVUkVEX1NUQVRFX1RPT19TTUFMTDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHZpZXdfY29tbW9uXzEubGF5b3V0LkVYQUNUTFk6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gc3BlY1NpemU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdCB8IChjaGlsZE1lYXN1cmVkU3RhdGUgJiB2aWV3X2NvbW1vbl8xLmxheW91dC5NRUFTVVJFRF9TVEFURV9NQVNLKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLl9zaG93TmF0aXZlTW9kYWxWaWV3ID0gZnVuY3Rpb24gKHBhcmVudCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9zaG93TmF0aXZlTW9kYWxWaWV3LmNhbGwodGhpcywgcGFyZW50LCBvcHRpb25zKTtcbiAgICAgICAgaW5pdGlhbGl6ZURpYWxvZ0ZyYWdtZW50KCk7XG4gICAgICAgIHZhciBkZiA9IG5ldyBEaWFsb2dGcmFnbWVudCgpO1xuICAgICAgICB2YXIgYXJncyA9IG5ldyBhbmRyb2lkLm9zLkJ1bmRsZSgpO1xuICAgICAgICBhcmdzLnB1dEludChET01JRCwgdGhpcy5fZG9tSWQpO1xuICAgICAgICBkZi5zZXRBcmd1bWVudHMoYXJncyk7XG4gICAgICAgIHZhciBkaWFsb2dPcHRpb25zID0ge1xuICAgICAgICAgICAgb3duZXI6IHRoaXMsXG4gICAgICAgICAgICBmdWxsc2NyZWVuOiAhIW9wdGlvbnMuZnVsbHNjcmVlbixcbiAgICAgICAgICAgIGFuaW1hdGVkOiAhIW9wdGlvbnMuYW5pbWF0ZWQsXG4gICAgICAgICAgICBzdHJldGNoZWQ6ICEhb3B0aW9ucy5zdHJldGNoZWQsXG4gICAgICAgICAgICBjYW5jZWxhYmxlOiBvcHRpb25zLmFuZHJvaWQgPyAhIW9wdGlvbnMuYW5kcm9pZC5jYW5jZWxhYmxlIDogdHJ1ZSxcbiAgICAgICAgICAgIHNob3duQ2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9yYWlzZVNob3duTW9kYWxseUV2ZW50KCk7IH0sXG4gICAgICAgICAgICBkaXNtaXNzQ2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmNsb3NlTW9kYWwoKTsgfVxuICAgICAgICB9O1xuICAgICAgICBzYXZlTW9kYWwoZGlhbG9nT3B0aW9ucyk7XG4gICAgICAgIHRoaXMuX2RpYWxvZ0ZyYWdtZW50ID0gZGY7XG4gICAgICAgIHRoaXMuX3JhaXNlU2hvd2luZ01vZGFsbHlFdmVudCgpO1xuICAgICAgICB0aGlzLl9kaWFsb2dGcmFnbWVudC5zaG93KHBhcmVudC5fZ2V0Um9vdEZyYWdtZW50TWFuYWdlcigpLCB0aGlzLl9kb21JZC50b1N0cmluZygpKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLl9oaWRlTmF0aXZlTW9kYWxWaWV3ID0gZnVuY3Rpb24gKHBhcmVudCwgd2hlbkNsb3NlZENhbGxiYWNrKSB7XG4gICAgICAgIHZhciBtYW5hZ2VyID0gdGhpcy5fZGlhbG9nRnJhZ21lbnQuZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgIGlmIChtYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aGlzLl9kaWFsb2dGcmFnbWVudC5kaXNtaXNzQWxsb3dpbmdTdGF0ZUxvc3MoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9kaWFsb2dGcmFnbWVudCA9IG51bGw7XG4gICAgICAgIHdoZW5DbG9zZWRDYWxsYmFjaygpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbdmlld19jb21tb25fMS5pc0VuYWJsZWRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRFbmFibGVkKHZhbHVlKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEub3JpZ2luWFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFBpdm90WCgpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbdmlld19jb21tb25fMS5vcmlnaW5YUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuT3JpZ2luUG9pbnQuc2V0WCh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIHZhbHVlKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEub3JpZ2luWVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFBpdm90WSgpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbdmlld19jb21tb25fMS5vcmlnaW5ZUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuT3JpZ2luUG9pbnQuc2V0WSh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIHZhbHVlKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEuYXV0b21hdGlvblRleHRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRDb250ZW50RGVzY3JpcHRpb24oKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEuYXV0b21hdGlvblRleHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRDb250ZW50RGVzY3JpcHRpb24odmFsdWUpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbdmlld19jb21tb25fMS5pc1VzZXJJbnRlcmFjdGlvbkVuYWJsZWRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRDbGlja2FibGUodmFsdWUpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0Rm9jdXNhYmxlKHZhbHVlKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS52aXNpYmlsaXR5UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaXNpYmlsaXR5ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFZpc2liaWxpdHkoKTtcbiAgICAgICAgc3dpdGNoIChuYXRpdmVWaXNpYmlsaXR5KSB7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5WaWV3LlZJU0lCTEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidmlzaWJsZVwiO1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuVmlldy5JTlZJU0lCTEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiaGlkZGVuXCI7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5WaWV3LkdPTkU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29sbGFwc2VcIjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5zdXBwb3J0ZWQgYW5kcm9pZC52aWV3LlZpZXcgdmlzaWJpbGl0eTogXCIgKyBuYXRpdmVWaXNpYmlsaXR5ICsgXCIuIEN1cnJlbnRseSBzdXBwb3J0ZWQgdmFsdWVzIGFyZSBhbmRyb2lkLnZpZXcuVmlldy5WSVNJQkxFLCBhbmRyb2lkLnZpZXcuVmlldy5JTlZJU0lCTEUsIGFuZHJvaWQudmlldy5WaWV3LkdPTkUuXCIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEudmlzaWJpbGl0eVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcInZpc2libGVcIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VmlzaWJpbGl0eShhbmRyb2lkLnZpZXcuVmlldy5WSVNJQkxFKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJoaWRkZW5cIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VmlzaWJpbGl0eShhbmRyb2lkLnZpZXcuVmlldy5JTlZJU0lCTEUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImNvbGxhcHNlXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFZpc2liaWxpdHkoYW5kcm9pZC52aWV3LlZpZXcuR09ORSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmlzaWJpbGl0eSB2YWx1ZTogXCIgKyB2YWx1ZSArIFwiLiBWYWxpZCB2YWx1ZXMgYXJlOiB2aXNpYmxlLCBoaWRkZW4sIGNvbGxhcHNlLlwiKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLm9wYWNpdHlQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRBbHBoYSgpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLm9wYWNpdHlQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRBbHBoYShmbG9hdCh2YWx1ZSkpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLmFuZHJvaWRFbGV2YXRpb25Qcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGVmYXVsdEVsZXZhdGlvbigpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLmFuZHJvaWRFbGV2YXRpb25Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmIChzZGtWZXJzaW9uKCkgPCAyMSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVmcmVzaFN0YXRlTGlzdEFuaW1hdG9yKCk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGVmYXVsdER5bmFtaWNFbGV2YXRpb25PZmZzZXQoKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5hbmRyb2lkRHluYW1pY0VsZXZhdGlvbk9mZnNldFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHNka1ZlcnNpb24oKSA8IDIxKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZWZyZXNoU3RhdGVMaXN0QW5pbWF0b3IoKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmdldERlZmF1bHRFbGV2YXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChzZGtWZXJzaW9uKCkgPCAyMSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldEVsZXZhdGlvbigpKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmdldERlZmF1bHREeW5hbWljRWxldmF0aW9uT2Zmc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLnJlZnJlc2hTdGF0ZUxpc3RBbmltYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBPYmplY3RBbmltYXRvciA9IGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yO1xuICAgICAgICB2YXIgQW5pbWF0b3JTZXQgPSBhbmRyb2lkLmFuaW1hdGlvbi5BbmltYXRvclNldDtcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gbmF0aXZlVmlldy5nZXRDb250ZXh0KCkuZ2V0UmVzb3VyY2VzKCkuZ2V0SW50ZWdlcihzaG9ydEFuaW1UaW1lKSAvIDI7XG4gICAgICAgIHZhciBlbGV2YXRpb24gPSB0aGlzLmFuZHJvaWRFbGV2YXRpb247XG4gICAgICAgIGlmICh0eXBlb2YgZWxldmF0aW9uID09PSBcInVuZGVmaW5lZFwiIHx8IGVsZXZhdGlvbiA9PT0gbnVsbCkge1xuICAgICAgICAgICAgZWxldmF0aW9uID0gdGhpcy5nZXREZWZhdWx0RWxldmF0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxldmF0aW9uID0gdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoZWxldmF0aW9uKTtcbiAgICAgICAgdmFyIHogPSB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscygwKTtcbiAgICAgICAgdmFyIHByZXNzZWRaID0gdGhpcy5hbmRyb2lkRHluYW1pY0VsZXZhdGlvbk9mZnNldDtcbiAgICAgICAgaWYgKHR5cGVvZiBwcmVzc2VkWiA9PT0gXCJ1bmRlZmluZWRcIiB8fCBwcmVzc2VkWiA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcHJlc3NlZFogPSB0aGlzLmdldERlZmF1bHREeW5hbWljRWxldmF0aW9uT2Zmc2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgcHJlc3NlZFogPSB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhwcmVzc2VkWik7XG4gICAgICAgIHZhciBwcmVzc2VkU2V0ID0gbmV3IEFuaW1hdG9yU2V0KCk7XG4gICAgICAgIHByZXNzZWRTZXQucGxheVRvZ2V0aGVyKGphdmEudXRpbC5BcnJheXMuYXNMaXN0KFtcbiAgICAgICAgICAgIE9iamVjdEFuaW1hdG9yLm9mRmxvYXQobmF0aXZlVmlldywgXCJ0cmFuc2xhdGlvblpcIiwgW3ByZXNzZWRaXSlcbiAgICAgICAgICAgICAgICAuc2V0RHVyYXRpb24oZHVyYXRpb24pLFxuICAgICAgICAgICAgT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChuYXRpdmVWaWV3LCBcImVsZXZhdGlvblwiLCBbZWxldmF0aW9uXSlcbiAgICAgICAgICAgICAgICAuc2V0RHVyYXRpb24oMCksXG4gICAgICAgIF0pKTtcbiAgICAgICAgdmFyIG5vdFByZXNzZWRTZXQgPSBuZXcgQW5pbWF0b3JTZXQoKTtcbiAgICAgICAgbm90UHJlc3NlZFNldC5wbGF5VG9nZXRoZXIoamF2YS51dGlsLkFycmF5cy5hc0xpc3QoW1xuICAgICAgICAgICAgT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChuYXRpdmVWaWV3LCBcInRyYW5zbGF0aW9uWlwiLCBbel0pXG4gICAgICAgICAgICAgICAgLnNldER1cmF0aW9uKGR1cmF0aW9uKSxcbiAgICAgICAgICAgIE9iamVjdEFuaW1hdG9yLm9mRmxvYXQobmF0aXZlVmlldywgXCJlbGV2YXRpb25cIiwgW2VsZXZhdGlvbl0pXG4gICAgICAgICAgICAgICAgLnNldER1cmF0aW9uKDApLFxuICAgICAgICBdKSk7XG4gICAgICAgIHZhciBkZWZhdWx0U2V0ID0gbmV3IEFuaW1hdG9yU2V0KCk7XG4gICAgICAgIGRlZmF1bHRTZXQucGxheVRvZ2V0aGVyKGphdmEudXRpbC5BcnJheXMuYXNMaXN0KFtcbiAgICAgICAgICAgIE9iamVjdEFuaW1hdG9yLm9mRmxvYXQobmF0aXZlVmlldywgXCJ0cmFuc2xhdGlvblpcIiwgWzBdKS5zZXREdXJhdGlvbigwKSxcbiAgICAgICAgICAgIE9iamVjdEFuaW1hdG9yLm9mRmxvYXQobmF0aXZlVmlldywgXCJlbGV2YXRpb25cIiwgWzBdKS5zZXREdXJhdGlvbigwKSxcbiAgICAgICAgXSkpO1xuICAgICAgICB2YXIgc3RhdGVMaXN0QW5pbWF0b3IgPSBuZXcgYW5kcm9pZC5hbmltYXRpb24uU3RhdGVMaXN0QW5pbWF0b3IoKTtcbiAgICAgICAgc3RhdGVMaXN0QW5pbWF0b3IuYWRkU3RhdGUoW3N0YXRlUHJlc3NlZCwgc3RhdGVFbmFibGVkXSwgcHJlc3NlZFNldCk7XG4gICAgICAgIHN0YXRlTGlzdEFuaW1hdG9yLmFkZFN0YXRlKFtzdGF0ZUVuYWJsZWRdLCBub3RQcmVzc2VkU2V0KTtcbiAgICAgICAgc3RhdGVMaXN0QW5pbWF0b3IuYWRkU3RhdGUoW10sIGRlZmF1bHRTZXQpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldFN0YXRlTGlzdEFuaW1hdG9yKHN0YXRlTGlzdEFuaW1hdG9yKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5ob3Jpem9udGFsQWxpZ25tZW50UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5nZXRIb3Jpem9udGFsQWxpZ25tZW50KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBscCA9IG5hdGl2ZVZpZXcuZ2V0TGF5b3V0UGFyYW1zKCkgfHwgbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Db21tb25MYXlvdXRQYXJhbXMoKTtcbiAgICAgICAgaWYgKGxwLmdyYXZpdHkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJsZWZ0XCI6XG4gICAgICAgICAgICAgICAgICAgIGxwLmdyYXZpdHkgPSBhbmRyb2lkLnZpZXcuR3Jhdml0eS5MRUZUIHwgKGxwLmdyYXZpdHkgJiBhbmRyb2lkLnZpZXcuR3Jhdml0eS5WRVJUSUNBTF9HUkFWSVRZX01BU0spO1xuICAgICAgICAgICAgICAgICAgICBpZiAobHAud2VpZ2h0IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbHAud2VpZ2h0ID0gLTI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImNlbnRlclwiOlxuICAgICAgICAgICAgICAgICAgICBscC5ncmF2aXR5ID0gYW5kcm9pZC52aWV3LkdyYXZpdHkuQ0VOVEVSX0hPUklaT05UQUwgfCAobHAuZ3Jhdml0eSAmIGFuZHJvaWQudmlldy5HcmF2aXR5LlZFUlRJQ0FMX0dSQVZJVFlfTUFTSyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChscC53ZWlnaHQgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBscC53ZWlnaHQgPSAtMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwicmlnaHRcIjpcbiAgICAgICAgICAgICAgICAgICAgbHAuZ3Jhdml0eSA9IGFuZHJvaWQudmlldy5HcmF2aXR5LlJJR0hUIHwgKGxwLmdyYXZpdHkgJiBhbmRyb2lkLnZpZXcuR3Jhdml0eS5WRVJUSUNBTF9HUkFWSVRZX01BU0spO1xuICAgICAgICAgICAgICAgICAgICBpZiAobHAud2VpZ2h0IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbHAud2VpZ2h0ID0gLTI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInN0cmV0Y2hcIjpcbiAgICAgICAgICAgICAgICAgICAgbHAuZ3Jhdml0eSA9IGFuZHJvaWQudmlldy5HcmF2aXR5LkZJTExfSE9SSVpPTlRBTCB8IChscC5ncmF2aXR5ICYgYW5kcm9pZC52aWV3LkdyYXZpdHkuVkVSVElDQUxfR1JBVklUWV9NQVNLKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxwLndlaWdodCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxwLndlaWdodCA9IC0xO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRMYXlvdXRQYXJhbXMobHApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEudmVydGljYWxBbGlnbm1lbnRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLmdldFZlcnRpY2FsQWxpZ25tZW50KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEudmVydGljYWxBbGlnbm1lbnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgbHAgPSBuYXRpdmVWaWV3LmdldExheW91dFBhcmFtcygpIHx8IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ29tbW9uTGF5b3V0UGFyYW1zKCk7XG4gICAgICAgIGlmIChscC5ncmF2aXR5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwidG9wXCI6XG4gICAgICAgICAgICAgICAgICAgIGxwLmdyYXZpdHkgPSBhbmRyb2lkLnZpZXcuR3Jhdml0eS5UT1AgfCAobHAuZ3Jhdml0eSAmIGFuZHJvaWQudmlldy5HcmF2aXR5LkhPUklaT05UQUxfR1JBVklUWV9NQVNLKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxwLmhlaWdodCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxwLmhlaWdodCA9IC0yO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJtaWRkbGVcIjpcbiAgICAgICAgICAgICAgICAgICAgbHAuZ3Jhdml0eSA9IGFuZHJvaWQudmlldy5HcmF2aXR5LkNFTlRFUl9WRVJUSUNBTCB8IChscC5ncmF2aXR5ICYgYW5kcm9pZC52aWV3LkdyYXZpdHkuSE9SSVpPTlRBTF9HUkFWSVRZX01BU0spO1xuICAgICAgICAgICAgICAgICAgICBpZiAobHAuaGVpZ2h0IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbHAuaGVpZ2h0ID0gLTI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImJvdHRvbVwiOlxuICAgICAgICAgICAgICAgICAgICBscC5ncmF2aXR5ID0gYW5kcm9pZC52aWV3LkdyYXZpdHkuQk9UVE9NIHwgKGxwLmdyYXZpdHkgJiBhbmRyb2lkLnZpZXcuR3Jhdml0eS5IT1JJWk9OVEFMX0dSQVZJVFlfTUFTSyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChscC5oZWlnaHQgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBscC5oZWlnaHQgPSAtMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwic3RyZXRjaFwiOlxuICAgICAgICAgICAgICAgICAgICBscC5ncmF2aXR5ID0gYW5kcm9pZC52aWV3LkdyYXZpdHkuRklMTF9WRVJUSUNBTCB8IChscC5ncmF2aXR5ICYgYW5kcm9pZC52aWV3LkdyYXZpdHkuSE9SSVpPTlRBTF9HUkFWSVRZX01BU0spO1xuICAgICAgICAgICAgICAgICAgICBpZiAobHAuaGVpZ2h0IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbHAuaGVpZ2h0ID0gLTE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldExheW91dFBhcmFtcyhscCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5yb3RhdGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldFJvdGF0ZSh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIGZsb2F0KHZhbHVlKSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVYUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRTY2FsZVgodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCBmbG9hdCh2YWx1ZSkpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0U2NhbGVZKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgZmxvYXQodmFsdWUpKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVYUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRUcmFuc2xhdGVYKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHModmFsdWUpKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVZUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRUcmFuc2xhdGVZKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHModmFsdWUpKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS56SW5kZXhQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuekluZGV4UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRaSW5kZXgodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgZHJhd2FibGUgPSBuYXRpdmVWaWV3LmdldEJhY2tncm91bmQoKTtcbiAgICAgICAgaWYgKGRyYXdhYmxlKSB7XG4gICAgICAgICAgICB2YXIgY29uc3RhbnRTdGF0ZSA9IGRyYXdhYmxlLmdldENvbnN0YW50U3RhdGUoKTtcbiAgICAgICAgICAgIGlmIChjb25zdGFudFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50U3RhdGUubmV3RHJhd2FibGUobmF0aXZlVmlldy5nZXRSZXNvdXJjZXMoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkcmF3YWJsZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZHJhd2FibGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9yZWRyYXdOYXRpdmVCYWNrZ3JvdW5kKHZhbHVlKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5taW5XaWR0aFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50IGluc3RhbmNlb2YgQ3VzdG9tTGF5b3V0VmlldyAmJiB0aGlzLnBhcmVudC5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5fc2V0Q2hpbGRNaW5XaWR0aE5hdGl2ZSh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3NldE1pbldpZHRoTmF0aXZlKHRoaXMubWluV2lkdGgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEubWluSGVpZ2h0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQgaW5zdGFuY2VvZiBDdXN0b21MYXlvdXRWaWV3ICYmIHRoaXMucGFyZW50Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Ll9zZXRDaGlsZE1pbkhlaWdodE5hdGl2ZSh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3NldE1pbkhlaWdodE5hdGl2ZSh0aGlzLm1pbkhlaWdodCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLl9yZWRyYXdOYXRpdmVCYWNrZ3JvdW5kID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGJhY2tncm91bmRfMS5CYWNrZ3JvdW5kKSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kXzEuYWQub25CYWNrZ3JvdW5kT3JCb3JkZXJQcm9wZXJ0eUNoYW5nZWQodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0QmFja2dyb3VuZCh2YWx1ZSk7XG4gICAgICAgICAgICB2YXIgc3R5bGUgPSB0aGlzLnN0eWxlO1xuICAgICAgICAgICAgdmFyIHBhZGRpbmdUb3AgPSB2aWV3X2NvbW1vbl8xLnBhZGRpbmdUb3BQcm9wZXJ0eS5pc1NldChzdHlsZSkgPyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdUb3AgOiB0aGlzLl9kZWZhdWx0UGFkZGluZ1RvcDtcbiAgICAgICAgICAgIHZhciBwYWRkaW5nUmlnaHQgPSB2aWV3X2NvbW1vbl8xLnBhZGRpbmdSaWdodFByb3BlcnR5LmlzU2V0KHN0eWxlKSA/IHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0IDogdGhpcy5fZGVmYXVsdFBhZGRpbmdSaWdodDtcbiAgICAgICAgICAgIHZhciBwYWRkaW5nQm90dG9tID0gdmlld19jb21tb25fMS5wYWRkaW5nQm90dG9tUHJvcGVydHkuaXNTZXQoc3R5bGUpID8gdGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tIDogdGhpcy5fZGVmYXVsdFBhZGRpbmdCb3R0b207XG4gICAgICAgICAgICB2YXIgcGFkZGluZ0xlZnQgPSB2aWV3X2NvbW1vbl8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuaXNTZXQoc3R5bGUpID8gdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCA6IHRoaXMuX2RlZmF1bHRQYWRkaW5nTGVmdDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1BhZGRpbmdSZWxhdGl2ZSkge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0UGFkZGluZ1JlbGF0aXZlKHBhZGRpbmdMZWZ0LCBwYWRkaW5nVG9wLCBwYWRkaW5nUmlnaHQsIHBhZGRpbmdCb3R0b20pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRQYWRkaW5nKHBhZGRpbmdMZWZ0LCBwYWRkaW5nVG9wLCBwYWRkaW5nUmlnaHQsIHBhZGRpbmdCb3R0b20pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmF0aXZlVmlldy5iYWNrZ3JvdW5kID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LmFuZHJvaWRCYWNrUHJlc3NlZEV2ZW50ID0gYW5kcm9pZEJhY2tQcmVzc2VkRXZlbnQ7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3LnByb3RvdHlwZSwgXCJvbkxvYWRlZFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXcucHJvdG90eXBlLCBcIm9uVW5sb2FkZWRcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3LnByb3RvdHlwZSwgXCJyZXF1ZXN0TGF5b3V0XCIsIG51bGwpO1xuICAgIHJldHVybiBWaWV3O1xufSh2aWV3X2NvbW1vbl8xLlZpZXdDb21tb24pKTtcbmV4cG9ydHMuVmlldyA9IFZpZXc7XG52YXIgQ29udGFpbmVyVmlldyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENvbnRhaW5lclZpZXcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ29udGFpbmVyVmlldygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICByZXR1cm4gQ29udGFpbmVyVmlldztcbn0oVmlldykpO1xuZXhwb3J0cy5Db250YWluZXJWaWV3ID0gQ29udGFpbmVyVmlldztcbnZhciBDdXN0b21MYXlvdXRWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ3VzdG9tTGF5b3V0VmlldywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDdXN0b21MYXlvdXRWaWV3KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEN1c3RvbUxheW91dFZpZXcucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbnRlbnRMYXlvdXQodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBDdXN0b21MYXlvdXRWaWV3LnByb3RvdHlwZS5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZSA9IGZ1bmN0aW9uIChjaGlsZCwgYXRJbmRleCkge1xuICAgICAgICBpZiAoYXRJbmRleCA9PT0gdm9pZCAwKSB7IGF0SW5kZXggPSBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUjsgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlLmNhbGwodGhpcywgY2hpbGQpO1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkICYmIGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIGlmICh2aWV3X2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgdmlld19jb21tb25fMS50cmFjZVdyaXRlKHRoaXMgKyBcIi5uYXRpdmVWaWV3LmFkZFZpZXcoXCIgKyBjaGlsZCArIFwiLm5hdGl2ZVZpZXcsIFwiICsgYXRJbmRleCArIFwiKVwiLCB2aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5WaXN1YWxUcmVlRXZlbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5hZGRWaWV3KGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIGF0SW5kZXgpO1xuICAgICAgICAgICAgaWYgKGNoaWxkIGluc3RhbmNlb2YgVmlldykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZU5hdGl2ZUxheW91dFBhcmFtcyhjaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBDdXN0b21MYXlvdXRWaWV3LnByb3RvdHlwZS5fdXBkYXRlTmF0aXZlTGF5b3V0UGFyYW1zID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHRoaXMuX3NldENoaWxkTWluV2lkdGhOYXRpdmUoY2hpbGQpO1xuICAgICAgICB0aGlzLl9zZXRDaGlsZE1pbkhlaWdodE5hdGl2ZShjaGlsZCk7XG4gICAgfTtcbiAgICBDdXN0b21MYXlvdXRWaWV3LnByb3RvdHlwZS5fc2V0Q2hpbGRNaW5XaWR0aE5hdGl2ZSA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICBjaGlsZC5fc2V0TWluV2lkdGhOYXRpdmUoY2hpbGQubWluV2lkdGgpO1xuICAgIH07XG4gICAgQ3VzdG9tTGF5b3V0Vmlldy5wcm90b3R5cGUuX3NldENoaWxkTWluSGVpZ2h0TmF0aXZlID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIGNoaWxkLl9zZXRNaW5IZWlnaHROYXRpdmUoY2hpbGQubWluSGVpZ2h0KTtcbiAgICB9O1xuICAgIEN1c3RvbUxheW91dFZpZXcucHJvdG90eXBlLl9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlLmNhbGwodGhpcywgY2hpbGQpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGNoaWxkVmlldyA9IGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3ICYmIGNoaWxkVmlldykge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5yZW1vdmVWaWV3KGNoaWxkVmlldyk7XG4gICAgICAgICAgICBpZiAodmlld19jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHZpZXdfY29tbW9uXzEudHJhY2VXcml0ZShuYXRpdmVWaWV3ICsgXCIucmVtb3ZlVmlldyhcIiArIGNoaWxkVmlldyArIFwiKVwiLCB2aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5WaXN1YWxUcmVlRXZlbnRzKTtcbiAgICAgICAgICAgICAgICB2aWV3X2NvbW1vbl8xLnRyYWNlTm90aWZ5RXZlbnQoY2hpbGQsIFwiY2hpbGRJbkxheW91dFJlbW92ZWRGcm9tTmF0aXZlVmlzdWFsVHJlZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEN1c3RvbUxheW91dFZpZXc7XG59KENvbnRhaW5lclZpZXcpKTtcbmV4cG9ydHMuQ3VzdG9tTGF5b3V0VmlldyA9IEN1c3RvbUxheW91dFZpZXc7XG52YXIgcGVyY2VudE5vdFN1cHBvcnRlZCA9IGZ1bmN0aW9uICh2aWV3LCB2YWx1ZSkgeyB0aHJvdyBuZXcgRXJyb3IoXCJQZXJjZW50TGVuZ3RoIGlzIG5vdCBzdXBwb3J0ZWQuXCIpOyB9O1xuZnVuY3Rpb24gY3JlYXRlTmF0aXZlUGVyY2VudExlbmd0aFByb3BlcnR5KG9wdGlvbnMpIHtcbiAgICB2YXIgZ2V0dGVyID0gb3B0aW9ucy5nZXR0ZXIsIHNldHRlciA9IG9wdGlvbnMuc2V0dGVyLCBfYSA9IG9wdGlvbnMuYXV0bywgYXV0byA9IF9hID09PSB2b2lkIDAgPyAwIDogX2E7XG4gICAgdmFyIHNldFBpeGVscywgZ2V0UGl4ZWxzLCBzZXRQZXJjZW50O1xuICAgIGlmIChnZXR0ZXIpIHtcbiAgICAgICAgVmlldy5wcm90b3R5cGVbZ2V0dGVyXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgc2V0UGl4ZWxzID0gb3B0aW9ucy5zZXRQaXhlbHM7XG4gICAgICAgICAgICAgICAgZ2V0UGl4ZWxzID0gb3B0aW9ucy5nZXRQaXhlbHM7XG4gICAgICAgICAgICAgICAgc2V0UGVyY2VudCA9IG9wdGlvbnMuc2V0UGVyY2VudCB8fCBwZXJjZW50Tm90U3VwcG9ydGVkO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZhbHVlID0gZ2V0UGl4ZWxzKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCk7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT0gYXV0bykge1xuICAgICAgICAgICAgICAgIHJldHVybiBcImF1dG9cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiB2YWx1ZSwgdW5pdDogXCJweFwiIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIGlmIChzZXR0ZXIpIHtcbiAgICAgICAgVmlldy5wcm90b3R5cGVbc2V0dGVyXSA9IGZ1bmN0aW9uIChsZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgc2V0UGl4ZWxzID0gb3B0aW9ucy5zZXRQaXhlbHM7XG4gICAgICAgICAgICAgICAgZ2V0UGl4ZWxzID0gb3B0aW9ucy5nZXRQaXhlbHM7XG4gICAgICAgICAgICAgICAgc2V0UGVyY2VudCA9IG9wdGlvbnMuc2V0UGVyY2VudCB8fCBwZXJjZW50Tm90U3VwcG9ydGVkO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxlbmd0aCA9PSBcImF1dG9cIikge1xuICAgICAgICAgICAgICAgIHNldFBpeGVscyh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIGF1dG8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGxlbmd0aCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgIHNldFBpeGVscyh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIHZpZXdfY29tbW9uXzEubGF5b3V0LnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGxlbmd0aCkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGxlbmd0aC51bml0ID09IFwiZGlwXCIpIHtcbiAgICAgICAgICAgICAgICBzZXRQaXhlbHModGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCB2aWV3X2NvbW1vbl8xLmxheW91dC5yb3VuZCh2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhsZW5ndGgudmFsdWUpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsZW5ndGgudW5pdCA9PSBcInB4XCIpIHtcbiAgICAgICAgICAgICAgICBzZXRQaXhlbHModGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCB2aWV3X2NvbW1vbl8xLmxheW91dC5yb3VuZChsZW5ndGgudmFsdWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGxlbmd0aC51bml0ID09IFwiJVwiKSB7XG4gICAgICAgICAgICAgICAgc2V0UGVyY2VudCh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIGxlbmd0aC52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbnN1cHBvcnRlZCBQZXJjZW50TGVuZ3RoIFwiICsgbGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG59XG5jcmVhdGVOYXRpdmVQZXJjZW50TGVuZ3RoUHJvcGVydHkoe1xuICAgIHNldHRlcjogc3R5bGVfcHJvcGVydGllc18xLm1hcmdpblRvcFByb3BlcnR5LnNldE5hdGl2ZSxcbiAgICBnZXQgc2V0UGl4ZWxzKCkgeyByZXR1cm4gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0TWFyZ2luVG9wOyB9LFxuICAgIGdldCBzZXRQZXJjZW50KCkgeyByZXR1cm4gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0TWFyZ2luVG9wUGVyY2VudDsgfVxufSk7XG5jcmVhdGVOYXRpdmVQZXJjZW50TGVuZ3RoUHJvcGVydHkoe1xuICAgIHNldHRlcjogc3R5bGVfcHJvcGVydGllc18xLm1hcmdpblJpZ2h0UHJvcGVydHkuc2V0TmF0aXZlLFxuICAgIGdldCBzZXRQaXhlbHMoKSB7IHJldHVybiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRNYXJnaW5SaWdodDsgfSxcbiAgICBnZXQgc2V0UGVyY2VudCgpIHsgcmV0dXJuIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldE1hcmdpblJpZ2h0UGVyY2VudDsgfVxufSk7XG5jcmVhdGVOYXRpdmVQZXJjZW50TGVuZ3RoUHJvcGVydHkoe1xuICAgIHNldHRlcjogc3R5bGVfcHJvcGVydGllc18xLm1hcmdpbkJvdHRvbVByb3BlcnR5LnNldE5hdGl2ZSxcbiAgICBnZXQgc2V0UGl4ZWxzKCkgeyByZXR1cm4gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0TWFyZ2luQm90dG9tOyB9LFxuICAgIGdldCBzZXRQZXJjZW50KCkgeyByZXR1cm4gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0TWFyZ2luQm90dG9tUGVyY2VudDsgfVxufSk7XG5jcmVhdGVOYXRpdmVQZXJjZW50TGVuZ3RoUHJvcGVydHkoe1xuICAgIHNldHRlcjogc3R5bGVfcHJvcGVydGllc18xLm1hcmdpbkxlZnRQcm9wZXJ0eS5zZXROYXRpdmUsXG4gICAgZ2V0IHNldFBpeGVscygpIHsgcmV0dXJuIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldE1hcmdpbkxlZnQ7IH0sXG4gICAgZ2V0IHNldFBlcmNlbnQoKSB7IHJldHVybiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRNYXJnaW5MZWZ0UGVyY2VudDsgfVxufSk7XG5jcmVhdGVOYXRpdmVQZXJjZW50TGVuZ3RoUHJvcGVydHkoe1xuICAgIHNldHRlcjogc3R5bGVfcHJvcGVydGllc18xLndpZHRoUHJvcGVydHkuc2V0TmF0aXZlLFxuICAgIGF1dG86IC0xLFxuICAgIGdldCBzZXRQaXhlbHMoKSB7IHJldHVybiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRXaWR0aDsgfSxcbiAgICBnZXQgc2V0UGVyY2VudCgpIHsgcmV0dXJuIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldFdpZHRoUGVyY2VudDsgfVxufSk7XG5jcmVhdGVOYXRpdmVQZXJjZW50TGVuZ3RoUHJvcGVydHkoe1xuICAgIHNldHRlcjogc3R5bGVfcHJvcGVydGllc18xLmhlaWdodFByb3BlcnR5LnNldE5hdGl2ZSxcbiAgICBhdXRvOiAtMSxcbiAgICBnZXQgc2V0UGl4ZWxzKCkgeyByZXR1cm4gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0SGVpZ2h0OyB9LFxuICAgIGdldCBzZXRQZXJjZW50KCkgeyByZXR1cm4gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0SGVpZ2h0UGVyY2VudDsgfVxufSk7XG5jcmVhdGVOYXRpdmVQZXJjZW50TGVuZ3RoUHJvcGVydHkoe1xuICAgIHNldHRlcjogXCJfc2V0TWluV2lkdGhOYXRpdmVcIixcbiAgICBnZXQgc2V0UGl4ZWxzKCkgeyByZXR1cm4gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0TWluV2lkdGg7IH1cbn0pO1xuY3JlYXRlTmF0aXZlUGVyY2VudExlbmd0aFByb3BlcnR5KHtcbiAgICBzZXR0ZXI6IFwiX3NldE1pbkhlaWdodE5hdGl2ZVwiLFxuICAgIGdldCBzZXRQaXhlbHMoKSB7IHJldHVybiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRNaW5IZWlnaHQ7IH1cbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dmlldy5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBoYW5kbGVyc0ZvckV2ZW50TmFtZSA9IG5ldyBNYXAoKTtcbnZhciBzb3VyY2VzTWFwID0gbmV3IFdlYWtNYXAoKTtcbnZhciBUYXJnZXRIYW5kbGVyUGFpciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVGFyZ2V0SGFuZGxlclBhaXIodGFyZ2V0LCBoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMudGFnZXRSZWYgPSBuZXcgV2Vha1JlZih0YXJnZXQpO1xuICAgICAgICB0aGlzLmhhbmRsZXIgPSBoYW5kbGVyO1xuICAgIH1cbiAgICByZXR1cm4gVGFyZ2V0SGFuZGxlclBhaXI7XG59KCkpO1xuZnVuY3Rpb24gZ2V0SGFuZGxlckZvckV2ZW50TmFtZShldmVudE5hbWUpIHtcbiAgICB2YXIgaGFuZGxlciA9IGhhbmRsZXJzRm9yRXZlbnROYW1lLmdldChldmVudE5hbWUpO1xuICAgIGlmICghaGFuZGxlcikge1xuICAgICAgICBoYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50RGF0YSkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGV2ZW50RGF0YS5vYmplY3Q7XG4gICAgICAgICAgICB2YXIgc291cmNlRXZlbnRNYXAgPSBzb3VyY2VzTWFwLmdldChzb3VyY2UpO1xuICAgICAgICAgICAgaWYgKCFzb3VyY2VFdmVudE1hcCkge1xuICAgICAgICAgICAgICAgIHNvdXJjZS5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgaGFuZGxlcnNGb3JFdmVudE5hbWUuZ2V0KGV2ZW50TmFtZSkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0YXJnZXRIYW5kbGVyUGFpckxpc3QgPSBzb3VyY2VFdmVudE1hcC5nZXQoZXZlbnROYW1lKTtcbiAgICAgICAgICAgIGlmICghdGFyZ2V0SGFuZGxlclBhaXJMaXN0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlYWRQYWlyc0luZGV4ZXMgPSBbXTtcbiAgICAgICAgICAgIHZhciBwYWlyO1xuICAgICAgICAgICAgdmFyIHRhcmdldDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFyZ2V0SGFuZGxlclBhaXJMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcGFpciA9IHRhcmdldEhhbmRsZXJQYWlyTGlzdFtpXTtcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSBwYWlyLnRhZ2V0UmVmLmdldCgpO1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFpci5oYW5kbGVyLmNhbGwodGFyZ2V0LCBldmVudERhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGVhZFBhaXJzSW5kZXhlcy5wdXNoKGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkZWFkUGFpcnNJbmRleGVzLmxlbmd0aCA9PT0gdGFyZ2V0SGFuZGxlclBhaXJMaXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHNvdXJjZS5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgaGFuZGxlcnNGb3JFdmVudE5hbWUuZ2V0KGV2ZW50TmFtZSkpO1xuICAgICAgICAgICAgICAgIHNvdXJjZUV2ZW50TWFwLmRlbGV0ZShldmVudE5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRlYWRQYWlyc0luZGV4ZXMubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SGFuZGxlclBhaXJMaXN0LnNwbGljZShkZWFkUGFpcnNJbmRleGVzW2pdLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGhhbmRsZXJzRm9yRXZlbnROYW1lLnNldChldmVudE5hbWUsIGhhbmRsZXIpO1xuICAgIH1cbiAgICByZXR1cm4gaGFuZGxlcjtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlQXJncyhzb3VyY2UsIGV2ZW50TmFtZSwgaGFuZGxlciwgdGFyZ2V0KSB7XG4gICAgaWYgKCFzb3VyY2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwic291cmNlIGlzIG51bGwgb3IgdW5kZWZpbmVkXCIpO1xuICAgIH1cbiAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ0YXJnZXQgaXMgbnVsbCBvciB1bmRlZmluZWRcIik7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZXZlbnROYW1lICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImV2ZW50TmFtZSBpcyBub3QgYSBzdHJpbmdcIik7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgaGFuZGxlciAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImhhbmRsZXIgaXMgbm90IGEgZnVuY3Rpb25cIik7XG4gICAgfVxufVxuZnVuY3Rpb24gYWRkV2Vha0V2ZW50TGlzdGVuZXIoc291cmNlLCBldmVudE5hbWUsIGhhbmRsZXIsIHRhcmdldCkge1xuICAgIHZhbGlkYXRlQXJncyhzb3VyY2UsIGV2ZW50TmFtZSwgaGFuZGxlciwgdGFyZ2V0KTtcbiAgICB2YXIgc2hvdWxkQXR0YWNoID0gZmFsc2U7XG4gICAgdmFyIHNvdXJjZUV2ZW50TWFwID0gc291cmNlc01hcC5nZXQoc291cmNlKTtcbiAgICBpZiAoIXNvdXJjZUV2ZW50TWFwKSB7XG4gICAgICAgIHNvdXJjZUV2ZW50TWFwID0gbmV3IE1hcCgpO1xuICAgICAgICBzb3VyY2VzTWFwLnNldChzb3VyY2UsIHNvdXJjZUV2ZW50TWFwKTtcbiAgICAgICAgc2hvdWxkQXR0YWNoID0gdHJ1ZTtcbiAgICB9XG4gICAgdmFyIHBhaXJMaXN0ID0gc291cmNlRXZlbnRNYXAuZ2V0KGV2ZW50TmFtZSk7XG4gICAgaWYgKCFwYWlyTGlzdCkge1xuICAgICAgICBwYWlyTGlzdCA9IG5ldyBBcnJheSgpO1xuICAgICAgICBzb3VyY2VFdmVudE1hcC5zZXQoZXZlbnROYW1lLCBwYWlyTGlzdCk7XG4gICAgICAgIHNob3VsZEF0dGFjaCA9IHRydWU7XG4gICAgfVxuICAgIHBhaXJMaXN0LnB1c2gobmV3IFRhcmdldEhhbmRsZXJQYWlyKHRhcmdldCwgaGFuZGxlcikpO1xuICAgIGlmIChzaG91bGRBdHRhY2gpIHtcbiAgICAgICAgc291cmNlLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBnZXRIYW5kbGVyRm9yRXZlbnROYW1lKGV2ZW50TmFtZSkpO1xuICAgIH1cbn1cbmV4cG9ydHMuYWRkV2Vha0V2ZW50TGlzdGVuZXIgPSBhZGRXZWFrRXZlbnRMaXN0ZW5lcjtcbmZ1bmN0aW9uIHJlbW92ZVdlYWtFdmVudExpc3RlbmVyKHNvdXJjZSwgZXZlbnROYW1lLCBoYW5kbGVyLCB0YXJnZXQpIHtcbiAgICB2YWxpZGF0ZUFyZ3Moc291cmNlLCBldmVudE5hbWUsIGhhbmRsZXIsIHRhcmdldCk7XG4gICAgdmFyIGhhbmRsZXJGb3JFdmVudFdpdGhOYW1lID0gaGFuZGxlcnNGb3JFdmVudE5hbWUuZ2V0KGV2ZW50TmFtZSk7XG4gICAgaWYgKCFoYW5kbGVyRm9yRXZlbnRXaXRoTmFtZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBzb3VyY2VFdmVudE1hcCA9IHNvdXJjZXNNYXAuZ2V0KHNvdXJjZSk7XG4gICAgaWYgKCFzb3VyY2VFdmVudE1hcCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0YXJnZXRIYW5kbGVyUGFpckxpc3QgPSBzb3VyY2VFdmVudE1hcC5nZXQoZXZlbnROYW1lKTtcbiAgICBpZiAoIXRhcmdldEhhbmRsZXJQYWlyTGlzdCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0YXJnZXRIYW5kbGVyUGFpcnNUb1JlbW92ZSA9IFtdO1xuICAgIHZhciBwYWlyO1xuICAgIHZhciByZWdpc3RlcmVkVGFyZ2V0O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFyZ2V0SGFuZGxlclBhaXJMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBhaXIgPSB0YXJnZXRIYW5kbGVyUGFpckxpc3RbaV07XG4gICAgICAgIHJlZ2lzdGVyZWRUYXJnZXQgPSBwYWlyLnRhZ2V0UmVmLmdldCgpO1xuICAgICAgICBpZiAoIXJlZ2lzdGVyZWRUYXJnZXQgfHwgKHJlZ2lzdGVyZWRUYXJnZXQgPT09IHRhcmdldCAmJiBoYW5kbGVyID09PSBwYWlyLmhhbmRsZXIpKSB7XG4gICAgICAgICAgICB0YXJnZXRIYW5kbGVyUGFpcnNUb1JlbW92ZS5wdXNoKGkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICh0YXJnZXRIYW5kbGVyUGFpcnNUb1JlbW92ZS5sZW5ndGggPT09IHRhcmdldEhhbmRsZXJQYWlyTGlzdC5sZW5ndGgpIHtcbiAgICAgICAgc291cmNlLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBoYW5kbGVyRm9yRXZlbnRXaXRoTmFtZSk7XG4gICAgICAgIHNvdXJjZUV2ZW50TWFwLmRlbGV0ZShldmVudE5hbWUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZm9yICh2YXIgaiA9IHRhcmdldEhhbmRsZXJQYWlyc1RvUmVtb3ZlLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7XG4gICAgICAgICAgICB0YXJnZXRIYW5kbGVyUGFpckxpc3Quc3BsaWNlKHRhcmdldEhhbmRsZXJQYWlyc1RvUmVtb3ZlW2pdLCAxKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMucmVtb3ZlV2Vha0V2ZW50TGlzdGVuZXIgPSByZW1vdmVXZWFrRXZlbnRMaXN0ZW5lcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXdlYWstZXZlbnQtbGlzdGVuZXIuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgZGVmYXVsdERhdGUgPSBuZXcgRGF0ZSgpO1xudmFyIGRhdGVDb21wYXJlciA9IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiAoeCA8PSB5ICYmIHggPj0geSk7IH07XG52YXIgRGF0ZVBpY2tlckJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhEYXRlUGlja2VyQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBEYXRlUGlja2VyQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBEYXRlUGlja2VyQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIkRhdGVQaWNrZXJcIilcbiAgICBdLCBEYXRlUGlja2VyQmFzZSk7XG4gICAgcmV0dXJuIERhdGVQaWNrZXJCYXNlO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5EYXRlUGlja2VyQmFzZSA9IERhdGVQaWNrZXJCYXNlO1xuRGF0ZVBpY2tlckJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLnllYXJQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwieWVhclwiLFxuICAgIGRlZmF1bHRWYWx1ZTogZGVmYXVsdERhdGUuZ2V0RnVsbFllYXIoKSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9LFxufSk7XG5leHBvcnRzLnllYXJQcm9wZXJ0eS5yZWdpc3RlcihEYXRlUGlja2VyQmFzZSk7XG5leHBvcnRzLm1vbnRoUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1vbnRoXCIsXG4gICAgZGVmYXVsdFZhbHVlOiBkZWZhdWx0RGF0ZS5nZXRNb250aCgpICsgMSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9LFxufSk7XG5leHBvcnRzLm1vbnRoUHJvcGVydHkucmVnaXN0ZXIoRGF0ZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5kYXlQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZGF5XCIsXG4gICAgZGVmYXVsdFZhbHVlOiBkZWZhdWx0RGF0ZS5nZXREYXRlKCksXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfSxcbn0pO1xuZXhwb3J0cy5kYXlQcm9wZXJ0eS5yZWdpc3RlcihEYXRlUGlja2VyQmFzZSk7XG5leHBvcnRzLm1heERhdGVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWF4RGF0ZVwiLFxuICAgIGVxdWFsaXR5Q29tcGFyZXI6IGRhdGVDb21wYXJlcixcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBEYXRlKHYpOyB9LFxufSk7XG5leHBvcnRzLm1heERhdGVQcm9wZXJ0eS5yZWdpc3RlcihEYXRlUGlja2VyQmFzZSk7XG5leHBvcnRzLm1pbkRhdGVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWluRGF0ZVwiLFxuICAgIGVxdWFsaXR5Q29tcGFyZXI6IGRhdGVDb21wYXJlcixcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBEYXRlKHYpOyB9LFxufSk7XG5leHBvcnRzLm1pbkRhdGVQcm9wZXJ0eS5yZWdpc3RlcihEYXRlUGlja2VyQmFzZSk7XG5leHBvcnRzLmRhdGVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZGF0ZVwiLFxuICAgIGRlZmF1bHRWYWx1ZTogZGVmYXVsdERhdGUsXG4gICAgZXF1YWxpdHlDb21wYXJlcjogZGF0ZUNvbXBhcmVyLFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IERhdGUodik7IH0sXG59KTtcbmV4cG9ydHMuZGF0ZVByb3BlcnR5LnJlZ2lzdGVyKERhdGVQaWNrZXJCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGUtcGlja2VyLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGRhdGVfcGlja2VyX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vZGF0ZS1waWNrZXItY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vZGF0ZS1waWNrZXItY29tbW9uXCIpKTtcbnZhciBEYXRlQ2hhbmdlZExpc3RlbmVyO1xuZnVuY3Rpb24gaW5pdGlhbGl6ZURhdGVDaGFuZ2VkTGlzdGVuZXIoKSB7XG4gICAgaWYgKERhdGVDaGFuZ2VkTGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgRGF0ZUNoYW5nZWRMaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoRGF0ZUNoYW5nZWRMaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIERhdGVDaGFuZ2VkTGlzdGVuZXJJbXBsKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIERhdGVDaGFuZ2VkTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vbkRhdGVDaGFuZ2VkID0gZnVuY3Rpb24gKHBpY2tlciwgeWVhciwgbW9udGgsIGRheSkge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIHZhciBkYXRlQ2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHllYXIgIT09IG93bmVyLnllYXIpIHtcbiAgICAgICAgICAgICAgICBkYXRlX3BpY2tlcl9jb21tb25fMS55ZWFyUHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIHllYXIpO1xuICAgICAgICAgICAgICAgIGRhdGVDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtb250aCAhPT0gKG93bmVyLm1vbnRoIC0gMSkpIHtcbiAgICAgICAgICAgICAgICBkYXRlX3BpY2tlcl9jb21tb25fMS5tb250aFByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKG93bmVyLCBtb250aCArIDEpO1xuICAgICAgICAgICAgICAgIGRhdGVDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkYXkgIT09IG93bmVyLmRheSkge1xuICAgICAgICAgICAgICAgIGRhdGVfcGlja2VyX2NvbW1vbl8xLmRheVByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKG93bmVyLCBkYXkpO1xuICAgICAgICAgICAgICAgIGRhdGVDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkYXRlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGRhdGVfcGlja2VyX2NvbW1vbl8xLmRhdGVQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgbmV3IERhdGUoeWVhciwgbW9udGgsIGRheSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEYXRlQ2hhbmdlZExpc3RlbmVySW1wbCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgSW50ZXJmYWNlcyhbYW5kcm9pZC53aWRnZXQuRGF0ZVBpY2tlci5PbkRhdGVDaGFuZ2VkTGlzdGVuZXJdKVxuICAgICAgICBdLCBEYXRlQ2hhbmdlZExpc3RlbmVySW1wbCk7XG4gICAgICAgIHJldHVybiBEYXRlQ2hhbmdlZExpc3RlbmVySW1wbDtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICBEYXRlQ2hhbmdlZExpc3RlbmVyID0gRGF0ZUNoYW5nZWRMaXN0ZW5lckltcGw7XG59XG52YXIgRGF0ZVBpY2tlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKERhdGVQaWNrZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRGF0ZVBpY2tlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBEYXRlUGlja2VyLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGlja2VyID0gbmV3IGFuZHJvaWQud2lkZ2V0LkRhdGVQaWNrZXIodGhpcy5fY29udGV4dCk7XG4gICAgICAgIHBpY2tlci5zZXRDYWxlbmRhclZpZXdTaG93bihmYWxzZSk7XG4gICAgICAgIHJldHVybiBwaWNrZXI7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICBpbml0aWFsaXplRGF0ZUNoYW5nZWRMaXN0ZW5lcigpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gbmV3IERhdGVDaGFuZ2VkTGlzdGVuZXIodGhpcyk7XG4gICAgICAgIG5hdGl2ZVZpZXcuaW5pdCh0aGlzLnllYXIsIHRoaXMubW9udGggLSAxLCB0aGlzLmRheSwgbGlzdGVuZXIpO1xuICAgICAgICBuYXRpdmVWaWV3Lmxpc3RlbmVyID0gbGlzdGVuZXI7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmxpc3RlbmVyLm93bmVyID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGUudXBkYXRlTmF0aXZlRGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciB5ZWFyID0gdHlwZW9mIHRoaXMueWVhciA9PT0gXCJudW1iZXJcIiA/IHRoaXMueWVhciA6IG5hdGl2ZVZpZXcuZ2V0WWVhcigpO1xuICAgICAgICB2YXIgbW9udGggPSB0eXBlb2YgdGhpcy5tb250aCA9PT0gXCJudW1iZXJcIiA/IHRoaXMubW9udGggLSAxIDogbmF0aXZlVmlldy5nZXRNb250aCgpO1xuICAgICAgICB2YXIgZGF5ID0gdHlwZW9mIHRoaXMuZGF5ID09PSBcIm51bWJlclwiID8gdGhpcy5kYXkgOiBuYXRpdmVWaWV3LmdldERheU9mTW9udGgoKTtcbiAgICAgICAgdGhpcy5kYXRlID0gbmV3IERhdGUoeWVhciwgbW9udGgsIGRheSk7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyLnByb3RvdHlwZVtkYXRlX3BpY2tlcl9jb21tb25fMS55ZWFyUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFllYXIoKSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTmF0aXZlRGF0ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBEYXRlUGlja2VyLnByb3RvdHlwZVtkYXRlX3BpY2tlcl9jb21tb25fMS5tb250aFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRNb250aCgpICE9PSAodmFsdWUgLSAxKSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVOYXRpdmVEYXRlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIERhdGVQaWNrZXIucHJvdG90eXBlW2RhdGVfcGlja2VyX2NvbW1vbl8xLmRheVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXREYXlPZk1vbnRoKCkgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU5hdGl2ZURhdGUoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGVbZGF0ZV9waWNrZXJfY29tbW9uXzEuZGF0ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3LmdldERheU9mTW9udGgoKSAhPT0gdmFsdWUuZ2V0RGF0ZSgpXG4gICAgICAgICAgICB8fCBuYXRpdmVWaWV3LmdldE1vbnRoKCkgIT09IHZhbHVlLmdldE1vbnRoKClcbiAgICAgICAgICAgIHx8IG5hdGl2ZVZpZXcuZ2V0WWVhcigpICE9PSB2YWx1ZS5nZXRGdWxsWWVhcigpKSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnVwZGF0ZURhdGUodmFsdWUuZ2V0RnVsbFllYXIoKSwgdmFsdWUuZ2V0TW9udGgoKSwgdmFsdWUuZ2V0RGF0ZSgpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGVbZGF0ZV9waWNrZXJfY29tbW9uXzEubWF4RGF0ZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldE1heERhdGUoKTtcbiAgICB9O1xuICAgIERhdGVQaWNrZXIucHJvdG90eXBlW2RhdGVfcGlja2VyX2NvbW1vbl8xLm1heERhdGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuZXdWYWx1ZSA9IHZhbHVlIGluc3RhbmNlb2YgRGF0ZSA/IHZhbHVlLmdldFRpbWUoKSA6IHZhbHVlO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0TWF4RGF0ZShuZXdWYWx1ZSk7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyLnByb3RvdHlwZVtkYXRlX3BpY2tlcl9jb21tb25fMS5taW5EYXRlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0TWluRGF0ZSgpO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGVbZGF0ZV9waWNrZXJfY29tbW9uXzEubWluRGF0ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5ld1ZhbHVlID0gdmFsdWUgaW5zdGFuY2VvZiBEYXRlID8gdmFsdWUuZ2V0VGltZSgpIDogdmFsdWU7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRNaW5EYXRlKG5ld1ZhbHVlKTtcbiAgICB9O1xuICAgIHJldHVybiBEYXRlUGlja2VyO1xufShkYXRlX3BpY2tlcl9jb21tb25fMS5EYXRlUGlja2VyQmFzZSkpO1xuZXhwb3J0cy5EYXRlUGlja2VyID0gRGF0ZVBpY2tlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGUtcGlja2VyLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vcGxhdGZvcm1cIik7XG52YXIgdHlwZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy90eXBlc1wiKTtcbmV4cG9ydHMuU1RSSU5HID0gXCJzdHJpbmdcIjtcbmV4cG9ydHMuUFJPTVBUID0gXCJQcm9tcHRcIjtcbmV4cG9ydHMuQ09ORklSTSA9IFwiQ29uZmlybVwiO1xuZXhwb3J0cy5BTEVSVCA9IFwiQWxlcnRcIjtcbmV4cG9ydHMuTE9HSU4gPSBcIkxvZ2luXCI7XG5leHBvcnRzLk9LID0gXCJPS1wiO1xuZXhwb3J0cy5DQU5DRUwgPSBcIkNhbmNlbFwiO1xudmFyIGlucHV0VHlwZTtcbihmdW5jdGlvbiAoaW5wdXRUeXBlKSB7XG4gICAgaW5wdXRUeXBlLnRleHQgPSBcInRleHRcIjtcbiAgICBpbnB1dFR5cGUucGFzc3dvcmQgPSBcInBhc3N3b3JkXCI7XG4gICAgaW5wdXRUeXBlLmVtYWlsID0gXCJlbWFpbFwiO1xuICAgIGlucHV0VHlwZS5udW1iZXIgPSBcIm51bWJlclwiO1xuICAgIGlucHV0VHlwZS5kZWNpbWFsID0gXCJkZWNpbWFsXCI7XG4gICAgaW5wdXRUeXBlLnBob25lID0gXCJwaG9uZVwiO1xufSkoaW5wdXRUeXBlID0gZXhwb3J0cy5pbnB1dFR5cGUgfHwgKGV4cG9ydHMuaW5wdXRUeXBlID0ge30pKTtcbnZhciBjYXBpdGFsaXphdGlvblR5cGU7XG4oZnVuY3Rpb24gKGNhcGl0YWxpemF0aW9uVHlwZSkge1xuICAgIGNhcGl0YWxpemF0aW9uVHlwZS5ub25lID0gXCJub25lXCI7XG4gICAgY2FwaXRhbGl6YXRpb25UeXBlLmFsbCA9IFwiYWxsXCI7XG4gICAgY2FwaXRhbGl6YXRpb25UeXBlLnNlbnRlbmNlcyA9IFwic2VudGVuY2VzXCI7XG4gICAgY2FwaXRhbGl6YXRpb25UeXBlLndvcmRzID0gXCJ3b3Jkc1wiO1xufSkoY2FwaXRhbGl6YXRpb25UeXBlID0gZXhwb3J0cy5jYXBpdGFsaXphdGlvblR5cGUgfHwgKGV4cG9ydHMuY2FwaXRhbGl6YXRpb25UeXBlID0ge30pKTtcbnZhciBmcmFtZTtcbmZ1bmN0aW9uIGdldEN1cnJlbnRQYWdlKCkge1xuICAgIGlmICghZnJhbWUpIHtcbiAgICAgICAgZnJhbWUgPSByZXF1aXJlKFwiLi4vZnJhbWVcIik7XG4gICAgfVxuICAgIHZhciB0b3Btb3N0RnJhbWUgPSBmcmFtZS50b3Btb3N0KCk7XG4gICAgaWYgKHRvcG1vc3RGcmFtZSkge1xuICAgICAgICByZXR1cm4gdG9wbW9zdEZyYW1lLmN1cnJlbnRQYWdlO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuZXhwb3J0cy5nZXRDdXJyZW50UGFnZSA9IGdldEN1cnJlbnRQYWdlO1xuZnVuY3Rpb24gYXBwbHlTZWxlY3RvcnModmlldywgY2FsbGJhY2spIHtcbiAgICB2YXIgY3VycmVudFBhZ2UgPSBnZXRDdXJyZW50UGFnZSgpO1xuICAgIGlmIChjdXJyZW50UGFnZSkge1xuICAgICAgICB2YXIgc3R5bGVTY29wZSA9IGN1cnJlbnRQYWdlLl9zdHlsZVNjb3BlO1xuICAgICAgICBpZiAoc3R5bGVTY29wZSkge1xuICAgICAgICAgICAgdmlldy5faW5oZXJpdFN0eWxlU2NvcGUoc3R5bGVTY29wZSk7XG4gICAgICAgICAgICB2aWV3Lm9uTG9hZGVkKCk7XG4gICAgICAgICAgICBjYWxsYmFjayh2aWV3KTtcbiAgICAgICAgICAgIHZpZXcub25VbmxvYWRlZCgpO1xuICAgICAgICB9XG4gICAgfVxufVxudmFyIGJ1dHRvbjtcbnZhciBsYWJlbDtcbnZhciB0ZXh0RmllbGQ7XG5mdW5jdGlvbiBnZXRCdXR0b25Db2xvcnMoKSB7XG4gICAgaWYgKCFidXR0b24pIHtcbiAgICAgICAgdmFyIEJ1dHRvbiA9IHJlcXVpcmUoXCIuLi9idXR0b25cIikuQnV0dG9uO1xuICAgICAgICBidXR0b24gPSBuZXcgQnV0dG9uO1xuICAgICAgICBpZiAocGxhdGZvcm1fMS5pc0lPUykge1xuICAgICAgICAgICAgYnV0dG9uLl9zZXR1cFVJKHt9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgYnV0dG9uQ29sb3I7XG4gICAgdmFyIGJ1dHRvbkJhY2tncm91bmRDb2xvcjtcbiAgICBhcHBseVNlbGVjdG9ycyhidXR0b24sIGZ1bmN0aW9uIChidG4pIHtcbiAgICAgICAgYnV0dG9uQ29sb3IgPSBidG4uY29sb3I7XG4gICAgICAgIGJ1dHRvbkJhY2tncm91bmRDb2xvciA9IGJ0bi5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgfSk7XG4gICAgcmV0dXJuIHsgY29sb3I6IGJ1dHRvbkNvbG9yLCBiYWNrZ3JvdW5kQ29sb3I6IGJ1dHRvbkJhY2tncm91bmRDb2xvciB9O1xufVxuZXhwb3J0cy5nZXRCdXR0b25Db2xvcnMgPSBnZXRCdXR0b25Db2xvcnM7XG5mdW5jdGlvbiBnZXRMYWJlbENvbG9yKCkge1xuICAgIGlmICghbGFiZWwpIHtcbiAgICAgICAgdmFyIExhYmVsID0gcmVxdWlyZShcIi4uL2xhYmVsXCIpLkxhYmVsO1xuICAgICAgICBsYWJlbCA9IG5ldyBMYWJlbDtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuaXNJT1MpIHtcbiAgICAgICAgICAgIGxhYmVsLl9zZXR1cFVJKHt9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgbGFiZWxDb2xvcjtcbiAgICBhcHBseVNlbGVjdG9ycyhsYWJlbCwgZnVuY3Rpb24gKGxibCkge1xuICAgICAgICBsYWJlbENvbG9yID0gbGJsLmNvbG9yO1xuICAgIH0pO1xuICAgIHJldHVybiBsYWJlbENvbG9yO1xufVxuZXhwb3J0cy5nZXRMYWJlbENvbG9yID0gZ2V0TGFiZWxDb2xvcjtcbmZ1bmN0aW9uIGdldFRleHRGaWVsZENvbG9yKCkge1xuICAgIGlmICghdGV4dEZpZWxkKSB7XG4gICAgICAgIHZhciBUZXh0RmllbGQgPSByZXF1aXJlKFwiLi4vdGV4dC1maWVsZFwiKS5UZXh0RmllbGQ7XG4gICAgICAgIHRleHRGaWVsZCA9IG5ldyBUZXh0RmllbGQoKTtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuaXNJT1MpIHtcbiAgICAgICAgICAgIHRleHRGaWVsZC5fc2V0dXBVSSh7fSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHRleHRGaWVsZENvbG9yO1xuICAgIGFwcGx5U2VsZWN0b3JzKHRleHRGaWVsZCwgZnVuY3Rpb24gKHRmKSB7XG4gICAgICAgIHRleHRGaWVsZENvbG9yID0gdGYuY29sb3I7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRleHRGaWVsZENvbG9yO1xufVxuZXhwb3J0cy5nZXRUZXh0RmllbGRDb2xvciA9IGdldFRleHRGaWVsZENvbG9yO1xuZnVuY3Rpb24gaXNEaWFsb2dPcHRpb25zKGFyZykge1xuICAgIHJldHVybiBhcmcgJiYgKGFyZy5tZXNzYWdlIHx8IGFyZy50aXRsZSk7XG59XG5leHBvcnRzLmlzRGlhbG9nT3B0aW9ucyA9IGlzRGlhbG9nT3B0aW9ucztcbmZ1bmN0aW9uIHBhcnNlTG9naW5PcHRpb25zKGFyZ3MpIHtcbiAgICBpZiAoYXJncy5sZW5ndGggPT09IDEgJiYgdHlwZXNfMS5pc09iamVjdChhcmdzWzBdKSkge1xuICAgICAgICByZXR1cm4gYXJnc1swXTtcbiAgICB9XG4gICAgdmFyIG9wdGlvbnMgPSB7IHRpdGxlOiBleHBvcnRzLkxPR0lOLCBva0J1dHRvblRleHQ6IGV4cG9ydHMuT0ssIGNhbmNlbEJ1dHRvblRleHQ6IGV4cG9ydHMuQ0FOQ0VMIH07XG4gICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoYXJnc1swXSkpIHtcbiAgICAgICAgb3B0aW9ucy5tZXNzYWdlID0gYXJnc1swXTtcbiAgICB9XG4gICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoYXJnc1sxXSkpIHtcbiAgICAgICAgb3B0aW9ucy51c2VyTmFtZUhpbnQgPSBhcmdzWzFdO1xuICAgIH1cbiAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhhcmdzWzJdKSkge1xuICAgICAgICBvcHRpb25zLnBhc3N3b3JkSGludCA9IGFyZ3NbMl07XG4gICAgfVxuICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKGFyZ3NbM10pKSB7XG4gICAgICAgIG9wdGlvbnMudXNlck5hbWUgPSBhcmdzWzNdO1xuICAgIH1cbiAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhhcmdzWzRdKSkge1xuICAgICAgICBvcHRpb25zLnBhc3N3b3JkID0gYXJnc1s0XTtcbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvbnM7XG59XG5leHBvcnRzLnBhcnNlTG9naW5PcHRpb25zID0gcGFyc2VMb2dpbk9wdGlvbnM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kaWFsb2dzLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGRpYWxvZ3NfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9kaWFsb2dzLWNvbW1vblwiKTtcbnZhciBhcHBsaWNhdGlvbl8xID0gcmVxdWlyZShcIi4uLy4uL2FwcGxpY2F0aW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vZGlhbG9ncy1jb21tb25cIikpO1xuZnVuY3Rpb24gaXNTdHJpbmcodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiO1xufVxuZnVuY3Rpb24gY3JlYXRlQWxlcnREaWFsb2cob3B0aW9ucykge1xuICAgIHZhciBhbGVydCA9IG5ldyBhbmRyb2lkLmFwcC5BbGVydERpYWxvZy5CdWlsZGVyKGFwcGxpY2F0aW9uXzEuYW5kcm9pZC5mb3JlZ3JvdW5kQWN0aXZpdHkpO1xuICAgIGFsZXJ0LnNldFRpdGxlKG9wdGlvbnMgJiYgaXNTdHJpbmcob3B0aW9ucy50aXRsZSkgPyBvcHRpb25zLnRpdGxlIDogXCJcIik7XG4gICAgYWxlcnQuc2V0TWVzc2FnZShvcHRpb25zICYmIGlzU3RyaW5nKG9wdGlvbnMubWVzc2FnZSkgPyBvcHRpb25zLm1lc3NhZ2UgOiBcIlwiKTtcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmNhbmNlbGFibGUgPT09IGZhbHNlKSB7XG4gICAgICAgIGFsZXJ0LnNldENhbmNlbGFibGUoZmFsc2UpO1xuICAgIH1cbiAgICByZXR1cm4gYWxlcnQ7XG59XG5mdW5jdGlvbiBzaG93RGlhbG9nKGJ1aWxkZXIpIHtcbiAgICB2YXIgZGxnID0gYnVpbGRlci5zaG93KCk7XG4gICAgdmFyIGxhYmVsQ29sb3IgPSBkaWFsb2dzX2NvbW1vbl8xLmdldExhYmVsQ29sb3IoKTtcbiAgICBpZiAobGFiZWxDb2xvcikge1xuICAgICAgICB2YXIgdGV4dFZpZXdJZCA9IGRsZy5nZXRDb250ZXh0KCkuZ2V0UmVzb3VyY2VzKCkuZ2V0SWRlbnRpZmllcihcImFuZHJvaWQ6aWQvYWxlcnRUaXRsZVwiLCBudWxsLCBudWxsKTtcbiAgICAgICAgaWYgKHRleHRWaWV3SWQpIHtcbiAgICAgICAgICAgIHZhciB0diA9IGRsZy5maW5kVmlld0J5SWQodGV4dFZpZXdJZCk7XG4gICAgICAgICAgICBpZiAodHYpIHtcbiAgICAgICAgICAgICAgICB0di5zZXRUZXh0Q29sb3IobGFiZWxDb2xvci5hbmRyb2lkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgbWVzc2FnZVRleHRWaWV3SWQgPSBkbGcuZ2V0Q29udGV4dCgpLmdldFJlc291cmNlcygpLmdldElkZW50aWZpZXIoXCJhbmRyb2lkOmlkL21lc3NhZ2VcIiwgbnVsbCwgbnVsbCk7XG4gICAgICAgIGlmIChtZXNzYWdlVGV4dFZpZXdJZCkge1xuICAgICAgICAgICAgdmFyIG1lc3NhZ2VUZXh0VmlldyA9IGRsZy5maW5kVmlld0J5SWQobWVzc2FnZVRleHRWaWV3SWQpO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2VUZXh0Vmlldykge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0Vmlldy5zZXRUZXh0Q29sb3IobGFiZWxDb2xvci5hbmRyb2lkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgX2EgPSBkaWFsb2dzX2NvbW1vbl8xLmdldEJ1dHRvbkNvbG9ycygpLCBjb2xvciA9IF9hLmNvbG9yLCBiYWNrZ3JvdW5kQ29sb3IgPSBfYS5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgaWYgKGNvbG9yKSB7XG4gICAgICAgIHZhciBidXR0b25zID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMzsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaWQgPSBkbGcuZ2V0Q29udGV4dCgpLmdldFJlc291cmNlcygpLmdldElkZW50aWZpZXIoXCJhbmRyb2lkOmlkL2J1dHRvblwiICsgaSwgbnVsbCwgbnVsbCk7XG4gICAgICAgICAgICBidXR0b25zW2ldID0gZGxnLmZpbmRWaWV3QnlJZChpZCk7XG4gICAgICAgIH1cbiAgICAgICAgYnV0dG9ucy5mb3JFYWNoKGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgICAgICAgIGlmIChidXR0b24pIHtcbiAgICAgICAgICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldFRleHRDb2xvcihjb2xvci5hbmRyb2lkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGJhY2tncm91bmRDb2xvcikge1xuICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0QmFja2dyb3VuZENvbG9yKGJhY2tncm91bmRDb2xvci5hbmRyb2lkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFkZEJ1dHRvbnNUb0FsZXJ0RGlhbG9nKGFsZXJ0LCBvcHRpb25zLCBjYWxsYmFjaykge1xuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChvcHRpb25zLm9rQnV0dG9uVGV4dCkge1xuICAgICAgICBhbGVydC5zZXRQb3NpdGl2ZUJ1dHRvbihvcHRpb25zLm9rQnV0dG9uVGV4dCwgbmV3IGFuZHJvaWQuY29udGVudC5EaWFsb2dJbnRlcmZhY2UuT25DbGlja0xpc3RlbmVyKHtcbiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIChkaWFsb2csIGlkKSB7XG4gICAgICAgICAgICAgICAgZGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLmNhbmNlbEJ1dHRvblRleHQpIHtcbiAgICAgICAgYWxlcnQuc2V0TmVnYXRpdmVCdXR0b24ob3B0aW9ucy5jYW5jZWxCdXR0b25UZXh0LCBuZXcgYW5kcm9pZC5jb250ZW50LkRpYWxvZ0ludGVyZmFjZS5PbkNsaWNrTGlzdGVuZXIoe1xuICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24gKGRpYWxvZywgaWQpIHtcbiAgICAgICAgICAgICAgICBkaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLm5ldXRyYWxCdXR0b25UZXh0KSB7XG4gICAgICAgIGFsZXJ0LnNldE5ldXRyYWxCdXR0b24ob3B0aW9ucy5uZXV0cmFsQnV0dG9uVGV4dCwgbmV3IGFuZHJvaWQuY29udGVudC5EaWFsb2dJbnRlcmZhY2UuT25DbGlja0xpc3RlbmVyKHtcbiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIChkaWFsb2csIGlkKSB7XG4gICAgICAgICAgICAgICAgZGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgYWxlcnQuc2V0T25EaXNtaXNzTGlzdGVuZXIobmV3IGFuZHJvaWQuY29udGVudC5EaWFsb2dJbnRlcmZhY2UuT25EaXNtaXNzTGlzdGVuZXIoe1xuICAgICAgICBvbkRpc21pc3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0pKTtcbn1cbmZ1bmN0aW9uIGFsZXJ0KGFyZykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9ICFkaWFsb2dzX2NvbW1vbl8xLmlzRGlhbG9nT3B0aW9ucyhhcmcpID8geyB0aXRsZTogZGlhbG9nc19jb21tb25fMS5BTEVSVCwgb2tCdXR0b25UZXh0OiBkaWFsb2dzX2NvbW1vbl8xLk9LLCBtZXNzYWdlOiBhcmcgKyBcIlwiIH0gOiBhcmc7XG4gICAgICAgICAgICB2YXIgYWxlcnRfMSA9IGNyZWF0ZUFsZXJ0RGlhbG9nKG9wdGlvbnMpO1xuICAgICAgICAgICAgYWxlcnRfMS5zZXRQb3NpdGl2ZUJ1dHRvbihvcHRpb25zLm9rQnV0dG9uVGV4dCwgbmV3IGFuZHJvaWQuY29udGVudC5EaWFsb2dJbnRlcmZhY2UuT25DbGlja0xpc3RlbmVyKHtcbiAgICAgICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiAoZGlhbG9nLCBpZCkge1xuICAgICAgICAgICAgICAgICAgICBkaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBhbGVydF8xLnNldE9uRGlzbWlzc0xpc3RlbmVyKG5ldyBhbmRyb2lkLmNvbnRlbnQuRGlhbG9nSW50ZXJmYWNlLk9uRGlzbWlzc0xpc3RlbmVyKHtcbiAgICAgICAgICAgICAgICBvbkRpc21pc3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHNob3dEaWFsb2coYWxlcnRfMSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLmFsZXJ0ID0gYWxlcnQ7XG5mdW5jdGlvbiBjb25maXJtKGFyZykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9ICFkaWFsb2dzX2NvbW1vbl8xLmlzRGlhbG9nT3B0aW9ucyhhcmcpID8geyB0aXRsZTogZGlhbG9nc19jb21tb25fMS5DT05GSVJNLCBva0J1dHRvblRleHQ6IGRpYWxvZ3NfY29tbW9uXzEuT0ssIGNhbmNlbEJ1dHRvblRleHQ6IGRpYWxvZ3NfY29tbW9uXzEuQ0FOQ0VMLCBtZXNzYWdlOiBhcmcgKyBcIlwiIH0gOiBhcmc7XG4gICAgICAgICAgICB2YXIgYWxlcnRfMiA9IGNyZWF0ZUFsZXJ0RGlhbG9nKG9wdGlvbnMpO1xuICAgICAgICAgICAgYWRkQnV0dG9uc1RvQWxlcnREaWFsb2coYWxlcnRfMiwgb3B0aW9ucywgZnVuY3Rpb24gKHJlc3VsdCkgeyByZXNvbHZlKHJlc3VsdCk7IH0pO1xuICAgICAgICAgICAgc2hvd0RpYWxvZyhhbGVydF8yKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIHJlamVjdChleCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmV4cG9ydHMuY29uZmlybSA9IGNvbmZpcm07XG5mdW5jdGlvbiBwcm9tcHQoYXJnKSB7XG4gICAgdmFyIG9wdGlvbnM7XG4gICAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgICAgICB0aXRsZTogZGlhbG9nc19jb21tb25fMS5QUk9NUFQsXG4gICAgICAgIG9rQnV0dG9uVGV4dDogZGlhbG9nc19jb21tb25fMS5PSyxcbiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogZGlhbG9nc19jb21tb25fMS5DQU5DRUwsXG4gICAgICAgIGlucHV0VHlwZTogZGlhbG9nc19jb21tb25fMS5pbnB1dFR5cGUudGV4dCxcbiAgICB9O1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGlmIChpc1N0cmluZyhhcmcpKSB7XG4gICAgICAgICAgICBvcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgICAgICBvcHRpb25zLm1lc3NhZ2UgPSBhcmc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBvcHRpb25zID0gYXJnO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgaWYgKGlzU3RyaW5nKGFyZ3VtZW50c1swXSkgJiYgaXNTdHJpbmcoYXJndW1lbnRzWzFdKSkge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucy5tZXNzYWdlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgb3B0aW9ucy5kZWZhdWx0VGV4dCA9IGFyZ3VtZW50c1sxXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGFsZXJ0XzMgPSBjcmVhdGVBbGVydERpYWxvZyhvcHRpb25zKTtcbiAgICAgICAgICAgIHZhciBpbnB1dF8xID0gbmV3IGFuZHJvaWQud2lkZ2V0LkVkaXRUZXh0KGFwcGxpY2F0aW9uXzEuYW5kcm9pZC5mb3JlZ3JvdW5kQWN0aXZpdHkpO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5pbnB1dFR5cGUgPT09IGRpYWxvZ3NfY29tbW9uXzEuaW5wdXRUeXBlLnBhc3N3b3JkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0XzEuc2V0SW5wdXRUeXBlKGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9DTEFTU19URVhUIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfVkFSSUFUSU9OX1BBU1NXT1JEKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAob3B0aW9ucy5pbnB1dFR5cGUgPT09IGRpYWxvZ3NfY29tbW9uXzEuaW5wdXRUeXBlLmVtYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0XzEuc2V0SW5wdXRUeXBlKGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9DTEFTU19URVhUIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfVkFSSUFUSU9OX0VNQUlMX0FERFJFU1MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChvcHRpb25zLmlucHV0VHlwZSA9PT0gZGlhbG9nc19jb21tb25fMS5pbnB1dFR5cGUubnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0XzEuc2V0SW5wdXRUeXBlKGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9DTEFTU19OVU1CRVIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChvcHRpb25zLmlucHV0VHlwZSA9PT0gZGlhbG9nc19jb21tb25fMS5pbnB1dFR5cGUuZGVjaW1hbCkge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dF8xLnNldElucHV0VHlwZShhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfTlVNQkVSIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX05VTUJFUl9GTEFHX0RFQ0lNQUwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChvcHRpb25zLmlucHV0VHlwZSA9PT0gZGlhbG9nc19jb21tb25fMS5pbnB1dFR5cGUucGhvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRfMS5zZXRJbnB1dFR5cGUoYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX1BIT05FKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3dpdGNoIChvcHRpb25zLmNhcGl0YWxpemF0aW9uVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIGRpYWxvZ3NfY29tbW9uXzEuY2FwaXRhbGl6YXRpb25UeXBlLmFsbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRfMS5zZXRJbnB1dFR5cGUoaW5wdXRfMS5nZXRJbnB1dFR5cGUoKSB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQ0FQX0NIQVJBQ1RFUlMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSBkaWFsb2dzX2NvbW1vbl8xLmNhcGl0YWxpemF0aW9uVHlwZS5zZW50ZW5jZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0XzEuc2V0SW5wdXRUeXBlKGlucHV0XzEuZ2V0SW5wdXRUeXBlKCkgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0NBUF9TRU5URU5DRVMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSBkaWFsb2dzX2NvbW1vbl8xLmNhcGl0YWxpemF0aW9uVHlwZS53b3Jkczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRfMS5zZXRJbnB1dFR5cGUoaW5wdXRfMS5nZXRJbnB1dFR5cGUoKSB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQ0FQX1dPUkRTKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5wdXRfMS5zZXRUZXh0KG9wdGlvbnMgJiYgb3B0aW9ucy5kZWZhdWx0VGV4dCB8fCBcIlwiKTtcbiAgICAgICAgICAgIGFsZXJ0XzMuc2V0VmlldyhpbnB1dF8xKTtcbiAgICAgICAgICAgIHZhciBnZXRUZXh0XzEgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBpbnB1dF8xLmdldFRleHQoKS50b1N0cmluZygpOyB9O1xuICAgICAgICAgICAgYWRkQnV0dG9uc1RvQWxlcnREaWFsb2coYWxlcnRfMywgb3B0aW9ucywgZnVuY3Rpb24gKHIpIHsgcmVzb2x2ZSh7IHJlc3VsdDogciwgdGV4dDogZ2V0VGV4dF8xKCkgfSk7IH0pO1xuICAgICAgICAgICAgc2hvd0RpYWxvZyhhbGVydF8zKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIHJlamVjdChleCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmV4cG9ydHMucHJvbXB0ID0gcHJvbXB0O1xuZnVuY3Rpb24gbG9naW4oKSB7XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHZhciBvcHRpb25zID0gZGlhbG9nc19jb21tb25fMS5wYXJzZUxvZ2luT3B0aW9ucyhhcmdzKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGNvbnRleHRfMSA9IGFwcGxpY2F0aW9uXzEuYW5kcm9pZC5mb3JlZ3JvdW5kQWN0aXZpdHk7XG4gICAgICAgICAgICB2YXIgYWxlcnRfNCA9IGNyZWF0ZUFsZXJ0RGlhbG9nKG9wdGlvbnMpO1xuICAgICAgICAgICAgdmFyIHVzZXJOYW1lSW5wdXRfMSA9IG5ldyBhbmRyb2lkLndpZGdldC5FZGl0VGV4dChjb250ZXh0XzEpO1xuICAgICAgICAgICAgdXNlck5hbWVJbnB1dF8xLnNldEhpbnQob3B0aW9ucy51c2VyTmFtZUhpbnQgPyBvcHRpb25zLnVzZXJOYW1lSGludCA6IFwiXCIpO1xuICAgICAgICAgICAgdXNlck5hbWVJbnB1dF8xLnNldFRleHQob3B0aW9ucy51c2VyTmFtZSA/IG9wdGlvbnMudXNlck5hbWUgOiBcIlwiKTtcbiAgICAgICAgICAgIHZhciBwYXNzd29yZElucHV0XzEgPSBuZXcgYW5kcm9pZC53aWRnZXQuRWRpdFRleHQoY29udGV4dF8xKTtcbiAgICAgICAgICAgIHBhc3N3b3JkSW5wdXRfMS5zZXRJbnB1dFR5cGUoYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX1RFWFQgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9WQVJJQVRJT05fUEFTU1dPUkQpO1xuICAgICAgICAgICAgcGFzc3dvcmRJbnB1dF8xLnNldFR5cGVmYWNlKGFuZHJvaWQuZ3JhcGhpY3MuVHlwZWZhY2UuREVGQVVMVCk7XG4gICAgICAgICAgICBwYXNzd29yZElucHV0XzEuc2V0SGludChvcHRpb25zLnBhc3N3b3JkSGludCA/IG9wdGlvbnMucGFzc3dvcmRIaW50IDogXCJcIik7XG4gICAgICAgICAgICBwYXNzd29yZElucHV0XzEuc2V0VGV4dChvcHRpb25zLnBhc3N3b3JkID8gb3B0aW9ucy5wYXNzd29yZCA6IFwiXCIpO1xuICAgICAgICAgICAgdmFyIGxheW91dCA9IG5ldyBhbmRyb2lkLndpZGdldC5MaW5lYXJMYXlvdXQoY29udGV4dF8xKTtcbiAgICAgICAgICAgIGxheW91dC5zZXRPcmllbnRhdGlvbigxKTtcbiAgICAgICAgICAgIGxheW91dC5hZGRWaWV3KHVzZXJOYW1lSW5wdXRfMSk7XG4gICAgICAgICAgICBsYXlvdXQuYWRkVmlldyhwYXNzd29yZElucHV0XzEpO1xuICAgICAgICAgICAgYWxlcnRfNC5zZXRWaWV3KGxheW91dCk7XG4gICAgICAgICAgICBhZGRCdXR0b25zVG9BbGVydERpYWxvZyhhbGVydF80LCBvcHRpb25zLCBmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoe1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IHIsXG4gICAgICAgICAgICAgICAgICAgIHVzZXJOYW1lOiB1c2VyTmFtZUlucHV0XzEuZ2V0VGV4dCgpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZElucHV0XzEuZ2V0VGV4dCgpLnRvU3RyaW5nKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2hvd0RpYWxvZyhhbGVydF80KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIHJlamVjdChleCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmV4cG9ydHMubG9naW4gPSBsb2dpbjtcbmZ1bmN0aW9uIGFjdGlvbihhcmcpIHtcbiAgICB2YXIgb3B0aW9ucztcbiAgICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7IHRpdGxlOiBudWxsLCBjYW5jZWxCdXR0b25UZXh0OiBkaWFsb2dzX2NvbW1vbl8xLkNBTkNFTCB9O1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGlmIChpc1N0cmluZyhhcmd1bWVudHNbMF0pKSB7XG4gICAgICAgICAgICBvcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgICAgICBvcHRpb25zLm1lc3NhZ2UgPSBhcmd1bWVudHNbMF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBvcHRpb25zID0gYXJndW1lbnRzWzBdO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgaWYgKGlzU3RyaW5nKGFyZ3VtZW50c1swXSkgJiYgaXNTdHJpbmcoYXJndW1lbnRzWzFdKSkge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucy5tZXNzYWdlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgb3B0aW9ucy5jYW5jZWxCdXR0b25UZXh0ID0gYXJndW1lbnRzWzFdO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgaWYgKGlzU3RyaW5nKGFyZ3VtZW50c1swXSkgJiYgaXNTdHJpbmcoYXJndW1lbnRzWzFdKSAmJiB0eXBlb2YgYXJndW1lbnRzWzJdICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBvcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgICAgICBvcHRpb25zLm1lc3NhZ2UgPSBhcmd1bWVudHNbMF07XG4gICAgICAgICAgICBvcHRpb25zLmNhbmNlbEJ1dHRvblRleHQgPSBhcmd1bWVudHNbMV07XG4gICAgICAgICAgICBvcHRpb25zLmFjdGlvbnMgPSBhcmd1bWVudHNbMl07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBhY3Rpdml0eSA9IGFwcGxpY2F0aW9uXzEuYW5kcm9pZC5mb3JlZ3JvdW5kQWN0aXZpdHkgfHwgYXBwbGljYXRpb25fMS5hbmRyb2lkLnN0YXJ0QWN0aXZpdHk7XG4gICAgICAgICAgICB2YXIgYWxlcnRfNSA9IG5ldyBhbmRyb2lkLmFwcC5BbGVydERpYWxvZy5CdWlsZGVyKGFjdGl2aXR5KTtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0gb3B0aW9ucyAmJiBpc1N0cmluZyhvcHRpb25zLm1lc3NhZ2UpID8gb3B0aW9ucy5tZXNzYWdlIDogXCJcIjtcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IG9wdGlvbnMgJiYgaXNTdHJpbmcob3B0aW9ucy50aXRsZSkgPyBvcHRpb25zLnRpdGxlIDogXCJcIjtcbiAgICAgICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuY2FuY2VsYWJsZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBhbGVydF81LnNldENhbmNlbGFibGUoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgYWxlcnRfNS5zZXRUaXRsZSh0aXRsZSk7XG4gICAgICAgICAgICAgICAgaWYgKCFvcHRpb25zLmFjdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnRfNS5zZXRNZXNzYWdlKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFsZXJ0XzUuc2V0VGl0bGUobWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5hY3Rpb25zKSB7XG4gICAgICAgICAgICAgICAgYWxlcnRfNS5zZXRJdGVtcyhvcHRpb25zLmFjdGlvbnMsIG5ldyBhbmRyb2lkLmNvbnRlbnQuRGlhbG9nSW50ZXJmYWNlLk9uQ2xpY2tMaXN0ZW5lcih7XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIChkaWFsb2csIHdoaWNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG9wdGlvbnMuYWN0aW9uc1t3aGljaF0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzU3RyaW5nKG9wdGlvbnMuY2FuY2VsQnV0dG9uVGV4dCkpIHtcbiAgICAgICAgICAgICAgICBhbGVydF81LnNldE5lZ2F0aXZlQnV0dG9uKG9wdGlvbnMuY2FuY2VsQnV0dG9uVGV4dCwgbmV3IGFuZHJvaWQuY29udGVudC5EaWFsb2dJbnRlcmZhY2UuT25DbGlja0xpc3RlbmVyKHtcbiAgICAgICAgICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24gKGRpYWxvZywgaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob3B0aW9ucy5jYW5jZWxCdXR0b25UZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFsZXJ0XzUuc2V0T25EaXNtaXNzTGlzdGVuZXIobmV3IGFuZHJvaWQuY29udGVudC5EaWFsb2dJbnRlcmZhY2UuT25EaXNtaXNzTGlzdGVuZXIoe1xuICAgICAgICAgICAgICAgIG9uRGlzbWlzczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNTdHJpbmcob3B0aW9ucy5jYW5jZWxCdXR0b25UZXh0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvcHRpb25zLmNhbmNlbEJ1dHRvblRleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHNob3dEaWFsb2coYWxlcnRfNSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLmFjdGlvbiA9IGFjdGlvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRpYWxvZ3MuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRleHRfYmFzZV8xID0gcmVxdWlyZShcIi4uL3RleHQtYmFzZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIikpO1xudmFyIEVkaXRhYmxlVGV4dEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhFZGl0YWJsZVRleHRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEVkaXRhYmxlVGV4dEJhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fZm9jdXNIYW5kbGVyID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2dvVG9WaXN1YWxTdGF0ZShcImZvY3VzXCIpOyB9O1xuICAgICAgICBfdGhpcy5fYmx1ckhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5fZ29Ub1Zpc3VhbFN0YXRlKFwiYmx1clwiKTsgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZS5fdXBkYXRlVGV4dEJhc2VGb2N1c1N0YXRlSGFuZGxlciA9IGZ1bmN0aW9uIChzdWJzY3JpYmUpIHtcbiAgICAgICAgdmFyIG1ldGhvZCA9IHN1YnNjcmliZSA/IFwib25cIiA6IFwib2ZmXCI7XG4gICAgICAgIHRoaXNbbWV0aG9kXShcImZvY3VzXCIsIHRoaXMuX2ZvY3VzSGFuZGxlcik7XG4gICAgICAgIHRoaXNbbWV0aG9kXShcImJsdXJcIiwgdGhpcy5fYmx1ckhhbmRsZXIpO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5ibHVyRXZlbnQgPSBcImJsdXJcIjtcbiAgICBFZGl0YWJsZVRleHRCYXNlLmZvY3VzRXZlbnQgPSBcImZvY3VzXCI7XG4gICAgRWRpdGFibGVUZXh0QmFzZS50ZXh0Q2hhbmdlRXZlbnQgPSBcInRleHRDaGFuZ2VcIjtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgdGV4dF9iYXNlXzEuUHNldWRvQ2xhc3NIYW5kbGVyKFwiZm9jdXNcIiwgXCJibHVyXCIpXG4gICAgXSwgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGUsIFwiX3VwZGF0ZVRleHRCYXNlRm9jdXNTdGF0ZUhhbmRsZXJcIiwgbnVsbCk7XG4gICAgcmV0dXJuIEVkaXRhYmxlVGV4dEJhc2U7XG59KHRleHRfYmFzZV8xLlRleHRCYXNlKSk7XG5leHBvcnRzLkVkaXRhYmxlVGV4dEJhc2UgPSBFZGl0YWJsZVRleHRCYXNlO1xuZXhwb3J0cy5wbGFjZWhvbGRlckNvbG9yUHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcInBsYWNlaG9sZGVyQ29sb3JcIiwgY3NzTmFtZTogXCJwbGFjZWhvbGRlci1jb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB0ZXh0X2Jhc2VfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IHRleHRfYmFzZV8xLkNvbG9yKHYpOyB9IH0pO1xuZXhwb3J0cy5wbGFjZWhvbGRlckNvbG9yUHJvcGVydHkucmVnaXN0ZXIodGV4dF9iYXNlXzEuU3R5bGUpO1xudmFyIGtleWJvYXJkVHlwZUNvbnZlcnRlciA9IHRleHRfYmFzZV8xLm1ha2VQYXJzZXIodGV4dF9iYXNlXzEubWFrZVZhbGlkYXRvcihcImRhdGV0aW1lXCIsIFwicGhvbmVcIiwgXCJudW1iZXJcIiwgXCJ1cmxcIiwgXCJlbWFpbFwiKSk7XG5leHBvcnRzLmtleWJvYXJkVHlwZVByb3BlcnR5ID0gbmV3IHRleHRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJrZXlib2FyZFR5cGVcIiwgdmFsdWVDb252ZXJ0ZXI6IGtleWJvYXJkVHlwZUNvbnZlcnRlciB9KTtcbmV4cG9ydHMua2V5Ym9hcmRUeXBlUHJvcGVydHkucmVnaXN0ZXIoRWRpdGFibGVUZXh0QmFzZSk7XG52YXIgcmV0dXJuS2V5VHlwZUNvbnZlcnRlciA9IHRleHRfYmFzZV8xLm1ha2VQYXJzZXIodGV4dF9iYXNlXzEubWFrZVZhbGlkYXRvcihcImRvbmVcIiwgXCJuZXh0XCIsIFwiZ29cIiwgXCJzZWFyY2hcIiwgXCJzZW5kXCIpKTtcbmV4cG9ydHMucmV0dXJuS2V5VHlwZVByb3BlcnR5ID0gbmV3IHRleHRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJyZXR1cm5LZXlUeXBlXCIsIHZhbHVlQ29udmVydGVyOiByZXR1cm5LZXlUeXBlQ29udmVydGVyIH0pO1xuZXhwb3J0cy5yZXR1cm5LZXlUeXBlUHJvcGVydHkucmVnaXN0ZXIoRWRpdGFibGVUZXh0QmFzZSk7XG5leHBvcnRzLmVkaXRhYmxlUHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcImVkaXRhYmxlXCIsIGRlZmF1bHRWYWx1ZTogdHJ1ZSwgdmFsdWVDb252ZXJ0ZXI6IHRleHRfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmVkaXRhYmxlUHJvcGVydHkucmVnaXN0ZXIoRWRpdGFibGVUZXh0QmFzZSk7XG5leHBvcnRzLnVwZGF0ZVRleHRUcmlnZ2VyUHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcInVwZGF0ZVRleHRUcmlnZ2VyXCIsIGRlZmF1bHRWYWx1ZTogXCJ0ZXh0Q2hhbmdlZFwiIH0pO1xuZXhwb3J0cy51cGRhdGVUZXh0VHJpZ2dlclByb3BlcnR5LnJlZ2lzdGVyKEVkaXRhYmxlVGV4dEJhc2UpO1xudmFyIGF1dG9jYXBpdGFsaXphdGlvblR5cGVDb252ZXJ0ZXIgPSB0ZXh0X2Jhc2VfMS5tYWtlUGFyc2VyKHRleHRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoXCJub25lXCIsIFwid29yZHNcIiwgXCJzZW50ZW5jZXNcIiwgXCJhbGxjaGFyYWN0ZXJzXCIpKTtcbmV4cG9ydHMuYXV0b2NhcGl0YWxpemF0aW9uVHlwZVByb3BlcnR5ID0gbmV3IHRleHRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJhdXRvY2FwaXRhbGl6YXRpb25UeXBlXCIsIGRlZmF1bHRWYWx1ZTogXCJzZW50ZW5jZXNcIiwgdmFsdWVDb252ZXJ0ZXI6IGF1dG9jYXBpdGFsaXphdGlvblR5cGVDb252ZXJ0ZXIgfSk7XG5leHBvcnRzLmF1dG9jYXBpdGFsaXphdGlvblR5cGVQcm9wZXJ0eS5yZWdpc3RlcihFZGl0YWJsZVRleHRCYXNlKTtcbmV4cG9ydHMuYXV0b2NvcnJlY3RQcm9wZXJ0eSA9IG5ldyB0ZXh0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYXV0b2NvcnJlY3RcIiwgdmFsdWVDb252ZXJ0ZXI6IHRleHRfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmF1dG9jb3JyZWN0UHJvcGVydHkucmVnaXN0ZXIoRWRpdGFibGVUZXh0QmFzZSk7XG5leHBvcnRzLmhpbnRQcm9wZXJ0eSA9IG5ldyB0ZXh0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaGludFwiLCBkZWZhdWx0VmFsdWU6IFwiXCIgfSk7XG5leHBvcnRzLmhpbnRQcm9wZXJ0eS5yZWdpc3RlcihFZGl0YWJsZVRleHRCYXNlKTtcbmV4cG9ydHMubWF4TGVuZ3RoUHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcIm1heExlbmd0aFwiLCBkZWZhdWx0VmFsdWU6IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlSW50IH0pO1xuZXhwb3J0cy5tYXhMZW5ndGhQcm9wZXJ0eS5yZWdpc3RlcihFZGl0YWJsZVRleHRCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVkaXRhYmxlLXRleHQtYmFzZS1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9lZGl0YWJsZS10ZXh0LWJhc2UtY29tbW9uXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdXRpbHNcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9lZGl0YWJsZS10ZXh0LWJhc2UtY29tbW9uXCIpKTtcbnZhciBFZGl0VGV4dExpc3RlbmVycztcbmZ1bmN0aW9uIGNsZWFyRGlzbWlzc1RpbWVyKCkge1xuICAgIGV4cG9ydHMuZGlzbWlzc0tleWJvYXJkT3duZXIgPSBudWxsO1xuICAgIGlmIChleHBvcnRzLmRpc21pc3NLZXlib2FyZFRpbWVvdXRJZCkge1xuICAgICAgICBjbGVhclRpbWVvdXQoZXhwb3J0cy5kaXNtaXNzS2V5Ym9hcmRUaW1lb3V0SWQpO1xuICAgICAgICBleHBvcnRzLmRpc21pc3NLZXlib2FyZFRpbWVvdXRJZCA9IG51bGw7XG4gICAgfVxufVxuZnVuY3Rpb24gZGlzbWlzc1NvZnRJbnB1dChvd25lcikge1xuICAgIGNsZWFyRGlzbWlzc1RpbWVyKCk7XG4gICAgaWYgKCFleHBvcnRzLmRpc21pc3NLZXlib2FyZFRpbWVvdXRJZCkge1xuICAgICAgICBleHBvcnRzLmRpc21pc3NLZXlib2FyZFRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gZXhwb3J0cy5kaXNtaXNzS2V5Ym9hcmRPd25lciAmJiBleHBvcnRzLmRpc21pc3NLZXlib2FyZE93bmVyLmdldCgpO1xuICAgICAgICAgICAgdmFyIGFjdGl2aXR5ID0gKG93bmVyICYmIG93bmVyLl9jb250ZXh0KTtcbiAgICAgICAgICAgIHZhciBuYXRpdmVWaWV3ID0gb3duZXIgJiYgb3duZXIubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgICAgIGV4cG9ydHMuZGlzbWlzc0tleWJvYXJkVGltZW91dElkID0gbnVsbDtcbiAgICAgICAgICAgIGV4cG9ydHMuZGlzbWlzc0tleWJvYXJkT3duZXIgPSBudWxsO1xuICAgICAgICAgICAgdmFyIGZvY3VzZWQgPSBhY3Rpdml0eSAmJiBhY3Rpdml0eS5nZXRDdXJyZW50Rm9jdXMoKTtcbiAgICAgICAgICAgIGlmICghZm9jdXNlZCB8fCAhKGZvY3VzZWQgaW5zdGFuY2VvZiBhbmRyb2lkLndpZGdldC5FZGl0VGV4dCkpIHtcbiAgICAgICAgICAgICAgICB1dGlsc18xLmFkLmRpc21pc3NTb2Z0SW5wdXQobmF0aXZlVmlldyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDEwKTtcbiAgICB9XG59XG5mdW5jdGlvbiBpbml0aWFsaXplRWRpdFRleHRMaXN0ZW5lcnMoKSB7XG4gICAgaWYgKEVkaXRUZXh0TGlzdGVuZXJzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIEVkaXRUZXh0TGlzdGVuZXJzSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhFZGl0VGV4dExpc3RlbmVyc0ltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIEVkaXRUZXh0TGlzdGVuZXJzSW1wbChvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBFZGl0VGV4dExpc3RlbmVyc0ltcGwucHJvdG90eXBlLmJlZm9yZVRleHRDaGFuZ2VkID0gZnVuY3Rpb24gKHRleHQsIHN0YXJ0LCBjb3VudCwgYWZ0ZXIpIHtcbiAgICAgICAgfTtcbiAgICAgICAgRWRpdFRleHRMaXN0ZW5lcnNJbXBsLnByb3RvdHlwZS5vblRleHRDaGFuZ2VkID0gZnVuY3Rpb24gKHRleHQsIHN0YXJ0LCBiZWZvcmUsIGNvdW50KSB7XG4gICAgICAgIH07XG4gICAgICAgIEVkaXRUZXh0TGlzdGVuZXJzSW1wbC5wcm90b3R5cGUuYWZ0ZXJUZXh0Q2hhbmdlZCA9IGZ1bmN0aW9uIChlZGl0YWJsZSkge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIGlmICghb3duZXIgfHwgb3duZXIuX2NoYW5nZUZyb21Db2RlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3dpdGNoIChvd25lci51cGRhdGVUZXh0VHJpZ2dlcikge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJmb2N1c0xvc3RcIjpcbiAgICAgICAgICAgICAgICAgICAgb3duZXIuX2RpcnR5VGV4dEFjY3VtdWxhdG9yID0gZWRpdGFibGUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInRleHRDaGFuZ2VkXCI6XG4gICAgICAgICAgICAgICAgICAgIGVkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS50ZXh0UHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIGVkaXRhYmxlLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHVwZGF0ZVRleHRUcmlnZ2VyOiBcIiArIG93bmVyLnVwZGF0ZVRleHRUcmlnZ2VyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRWRpdFRleHRMaXN0ZW5lcnNJbXBsLnByb3RvdHlwZS5vbkZvY3VzQ2hhbmdlID0gZnVuY3Rpb24gKHZpZXcsIGhhc0ZvY3VzKSB7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgaWYgKCFvd25lcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChoYXNGb2N1cykge1xuICAgICAgICAgICAgICAgIGNsZWFyRGlzbWlzc1RpbWVyKCk7XG4gICAgICAgICAgICAgICAgb3duZXIubm90aWZ5KHsgZXZlbnROYW1lOiBFZGl0YWJsZVRleHRCYXNlLmZvY3VzRXZlbnQsIG9iamVjdDogb3duZXIgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAob3duZXIuX2RpcnR5VGV4dEFjY3VtdWxhdG9yIHx8IG93bmVyLl9kaXJ0eVRleHRBY2N1bXVsYXRvciA9PT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICBlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEudGV4dFByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKG93bmVyLCBvd25lci5fZGlydHlUZXh0QWNjdW11bGF0b3IpO1xuICAgICAgICAgICAgICAgICAgICBvd25lci5fZGlydHlUZXh0QWNjdW11bGF0b3IgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG93bmVyLm5vdGlmeSh7IGV2ZW50TmFtZTogRWRpdGFibGVUZXh0QmFzZS5ibHVyRXZlbnQsIG9iamVjdDogb3duZXIgfSk7XG4gICAgICAgICAgICAgICAgZGlzbWlzc1NvZnRJbnB1dChvd25lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEVkaXRUZXh0TGlzdGVuZXJzSW1wbC5wcm90b3R5cGUub25FZGl0b3JBY3Rpb24gPSBmdW5jdGlvbiAodGV4dFZpZXcsIGFjdGlvbklkLCBldmVudCkge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIGlmICghb3duZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYWN0aW9uSWQgPT09IGFuZHJvaWQudmlldy5pbnB1dG1ldGhvZC5FZGl0b3JJbmZvLklNRV9BQ1RJT05fRE9ORSB8fFxuICAgICAgICAgICAgICAgIGFjdGlvbklkID09PSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX1VOU1BFQ0lGSUVEIHx8XG4gICAgICAgICAgICAgICAgKGV2ZW50ICYmIGV2ZW50LmdldEtleUNvZGUoKSA9PT0gYW5kcm9pZC52aWV3LktleUV2ZW50LktFWUNPREVfRU5URVIpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRleHRWaWV3LmdldE1heExpbmVzKCkgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXIuZGlzbWlzc1NvZnRJbnB1dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvd25lci5fb25SZXR1cm5QcmVzcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWN0aW9uSWQgPT09IGFuZHJvaWQudmlldy5pbnB1dG1ldGhvZC5FZGl0b3JJbmZvLklNRV9BQ1RJT05fTkVYVCB8fFxuICAgICAgICAgICAgICAgIGFjdGlvbklkID09PSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX1BSRVZJT1VTKSB7XG4gICAgICAgICAgICAgICAgb3duZXIuX29uUmV0dXJuUHJlc3MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgRWRpdFRleHRMaXN0ZW5lcnNJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLnRleHQuVGV4dFdhdGNoZXIsIGFuZHJvaWQudmlldy5WaWV3Lk9uRm9jdXNDaGFuZ2VMaXN0ZW5lciwgYW5kcm9pZC53aWRnZXQuVGV4dFZpZXcuT25FZGl0b3JBY3Rpb25MaXN0ZW5lcl0pXG4gICAgICAgIF0sIEVkaXRUZXh0TGlzdGVuZXJzSW1wbCk7XG4gICAgICAgIHJldHVybiBFZGl0VGV4dExpc3RlbmVyc0ltcGw7XG4gICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgRWRpdFRleHRMaXN0ZW5lcnMgPSBFZGl0VGV4dExpc3RlbmVyc0ltcGw7XG59XG52YXIgRWRpdGFibGVUZXh0QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEVkaXRhYmxlVGV4dEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRWRpdGFibGVUZXh0QmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZS5fb25SZXR1cm5QcmVzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgYW5kcm9pZC53aWRnZXQuRWRpdFRleHQodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgZWRpdFRleHQgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkO1xuICAgICAgICB0aGlzLl9jb25maWd1cmVFZGl0VGV4dChlZGl0VGV4dCk7XG4gICAgICAgIGluaXRpYWxpemVFZGl0VGV4dExpc3RlbmVycygpO1xuICAgICAgICB2YXIgbGlzdGVuZXJzID0gbmV3IEVkaXRUZXh0TGlzdGVuZXJzKHRoaXMpO1xuICAgICAgICBlZGl0VGV4dC5hZGRUZXh0Q2hhbmdlZExpc3RlbmVyKGxpc3RlbmVycyk7XG4gICAgICAgIGVkaXRUZXh0LnNldE9uRm9jdXNDaGFuZ2VMaXN0ZW5lcihsaXN0ZW5lcnMpO1xuICAgICAgICBlZGl0VGV4dC5zZXRPbkVkaXRvckFjdGlvbkxpc3RlbmVyKGxpc3RlbmVycyk7XG4gICAgICAgIGVkaXRUZXh0Lmxpc3RlbmVyID0gbGlzdGVuZXJzO1xuICAgICAgICB0aGlzLl9pbnB1dFR5cGUgPSBlZGl0VGV4dC5nZXRJbnB1dFR5cGUoKTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmxpc3RlbmVyLm93bmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5fa2V5TGlzdGVuZXJDYWNoZSA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRJbnB1dFR5cGUodGhpcy5faW5wdXRUeXBlKTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlLm9uVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZGlzbWlzc1NvZnRJbnB1dCgpO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uVW5sb2FkZWQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlLmRpc21pc3NTb2Z0SW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKCFuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdXRpbHNfMS5hZC5kaXNtaXNzU29mdElucHV0KG5hdGl2ZVZpZXcpO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGUuZm9jdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKCFuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdCA9IF9zdXBlci5wcm90b3R5cGUuZm9jdXMuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgdXRpbHNfMS5hZC5zaG93U29mdElucHV0KHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZS5fc2V0SW5wdXRUeXBlID0gZnVuY3Rpb24gKGlucHV0VHlwZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLl9jaGFuZ2VGcm9tQ29kZSA9IHRydWU7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldElucHV0VHlwZShpbnB1dFR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5fY2hhbmdlRnJvbUNvZGUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGlzdGVuZXIgPSBuYXRpdmVWaWV3LmdldEtleUxpc3RlbmVyKCk7XG4gICAgICAgIGlmIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5fa2V5TGlzdGVuZXJDYWNoZSA9IGxpc3RlbmVyO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5lZGl0YWJsZSkge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRLZXlMaXN0ZW5lcihudWxsKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGVkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5yZXNldFN5bWJvbDtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS50ZXh0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5fY2hhbmdlRnJvbUNvZGUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fc2V0TmF0aXZlVGV4dCh2YWx1ZSA9PT0gZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLnJlc2V0U3ltYm9sKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuX2NoYW5nZUZyb21Db2RlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5rZXlib2FyZFR5cGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuZ2V0SW5wdXRUeXBlKCk7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEua2V5Ym9hcmRUeXBlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmV3SW5wdXRUeXBlO1xuICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICBjYXNlIFwiZGF0ZXRpbWVcIjpcbiAgICAgICAgICAgICAgICBuZXdJbnB1dFR5cGUgPSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfREFURVRJTUUgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfREFURVRJTUVfVkFSSUFUSU9OX05PUk1BTDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJwaG9uZVwiOlxuICAgICAgICAgICAgICAgIG5ld0lucHV0VHlwZSA9IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9DTEFTU19QSE9ORTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJudW1iZXJcIjpcbiAgICAgICAgICAgICAgICBuZXdJbnB1dFR5cGUgPSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfTlVNQkVSIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX05VTUJFUl9WQVJJQVRJT05fTk9STUFMIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX05VTUJFUl9GTEFHX1NJR05FRCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9OVU1CRVJfRkxBR19ERUNJTUFMO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInVybFwiOlxuICAgICAgICAgICAgICAgIG5ld0lucHV0VHlwZSA9IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9DTEFTU19URVhUIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfVkFSSUFUSU9OX1VSSTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJlbWFpbFwiOlxuICAgICAgICAgICAgICAgIG5ld0lucHV0VHlwZSA9IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9DTEFTU19URVhUIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfVkFSSUFUSU9OX0VNQUlMX0FERFJFU1M7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIG5ld0lucHV0VHlwZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3NldElucHV0VHlwZShuZXdJbnB1dFR5cGUpO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLnJldHVybktleVR5cGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGltZSA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuZ2V0SW1lT3B0aW9ucygpO1xuICAgICAgICBzd2l0Y2ggKGltZSkge1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX0RPTkU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZG9uZVwiO1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX0dPOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImdvXCI7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5pbnB1dG1ldGhvZC5FZGl0b3JJbmZvLklNRV9BQ1RJT05fTkVYVDpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJuZXh0XCI7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5pbnB1dG1ldGhvZC5FZGl0b3JJbmZvLklNRV9BQ1RJT05fU0VBUkNIOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInNlYXJjaFwiO1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX1NFTkQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwic2VuZFwiO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gaW1lLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5yZXR1cm5LZXlUeXBlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmV3SW1lT3B0aW9ucztcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcImRvbmVcIjpcbiAgICAgICAgICAgICAgICBuZXdJbWVPcHRpb25zID0gYW5kcm9pZC52aWV3LmlucHV0bWV0aG9kLkVkaXRvckluZm8uSU1FX0FDVElPTl9ET05FO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImdvXCI6XG4gICAgICAgICAgICAgICAgbmV3SW1lT3B0aW9ucyA9IGFuZHJvaWQudmlldy5pbnB1dG1ldGhvZC5FZGl0b3JJbmZvLklNRV9BQ1RJT05fR087XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibmV4dFwiOlxuICAgICAgICAgICAgICAgIG5ld0ltZU9wdGlvbnMgPSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX05FWFQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic2VhcmNoXCI6XG4gICAgICAgICAgICAgICAgbmV3SW1lT3B0aW9ucyA9IGFuZHJvaWQudmlldy5pbnB1dG1ldGhvZC5FZGl0b3JJbmZvLklNRV9BQ1RJT05fU0VBUkNIO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInNlbmRcIjpcbiAgICAgICAgICAgICAgICBuZXdJbWVPcHRpb25zID0gYW5kcm9pZC52aWV3LmlucHV0bWV0aG9kLkVkaXRvckluZm8uSU1FX0FDVElPTl9TRU5EO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB2YXIgaW1lID0gK3ZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICghaXNOYU4oaW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdJbWVPcHRpb25zID0gaW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3SW1lT3B0aW9ucyA9IGFuZHJvaWQudmlldy5pbnB1dG1ldGhvZC5FZGl0b3JJbmZvLklNRV9BQ1RJT05fVU5TUEVDSUZJRUQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0SW1lT3B0aW9ucyhuZXdJbWVPcHRpb25zKTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5lZGl0YWJsZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0S2V5TGlzdGVuZXIodGhpcy5fa2V5TGlzdGVuZXJDYWNoZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2tleUxpc3RlbmVyQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9rZXlMaXN0ZW5lckNhY2hlID0gbmF0aXZlVmlldy5nZXRLZXlMaXN0ZW5lcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRLZXlMaXN0ZW5lcihudWxsKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLmF1dG9jYXBpdGFsaXphdGlvblR5cGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlucHV0VHlwZSA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuZ2V0SW5wdXRUeXBlKCk7XG4gICAgICAgIGlmICgoaW5wdXRUeXBlICYgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfV09SRFMpID09PSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0NBUF9XT1JEUykge1xuICAgICAgICAgICAgcmV0dXJuIFwid29yZHNcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICgoaW5wdXRUeXBlICYgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfU0VOVEVOQ0VTKSA9PT0gYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfU0VOVEVOQ0VTKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJzZW50ZW5jZXNcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICgoaW5wdXRUeXBlICYgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfQ0hBUkFDVEVSUykgPT09IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQ0FQX0NIQVJBQ1RFUlMpIHtcbiAgICAgICAgICAgIHJldHVybiBcImFsbGNoYXJhY3RlcnNcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBpbnB1dFR5cGUudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLmF1dG9jYXBpdGFsaXphdGlvblR5cGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnB1dFR5cGUgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmdldElucHV0VHlwZSgpO1xuICAgICAgICBpbnB1dFR5cGUgPSBpbnB1dFR5cGUgJiB+Mjg2NzI7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJub25lXCI6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwid29yZHNcIjpcbiAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBpbnB1dFR5cGUgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0NBUF9XT1JEUztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzZW50ZW5jZXNcIjpcbiAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBpbnB1dFR5cGUgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0NBUF9TRU5URU5DRVM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiYWxsY2hhcmFjdGVyc1wiOlxuICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGlucHV0VHlwZSB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQ0FQX0NIQVJBQ1RFUlM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHZhciBudW1iZXIgPSArdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKCFpc05hTihudW1iZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IG51bWJlcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGlucHV0VHlwZSB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQ0FQX1NFTlRFTkNFUztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2V0SW5wdXRUeXBlKGlucHV0VHlwZSk7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEuYXV0b2NvcnJlY3RQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGF1dG9jb3JyZWN0ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5nZXRJbnB1dFR5cGUoKTtcbiAgICAgICAgaWYgKChhdXRvY29ycmVjdCAmIGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQVVUT19DT1JSRUNUKSA9PT0gYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19BVVRPX0NPUlJFQ1QpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5hdXRvY29ycmVjdFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGlucHV0VHlwZSA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuZ2V0SW5wdXRUeXBlKCk7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgdHJ1ZTpcbiAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBpbnB1dFR5cGUgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0FVVE9fQ09NUExFVEU7XG4gICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gaW5wdXRUeXBlIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19BVVRPX0NPUlJFQ1Q7XG4gICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gaW5wdXRUeXBlICYgfmFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfTk9fU1VHR0VTVElPTlM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGZhbHNlOlxuICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGlucHV0VHlwZSAmIH5hbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0FVVE9fQ09NUExFVEU7XG4gICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gaW5wdXRUeXBlICYgfmFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQVVUT19DT1JSRUNUO1xuICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGlucHV0VHlwZSB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfTk9fU1VHR0VTVElPTlM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3NldElucHV0VHlwZShpbnB1dFR5cGUpO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLmhpbnRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuZ2V0SGludCgpO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLmhpbnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciB0ZXh0ID0gKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpID8gbnVsbCA6IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0SGludCh0ZXh0KTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5wbGFjZWhvbGRlckNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmdldEhpbnRUZXh0Q29sb3JzKCk7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEucGxhY2Vob2xkZXJDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5hbmRyb2lkIDogdmFsdWU7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0SGludFRleHRDb2xvcihjb2xvcik7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEudGV4dFRyYW5zZm9ybVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5tYXhMZW5ndGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldEZpbHRlcnMoW10pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGxlbmd0aEZpbHRlciA9IG5ldyBhbmRyb2lkLnRleHQuSW5wdXRGaWx0ZXIuTGVuZ3RoRmlsdGVyKHZhbHVlKTtcbiAgICAgICAgICAgIHZhciBmaWx0ZXJzID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5nZXRGaWx0ZXJzKCk7XG4gICAgICAgICAgICB2YXIgbmV3RmlsdGVycyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaWx0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpbHRlciA9IGZpbHRlcnNbaV07XG4gICAgICAgICAgICAgICAgaWYgKCEoZmlsdGVyIGluc3RhbmNlb2YgYW5kcm9pZC50ZXh0LklucHV0RmlsdGVyLkxlbmd0aEZpbHRlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3RmlsdGVycy5wdXNoKGZpbHRlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3RmlsdGVycy5wdXNoKGxlbmd0aEZpbHRlcik7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldEZpbHRlcnMobmV3RmlsdGVycyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBFZGl0YWJsZVRleHRCYXNlO1xufShlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEuRWRpdGFibGVUZXh0QmFzZSkpO1xuZXhwb3J0cy5FZGl0YWJsZVRleHRCYXNlID0gRWRpdGFibGVUZXh0QmFzZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVkaXRhYmxlLXRleHQtYmFzZS5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBLZXlib2FyZFR5cGU7XG4oZnVuY3Rpb24gKEtleWJvYXJkVHlwZSkge1xuICAgIEtleWJvYXJkVHlwZS5kYXRldGltZSA9IFwiZGF0ZXRpbWVcIjtcbiAgICBLZXlib2FyZFR5cGUucGhvbmUgPSBcInBob25lXCI7XG4gICAgS2V5Ym9hcmRUeXBlLm51bWJlciA9IFwibnVtYmVyXCI7XG4gICAgS2V5Ym9hcmRUeXBlLnVybCA9IFwidXJsXCI7XG4gICAgS2V5Ym9hcmRUeXBlLmVtYWlsID0gXCJlbWFpbFwiO1xufSkoS2V5Ym9hcmRUeXBlID0gZXhwb3J0cy5LZXlib2FyZFR5cGUgfHwgKGV4cG9ydHMuS2V5Ym9hcmRUeXBlID0ge30pKTtcbnZhciBSZXR1cm5LZXlUeXBlO1xuKGZ1bmN0aW9uIChSZXR1cm5LZXlUeXBlKSB7XG4gICAgUmV0dXJuS2V5VHlwZS5kb25lID0gXCJkb25lXCI7XG4gICAgUmV0dXJuS2V5VHlwZS5uZXh0ID0gXCJuZXh0XCI7XG4gICAgUmV0dXJuS2V5VHlwZS5nbyA9IFwiZ29cIjtcbiAgICBSZXR1cm5LZXlUeXBlLnNlYXJjaCA9IFwic2VhcmNoXCI7XG4gICAgUmV0dXJuS2V5VHlwZS5zZW5kID0gXCJzZW5kXCI7XG59KShSZXR1cm5LZXlUeXBlID0gZXhwb3J0cy5SZXR1cm5LZXlUeXBlIHx8IChleHBvcnRzLlJldHVybktleVR5cGUgPSB7fSkpO1xudmFyIFRleHRBbGlnbm1lbnQ7XG4oZnVuY3Rpb24gKFRleHRBbGlnbm1lbnQpIHtcbiAgICBUZXh0QWxpZ25tZW50LmxlZnQgPSBcImxlZnRcIjtcbiAgICBUZXh0QWxpZ25tZW50LmNlbnRlciA9IFwiY2VudGVyXCI7XG4gICAgVGV4dEFsaWdubWVudC5yaWdodCA9IFwicmlnaHRcIjtcbn0pKFRleHRBbGlnbm1lbnQgPSBleHBvcnRzLlRleHRBbGlnbm1lbnQgfHwgKGV4cG9ydHMuVGV4dEFsaWdubWVudCA9IHt9KSk7XG52YXIgVGV4dERlY29yYXRpb247XG4oZnVuY3Rpb24gKFRleHREZWNvcmF0aW9uKSB7XG4gICAgVGV4dERlY29yYXRpb24ubm9uZSA9IFwibm9uZVwiO1xuICAgIFRleHREZWNvcmF0aW9uLnVuZGVybGluZSA9IFwidW5kZXJsaW5lXCI7XG4gICAgVGV4dERlY29yYXRpb24ubGluZVRocm91Z2ggPSBcImxpbmUtdGhyb3VnaFwiO1xufSkoVGV4dERlY29yYXRpb24gPSBleHBvcnRzLlRleHREZWNvcmF0aW9uIHx8IChleHBvcnRzLlRleHREZWNvcmF0aW9uID0ge30pKTtcbnZhciBUZXh0VHJhbnNmb3JtO1xuKGZ1bmN0aW9uIChUZXh0VHJhbnNmb3JtKSB7XG4gICAgVGV4dFRyYW5zZm9ybS5ub25lID0gXCJub25lXCI7XG4gICAgVGV4dFRyYW5zZm9ybS5jYXBpdGFsaXplID0gXCJjYXBpdGFsaXplXCI7XG4gICAgVGV4dFRyYW5zZm9ybS51cHBlcmNhc2UgPSBcInVwcGVyY2FzZVwiO1xuICAgIFRleHRUcmFuc2Zvcm0ubG93ZXJjYXNlID0gXCJsb3dlcmNhc2VcIjtcbn0pKFRleHRUcmFuc2Zvcm0gPSBleHBvcnRzLlRleHRUcmFuc2Zvcm0gfHwgKGV4cG9ydHMuVGV4dFRyYW5zZm9ybSA9IHt9KSk7XG52YXIgV2hpdGVTcGFjZTtcbihmdW5jdGlvbiAoV2hpdGVTcGFjZSkge1xuICAgIFdoaXRlU3BhY2Uubm9ybWFsID0gXCJub3JtYWxcIjtcbiAgICBXaGl0ZVNwYWNlLm5vd3JhcCA9IFwibm93cmFwXCI7XG59KShXaGl0ZVNwYWNlID0gZXhwb3J0cy5XaGl0ZVNwYWNlIHx8IChleHBvcnRzLldoaXRlU3BhY2UgPSB7fSkpO1xudmFyIE9yaWVudGF0aW9uO1xuKGZ1bmN0aW9uIChPcmllbnRhdGlvbikge1xuICAgIE9yaWVudGF0aW9uLmhvcml6b250YWwgPSBcImhvcml6b250YWxcIjtcbiAgICBPcmllbnRhdGlvbi52ZXJ0aWNhbCA9IFwidmVydGljYWxcIjtcbn0pKE9yaWVudGF0aW9uID0gZXhwb3J0cy5PcmllbnRhdGlvbiB8fCAoZXhwb3J0cy5PcmllbnRhdGlvbiA9IHt9KSk7XG52YXIgRGV2aWNlT3JpZW50YXRpb247XG4oZnVuY3Rpb24gKERldmljZU9yaWVudGF0aW9uKSB7XG4gICAgRGV2aWNlT3JpZW50YXRpb24ucG9ydHJhaXQgPSBcInBvcnRyYWl0XCI7XG4gICAgRGV2aWNlT3JpZW50YXRpb24ubGFuZHNjYXBlID0gXCJsYW5kc2NhcGVcIjtcbiAgICBEZXZpY2VPcmllbnRhdGlvbi51bmtub3duID0gXCJ1bmtub3duXCI7XG59KShEZXZpY2VPcmllbnRhdGlvbiA9IGV4cG9ydHMuRGV2aWNlT3JpZW50YXRpb24gfHwgKGV4cG9ydHMuRGV2aWNlT3JpZW50YXRpb24gPSB7fSkpO1xudmFyIEhvcml6b250YWxBbGlnbm1lbnQ7XG4oZnVuY3Rpb24gKEhvcml6b250YWxBbGlnbm1lbnQpIHtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LmxlZnQgPSBcImxlZnRcIjtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LmNlbnRlciA9IFwiY2VudGVyXCI7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5yaWdodCA9IFwicmlnaHRcIjtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LnN0cmV0Y2ggPSBcInN0cmV0Y2hcIjtcbn0pKEhvcml6b250YWxBbGlnbm1lbnQgPSBleHBvcnRzLkhvcml6b250YWxBbGlnbm1lbnQgfHwgKGV4cG9ydHMuSG9yaXpvbnRhbEFsaWdubWVudCA9IHt9KSk7XG52YXIgVmVydGljYWxBbGlnbm1lbnQ7XG4oZnVuY3Rpb24gKFZlcnRpY2FsQWxpZ25tZW50KSB7XG4gICAgVmVydGljYWxBbGlnbm1lbnQudG9wID0gXCJ0b3BcIjtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC5taWRkbGUgPSBcIm1pZGRsZVwiO1xuICAgIFZlcnRpY2FsQWxpZ25tZW50LmJvdHRvbSA9IFwiYm90dG9tXCI7XG4gICAgVmVydGljYWxBbGlnbm1lbnQuc3RyZXRjaCA9IFwic3RyZXRjaFwiO1xufSkoVmVydGljYWxBbGlnbm1lbnQgPSBleHBvcnRzLlZlcnRpY2FsQWxpZ25tZW50IHx8IChleHBvcnRzLlZlcnRpY2FsQWxpZ25tZW50ID0ge30pKTtcbnZhciBTdHJldGNoO1xuKGZ1bmN0aW9uIChTdHJldGNoKSB7XG4gICAgU3RyZXRjaC5ub25lID0gXCJub25lXCI7XG4gICAgU3RyZXRjaC5hc3BlY3RGaWxsID0gXCJhc3BlY3RGaWxsXCI7XG4gICAgU3RyZXRjaC5hc3BlY3RGaXQgPSBcImFzcGVjdEZpdFwiO1xuICAgIFN0cmV0Y2guZmlsbCA9IFwiZmlsbFwiO1xufSkoU3RyZXRjaCA9IGV4cG9ydHMuU3RyZXRjaCB8fCAoZXhwb3J0cy5TdHJldGNoID0ge30pKTtcbnZhciBWaXNpYmlsaXR5O1xuKGZ1bmN0aW9uIChWaXNpYmlsaXR5KSB7XG4gICAgVmlzaWJpbGl0eS52aXNpYmxlID0gXCJ2aXNpYmxlXCI7XG4gICAgVmlzaWJpbGl0eS5jb2xsYXBzZSA9IFwiY29sbGFwc2VcIjtcbiAgICBWaXNpYmlsaXR5LmNvbGxhcHNlZCA9IFwiY29sbGFwc2VkXCI7XG59KShWaXNpYmlsaXR5ID0gZXhwb3J0cy5WaXNpYmlsaXR5IHx8IChleHBvcnRzLlZpc2liaWxpdHkgPSB7fSkpO1xudmFyIEZvbnRBdHRyaWJ1dGVzO1xuKGZ1bmN0aW9uIChGb250QXR0cmlidXRlcykge1xuICAgIEZvbnRBdHRyaWJ1dGVzLk5vcm1hbCA9IDA7XG4gICAgRm9udEF0dHJpYnV0ZXMuQm9sZCA9IDE7XG4gICAgRm9udEF0dHJpYnV0ZXMuSXRhbGljID0gMSA8PCAxO1xufSkoRm9udEF0dHJpYnV0ZXMgPSBleHBvcnRzLkZvbnRBdHRyaWJ1dGVzIHx8IChleHBvcnRzLkZvbnRBdHRyaWJ1dGVzID0ge30pKTtcbnZhciBEZXZpY2VUeXBlO1xuKGZ1bmN0aW9uIChEZXZpY2VUeXBlKSB7XG4gICAgRGV2aWNlVHlwZS5QaG9uZSA9IFwiUGhvbmVcIjtcbiAgICBEZXZpY2VUeXBlLlRhYmxldCA9IFwiVGFibGV0XCI7XG59KShEZXZpY2VUeXBlID0gZXhwb3J0cy5EZXZpY2VUeXBlIHx8IChleHBvcnRzLkRldmljZVR5cGUgPSB7fSkpO1xudmFyIFVwZGF0ZVRleHRUcmlnZ2VyO1xuKGZ1bmN0aW9uIChVcGRhdGVUZXh0VHJpZ2dlcikge1xuICAgIFVwZGF0ZVRleHRUcmlnZ2VyLmZvY3VzTG9zdCA9IFwiZm9jdXNMb3N0XCI7XG4gICAgVXBkYXRlVGV4dFRyaWdnZXIudGV4dENoYW5nZWQgPSBcInRleHRDaGFuZ2VkXCI7XG59KShVcGRhdGVUZXh0VHJpZ2dlciA9IGV4cG9ydHMuVXBkYXRlVGV4dFRyaWdnZXIgfHwgKGV4cG9ydHMuVXBkYXRlVGV4dFRyaWdnZXIgPSB7fSkpO1xudmFyIEFjY3VyYWN5O1xuKGZ1bmN0aW9uIChBY2N1cmFjeSkge1xuICAgIEFjY3VyYWN5LmFueSA9IDMwMDtcbiAgICBBY2N1cmFjeS5oaWdoID0gMztcbn0pKEFjY3VyYWN5ID0gZXhwb3J0cy5BY2N1cmFjeSB8fCAoZXhwb3J0cy5BY2N1cmFjeSA9IHt9KSk7XG52YXIgRG9jaztcbihmdW5jdGlvbiAoRG9jaykge1xuICAgIERvY2subGVmdCA9IFwibGVmdFwiO1xuICAgIERvY2sudG9wID0gXCJ0b3BcIjtcbiAgICBEb2NrLnJpZ2h0ID0gXCJyaWdodFwiO1xuICAgIERvY2suYm90dG9tID0gXCJib3R0b21cIjtcbn0pKERvY2sgPSBleHBvcnRzLkRvY2sgfHwgKGV4cG9ydHMuRG9jayA9IHt9KSk7XG52YXIgQXV0b2NhcGl0YWxpemF0aW9uVHlwZTtcbihmdW5jdGlvbiAoQXV0b2NhcGl0YWxpemF0aW9uVHlwZSkge1xuICAgIEF1dG9jYXBpdGFsaXphdGlvblR5cGUubm9uZSA9IFwibm9uZVwiO1xuICAgIEF1dG9jYXBpdGFsaXphdGlvblR5cGUud29yZHMgPSBcIndvcmRzXCI7XG4gICAgQXV0b2NhcGl0YWxpemF0aW9uVHlwZS5zZW50ZW5jZXMgPSBcInNlbnRlbmNlc1wiO1xuICAgIEF1dG9jYXBpdGFsaXphdGlvblR5cGUuYWxsQ2hhcmFjdGVycyA9IFwiYWxsY2hhcmFjdGVyc1wiO1xufSkoQXV0b2NhcGl0YWxpemF0aW9uVHlwZSA9IGV4cG9ydHMuQXV0b2NhcGl0YWxpemF0aW9uVHlwZSB8fCAoZXhwb3J0cy5BdXRvY2FwaXRhbGl6YXRpb25UeXBlID0ge30pKTtcbnZhciBOYXZpZ2F0aW9uQmFyVmlzaWJpbGl0eTtcbihmdW5jdGlvbiAoTmF2aWdhdGlvbkJhclZpc2liaWxpdHkpIHtcbiAgICBOYXZpZ2F0aW9uQmFyVmlzaWJpbGl0eS5hdXRvID0gXCJhdXRvXCI7XG4gICAgTmF2aWdhdGlvbkJhclZpc2liaWxpdHkubmV2ZXIgPSBcIm5ldmVyXCI7XG4gICAgTmF2aWdhdGlvbkJhclZpc2liaWxpdHkuYWx3YXlzID0gXCJhbHdheXNcIjtcbn0pKE5hdmlnYXRpb25CYXJWaXNpYmlsaXR5ID0gZXhwb3J0cy5OYXZpZ2F0aW9uQmFyVmlzaWJpbGl0eSB8fCAoZXhwb3J0cy5OYXZpZ2F0aW9uQmFyVmlzaWJpbGl0eSA9IHt9KSk7XG52YXIgQW5kcm9pZEFjdGlvbkJhckljb25WaXNpYmlsaXR5O1xuKGZ1bmN0aW9uIChBbmRyb2lkQWN0aW9uQmFySWNvblZpc2liaWxpdHkpIHtcbiAgICBBbmRyb2lkQWN0aW9uQmFySWNvblZpc2liaWxpdHkuYXV0byA9IFwiYXV0b1wiO1xuICAgIEFuZHJvaWRBY3Rpb25CYXJJY29uVmlzaWJpbGl0eS5uZXZlciA9IFwibmV2ZXJcIjtcbiAgICBBbmRyb2lkQWN0aW9uQmFySWNvblZpc2liaWxpdHkuYWx3YXlzID0gXCJhbHdheXNcIjtcbn0pKEFuZHJvaWRBY3Rpb25CYXJJY29uVmlzaWJpbGl0eSA9IGV4cG9ydHMuQW5kcm9pZEFjdGlvbkJhckljb25WaXNpYmlsaXR5IHx8IChleHBvcnRzLkFuZHJvaWRBY3Rpb25CYXJJY29uVmlzaWJpbGl0eSA9IHt9KSk7XG52YXIgQW5kcm9pZEFjdGlvbkl0ZW1Qb3NpdGlvbjtcbihmdW5jdGlvbiAoQW5kcm9pZEFjdGlvbkl0ZW1Qb3NpdGlvbikge1xuICAgIEFuZHJvaWRBY3Rpb25JdGVtUG9zaXRpb24uYWN0aW9uQmFyID0gXCJhY3Rpb25CYXJcIjtcbiAgICBBbmRyb2lkQWN0aW9uSXRlbVBvc2l0aW9uLmFjdGlvbkJhcklmUm9vbSA9IFwiYWN0aW9uQmFySWZSb29tXCI7XG4gICAgQW5kcm9pZEFjdGlvbkl0ZW1Qb3NpdGlvbi5wb3B1cCA9IFwicG9wdXBcIjtcbn0pKEFuZHJvaWRBY3Rpb25JdGVtUG9zaXRpb24gPSBleHBvcnRzLkFuZHJvaWRBY3Rpb25JdGVtUG9zaXRpb24gfHwgKGV4cG9ydHMuQW5kcm9pZEFjdGlvbkl0ZW1Qb3NpdGlvbiA9IHt9KSk7XG52YXIgSU9TQWN0aW9uSXRlbVBvc2l0aW9uO1xuKGZ1bmN0aW9uIChJT1NBY3Rpb25JdGVtUG9zaXRpb24pIHtcbiAgICBJT1NBY3Rpb25JdGVtUG9zaXRpb24ubGVmdCA9IFwibGVmdFwiO1xuICAgIElPU0FjdGlvbkl0ZW1Qb3NpdGlvbi5yaWdodCA9IFwicmlnaHRcIjtcbn0pKElPU0FjdGlvbkl0ZW1Qb3NpdGlvbiA9IGV4cG9ydHMuSU9TQWN0aW9uSXRlbVBvc2l0aW9uIHx8IChleHBvcnRzLklPU0FjdGlvbkl0ZW1Qb3NpdGlvbiA9IHt9KSk7XG52YXIgSW1hZ2VGb3JtYXQ7XG4oZnVuY3Rpb24gKEltYWdlRm9ybWF0KSB7XG4gICAgSW1hZ2VGb3JtYXQucG5nID0gXCJwbmdcIjtcbiAgICBJbWFnZUZvcm1hdC5qcGVnID0gXCJqcGVnXCI7XG4gICAgSW1hZ2VGb3JtYXQuanBnID0gXCJqcGdcIjtcbn0pKEltYWdlRm9ybWF0ID0gZXhwb3J0cy5JbWFnZUZvcm1hdCB8fCAoZXhwb3J0cy5JbWFnZUZvcm1hdCA9IHt9KSk7XG52YXIgRm9udFN0eWxlO1xuKGZ1bmN0aW9uIChGb250U3R5bGUpIHtcbiAgICBGb250U3R5bGUubm9ybWFsID0gXCJub3JtYWxcIjtcbiAgICBGb250U3R5bGUuaXRhbGljID0gXCJpdGFsaWNcIjtcbn0pKEZvbnRTdHlsZSA9IGV4cG9ydHMuRm9udFN0eWxlIHx8IChleHBvcnRzLkZvbnRTdHlsZSA9IHt9KSk7XG52YXIgRm9udFdlaWdodDtcbihmdW5jdGlvbiAoRm9udFdlaWdodCkge1xuICAgIEZvbnRXZWlnaHQudGhpbiA9IFwiMTAwXCI7XG4gICAgRm9udFdlaWdodC5leHRyYUxpZ2h0ID0gXCIyMDBcIjtcbiAgICBGb250V2VpZ2h0LmxpZ2h0ID0gXCIzMDBcIjtcbiAgICBGb250V2VpZ2h0Lm5vcm1hbCA9IFwibm9ybWFsXCI7XG4gICAgRm9udFdlaWdodC5tZWRpdW0gPSBcIjUwMFwiO1xuICAgIEZvbnRXZWlnaHQuc2VtaUJvbGQgPSBcIjYwMFwiO1xuICAgIEZvbnRXZWlnaHQuYm9sZCA9IFwiYm9sZFwiO1xuICAgIEZvbnRXZWlnaHQuZXh0cmFCb2xkID0gXCI4MDBcIjtcbiAgICBGb250V2VpZ2h0LmJsYWNrID0gXCI5MDBcIjtcbn0pKEZvbnRXZWlnaHQgPSBleHBvcnRzLkZvbnRXZWlnaHQgfHwgKGV4cG9ydHMuRm9udFdlaWdodCA9IHt9KSk7XG52YXIgQmFja2dyb3VuZFJlcGVhdDtcbihmdW5jdGlvbiAoQmFja2dyb3VuZFJlcGVhdCkge1xuICAgIEJhY2tncm91bmRSZXBlYXQucmVwZWF0ID0gXCJyZXBlYXRcIjtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0LnJlcGVhdFggPSBcInJlcGVhdC14XCI7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5yZXBlYXRZID0gXCJyZXBlYXQteVwiO1xuICAgIEJhY2tncm91bmRSZXBlYXQubm9SZXBlYXQgPSBcIm5vLXJlcGVhdFwiO1xufSkoQmFja2dyb3VuZFJlcGVhdCA9IGV4cG9ydHMuQmFja2dyb3VuZFJlcGVhdCB8fCAoZXhwb3J0cy5CYWNrZ3JvdW5kUmVwZWF0ID0ge30pKTtcbnZhciBhbmltYXRpb247XG52YXIgQW5pbWF0aW9uQ3VydmU7XG4oZnVuY3Rpb24gKEFuaW1hdGlvbkN1cnZlKSB7XG4gICAgQW5pbWF0aW9uQ3VydmUuZWFzZSA9IFwiZWFzZVwiO1xuICAgIEFuaW1hdGlvbkN1cnZlLmVhc2VJbiA9IFwiZWFzZUluXCI7XG4gICAgQW5pbWF0aW9uQ3VydmUuZWFzZU91dCA9IFwiZWFzZU91dFwiO1xuICAgIEFuaW1hdGlvbkN1cnZlLmVhc2VJbk91dCA9IFwiZWFzZUluT3V0XCI7XG4gICAgQW5pbWF0aW9uQ3VydmUubGluZWFyID0gXCJsaW5lYXJcIjtcbiAgICBBbmltYXRpb25DdXJ2ZS5zcHJpbmcgPSBcInNwcmluZ1wiO1xuICAgIGZ1bmN0aW9uIGN1YmljQmV6aWVyKHgxLCB5MSwgeDIsIHkyKSB7XG4gICAgICAgIGFuaW1hdGlvbiA9IGFuaW1hdGlvbiB8fCByZXF1aXJlKFwiLi4vYW5pbWF0aW9uXCIpO1xuICAgICAgICByZXR1cm4gbmV3IGFuaW1hdGlvbi5DdWJpY0JlemllckFuaW1hdGlvbkN1cnZlKHgxLCB5MSwgeDIsIHkyKTtcbiAgICB9XG4gICAgQW5pbWF0aW9uQ3VydmUuY3ViaWNCZXppZXIgPSBjdWJpY0Jlemllcjtcbn0pKEFuaW1hdGlvbkN1cnZlID0gZXhwb3J0cy5BbmltYXRpb25DdXJ2ZSB8fCAoZXhwb3J0cy5BbmltYXRpb25DdXJ2ZSA9IHt9KSk7XG52YXIgU3RhdHVzQmFyU3R5bGU7XG4oZnVuY3Rpb24gKFN0YXR1c0JhclN0eWxlKSB7XG4gICAgU3RhdHVzQmFyU3R5bGUubGlnaHQgPSBcImxpZ2h0XCI7XG4gICAgU3RhdHVzQmFyU3R5bGUuZGFyayA9IFwiZGFya1wiO1xufSkoU3RhdHVzQmFyU3R5bGUgPSBleHBvcnRzLlN0YXR1c0JhclN0eWxlIHx8IChleHBvcnRzLlN0YXR1c0JhclN0eWxlID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVudW1zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmcmFtZV8xID0gcmVxdWlyZShcIi4vZnJhbWVcIik7XG52YXIgZ2xvYmFscyA9IHJlcXVpcmUoXCIuLi8uLi9nbG9iYWxzXCIpO1xudmFyIGFwcE1vZHVsZSA9IHJlcXVpcmUoXCIuLi8uLi9hcHBsaWNhdGlvblwiKTtcbmlmIChnbG9iYWwuX19zbmFwc2hvdCkge1xuICAgIGdsb2JhbHMuaW5zdGFsbCgpO1xufVxudmFyIE5hdGl2ZVNjcmlwdEFjdGl2aXR5ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTmF0aXZlU2NyaXB0QWN0aXZpdHksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTmF0aXZlU2NyaXB0QWN0aXZpdHkoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgIH1cbiAgICBOYXRpdmVTY3JpcHRBY3Rpdml0eS5wcm90b3R5cGUub25DcmVhdGUgPSBmdW5jdGlvbiAoc2F2ZWRJbnN0YW5jZVN0YXRlKSB7XG4gICAgICAgIGFwcE1vZHVsZS5hbmRyb2lkLmluaXQodGhpcy5nZXRBcHBsaWNhdGlvbigpKTtcbiAgICAgICAgdGhpcy5pc05hdGl2ZVNjcmlwdEFjdGl2aXR5ID0gdHJ1ZTtcbiAgICAgICAgaWYgKCF0aGlzLl9jYWxsYmFja3MpIHtcbiAgICAgICAgICAgIGZyYW1lXzEuc2V0QWN0aXZpdHlDYWxsYmFja3ModGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzLm9uQ3JlYXRlKHRoaXMsIHNhdmVkSW5zdGFuY2VTdGF0ZSwgdGhpcy5nZXRJbnRlbnQoKSwgX3N1cGVyLnByb3RvdHlwZS5vbkNyZWF0ZSk7XG4gICAgfTtcbiAgICBOYXRpdmVTY3JpcHRBY3Rpdml0eS5wcm90b3R5cGUub25OZXdJbnRlbnQgPSBmdW5jdGlvbiAoaW50ZW50KSB7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcy5vbk5ld0ludGVudCh0aGlzLCBpbnRlbnQsIF9zdXBlci5wcm90b3R5cGUuc2V0SW50ZW50LCBfc3VwZXIucHJvdG90eXBlLm9uTmV3SW50ZW50KTtcbiAgICB9O1xuICAgIE5hdGl2ZVNjcmlwdEFjdGl2aXR5LnByb3RvdHlwZS5vblNhdmVJbnN0YW5jZVN0YXRlID0gZnVuY3Rpb24gKG91dFN0YXRlKSB7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcy5vblNhdmVJbnN0YW5jZVN0YXRlKHRoaXMsIG91dFN0YXRlLCBfc3VwZXIucHJvdG90eXBlLm9uU2F2ZUluc3RhbmNlU3RhdGUpO1xuICAgIH07XG4gICAgTmF0aXZlU2NyaXB0QWN0aXZpdHkucHJvdG90eXBlLm9uU3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcy5vblN0YXJ0KHRoaXMsIF9zdXBlci5wcm90b3R5cGUub25TdGFydCk7XG4gICAgfTtcbiAgICBOYXRpdmVTY3JpcHRBY3Rpdml0eS5wcm90b3R5cGUub25TdG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3Mub25TdG9wKHRoaXMsIF9zdXBlci5wcm90b3R5cGUub25TdG9wKTtcbiAgICB9O1xuICAgIE5hdGl2ZVNjcmlwdEFjdGl2aXR5LnByb3RvdHlwZS5vbkRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcy5vbkRlc3Ryb3kodGhpcywgX3N1cGVyLnByb3RvdHlwZS5vbkRlc3Ryb3kpO1xuICAgIH07XG4gICAgTmF0aXZlU2NyaXB0QWN0aXZpdHkucHJvdG90eXBlLm9uUG9zdFJlc3VtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzLm9uUG9zdFJlc3VtZSh0aGlzLCBfc3VwZXIucHJvdG90eXBlLm9uUG9zdFJlc3VtZSk7XG4gICAgfTtcbiAgICBOYXRpdmVTY3JpcHRBY3Rpdml0eS5wcm90b3R5cGUub25CYWNrUHJlc3NlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzLm9uQmFja1ByZXNzZWQodGhpcywgX3N1cGVyLnByb3RvdHlwZS5vbkJhY2tQcmVzc2VkKTtcbiAgICB9O1xuICAgIE5hdGl2ZVNjcmlwdEFjdGl2aXR5LnByb3RvdHlwZS5vblJlcXVlc3RQZXJtaXNzaW9uc1Jlc3VsdCA9IGZ1bmN0aW9uIChyZXF1ZXN0Q29kZSwgcGVybWlzc2lvbnMsIGdyYW50UmVzdWx0cykge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3Mub25SZXF1ZXN0UGVybWlzc2lvbnNSZXN1bHQodGhpcywgcmVxdWVzdENvZGUsIHBlcm1pc3Npb25zLCBncmFudFJlc3VsdHMsIHVuZGVmaW5lZCk7XG4gICAgfTtcbiAgICBOYXRpdmVTY3JpcHRBY3Rpdml0eS5wcm90b3R5cGUub25BY3Rpdml0eVJlc3VsdCA9IGZ1bmN0aW9uIChyZXF1ZXN0Q29kZSwgcmVzdWx0Q29kZSwgZGF0YSkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3Mub25BY3Rpdml0eVJlc3VsdCh0aGlzLCByZXF1ZXN0Q29kZSwgcmVzdWx0Q29kZSwgZGF0YSwgX3N1cGVyLnByb3RvdHlwZS5vbkFjdGl2aXR5UmVzdWx0KTtcbiAgICB9O1xuICAgIE5hdGl2ZVNjcmlwdEFjdGl2aXR5ID0gX19kZWNvcmF0ZShbXG4gICAgICAgIEphdmFQcm94eShcImNvbS50bnMuTmF0aXZlU2NyaXB0QWN0aXZpdHlcIilcbiAgICBdLCBOYXRpdmVTY3JpcHRBY3Rpdml0eSk7XG4gICAgcmV0dXJuIE5hdGl2ZVNjcmlwdEFjdGl2aXR5O1xufShhbmRyb2lkeC5hcHBjb21wYXQuYXBwLkFwcENvbXBhdEFjdGl2aXR5KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hY3Rpdml0eS5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmcmFtZV8xID0gcmVxdWlyZShcIi4vZnJhbWVcIik7XG52YXIgRnJhZ21lbnRDbGFzcyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZyYWdtZW50Q2xhc3MsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRnJhZ21lbnRDbGFzcygpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgfVxuICAgIEZyYWdtZW50Q2xhc3MucHJvdG90eXBlLm9uSGlkZGVuQ2hhbmdlZCA9IGZ1bmN0aW9uIChoaWRkZW4pIHtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzLm9uSGlkZGVuQ2hhbmdlZCh0aGlzLCBoaWRkZW4sIF9zdXBlci5wcm90b3R5cGUub25IaWRkZW5DaGFuZ2VkKTtcbiAgICB9O1xuICAgIEZyYWdtZW50Q2xhc3MucHJvdG90eXBlLm9uQ3JlYXRlQW5pbWF0b3IgPSBmdW5jdGlvbiAodHJhbnNpdCwgZW50ZXIsIG5leHRBbmltKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYWxsYmFja3Mub25DcmVhdGVBbmltYXRvcih0aGlzLCB0cmFuc2l0LCBlbnRlciwgbmV4dEFuaW0sIF9zdXBlci5wcm90b3R5cGUub25DcmVhdGVBbmltYXRvcik7XG4gICAgfTtcbiAgICBGcmFnbWVudENsYXNzLnByb3RvdHlwZS5vblN0b3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcy5vblN0b3AodGhpcywgX3N1cGVyLnByb3RvdHlwZS5vblN0b3ApO1xuICAgIH07XG4gICAgRnJhZ21lbnRDbGFzcy5wcm90b3R5cGUub25DcmVhdGUgPSBmdW5jdGlvbiAoc2F2ZWRJbnN0YW5jZVN0YXRlKSB7XG4gICAgICAgIGlmICghdGhpcy5fY2FsbGJhY2tzKSB7XG4gICAgICAgICAgICBmcmFtZV8xLnNldEZyYWdtZW50Q2FsbGJhY2tzKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0SGFzT3B0aW9uc01lbnUodHJ1ZSk7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcy5vbkNyZWF0ZSh0aGlzLCBzYXZlZEluc3RhbmNlU3RhdGUsIF9zdXBlci5wcm90b3R5cGUub25DcmVhdGUpO1xuICAgIH07XG4gICAgRnJhZ21lbnRDbGFzcy5wcm90b3R5cGUub25DcmVhdGVWaWV3ID0gZnVuY3Rpb24gKGluZmxhdGVyLCBjb250YWluZXIsIHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fY2FsbGJhY2tzLm9uQ3JlYXRlVmlldyh0aGlzLCBpbmZsYXRlciwgY29udGFpbmVyLCBzYXZlZEluc3RhbmNlU3RhdGUsIF9zdXBlci5wcm90b3R5cGUub25DcmVhdGVWaWV3KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIEZyYWdtZW50Q2xhc3MucHJvdG90eXBlLm9uU2F2ZUluc3RhbmNlU3RhdGUgPSBmdW5jdGlvbiAob3V0U3RhdGUpIHtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzLm9uU2F2ZUluc3RhbmNlU3RhdGUodGhpcywgb3V0U3RhdGUsIF9zdXBlci5wcm90b3R5cGUub25TYXZlSW5zdGFuY2VTdGF0ZSk7XG4gICAgfTtcbiAgICBGcmFnbWVudENsYXNzLnByb3RvdHlwZS5vbkRlc3Ryb3lWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3Mub25EZXN0cm95Vmlldyh0aGlzLCBfc3VwZXIucHJvdG90eXBlLm9uRGVzdHJveVZpZXcpO1xuICAgIH07XG4gICAgRnJhZ21lbnRDbGFzcy5wcm90b3R5cGUub25EZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3Mub25EZXN0cm95KHRoaXMsIF9zdXBlci5wcm90b3R5cGUub25EZXN0cm95KTtcbiAgICB9O1xuICAgIEZyYWdtZW50Q2xhc3MucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzO1xuICAgICAgICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FsbGJhY2tzLnRvU3RyaW5nT3ZlcnJpZGUodGhpcywgX3N1cGVyLnByb3RvdHlwZS50b1N0cmluZyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYWdtZW50Q2xhc3MgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgSmF2YVByb3h5KFwiY29tLnRucy5GcmFnbWVudENsYXNzXCIpXG4gICAgXSwgRnJhZ21lbnRDbGFzcyk7XG4gICAgcmV0dXJuIEZyYWdtZW50Q2xhc3M7XG59KG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5GcmFnbWVudEJhc2UpKTtcbmZyYW1lXzEuc2V0RnJhZ21lbnRDbGFzcyhGcmFnbWVudENsYXNzKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZyYWdtZW50LmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGZyYW1lX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vZnJhbWUtY29tbW9uXCIpO1xudmFyIHRyYW5zaXRpb25fMSA9IHJlcXVpcmUoXCIuLi90cmFuc2l0aW9uL3RyYW5zaXRpb25cIik7XG52YXIgc2xpZGVfdHJhbnNpdGlvbl8xID0gcmVxdWlyZShcIi4uL3RyYW5zaXRpb24vc2xpZGUtdHJhbnNpdGlvblwiKTtcbnZhciBmYWRlX3RyYW5zaXRpb25fMSA9IHJlcXVpcmUoXCIuLi90cmFuc2l0aW9uL2ZhZGUtdHJhbnNpdGlvblwiKTtcbnZhciBmbGlwX3RyYW5zaXRpb25fMSA9IHJlcXVpcmUoXCIuLi90cmFuc2l0aW9uL2ZsaXAtdHJhbnNpdGlvblwiKTtcbnZhciBhbmltYXRpb25fMSA9IHJlcXVpcmUoXCIuLi9hbmltYXRpb25cIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybVwiKTtcbnZhciBsYXp5XzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvbGF6eVwiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uL3RyYWNlXCIpO1xudmFyIHNka1ZlcnNpb24gPSBsYXp5XzEuZGVmYXVsdChmdW5jdGlvbiAoKSB7IHJldHVybiBwYXJzZUludChwbGF0Zm9ybV8xLmRldmljZS5zZGtWZXJzaW9uKTsgfSk7XG52YXIgaW50RXZhbHVhdG9yID0gbGF6eV8xLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IGFuZHJvaWQuYW5pbWF0aW9uLkludEV2YWx1YXRvcigpOyB9KTtcbnZhciBkZWZhdWx0SW50ZXJwb2xhdG9yID0gbGF6eV8xLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IGFuZHJvaWQudmlldy5hbmltYXRpb24uQWNjZWxlcmF0ZURlY2VsZXJhdGVJbnRlcnBvbGF0b3IoKTsgfSk7XG5leHBvcnRzLndhaXRpbmdRdWV1ZSA9IG5ldyBNYXAoKTtcbmV4cG9ydHMuY29tcGxldGVkRW50cmllcyA9IG5ldyBNYXAoKTtcbnZhciBUcmFuc2l0aW9uTGlzdGVuZXI7XG52YXIgQW5pbWF0aW9uTGlzdGVuZXI7XG5mdW5jdGlvbiBfc2V0QW5kcm9pZEZyYWdtZW50VHJhbnNpdGlvbnMoYW5pbWF0ZWQsIG5hdmlnYXRpb25UcmFuc2l0aW9uLCBjdXJyZW50RW50cnksIG5ld0VudHJ5LCBmcmFnbWVudFRyYW5zYWN0aW9uLCBmcmFtZUlkKSB7XG4gICAgdmFyIGN1cnJlbnRGcmFnbWVudCA9IGN1cnJlbnRFbnRyeSA/IGN1cnJlbnRFbnRyeS5mcmFnbWVudCA6IG51bGw7XG4gICAgdmFyIG5ld0ZyYWdtZW50ID0gbmV3RW50cnkuZnJhZ21lbnQ7XG4gICAgdmFyIGVudHJpZXMgPSBleHBvcnRzLndhaXRpbmdRdWV1ZS5nZXQoZnJhbWVJZCk7XG4gICAgaWYgKGVudHJpZXMgJiYgZW50cmllcy5zaXplID4gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYWxsaW5nIG5hdmlnYXRpb24gYmVmb3JlIHByZXZpb3VzIG5hdmlnYXRpb24gZmluaXNoLlwiKTtcbiAgICB9XG4gICAgaWYgKHNka1ZlcnNpb24oKSA+PSAyMSkge1xuICAgICAgICBhbGxvd1RyYW5zaXRpb25PdmVybGFwKGN1cnJlbnRGcmFnbWVudCk7XG4gICAgICAgIGFsbG93VHJhbnNpdGlvbk92ZXJsYXAobmV3RnJhZ21lbnQpO1xuICAgIH1cbiAgICB2YXIgbmFtZSA9IFwiXCI7XG4gICAgdmFyIHRyYW5zaXRpb247XG4gICAgaWYgKG5hdmlnYXRpb25UcmFuc2l0aW9uKSB7XG4gICAgICAgIHRyYW5zaXRpb24gPSBuYXZpZ2F0aW9uVHJhbnNpdGlvbi5pbnN0YW5jZTtcbiAgICAgICAgbmFtZSA9IG5hdmlnYXRpb25UcmFuc2l0aW9uLm5hbWUgPyBuYXZpZ2F0aW9uVHJhbnNpdGlvbi5uYW1lLnRvTG93ZXJDYXNlKCkgOiBcIlwiO1xuICAgIH1cbiAgICB2YXIgdXNlTG9sbGlwb3BUcmFuc2l0aW9uID0gISEobmFtZSAmJiAobmFtZS5pbmRleE9mKFwic2xpZGVcIikgPT09IDAgfHwgbmFtZSA9PT0gXCJmYWRlXCIgfHwgbmFtZSA9PT0gXCJleHBsb2RlXCIpICYmIHNka1ZlcnNpb24oKSA+PSAyMSk7XG4gICAgaWYgKGN1cnJlbnRGcmFnbWVudCAmJlxuICAgICAgICBjdXJyZW50RnJhZ21lbnQuZ2V0Q2hpbGRGcmFnbWVudE1hbmFnZXIoKSAmJlxuICAgICAgICBjdXJyZW50RnJhZ21lbnQuZ2V0Q2hpbGRGcmFnbWVudE1hbmFnZXIoKS5nZXRGcmFnbWVudHMoKS50b0FycmF5KCkubGVuZ3RoID4gMCkge1xuICAgICAgICB1c2VMb2xsaXBvcFRyYW5zaXRpb24gPSBmYWxzZTtcbiAgICB9XG4gICAgbmV3RW50cnkudXNlTG9sbGlwb3BUcmFuc2l0aW9uID0gdXNlTG9sbGlwb3BUcmFuc2l0aW9uO1xuICAgIGlmICghYW5pbWF0ZWQpIHtcbiAgICAgICAgbmFtZSA9IFwibm9uZVwiO1xuICAgIH1cbiAgICBlbHNlIGlmICh0cmFuc2l0aW9uKSB7XG4gICAgICAgIG5hbWUgPSBcImN1c3RvbVwiO1xuICAgICAgICB1c2VMb2xsaXBvcFRyYW5zaXRpb24gPSBmYWxzZTtcbiAgICB9XG4gICAgZWxzZSBpZiAoIXVzZUxvbGxpcG9wVHJhbnNpdGlvbiAmJiBuYW1lLmluZGV4T2YoXCJzbGlkZVwiKSAhPT0gMCAmJiBuYW1lICE9PSBcImZhZGVcIiAmJiBuYW1lLmluZGV4T2YoXCJmbGlwXCIpICE9PSAwKSB7XG4gICAgICAgIG5hbWUgPSBcImRlZmF1bHRcIjtcbiAgICB9XG4gICAgdmFyIGN1cnJlbnRGcmFnbWVudE5lZWRzRGlmZmVyZW50QW5pbWF0aW9uID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRFbnRyeSkge1xuICAgICAgICBfdXBkYXRlVHJhbnNpdGlvbnMoY3VycmVudEVudHJ5KTtcbiAgICAgICAgaWYgKGN1cnJlbnRFbnRyeS50cmFuc2l0aW9uTmFtZSAhPT0gbmFtZSB8fFxuICAgICAgICAgICAgY3VycmVudEVudHJ5LnRyYW5zaXRpb24gIT09IHRyYW5zaXRpb24gfHxcbiAgICAgICAgICAgICEhY3VycmVudEVudHJ5LnVzZUxvbGxpcG9wVHJhbnNpdGlvbiAhPT0gdXNlTG9sbGlwb3BUcmFuc2l0aW9uIHx8XG4gICAgICAgICAgICAhdXNlTG9sbGlwb3BUcmFuc2l0aW9uKSB7XG4gICAgICAgICAgICBjbGVhckV4aXRBbmRSZWVudGVyVHJhbnNpdGlvbnMoY3VycmVudEVudHJ5LCB0cnVlKTtcbiAgICAgICAgICAgIGN1cnJlbnRGcmFnbWVudE5lZWRzRGlmZmVyZW50QW5pbWF0aW9uID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAobmFtZSA9PT0gXCJub25lXCIpIHtcbiAgICAgICAgdHJhbnNpdGlvbiA9IG5ldyBOb1RyYW5zaXRpb24oMCwgbnVsbCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKG5hbWUgPT09IFwiZGVmYXVsdFwiKSB7XG4gICAgICAgIHRyYW5zaXRpb24gPSBuZXcgZmFkZV90cmFuc2l0aW9uXzEuRmFkZVRyYW5zaXRpb24oMTUwLCBudWxsKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodXNlTG9sbGlwb3BUcmFuc2l0aW9uKSB7XG4gICAgICAgIGlmIChuYW1lLmluZGV4T2YoXCJzbGlkZVwiKSA9PT0gMCkge1xuICAgICAgICAgICAgc2V0dXBOZXdGcmFnbWVudFNsaWRlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgbmV3RW50cnksIG5hbWUpO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRGcmFnbWVudE5lZWRzRGlmZmVyZW50QW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgc2V0dXBDdXJyZW50RnJhZ21lbnRTbGlkZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIGN1cnJlbnRFbnRyeSwgbmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobmFtZSA9PT0gXCJmYWRlXCIpIHtcbiAgICAgICAgICAgIHNldHVwTmV3RnJhZ21lbnRGYWRlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgbmV3RW50cnkpO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRGcmFnbWVudE5lZWRzRGlmZmVyZW50QW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgc2V0dXBDdXJyZW50RnJhZ21lbnRGYWRlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgY3VycmVudEVudHJ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChuYW1lID09PSBcImV4cGxvZGVcIikge1xuICAgICAgICAgICAgc2V0dXBOZXdGcmFnbWVudEV4cGxvZGVUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCBuZXdFbnRyeSk7XG4gICAgICAgICAgICBpZiAoY3VycmVudEZyYWdtZW50TmVlZHNEaWZmZXJlbnRBbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICBzZXR1cEN1cnJlbnRGcmFnbWVudEV4cGxvZGVUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCBjdXJyZW50RW50cnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKG5hbWUuaW5kZXhPZihcInNsaWRlXCIpID09PSAwKSB7XG4gICAgICAgIHZhciBkaXJlY3Rpb24gPSBuYW1lLnN1YnN0cihcInNsaWRlXCIubGVuZ3RoKSB8fCBcImxlZnRcIjtcbiAgICAgICAgdHJhbnNpdGlvbiA9IG5ldyBzbGlkZV90cmFuc2l0aW9uXzEuU2xpZGVUcmFuc2l0aW9uKGRpcmVjdGlvbiwgbmF2aWdhdGlvblRyYW5zaXRpb24uZHVyYXRpb24sIG5hdmlnYXRpb25UcmFuc2l0aW9uLmN1cnZlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobmFtZSA9PT0gXCJmYWRlXCIpIHtcbiAgICAgICAgdHJhbnNpdGlvbiA9IG5ldyBmYWRlX3RyYW5zaXRpb25fMS5GYWRlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbi5kdXJhdGlvbiwgbmF2aWdhdGlvblRyYW5zaXRpb24uY3VydmUpO1xuICAgIH1cbiAgICBlbHNlIGlmIChuYW1lLmluZGV4T2YoXCJmbGlwXCIpID09PSAwKSB7XG4gICAgICAgIHZhciBkaXJlY3Rpb24gPSBuYW1lLnN1YnN0cihcImZsaXBcIi5sZW5ndGgpIHx8IFwicmlnaHRcIjtcbiAgICAgICAgdHJhbnNpdGlvbiA9IG5ldyBmbGlwX3RyYW5zaXRpb25fMS5GbGlwVHJhbnNpdGlvbihkaXJlY3Rpb24sIG5hdmlnYXRpb25UcmFuc2l0aW9uLmR1cmF0aW9uLCBuYXZpZ2F0aW9uVHJhbnNpdGlvbi5jdXJ2ZSk7XG4gICAgfVxuICAgIG5ld0VudHJ5LnRyYW5zaXRpb25OYW1lID0gbmFtZTtcbiAgICBpZiAobmFtZSA9PT0gXCJjdXN0b21cIikge1xuICAgICAgICBuZXdFbnRyeS50cmFuc2l0aW9uID0gdHJhbnNpdGlvbjtcbiAgICB9XG4gICAgaWYgKHRyYW5zaXRpb24pIHtcbiAgICAgICAgaWYgKGZyYWdtZW50VHJhbnNhY3Rpb24pIHtcbiAgICAgICAgICAgIGZyYWdtZW50VHJhbnNhY3Rpb24uc2V0Q3VzdG9tQW5pbWF0aW9ucygtMTAsIC0yMCk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0dXBBbGxBbmltYXRpb24obmV3RW50cnksIHRyYW5zaXRpb24pO1xuICAgICAgICBpZiAoY3VycmVudEZyYWdtZW50TmVlZHNEaWZmZXJlbnRBbmltYXRpb24pIHtcbiAgICAgICAgICAgIHNldHVwRXhpdEFuZFBvcEVudGVyQW5pbWF0aW9uKGN1cnJlbnRFbnRyeSwgdHJhbnNpdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGN1cnJlbnRFbnRyeSkge1xuICAgICAgICBjdXJyZW50RW50cnkudHJhbnNpdGlvbk5hbWUgPSBuYW1lO1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJjdXN0b21cIikge1xuICAgICAgICAgICAgY3VycmVudEVudHJ5LnRyYW5zaXRpb24gPSB0cmFuc2l0aW9uO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldHVwRGVmYXVsdEFuaW1hdGlvbnMobmV3RW50cnksIG5ldyBmYWRlX3RyYW5zaXRpb25fMS5GYWRlVHJhbnNpdGlvbigxNTAsIG51bGwpKTtcbiAgICBwcmludFRyYW5zaXRpb25zKGN1cnJlbnRFbnRyeSk7XG4gICAgcHJpbnRUcmFuc2l0aW9ucyhuZXdFbnRyeSk7XG59XG5leHBvcnRzLl9zZXRBbmRyb2lkRnJhZ21lbnRUcmFuc2l0aW9ucyA9IF9zZXRBbmRyb2lkRnJhZ21lbnRUcmFuc2l0aW9ucztcbmZ1bmN0aW9uIF9vbkZyYWdtZW50Q3JlYXRlQW5pbWF0b3IoZW50cnksIGZyYWdtZW50LCBuZXh0QW5pbSwgZW50ZXIpIHtcbiAgICB2YXIgYW5pbWF0b3I7XG4gICAgc3dpdGNoIChuZXh0QW5pbSkge1xuICAgICAgICBjYXNlIC0xMDpcbiAgICAgICAgICAgIGFuaW1hdG9yID0gZW50cnkuZW50ZXJBbmltYXRvciB8fCBlbnRyeS5kZWZhdWx0RW50ZXJBbmltYXRvcjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIC0yMDpcbiAgICAgICAgICAgIGFuaW1hdG9yID0gZW50cnkuZXhpdEFuaW1hdG9yIHx8IGVudHJ5LmRlZmF1bHRFeGl0QW5pbWF0b3I7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAtMzA6XG4gICAgICAgICAgICBhbmltYXRvciA9IGVudHJ5LnBvcEVudGVyQW5pbWF0b3I7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAtNDA6XG4gICAgICAgICAgICBhbmltYXRvciA9IGVudHJ5LnBvcEV4aXRBbmltYXRvcjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAoIWFuaW1hdG9yICYmIHNka1ZlcnNpb24oKSA+PSAyMSkge1xuICAgICAgICB2YXIgdmlldyA9IGZyYWdtZW50LmdldFZpZXcoKTtcbiAgICAgICAgdmFyIGpzUGFyZW50ID0gZW50cnkucmVzb2x2ZWRQYWdlLnBhcmVudDtcbiAgICAgICAgdmFyIHBhcmVudF8xID0gdmlldy5nZXRQYXJlbnQoKSB8fCAoanNQYXJlbnQgJiYganNQYXJlbnQubmF0aXZlVmlld1Byb3RlY3RlZCk7XG4gICAgICAgIHZhciBhbmltYXRlZEVudHJpZXMgPSBfZ2V0QW5pbWF0ZWRFbnRyaWVzKGVudHJ5LmZyYW1lSWQpO1xuICAgICAgICBpZiAoIWFuaW1hdGVkRW50cmllcyB8fCAhYW5pbWF0ZWRFbnRyaWVzLmhhcyhlbnRyeSkpIHtcbiAgICAgICAgICAgIGlmIChwYXJlbnRfMSAmJiAhcGFyZW50XzEuaXNMYWlkT3V0KCkpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRvciA9IGVudGVyID8gZW50cnkuZGVmYXVsdEVudGVyQW5pbWF0b3IgOiBlbnRyeS5kZWZhdWx0RXhpdEFuaW1hdG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhbmltYXRvcjtcbn1cbmV4cG9ydHMuX29uRnJhZ21lbnRDcmVhdGVBbmltYXRvciA9IF9vbkZyYWdtZW50Q3JlYXRlQW5pbWF0b3I7XG5mdW5jdGlvbiBfZ2V0QW5pbWF0ZWRFbnRyaWVzKGZyYW1lSWQpIHtcbiAgICByZXR1cm4gZXhwb3J0cy53YWl0aW5nUXVldWUuZ2V0KGZyYW1lSWQpO1xufVxuZXhwb3J0cy5fZ2V0QW5pbWF0ZWRFbnRyaWVzID0gX2dldEFuaW1hdGVkRW50cmllcztcbmZ1bmN0aW9uIF91cGRhdGVUcmFuc2l0aW9ucyhlbnRyeSkge1xuICAgIHZhciBmcmFnbWVudCA9IGVudHJ5LmZyYWdtZW50O1xuICAgIHZhciBlbnRlclRyYW5zaXRpb25MaXN0ZW5lciA9IGVudHJ5LmVudGVyVHJhbnNpdGlvbkxpc3RlbmVyO1xuICAgIGlmIChlbnRlclRyYW5zaXRpb25MaXN0ZW5lciAmJiBmcmFnbWVudCkge1xuICAgICAgICBmcmFnbWVudC5zZXRFbnRlclRyYW5zaXRpb24oZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXIudHJhbnNpdGlvbik7XG4gICAgfVxuICAgIHZhciBleGl0VHJhbnNpdGlvbkxpc3RlbmVyID0gZW50cnkuZXhpdFRyYW5zaXRpb25MaXN0ZW5lcjtcbiAgICBpZiAoZXhpdFRyYW5zaXRpb25MaXN0ZW5lciAmJiBmcmFnbWVudCkge1xuICAgICAgICBmcmFnbWVudC5zZXRFeGl0VHJhbnNpdGlvbihleGl0VHJhbnNpdGlvbkxpc3RlbmVyLnRyYW5zaXRpb24pO1xuICAgIH1cbiAgICB2YXIgcmVlbnRlclRyYW5zaXRpb25MaXN0ZW5lciA9IGVudHJ5LnJlZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXI7XG4gICAgaWYgKHJlZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXIgJiYgZnJhZ21lbnQpIHtcbiAgICAgICAgZnJhZ21lbnQuc2V0UmVlbnRlclRyYW5zaXRpb24ocmVlbnRlclRyYW5zaXRpb25MaXN0ZW5lci50cmFuc2l0aW9uKTtcbiAgICB9XG4gICAgdmFyIHJldHVyblRyYW5zaXRpb25MaXN0ZW5lciA9IGVudHJ5LnJldHVyblRyYW5zaXRpb25MaXN0ZW5lcjtcbiAgICBpZiAocmV0dXJuVHJhbnNpdGlvbkxpc3RlbmVyICYmIGZyYWdtZW50KSB7XG4gICAgICAgIGZyYWdtZW50LnNldFJldHVyblRyYW5zaXRpb24ocmV0dXJuVHJhbnNpdGlvbkxpc3RlbmVyLnRyYW5zaXRpb24pO1xuICAgIH1cbn1cbmV4cG9ydHMuX3VwZGF0ZVRyYW5zaXRpb25zID0gX3VwZGF0ZVRyYW5zaXRpb25zO1xuZnVuY3Rpb24gX3JldmVyc2VUcmFuc2l0aW9ucyhwcmV2aW91c0VudHJ5LCBjdXJyZW50RW50cnkpIHtcbiAgICB2YXIgcHJldmlvdXNGcmFnbWVudCA9IHByZXZpb3VzRW50cnkuZnJhZ21lbnQ7XG4gICAgdmFyIGN1cnJlbnRGcmFnbWVudCA9IGN1cnJlbnRFbnRyeS5mcmFnbWVudDtcbiAgICB2YXIgdHJhbnNpdGlvblVzZWQgPSBmYWxzZTtcbiAgICBpZiAoc2RrVmVyc2lvbigpID49IDIxKSB7XG4gICAgICAgIHZhciByZXR1cm5UcmFuc2l0aW9uTGlzdGVuZXIgPSBjdXJyZW50RW50cnkucmV0dXJuVHJhbnNpdGlvbkxpc3RlbmVyO1xuICAgICAgICBpZiAocmV0dXJuVHJhbnNpdGlvbkxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0cmFuc2l0aW9uVXNlZCA9IHRydWU7XG4gICAgICAgICAgICBjdXJyZW50RnJhZ21lbnQuc2V0RXhpdFRyYW5zaXRpb24ocmV0dXJuVHJhbnNpdGlvbkxpc3RlbmVyLnRyYW5zaXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY3VycmVudEZyYWdtZW50LnNldEV4aXRUcmFuc2l0aW9uKG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZWVudGVyVHJhbnNpdGlvbkxpc3RlbmVyID0gcHJldmlvdXNFbnRyeS5yZWVudGVyVHJhbnNpdGlvbkxpc3RlbmVyO1xuICAgICAgICBpZiAocmVlbnRlclRyYW5zaXRpb25MaXN0ZW5lcikge1xuICAgICAgICAgICAgdHJhbnNpdGlvblVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgcHJldmlvdXNGcmFnbWVudC5zZXRFbnRlclRyYW5zaXRpb24ocmVlbnRlclRyYW5zaXRpb25MaXN0ZW5lci50cmFuc2l0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHByZXZpb3VzRnJhZ21lbnQuc2V0RW50ZXJUcmFuc2l0aW9uKG51bGwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cmFuc2l0aW9uVXNlZDtcbn1cbmV4cG9ydHMuX3JldmVyc2VUcmFuc2l0aW9ucyA9IF9yZXZlcnNlVHJhbnNpdGlvbnM7XG5mdW5jdGlvbiBnZXRUcmFuc2l0aW9uTGlzdGVuZXIoZW50cnksIHRyYW5zaXRpb24pIHtcbiAgICBpZiAoIVRyYW5zaXRpb25MaXN0ZW5lcikge1xuICAgICAgICB2YXIgVHJhbnNpdGlvbkxpc3RlbmVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgICAgICBfX2V4dGVuZHMoVHJhbnNpdGlvbkxpc3RlbmVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFRyYW5zaXRpb25MaXN0ZW5lckltcGwoZW50cnksIHRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgICAgIF90aGlzLmVudHJ5ID0gZW50cnk7XG4gICAgICAgICAgICAgICAgX3RoaXMudHJhbnNpdGlvbiA9IHRyYW5zaXRpb247XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBUcmFuc2l0aW9uTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblRyYW5zaXRpb25TdGFydCA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy5lbnRyeTtcbiAgICAgICAgICAgICAgICBhZGRUb1dhaXRpbmdRdWV1ZShlbnRyeSk7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIlNUQVJUIFwiICsgdG9TaG9ydFN0cmluZyh0cmFuc2l0aW9uKSArIFwiIHRyYW5zaXRpb24gZm9yIFwiICsgZW50cnkuZnJhZ21lbnRUYWcsIHRyYWNlXzEuY2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgVHJhbnNpdGlvbkxpc3RlbmVySW1wbC5wcm90b3R5cGUub25UcmFuc2l0aW9uRW5kID0gZnVuY3Rpb24gKHRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgZW50cnkgPSB0aGlzLmVudHJ5O1xuICAgICAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJFTkQgXCIgKyB0b1Nob3J0U3RyaW5nKHRyYW5zaXRpb24pICsgXCIgdHJhbnNpdGlvbiBmb3IgXCIgKyBlbnRyeS5mcmFnbWVudFRhZywgdHJhY2VfMS5jYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uT3JBbmltYXRpb25Db21wbGV0ZWQoZW50cnkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFRyYW5zaXRpb25MaXN0ZW5lckltcGwucHJvdG90eXBlLm9uVHJhbnNpdGlvblJlc3VtZSA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZyYWdtZW50ID0gdGhpcy5lbnRyeS5mcmFnbWVudFRhZztcbiAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIlJFU1VNRSBcIiArIHRvU2hvcnRTdHJpbmcodHJhbnNpdGlvbikgKyBcIiB0cmFuc2l0aW9uIGZvciBcIiArIGZyYWdtZW50LCB0cmFjZV8xLmNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFRyYW5zaXRpb25MaXN0ZW5lckltcGwucHJvdG90eXBlLm9uVHJhbnNpdGlvblBhdXNlID0gZnVuY3Rpb24gKHRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiUEFVU0UgXCIgKyB0b1Nob3J0U3RyaW5nKHRyYW5zaXRpb24pICsgXCIgdHJhbnNpdGlvbiBmb3IgXCIgKyB0aGlzLmVudHJ5LmZyYWdtZW50VGFnLCB0cmFjZV8xLmNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFRyYW5zaXRpb25MaXN0ZW5lckltcGwucHJvdG90eXBlLm9uVHJhbnNpdGlvbkNhbmNlbCA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkNBTkNFTCBcIiArIHRvU2hvcnRTdHJpbmcodHJhbnNpdGlvbikgKyBcIiB0cmFuc2l0aW9uIGZvciBcIiArIHRoaXMuZW50cnkuZnJhZ21lbnRUYWcsIHRyYWNlXzEuY2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgVHJhbnNpdGlvbkxpc3RlbmVySW1wbCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWQudHJhbnNpdGlvbi5UcmFuc2l0aW9uLlRyYW5zaXRpb25MaXN0ZW5lcl0pXG4gICAgICAgICAgICBdLCBUcmFuc2l0aW9uTGlzdGVuZXJJbXBsKTtcbiAgICAgICAgICAgIHJldHVybiBUcmFuc2l0aW9uTGlzdGVuZXJJbXBsO1xuICAgICAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICAgICAgVHJhbnNpdGlvbkxpc3RlbmVyID0gVHJhbnNpdGlvbkxpc3RlbmVySW1wbDtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBUcmFuc2l0aW9uTGlzdGVuZXIoZW50cnksIHRyYW5zaXRpb24pO1xufVxuZnVuY3Rpb24gZ2V0QW5pbWF0aW9uTGlzdGVuZXIoKSB7XG4gICAgaWYgKCFBbmltYXRpb25MaXN0ZW5lcikge1xuICAgICAgICB2YXIgQW5pbWF0aW9uTGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgICAgIF9fZXh0ZW5kcyhBbmltYXRpb25MaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgICAgICBmdW5jdGlvbiBBbmltYXRpb25MaXN0ZW5lckltcGwoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEFuaW1hdGlvbkxpc3RlbmVySW1wbC5wcm90b3R5cGUub25BbmltYXRpb25TdGFydCA9IGZ1bmN0aW9uIChhbmltYXRvcikge1xuICAgICAgICAgICAgICAgIHZhciBlbnRyeSA9IGFuaW1hdG9yLmVudHJ5O1xuICAgICAgICAgICAgICAgIGFkZFRvV2FpdGluZ1F1ZXVlKGVudHJ5KTtcbiAgICAgICAgICAgICAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiU1RBUlQgXCIgKyBhbmltYXRvci50cmFuc2l0aW9uVHlwZSArIFwiIGZvciBcIiArIGVudHJ5LmZyYWdtZW50VGFnLCB0cmFjZV8xLmNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIEFuaW1hdGlvbkxpc3RlbmVySW1wbC5wcm90b3R5cGUub25BbmltYXRpb25SZXBlYXQgPSBmdW5jdGlvbiAoYW5pbWF0b3IpIHtcbiAgICAgICAgICAgICAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiUkVQRUFUIFwiICsgYW5pbWF0b3IudHJhbnNpdGlvblR5cGUgKyBcIiBmb3IgXCIgKyBhbmltYXRvci5lbnRyeS5mcmFnbWVudFRhZywgdHJhY2VfMS5jYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBBbmltYXRpb25MaXN0ZW5lckltcGwucHJvdG90eXBlLm9uQW5pbWF0aW9uRW5kID0gZnVuY3Rpb24gKGFuaW1hdG9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkVORCBcIiArIGFuaW1hdG9yLnRyYW5zaXRpb25UeXBlICsgXCIgZm9yIFwiICsgYW5pbWF0b3IuZW50cnkuZnJhZ21lbnRUYWcsIHRyYWNlXzEuY2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbk9yQW5pbWF0aW9uQ29tcGxldGVkKGFuaW1hdG9yLmVudHJ5KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBBbmltYXRpb25MaXN0ZW5lckltcGwucHJvdG90eXBlLm9uQW5pbWF0aW9uQ2FuY2VsID0gZnVuY3Rpb24gKGFuaW1hdG9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkNBTkNFTCBcIiArIGFuaW1hdG9yLnRyYW5zaXRpb25UeXBlICsgXCIgZm9yIFwiICsgYW5pbWF0b3IuZW50cnkuZnJhZ21lbnRUYWcsIHRyYWNlXzEuY2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgQW5pbWF0aW9uTGlzdGVuZXJJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICAgICAgSW50ZXJmYWNlcyhbYW5kcm9pZC5hbmltYXRpb24uQW5pbWF0b3IuQW5pbWF0b3JMaXN0ZW5lcl0pXG4gICAgICAgICAgICBdLCBBbmltYXRpb25MaXN0ZW5lckltcGwpO1xuICAgICAgICAgICAgcmV0dXJuIEFuaW1hdGlvbkxpc3RlbmVySW1wbDtcbiAgICAgICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgICAgIEFuaW1hdGlvbkxpc3RlbmVyID0gbmV3IEFuaW1hdGlvbkxpc3RlbmVySW1wbCgpO1xuICAgIH1cbiAgICByZXR1cm4gQW5pbWF0aW9uTGlzdGVuZXI7XG59XG5mdW5jdGlvbiBhZGRUb1dhaXRpbmdRdWV1ZShlbnRyeSkge1xuICAgIHZhciBmcmFtZUlkID0gZW50cnkuZnJhbWVJZDtcbiAgICB2YXIgZW50cmllcyA9IGV4cG9ydHMud2FpdGluZ1F1ZXVlLmdldChmcmFtZUlkKTtcbiAgICBpZiAoIWVudHJpZXMpIHtcbiAgICAgICAgZW50cmllcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgZXhwb3J0cy53YWl0aW5nUXVldWUuc2V0KGZyYW1lSWQsIGVudHJpZXMpO1xuICAgIH1cbiAgICBlbnRyaWVzLmFkZChlbnRyeSk7XG59XG5mdW5jdGlvbiBjbGVhckFuaW1hdGlvbkxpc3RlbmVyKGFuaW1hdG9yLCBsaXN0ZW5lcikge1xuICAgIGlmICghYW5pbWF0b3IpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhbmltYXRvci5yZW1vdmVMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgaWYgKGFuaW1hdG9yLmVudHJ5ICYmIHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gYW5pbWF0b3IuZW50cnk7XG4gICAgICAgIHRyYWNlXzEud3JpdGUoXCJDbGVhciBcIiArIGFuaW1hdG9yLnRyYW5zaXRpb25UeXBlICsgXCIgLSBcIiArIGVudHJ5LnRyYW5zaXRpb24gKyBcIiBmb3IgXCIgKyBlbnRyeS5mcmFnbWVudFRhZywgdHJhY2VfMS5jYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgIH1cbiAgICBhbmltYXRvci5lbnRyeSA9IG51bGw7XG59XG5mdW5jdGlvbiBjbGVhckV4aXRBbmRSZWVudGVyVHJhbnNpdGlvbnMoZW50cnksIHJlbW92ZUxpc3RlbmVyKSB7XG4gICAgaWYgKHNka1ZlcnNpb24oKSA+PSAyMSkge1xuICAgICAgICB2YXIgZnJhZ21lbnQgPSBlbnRyeS5mcmFnbWVudDtcbiAgICAgICAgdmFyIGV4aXRMaXN0ZW5lciA9IGVudHJ5LmV4aXRUcmFuc2l0aW9uTGlzdGVuZXI7XG4gICAgICAgIGlmIChleGl0TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHZhciBleGl0VHJhbnNpdGlvbiA9IGZyYWdtZW50LmdldEV4aXRUcmFuc2l0aW9uKCk7XG4gICAgICAgICAgICBpZiAoZXhpdFRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAocmVtb3ZlTGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXhpdFRyYW5zaXRpb24ucmVtb3ZlTGlzdGVuZXIoZXhpdExpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZnJhZ21lbnQuc2V0RXhpdFRyYW5zaXRpb24obnVsbCk7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkNsZWFyZWQgRXhpdCBcIiArIGV4aXRUcmFuc2l0aW9uLmdldENsYXNzKCkuZ2V0U2ltcGxlTmFtZSgpICsgXCIgdHJhbnNpdGlvbiBmb3IgXCIgKyBmcmFnbWVudCwgdHJhY2VfMS5jYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZW1vdmVMaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgIGVudHJ5LmV4aXRUcmFuc2l0aW9uTGlzdGVuZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciByZWVudGVyTGlzdGVuZXIgPSBlbnRyeS5yZWVudGVyVHJhbnNpdGlvbkxpc3RlbmVyO1xuICAgICAgICBpZiAocmVlbnRlckxpc3RlbmVyKSB7XG4gICAgICAgICAgICB2YXIgcmVlbnRlclRyYW5zaXRpb24gPSBmcmFnbWVudC5nZXRSZWVudGVyVHJhbnNpdGlvbigpO1xuICAgICAgICAgICAgaWYgKHJlZW50ZXJUcmFuc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlbW92ZUxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlZW50ZXJUcmFuc2l0aW9uLnJlbW92ZUxpc3RlbmVyKHJlZW50ZXJMaXN0ZW5lcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZyYWdtZW50LnNldFJlZW50ZXJUcmFuc2l0aW9uKG51bGwpO1xuICAgICAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDbGVhcmVkIFJlZW50ZXIgXCIgKyByZWVudGVyVHJhbnNpdGlvbi5nZXRDbGFzcygpLmdldFNpbXBsZU5hbWUoKSArIFwiIHRyYW5zaXRpb24gZm9yIFwiICsgZnJhZ21lbnQsIHRyYWNlXzEuY2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVtb3ZlTGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICBlbnRyeS5yZWVudGVyVHJhbnNpdGlvbkxpc3RlbmVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIF9jbGVhckZyYWdtZW50KGVudHJ5KSB7XG4gICAgY2xlYXJFbnRyeShlbnRyeSwgZmFsc2UpO1xufVxuZXhwb3J0cy5fY2xlYXJGcmFnbWVudCA9IF9jbGVhckZyYWdtZW50O1xuZnVuY3Rpb24gX2NsZWFyRW50cnkoZW50cnkpIHtcbiAgICBjbGVhckVudHJ5KGVudHJ5LCB0cnVlKTtcbn1cbmV4cG9ydHMuX2NsZWFyRW50cnkgPSBfY2xlYXJFbnRyeTtcbmZ1bmN0aW9uIGNsZWFyRW50cnkoZW50cnksIHJlbW92ZUxpc3RlbmVyKSB7XG4gICAgY2xlYXJFeGl0QW5kUmVlbnRlclRyYW5zaXRpb25zKGVudHJ5LCByZW1vdmVMaXN0ZW5lcik7XG4gICAgaWYgKHNka1ZlcnNpb24oKSA+PSAyMSkge1xuICAgICAgICB2YXIgZnJhZ21lbnQgPSBlbnRyeS5mcmFnbWVudDtcbiAgICAgICAgdmFyIGVudGVyTGlzdGVuZXIgPSBlbnRyeS5lbnRlclRyYW5zaXRpb25MaXN0ZW5lcjtcbiAgICAgICAgaWYgKGVudGVyTGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHZhciBlbnRlclRyYW5zaXRpb24gPSBmcmFnbWVudC5nZXRFbnRlclRyYW5zaXRpb24oKTtcbiAgICAgICAgICAgIGlmIChlbnRlclRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAocmVtb3ZlTGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgZW50ZXJUcmFuc2l0aW9uLnJlbW92ZUxpc3RlbmVyKGVudGVyTGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmcmFnbWVudC5zZXRFbnRlclRyYW5zaXRpb24obnVsbCk7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkNsZWFyZWQgRW50ZXIgXCIgKyBlbnRlclRyYW5zaXRpb24uZ2V0Q2xhc3MoKS5nZXRTaW1wbGVOYW1lKCkgKyBcIiB0cmFuc2l0aW9uIGZvciBcIiArIGZyYWdtZW50LCB0cmFjZV8xLmNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlbW92ZUxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgZW50cnkuZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciByZXR1cm5MaXN0ZW5lciA9IGVudHJ5LnJldHVyblRyYW5zaXRpb25MaXN0ZW5lcjtcbiAgICAgICAgaWYgKHJldHVybkxpc3RlbmVyKSB7XG4gICAgICAgICAgICB2YXIgcmV0dXJuVHJhbnNpdGlvbiA9IGZyYWdtZW50LmdldFJldHVyblRyYW5zaXRpb24oKTtcbiAgICAgICAgICAgIGlmIChyZXR1cm5UcmFuc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlbW92ZUxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblRyYW5zaXRpb24ucmVtb3ZlTGlzdGVuZXIocmV0dXJuTGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmcmFnbWVudC5zZXRSZXR1cm5UcmFuc2l0aW9uKG51bGwpO1xuICAgICAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDbGVhcmVkIFJldHVybiBcIiArIHJldHVyblRyYW5zaXRpb24uZ2V0Q2xhc3MoKS5nZXRTaW1wbGVOYW1lKCkgKyBcIiB0cmFuc2l0aW9uIGZvciBcIiArIGZyYWdtZW50LCB0cmFjZV8xLmNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlbW92ZUxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgZW50cnkucmV0dXJuVHJhbnNpdGlvbkxpc3RlbmVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAocmVtb3ZlTGlzdGVuZXIpIHtcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gZ2V0QW5pbWF0aW9uTGlzdGVuZXIoKTtcbiAgICAgICAgY2xlYXJBbmltYXRpb25MaXN0ZW5lcihlbnRyeS5lbnRlckFuaW1hdG9yLCBsaXN0ZW5lcik7XG4gICAgICAgIGNsZWFyQW5pbWF0aW9uTGlzdGVuZXIoZW50cnkuZXhpdEFuaW1hdG9yLCBsaXN0ZW5lcik7XG4gICAgICAgIGNsZWFyQW5pbWF0aW9uTGlzdGVuZXIoZW50cnkucG9wRW50ZXJBbmltYXRvciwgbGlzdGVuZXIpO1xuICAgICAgICBjbGVhckFuaW1hdGlvbkxpc3RlbmVyKGVudHJ5LnBvcEV4aXRBbmltYXRvciwgbGlzdGVuZXIpO1xuICAgICAgICBjbGVhckFuaW1hdGlvbkxpc3RlbmVyKGVudHJ5LmRlZmF1bHRFbnRlckFuaW1hdG9yLCBsaXN0ZW5lcik7XG4gICAgICAgIGNsZWFyQW5pbWF0aW9uTGlzdGVuZXIoZW50cnkuZGVmYXVsdEV4aXRBbmltYXRvciwgbGlzdGVuZXIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFsbG93VHJhbnNpdGlvbk92ZXJsYXAoZnJhZ21lbnQpIHtcbiAgICBpZiAoZnJhZ21lbnQpIHtcbiAgICAgICAgZnJhZ21lbnQuc2V0QWxsb3dFbnRlclRyYW5zaXRpb25PdmVybGFwKHRydWUpO1xuICAgICAgICBmcmFnbWVudC5zZXRBbGxvd1JldHVyblRyYW5zaXRpb25PdmVybGFwKHRydWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNldEVudGVyVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgZW50cnksIHRyYW5zaXRpb24pIHtcbiAgICBzZXRVcE5hdGl2ZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIHRyYW5zaXRpb24pO1xuICAgIHZhciBsaXN0ZW5lciA9IGFkZE5hdGl2ZVRyYW5zaXRpb25MaXN0ZW5lcihlbnRyeSwgdHJhbnNpdGlvbik7XG4gICAgZW50cnkuZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICB2YXIgZnJhZ21lbnQgPSBlbnRyeS5mcmFnbWVudDtcbiAgICBmcmFnbWVudC5zZXRFbnRlclRyYW5zaXRpb24odHJhbnNpdGlvbik7XG59XG5mdW5jdGlvbiBzZXRFeGl0VHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgZW50cnksIHRyYW5zaXRpb24pIHtcbiAgICBzZXRVcE5hdGl2ZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIHRyYW5zaXRpb24pO1xuICAgIHZhciBsaXN0ZW5lciA9IGFkZE5hdGl2ZVRyYW5zaXRpb25MaXN0ZW5lcihlbnRyeSwgdHJhbnNpdGlvbik7XG4gICAgZW50cnkuZXhpdFRyYW5zaXRpb25MaXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgIHZhciBmcmFnbWVudCA9IGVudHJ5LmZyYWdtZW50O1xuICAgIGZyYWdtZW50LnNldEV4aXRUcmFuc2l0aW9uKHRyYW5zaXRpb24pO1xufVxuZnVuY3Rpb24gc2V0UmVlbnRlclRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIGVudHJ5LCB0cmFuc2l0aW9uKSB7XG4gICAgc2V0VXBOYXRpdmVUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCB0cmFuc2l0aW9uKTtcbiAgICB2YXIgbGlzdGVuZXIgPSBhZGROYXRpdmVUcmFuc2l0aW9uTGlzdGVuZXIoZW50cnksIHRyYW5zaXRpb24pO1xuICAgIGVudHJ5LnJlZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICB2YXIgZnJhZ21lbnQgPSBlbnRyeS5mcmFnbWVudDtcbiAgICBmcmFnbWVudC5zZXRSZWVudGVyVHJhbnNpdGlvbih0cmFuc2l0aW9uKTtcbn1cbmZ1bmN0aW9uIHNldFJldHVyblRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIGVudHJ5LCB0cmFuc2l0aW9uKSB7XG4gICAgc2V0VXBOYXRpdmVUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCB0cmFuc2l0aW9uKTtcbiAgICB2YXIgbGlzdGVuZXIgPSBhZGROYXRpdmVUcmFuc2l0aW9uTGlzdGVuZXIoZW50cnksIHRyYW5zaXRpb24pO1xuICAgIGVudHJ5LnJldHVyblRyYW5zaXRpb25MaXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgIHZhciBmcmFnbWVudCA9IGVudHJ5LmZyYWdtZW50O1xuICAgIGZyYWdtZW50LnNldFJldHVyblRyYW5zaXRpb24odHJhbnNpdGlvbik7XG59XG5mdW5jdGlvbiBzZXR1cE5ld0ZyYWdtZW50U2xpZGVUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuYW1lKSB7XG4gICAgc2V0dXBDdXJyZW50RnJhZ21lbnRTbGlkZVRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5hbWUpO1xuICAgIHZhciBkaXJlY3Rpb24gPSBuYW1lLnN1YnN0cihcInNsaWRlXCIubGVuZ3RoKSB8fCBcImxlZnRcIjtcbiAgICBzd2l0Y2ggKGRpcmVjdGlvbikge1xuICAgICAgICBjYXNlIFwibGVmdFwiOlxuICAgICAgICAgICAgc2V0RW50ZXJUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLlNsaWRlKGFuZHJvaWQudmlldy5HcmF2aXR5LlJJR0hUKSk7XG4gICAgICAgICAgICBzZXRSZXR1cm5UcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLlNsaWRlKGFuZHJvaWQudmlldy5HcmF2aXR5LlJJR0hUKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcInJpZ2h0XCI6XG4gICAgICAgICAgICBzZXRFbnRlclRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uU2xpZGUoYW5kcm9pZC52aWV3LkdyYXZpdHkuTEVGVCkpO1xuICAgICAgICAgICAgc2V0UmV0dXJuVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5TbGlkZShhbmRyb2lkLnZpZXcuR3Jhdml0eS5MRUZUKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcInRvcFwiOlxuICAgICAgICAgICAgc2V0RW50ZXJUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLlNsaWRlKGFuZHJvaWQudmlldy5HcmF2aXR5LkJPVFRPTSkpO1xuICAgICAgICAgICAgc2V0UmV0dXJuVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5TbGlkZShhbmRyb2lkLnZpZXcuR3Jhdml0eS5CT1RUT00pKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiYm90dG9tXCI6XG4gICAgICAgICAgICBzZXRFbnRlclRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uU2xpZGUoYW5kcm9pZC52aWV3LkdyYXZpdHkuVE9QKSk7XG4gICAgICAgICAgICBzZXRSZXR1cm5UcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLlNsaWRlKGFuZHJvaWQudmlldy5HcmF2aXR5LlRPUCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxufVxuZnVuY3Rpb24gc2V0dXBDdXJyZW50RnJhZ21lbnRTbGlkZVRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5hbWUpIHtcbiAgICB2YXIgZGlyZWN0aW9uID0gbmFtZS5zdWJzdHIoXCJzbGlkZVwiLmxlbmd0aCkgfHwgXCJsZWZ0XCI7XG4gICAgc3dpdGNoIChkaXJlY3Rpb24pIHtcbiAgICAgICAgY2FzZSBcImxlZnRcIjpcbiAgICAgICAgICAgIHNldEV4aXRUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLlNsaWRlKGFuZHJvaWQudmlldy5HcmF2aXR5LkxFRlQpKTtcbiAgICAgICAgICAgIHNldFJlZW50ZXJUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLlNsaWRlKGFuZHJvaWQudmlldy5HcmF2aXR5LkxFRlQpKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwicmlnaHRcIjpcbiAgICAgICAgICAgIHNldEV4aXRUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLlNsaWRlKGFuZHJvaWQudmlldy5HcmF2aXR5LlJJR0hUKSk7XG4gICAgICAgICAgICBzZXRSZWVudGVyVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5TbGlkZShhbmRyb2lkLnZpZXcuR3Jhdml0eS5SSUdIVCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJ0b3BcIjpcbiAgICAgICAgICAgIHNldEV4aXRUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLlNsaWRlKGFuZHJvaWQudmlldy5HcmF2aXR5LlRPUCkpO1xuICAgICAgICAgICAgc2V0UmVlbnRlclRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uU2xpZGUoYW5kcm9pZC52aWV3LkdyYXZpdHkuVE9QKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImJvdHRvbVwiOlxuICAgICAgICAgICAgc2V0RXhpdFRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uU2xpZGUoYW5kcm9pZC52aWV3LkdyYXZpdHkuQk9UVE9NKSk7XG4gICAgICAgICAgICBzZXRSZWVudGVyVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5TbGlkZShhbmRyb2lkLnZpZXcuR3Jhdml0eS5CT1RUT00pKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNldHVwTmV3RnJhZ21lbnRGYWRlVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSkge1xuICAgIHNldHVwQ3VycmVudEZyYWdtZW50RmFkZVRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnkpO1xuICAgIHZhciBmYWRlSW5FbnRlciA9IG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uRmFkZShhbmRyb2lkLnRyYW5zaXRpb24uRmFkZS5JTik7XG4gICAgc2V0RW50ZXJUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBmYWRlSW5FbnRlcik7XG4gICAgdmFyIGZhZGVPdXRSZXR1cm4gPSBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLkZhZGUoYW5kcm9pZC50cmFuc2l0aW9uLkZhZGUuT1VUKTtcbiAgICBzZXRSZXR1cm5UcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBmYWRlT3V0UmV0dXJuKTtcbn1cbmZ1bmN0aW9uIHNldHVwQ3VycmVudEZyYWdtZW50RmFkZVRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnkpIHtcbiAgICB2YXIgZmFkZU91dEV4aXQgPSBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLkZhZGUoYW5kcm9pZC50cmFuc2l0aW9uLkZhZGUuT1VUKTtcbiAgICBzZXRFeGl0VHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgZmFkZU91dEV4aXQpO1xuICAgIHZhciBmYWRlSW5SZWVudGVyID0gbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5GYWRlKGFuZHJvaWQudHJhbnNpdGlvbi5GYWRlLklOKTtcbiAgICBzZXRSZWVudGVyVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgZmFkZUluUmVlbnRlcik7XG59XG5mdW5jdGlvbiBzZXR1cEN1cnJlbnRGcmFnbWVudEV4cGxvZGVUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5KSB7XG4gICAgc2V0RXhpdFRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uRXhwbG9kZSgpKTtcbiAgICBzZXRSZWVudGVyVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5FeHBsb2RlKCkpO1xufVxuZnVuY3Rpb24gc2V0dXBOZXdGcmFnbWVudEV4cGxvZGVUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5KSB7XG4gICAgc2V0dXBDdXJyZW50RnJhZ21lbnRFeHBsb2RlVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSk7XG4gICAgc2V0RW50ZXJUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLkV4cGxvZGUoKSk7XG4gICAgc2V0UmV0dXJuVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5FeHBsb2RlKCkpO1xufVxuZnVuY3Rpb24gc2V0dXBFeGl0QW5kUG9wRW50ZXJBbmltYXRpb24oZW50cnksIHRyYW5zaXRpb24pIHtcbiAgICB2YXIgbGlzdGVuZXIgPSBnZXRBbmltYXRpb25MaXN0ZW5lcigpO1xuICAgIGNsZWFyQW5pbWF0aW9uTGlzdGVuZXIoZW50cnkuZXhpdEFuaW1hdG9yLCBsaXN0ZW5lcik7XG4gICAgY2xlYXJBbmltYXRpb25MaXN0ZW5lcihlbnRyeS5wb3BFbnRlckFuaW1hdG9yLCBsaXN0ZW5lcik7XG4gICAgdmFyIGV4aXRBbmltYXRvciA9IHRyYW5zaXRpb24uY3JlYXRlQW5kcm9pZEFuaW1hdG9yKHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZXhpdCk7XG4gICAgZXhpdEFuaW1hdG9yLnRyYW5zaXRpb25UeXBlID0gdHJhbnNpdGlvbl8xLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5leGl0O1xuICAgIGV4aXRBbmltYXRvci5lbnRyeSA9IGVudHJ5O1xuICAgIGV4aXRBbmltYXRvci5hZGRMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgZW50cnkuZXhpdEFuaW1hdG9yID0gZXhpdEFuaW1hdG9yO1xuICAgIHZhciBwb3BFbnRlckFuaW1hdG9yID0gdHJhbnNpdGlvbi5jcmVhdGVBbmRyb2lkQW5pbWF0b3IodHJhbnNpdGlvbl8xLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFbnRlcik7XG4gICAgcG9wRW50ZXJBbmltYXRvci50cmFuc2l0aW9uVHlwZSA9IHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUucG9wRW50ZXI7XG4gICAgcG9wRW50ZXJBbmltYXRvci5lbnRyeSA9IGVudHJ5O1xuICAgIHBvcEVudGVyQW5pbWF0b3IuYWRkTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIGVudHJ5LnBvcEVudGVyQW5pbWF0b3IgPSBwb3BFbnRlckFuaW1hdG9yO1xufVxuZnVuY3Rpb24gc2V0dXBBbGxBbmltYXRpb24oZW50cnksIHRyYW5zaXRpb24pIHtcbiAgICBzZXR1cEV4aXRBbmRQb3BFbnRlckFuaW1hdGlvbihlbnRyeSwgdHJhbnNpdGlvbik7XG4gICAgdmFyIGxpc3RlbmVyID0gZ2V0QW5pbWF0aW9uTGlzdGVuZXIoKTtcbiAgICB2YXIgZW50ZXJBbmltYXRvciA9IHRyYW5zaXRpb24uY3JlYXRlQW5kcm9pZEFuaW1hdG9yKHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZW50ZXIpO1xuICAgIGVudGVyQW5pbWF0b3IudHJhbnNpdGlvblR5cGUgPSB0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLmVudGVyO1xuICAgIGVudGVyQW5pbWF0b3IuZW50cnkgPSBlbnRyeTtcbiAgICBlbnRlckFuaW1hdG9yLmFkZExpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICBlbnRyeS5lbnRlckFuaW1hdG9yID0gZW50ZXJBbmltYXRvcjtcbiAgICB2YXIgcG9wRXhpdEFuaW1hdG9yID0gdHJhbnNpdGlvbi5jcmVhdGVBbmRyb2lkQW5pbWF0b3IodHJhbnNpdGlvbl8xLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFeGl0KTtcbiAgICBwb3BFeGl0QW5pbWF0b3IudHJhbnNpdGlvblR5cGUgPSB0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLnBvcEV4aXQ7XG4gICAgcG9wRXhpdEFuaW1hdG9yLmVudHJ5ID0gZW50cnk7XG4gICAgcG9wRXhpdEFuaW1hdG9yLmFkZExpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICBlbnRyeS5wb3BFeGl0QW5pbWF0b3IgPSBwb3BFeGl0QW5pbWF0b3I7XG59XG5mdW5jdGlvbiBzZXR1cERlZmF1bHRBbmltYXRpb25zKGVudHJ5LCB0cmFuc2l0aW9uKSB7XG4gICAgdmFyIGxpc3RlbmVyID0gZ2V0QW5pbWF0aW9uTGlzdGVuZXIoKTtcbiAgICB2YXIgZW50ZXJBbmltYXRvciA9IHRyYW5zaXRpb24uY3JlYXRlQW5kcm9pZEFuaW1hdG9yKHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZW50ZXIpO1xuICAgIGVudGVyQW5pbWF0b3IudHJhbnNpdGlvblR5cGUgPSB0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLmVudGVyO1xuICAgIGVudGVyQW5pbWF0b3IuZW50cnkgPSBlbnRyeTtcbiAgICBlbnRlckFuaW1hdG9yLmFkZExpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICBlbnRyeS5kZWZhdWx0RW50ZXJBbmltYXRvciA9IGVudGVyQW5pbWF0b3I7XG4gICAgdmFyIGV4aXRBbmltYXRvciA9IHRyYW5zaXRpb24uY3JlYXRlQW5kcm9pZEFuaW1hdG9yKHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZXhpdCk7XG4gICAgZXhpdEFuaW1hdG9yLnRyYW5zaXRpb25UeXBlID0gdHJhbnNpdGlvbl8xLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5leGl0O1xuICAgIGV4aXRBbmltYXRvci5lbnRyeSA9IGVudHJ5O1xuICAgIGV4aXRBbmltYXRvci5hZGRMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgZW50cnkuZGVmYXVsdEV4aXRBbmltYXRvciA9IGV4aXRBbmltYXRvcjtcbn1cbmZ1bmN0aW9uIHNldFVwTmF0aXZlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgbmF0aXZlVHJhbnNpdGlvbikge1xuICAgIGlmIChuYXZpZ2F0aW9uVHJhbnNpdGlvbi5kdXJhdGlvbikge1xuICAgICAgICBuYXRpdmVUcmFuc2l0aW9uLnNldER1cmF0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLmR1cmF0aW9uKTtcbiAgICB9XG4gICAgdmFyIGludGVycG9sYXRvciA9IG5hdmlnYXRpb25UcmFuc2l0aW9uLmN1cnZlID8gYW5pbWF0aW9uXzEuX3Jlc29sdmVBbmltYXRpb25DdXJ2ZShuYXZpZ2F0aW9uVHJhbnNpdGlvbi5jdXJ2ZSkgOiBkZWZhdWx0SW50ZXJwb2xhdG9yKCk7XG4gICAgbmF0aXZlVHJhbnNpdGlvbi5zZXRJbnRlcnBvbGF0b3IoaW50ZXJwb2xhdG9yKTtcbn1cbmZ1bmN0aW9uIGFkZE5hdGl2ZVRyYW5zaXRpb25MaXN0ZW5lcihlbnRyeSwgbmF0aXZlVHJhbnNpdGlvbikge1xuICAgIHZhciBsaXN0ZW5lciA9IGdldFRyYW5zaXRpb25MaXN0ZW5lcihlbnRyeSwgbmF0aXZlVHJhbnNpdGlvbik7XG4gICAgbmF0aXZlVHJhbnNpdGlvbi5hZGRMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgcmV0dXJuIGxpc3RlbmVyO1xufVxuZnVuY3Rpb24gdHJhbnNpdGlvbk9yQW5pbWF0aW9uQ29tcGxldGVkKGVudHJ5KSB7XG4gICAgdmFyIGZyYW1lSWQgPSBlbnRyeS5mcmFtZUlkO1xuICAgIHZhciBlbnRyaWVzID0gZXhwb3J0cy53YWl0aW5nUXVldWUuZ2V0KGZyYW1lSWQpO1xuICAgIGlmICghZW50cmllcykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGVudHJpZXMuZGVsZXRlKGVudHJ5KTtcbiAgICBpZiAoZW50cmllcy5zaXplID09PSAwKSB7XG4gICAgICAgIHZhciBmcmFtZV8xID0gZW50cnkucmVzb2x2ZWRQYWdlLmZyYW1lO1xuICAgICAgICB2YXIgcHJldmlvdXNDb21wbGV0ZWRBbmltYXRpb25FbnRyeSA9IGV4cG9ydHMuY29tcGxldGVkRW50cmllcy5nZXQoZnJhbWVJZCk7XG4gICAgICAgIGV4cG9ydHMuY29tcGxldGVkRW50cmllcy5kZWxldGUoZnJhbWVJZCk7XG4gICAgICAgIGV4cG9ydHMud2FpdGluZ1F1ZXVlLmRlbGV0ZShmcmFtZUlkKTtcbiAgICAgICAgdmFyIG5hdmlnYXRpb25Db250ZXh0XzEgPSBmcmFtZV8xLl9leGVjdXRpbmdDb250ZXh0IHx8IHsgbmF2aWdhdGlvblR5cGU6IGZyYW1lX2NvbW1vbl8xLk5hdmlnYXRpb25UeXBlLmJhY2sgfTtcbiAgICAgICAgdmFyIGN1cnJlbnRfMSA9IGZyYW1lXzEuaXNDdXJyZW50KGVudHJ5KSA/IHByZXZpb3VzQ29tcGxldGVkQW5pbWF0aW9uRW50cnkgOiBlbnRyeTtcbiAgICAgICAgY3VycmVudF8xID0gY3VycmVudF8xIHx8IGVudHJ5O1xuICAgICAgICBpZiAoY3VycmVudF8xKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZyYW1lXzEuc2V0Q3VycmVudChjdXJyZW50XzEsIG5hdmlnYXRpb25Db250ZXh0XzEubmF2aWdhdGlvblR5cGUpOyB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZXhwb3J0cy5jb21wbGV0ZWRFbnRyaWVzLnNldChmcmFtZUlkLCBlbnRyeSk7XG4gICAgfVxufVxuZnVuY3Rpb24gdG9TaG9ydFN0cmluZyhuYXRpdmVUcmFuc2l0aW9uKSB7XG4gICAgcmV0dXJuIG5hdGl2ZVRyYW5zaXRpb24uZ2V0Q2xhc3MoKS5nZXRTaW1wbGVOYW1lKCkgKyBcIkBcIiArIG5hdGl2ZVRyYW5zaXRpb24uaGFzaENvZGUoKS50b1N0cmluZygxNik7XG59XG5mdW5jdGlvbiBwcmludFRyYW5zaXRpb25zKGVudHJ5KSB7XG4gICAgaWYgKGVudHJ5ICYmIHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IGVudHJ5LmZyYWdtZW50VGFnICsgXCIgVHJhbnNpdGlvbnM6XCI7XG4gICAgICAgIGlmIChlbnRyeS50cmFuc2l0aW9uTmFtZSkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwidHJhbnNpdGlvbk5hbWU9XCIgKyBlbnRyeS50cmFuc2l0aW9uTmFtZSArIFwiLCBcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZW50cnkudHJhbnNpdGlvbikge1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwiZW50ZXJBbmltYXRvcj1cIiArIGVudHJ5LmVudGVyQW5pbWF0b3IgKyBcIiwgXCI7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJleGl0QW5pbWF0b3I9XCIgKyBlbnRyeS5leGl0QW5pbWF0b3IgKyBcIiwgXCI7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJwb3BFbnRlckFuaW1hdG9yPVwiICsgZW50cnkucG9wRW50ZXJBbmltYXRvciArIFwiLCBcIjtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcInBvcEV4aXRBbmltYXRvcj1cIiArIGVudHJ5LnBvcEV4aXRBbmltYXRvciArIFwiLCBcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2RrVmVyc2lvbigpID49IDIxKSB7XG4gICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSBlbnRyeS5mcmFnbWVudDtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcIlwiICsgKGZyYWdtZW50LmdldEVudGVyVHJhbnNpdGlvbigpID8gXCIgZW50ZXI9XCIgKyB0b1Nob3J0U3RyaW5nKGZyYWdtZW50LmdldEVudGVyVHJhbnNpdGlvbigpKSA6IFwiXCIpO1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwiXCIgKyAoZnJhZ21lbnQuZ2V0RXhpdFRyYW5zaXRpb24oKSA/IFwiIGV4aXQ9XCIgKyB0b1Nob3J0U3RyaW5nKGZyYWdtZW50LmdldEV4aXRUcmFuc2l0aW9uKCkpIDogXCJcIik7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJcIiArIChmcmFnbWVudC5nZXRSZWVudGVyVHJhbnNpdGlvbigpID8gXCIgcG9wRW50ZXI9XCIgKyB0b1Nob3J0U3RyaW5nKGZyYWdtZW50LmdldFJlZW50ZXJUcmFuc2l0aW9uKCkpIDogXCJcIik7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJcIiArIChmcmFnbWVudC5nZXRSZXR1cm5UcmFuc2l0aW9uKCkgPyBcIiBwb3BFeGl0PVwiICsgdG9TaG9ydFN0cmluZyhmcmFnbWVudC5nZXRSZXR1cm5UcmFuc2l0aW9uKCkpIDogXCJcIik7XG4gICAgICAgIH1cbiAgICAgICAgdHJhY2VfMS53cml0ZShyZXN1bHQsIHRyYWNlXzEuY2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICB9XG59XG5mdW5jdGlvbiBqYXZhT2JqZWN0QXJyYXkoKSB7XG4gICAgdmFyIHBhcmFtcyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHBhcmFtc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICB2YXIgbmF0aXZlQXJyYXkgPSBBcnJheS5jcmVhdGUoamF2YS5sYW5nLk9iamVjdCwgcGFyYW1zLmxlbmd0aCk7XG4gICAgcGFyYW1zLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBpKSB7IHJldHVybiBuYXRpdmVBcnJheVtpXSA9IHZhbHVlOyB9KTtcbiAgICByZXR1cm4gbmF0aXZlQXJyYXk7XG59XG5mdW5jdGlvbiBjcmVhdGVEdW1teVplcm9EdXJhdGlvbkFuaW1hdG9yKCkge1xuICAgIHZhciBhbmltYXRvciA9IGFuZHJvaWQuYW5pbWF0aW9uLlZhbHVlQW5pbWF0b3Iub2ZPYmplY3QoaW50RXZhbHVhdG9yKCksIGphdmFPYmplY3RBcnJheShqYXZhLmxhbmcuSW50ZWdlci52YWx1ZU9mKDApLCBqYXZhLmxhbmcuSW50ZWdlci52YWx1ZU9mKDEpKSk7XG4gICAgYW5pbWF0b3Iuc2V0RHVyYXRpb24oMSk7XG4gICAgcmV0dXJuIGFuaW1hdG9yO1xufVxudmFyIE5vVHJhbnNpdGlvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE5vVHJhbnNpdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBOb1RyYW5zaXRpb24oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgTm9UcmFuc2l0aW9uLnByb3RvdHlwZS5jcmVhdGVBbmRyb2lkQW5pbWF0b3IgPSBmdW5jdGlvbiAodHJhbnNpdGlvblR5cGUpIHtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZUR1bW15WmVyb0R1cmF0aW9uQW5pbWF0b3IoKTtcbiAgICB9O1xuICAgIHJldHVybiBOb1RyYW5zaXRpb247XG59KHRyYW5zaXRpb25fMS5UcmFuc2l0aW9uKSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mcmFnbWVudC50cmFuc2l0aW9ucy5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld19jb21tb25fMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXcvdmlldy1jb21tb25cIik7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBidWlsZGVyXzEgPSByZXF1aXJlKFwiLi4vYnVpbGRlclwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG52YXIgZnJhbWVfc3RhY2tfMSA9IHJlcXVpcmUoXCIuL2ZyYW1lLXN0YWNrXCIpO1xudmFyIG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xID0gcmVxdWlyZShcIi4uL2J1aWxkZXIvbW9kdWxlLW5hbWUtc2FuaXRpemVyXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgTmF2aWdhdGlvblR5cGU7XG4oZnVuY3Rpb24gKE5hdmlnYXRpb25UeXBlKSB7XG4gICAgTmF2aWdhdGlvblR5cGVbTmF2aWdhdGlvblR5cGVbXCJiYWNrXCJdID0gMF0gPSBcImJhY2tcIjtcbiAgICBOYXZpZ2F0aW9uVHlwZVtOYXZpZ2F0aW9uVHlwZVtcImZvcndhcmRcIl0gPSAxXSA9IFwiZm9yd2FyZFwiO1xuICAgIE5hdmlnYXRpb25UeXBlW05hdmlnYXRpb25UeXBlW1wicmVwbGFjZVwiXSA9IDJdID0gXCJyZXBsYWNlXCI7XG59KShOYXZpZ2F0aW9uVHlwZSA9IGV4cG9ydHMuTmF2aWdhdGlvblR5cGUgfHwgKGV4cG9ydHMuTmF2aWdhdGlvblR5cGUgPSB7fSkpO1xuZnVuY3Rpb24gYnVpbGRFbnRyeUZyb21BcmdzKGFyZykge1xuICAgIHZhciBlbnRyeTtcbiAgICBpZiAodHlwZW9mIGFyZyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBlbnRyeSA9IHtcbiAgICAgICAgICAgIG1vZHVsZU5hbWU6IGFyZ1xuICAgICAgICB9O1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgYXJnID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgZW50cnkgPSB7XG4gICAgICAgICAgICBjcmVhdGU6IGFyZ1xuICAgICAgICB9O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZW50cnkgPSBhcmc7XG4gICAgfVxuICAgIHJldHVybiBlbnRyeTtcbn1cbnZhciBGcmFtZUJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGcmFtZUJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRnJhbWVCYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2JhY2tTdGFjayA9IG5ldyBBcnJheSgpO1xuICAgICAgICBfdGhpcy5fbmF2aWdhdGlvblF1ZXVlID0gbmV3IEFycmF5KCk7XG4gICAgICAgIF90aGlzLl9pc0luRnJhbWVTdGFjayA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEZyYW1lQmFzZV8xID0gRnJhbWVCYXNlO1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRnJhbWUgc2hvdWxkIG5vdCBoYXZlIGEgdmlldy4gVXNlICdkZWZhdWx0UGFnZScgcHJvcGVydHkgaW5zdGVhZC5cIik7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuX3Byb2Nlc3NOZXh0TmF2aWdhdGlvbkVudHJ5KCk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLmNhbkdvQmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGJhY2tzdGFjayA9IHRoaXMuX2JhY2tTdGFjay5sZW5ndGg7XG4gICAgICAgIHZhciBwcmV2aW91c0ZvcndhcmROb3RJbkJhY2tzdGFjayA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uUXVldWUuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgdmFyIGVudHJ5ID0gaXRlbS5lbnRyeTtcbiAgICAgICAgICAgIHZhciBpc0JhY2tOYXZpZ2F0aW9uID0gaXRlbS5uYXZpZ2F0aW9uVHlwZSA9PT0gTmF2aWdhdGlvblR5cGUuYmFjaztcbiAgICAgICAgICAgIGlmIChpc0JhY2tOYXZpZ2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgcHJldmlvdXNGb3J3YXJkTm90SW5CYWNrc3RhY2sgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIGJhY2tzdGFjay0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhY2tzdGFja0luZGV4ID0gX3RoaXMuX2JhY2tTdGFjay5pbmRleE9mKGVudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJhY2tzdGFja0luZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFja3N0YWNrID0gYmFja3N0YWNrSW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBiYWNrc3RhY2stLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGVudHJ5LmVudHJ5LmNsZWFySGlzdG9yeSkge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzRm9yd2FyZE5vdEluQmFja3N0YWNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYmFja3N0YWNrID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGJhY2tzdGFjaysrO1xuICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c0ZvcndhcmROb3RJbkJhY2tzdGFjaykge1xuICAgICAgICAgICAgICAgICAgICBiYWNrc3RhY2stLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJldmlvdXNGb3J3YXJkTm90SW5CYWNrc3RhY2sgPSBlbnRyeS5lbnRyeS5iYWNrc3RhY2tWaXNpYmxlID09PSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0aGlzLl9uYXZpZ2F0aW9uUXVldWUubGVuZ3RoID4gMCAmJiAhdGhpcy5fY3VycmVudEVudHJ5KSB7XG4gICAgICAgICAgICBiYWNrc3RhY2stLTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYmFja3N0YWNrID4gMDtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuZ29CYWNrID0gZnVuY3Rpb24gKGJhY2tzdGFja0VudHJ5KSB7XG4gICAgICAgIGlmICh2aWV3XzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiR08gQkFDS1wiLCB2aWV3XzEudHJhY2VDYXRlZ29yaWVzLk5hdmlnYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5jYW5Hb0JhY2soKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiYWNrc3RhY2tFbnRyeSkge1xuICAgICAgICAgICAgdmFyIGluZGV4XzEgPSB0aGlzLl9iYWNrU3RhY2suaW5kZXhPZihiYWNrc3RhY2tFbnRyeSk7XG4gICAgICAgICAgICBpZiAoaW5kZXhfMSA8IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdmlnYXRpb25Db250ZXh0ID0ge1xuICAgICAgICAgICAgZW50cnk6IGJhY2tzdGFja0VudHJ5LFxuICAgICAgICAgICAgaXNCYWNrTmF2aWdhdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgIG5hdmlnYXRpb25UeXBlOiBOYXZpZ2F0aW9uVHlwZS5iYWNrXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX25hdmlnYXRpb25RdWV1ZS5wdXNoKG5hdmlnYXRpb25Db250ZXh0KTtcbiAgICAgICAgdGhpcy5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkoKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3JlbW92ZUVudHJ5ID0gZnVuY3Rpb24gKHJlbW92ZWQpIHtcbiAgICAgICAgdmFyIHBhZ2UgPSByZW1vdmVkLnJlc29sdmVkUGFnZTtcbiAgICAgICAgdmFyIGZyYW1lID0gcGFnZS5mcmFtZTtcbiAgICAgICAgcGFnZS5fZnJhbWUgPSBudWxsO1xuICAgICAgICBpZiAoZnJhbWUpIHtcbiAgICAgICAgICAgIGZyYW1lLl9yZW1vdmVWaWV3KHBhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcGFnZS5fdGVhckRvd25VSSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICByZW1vdmVkLnJlc29sdmVkUGFnZSA9IG51bGw7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLm5hdmlnYXRlID0gZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgIGlmICh2aWV3XzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiTkFWSUdBVEVcIiwgdmlld18xLnRyYWNlQ2F0ZWdvcmllcy5OYXZpZ2F0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZW50cnkgPSBidWlsZEVudHJ5RnJvbUFyZ3MocGFyYW0pO1xuICAgICAgICB2YXIgcGFnZSA9IGJ1aWxkZXJfMS5jcmVhdGVWaWV3RnJvbUVudHJ5KGVudHJ5KTtcbiAgICAgICAgdGhpcy5fcHVzaEluRnJhbWVTdGFjaygpO1xuICAgICAgICB2YXIgYmFja3N0YWNrRW50cnkgPSB7XG4gICAgICAgICAgICBlbnRyeTogZW50cnksXG4gICAgICAgICAgICByZXNvbHZlZFBhZ2U6IHBhZ2UsXG4gICAgICAgICAgICBuYXZEZXB0aDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgZnJhZ21lbnRUYWc6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgICB2YXIgbmF2aWdhdGlvbkNvbnRleHQgPSB7XG4gICAgICAgICAgICBlbnRyeTogYmFja3N0YWNrRW50cnksXG4gICAgICAgICAgICBpc0JhY2tOYXZpZ2F0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgIG5hdmlnYXRpb25UeXBlOiBOYXZpZ2F0aW9uVHlwZS5mb3J3YXJkXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX25hdmlnYXRpb25RdWV1ZS5wdXNoKG5hdmlnYXRpb25Db250ZXh0KTtcbiAgICAgICAgdGhpcy5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkoKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuaXNDdXJyZW50ID0gZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50RW50cnkgPT09IGVudHJ5O1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5zZXRDdXJyZW50ID0gZnVuY3Rpb24gKGVudHJ5LCBuYXZpZ2F0aW9uVHlwZSkge1xuICAgICAgICB2YXIgbmV3UGFnZSA9IGVudHJ5LnJlc29sdmVkUGFnZTtcbiAgICAgICAgaWYgKCFuZXdQYWdlLmZyYW1lKSB7XG4gICAgICAgICAgICB0aGlzLl9hZGRWaWV3KG5ld1BhZ2UpO1xuICAgICAgICAgICAgbmV3UGFnZS5fZnJhbWUgPSB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2N1cnJlbnRFbnRyeSA9IGVudHJ5O1xuICAgICAgICB2YXIgaXNCYWNrID0gbmF2aWdhdGlvblR5cGUgPT09IE5hdmlnYXRpb25UeXBlLmJhY2s7XG4gICAgICAgIGlmIChpc0JhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX3B1c2hJbkZyYW1lU3RhY2soKTtcbiAgICAgICAgfVxuICAgICAgICBuZXdQYWdlLm9uTmF2aWdhdGVkVG8oaXNCYWNrKTtcbiAgICAgICAgdGhpcy5fZXhlY3V0aW5nQ29udGV4dCA9IG51bGw7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl91cGRhdGVCYWNrc3RhY2sgPSBmdW5jdGlvbiAoZW50cnksIG5hdmlnYXRpb25UeXBlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBpc0JhY2sgPSBuYXZpZ2F0aW9uVHlwZSA9PT0gTmF2aWdhdGlvblR5cGUuYmFjaztcbiAgICAgICAgdmFyIGlzUmVwbGFjZSA9IG5hdmlnYXRpb25UeXBlID09PSBOYXZpZ2F0aW9uVHlwZS5yZXBsYWNlO1xuICAgICAgICB0aGlzLnJhaXNlQ3VycmVudFBhZ2VOYXZpZ2F0ZWRFdmVudHMoaXNCYWNrKTtcbiAgICAgICAgdmFyIGN1cnJlbnQgPSB0aGlzLl9jdXJyZW50RW50cnk7XG4gICAgICAgIGlmIChpc0JhY2spIHtcbiAgICAgICAgICAgIHZhciBpbmRleF8yID0gdGhpcy5fYmFja1N0YWNrLmluZGV4T2YoZW50cnkpO1xuICAgICAgICAgICAgdGhpcy5fYmFja1N0YWNrLnNwbGljZShpbmRleF8yICsgMSkuZm9yRWFjaChmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMuX3JlbW92ZUVudHJ5KGUpOyB9KTtcbiAgICAgICAgICAgIHRoaXMuX2JhY2tTdGFjay5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghaXNSZXBsYWNlKSB7XG4gICAgICAgICAgICBpZiAoZW50cnkuZW50cnkuY2xlYXJIaXN0b3J5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmFja1N0YWNrLmZvckVhY2goZnVuY3Rpb24gKGUpIHsgcmV0dXJuIF90aGlzLl9yZW1vdmVFbnRyeShlKTsgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmFja1N0YWNrLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChGcmFtZUJhc2VfMS5faXNFbnRyeUJhY2tzdGFja1Zpc2libGUoY3VycmVudCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9iYWNrU3RhY2sucHVzaChjdXJyZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY3VycmVudCAmJiB0aGlzLl9iYWNrU3RhY2suaW5kZXhPZihjdXJyZW50KSA8IDApIHtcbiAgICAgICAgICAgIHRoaXMuX3JlbW92ZUVudHJ5KGN1cnJlbnQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLmlzTmVzdGVkV2l0aGluID0gZnVuY3Rpb24gKHBhcmVudEZyYW1lQ2FuZGlkYXRlKSB7XG4gICAgICAgIHZhciBmcmFtZUFuY2VzdG9yID0gdGhpcztcbiAgICAgICAgd2hpbGUgKGZyYW1lQW5jZXN0b3IpIHtcbiAgICAgICAgICAgIGZyYW1lQW5jZXN0b3IgPSB2aWV3X2NvbW1vbl8xLmdldEFuY2VzdG9yKGZyYW1lQW5jZXN0b3IsIEZyYW1lQmFzZV8xKTtcbiAgICAgICAgICAgIGlmIChmcmFtZUFuY2VzdG9yID09PSBwYXJlbnRGcmFtZUNhbmRpZGF0ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUucmFpc2VDdXJyZW50UGFnZU5hdmlnYXRlZEV2ZW50cyA9IGZ1bmN0aW9uIChpc0JhY2spIHtcbiAgICAgICAgdmFyIHBhZ2UgPSB0aGlzLmN1cnJlbnRQYWdlO1xuICAgICAgICBpZiAocGFnZSkge1xuICAgICAgICAgICAgaWYgKHBhZ2UuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICBwYWdlLmNhbGxVbmxvYWRlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFnZS5vbk5hdmlnYXRlZEZyb20oaXNCYWNrKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fcHJvY2Vzc05hdmlnYXRpb25RdWV1ZSA9IGZ1bmN0aW9uIChwYWdlKSB7XG4gICAgICAgIGlmICh0aGlzLl9uYXZpZ2F0aW9uUXVldWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy5fbmF2aWdhdGlvblF1ZXVlWzBdLmVudHJ5O1xuICAgICAgICB2YXIgY3VycmVudE5hdmlnYXRpb25QYWdlID0gZW50cnkucmVzb2x2ZWRQYWdlO1xuICAgICAgICBpZiAocGFnZSAhPT0gY3VycmVudE5hdmlnYXRpb25QYWdlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbmF2aWdhdGlvblF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgIHRoaXMuX3Byb2Nlc3NOZXh0TmF2aWdhdGlvbkVudHJ5KCk7XG4gICAgICAgIHRoaXMuX3VwZGF0ZUFjdGlvbkJhcigpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fZmluZEVudHJ5Rm9yVGFnID0gZnVuY3Rpb24gKGZyYWdtZW50VGFnKSB7XG4gICAgICAgIHZhciBlbnRyeTtcbiAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRFbnRyeSAmJiB0aGlzLl9jdXJyZW50RW50cnkuZnJhZ21lbnRUYWcgPT09IGZyYWdtZW50VGFnKSB7XG4gICAgICAgICAgICBlbnRyeSA9IHRoaXMuX2N1cnJlbnRFbnRyeTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGVudHJ5ID0gdGhpcy5fYmFja1N0YWNrLmZpbmQoZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiB2YWx1ZS5mcmFnbWVudFRhZyA9PT0gZnJhZ21lbnRUYWc7IH0pO1xuICAgICAgICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAgICAgICAgIHZhciBuYXZpZ2F0aW9uSXRlbSA9IHRoaXMuX25hdmlnYXRpb25RdWV1ZS5maW5kKGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdmFsdWUuZW50cnkuZnJhZ21lbnRUYWcgPT09IGZyYWdtZW50VGFnOyB9KTtcbiAgICAgICAgICAgICAgICBlbnRyeSA9IG5hdmlnYXRpb25JdGVtID8gbmF2aWdhdGlvbkl0ZW0uZW50cnkgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVudHJ5O1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5uYXZpZ2F0aW9uUXVldWVJc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbmF2aWdhdGlvblF1ZXVlLmxlbmd0aCA9PT0gMDtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5faXNFbnRyeUJhY2tzdGFja1Zpc2libGUgPSBmdW5jdGlvbiAoZW50cnkpIHtcbiAgICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrc3RhY2tWaXNpYmxlVmFsdWUgPSBlbnRyeS5lbnRyeS5iYWNrc3RhY2tWaXNpYmxlO1xuICAgICAgICB2YXIgYmFja3N0YWNrSGlkZGVuID0gYmFja3N0YWNrVmlzaWJsZVZhbHVlICE9PSB1bmRlZmluZWQgJiYgIWJhY2tzdGFja1Zpc2libGVWYWx1ZTtcbiAgICAgICAgcmV0dXJuICFiYWNrc3RhY2tIaWRkZW47XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl91cGRhdGVBY3Rpb25CYXIgPSBmdW5jdGlvbiAocGFnZSwgZGlzYWJsZU5hdkJhckFuaW1hdGlvbikge1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0xvYWRlZCB8fCB0aGlzLl9leGVjdXRpbmdDb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX25hdmlnYXRpb25RdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgbmF2aWdhdGlvbkNvbnRleHQgPSB0aGlzLl9uYXZpZ2F0aW9uUXVldWVbMF07XG4gICAgICAgICAgICB2YXIgaXNCYWNrTmF2aWdhdGlvbiA9IG5hdmlnYXRpb25Db250ZXh0Lm5hdmlnYXRpb25UeXBlID09PSBOYXZpZ2F0aW9uVHlwZS5iYWNrO1xuICAgICAgICAgICAgaWYgKGlzQmFja05hdmlnYXRpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBlcmZvcm1Hb0JhY2sobmF2aWdhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wZXJmb3JtTmF2aWdhdGlvbihuYXZpZ2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUucGVyZm9ybU5hdmlnYXRpb24gPSBmdW5jdGlvbiAobmF2aWdhdGlvbkNvbnRleHQpIHtcbiAgICAgICAgdGhpcy5fZXhlY3V0aW5nQ29udGV4dCA9IG5hdmlnYXRpb25Db250ZXh0O1xuICAgICAgICB2YXIgYmFja3N0YWNrRW50cnkgPSBuYXZpZ2F0aW9uQ29udGV4dC5lbnRyeTtcbiAgICAgICAgdmFyIGlzQmFja05hdmlnYXRpb24gPSBuYXZpZ2F0aW9uQ29udGV4dC5uYXZpZ2F0aW9uVHlwZSA9PT0gTmF2aWdhdGlvblR5cGUuYmFjaztcbiAgICAgICAgdGhpcy5fb25OYXZpZ2F0aW5nVG8oYmFja3N0YWNrRW50cnksIGlzQmFja05hdmlnYXRpb24pO1xuICAgICAgICB0aGlzLl9uYXZpZ2F0ZUNvcmUoYmFja3N0YWNrRW50cnkpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5wZXJmb3JtR29CYWNrID0gZnVuY3Rpb24gKG5hdmlnYXRpb25Db250ZXh0KSB7XG4gICAgICAgIHZhciBiYWNrc3RhY2tFbnRyeSA9IG5hdmlnYXRpb25Db250ZXh0LmVudHJ5O1xuICAgICAgICB2YXIgYmFja3N0YWNrID0gdGhpcy5fYmFja1N0YWNrO1xuICAgICAgICBpZiAoIWJhY2tzdGFja0VudHJ5KSB7XG4gICAgICAgICAgICBiYWNrc3RhY2tFbnRyeSA9IGJhY2tzdGFja1tiYWNrc3RhY2subGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBuYXZpZ2F0aW9uQ29udGV4dC5lbnRyeSA9IGJhY2tzdGFja0VudHJ5O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2V4ZWN1dGluZ0NvbnRleHQgPSBuYXZpZ2F0aW9uQ29udGV4dDtcbiAgICAgICAgdGhpcy5fb25OYXZpZ2F0aW5nVG8oYmFja3N0YWNrRW50cnksIHRydWUpO1xuICAgICAgICB0aGlzLl9nb0JhY2tDb3JlKGJhY2tzdGFja0VudHJ5KTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2dvQmFja0NvcmUgPSBmdW5jdGlvbiAoYmFja3N0YWNrRW50cnkpIHtcbiAgICAgICAgaWYgKHZpZXdfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdmlld18xLnRyYWNlV3JpdGUoXCJHTyBCQUNLIENPUkUoXCIgKyB0aGlzLl9iYWNrc3RhY2tFbnRyeVRyYWNlKGJhY2tzdGFja0VudHJ5KSArIFwiKTsgY3VycmVudFBhZ2U6IFwiICsgdGhpcy5jdXJyZW50UGFnZSwgdmlld18xLnRyYWNlQ2F0ZWdvcmllcy5OYXZpZ2F0aW9uKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fbmF2aWdhdGVDb3JlID0gZnVuY3Rpb24gKGJhY2tzdGFja0VudHJ5KSB7XG4gICAgICAgIGlmICh2aWV3XzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiTkFWSUdBVEUgQ09SRShcIiArIHRoaXMuX2JhY2tzdGFja0VudHJ5VHJhY2UoYmFja3N0YWNrRW50cnkpICsgXCIpOyBjdXJyZW50UGFnZTogXCIgKyB0aGlzLmN1cnJlbnRQYWdlLCB2aWV3XzEudHJhY2VDYXRlZ29yaWVzLk5hdmlnYXRpb24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9vbk5hdmlnYXRpbmdUbyA9IGZ1bmN0aW9uIChiYWNrc3RhY2tFbnRyeSwgaXNCYWNrKSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlLm9uTmF2aWdhdGluZ0Zyb20oaXNCYWNrKTtcbiAgICAgICAgfVxuICAgICAgICBiYWNrc3RhY2tFbnRyeS5yZXNvbHZlZFBhZ2Uub25OYXZpZ2F0aW5nVG8oYmFja3N0YWNrRW50cnkuZW50cnkuY29udGV4dCwgaXNCYWNrLCBiYWNrc3RhY2tFbnRyeS5lbnRyeS5iaW5kaW5nQ29udGV4dCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJhbmltYXRlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FuaW1hdGVkO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fYW5pbWF0ZWQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lQmFzZS5wcm90b3R5cGUsIFwidHJhbnNpdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zaXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZUJhc2UucHJvdG90eXBlLCBcImJhY2tTdGFja1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tTdGFjay5zbGljZSgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJjdXJyZW50UGFnZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRFbnRyeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50RW50cnkucmVzb2x2ZWRQYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZUJhc2UucHJvdG90eXBlLCBcImN1cnJlbnRFbnRyeVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRFbnRyeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50RW50cnkuZW50cnk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fcHVzaEluRnJhbWVTdGFja1JlY3Vyc2l2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fcHVzaEluRnJhbWVTdGFjaygpO1xuICAgICAgICB2YXIgZnJhbWVzVG9QdXNoID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgZnJhbWVTdGFja18xID0gZnJhbWVfc3RhY2tfMS5mcmFtZVN0YWNrOyBfaSA8IGZyYW1lU3RhY2tfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBmcmFtZSA9IGZyYW1lU3RhY2tfMVtfaV07XG4gICAgICAgICAgICBpZiAoZnJhbWUuaXNOZXN0ZWRXaXRoaW4odGhpcykpIHtcbiAgICAgICAgICAgICAgICBmcmFtZXNUb1B1c2gucHVzaChmcmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBmcmFtZXNUb1B1c2hfMSA9IGZyYW1lc1RvUHVzaDsgX2EgPCBmcmFtZXNUb1B1c2hfMS5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgICAgIHZhciBmcmFtZSA9IGZyYW1lc1RvUHVzaF8xW19hXTtcbiAgICAgICAgICAgIGZyYW1lLl9wdXNoSW5GcmFtZVN0YWNrKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3B1c2hJbkZyYW1lU3RhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZyYW1lX3N0YWNrXzEuX3B1c2hJbkZyYW1lU3RhY2sodGhpcyk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9wb3BGcm9tRnJhbWVTdGFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnJhbWVfc3RhY2tfMS5fcG9wRnJvbUZyYW1lU3RhY2sodGhpcyk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9yZW1vdmVGcm9tRnJhbWVTdGFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnJhbWVfc3RhY2tfMS5fcmVtb3ZlRnJvbUZyYW1lU3RhY2sodGhpcyk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9kaWFsb2dDbG9zZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3JlbW92ZUZyb21GcmFtZVN0YWNrKCk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9vblJvb3RWaWV3UmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX29uUm9vdFZpZXdSZXNldC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9yZW1vdmVGcm9tRnJhbWVTdGFjaygpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lQmFzZS5wcm90b3R5cGUsIFwiX2NoaWxkcmVuQ291bnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBwYWdlID0gdGhpcy5jdXJyZW50UGFnZTtcbiAgICAgICAgaWYgKHBhZ2UpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHBhZ2UpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9nZXRJc0FuaW1hdGVkTmF2aWdhdGlvbiA9IGZ1bmN0aW9uIChlbnRyeSkge1xuICAgICAgICBpZiAoZW50cnkgJiYgZW50cnkuYW5pbWF0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGVudHJ5LmFuaW1hdGVkO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmFuaW1hdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFuaW1hdGVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBGcmFtZUJhc2VfMS5kZWZhdWx0QW5pbWF0ZWROYXZpZ2F0aW9uO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fZ2V0TmF2aWdhdGlvblRyYW5zaXRpb24gPSBmdW5jdGlvbiAoZW50cnkpIHtcbiAgICAgICAgaWYgKGVudHJ5KSB7XG4gICAgICAgICAgICBpZiAodmlld18xLmlzSU9TICYmIGVudHJ5LnRyYW5zaXRpb25pT1MgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbnRyeS50cmFuc2l0aW9uaU9TO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZpZXdfMS5pc0FuZHJvaWQgJiYgZW50cnkudHJhbnNpdGlvbkFuZHJvaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbnRyeS50cmFuc2l0aW9uQW5kcm9pZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbnRyeS50cmFuc2l0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZW50cnkudHJhbnNpdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy50cmFuc2l0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRyYW5zaXRpb247XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEZyYW1lQmFzZV8xLmRlZmF1bHRUcmFuc2l0aW9uO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lQmFzZS5wcm90b3R5cGUsIFwibmF2aWdhdGlvbkJhckhlaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2dldE5hdkJhclZpc2libGUgPSBmdW5jdGlvbiAocGFnZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgY2hpbGQuX2lzQWRkZWRUb05hdGl2ZVZpc3VhbFRyZWUgPSBmYWxzZTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3ByaW50RnJhbWVCYWNrU3RhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmJhY2tTdGFjay5sZW5ndGg7XG4gICAgICAgIHZhciBpID0gbGVuZ3RoIC0gMTtcbiAgICAgICAgY29uc29sZS5sb2coXCJGcmFtZSBCYWNrIFN0YWNrOiBcIik7XG4gICAgICAgIHdoaWxlIChpID49IDApIHtcbiAgICAgICAgICAgIHZhciBiYWNrc3RhY2tFbnRyeSA9IHRoaXMuYmFja1N0YWNrW2ktLV07XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlxcdFwiICsgYmFja3N0YWNrRW50cnkucmVzb2x2ZWRQYWdlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fYmFja3N0YWNrRW50cnlUcmFjZSA9IGZ1bmN0aW9uIChiKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBcIlwiICsgYi5yZXNvbHZlZFBhZ2U7XG4gICAgICAgIHZhciBiYWNrc3RhY2tWaXNpYmxlID0gRnJhbWVCYXNlXzEuX2lzRW50cnlCYWNrc3RhY2tWaXNpYmxlKGIpO1xuICAgICAgICBpZiAoIWJhY2tzdGFja1Zpc2libGUpIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcIiB8IElOVklTSUJMRVwiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiLmVudHJ5LmNsZWFySGlzdG9yeSkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwiIHwgQ0xFQVIgSElTVE9SWVwiO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhbmltYXRlZCA9IHRoaXMuX2dldElzQW5pbWF0ZWROYXZpZ2F0aW9uKGIuZW50cnkpO1xuICAgICAgICBpZiAoIWFuaW1hdGVkKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCIgfCBOT1QgQU5JTUFURURcIjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdCA9IHRoaXMuX2dldE5hdmlnYXRpb25UcmFuc2l0aW9uKGIuZW50cnkpO1xuICAgICAgICBpZiAodCkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwiIHwgVHJhbnNpdGlvbltcIiArIEpTT04uc3RyaW5naWZ5KHQpICsgXCJdXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX29uTGl2ZXN5bmMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICBpZiAoX3N1cGVyLnByb3RvdHlwZS5fb25MaXZlc3luYy5jYWxsKHRoaXMsIGNvbnRleHQpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxlZ2FjeUxpdmVzeW5jKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5faGFuZGxlTGl2ZXN5bmMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICBpZiAoX3N1cGVyLnByb3RvdHlwZS5faGFuZGxlTGl2ZXN5bmMuY2FsbCh0aGlzLCBjb250ZXh0KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgJiZcbiAgICAgICAgICAgIHZpZXdfY29tbW9uXzEudmlld01hdGNoZXNNb2R1bGVDb250ZXh0KHRoaXMuY3VycmVudFBhZ2UsIGNvbnRleHQsIFtcIm1hcmt1cFwiLCBcInNjcmlwdFwiXSkpIHtcbiAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiQ2hhbmdlIEhhbmRsZWQ6IFJlcGxhY2luZyBwYWdlIFwiICsgY29udGV4dC5wYXRoLCB2aWV3XzEudHJhY2VDYXRlZ29yaWVzLkxpdmVzeW5jKTtcbiAgICAgICAgICAgIHRoaXMucmVwbGFjZVBhZ2UoY29udGV4dC5wYXRoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUubGVnYWN5TGl2ZXN5bmMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh2aWV3XzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKHRoaXMgKyBcIi5fb25MaXZlc3luYygpXCIsIHZpZXdfMS50cmFjZUNhdGVnb3JpZXMuTGl2ZXN5bmMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5fY3VycmVudEVudHJ5IHx8ICF0aGlzLl9jdXJyZW50RW50cnkuZW50cnkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY3VycmVudEVudHJ5ID0gdGhpcy5fY3VycmVudEVudHJ5LmVudHJ5O1xuICAgICAgICB2YXIgbmV3RW50cnkgPSB7XG4gICAgICAgICAgICBhbmltYXRlZDogZmFsc2UsXG4gICAgICAgICAgICBjbGVhckhpc3Rvcnk6IHRydWUsXG4gICAgICAgICAgICBjb250ZXh0OiBjdXJyZW50RW50cnkuY29udGV4dCxcbiAgICAgICAgICAgIGNyZWF0ZTogY3VycmVudEVudHJ5LmNyZWF0ZSxcbiAgICAgICAgICAgIG1vZHVsZU5hbWU6IGN1cnJlbnRFbnRyeS5tb2R1bGVOYW1lLFxuICAgICAgICAgICAgYmFja3N0YWNrVmlzaWJsZTogY3VycmVudEVudHJ5LmJhY2tzdGFja1Zpc2libGVcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG5ld0VudHJ5LmNyZWF0ZSkge1xuICAgICAgICAgICAgdmFyIHBhZ2UgPSBuZXdFbnRyeS5jcmVhdGUoKTtcbiAgICAgICAgICAgIGlmIChwYWdlID09PSB0aGlzLmN1cnJlbnRQYWdlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF2aWdhdGUobmV3RW50cnkpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUucmVwbGFjZVBhZ2UgPSBmdW5jdGlvbiAocGFnZVBhdGgpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRCYWNrc3RhY2tFbnRyeSA9IHRoaXMuX2N1cnJlbnRFbnRyeTtcbiAgICAgICAgdmFyIGNvbnRleHRNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfc2FuaXRpemVyXzEuc2FuaXRpemVNb2R1bGVOYW1lKHBhZ2VQYXRoKTtcbiAgICAgICAgdmFyIG5ld1BhZ2UgPSBidWlsZGVyXzEuY3JlYXRlVmlld0Zyb21FbnRyeSh7IG1vZHVsZU5hbWU6IGNvbnRleHRNb2R1bGVOYW1lIH0pO1xuICAgICAgICB2YXIgbmV3QmFja3N0YWNrRW50cnkgPSB7XG4gICAgICAgICAgICBlbnRyeTogY3VycmVudEJhY2tzdGFja0VudHJ5LmVudHJ5LFxuICAgICAgICAgICAgcmVzb2x2ZWRQYWdlOiBuZXdQYWdlLFxuICAgICAgICAgICAgbmF2RGVwdGg6IGN1cnJlbnRCYWNrc3RhY2tFbnRyeS5uYXZEZXB0aCxcbiAgICAgICAgICAgIGZyYWdtZW50VGFnOiBjdXJyZW50QmFja3N0YWNrRW50cnkuZnJhZ21lbnRUYWcsXG4gICAgICAgICAgICBmcmFtZUlkOiBjdXJyZW50QmFja3N0YWNrRW50cnkuZnJhbWVJZFxuICAgICAgICB9O1xuICAgICAgICB2YXIgbmF2aWdhdGlvbkNvbnRleHQgPSB7XG4gICAgICAgICAgICBlbnRyeTogbmV3QmFja3N0YWNrRW50cnksXG4gICAgICAgICAgICBpc0JhY2tOYXZpZ2F0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgIG5hdmlnYXRpb25UeXBlOiBOYXZpZ2F0aW9uVHlwZS5yZXBsYWNlXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX25hdmlnYXRpb25RdWV1ZS5wdXNoKG5hdmlnYXRpb25Db250ZXh0KTtcbiAgICAgICAgdGhpcy5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkoKTtcbiAgICB9O1xuICAgIHZhciBGcmFtZUJhc2VfMTtcbiAgICBGcmFtZUJhc2UuYW5kcm9pZE9wdGlvblNlbGVjdGVkRXZlbnQgPSBcIm9wdGlvblNlbGVjdGVkXCI7XG4gICAgRnJhbWVCYXNlLmRlZmF1bHRBbmltYXRlZE5hdmlnYXRpb24gPSB0cnVlO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJvbkxvYWRlZFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZyYW1lQmFzZS5wcm90b3R5cGUsIFwicGVyZm9ybU5hdmlnYXRpb25cIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBGcmFtZUJhc2UucHJvdG90eXBlLCBcInBlcmZvcm1Hb0JhY2tcIiwgbnVsbCk7XG4gICAgRnJhbWVCYXNlID0gRnJhbWVCYXNlXzEgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJGcmFtZVwiKVxuICAgIF0sIEZyYW1lQmFzZSk7XG4gICAgcmV0dXJuIEZyYW1lQmFzZTtcbn0odmlld18xLkN1c3RvbUxheW91dFZpZXcpKTtcbmV4cG9ydHMuRnJhbWVCYXNlID0gRnJhbWVCYXNlO1xuZnVuY3Rpb24gZ2V0RnJhbWVCeUlkKGlkKSB7XG4gICAgcmV0dXJuIGZyYW1lX3N0YWNrXzEuZnJhbWVTdGFjay5maW5kKGZ1bmN0aW9uIChmcmFtZSkgeyByZXR1cm4gZnJhbWUuaWQgJiYgZnJhbWUuaWQgPT09IGlkOyB9KTtcbn1cbmV4cG9ydHMuZ2V0RnJhbWVCeUlkID0gZ2V0RnJhbWVCeUlkO1xuZnVuY3Rpb24gdG9wbW9zdCgpIHtcbiAgICByZXR1cm4gZnJhbWVfc3RhY2tfMS50b3Btb3N0KCk7XG59XG5leHBvcnRzLnRvcG1vc3QgPSB0b3Btb3N0O1xuZnVuY3Rpb24gZ29CYWNrKCkge1xuICAgIHZhciB0b3AgPSB0b3Btb3N0KCk7XG4gICAgaWYgKHRvcCAmJiB0b3AuY2FuR29CYWNrKCkpIHtcbiAgICAgICAgdG9wLmdvQmFjaygpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSBpZiAodG9wKSB7XG4gICAgICAgIHZhciBwYXJlbnRGcmFtZUNhbkdvQmFjayA9IGZhbHNlO1xuICAgICAgICB2YXIgcGFyZW50RnJhbWUgPSB2aWV3X2NvbW1vbl8xLmdldEFuY2VzdG9yKHRvcCwgXCJGcmFtZVwiKTtcbiAgICAgICAgd2hpbGUgKHBhcmVudEZyYW1lICYmICFwYXJlbnRGcmFtZUNhbkdvQmFjaykge1xuICAgICAgICAgICAgaWYgKHBhcmVudEZyYW1lICYmIHBhcmVudEZyYW1lLmNhbkdvQmFjaygpKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50RnJhbWVDYW5Hb0JhY2sgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFyZW50RnJhbWUgPSB2aWV3X2NvbW1vbl8xLmdldEFuY2VzdG9yKHBhcmVudEZyYW1lLCBcIkZyYW1lXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJlbnRGcmFtZSAmJiBwYXJlbnRGcmFtZUNhbkdvQmFjaykge1xuICAgICAgICAgICAgcGFyZW50RnJhbWUuZ29CYWNrKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoZnJhbWVfc3RhY2tfMS5mcmFtZVN0YWNrLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdG9wLl9wb3BGcm9tRnJhbWVTdGFjaygpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5leHBvcnRzLmdvQmFjayA9IGdvQmFjaztcbmZ1bmN0aW9uIF9zdGFjaygpIHtcbiAgICByZXR1cm4gZnJhbWVfc3RhY2tfMS5mcmFtZVN0YWNrO1xufVxuZXhwb3J0cy5fc3RhY2sgPSBfc3RhY2s7XG5leHBvcnRzLmRlZmF1bHRQYWdlID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJkZWZhdWx0UGFnZVwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uIChmcmFtZSwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGZyYW1lLm5hdmlnYXRlKHsgbW9kdWxlTmFtZTogbmV3VmFsdWUgfSk7XG4gICAgfVxufSk7XG5leHBvcnRzLmRlZmF1bHRQYWdlLnJlZ2lzdGVyKEZyYW1lQmFzZSk7XG5leHBvcnRzLmFjdGlvbkJhclZpc2liaWxpdHlQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImFjdGlvbkJhclZpc2liaWxpdHlcIiwgZGVmYXVsdFZhbHVlOiBcImF1dG9cIiwgYWZmZWN0c0xheW91dDogdmlld18xLmlzSU9TIH0pO1xuZXhwb3J0cy5hY3Rpb25CYXJWaXNpYmlsaXR5UHJvcGVydHkucmVnaXN0ZXIoRnJhbWVCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZyYW1lLWNvbW1vbi5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmZyYW1lU3RhY2sgPSBbXTtcbmZ1bmN0aW9uIHRvcG1vc3QoKSB7XG4gICAgaWYgKGV4cG9ydHMuZnJhbWVTdGFjay5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBleHBvcnRzLmZyYW1lU3RhY2tbZXhwb3J0cy5mcmFtZVN0YWNrLmxlbmd0aCAtIDFdO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuZXhwb3J0cy50b3Btb3N0ID0gdG9wbW9zdDtcbmZ1bmN0aW9uIF9wdXNoSW5GcmFtZVN0YWNrKGZyYW1lKSB7XG4gICAgaWYgKGZyYW1lLl9pc0luRnJhbWVTdGFjayAmJiBleHBvcnRzLmZyYW1lU3RhY2tbZXhwb3J0cy5mcmFtZVN0YWNrLmxlbmd0aCAtIDFdID09PSBmcmFtZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChmcmFtZS5faXNJbkZyYW1lU3RhY2spIHtcbiAgICAgICAgdmFyIGluZGV4T2ZGcmFtZSA9IGV4cG9ydHMuZnJhbWVTdGFjay5pbmRleE9mKGZyYW1lKTtcbiAgICAgICAgZXhwb3J0cy5mcmFtZVN0YWNrLnNwbGljZShpbmRleE9mRnJhbWUsIDEpO1xuICAgIH1cbiAgICBleHBvcnRzLmZyYW1lU3RhY2sucHVzaChmcmFtZSk7XG4gICAgZnJhbWUuX2lzSW5GcmFtZVN0YWNrID0gdHJ1ZTtcbn1cbmV4cG9ydHMuX3B1c2hJbkZyYW1lU3RhY2sgPSBfcHVzaEluRnJhbWVTdGFjaztcbmZ1bmN0aW9uIF9wb3BGcm9tRnJhbWVTdGFjayhmcmFtZSkge1xuICAgIGlmICghZnJhbWUuX2lzSW5GcmFtZVN0YWNrKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRvcCA9IHRvcG1vc3QoKTtcbiAgICBpZiAodG9wICE9PSBmcmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgcG9wIGEgRnJhbWUgd2hpY2ggaXMgbm90IGF0IHRoZSB0b3Agb2YgdGhlIG5hdmlnYXRpb24gc3RhY2suXCIpO1xuICAgIH1cbiAgICBleHBvcnRzLmZyYW1lU3RhY2sucG9wKCk7XG4gICAgZnJhbWUuX2lzSW5GcmFtZVN0YWNrID0gZmFsc2U7XG59XG5leHBvcnRzLl9wb3BGcm9tRnJhbWVTdGFjayA9IF9wb3BGcm9tRnJhbWVTdGFjaztcbmZ1bmN0aW9uIF9yZW1vdmVGcm9tRnJhbWVTdGFjayhmcmFtZSkge1xuICAgIGlmICghZnJhbWUuX2lzSW5GcmFtZVN0YWNrKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGluZGV4ID0gZXhwb3J0cy5mcmFtZVN0YWNrLmluZGV4T2YoZnJhbWUpO1xuICAgIGV4cG9ydHMuZnJhbWVTdGFjay5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIGZyYW1lLl9pc0luRnJhbWVTdGFjayA9IGZhbHNlO1xufVxuZXhwb3J0cy5fcmVtb3ZlRnJvbUZyYW1lU3RhY2sgPSBfcmVtb3ZlRnJvbUZyYW1lU3RhY2s7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mcmFtZS1zdGFjay5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGFwcGxpY2F0aW9uID0gcmVxdWlyZShcIi4uLy4uL2FwcGxpY2F0aW9uXCIpO1xudmFyIGZyYW1lX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vZnJhbWUtY29tbW9uXCIpO1xudmFyIGZyYWdtZW50X3RyYW5zaXRpb25zXzEgPSByZXF1aXJlKFwiLi9mcmFnbWVudC50cmFuc2l0aW9uc1wiKTtcbnZhciBidWlsZGVyXzEgPSByZXF1aXJlKFwiLi4vYnVpbGRlclwiKTtcbnZhciBzeXN0ZW1fY2xhc3Nlc18xID0gcmVxdWlyZShcIi4uLy4uL2Nzcy9zeXN0ZW0tY2xhc3Nlc1wiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtL3BsYXRmb3JtXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2ZyYW1lLWNvbW1vblwiKSk7XG52YXIgQU5EUk9JRF9QTEFURk9STSA9IFwiYW5kcm9pZFwiO1xudmFyIElOVEVOVF9FWFRSQSA9IFwiY29tLnRucy5hY3Rpdml0eVwiO1xudmFyIFJPT1RfVklFV19JRF9FWFRSQSA9IFwiY29tLnRucy5hY3Rpdml0eS5yb290Vmlld0lkXCI7XG52YXIgRlJBTUVJRCA9IFwiX2ZyYW1lSWRcIjtcbnZhciBDQUxMQkFDS1MgPSBcIl9jYWxsYmFja3NcIjtcbnZhciBITVJfUkVQTEFDRV9UUkFOU0lUSU9OID0gXCJmYWRlXCI7XG52YXIgb3duZXJTeW1ib2wgPSBTeW1ib2woXCJfb3duZXJcIik7XG52YXIgYWN0aXZpdHlSb290Vmlld3NNYXAgPSBuZXcgTWFwKCk7XG52YXIgbmF2RGVwdGggPSAtMTtcbnZhciBmcmFnbWVudElkID0gLTE7XG5pZiAoZ2xvYmFsICYmIGdsb2JhbC5fX2luc3BlY3Rvcikge1xuICAgIHZhciBkZXZ0b29scyA9IHJlcXVpcmUoXCIuLi8uLi9kZWJ1Z2dlci9kZXZ0b29scy1lbGVtZW50c1wiKTtcbiAgICBkZXZ0b29scy5hdHRhY2hET01JbnNwZWN0b3JFdmVudENhbGxiYWNrcyhnbG9iYWwuX19pbnNwZWN0b3IpO1xuICAgIGRldnRvb2xzLmF0dGFjaERPTUluc3BlY3RvckNvbW1hbmRDYWxsYmFja3MoZ2xvYmFsLl9faW5zcGVjdG9yKTtcbn1cbmZ1bmN0aW9uIGdldEF0dGFjaExpc3RlbmVyKCkge1xuICAgIGlmICghZXhwb3J0cy5hdHRhY2hTdGF0ZUNoYW5nZUxpc3RlbmVyKSB7XG4gICAgICAgIHZhciBBdHRhY2hMaXN0ZW5lciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgICAgICBfX2V4dGVuZHMoQXR0YWNoTGlzdGVuZXIsIF9zdXBlcik7XG4gICAgICAgICAgICBmdW5jdGlvbiBBdHRhY2hMaXN0ZW5lcigpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQXR0YWNoTGlzdGVuZXIucHJvdG90eXBlLm9uVmlld0F0dGFjaGVkVG9XaW5kb3cgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICAgICAgICAgIHZhciBvd25lciA9IHZpZXdbb3duZXJTeW1ib2xdO1xuICAgICAgICAgICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgICAgICAgICBvd25lci5fb25BdHRhY2hlZFRvV2luZG93KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIEF0dGFjaExpc3RlbmVyLnByb3RvdHlwZS5vblZpZXdEZXRhY2hlZEZyb21XaW5kb3cgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICAgICAgICAgIHZhciBvd25lciA9IHZpZXdbb3duZXJTeW1ib2xdO1xuICAgICAgICAgICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgICAgICAgICBvd25lci5fb25EZXRhY2hlZEZyb21XaW5kb3coKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgQXR0YWNoTGlzdGVuZXIgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLnZpZXcuVmlldy5PbkF0dGFjaFN0YXRlQ2hhbmdlTGlzdGVuZXJdKVxuICAgICAgICAgICAgXSwgQXR0YWNoTGlzdGVuZXIpO1xuICAgICAgICAgICAgcmV0dXJuIEF0dGFjaExpc3RlbmVyO1xuICAgICAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICAgICAgZXhwb3J0cy5hdHRhY2hTdGF0ZUNoYW5nZUxpc3RlbmVyID0gbmV3IEF0dGFjaExpc3RlbmVyKCk7XG4gICAgfVxuICAgIHJldHVybiBleHBvcnRzLmF0dGFjaFN0YXRlQ2hhbmdlTGlzdGVuZXI7XG59XG5mdW5jdGlvbiByZWxvYWRQYWdlKGNvbnRleHQpIHtcbiAgICB2YXIgYWN0aXZpdHkgPSBhcHBsaWNhdGlvbi5hbmRyb2lkLmZvcmVncm91bmRBY3Rpdml0eTtcbiAgICB2YXIgY2FsbGJhY2tzID0gYWN0aXZpdHlbQ0FMTEJBQ0tTXTtcbiAgICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgICAgIHZhciByb290VmlldyA9IGNhbGxiYWNrcy5nZXRSb290VmlldygpO1xuICAgICAgICB2YXIgaXNBcHBSb290TW9kdWxlQ2hhbmdlZCA9IGNvbnRleHQgJiYgY29udGV4dC5wYXRoICYmIGNvbnRleHQucGF0aC5pbmNsdWRlcyhhcHBsaWNhdGlvbi5nZXRNYWluRW50cnkoKS5tb2R1bGVOYW1lKSAmJiBjb250ZXh0LnR5cGUgIT09IFwic3R5bGVcIjtcbiAgICAgICAgaWYgKGlzQXBwUm9vdE1vZHVsZUNoYW5nZWQgfHwgIXJvb3RWaWV3IHx8ICFyb290Vmlldy5fb25MaXZlc3luYyhjb250ZXh0KSkge1xuICAgICAgICAgICAgY2FsbGJhY2tzLnJlc2V0QWN0aXZpdHlDb250ZW50KGFjdGl2aXR5KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VFcnJvcihhY3Rpdml0eSArIFwiW0NBTExCQUNLU10gaXMgbnVsbCBvciB1bmRlZmluZWRcIik7XG4gICAgfVxufVxuZXhwb3J0cy5yZWxvYWRQYWdlID0gcmVsb2FkUGFnZTtcbmdsb2JhbC5fX29uTGl2ZVN5bmNDb3JlID0gcmVsb2FkUGFnZTtcbnZhciBGcmFtZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZyYW1lLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZyYW1lKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fY29udGFpbmVyVmlld0lkID0gLTE7XG4gICAgICAgIF90aGlzLl90ZWFyRG93blBlbmRpbmcgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuX2F0dGFjaGVkVG9XaW5kb3cgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuX2FuZHJvaWQgPSBuZXcgQW5kcm9pZEZyYW1lKF90aGlzKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWUsIFwiZGVmYXVsdEFuaW1hdGVkTmF2aWdhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZyYW1lX2NvbW1vbl8xLkZyYW1lQmFzZS5kZWZhdWx0QW5pbWF0ZWROYXZpZ2F0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEuRnJhbWVCYXNlLmRlZmF1bHRBbmltYXRlZE5hdmlnYXRpb24gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lLCBcImRlZmF1bHRUcmFuc2l0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZnJhbWVfY29tbW9uXzEuRnJhbWVCYXNlLmRlZmF1bHRUcmFuc2l0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEuRnJhbWVCYXNlLmRlZmF1bHRUcmFuc2l0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZS5wcm90b3R5cGUsIFwiY29udGFpbmVyVmlld0lkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGFpbmVyVmlld0lkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWUucHJvdG90eXBlLCBcImFuZHJvaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hbmRyb2lkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWUucHJvdG90eXBlLCBcIl9oYXNGcmFnbWVudHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGcmFtZS5wcm90b3R5cGUuX29uQXR0YWNoZWRUb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fb25BdHRhY2hlZFRvV2luZG93LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuX2F0dGFjaGVkVG9XaW5kb3cgPSB0cnVlO1xuICAgICAgICB0aGlzLl9wcm9jZXNzTmV4dE5hdmlnYXRpb25FbnRyeSgpO1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLl9vbkRldGFjaGVkRnJvbVdpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fb25EZXRhY2hlZEZyb21XaW5kb3cuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5fYXR0YWNoZWRUb1dpbmRvdyA9IGZhbHNlO1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLl9wcm9jZXNzTmV4dE5hdmlnYXRpb25FbnRyeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzTG9hZGVkIHx8IHRoaXMuX2V4ZWN1dGluZ0NvbnRleHQgfHwgIXRoaXMuX2F0dGFjaGVkVG9XaW5kb3cpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYW5pbWF0ZWRFbnRyaWVzID0gZnJhZ21lbnRfdHJhbnNpdGlvbnNfMS5fZ2V0QW5pbWF0ZWRFbnRyaWVzKHRoaXMuX2FuZHJvaWQuZnJhbWVJZCk7XG4gICAgICAgIGlmIChhbmltYXRlZEVudHJpZXMpIHtcbiAgICAgICAgICAgIGlmIChhbmltYXRlZEVudHJpZXMuc2l6ZSA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1hbmFnZXIgPSB0aGlzLl9nZXRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy5fY3VycmVudEVudHJ5O1xuICAgICAgICBpZiAoZW50cnkgJiYgbWFuYWdlciAmJiAhbWFuYWdlci5maW5kRnJhZ21lbnRCeVRhZyhlbnRyeS5mcmFnbWVudFRhZykpIHtcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlZEFuaW1hdG9yU3RhdGUgPSBnZXRBbmltYXRvclN0YXRlKHRoaXMuX2N1cnJlbnRFbnRyeSk7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50RW50cnkgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fbmF2aWdhdGVDb3JlKGVudHJ5KTtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRFbnRyeSA9IGVudHJ5O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkuY2FsbCh0aGlzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLl9nZXRDaGlsZEZyYWdtZW50TWFuYWdlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGJhY2tzdGFja0VudHJ5O1xuICAgICAgICBpZiAodGhpcy5fZXhlY3V0aW5nQ29udGV4dCAmJiB0aGlzLl9leGVjdXRpbmdDb250ZXh0LmVudHJ5KSB7XG4gICAgICAgICAgICBiYWNrc3RhY2tFbnRyeSA9IHRoaXMuX2V4ZWN1dGluZ0NvbnRleHQuZW50cnk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBiYWNrc3RhY2tFbnRyeSA9IHRoaXMuX2N1cnJlbnRFbnRyeTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYmFja3N0YWNrRW50cnkgJiYgYmFja3N0YWNrRW50cnkuZnJhZ21lbnQgJiYgYmFja3N0YWNrRW50cnkuZnJhZ21lbnQuaXNBZGRlZCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gYmFja3N0YWNrRW50cnkuZnJhZ21lbnQuZ2V0Q2hpbGRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5fb25Sb290Vmlld1Jlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9vblJvb3RWaWV3UmVzZXQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudEZyYWdtZW50KCk7XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRGcmFnbWVudCgpO1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLmRpc3Bvc2VDdXJyZW50RnJhZ21lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fY3VycmVudEVudHJ5IHx8XG4gICAgICAgICAgICAhdGhpcy5fY3VycmVudEVudHJ5LmZyYWdtZW50IHx8XG4gICAgICAgICAgICAhdGhpcy5fY3VycmVudEVudHJ5LmZyYWdtZW50LmlzQWRkZWQoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtYW5hZ2VyID0gdGhpcy5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IG1hbmFnZXIuYmVnaW5UcmFuc2FjdGlvbigpO1xuICAgICAgICB0cmFuc2FjdGlvbi5yZW1vdmUodGhpcy5fY3VycmVudEVudHJ5LmZyYWdtZW50KTtcbiAgICAgICAgdHJhbnNhY3Rpb24uY29tbWl0Tm93QWxsb3dpbmdTdGF0ZUxvc3MoKTtcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5jcmVhdGVGcmFnbWVudCA9IGZ1bmN0aW9uIChiYWNrc3RhY2tFbnRyeSwgZnJhZ21lbnRUYWcpIHtcbiAgICAgICAgZW5zdXJlRnJhZ21lbnRDbGFzcygpO1xuICAgICAgICB2YXIgbmV3RnJhZ21lbnQgPSBuZXcgZnJhZ21lbnRDbGFzcygpO1xuICAgICAgICB2YXIgYXJncyA9IG5ldyBhbmRyb2lkLm9zLkJ1bmRsZSgpO1xuICAgICAgICBhcmdzLnB1dEludChGUkFNRUlELCB0aGlzLl9hbmRyb2lkLmZyYW1lSWQpO1xuICAgICAgICBuZXdGcmFnbWVudC5zZXRBcmd1bWVudHMoYXJncyk7XG4gICAgICAgIHNldEZyYWdtZW50Q2FsbGJhY2tzKG5ld0ZyYWdtZW50KTtcbiAgICAgICAgdmFyIGNhbGxiYWNrcyA9IG5ld0ZyYWdtZW50W0NBTExCQUNLU107XG4gICAgICAgIGNhbGxiYWNrcy5mcmFtZSA9IHRoaXM7XG4gICAgICAgIGNhbGxiYWNrcy5lbnRyeSA9IGJhY2tzdGFja0VudHJ5O1xuICAgICAgICBiYWNrc3RhY2tFbnRyeS5mcmFnbWVudCA9IG5ld0ZyYWdtZW50O1xuICAgICAgICBiYWNrc3RhY2tFbnRyeS5mcmFnbWVudFRhZyA9IGZyYWdtZW50VGFnO1xuICAgICAgICBiYWNrc3RhY2tFbnRyeS5uYXZEZXB0aCA9IG5hdkRlcHRoO1xuICAgICAgICByZXR1cm4gbmV3RnJhZ21lbnQ7XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuc2V0Q3VycmVudCA9IGZ1bmN0aW9uIChlbnRyeSwgbmF2aWdhdGlvblR5cGUpIHtcbiAgICAgICAgdmFyIGN1cnJlbnQgPSB0aGlzLl9jdXJyZW50RW50cnk7XG4gICAgICAgIHZhciBjdXJyZW50RW50cnlDaGFuZ2VkID0gY3VycmVudCAhPT0gZW50cnk7XG4gICAgICAgIGlmIChjdXJyZW50RW50cnlDaGFuZ2VkKSB7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVCYWNrc3RhY2soZW50cnksIG5hdmlnYXRpb25UeXBlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl90ZWFyRG93blBlbmRpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90ZWFyRG93blBlbmRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoIWVudHJ5LnJlY3JlYXRlZCkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhckVudHJ5KGVudHJ5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQgJiYgIWN1cnJlbnQucmVjcmVhdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFyRW50cnkoY3VycmVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjb250ZXh0XzEgPSB0aGlzLl9jb250ZXh0O1xuICAgICAgICAgICAgICAgIGlmIChjb250ZXh0XzEgJiYgIWVudHJ5LnJlY3JlYXRlZCkge1xuICAgICAgICAgICAgICAgICAgICBlbnRyeS5mcmFnbWVudCA9IHRoaXMuY3JlYXRlRnJhZ21lbnQoZW50cnksIGVudHJ5LmZyYWdtZW50VGFnKTtcbiAgICAgICAgICAgICAgICAgICAgZW50cnkucmVzb2x2ZWRQYWdlLl9zZXR1cFVJKGNvbnRleHRfMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVudHJ5LnJlY3JlYXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQucmVjcmVhdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5zZXRDdXJyZW50LmNhbGwodGhpcywgZW50cnksIG5hdmlnYXRpb25UeXBlKTtcbiAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3NOYXZpZ2F0aW9uUXVldWUoZW50cnkucmVzb2x2ZWRQYWdlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3NOZXh0TmF2aWdhdGlvbkVudHJ5KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2NhY2hlZEFuaW1hdG9yU3RhdGUpIHtcbiAgICAgICAgICAgIHJlc3RvcmVBbmltYXRvclN0YXRlKHRoaXMuX2N1cnJlbnRFbnRyeSwgdGhpcy5fY2FjaGVkQW5pbWF0b3JTdGF0ZSk7XG4gICAgICAgICAgICB0aGlzLl9jYWNoZWRBbmltYXRvclN0YXRlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmF2aWdhdGlvblR5cGUgPT09IGZyYW1lX2NvbW1vbl8xLk5hdmlnYXRpb25UeXBlLnJlcGxhY2UpIHtcbiAgICAgICAgICAgIGZyYWdtZW50X3RyYW5zaXRpb25zXzEuX2NsZWFyRW50cnkoZW50cnkpO1xuICAgICAgICAgICAgdmFyIGFuaW1hdGVkID0gdGhpcy5fZ2V0SXNBbmltYXRlZE5hdmlnYXRpb24oZW50cnkuZW50cnkpO1xuICAgICAgICAgICAgdmFyIG5hdmlnYXRpb25UcmFuc2l0aW9uID0gdGhpcy5fZ2V0TmF2aWdhdGlvblRyYW5zaXRpb24oZW50cnkuZW50cnkpO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRFbnRyeSA9IG51bGw7XG4gICAgICAgICAgICB2YXIgbmV3RW50cnkgPSBlbnRyeTtcbiAgICAgICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IG51bGw7XG4gICAgICAgICAgICBmcmFnbWVudF90cmFuc2l0aW9uc18xLl9zZXRBbmRyb2lkRnJhZ21lbnRUcmFuc2l0aW9ucyhhbmltYXRlZCwgbmF2aWdhdGlvblRyYW5zaXRpb24sIGN1cnJlbnRFbnRyeSwgbmV3RW50cnksIHRyYW5zYWN0aW9uLCB0aGlzLl9hbmRyb2lkLmZyYW1lSWQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUub25CYWNrUHJlc3NlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuY2FuR29CYWNrKCkpIHtcbiAgICAgICAgICAgIHRoaXMuZ29CYWNrKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMubmF2aWdhdGlvblF1ZXVlSXNFbXB0eSgpKSB7XG4gICAgICAgICAgICB2YXIgbWFuYWdlciA9IHRoaXMuX2dldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICAgICAgaWYgKG1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICBtYW5hZ2VyLmV4ZWN1dGVQZW5kaW5nVHJhbnNhY3Rpb25zKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLl9uYXZpZ2F0ZUNvcmUgPSBmdW5jdGlvbiAobmV3RW50cnkpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fbmF2aWdhdGVDb3JlLmNhbGwodGhpcywgbmV3RW50cnkpO1xuICAgICAgICBuZXdFbnRyeS5mcmFtZUlkID0gdGhpcy5fYW5kcm9pZC5mcmFtZUlkO1xuICAgICAgICB2YXIgYWN0aXZpdHkgPSB0aGlzLl9hbmRyb2lkLmFjdGl2aXR5O1xuICAgICAgICBpZiAoIWFjdGl2aXR5KSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudEFjdGl2aXR5ID0gdGhpcy5fYW5kcm9pZC5jdXJyZW50QWN0aXZpdHk7XG4gICAgICAgICAgICBpZiAoY3VycmVudEFjdGl2aXR5KSB7XG4gICAgICAgICAgICAgICAgc3RhcnRBY3Rpdml0eShjdXJyZW50QWN0aXZpdHksIHRoaXMuX2FuZHJvaWQuZnJhbWVJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1hbmFnZXIgPSB0aGlzLl9nZXRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgdmFyIGNsZWFySGlzdG9yeSA9IG5ld0VudHJ5LmVudHJ5LmNsZWFySGlzdG9yeTtcbiAgICAgICAgdmFyIGN1cnJlbnRFbnRyeSA9IHRoaXMuX2N1cnJlbnRFbnRyeTtcbiAgICAgICAgaWYgKGNsZWFySGlzdG9yeSkge1xuICAgICAgICAgICAgbmF2RGVwdGggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXNSZXBsYWNlID0gdGhpcy5fZXhlY3V0aW5nQ29udGV4dCAmJiB0aGlzLl9leGVjdXRpbmdDb250ZXh0Lm5hdmlnYXRpb25UeXBlID09PSBmcmFtZV9jb21tb25fMS5OYXZpZ2F0aW9uVHlwZS5yZXBsYWNlO1xuICAgICAgICBpZiAoIWlzUmVwbGFjZSkge1xuICAgICAgICAgICAgbmF2RGVwdGgrKztcbiAgICAgICAgfVxuICAgICAgICBmcmFnbWVudElkKys7XG4gICAgICAgIHZhciBuZXdGcmFnbWVudFRhZyA9IFwiZnJhZ21lbnRcIiArIGZyYWdtZW50SWQgKyBcIltcIiArIG5hdkRlcHRoICsgXCJdXCI7XG4gICAgICAgIHZhciBuZXdGcmFnbWVudCA9IHRoaXMuY3JlYXRlRnJhZ21lbnQobmV3RW50cnksIG5ld0ZyYWdtZW50VGFnKTtcbiAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gbWFuYWdlci5iZWdpblRyYW5zYWN0aW9uKCk7XG4gICAgICAgIHZhciBhbmltYXRlZCA9IGN1cnJlbnRFbnRyeSA/IHRoaXMuX2dldElzQW5pbWF0ZWROYXZpZ2F0aW9uKG5ld0VudHJ5LmVudHJ5KSA6IGZhbHNlO1xuICAgICAgICB2YXIgbmF2aWdhdGlvblRyYW5zaXRpb247XG4gICAgICAgIGlmIChpc1JlcGxhY2UpIHtcbiAgICAgICAgICAgIGFuaW1hdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIG5hdmlnYXRpb25UcmFuc2l0aW9uID0geyBuYW1lOiBITVJfUkVQTEFDRV9UUkFOU0lUSU9OLCBkdXJhdGlvbjogMTAwIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fY3VycmVudEVudHJ5KSB7XG4gICAgICAgICAgICBuYXZpZ2F0aW9uVHJhbnNpdGlvbiA9IHRoaXMuX2dldE5hdmlnYXRpb25UcmFuc2l0aW9uKG5ld0VudHJ5LmVudHJ5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5hdmlnYXRpb25UcmFuc2l0aW9uID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBmcmFnbWVudF90cmFuc2l0aW9uc18xLl9zZXRBbmRyb2lkRnJhZ21lbnRUcmFuc2l0aW9ucyhhbmltYXRlZCwgbmF2aWdhdGlvblRyYW5zaXRpb24sIGN1cnJlbnRFbnRyeSwgbmV3RW50cnksIHRyYW5zYWN0aW9uLCB0aGlzLl9hbmRyb2lkLmZyYW1lSWQpO1xuICAgICAgICBpZiAoY3VycmVudEVudHJ5ICYmIGFuaW1hdGVkICYmICFuYXZpZ2F0aW9uVHJhbnNpdGlvbikge1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24uc2V0VHJhbnNpdGlvbihhbmRyb2lkeC5mcmFnbWVudC5hcHAuRnJhZ21lbnRUcmFuc2FjdGlvbi5UUkFOU0lUX0ZSQUdNRU5UX09QRU4pO1xuICAgICAgICB9XG4gICAgICAgIHRyYW5zYWN0aW9uLnJlcGxhY2UodGhpcy5jb250YWluZXJWaWV3SWQsIG5ld0ZyYWdtZW50LCBuZXdGcmFnbWVudFRhZyk7XG4gICAgICAgIHRyYW5zYWN0aW9uLmNvbW1pdEFsbG93aW5nU3RhdGVMb3NzKCk7XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuX2dvQmFja0NvcmUgPSBmdW5jdGlvbiAoYmFja3N0YWNrRW50cnkpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fZ29CYWNrQ29yZS5jYWxsKHRoaXMsIGJhY2tzdGFja0VudHJ5KTtcbiAgICAgICAgbmF2RGVwdGggPSBiYWNrc3RhY2tFbnRyeS5uYXZEZXB0aDtcbiAgICAgICAgdmFyIG1hbmFnZXIgPSB0aGlzLl9nZXRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gbWFuYWdlci5iZWdpblRyYW5zYWN0aW9uKCk7XG4gICAgICAgIGlmICghYmFja3N0YWNrRW50cnkuZnJhZ21lbnQpIHtcbiAgICAgICAgICAgIGJhY2tzdGFja0VudHJ5LmZyYWdtZW50ID0gdGhpcy5jcmVhdGVGcmFnbWVudChiYWNrc3RhY2tFbnRyeSwgYmFja3N0YWNrRW50cnkuZnJhZ21lbnRUYWcpO1xuICAgICAgICAgICAgZnJhZ21lbnRfdHJhbnNpdGlvbnNfMS5fdXBkYXRlVHJhbnNpdGlvbnMoYmFja3N0YWNrRW50cnkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0cmFuc2l0aW9uUmV2ZXJzZWQgPSBmcmFnbWVudF90cmFuc2l0aW9uc18xLl9yZXZlcnNlVHJhbnNpdGlvbnMoYmFja3N0YWNrRW50cnksIHRoaXMuX2N1cnJlbnRFbnRyeSk7XG4gICAgICAgIGlmICghdHJhbnNpdGlvblJldmVyc2VkKSB7XG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5zZXRDdXN0b21BbmltYXRpb25zKC0zMCwgLTQwKTtcbiAgICAgICAgfVxuICAgICAgICB0cmFuc2FjdGlvbi5yZXBsYWNlKHRoaXMuY29udGFpbmVyVmlld0lkLCBiYWNrc3RhY2tFbnRyeS5mcmFnbWVudCwgYmFja3N0YWNrRW50cnkuZnJhZ21lbnRUYWcpO1xuICAgICAgICB0cmFuc2FjdGlvbi5jb21taXRBbGxvd2luZ1N0YXRlTG9zcygpO1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLl9yZW1vdmVFbnRyeSA9IGZ1bmN0aW9uIChyZW1vdmVkKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3JlbW92ZUVudHJ5LmNhbGwodGhpcywgcmVtb3ZlZCk7XG4gICAgICAgIGlmIChyZW1vdmVkLmZyYWdtZW50KSB7XG4gICAgICAgICAgICBmcmFnbWVudF90cmFuc2l0aW9uc18xLl9jbGVhckVudHJ5KHJlbW92ZWQpO1xuICAgICAgICB9XG4gICAgICAgIHJlbW92ZWQuZnJhZ21lbnQgPSBudWxsO1xuICAgICAgICByZW1vdmVkLnZpZXdTYXZlZFN0YXRlID0gbnVsbDtcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Db250ZW50TGF5b3V0KHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IGdldEF0dGFjaExpc3RlbmVyKCk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5hZGRPbkF0dGFjaFN0YXRlQ2hhbmdlTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWRbb3duZXJTeW1ib2xdID0gdGhpcztcbiAgICAgICAgdGhpcy5fYW5kcm9pZC5yb290Vmlld0dyb3VwID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAodGhpcy5fY29udGFpbmVyVmlld0lkIDwgMCkge1xuICAgICAgICAgICAgdGhpcy5fY29udGFpbmVyVmlld0lkID0gYW5kcm9pZC52aWV3LlZpZXcuZ2VuZXJhdGVWaWV3SWQoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9hbmRyb2lkLnJvb3RWaWV3R3JvdXAuc2V0SWQodGhpcy5fY29udGFpbmVyVmlld0lkKTtcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gZ2V0QXR0YWNoTGlzdGVuZXIoKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnJlbW92ZU9uQXR0YWNoU3RhdGVDaGFuZ2VMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZFtvd25lclN5bWJvbF0gPSBudWxsO1xuICAgICAgICB0aGlzLl90ZWFyRG93blBlbmRpbmcgPSAhIXRoaXMuX2V4ZWN1dGluZ0NvbnRleHQ7XG4gICAgICAgIHZhciBjdXJyZW50ID0gdGhpcy5fY3VycmVudEVudHJ5O1xuICAgICAgICB2YXIgZXhlY3V0aW5nRW50cnkgPSB0aGlzLl9leGVjdXRpbmdDb250ZXh0ID8gdGhpcy5fZXhlY3V0aW5nQ29udGV4dC5lbnRyeSA6IG51bGw7XG4gICAgICAgIHRoaXMuYmFja1N0YWNrLmZvckVhY2goZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgICAgICAgICBpZiAoZW50cnkgIT09IGV4ZWN1dGluZ0VudHJ5KSB7XG4gICAgICAgICAgICAgICAgY2xlYXJFbnRyeShlbnRyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoY3VycmVudCAmJiAhZXhlY3V0aW5nRW50cnkpIHtcbiAgICAgICAgICAgIGNsZWFyRW50cnkoY3VycmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYW5kcm9pZC5yb290Vmlld0dyb3VwID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcmVtb3ZlRnJvbUZyYW1lU3RhY2soKTtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLl9wb3BGcm9tRnJhbWVTdGFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9pc0luRnJhbWVTdGFjaykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3BvcEZyb21GcmFtZVN0YWNrLmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuX2dldE5hdkJhclZpc2libGUgPSBmdW5jdGlvbiAocGFnZSkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMuYWN0aW9uQmFyVmlzaWJpbGl0eSkge1xuICAgICAgICAgICAgY2FzZSBcIm5ldmVyXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgY2FzZSBcImFsd2F5c1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBpZiAocGFnZS5hY3Rpb25CYXJIaWRkZW4gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXBhZ2UuYWN0aW9uQmFySGlkZGVuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYW5kcm9pZCAmJiB0aGlzLl9hbmRyb2lkLnNob3dBY3Rpb25CYXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYW5kcm9pZC5zaG93QWN0aW9uQmFyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLl9zYXZlRnJhZ21lbnRzU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYmFja1N0YWNrLmZvckVhY2goZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IGVudHJ5LnJlc29sdmVkUGFnZS5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgaWYgKCFlbnRyeS52aWV3U2F2ZWRTdGF0ZSAmJiB2aWV3KSB7XG4gICAgICAgICAgICAgICAgdmFyIHZpZXdTdGF0ZSA9IG5ldyBhbmRyb2lkLnV0aWwuU3BhcnNlQXJyYXkoKTtcbiAgICAgICAgICAgICAgICB2aWV3LnNhdmVIaWVyYXJjaHlTdGF0ZSh2aWV3U3RhdGUpO1xuICAgICAgICAgICAgICAgIGVudHJ5LnZpZXdTYXZlZFN0YXRlID0gdmlld1N0YXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRnJhbWUucHJvdG90eXBlLCBcIl9uYXZpZ2F0ZUNvcmVcIiwgbnVsbCk7XG4gICAgcmV0dXJuIEZyYW1lO1xufShmcmFtZV9jb21tb25fMS5GcmFtZUJhc2UpKTtcbmV4cG9ydHMuRnJhbWUgPSBGcmFtZTtcbmZ1bmN0aW9uIGNsb25lRXhwYW5kZWRBbmltYXRvcihleHBhbmRlZEFuaW1hdG9yKSB7XG4gICAgaWYgKCFleHBhbmRlZEFuaW1hdG9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgY2xvbmUgPSBleHBhbmRlZEFuaW1hdG9yLmNsb25lKCk7XG4gICAgY2xvbmUuZW50cnkgPSBleHBhbmRlZEFuaW1hdG9yLmVudHJ5O1xuICAgIGNsb25lLnRyYW5zaXRpb25UeXBlID0gZXhwYW5kZWRBbmltYXRvci50cmFuc2l0aW9uVHlwZTtcbiAgICByZXR1cm4gY2xvbmU7XG59XG5mdW5jdGlvbiBnZXRBbmltYXRvclN0YXRlKGVudHJ5KSB7XG4gICAgdmFyIGV4cGFuZGVkRW50cnkgPSBlbnRyeTtcbiAgICB2YXIgYW5pbWF0b3JTdGF0ZSA9IHt9O1xuICAgIGFuaW1hdG9yU3RhdGUuZW50ZXJBbmltYXRvciA9IGNsb25lRXhwYW5kZWRBbmltYXRvcihleHBhbmRlZEVudHJ5LmVudGVyQW5pbWF0b3IpO1xuICAgIGFuaW1hdG9yU3RhdGUuZXhpdEFuaW1hdG9yID0gY2xvbmVFeHBhbmRlZEFuaW1hdG9yKGV4cGFuZGVkRW50cnkuZXhpdEFuaW1hdG9yKTtcbiAgICBhbmltYXRvclN0YXRlLnBvcEVudGVyQW5pbWF0b3IgPSBjbG9uZUV4cGFuZGVkQW5pbWF0b3IoZXhwYW5kZWRFbnRyeS5wb3BFbnRlckFuaW1hdG9yKTtcbiAgICBhbmltYXRvclN0YXRlLnBvcEV4aXRBbmltYXRvciA9IGNsb25lRXhwYW5kZWRBbmltYXRvcihleHBhbmRlZEVudHJ5LnBvcEV4aXRBbmltYXRvcik7XG4gICAgYW5pbWF0b3JTdGF0ZS50cmFuc2l0aW9uTmFtZSA9IGV4cGFuZGVkRW50cnkudHJhbnNpdGlvbk5hbWU7XG4gICAgcmV0dXJuIGFuaW1hdG9yU3RhdGU7XG59XG5mdW5jdGlvbiByZXN0b3JlQW5pbWF0b3JTdGF0ZShlbnRyeSwgc25hcHNob3QpIHtcbiAgICB2YXIgZXhwYW5kZWRFbnRyeSA9IGVudHJ5O1xuICAgIGlmIChzbmFwc2hvdC5lbnRlckFuaW1hdG9yKSB7XG4gICAgICAgIGV4cGFuZGVkRW50cnkuZW50ZXJBbmltYXRvciA9IHNuYXBzaG90LmVudGVyQW5pbWF0b3I7XG4gICAgfVxuICAgIGlmIChzbmFwc2hvdC5leGl0QW5pbWF0b3IpIHtcbiAgICAgICAgZXhwYW5kZWRFbnRyeS5leGl0QW5pbWF0b3IgPSBzbmFwc2hvdC5leGl0QW5pbWF0b3I7XG4gICAgfVxuICAgIGlmIChzbmFwc2hvdC5wb3BFbnRlckFuaW1hdG9yKSB7XG4gICAgICAgIGV4cGFuZGVkRW50cnkucG9wRW50ZXJBbmltYXRvciA9IHNuYXBzaG90LnBvcEVudGVyQW5pbWF0b3I7XG4gICAgfVxuICAgIGlmIChzbmFwc2hvdC5wb3BFeGl0QW5pbWF0b3IpIHtcbiAgICAgICAgZXhwYW5kZWRFbnRyeS5wb3BFeGl0QW5pbWF0b3IgPSBzbmFwc2hvdC5wb3BFeGl0QW5pbWF0b3I7XG4gICAgfVxuICAgIGV4cGFuZGVkRW50cnkudHJhbnNpdGlvbk5hbWUgPSBzbmFwc2hvdC50cmFuc2l0aW9uTmFtZTtcbn1cbmZ1bmN0aW9uIGNsZWFyRW50cnkoZW50cnkpIHtcbiAgICBpZiAoZW50cnkuZnJhZ21lbnQpIHtcbiAgICAgICAgZnJhZ21lbnRfdHJhbnNpdGlvbnNfMS5fY2xlYXJGcmFnbWVudChlbnRyeSk7XG4gICAgfVxuICAgIGVudHJ5LnJlY3JlYXRlZCA9IGZhbHNlO1xuICAgIGVudHJ5LmZyYWdtZW50ID0gbnVsbDtcbiAgICB2YXIgcGFnZSA9IGVudHJ5LnJlc29sdmVkUGFnZTtcbiAgICBpZiAocGFnZS5fY29udGV4dCkge1xuICAgICAgICBlbnRyeS5yZXNvbHZlZFBhZ2UuX3RlYXJEb3duVUkodHJ1ZSk7XG4gICAgfVxufVxudmFyIGZyYW1lc0NvdW50ZXIgPSAwO1xudmFyIGZyYW1lc0NhY2hlID0gbmV3IEFycmF5KCk7XG52YXIgQW5kcm9pZEZyYW1lID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQW5kcm9pZEZyYW1lLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFuZHJvaWRGcmFtZShvd25lcikge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fc2hvd0FjdGlvbkJhciA9IHRydWU7XG4gICAgICAgIF90aGlzLl9vd25lciA9IG93bmVyO1xuICAgICAgICBfdGhpcy5mcmFtZUlkID0gZnJhbWVzQ291bnRlcisrO1xuICAgICAgICBmcmFtZXNDYWNoZS5wdXNoKG5ldyBXZWFrUmVmKF90aGlzKSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFuZHJvaWRGcmFtZS5wcm90b3R5cGUsIFwic2hvd0FjdGlvbkJhclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Nob3dBY3Rpb25CYXI7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc2hvd0FjdGlvbkJhciAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zaG93QWN0aW9uQmFyID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3duZXIuY3VycmVudFBhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vd25lci5jdXJyZW50UGFnZS5hY3Rpb25CYXIudXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQW5kcm9pZEZyYW1lLnByb3RvdHlwZSwgXCJhY3Rpdml0eVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFjdGl2aXR5ID0gdGhpcy5vd25lci5fY29udGV4dDtcbiAgICAgICAgICAgIGlmIChhY3Rpdml0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpdml0eTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjdXJyVmlldyA9IHRoaXMuX293bmVyLnBhcmVudDtcbiAgICAgICAgICAgIHdoaWxlIChjdXJyVmlldykge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyVmlldyBpbnN0YW5jZW9mIEZyYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjdXJyVmlldy5hbmRyb2lkLmFjdGl2aXR5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdXJyVmlldyA9IGN1cnJWaWV3LnBhcmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbmRyb2lkRnJhbWUucHJvdG90eXBlLCBcImFjdGlvbkJhclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFjdGl2aXR5ID0gdGhpcy5jdXJyZW50QWN0aXZpdHk7XG4gICAgICAgICAgICBpZiAoIWFjdGl2aXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBiYXIgPSBhY3Rpdml0eS5nZXRBY3Rpb25CYXIoKTtcbiAgICAgICAgICAgIGlmICghYmFyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBiYXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbmRyb2lkRnJhbWUucHJvdG90eXBlLCBcImN1cnJlbnRBY3Rpdml0eVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFjdGl2aXR5ID0gdGhpcy5hY3Rpdml0eTtcbiAgICAgICAgICAgIGlmIChhY3Rpdml0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpdml0eTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmcmFtZXMgPSBmcmFtZV9jb21tb25fMS5fc3RhY2soKTtcbiAgICAgICAgICAgIGZvciAodmFyIGxlbmd0aF8xID0gZnJhbWVzLmxlbmd0aCwgaSA9IGxlbmd0aF8xIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICBhY3Rpdml0eSA9IGZyYW1lc1tpXS5hbmRyb2lkLmFjdGl2aXR5O1xuICAgICAgICAgICAgICAgIGlmIChhY3Rpdml0eSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aXZpdHk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFuZHJvaWRGcmFtZS5wcm90b3R5cGUsIFwib3duZXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vd25lcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQW5kcm9pZEZyYW1lLnByb3RvdHlwZS5jYW5Hb0JhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5hY3Rpdml0eSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGl2aXR5LmdldEludGVudCgpLmdldEFjdGlvbigpICE9PSBhbmRyb2lkLmNvbnRlbnQuSW50ZW50LkFDVElPTl9NQUlOO1xuICAgIH07XG4gICAgQW5kcm9pZEZyYW1lLnByb3RvdHlwZS5mcmFnbWVudEZvclBhZ2UgPSBmdW5jdGlvbiAoZW50cnkpIHtcbiAgICAgICAgdmFyIHRhZyA9IGVudHJ5ICYmIGVudHJ5LmZyYWdtZW50VGFnO1xuICAgICAgICBpZiAodGFnKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vd25lci5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCkuZmluZEZyYWdtZW50QnlUYWcodGFnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgcmV0dXJuIEFuZHJvaWRGcmFtZTtcbn0oZnJhbWVfY29tbW9uXzEuT2JzZXJ2YWJsZSkpO1xuZnVuY3Rpb24gZmluZFBhZ2VGb3JGcmFnbWVudChmcmFnbWVudCwgZnJhbWUpIHtcbiAgICB2YXIgZnJhZ21lbnRUYWcgPSBmcmFnbWVudC5nZXRUYWcoKTtcbiAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIkZpbmRpbmcgcGFnZSBmb3IgXCIgKyBmcmFnbWVudFRhZyArIFwiLlwiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICB9XG4gICAgdmFyIGVudHJ5O1xuICAgIHZhciBjdXJyZW50ID0gZnJhbWUuX2N1cnJlbnRFbnRyeTtcbiAgICB2YXIgZXhlY3V0aW5nQ29udGV4dCA9IGZyYW1lLl9leGVjdXRpbmdDb250ZXh0O1xuICAgIGlmIChjdXJyZW50ICYmIGN1cnJlbnQuZnJhZ21lbnRUYWcgPT09IGZyYWdtZW50VGFnKSB7XG4gICAgICAgIGVudHJ5ID0gY3VycmVudDtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXhlY3V0aW5nQ29udGV4dCAmJiBleGVjdXRpbmdDb250ZXh0LmVudHJ5ICYmIGV4ZWN1dGluZ0NvbnRleHQuZW50cnkuZnJhZ21lbnRUYWcgPT09IGZyYWdtZW50VGFnKSB7XG4gICAgICAgIGVudHJ5ID0gZXhlY3V0aW5nQ29udGV4dC5lbnRyeTtcbiAgICB9XG4gICAgdmFyIHBhZ2U7XG4gICAgaWYgKGVudHJ5KSB7XG4gICAgICAgIGVudHJ5LnJlY3JlYXRlZCA9IHRydWU7XG4gICAgICAgIHBhZ2UgPSBlbnRyeS5yZXNvbHZlZFBhZ2U7XG4gICAgfVxuICAgIGlmIChwYWdlKSB7XG4gICAgICAgIHZhciBjYWxsYmFja3MgPSBmcmFnbWVudFtDQUxMQkFDS1NdO1xuICAgICAgICBjYWxsYmFja3MuZnJhbWUgPSBmcmFtZTtcbiAgICAgICAgY2FsbGJhY2tzLmVudHJ5ID0gZW50cnk7XG4gICAgICAgIGVudHJ5LmZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgICAgIGZyYWdtZW50X3RyYW5zaXRpb25zXzEuX3VwZGF0ZVRyYW5zaXRpb25zKGVudHJ5KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvdWxkIG5vdCBmaW5kIGEgcGFnZSBmb3IgXCIgKyBmcmFnbWVudFRhZyArIFwiLlwiKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzdGFydEFjdGl2aXR5KGFjdGl2aXR5LCBmcmFtZUlkKSB7XG4gICAgdmFyIGludGVudCA9IG5ldyBhbmRyb2lkLmNvbnRlbnQuSW50ZW50KGFjdGl2aXR5LCBhY3Rpdml0eS5nZXRDbGFzcygpKTtcbiAgICBpbnRlbnQuc2V0QWN0aW9uKGFuZHJvaWQuY29udGVudC5JbnRlbnQuQUNUSU9OX0RFRkFVTFQpO1xuICAgIGludGVudC5wdXRFeHRyYShJTlRFTlRfRVhUUkEsIGZyYW1lSWQpO1xuICAgIGFjdGl2aXR5LnN0YXJ0QWN0aXZpdHkoaW50ZW50KTtcbn1cbmZ1bmN0aW9uIGdldEZyYW1lQnlOdW1iZXJJZChmcmFtZUlkKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmcmFtZXNDYWNoZS5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYWxpdmVGcmFtZSA9IGZyYW1lc0NhY2hlW2ldLmdldCgpO1xuICAgICAgICBpZiAoYWxpdmVGcmFtZSAmJiBhbGl2ZUZyYW1lLmZyYW1lSWQgPT09IGZyYW1lSWQpIHtcbiAgICAgICAgICAgIHJldHVybiBhbGl2ZUZyYW1lLm93bmVyO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuZnVuY3Rpb24gZW5zdXJlRnJhZ21lbnRDbGFzcygpIHtcbiAgICBpZiAoZnJhZ21lbnRDbGFzcykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHJlcXVpcmUoXCIuL2ZyYWdtZW50XCIpO1xuICAgIGlmICghZnJhZ21lbnRDbGFzcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gaW5pdGlhbGl6ZSB0aGUgZXh0ZW5kZWQgYW5kcm9pZHguZnJhZ21lbnQuYXBwLkZyYWdtZW50IGNsYXNzXCIpO1xuICAgIH1cbn1cbnZhciBmcmFnbWVudENsYXNzO1xuZnVuY3Rpb24gc2V0RnJhZ21lbnRDbGFzcyhjbGF6eikge1xuICAgIGlmIChmcmFnbWVudENsYXNzKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZyYWdtZW50IGNsYXNzIGFscmVhZHkgaW5pdGlhbGl6ZWRcIik7XG4gICAgfVxuICAgIGZyYWdtZW50Q2xhc3MgPSBjbGF6ejtcbn1cbmV4cG9ydHMuc2V0RnJhZ21lbnRDbGFzcyA9IHNldEZyYWdtZW50Q2xhc3M7XG52YXIgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbiA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbigpIHtcbiAgICB9XG4gICAgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25IaWRkZW5DaGFuZ2VkID0gZnVuY3Rpb24gKGZyYWdtZW50LCBoaWRkZW4sIHN1cGVyRnVuYykge1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoZnJhZ21lbnQgKyBcIi5vbkhpZGRlbkNoYW5nZWQoXCIgKyBoaWRkZW4gKyBcIilcIiwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdGl2ZUxpZmVjeWNsZSk7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXJGdW5jLmNhbGwoZnJhZ21lbnQsIGhpZGRlbik7XG4gICAgfTtcbiAgICBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vbkNyZWF0ZUFuaW1hdG9yID0gZnVuY3Rpb24gKGZyYWdtZW50LCB0cmFuc2l0LCBlbnRlciwgbmV4dEFuaW0sIHN1cGVyRnVuYykge1xuICAgICAgICBpZiAoIWVudGVyICYmIGZyYWdtZW50LmdldFJlbW92aW5nUGFyZW50RnJhZ21lbnQoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHN1cGVyRnVuYy5jYWxsKGZyYWdtZW50LCB0cmFuc2l0LCBlbnRlciwgbmV4dEFuaW0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuZXh0QW5pbVN0cmluZztcbiAgICAgICAgc3dpdGNoIChuZXh0QW5pbSkge1xuICAgICAgICAgICAgY2FzZSAtMTA6XG4gICAgICAgICAgICAgICAgbmV4dEFuaW1TdHJpbmcgPSBcImVudGVyXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIC0yMDpcbiAgICAgICAgICAgICAgICBuZXh0QW5pbVN0cmluZyA9IFwiZXhpdFwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAtMzA6XG4gICAgICAgICAgICAgICAgbmV4dEFuaW1TdHJpbmcgPSBcInBvcEVudGVyXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIC00MDpcbiAgICAgICAgICAgICAgICBuZXh0QW5pbVN0cmluZyA9IFwicG9wRXhpdFwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhbmltYXRvciA9IGZyYWdtZW50X3RyYW5zaXRpb25zXzEuX29uRnJhZ21lbnRDcmVhdGVBbmltYXRvcih0aGlzLmVudHJ5LCBmcmFnbWVudCwgbmV4dEFuaW0sIGVudGVyKTtcbiAgICAgICAgaWYgKCFhbmltYXRvcikge1xuICAgICAgICAgICAgYW5pbWF0b3IgPSBzdXBlckZ1bmMuY2FsbChmcmFnbWVudCwgdHJhbnNpdCwgZW50ZXIsIG5leHRBbmltKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoZnJhZ21lbnQgKyBcIi5vbkNyZWF0ZUFuaW1hdG9yKFwiICsgdHJhbnNpdCArIFwiLCBcIiArIChlbnRlciA/IFwiZW50ZXJcIiA6IFwiZXhpdFwiKSArIFwiLCBcIiArIG5leHRBbmltU3RyaW5nICsgXCIpOiBcIiArIChhbmltYXRvciA/IFwiYW5pbWF0b3JcIiA6IFwibm8gYW5pbWF0b3JcIiksIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhbmltYXRvcjtcbiAgICB9O1xuICAgIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uQ3JlYXRlID0gZnVuY3Rpb24gKGZyYWdtZW50LCBzYXZlZEluc3RhbmNlU3RhdGUsIHN1cGVyRnVuYykge1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoZnJhZ21lbnQgKyBcIi5vbkNyZWF0ZShcIiArIHNhdmVkSW5zdGFuY2VTdGF0ZSArIFwiKVwiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlckZ1bmMuY2FsbChmcmFnbWVudCwgc2F2ZWRJbnN0YW5jZVN0YXRlKTtcbiAgICAgICAgaWYgKCF0aGlzLmVudHJ5KSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IGZyYWdtZW50LmdldEFyZ3VtZW50cygpO1xuICAgICAgICAgICAgdmFyIGZyYW1lSWQgPSBhcmdzLmdldEludChGUkFNRUlEKTtcbiAgICAgICAgICAgIHZhciBmcmFtZSA9IGdldEZyYW1lQnlOdW1iZXJJZChmcmFtZUlkKTtcbiAgICAgICAgICAgIGlmICghZnJhbWUpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBGcmFtZSBmb3IgXCIgKyBmcmFnbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5kUGFnZUZvckZyYWdtZW50KGZyYWdtZW50LCBmcmFtZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uQ3JlYXRlVmlldyA9IGZ1bmN0aW9uIChmcmFnbWVudCwgaW5mbGF0ZXIsIGNvbnRhaW5lciwgc2F2ZWRJbnN0YW5jZVN0YXRlLCBzdXBlckZ1bmMpIHtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKGZyYWdtZW50ICsgXCIub25DcmVhdGVWaWV3KGluZmxhdGVyLCBjb250YWluZXIsIFwiICsgc2F2ZWRJbnN0YW5jZVN0YXRlICsgXCIpXCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMuZW50cnk7XG4gICAgICAgIGlmICghZW50cnkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlRXJyb3IoZnJhZ21lbnQgKyBcIi5vbkNyZWF0ZVZpZXc6IGVudHJ5IGlzIG51bGwgb3IgdW5kZWZpbmVkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBhZ2UgPSBlbnRyeS5yZXNvbHZlZFBhZ2U7XG4gICAgICAgIGlmICghcGFnZSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VFcnJvcihmcmFnbWVudCArIFwiLm9uQ3JlYXRlVmlldzogZW50cnkgaGFzIG5vIHJlc29sdmVkUGFnZVwiKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmcmFtZSA9IHRoaXMuZnJhbWU7XG4gICAgICAgIGlmICghZnJhbWUpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlRXJyb3IoZnJhZ21lbnQgKyBcIi5vbkNyZWF0ZVZpZXc6IHRoaXMuZnJhbWUgaXMgbnVsbCBvciB1bmRlZmluZWRcIik7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFnZS5wYXJlbnQgPT09IGZyYW1lKSB7XG4gICAgICAgICAgICBpZiAoIXBhZ2UuX2NvbnRleHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udGV4dF8yID0gY29udGFpbmVyICYmIGNvbnRhaW5lci5nZXRDb250ZXh0KCkgfHwgaW5mbGF0ZXIgJiYgaW5mbGF0ZXIuZ2V0Q29udGV4dCgpO1xuICAgICAgICAgICAgICAgIHBhZ2UuX3NldHVwVUkoY29udGV4dF8yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICghZnJhbWUuX3N0eWxlU2NvcGUpIHtcbiAgICAgICAgICAgICAgICBwYWdlLl91cGRhdGVTdHlsZVNjb3BlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmcmFtZS5fYWRkVmlldyhwYWdlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZnJhbWUuaXNMb2FkZWQgJiYgIXBhZ2UuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHBhZ2UuY2FsbExvYWRlZCgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzYXZlZFN0YXRlID0gZW50cnkudmlld1NhdmVkU3RhdGU7XG4gICAgICAgIGlmIChzYXZlZFN0YXRlKSB7XG4gICAgICAgICAgICBwYWdlLm5hdGl2ZVZpZXdQcm90ZWN0ZWQucmVzdG9yZUhpZXJhcmNoeVN0YXRlKHNhdmVkU3RhdGUpO1xuICAgICAgICAgICAgZW50cnkudmlld1NhdmVkU3RhdGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gcGFnZS5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldyAhPSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50VmlldyA9IG5hdGl2ZVZpZXcuZ2V0UGFyZW50KCk7XG4gICAgICAgICAgICBpZiAocGFyZW50VmlldyBpbnN0YW5jZW9mIGFuZHJvaWQudmlldy5WaWV3R3JvdXApIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50Vmlldy5nZXRDaGlsZENvdW50KCkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Vmlldy5hZGRWaWV3SW5MYXlvdXQobmF0aXZlVmlldywgLTEsIG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ29tbW9uTGF5b3V0UGFyYW1zKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwYXJlbnRWaWV3LnJlbW92ZVZpZXcobmF0aXZlVmlldyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhZ2UubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICB9O1xuICAgIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uU2F2ZUluc3RhbmNlU3RhdGUgPSBmdW5jdGlvbiAoZnJhZ21lbnQsIG91dFN0YXRlLCBzdXBlckZ1bmMpIHtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKGZyYWdtZW50ICsgXCIub25TYXZlSW5zdGFuY2VTdGF0ZShcIiArIG91dFN0YXRlICsgXCIpXCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyRnVuYy5jYWxsKGZyYWdtZW50LCBvdXRTdGF0ZSk7XG4gICAgfTtcbiAgICBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vbkRlc3Ryb3lWaWV3ID0gZnVuY3Rpb24gKGZyYWdtZW50LCBzdXBlckZ1bmMpIHtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKGZyYWdtZW50ICsgXCIub25EZXN0cm95VmlldygpXCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyRnVuYy5jYWxsKGZyYWdtZW50KTtcbiAgICB9O1xuICAgIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uRGVzdHJveSA9IGZ1bmN0aW9uIChmcmFnbWVudCwgc3VwZXJGdW5jKSB7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShmcmFnbWVudCArIFwiLm9uRGVzdHJveSgpXCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyRnVuYy5jYWxsKGZyYWdtZW50KTtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy5lbnRyeTtcbiAgICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VFcnJvcihmcmFnbWVudCArIFwiLm9uRGVzdHJveTogZW50cnkgaXMgbnVsbCBvciB1bmRlZmluZWRcIik7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbnRyeS5mcmFnbWVudCA9IG51bGw7XG4gICAgICAgIHZhciBwYWdlID0gZW50cnkucmVzb2x2ZWRQYWdlO1xuICAgICAgICBpZiAoIXBhZ2UpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlRXJyb3IoZnJhZ21lbnQgKyBcIi5vbkRlc3Ryb3k6IGVudHJ5IGhhcyBubyByZXNvbHZlZFBhZ2VcIik7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25TdG9wID0gZnVuY3Rpb24gKGZyYWdtZW50LCBzdXBlckZ1bmMpIHtcbiAgICAgICAgc3VwZXJGdW5jLmNhbGwoZnJhZ21lbnQpO1xuICAgIH07XG4gICAgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUudG9TdHJpbmdPdmVycmlkZSA9IGZ1bmN0aW9uIChmcmFnbWVudCwgc3VwZXJGdW5jKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMuZW50cnk7XG4gICAgICAgIGlmIChlbnRyeSkge1xuICAgICAgICAgICAgcmV0dXJuIGVudHJ5LmZyYWdtZW50VGFnICsgXCI8XCIgKyBlbnRyeS5yZXNvbHZlZFBhZ2UgKyBcIj5cIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcIk5PIEVOVFJZLCBcIiArIHN1cGVyRnVuYy5jYWxsKGZyYWdtZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvbkhpZGRlbkNoYW5nZWRcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvbkNyZWF0ZUFuaW1hdG9yXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25DcmVhdGVcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvbkNyZWF0ZVZpZXdcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvblNhdmVJbnN0YW5jZVN0YXRlXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25EZXN0cm95Vmlld1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLCBcIm9uRGVzdHJveVwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLCBcIm9uU3RvcFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLCBcInRvU3RyaW5nT3ZlcnJpZGVcIiwgbnVsbCk7XG4gICAgcmV0dXJuIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb247XG59KCkpO1xudmFyIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24oKSB7XG4gICAgfVxuICAgIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLmdldFJvb3RWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcm9vdFZpZXc7XG4gICAgfTtcbiAgICBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vbkNyZWF0ZSA9IGZ1bmN0aW9uIChhY3Rpdml0eSwgc2F2ZWRJbnN0YW5jZVN0YXRlLCBpbnRlbnRPclN1cGVyRnVuYywgc3VwZXJGdW5jKSB7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIkFjdGl2aXR5Lm9uQ3JlYXRlKFwiICsgc2F2ZWRJbnN0YW5jZVN0YXRlICsgXCIpXCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnRlbnQgPSBzdXBlckZ1bmMgPyBpbnRlbnRPclN1cGVyRnVuYyA6IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKCFzdXBlckZ1bmMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQW5kcm9pZEFjdGl2aXR5Q2FsbGJhY2tzLm9uQ3JlYXRlKGFjdGl2aXR5OiBhbnksIHNhdmVkSW5zdGFuY2VTdGF0ZTogYW55LCBzdXBlckZ1bmM6IEZ1bmN0aW9uKSBcIiArXG4gICAgICAgICAgICAgICAgXCJpcyBkZXByZWNhdGVkLiBVc2UgQW5kcm9pZEFjdGl2aXR5Q2FsbGJhY2tzLm9uQ3JlYXRlKGFjdGl2aXR5OiBhbnksIHNhdmVkSW5zdGFuY2VTdGF0ZTogYW55LCBpbnRlbnQ6IGFueSwgc3VwZXJGdW5jOiBGdW5jdGlvbikgaW5zdGVhZC5cIik7XG4gICAgICAgICAgICBzdXBlckZ1bmMgPSBpbnRlbnRPclN1cGVyRnVuYztcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXNSZXN0YXJ0ID0gISFzYXZlZEluc3RhbmNlU3RhdGUgJiYgZXhwb3J0cy5tb2R1bGVMb2FkZWQ7XG4gICAgICAgIHN1cGVyRnVuYy5jYWxsKGFjdGl2aXR5LCBpc1Jlc3RhcnQgPyBzYXZlZEluc3RhbmNlU3RhdGUgOiBudWxsKTtcbiAgICAgICAgaWYgKHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICAgICAgdmFyIHJvb3RWaWV3SWQgPSBzYXZlZEluc3RhbmNlU3RhdGUuZ2V0SW50KFJPT1RfVklFV19JRF9FWFRSQSwgLTEpO1xuICAgICAgICAgICAgaWYgKHJvb3RWaWV3SWQgIT09IC0xICYmIGFjdGl2aXR5Um9vdFZpZXdzTWFwLmhhcyhyb290Vmlld0lkKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Jvb3RWaWV3ID0gYWN0aXZpdHlSb290Vmlld3NNYXAuZ2V0KHJvb3RWaWV3SWQpLmdldCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpbnRlbnQgJiYgaW50ZW50LmdldEFjdGlvbigpKSB7XG4gICAgICAgICAgICBhcHBsaWNhdGlvbi5hbmRyb2lkLm5vdGlmeSh7XG4gICAgICAgICAgICAgICAgZXZlbnROYW1lOiBhcHBsaWNhdGlvbi5BbmRyb2lkQXBwbGljYXRpb24uYWN0aXZpdHlOZXdJbnRlbnRFdmVudCxcbiAgICAgICAgICAgICAgICBvYmplY3Q6IGFwcGxpY2F0aW9uLmFuZHJvaWQsXG4gICAgICAgICAgICAgICAgYWN0aXZpdHk6IGFjdGl2aXR5LFxuICAgICAgICAgICAgICAgIGludGVudDogaW50ZW50XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldEFjdGl2aXR5Q29udGVudChhY3Rpdml0eSwgc2F2ZWRJbnN0YW5jZVN0YXRlLCB0cnVlKTtcbiAgICAgICAgZXhwb3J0cy5tb2R1bGVMb2FkZWQgPSB0cnVlO1xuICAgIH07XG4gICAgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25TYXZlSW5zdGFuY2VTdGF0ZSA9IGZ1bmN0aW9uIChhY3Rpdml0eSwgb3V0U3RhdGUsIHN1cGVyRnVuYykge1xuICAgICAgICBzdXBlckZ1bmMuY2FsbChhY3Rpdml0eSwgb3V0U3RhdGUpO1xuICAgICAgICB2YXIgcm9vdFZpZXcgPSB0aGlzLl9yb290VmlldztcbiAgICAgICAgaWYgKHJvb3RWaWV3IGluc3RhbmNlb2YgRnJhbWUpIHtcbiAgICAgICAgICAgIG91dFN0YXRlLnB1dEludChJTlRFTlRfRVhUUkEsIHJvb3RWaWV3LmFuZHJvaWQuZnJhbWVJZCk7XG4gICAgICAgICAgICByb290Vmlldy5fc2F2ZUZyYWdtZW50c1N0YXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgb3V0U3RhdGUucHV0SW50KFJPT1RfVklFV19JRF9FWFRSQSwgcm9vdFZpZXcuX2RvbUlkKTtcbiAgICB9O1xuICAgIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uTmV3SW50ZW50ID0gZnVuY3Rpb24gKGFjdGl2aXR5LCBpbnRlbnQsIHN1cGVyU2V0SW50ZW50RnVuYywgc3VwZXJGdW5jKSB7XG4gICAgICAgIHN1cGVyRnVuYy5jYWxsKGFjdGl2aXR5LCBpbnRlbnQpO1xuICAgICAgICBzdXBlclNldEludGVudEZ1bmMuY2FsbChhY3Rpdml0eSwgaW50ZW50KTtcbiAgICAgICAgYXBwbGljYXRpb24uYW5kcm9pZC5ub3RpZnkoe1xuICAgICAgICAgICAgZXZlbnROYW1lOiBhcHBsaWNhdGlvbi5BbmRyb2lkQXBwbGljYXRpb24uYWN0aXZpdHlOZXdJbnRlbnRFdmVudCxcbiAgICAgICAgICAgIG9iamVjdDogYXBwbGljYXRpb24uYW5kcm9pZCxcbiAgICAgICAgICAgIGFjdGl2aXR5OiBhY3Rpdml0eSxcbiAgICAgICAgICAgIGludGVudDogaW50ZW50XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25TdGFydCA9IGZ1bmN0aW9uIChhY3Rpdml0eSwgc3VwZXJGdW5jKSB7XG4gICAgICAgIHN1cGVyRnVuYy5jYWxsKGFjdGl2aXR5KTtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKFwiTmF0aXZlU2NyaXB0QWN0aXZpdHkub25TdGFydCgpO1wiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcm9vdFZpZXcgPSB0aGlzLl9yb290VmlldztcbiAgICAgICAgaWYgKHJvb3RWaWV3ICYmICFyb290Vmlldy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgcm9vdFZpZXcuY2FsbExvYWRlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vblN0b3AgPSBmdW5jdGlvbiAoYWN0aXZpdHksIHN1cGVyRnVuYykge1xuICAgICAgICBzdXBlckZ1bmMuY2FsbChhY3Rpdml0eSk7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIk5hdGl2ZVNjcmlwdEFjdGl2aXR5Lm9uU3RvcCgpO1wiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcm9vdFZpZXcgPSB0aGlzLl9yb290VmlldztcbiAgICAgICAgaWYgKHJvb3RWaWV3ICYmIHJvb3RWaWV3LmlzTG9hZGVkKSB7XG4gICAgICAgICAgICByb290Vmlldy5jYWxsVW5sb2FkZWQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25Qb3N0UmVzdW1lID0gZnVuY3Rpb24gKGFjdGl2aXR5LCBzdXBlckZ1bmMpIHtcbiAgICAgICAgc3VwZXJGdW5jLmNhbGwoYWN0aXZpdHkpO1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJOYXRpdmVTY3JpcHRBY3Rpdml0eS5vblBvc3RSZXN1bWUoKTtcIiwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdGl2ZUxpZmVjeWNsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdGl2aXR5LmlzTmF0aXZlU2NyaXB0QWN0aXZpdHkpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgICAgIGV2ZW50TmFtZTogYXBwbGljYXRpb24ucmVzdW1lRXZlbnQsXG4gICAgICAgICAgICAgICAgb2JqZWN0OiBhcHBsaWNhdGlvbi5hbmRyb2lkLFxuICAgICAgICAgICAgICAgIGFuZHJvaWQ6IGFjdGl2aXR5XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYXBwbGljYXRpb24ubm90aWZ5KGFyZ3MpO1xuICAgICAgICAgICAgYXBwbGljYXRpb24uYW5kcm9pZC5wYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25EZXN0cm95ID0gZnVuY3Rpb24gKGFjdGl2aXR5LCBzdXBlckZ1bmMpIHtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKFwiTmF0aXZlU2NyaXB0QWN0aXZpdHkub25EZXN0cm95KCk7XCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByb290VmlldyA9IHRoaXMuX3Jvb3RWaWV3O1xuICAgICAgICBpZiAocm9vdFZpZXcpIHtcbiAgICAgICAgICAgIHJvb3RWaWV3Ll90ZWFyRG93blVJKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBleGl0QXJncyA9IHsgZXZlbnROYW1lOiBhcHBsaWNhdGlvbi5leGl0RXZlbnQsIG9iamVjdDogYXBwbGljYXRpb24uYW5kcm9pZCwgYW5kcm9pZDogYWN0aXZpdHkgfTtcbiAgICAgICAgYXBwbGljYXRpb24ubm90aWZ5KGV4aXRBcmdzKTtcbiAgICAgICAgc3VwZXJGdW5jLmNhbGwoYWN0aXZpdHkpO1xuICAgIH07XG4gICAgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25CYWNrUHJlc3NlZCA9IGZ1bmN0aW9uIChhY3Rpdml0eSwgc3VwZXJGdW5jKSB7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIk5hdGl2ZVNjcmlwdEFjdGl2aXR5Lm9uQmFja1ByZXNzZWQ7XCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgZXZlbnROYW1lOiBcImFjdGl2aXR5QmFja1ByZXNzZWRcIixcbiAgICAgICAgICAgIG9iamVjdDogYXBwbGljYXRpb24uYW5kcm9pZCxcbiAgICAgICAgICAgIGFjdGl2aXR5OiBhY3Rpdml0eSxcbiAgICAgICAgICAgIGNhbmNlbDogZmFsc2UsXG4gICAgICAgIH07XG4gICAgICAgIGFwcGxpY2F0aW9uLmFuZHJvaWQubm90aWZ5KGFyZ3MpO1xuICAgICAgICBpZiAoYXJncy5jYW5jZWwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmlldyA9IHRoaXMuX3Jvb3RWaWV3O1xuICAgICAgICB2YXIgY2FsbFN1cGVyID0gZmFsc2U7XG4gICAgICAgIGlmICh2aWV3IGluc3RhbmNlb2YgRnJhbWUpIHtcbiAgICAgICAgICAgIGNhbGxTdXBlciA9ICFmcmFtZV9jb21tb25fMS5nb0JhY2soKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciB2aWV3QXJncyA9IHtcbiAgICAgICAgICAgICAgICBldmVudE5hbWU6IFwiYWN0aXZpdHlCYWNrUHJlc3NlZFwiLFxuICAgICAgICAgICAgICAgIG9iamVjdDogdmlldyxcbiAgICAgICAgICAgICAgICBhY3Rpdml0eTogYWN0aXZpdHksXG4gICAgICAgICAgICAgICAgY2FuY2VsOiBmYWxzZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2aWV3Lm5vdGlmeSh2aWV3QXJncyk7XG4gICAgICAgICAgICBpZiAoIXZpZXdBcmdzLmNhbmNlbCAmJiAhdmlldy5vbkJhY2tQcmVzc2VkKCkpIHtcbiAgICAgICAgICAgICAgICBjYWxsU3VwZXIgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChjYWxsU3VwZXIpIHtcbiAgICAgICAgICAgIHN1cGVyRnVuYy5jYWxsKGFjdGl2aXR5KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25SZXF1ZXN0UGVybWlzc2lvbnNSZXN1bHQgPSBmdW5jdGlvbiAoYWN0aXZpdHksIHJlcXVlc3RDb2RlLCBwZXJtaXNzaW9ucywgZ3JhbnRSZXN1bHRzLCBzdXBlckZ1bmMpIHtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKFwiTmF0aXZlU2NyaXB0QWN0aXZpdHkub25SZXF1ZXN0UGVybWlzc2lvbnNSZXN1bHQ7XCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIGFwcGxpY2F0aW9uLmFuZHJvaWQubm90aWZ5KHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogXCJhY3Rpdml0eVJlcXVlc3RQZXJtaXNzaW9uc1wiLFxuICAgICAgICAgICAgb2JqZWN0OiBhcHBsaWNhdGlvbi5hbmRyb2lkLFxuICAgICAgICAgICAgYWN0aXZpdHk6IGFjdGl2aXR5LFxuICAgICAgICAgICAgcmVxdWVzdENvZGU6IHJlcXVlc3RDb2RlLFxuICAgICAgICAgICAgcGVybWlzc2lvbnM6IHBlcm1pc3Npb25zLFxuICAgICAgICAgICAgZ3JhbnRSZXN1bHRzOiBncmFudFJlc3VsdHNcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vbkFjdGl2aXR5UmVzdWx0ID0gZnVuY3Rpb24gKGFjdGl2aXR5LCByZXF1ZXN0Q29kZSwgcmVzdWx0Q29kZSwgZGF0YSwgc3VwZXJGdW5jKSB7XG4gICAgICAgIHN1cGVyRnVuYy5jYWxsKGFjdGl2aXR5LCByZXF1ZXN0Q29kZSwgcmVzdWx0Q29kZSwgZGF0YSk7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIk5hdGl2ZVNjcmlwdEFjdGl2aXR5Lm9uQWN0aXZpdHlSZXN1bHQoXCIgKyByZXF1ZXN0Q29kZSArIFwiLCBcIiArIHJlc3VsdENvZGUgKyBcIiwgXCIgKyBkYXRhICsgXCIpXCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIGFwcGxpY2F0aW9uLmFuZHJvaWQubm90aWZ5KHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogXCJhY3Rpdml0eVJlc3VsdFwiLFxuICAgICAgICAgICAgb2JqZWN0OiBhcHBsaWNhdGlvbi5hbmRyb2lkLFxuICAgICAgICAgICAgYWN0aXZpdHk6IGFjdGl2aXR5LFxuICAgICAgICAgICAgcmVxdWVzdENvZGU6IHJlcXVlc3RDb2RlLFxuICAgICAgICAgICAgcmVzdWx0Q29kZTogcmVzdWx0Q29kZSxcbiAgICAgICAgICAgIGludGVudDogZGF0YVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLnJlc2V0QWN0aXZpdHlDb250ZW50ID0gZnVuY3Rpb24gKGFjdGl2aXR5KSB7XG4gICAgICAgIGlmICh0aGlzLl9yb290Vmlldykge1xuICAgICAgICAgICAgdmFyIG1hbmFnZXIgPSB0aGlzLl9yb290Vmlldy5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgICAgICBtYW5hZ2VyLmV4ZWN1dGVQZW5kaW5nVHJhbnNhY3Rpb25zKCk7XG4gICAgICAgICAgICB0aGlzLl9yb290Vmlldy5fb25Sb290Vmlld1Jlc2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcm9vdFZpZXcgPSBudWxsO1xuICAgICAgICB0aGlzLnNldEFjdGl2aXR5Q29udGVudChhY3Rpdml0eSwgbnVsbCwgZmFsc2UpO1xuICAgICAgICB0aGlzLl9yb290Vmlldy5jYWxsTG9hZGVkKCk7XG4gICAgfTtcbiAgICBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5zZXRBY3Rpdml0eUNvbnRlbnQgPSBmdW5jdGlvbiAoYWN0aXZpdHksIHNhdmVkSW5zdGFuY2VTdGF0ZSwgZmlyZUxhdW5jaEV2ZW50KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBzaG91bGRDcmVhdGVSb290RnJhbWUgPSBhcHBsaWNhdGlvbi5fc2hvdWxkQ3JlYXRlUm9vdEZyYW1lKCk7XG4gICAgICAgIHZhciByb290VmlldyA9IHRoaXMuX3Jvb3RWaWV3O1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJGcmFtZS5zZXRBY3Rpdml0eUNvbnRlbnQgcm9vdFZpZXc6IFwiICsgcm9vdFZpZXcgKyBcIiBzaG91bGRDcmVhdGVSb290RnJhbWU6IFwiICsgc2hvdWxkQ3JlYXRlUm9vdEZyYW1lICsgXCIgZmlyZUxhdW5jaEV2ZW50OiBcIiArIGZpcmVMYXVuY2hFdmVudCwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdGl2ZUxpZmVjeWNsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFyb290Vmlldykge1xuICAgICAgICAgICAgdmFyIG1haW5FbnRyeSA9IGFwcGxpY2F0aW9uLmdldE1haW5FbnRyeSgpO1xuICAgICAgICAgICAgdmFyIGludGVudCA9IGFjdGl2aXR5LmdldEludGVudCgpO1xuICAgICAgICAgICAgaWYgKGZpcmVMYXVuY2hFdmVudCkge1xuICAgICAgICAgICAgICAgIHJvb3RWaWV3ID0gbm90aWZ5TGF1bmNoKGludGVudCwgc2F2ZWRJbnN0YW5jZVN0YXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghcm9vdFZpZXcpIHtcbiAgICAgICAgICAgICAgICBpZiAoIW1haW5FbnRyeSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNYWluIGVudHJ5IGlzIG1pc3NpbmcuIEFwcCBjYW5ub3QgYmUgc3RhcnRlZC4gVmVyaWZ5IGFwcCBib290c3RyYXAuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2hvdWxkQ3JlYXRlUm9vdEZyYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBleHRyYXMgPSBpbnRlbnQuZ2V0RXh0cmFzKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmcmFtZUlkID0gLTE7XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHRyYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lSWQgPSBleHRyYXMuZ2V0SW50KElOVEVOVF9FWFRSQSwgLTEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzYXZlZEluc3RhbmNlU3RhdGUgJiYgZnJhbWVJZCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lSWQgPSBzYXZlZEluc3RhbmNlU3RhdGUuZ2V0SW50KElOVEVOVF9FWFRSQSwgLTEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghcm9vdFZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3RWaWV3ID0gZ2V0RnJhbWVCeU51bWJlcklkKGZyYW1lSWQpIHx8IG5ldyBGcmFtZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChyb290VmlldyBpbnN0YW5jZW9mIEZyYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByb290Vmlldy5uYXZpZ2F0ZShtYWluRW50cnkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQSBGcmFtZSBtdXN0IGJlIHVzZWQgdG8gbmF2aWdhdGUgdG8gYSBQYWdlLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcm9vdFZpZXcgPSBidWlsZGVyXzEuY3JlYXRlVmlld0Zyb21FbnRyeShtYWluRW50cnkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3Jvb3RWaWV3ID0gcm9vdFZpZXc7XG4gICAgICAgICAgICBhY3Rpdml0eVJvb3RWaWV3c01hcC5zZXQocm9vdFZpZXcuX2RvbUlkLCBuZXcgV2Vha1JlZihyb290VmlldykpO1xuICAgICAgICAgICAgdmFyIGRldmljZVR5cGUgPSBwbGF0Zm9ybV8xLmRldmljZS5kZXZpY2VUeXBlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBzeXN0ZW1fY2xhc3Nlc18xLnB1c2hUb1Jvb3RWaWV3Q3NzQ2xhc3NlcyhcIlwiICsgc3lzdGVtX2NsYXNzZXNfMS5DTEFTU19QUkVGSVggKyBBTkRST0lEX1BMQVRGT1JNKTtcbiAgICAgICAgICAgIHN5c3RlbV9jbGFzc2VzXzEucHVzaFRvUm9vdFZpZXdDc3NDbGFzc2VzKFwiXCIgKyBzeXN0ZW1fY2xhc3Nlc18xLkNMQVNTX1BSRUZJWCArIGRldmljZVR5cGUpO1xuICAgICAgICAgICAgc3lzdGVtX2NsYXNzZXNfMS5wdXNoVG9Sb290Vmlld0Nzc0NsYXNzZXMoXCJcIiArIHN5c3RlbV9jbGFzc2VzXzEuQ0xBU1NfUFJFRklYICsgYXBwbGljYXRpb24uYW5kcm9pZC5vcmllbnRhdGlvbik7XG4gICAgICAgICAgICB2YXIgcm9vdFZpZXdDc3NDbGFzc2VzID0gc3lzdGVtX2NsYXNzZXNfMS5nZXRSb290Vmlld0Nzc0NsYXNzZXMoKTtcbiAgICAgICAgICAgIHJvb3RWaWV3Q3NzQ2xhc3Nlcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7IHJldHVybiBfdGhpcy5fcm9vdFZpZXcuY3NzQ2xhc3Nlcy5hZGQoYyk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzaG91bGRDcmVhdGVSb290RnJhbWUpIHtcbiAgICAgICAgICAgIHJvb3RWaWV3Ll9zZXR1cFVJKGFjdGl2aXR5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJvb3RWaWV3Ll9zZXR1cEFzUm9vdFZpZXcoYWN0aXZpdHkpO1xuICAgICAgICB9XG4gICAgICAgIGFjdGl2aXR5LnNldENvbnRlbnRWaWV3KHJvb3RWaWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ29tbW9uTGF5b3V0UGFyYW1zKCkpO1xuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvbkNyZWF0ZVwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLCBcIm9uU2F2ZUluc3RhbmNlU3RhdGVcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvbk5ld0ludGVudFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLCBcIm9uU3RhcnRcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvblN0b3BcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvblBvc3RSZXN1bWVcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvbkRlc3Ryb3lcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvbkJhY2tQcmVzc2VkXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25SZXF1ZXN0UGVybWlzc2lvbnNSZXN1bHRcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvbkFjdGl2aXR5UmVzdWx0XCIsIG51bGwpO1xuICAgIHJldHVybiBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uO1xufSgpKTtcbnZhciBub3RpZnlMYXVuY2ggPSBwcm9maWxpbmdfMS5wcm9maWxlKFwibm90aWZ5TGF1bmNoXCIsIGZ1bmN0aW9uIG5vdGlmeUxhdW5jaChpbnRlbnQsIHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgIHZhciBsYXVuY2hBcmdzID0ge1xuICAgICAgICBldmVudE5hbWU6IGFwcGxpY2F0aW9uLmxhdW5jaEV2ZW50LFxuICAgICAgICBvYmplY3Q6IGFwcGxpY2F0aW9uLmFuZHJvaWQsXG4gICAgICAgIGFuZHJvaWQ6IGludGVudCwgc2F2ZWRJbnN0YW5jZVN0YXRlOiBzYXZlZEluc3RhbmNlU3RhdGVcbiAgICB9O1xuICAgIGFwcGxpY2F0aW9uLm5vdGlmeShsYXVuY2hBcmdzKTtcbiAgICBhcHBsaWNhdGlvbi5ub3RpZnkoeyBldmVudE5hbWU6IFwibG9hZEFwcENzc1wiLCBvYmplY3Q6IHRoaXMsIGNzc0ZpbGU6IGFwcGxpY2F0aW9uLmdldENzc0ZpbGVOYW1lKCkgfSk7XG4gICAgcmV0dXJuIGxhdW5jaEFyZ3Mucm9vdDtcbn0pO1xuZnVuY3Rpb24gc2V0QWN0aXZpdHlDYWxsYmFja3MoYWN0aXZpdHkpIHtcbiAgICBhY3Rpdml0eVtDQUxMQkFDS1NdID0gbmV3IEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24oKTtcbn1cbmV4cG9ydHMuc2V0QWN0aXZpdHlDYWxsYmFja3MgPSBzZXRBY3Rpdml0eUNhbGxiYWNrcztcbmZ1bmN0aW9uIHNldEZyYWdtZW50Q2FsbGJhY2tzKGZyYWdtZW50KSB7XG4gICAgZnJhZ21lbnRbQ0FMTEJBQ0tTXSA9IG5ldyBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uKCk7XG59XG5leHBvcnRzLnNldEZyYWdtZW50Q2FsbGJhY2tzID0gc2V0RnJhZ21lbnRDYWxsYmFja3M7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mcmFtZS5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBHZXN0dXJlVHlwZXM7XG4oZnVuY3Rpb24gKEdlc3R1cmVUeXBlcykge1xuICAgIEdlc3R1cmVUeXBlc1tHZXN0dXJlVHlwZXNbXCJ0YXBcIl0gPSAxXSA9IFwidGFwXCI7XG4gICAgR2VzdHVyZVR5cGVzW0dlc3R1cmVUeXBlc1tcImRvdWJsZVRhcFwiXSA9IDJdID0gXCJkb3VibGVUYXBcIjtcbiAgICBHZXN0dXJlVHlwZXNbR2VzdHVyZVR5cGVzW1wicGluY2hcIl0gPSA0XSA9IFwicGluY2hcIjtcbiAgICBHZXN0dXJlVHlwZXNbR2VzdHVyZVR5cGVzW1wicGFuXCJdID0gOF0gPSBcInBhblwiO1xuICAgIEdlc3R1cmVUeXBlc1tHZXN0dXJlVHlwZXNbXCJzd2lwZVwiXSA9IDE2XSA9IFwic3dpcGVcIjtcbiAgICBHZXN0dXJlVHlwZXNbR2VzdHVyZVR5cGVzW1wicm90YXRpb25cIl0gPSAzMl0gPSBcInJvdGF0aW9uXCI7XG4gICAgR2VzdHVyZVR5cGVzW0dlc3R1cmVUeXBlc1tcImxvbmdQcmVzc1wiXSA9IDY0XSA9IFwibG9uZ1ByZXNzXCI7XG4gICAgR2VzdHVyZVR5cGVzW0dlc3R1cmVUeXBlc1tcInRvdWNoXCJdID0gMTI4XSA9IFwidG91Y2hcIjtcbn0pKEdlc3R1cmVUeXBlcyA9IGV4cG9ydHMuR2VzdHVyZVR5cGVzIHx8IChleHBvcnRzLkdlc3R1cmVUeXBlcyA9IHt9KSk7XG52YXIgR2VzdHVyZVN0YXRlVHlwZXM7XG4oZnVuY3Rpb24gKEdlc3R1cmVTdGF0ZVR5cGVzKSB7XG4gICAgR2VzdHVyZVN0YXRlVHlwZXNbR2VzdHVyZVN0YXRlVHlwZXNbXCJjYW5jZWxsZWRcIl0gPSAwXSA9IFwiY2FuY2VsbGVkXCI7XG4gICAgR2VzdHVyZVN0YXRlVHlwZXNbR2VzdHVyZVN0YXRlVHlwZXNbXCJiZWdhblwiXSA9IDFdID0gXCJiZWdhblwiO1xuICAgIEdlc3R1cmVTdGF0ZVR5cGVzW0dlc3R1cmVTdGF0ZVR5cGVzW1wiY2hhbmdlZFwiXSA9IDJdID0gXCJjaGFuZ2VkXCI7XG4gICAgR2VzdHVyZVN0YXRlVHlwZXNbR2VzdHVyZVN0YXRlVHlwZXNbXCJlbmRlZFwiXSA9IDNdID0gXCJlbmRlZFwiO1xufSkoR2VzdHVyZVN0YXRlVHlwZXMgPSBleHBvcnRzLkdlc3R1cmVTdGF0ZVR5cGVzIHx8IChleHBvcnRzLkdlc3R1cmVTdGF0ZVR5cGVzID0ge30pKTtcbnZhciBTd2lwZURpcmVjdGlvbjtcbihmdW5jdGlvbiAoU3dpcGVEaXJlY3Rpb24pIHtcbiAgICBTd2lwZURpcmVjdGlvbltTd2lwZURpcmVjdGlvbltcInJpZ2h0XCJdID0gMV0gPSBcInJpZ2h0XCI7XG4gICAgU3dpcGVEaXJlY3Rpb25bU3dpcGVEaXJlY3Rpb25bXCJsZWZ0XCJdID0gMl0gPSBcImxlZnRcIjtcbiAgICBTd2lwZURpcmVjdGlvbltTd2lwZURpcmVjdGlvbltcInVwXCJdID0gNF0gPSBcInVwXCI7XG4gICAgU3dpcGVEaXJlY3Rpb25bU3dpcGVEaXJlY3Rpb25bXCJkb3duXCJdID0gOF0gPSBcImRvd25cIjtcbn0pKFN3aXBlRGlyZWN0aW9uID0gZXhwb3J0cy5Td2lwZURpcmVjdGlvbiB8fCAoZXhwb3J0cy5Td2lwZURpcmVjdGlvbiA9IHt9KSk7XG52YXIgVG91Y2hBY3Rpb247XG4oZnVuY3Rpb24gKFRvdWNoQWN0aW9uKSB7XG4gICAgVG91Y2hBY3Rpb24uZG93biA9IFwiZG93blwiO1xuICAgIFRvdWNoQWN0aW9uLnVwID0gXCJ1cFwiO1xuICAgIFRvdWNoQWN0aW9uLm1vdmUgPSBcIm1vdmVcIjtcbiAgICBUb3VjaEFjdGlvbi5jYW5jZWwgPSBcImNhbmNlbFwiO1xufSkoVG91Y2hBY3Rpb24gPSBleHBvcnRzLlRvdWNoQWN0aW9uIHx8IChleHBvcnRzLlRvdWNoQWN0aW9uID0ge30pKTtcbmZ1bmN0aW9uIHRvU3RyaW5nKHR5cGUsIHNlcGFyYXRvcikge1xuICAgIHZhciB0eXBlcyA9IG5ldyBBcnJheSgpO1xuICAgIGlmICh0eXBlICYgR2VzdHVyZVR5cGVzLnRhcCkge1xuICAgICAgICB0eXBlcy5wdXNoKFwidGFwXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZSAmIEdlc3R1cmVUeXBlcy5kb3VibGVUYXApIHtcbiAgICAgICAgdHlwZXMucHVzaChcImRvdWJsZVRhcFwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgJiBHZXN0dXJlVHlwZXMucGluY2gpIHtcbiAgICAgICAgdHlwZXMucHVzaChcInBpbmNoXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZSAmIEdlc3R1cmVUeXBlcy5wYW4pIHtcbiAgICAgICAgdHlwZXMucHVzaChcInBhblwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgJiBHZXN0dXJlVHlwZXMuc3dpcGUpIHtcbiAgICAgICAgdHlwZXMucHVzaChcInN3aXBlXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZSAmIEdlc3R1cmVUeXBlcy5yb3RhdGlvbikge1xuICAgICAgICB0eXBlcy5wdXNoKFwicm90YXRpb25cIik7XG4gICAgfVxuICAgIGlmICh0eXBlICYgR2VzdHVyZVR5cGVzLmxvbmdQcmVzcykge1xuICAgICAgICB0eXBlcy5wdXNoKFwibG9uZ1ByZXNzXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZSAmIEdlc3R1cmVUeXBlcy50b3VjaCkge1xuICAgICAgICB0eXBlcy5wdXNoKFwidG91Y2hcIik7XG4gICAgfVxuICAgIHJldHVybiB0eXBlcy5qb2luKHNlcGFyYXRvcik7XG59XG5leHBvcnRzLnRvU3RyaW5nID0gdG9TdHJpbmc7XG5mdW5jdGlvbiBmcm9tU3RyaW5nKHR5cGUpIHtcbiAgICB2YXIgdCA9IHR5cGUudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKHQgPT09IFwidGFwXCIpIHtcbiAgICAgICAgcmV0dXJuIEdlc3R1cmVUeXBlcy50YXA7XG4gICAgfVxuICAgIGVsc2UgaWYgKHQgPT09IFwiZG91YmxldGFwXCIpIHtcbiAgICAgICAgcmV0dXJuIEdlc3R1cmVUeXBlcy5kb3VibGVUYXA7XG4gICAgfVxuICAgIGVsc2UgaWYgKHQgPT09IFwicGluY2hcIikge1xuICAgICAgICByZXR1cm4gR2VzdHVyZVR5cGVzLnBpbmNoO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ID09PSBcInBhblwiKSB7XG4gICAgICAgIHJldHVybiBHZXN0dXJlVHlwZXMucGFuO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ID09PSBcInN3aXBlXCIpIHtcbiAgICAgICAgcmV0dXJuIEdlc3R1cmVUeXBlcy5zd2lwZTtcbiAgICB9XG4gICAgZWxzZSBpZiAodCA9PT0gXCJyb3RhdGlvblwiKSB7XG4gICAgICAgIHJldHVybiBHZXN0dXJlVHlwZXMucm90YXRpb247XG4gICAgfVxuICAgIGVsc2UgaWYgKHQgPT09IFwibG9uZ3ByZXNzXCIpIHtcbiAgICAgICAgcmV0dXJuIEdlc3R1cmVUeXBlcy5sb25nUHJlc3M7XG4gICAgfVxuICAgIGVsc2UgaWYgKHQgPT09IFwidG91Y2hcIikge1xuICAgICAgICByZXR1cm4gR2VzdHVyZVR5cGVzLnRvdWNoO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuZXhwb3J0cy5mcm9tU3RyaW5nID0gZnJvbVN0cmluZztcbnZhciBHZXN0dXJlc09ic2VydmVyQmFzZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gR2VzdHVyZXNPYnNlcnZlckJhc2UodGFyZ2V0LCBjYWxsYmFjaywgY29udGV4dCkge1xuICAgICAgICB0aGlzLl90YXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgICAgIHRoaXMuX2NvbnRleHQgPSBjb250ZXh0O1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VzdHVyZXNPYnNlcnZlckJhc2UucHJvdG90eXBlLCBcImNhbGxiYWNrXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY2FsbGJhY2s7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShHZXN0dXJlc09ic2VydmVyQmFzZS5wcm90b3R5cGUsIFwidGFyZ2V0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGFyZ2V0O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VzdHVyZXNPYnNlcnZlckJhc2UucHJvdG90eXBlLCBcImNvbnRleHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBHZXN0dXJlc09ic2VydmVyQmFzZS5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudGFyZ2V0KSB7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMudGFyZ2V0LmdldEdlc3R1cmVPYnNlcnZlcnModGhpcy50eXBlKTtcbiAgICAgICAgICAgIGlmIChsaXN0ICYmIGxpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobGlzdFtpXS5jYWxsYmFjayA9PT0gdGhpcy5jYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGlzdC5sZW5ndGggPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0Ll9nZXN0dXJlT2JzZXJ2ZXJzW3RoaXMudHlwZV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMudGFyZ2V0Ll9nZXN0dXJlT2JzZXJ2ZXJzW3RoaXMudHlwZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBudWxsO1xuICAgICAgICB0aGlzLl9jb250ZXh0ID0gbnVsbDtcbiAgICB9O1xuICAgIHJldHVybiBHZXN0dXJlc09ic2VydmVyQmFzZTtcbn0oKSk7XG5leHBvcnRzLkdlc3R1cmVzT2JzZXJ2ZXJCYXNlID0gR2VzdHVyZXNPYnNlcnZlckJhc2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1nZXN0dXJlcy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBnZXN0dXJlc19jb21tb25fMSA9IHJlcXVpcmUoXCIuL2dlc3R1cmVzLWNvbW1vblwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3V0aWxzXCIpO1xudmFyIHRpbWVyID0gcmVxdWlyZShcIi4uLy4uL3RpbWVyXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vZ2VzdHVyZXMtY29tbW9uXCIpKTtcbnZhciBUYXBBbmREb3VibGVUYXBHZXN0dXJlTGlzdGVuZXI7XG5mdW5jdGlvbiBpbml0aWFsaXplVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVyKCkge1xuICAgIGlmIChUYXBBbmREb3VibGVUYXBHZXN0dXJlTGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhUYXBBbmREb3VibGVUYXBHZXN0dXJlTGlzdGVuZXJJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBUYXBBbmREb3VibGVUYXBHZXN0dXJlTGlzdGVuZXJJbXBsKG9ic2VydmVyLCB0YXJnZXQsIHR5cGUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5fbGFzdFVwVGltZSA9IDA7XG4gICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICAgICAgICAgIF90aGlzLl90YXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgICAgICBfdGhpcy5fdHlwZSA9IHR5cGU7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBUYXBBbmREb3VibGVUYXBHZXN0dXJlTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblNpbmdsZVRhcFVwID0gZnVuY3Rpb24gKG1vdGlvbkV2ZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVTaW5nbGVUYXAobW90aW9uRXZlbnQpO1xuICAgICAgICAgICAgdGhpcy5fbGFzdFVwVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVySW1wbC5wcm90b3R5cGUub25Eb3duID0gZnVuY3Rpb24gKG1vdGlvbkV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgdGFwVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBpZiAoKHRhcFRpbWUgLSB0aGlzLl9sYXN0VXBUaW1lKSA8PSBUYXBBbmREb3VibGVUYXBHZXN0dXJlTGlzdGVuZXJJbXBsLkRvdWJsZVRhcFRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVEb3VibGVUYXAobW90aW9uRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIFRhcEFuZERvdWJsZVRhcEdlc3R1cmVMaXN0ZW5lckltcGwucHJvdG90eXBlLm9uTG9uZ1ByZXNzID0gZnVuY3Rpb24gKG1vdGlvbkV2ZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fdHlwZSAmIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5sb25nUHJlc3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IF9nZXRBcmdzKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5sb25nUHJlc3MsIHRoaXMuX3RhcmdldCwgbW90aW9uRXZlbnQpO1xuICAgICAgICAgICAgICAgIF9leGVjdXRlQ2FsbGJhY2sodGhpcy5fb2JzZXJ2ZXIsIGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBUYXBBbmREb3VibGVUYXBHZXN0dXJlTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5faGFuZGxlU2luZ2xlVGFwID0gZnVuY3Rpb24gKG1vdGlvbkV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKHRoaXMuX3RhcmdldC5nZXRHZXN0dXJlT2JzZXJ2ZXJzKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5kb3VibGVUYXApKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGFwVGltZW91dElkID0gdGltZXIuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5fdHlwZSAmIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy50YXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gX2dldEFyZ3MoZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnRhcCwgX3RoaXMuX3RhcmdldCwgbW90aW9uRXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2V4ZWN1dGVDYWxsYmFjayhfdGhpcy5fb2JzZXJ2ZXIsIGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRpbWVyLmNsZWFyVGltZW91dChfdGhpcy5fdGFwVGltZW91dElkKTtcbiAgICAgICAgICAgICAgICB9LCBUYXBBbmREb3VibGVUYXBHZXN0dXJlTGlzdGVuZXJJbXBsLkRvdWJsZVRhcFRpbWVvdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3R5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMudGFwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gX2dldEFyZ3MoZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnRhcCwgdGhpcy5fdGFyZ2V0LCBtb3Rpb25FdmVudCk7XG4gICAgICAgICAgICAgICAgICAgIF9leGVjdXRlQ2FsbGJhY2sodGhpcy5fb2JzZXJ2ZXIsIGFyZ3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVySW1wbC5wcm90b3R5cGUuX2hhbmRsZURvdWJsZVRhcCA9IGZ1bmN0aW9uIChtb3Rpb25FdmVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3RhcFRpbWVvdXRJZCkge1xuICAgICAgICAgICAgICAgIHRpbWVyLmNsZWFyVGltZW91dCh0aGlzLl90YXBUaW1lb3V0SWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3R5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuZG91YmxlVGFwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBfZ2V0QXJncyhnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuZG91YmxlVGFwLCB0aGlzLl90YXJnZXQsIG1vdGlvbkV2ZW50KTtcbiAgICAgICAgICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMuX29ic2VydmVyLCBhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVySW1wbC5Eb3VibGVUYXBUaW1lb3V0ID0gYW5kcm9pZC52aWV3LlZpZXdDb25maWd1cmF0aW9uLmdldERvdWJsZVRhcFRpbWVvdXQoKTtcbiAgICAgICAgcmV0dXJuIFRhcEFuZERvdWJsZVRhcEdlc3R1cmVMaXN0ZW5lckltcGw7XG4gICAgfShhbmRyb2lkLnZpZXcuR2VzdHVyZURldGVjdG9yLlNpbXBsZU9uR2VzdHVyZUxpc3RlbmVyKSk7XG4gICAgVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVyID0gVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVySW1wbDtcbn1cbnZhciBQaW5jaEdlc3R1cmVMaXN0ZW5lcjtcbmZ1bmN0aW9uIGluaXRpYWxpemVQaW5jaEdlc3R1cmVMaXN0ZW5lcigpIHtcbiAgICBpZiAoUGluY2hHZXN0dXJlTGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgUGluY2hHZXN0dXJlTGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFBpbmNoR2VzdHVyZUxpc3RlbmVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gUGluY2hHZXN0dXJlTGlzdGVuZXJJbXBsKG9ic2VydmVyLCB0YXJnZXQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICAgICAgICAgIF90aGlzLl90YXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBQaW5jaEdlc3R1cmVMaXN0ZW5lckltcGwucHJvdG90eXBlLm9uU2NhbGVCZWdpbiA9IGZ1bmN0aW9uIChkZXRlY3Rvcikge1xuICAgICAgICAgICAgdGhpcy5fc2NhbGUgPSBkZXRlY3Rvci5nZXRTY2FsZUZhY3RvcigpO1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBuZXcgUGluY2hHZXN0dXJlRXZlbnREYXRhKHRoaXMuX3RhcmdldCwgZGV0ZWN0b3IsIHRoaXMuX3NjYWxlLCB0aGlzLl90YXJnZXQsIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVTdGF0ZVR5cGVzLmJlZ2FuKTtcbiAgICAgICAgICAgIF9leGVjdXRlQ2FsbGJhY2sodGhpcy5fb2JzZXJ2ZXIsIGFyZ3MpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIFBpbmNoR2VzdHVyZUxpc3RlbmVySW1wbC5wcm90b3R5cGUub25TY2FsZSA9IGZ1bmN0aW9uIChkZXRlY3Rvcikge1xuICAgICAgICAgICAgdGhpcy5fc2NhbGUgKj0gZGV0ZWN0b3IuZ2V0U2NhbGVGYWN0b3IoKTtcbiAgICAgICAgICAgIHZhciBhcmdzID0gbmV3IFBpbmNoR2VzdHVyZUV2ZW50RGF0YSh0aGlzLl90YXJnZXQsIGRldGVjdG9yLCB0aGlzLl9zY2FsZSwgdGhpcy5fdGFyZ2V0LCBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5jaGFuZ2VkKTtcbiAgICAgICAgICAgIF9leGVjdXRlQ2FsbGJhY2sodGhpcy5fb2JzZXJ2ZXIsIGFyZ3MpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIFBpbmNoR2VzdHVyZUxpc3RlbmVySW1wbC5wcm90b3R5cGUub25TY2FsZUVuZCA9IGZ1bmN0aW9uIChkZXRlY3Rvcikge1xuICAgICAgICAgICAgdGhpcy5fc2NhbGUgKj0gZGV0ZWN0b3IuZ2V0U2NhbGVGYWN0b3IoKTtcbiAgICAgICAgICAgIHZhciBhcmdzID0gbmV3IFBpbmNoR2VzdHVyZUV2ZW50RGF0YSh0aGlzLl90YXJnZXQsIGRldGVjdG9yLCB0aGlzLl9zY2FsZSwgdGhpcy5fdGFyZ2V0LCBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5lbmRlZCk7XG4gICAgICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMuX29ic2VydmVyLCBhcmdzKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFBpbmNoR2VzdHVyZUxpc3RlbmVySW1wbDtcbiAgICB9KGFuZHJvaWQudmlldy5TY2FsZUdlc3R1cmVEZXRlY3Rvci5TaW1wbGVPblNjYWxlR2VzdHVyZUxpc3RlbmVyKSk7XG4gICAgUGluY2hHZXN0dXJlTGlzdGVuZXIgPSBQaW5jaEdlc3R1cmVMaXN0ZW5lckltcGw7XG59XG52YXIgU3dpcGVHZXN0dXJlTGlzdGVuZXI7XG5mdW5jdGlvbiBpbml0aWFsaXplU3dpcGVHZXN0dXJlTGlzdGVuZXIoKSB7XG4gICAgaWYgKFN3aXBlR2VzdHVyZUxpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIFN3aXBlR2VzdHVyZUxpc3RlbmVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhTd2lwZUdlc3R1cmVMaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFN3aXBlR2VzdHVyZUxpc3RlbmVySW1wbChvYnNlcnZlciwgdGFyZ2V0KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMuX29ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgICAgICAgICBfdGhpcy5fdGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgU3dpcGVHZXN0dXJlTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vbkRvd24gPSBmdW5jdGlvbiAobW90aW9uRXZlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBTd2lwZUdlc3R1cmVMaXN0ZW5lckltcGwucHJvdG90eXBlLm9uRmxpbmcgPSBmdW5jdGlvbiAoaW5pdGlhbEV2ZW50LCBjdXJyZW50RXZlbnQsIHZlbG9jaXR5WCwgdmVsb2NpdHlZKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgYXJncztcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlbHRhWSA9IGN1cnJlbnRFdmVudC5nZXRZKCkgLSBpbml0aWFsRXZlbnQuZ2V0WSgpO1xuICAgICAgICAgICAgICAgIHZhciBkZWx0YVggPSBjdXJyZW50RXZlbnQuZ2V0WCgpIC0gaW5pdGlhbEV2ZW50LmdldFgoKTtcbiAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoZGVsdGFYKSA+IE1hdGguYWJzKGRlbHRhWSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKGRlbHRhWCkgPiBTV0lQRV9USFJFU0hPTERcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIE1hdGguYWJzKHZlbG9jaXR5WCkgPiBTV0lQRV9WRUxPQ0lUWV9USFJFU0hPTEQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWx0YVggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncyA9IF9nZXRTd2lwZUFyZ3MoZ2VzdHVyZXNfY29tbW9uXzEuU3dpcGVEaXJlY3Rpb24ucmlnaHQsIHRoaXMuX3RhcmdldCwgaW5pdGlhbEV2ZW50LCBjdXJyZW50RXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9leGVjdXRlQ2FsbGJhY2sodGhpcy5fb2JzZXJ2ZXIsIGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzID0gX2dldFN3aXBlQXJncyhnZXN0dXJlc19jb21tb25fMS5Td2lwZURpcmVjdGlvbi5sZWZ0LCB0aGlzLl90YXJnZXQsIGluaXRpYWxFdmVudCwgY3VycmVudEV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMuX29ic2VydmVyLCBhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoZGVsdGFZKSA+IFNXSVBFX1RIUkVTSE9MRFxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgTWF0aC5hYnModmVsb2NpdHlZKSA+IFNXSVBFX1ZFTE9DSVRZX1RIUkVTSE9MRCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlbHRhWSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzID0gX2dldFN3aXBlQXJncyhnZXN0dXJlc19jb21tb25fMS5Td2lwZURpcmVjdGlvbi5kb3duLCB0aGlzLl90YXJnZXQsIGluaXRpYWxFdmVudCwgY3VycmVudEV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMuX29ic2VydmVyLCBhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncyA9IF9nZXRTd2lwZUFyZ3MoZ2VzdHVyZXNfY29tbW9uXzEuU3dpcGVEaXJlY3Rpb24udXAsIHRoaXMuX3RhcmdldCwgaW5pdGlhbEV2ZW50LCBjdXJyZW50RXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9leGVjdXRlQ2FsbGJhY2sodGhpcy5fb2JzZXJ2ZXIsIGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBTd2lwZUdlc3R1cmVMaXN0ZW5lckltcGw7XG4gICAgfShhbmRyb2lkLnZpZXcuR2VzdHVyZURldGVjdG9yLlNpbXBsZU9uR2VzdHVyZUxpc3RlbmVyKSk7XG4gICAgU3dpcGVHZXN0dXJlTGlzdGVuZXIgPSBTd2lwZUdlc3R1cmVMaXN0ZW5lckltcGw7XG59XG52YXIgU1dJUEVfVEhSRVNIT0xEID0gMTAwO1xudmFyIFNXSVBFX1ZFTE9DSVRZX1RIUkVTSE9MRCA9IDEwMDtcbnZhciBJTlZBTElEX1BPSU5URVJfSUQgPSAtMTtcbnZhciBUT19ERUdSRUVTID0gKDE4MCAvIE1hdGguUEkpO1xuZnVuY3Rpb24gb2JzZXJ2ZSh0YXJnZXQsIHR5cGUsIGNhbGxiYWNrLCBjb250ZXh0KSB7XG4gICAgdmFyIG9ic2VydmVyID0gbmV3IEdlc3R1cmVzT2JzZXJ2ZXIodGFyZ2V0LCBjYWxsYmFjaywgY29udGV4dCk7XG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0eXBlKTtcbiAgICByZXR1cm4gb2JzZXJ2ZXI7XG59XG5leHBvcnRzLm9ic2VydmUgPSBvYnNlcnZlO1xudmFyIEdlc3R1cmVzT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhHZXN0dXJlc09ic2VydmVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEdlc3R1cmVzT2JzZXJ2ZXIoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgR2VzdHVyZXNPYnNlcnZlci5wcm90b3R5cGUub2JzZXJ2ZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLnRhcmdldCkge1xuICAgICAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgICAgIHRoaXMuX29uVGFyZ2V0TG9hZGVkID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5fYXR0YWNoKF90aGlzLnRhcmdldCwgdHlwZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5fb25UYXJnZXRVbmxvYWRlZCA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2RldGFjaCgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0Lm9uKFwibG9hZGVkXCIsIHRoaXMuX29uVGFyZ2V0TG9hZGVkKTtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0Lm9uKFwidW5sb2FkZWRcIiwgdGhpcy5fb25UYXJnZXRVbmxvYWRlZCk7XG4gICAgICAgICAgICBpZiAodGhpcy50YXJnZXQuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hdHRhY2godGhpcy50YXJnZXQsIHR5cGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBHZXN0dXJlc09ic2VydmVyLnByb3RvdHlwZS5kaXNjb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9kZXRhY2goKTtcbiAgICAgICAgaWYgKHRoaXMudGFyZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5vZmYoXCJsb2FkZWRcIiwgdGhpcy5fb25UYXJnZXRMb2FkZWQpO1xuICAgICAgICAgICAgdGhpcy50YXJnZXQub2ZmKFwidW5sb2FkZWRcIiwgdGhpcy5fb25UYXJnZXRVbmxvYWRlZCk7XG4gICAgICAgICAgICB0aGlzLl9vblRhcmdldExvYWRlZCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vblRhcmdldFVubG9hZGVkID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc2Nvbm5lY3QuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIEdlc3R1cmVzT2JzZXJ2ZXIucHJvdG90eXBlLl9kZXRhY2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX25vdGlmeVRvdWNoID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3NpbXBsZUdlc3R1cmVEZXRlY3RvciA9IG51bGw7XG4gICAgICAgIHRoaXMuX3NjYWxlR2VzdHVyZURldGVjdG9yID0gbnVsbDtcbiAgICAgICAgdGhpcy5fc3dpcGVHZXN0dXJlRGV0ZWN0b3IgPSBudWxsO1xuICAgICAgICB0aGlzLl9wYW5HZXN0dXJlRGV0ZWN0b3IgPSBudWxsO1xuICAgICAgICB0aGlzLl9yb3RhdGVHZXN0dXJlRGV0ZWN0b3IgPSBudWxsO1xuICAgICAgICB0aGlzLl9ldmVudERhdGEgPSBudWxsO1xuICAgIH07XG4gICAgR2VzdHVyZXNPYnNlcnZlci5wcm90b3R5cGUuX2F0dGFjaCA9IGZ1bmN0aW9uICh0YXJnZXQsIHR5cGUpIHtcbiAgICAgICAgdGhpcy5fZGV0YWNoKCk7XG4gICAgICAgIGlmICgodHlwZSAmIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy50YXApIHx8ICh0eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLmRvdWJsZVRhcCkgfHwgKHR5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMubG9uZ1ByZXNzKSkge1xuICAgICAgICAgICAgaW5pdGlhbGl6ZVRhcEFuZERvdWJsZVRhcEdlc3R1cmVMaXN0ZW5lcigpO1xuICAgICAgICAgICAgdGhpcy5fc2ltcGxlR2VzdHVyZURldGVjdG9yID0gbmV3IGFuZHJvaWR4LmNvcmUudmlldy5HZXN0dXJlRGV0ZWN0b3JDb21wYXQodGFyZ2V0Ll9jb250ZXh0LCBuZXcgVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVyKHRoaXMsIHRoaXMudGFyZ2V0LCB0eXBlKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMucGluY2gpIHtcbiAgICAgICAgICAgIGluaXRpYWxpemVQaW5jaEdlc3R1cmVMaXN0ZW5lcigpO1xuICAgICAgICAgICAgdGhpcy5fc2NhbGVHZXN0dXJlRGV0ZWN0b3IgPSBuZXcgYW5kcm9pZC52aWV3LlNjYWxlR2VzdHVyZURldGVjdG9yKHRhcmdldC5fY29udGV4dCwgbmV3IFBpbmNoR2VzdHVyZUxpc3RlbmVyKHRoaXMsIHRoaXMudGFyZ2V0KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuc3dpcGUpIHtcbiAgICAgICAgICAgIGluaXRpYWxpemVTd2lwZUdlc3R1cmVMaXN0ZW5lcigpO1xuICAgICAgICAgICAgdGhpcy5fc3dpcGVHZXN0dXJlRGV0ZWN0b3IgPSBuZXcgYW5kcm9pZHguY29yZS52aWV3Lkdlc3R1cmVEZXRlY3RvckNvbXBhdCh0YXJnZXQuX2NvbnRleHQsIG5ldyBTd2lwZUdlc3R1cmVMaXN0ZW5lcih0aGlzLCB0aGlzLnRhcmdldCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnBhbikge1xuICAgICAgICAgICAgdGhpcy5fcGFuR2VzdHVyZURldGVjdG9yID0gbmV3IEN1c3RvbVBhbkdlc3R1cmVEZXRlY3Rvcih0aGlzLCB0aGlzLnRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMucm90YXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMuX3JvdGF0ZUdlc3R1cmVEZXRlY3RvciA9IG5ldyBDdXN0b21Sb3RhdGVHZXN0dXJlRGV0ZWN0b3IodGhpcywgdGhpcy50YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnRvdWNoKSB7XG4gICAgICAgICAgICB0aGlzLl9ub3RpZnlUb3VjaCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdlc3R1cmVzT2JzZXJ2ZXIucHJvdG90eXBlLmFuZHJvaWRPblRvdWNoRXZlbnQgPSBmdW5jdGlvbiAobW90aW9uRXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuX25vdGlmeVRvdWNoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2V2ZW50RGF0YSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2V2ZW50RGF0YSA9IG5ldyBUb3VjaEdlc3R1cmVFdmVudERhdGEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2V2ZW50RGF0YS5wcmVwYXJlKHRoaXMudGFyZ2V0LCBtb3Rpb25FdmVudCk7XG4gICAgICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMsIHRoaXMuX2V2ZW50RGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3NpbXBsZUdlc3R1cmVEZXRlY3Rvcikge1xuICAgICAgICAgICAgdGhpcy5fc2ltcGxlR2VzdHVyZURldGVjdG9yLm9uVG91Y2hFdmVudChtb3Rpb25FdmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3NjYWxlR2VzdHVyZURldGVjdG9yKSB7XG4gICAgICAgICAgICB0aGlzLl9zY2FsZUdlc3R1cmVEZXRlY3Rvci5vblRvdWNoRXZlbnQobW90aW9uRXZlbnQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9zd2lwZUdlc3R1cmVEZXRlY3Rvcikge1xuICAgICAgICAgICAgdGhpcy5fc3dpcGVHZXN0dXJlRGV0ZWN0b3Iub25Ub3VjaEV2ZW50KG1vdGlvbkV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fcGFuR2VzdHVyZURldGVjdG9yKSB7XG4gICAgICAgICAgICB0aGlzLl9wYW5HZXN0dXJlRGV0ZWN0b3Iub25Ub3VjaEV2ZW50KG1vdGlvbkV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fcm90YXRlR2VzdHVyZURldGVjdG9yKSB7XG4gICAgICAgICAgICB0aGlzLl9yb3RhdGVHZXN0dXJlRGV0ZWN0b3Iub25Ub3VjaEV2ZW50KG1vdGlvbkV2ZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEdlc3R1cmVzT2JzZXJ2ZXI7XG59KGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVzT2JzZXJ2ZXJCYXNlKSk7XG5leHBvcnRzLkdlc3R1cmVzT2JzZXJ2ZXIgPSBHZXN0dXJlc09ic2VydmVyO1xuZnVuY3Rpb24gX2dldEFyZ3ModHlwZSwgdmlldywgZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgIHZpZXc6IHZpZXcsXG4gICAgICAgIGFuZHJvaWQ6IGUsXG4gICAgICAgIGlvczogdW5kZWZpbmVkLFxuICAgICAgICBvYmplY3Q6IHZpZXcsXG4gICAgICAgIGV2ZW50TmFtZTogZ2VzdHVyZXNfY29tbW9uXzEudG9TdHJpbmcodHlwZSksXG4gICAgfTtcbn1cbmZ1bmN0aW9uIF9nZXRTd2lwZUFyZ3MoZGlyZWN0aW9uLCB2aWV3LCBpbml0aWFsRXZlbnQsIGN1cnJlbnRFdmVudCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5zd2lwZSxcbiAgICAgICAgdmlldzogdmlldyxcbiAgICAgICAgYW5kcm9pZDogeyBpbml0aWFsOiBpbml0aWFsRXZlbnQsIGN1cnJlbnQ6IGN1cnJlbnRFdmVudCB9LFxuICAgICAgICBkaXJlY3Rpb246IGRpcmVjdGlvbixcbiAgICAgICAgaW9zOiB1bmRlZmluZWQsXG4gICAgICAgIG9iamVjdDogdmlldyxcbiAgICAgICAgZXZlbnROYW1lOiBnZXN0dXJlc19jb21tb25fMS50b1N0cmluZyhnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuc3dpcGUpLFxuICAgIH07XG59XG5mdW5jdGlvbiBfZ2V0UGFuQXJncyhkZWx0YVgsIGRlbHRhWSwgdmlldywgc3RhdGUsIGluaXRpYWxFdmVudCwgY3VycmVudEV2ZW50KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnBhbixcbiAgICAgICAgdmlldzogdmlldyxcbiAgICAgICAgYW5kcm9pZDogeyBpbml0aWFsOiBpbml0aWFsRXZlbnQsIGN1cnJlbnQ6IGN1cnJlbnRFdmVudCB9LFxuICAgICAgICBkZWx0YVg6IGRlbHRhWCxcbiAgICAgICAgZGVsdGFZOiBkZWx0YVksXG4gICAgICAgIGlvczogdW5kZWZpbmVkLFxuICAgICAgICBvYmplY3Q6IHZpZXcsXG4gICAgICAgIGV2ZW50TmFtZTogZ2VzdHVyZXNfY29tbW9uXzEudG9TdHJpbmcoZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnBhbiksXG4gICAgICAgIHN0YXRlOiBzdGF0ZVxuICAgIH07XG59XG5mdW5jdGlvbiBfZXhlY3V0ZUNhbGxiYWNrKG9ic2VydmVyLCBhcmdzKSB7XG4gICAgaWYgKG9ic2VydmVyICYmIG9ic2VydmVyLmNhbGxiYWNrKSB7XG4gICAgICAgIG9ic2VydmVyLmNhbGxiYWNrLmNhbGwob2JzZXJ2ZXIuX2NvbnRleHQsIGFyZ3MpO1xuICAgIH1cbn1cbnZhciBQaW5jaEdlc3R1cmVFdmVudERhdGEgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFBpbmNoR2VzdHVyZUV2ZW50RGF0YSh2aWV3LCBhbmRyb2lkLCBzY2FsZSwgb2JqZWN0LCBzdGF0ZSkge1xuICAgICAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgICAgICB0aGlzLmFuZHJvaWQgPSBhbmRyb2lkO1xuICAgICAgICB0aGlzLnNjYWxlID0gc2NhbGU7XG4gICAgICAgIHRoaXMub2JqZWN0ID0gb2JqZWN0O1xuICAgICAgICB0aGlzLnN0YXRlID0gc3RhdGU7XG4gICAgICAgIHRoaXMudHlwZSA9IGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5waW5jaDtcbiAgICAgICAgdGhpcy5ldmVudE5hbWUgPSBnZXN0dXJlc19jb21tb25fMS50b1N0cmluZyhnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMucGluY2gpO1xuICAgIH1cbiAgICBQaW5jaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldEZvY3VzWCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYW5kcm9pZC5nZXRGb2N1c1goKSAvIHV0aWxzXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgfTtcbiAgICBQaW5jaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldEZvY3VzWSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYW5kcm9pZC5nZXRGb2N1c1koKSAvIHV0aWxzXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgfTtcbiAgICByZXR1cm4gUGluY2hHZXN0dXJlRXZlbnREYXRhO1xufSgpKTtcbnZhciBDdXN0b21QYW5HZXN0dXJlRGV0ZWN0b3IgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEN1c3RvbVBhbkdlc3R1cmVEZXRlY3RvcihvYnNlcnZlciwgdGFyZ2V0KSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgIHRoaXMuaXNUcmFja2luZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRlbnNpdHkgPSB1dGlsc18xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgIH1cbiAgICBDdXN0b21QYW5HZXN0dXJlRGV0ZWN0b3IucHJvdG90eXBlLm9uVG91Y2hFdmVudCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBzd2l0Y2ggKGV2ZW50LmdldEFjdGlvbk1hc2tlZCgpKSB7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fVVA6XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fQ0FOQ0VMOlxuICAgICAgICAgICAgICAgIHRoaXMudHJhY2tTdG9wKGV2ZW50LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fRE9XTjpcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3Lk1vdGlvbkV2ZW50LkFDVElPTl9QT0lOVEVSX0RPV046XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fUE9JTlRFUl9VUDpcbiAgICAgICAgICAgICAgICB0aGlzLnRyYWNrU3RvcChldmVudCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fTU9WRTpcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNUcmFja2luZykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYWNrU3RhcnQoZXZlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnRyYWNrQ2hhbmdlKGV2ZW50KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIEN1c3RvbVBhbkdlc3R1cmVEZXRlY3Rvci5wcm90b3R5cGUudHJhY2tTdG9wID0gZnVuY3Rpb24gKGN1cnJlbnRFdmVudCwgY2FjaGVFdmVudCkge1xuICAgICAgICBpZiAodGhpcy5pc1RyYWNraW5nKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IF9nZXRQYW5BcmdzKHRoaXMuZGVsdGFYLCB0aGlzLmRlbHRhWSwgdGhpcy50YXJnZXQsIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVTdGF0ZVR5cGVzLmVuZGVkLCBudWxsLCBjdXJyZW50RXZlbnQpO1xuICAgICAgICAgICAgX2V4ZWN1dGVDYWxsYmFjayh0aGlzLm9ic2VydmVyLCBhcmdzKTtcbiAgICAgICAgICAgIHRoaXMuZGVsdGFYID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5kZWx0YVkgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLmlzVHJhY2tpbmcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FjaGVFdmVudCkge1xuICAgICAgICAgICAgdGhpcy5sYXN0RXZlbnRDYWNoZSA9IGN1cnJlbnRFdmVudDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubGFzdEV2ZW50Q2FjaGUgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEN1c3RvbVBhbkdlc3R1cmVEZXRlY3Rvci5wcm90b3R5cGUudHJhY2tTdGFydCA9IGZ1bmN0aW9uIChjdXJyZW50RXZlbnQpIHtcbiAgICAgICAgdmFyIGluaXRhbCA9IHRoaXMuZ2V0RXZlbnRDb29yZGluYXRlcyh0aGlzLmxhc3RFdmVudENhY2hlID8gdGhpcy5sYXN0RXZlbnRDYWNoZSA6IGN1cnJlbnRFdmVudCk7XG4gICAgICAgIHRoaXMuaW5pdGlhbFggPSBpbml0YWwueDtcbiAgICAgICAgdGhpcy5pbml0aWFsWSA9IGluaXRhbC55O1xuICAgICAgICB0aGlzLmlzVHJhY2tpbmcgPSB0cnVlO1xuICAgICAgICB2YXIgYXJncyA9IF9nZXRQYW5BcmdzKDAsIDAsIHRoaXMudGFyZ2V0LCBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5iZWdhbiwgbnVsbCwgY3VycmVudEV2ZW50KTtcbiAgICAgICAgX2V4ZWN1dGVDYWxsYmFjayh0aGlzLm9ic2VydmVyLCBhcmdzKTtcbiAgICB9O1xuICAgIEN1c3RvbVBhbkdlc3R1cmVEZXRlY3Rvci5wcm90b3R5cGUudHJhY2tDaGFuZ2UgPSBmdW5jdGlvbiAoY3VycmVudEV2ZW50KSB7XG4gICAgICAgIHZhciBjdXJyZW50ID0gdGhpcy5nZXRFdmVudENvb3JkaW5hdGVzKGN1cnJlbnRFdmVudCk7XG4gICAgICAgIHRoaXMuZGVsdGFYID0gY3VycmVudC54IC0gdGhpcy5pbml0aWFsWDtcbiAgICAgICAgdGhpcy5kZWx0YVkgPSBjdXJyZW50LnkgLSB0aGlzLmluaXRpYWxZO1xuICAgICAgICB2YXIgYXJncyA9IF9nZXRQYW5BcmdzKHRoaXMuZGVsdGFYLCB0aGlzLmRlbHRhWSwgdGhpcy50YXJnZXQsIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVTdGF0ZVR5cGVzLmNoYW5nZWQsIG51bGwsIGN1cnJlbnRFdmVudCk7XG4gICAgICAgIF9leGVjdXRlQ2FsbGJhY2sodGhpcy5vYnNlcnZlciwgYXJncyk7XG4gICAgfTtcbiAgICBDdXN0b21QYW5HZXN0dXJlRGV0ZWN0b3IucHJvdG90eXBlLmdldEV2ZW50Q29vcmRpbmF0ZXMgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGNvdW50ID0gZXZlbnQuZ2V0UG9pbnRlckNvdW50KCk7XG4gICAgICAgIGlmIChjb3VudCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB4OiBldmVudC5nZXRSYXdYKCkgLyB0aGlzLmRlbnNpdHksXG4gICAgICAgICAgICAgICAgeTogZXZlbnQuZ2V0UmF3WSgpIC8gdGhpcy5kZW5zaXR5XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIG9mZlggPSBldmVudC5nZXRSYXdYKCkgLSBldmVudC5nZXRYKCk7XG4gICAgICAgICAgICB2YXIgb2ZmWSA9IGV2ZW50LmdldFJhd1koKSAtIGV2ZW50LmdldFkoKTtcbiAgICAgICAgICAgIHZhciByZXMgPSB7IHg6IDAsIHk6IDAgfTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHJlcy54ICs9IGV2ZW50LmdldFgoaSkgKyBvZmZYO1xuICAgICAgICAgICAgICAgIHJlcy55ICs9IGV2ZW50LmdldFkoaSkgKyBvZmZZO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzLnggLz0gKGNvdW50ICogdGhpcy5kZW5zaXR5KTtcbiAgICAgICAgICAgIHJlcy55IC89IChjb3VudCAqIHRoaXMuZGVuc2l0eSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQ3VzdG9tUGFuR2VzdHVyZURldGVjdG9yO1xufSgpKTtcbnZhciBDdXN0b21Sb3RhdGVHZXN0dXJlRGV0ZWN0b3IgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEN1c3RvbVJvdGF0ZUdlc3R1cmVEZXRlY3RvcihvYnNlcnZlciwgdGFyZ2V0KSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgIHRoaXMudHJhY2tlZFB0cklkMSA9IElOVkFMSURfUE9JTlRFUl9JRDtcbiAgICAgICAgdGhpcy50cmFja2VkUHRySWQyID0gSU5WQUxJRF9QT0lOVEVSX0lEO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ3VzdG9tUm90YXRlR2VzdHVyZURldGVjdG9yLnByb3RvdHlwZSwgXCJpc1RyYWNraW5nXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50cmFja2VkUHRySWQxICE9PSBJTlZBTElEX1BPSU5URVJfSUQgJiYgdGhpcy50cmFja2VkUHRySWQyICE9PSBJTlZBTElEX1BPSU5URVJfSUQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEN1c3RvbVJvdGF0ZUdlc3R1cmVEZXRlY3Rvci5wcm90b3R5cGUub25Ub3VjaEV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBwb2ludGVySUQgPSBldmVudC5nZXRQb2ludGVySWQoZXZlbnQuZ2V0QWN0aW9uSW5kZXgoKSk7XG4gICAgICAgIHZhciB3YXNUcmFja2luZyA9IHRoaXMuaXNUcmFja2luZztcbiAgICAgICAgc3dpdGNoIChldmVudC5nZXRBY3Rpb25NYXNrZWQoKSkge1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuTW90aW9uRXZlbnQuQUNUSU9OX0RPV046XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fUE9JTlRFUl9ET1dOOlxuICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRyYWNrZWRQdHJJZDEgPT09IElOVkFMSURfUE9JTlRFUl9JRCAmJiBwb2ludGVySUQgIT09IHRoaXMudHJhY2tlZFB0cklkMikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYWNrZWRQdHJJZDEgPSBwb2ludGVySUQ7XG4gICAgICAgICAgICAgICAgICAgIGFzc2lnbmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy50cmFja2VkUHRySWQyID09PSBJTlZBTElEX1BPSU5URVJfSUQgJiYgcG9pbnRlcklEICE9PSB0aGlzLnRyYWNrZWRQdHJJZDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFja2VkUHRySWQyID0gcG9pbnRlcklEO1xuICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhc3NpZ25lZCAmJiB0aGlzLmlzVHJhY2tpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbmdsZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdGFsUG9pbnRlcnNBbmdsZSA9IHRoaXMuZ2V0UG9pbnRlcnNBbmdsZShldmVudCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY3V0ZUNhbGxiYWNrKGV2ZW50LCBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5iZWdhbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuTW90aW9uRXZlbnQuQUNUSU9OX01PVkU6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNUcmFja2luZykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUFuZ2xlKGV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5leGVjdXRlQ2FsbGJhY2soZXZlbnQsIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVTdGF0ZVR5cGVzLmNoYW5nZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3Lk1vdGlvbkV2ZW50LkFDVElPTl9VUDpcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3Lk1vdGlvbkV2ZW50LkFDVElPTl9QT0lOVEVSX1VQOlxuICAgICAgICAgICAgICAgIGlmIChwb2ludGVySUQgPT09IHRoaXMudHJhY2tlZFB0cklkMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYWNrZWRQdHJJZDEgPSBJTlZBTElEX1BPSU5URVJfSUQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBvaW50ZXJJRCA9PT0gdGhpcy50cmFja2VkUHRySWQyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJhY2tlZFB0cklkMiA9IElOVkFMSURfUE9JTlRFUl9JRDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHdhc1RyYWNraW5nICYmICF0aGlzLmlzVHJhY2tpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5leGVjdXRlQ2FsbGJhY2soZXZlbnQsIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVTdGF0ZVR5cGVzLmVuZGVkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fQ0FOQ0VMOlxuICAgICAgICAgICAgICAgIHRoaXMudHJhY2tlZFB0cklkMSA9IElOVkFMSURfUE9JTlRFUl9JRDtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYWNrZWRQdHJJZDIgPSBJTlZBTElEX1BPSU5URVJfSUQ7XG4gICAgICAgICAgICAgICAgaWYgKHdhc1RyYWNraW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY3V0ZUNhbGxiYWNrKGV2ZW50LCBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5jYW5jZWxsZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIEN1c3RvbVJvdGF0ZUdlc3R1cmVEZXRlY3Rvci5wcm90b3R5cGUuZXhlY3V0ZUNhbGxiYWNrID0gZnVuY3Rpb24gKGV2ZW50LCBzdGF0ZSkge1xuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIHR5cGU6IGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5yb3RhdGlvbixcbiAgICAgICAgICAgIHZpZXc6IHRoaXMudGFyZ2V0LFxuICAgICAgICAgICAgYW5kcm9pZDogZXZlbnQsXG4gICAgICAgICAgICByb3RhdGlvbjogdGhpcy5hbmdsZSxcbiAgICAgICAgICAgIGlvczogdW5kZWZpbmVkLFxuICAgICAgICAgICAgb2JqZWN0OiB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgIGV2ZW50TmFtZTogZ2VzdHVyZXNfY29tbW9uXzEudG9TdHJpbmcoZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnJvdGF0aW9uKSxcbiAgICAgICAgICAgIHN0YXRlOiBzdGF0ZVxuICAgICAgICB9O1xuICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMub2JzZXJ2ZXIsIGFyZ3MpO1xuICAgIH07XG4gICAgQ3VzdG9tUm90YXRlR2VzdHVyZURldGVjdG9yLnByb3RvdHlwZS51cGRhdGVBbmdsZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgbmV3UG9pbnRlcnNBbmdsZSA9IHRoaXMuZ2V0UG9pbnRlcnNBbmdsZShldmVudCk7XG4gICAgICAgIHZhciByZXN1bHQgPSAoKG5ld1BvaW50ZXJzQW5nbGUgLSB0aGlzLmluaXRhbFBvaW50ZXJzQW5nbGUpICogVE9fREVHUkVFUykgJSAzNjA7XG4gICAgICAgIGlmIChyZXN1bHQgPCAtMTgwKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gMzYwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXN1bHQgPiAxODApIHtcbiAgICAgICAgICAgIHJlc3VsdCAtPSAzNjA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hbmdsZSA9IHJlc3VsdDtcbiAgICB9O1xuICAgIEN1c3RvbVJvdGF0ZUdlc3R1cmVEZXRlY3Rvci5wcm90b3R5cGUuZ2V0UG9pbnRlcnNBbmdsZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgZmlyc3RYID0gZXZlbnQuZ2V0WChldmVudC5maW5kUG9pbnRlckluZGV4KHRoaXMudHJhY2tlZFB0cklkMSkpO1xuICAgICAgICB2YXIgZmlyc3RZID0gZXZlbnQuZ2V0WShldmVudC5maW5kUG9pbnRlckluZGV4KHRoaXMudHJhY2tlZFB0cklkMSkpO1xuICAgICAgICB2YXIgc2Vjb25kWCA9IGV2ZW50LmdldFgoZXZlbnQuZmluZFBvaW50ZXJJbmRleCh0aGlzLnRyYWNrZWRQdHJJZDIpKTtcbiAgICAgICAgdmFyIHNlY29uZFkgPSBldmVudC5nZXRZKGV2ZW50LmZpbmRQb2ludGVySW5kZXgodGhpcy50cmFja2VkUHRySWQyKSk7XG4gICAgICAgIHJldHVybiBNYXRoLmF0YW4yKChzZWNvbmRZIC0gZmlyc3RZKSwgKHNlY29uZFggLSBmaXJzdFgpKTtcbiAgICB9O1xuICAgIHJldHVybiBDdXN0b21Sb3RhdGVHZXN0dXJlRGV0ZWN0b3I7XG59KCkpO1xudmFyIFBvaW50ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFBvaW50ZXIoaWQsIGV2ZW50KSB7XG4gICAgICAgIHRoaXMuZXZlbnQgPSBldmVudDtcbiAgICAgICAgdGhpcy5pb3MgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuYW5kcm9pZCA9IGlkO1xuICAgIH1cbiAgICBQb2ludGVyLnByb3RvdHlwZS5nZXRYID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ldmVudC5nZXRYKHRoaXMuYW5kcm9pZCkgLyB1dGlsc18xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgIH07XG4gICAgUG9pbnRlci5wcm90b3R5cGUuZ2V0WSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnQuZ2V0WSh0aGlzLmFuZHJvaWQpIC8gdXRpbHNfMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICB9O1xuICAgIHJldHVybiBQb2ludGVyO1xufSgpKTtcbnZhciBUb3VjaEdlc3R1cmVFdmVudERhdGEgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFRvdWNoR2VzdHVyZUV2ZW50RGF0YSgpIHtcbiAgICAgICAgdGhpcy5ldmVudE5hbWUgPSBnZXN0dXJlc19jb21tb25fMS50b1N0cmluZyhnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMudG91Y2gpO1xuICAgICAgICB0aGlzLnR5cGUgPSBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMudG91Y2g7XG4gICAgICAgIHRoaXMuaW9zID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBUb3VjaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLnByZXBhcmUgPSBmdW5jdGlvbiAodmlldywgZSkge1xuICAgICAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgICAgICB0aGlzLm9iamVjdCA9IHZpZXc7XG4gICAgICAgIHRoaXMuYW5kcm9pZCA9IGU7XG4gICAgICAgIHRoaXMuYWN0aW9uID0gdGhpcy5nZXRBY3Rpb25UeXBlKGUpO1xuICAgICAgICB0aGlzLl9hY3RpdmVQb2ludGVycyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fYWxsUG9pbnRlcnMgPSB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldFBvaW50ZXJDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYW5kcm9pZC5nZXRQb2ludGVyQ291bnQoKTtcbiAgICB9O1xuICAgIFRvdWNoR2VzdHVyZUV2ZW50RGF0YS5wcm90b3R5cGUuZ2V0QWN0aXZlUG9pbnRlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fYWN0aXZlUG9pbnRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuX2FjdGl2ZVBvaW50ZXJzID0gW25ldyBQb2ludGVyKHRoaXMuYW5kcm9pZC5nZXRBY3Rpb25JbmRleCgpLCB0aGlzLmFuZHJvaWQpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fYWN0aXZlUG9pbnRlcnM7XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldEFsbFBvaW50ZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2FsbFBvaW50ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLl9hbGxQb2ludGVycyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmdldFBvaW50ZXJDb3VudCgpOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hbGxQb2ludGVycy5wdXNoKG5ldyBQb2ludGVyKGksIHRoaXMuYW5kcm9pZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9hbGxQb2ludGVycztcbiAgICB9O1xuICAgIFRvdWNoR2VzdHVyZUV2ZW50RGF0YS5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWN0aXZlUG9pbnRlcnMoKVswXS5nZXRYKCk7XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldFkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEFjdGl2ZVBvaW50ZXJzKClbMF0uZ2V0WSgpO1xuICAgIH07XG4gICAgVG91Y2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5nZXRBY3Rpb25UeXBlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgc3dpdGNoIChlLmdldEFjdGlvbk1hc2tlZCgpKSB7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fRE9XTjpcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3Lk1vdGlvbkV2ZW50LkFDVElPTl9QT0lOVEVSX0RPV046XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdlc3R1cmVzX2NvbW1vbl8xLlRvdWNoQWN0aW9uLmRvd247XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fTU9WRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2VzdHVyZXNfY29tbW9uXzEuVG91Y2hBY3Rpb24ubW92ZTtcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3Lk1vdGlvbkV2ZW50LkFDVElPTl9VUDpcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3Lk1vdGlvbkV2ZW50LkFDVElPTl9QT0lOVEVSX1VQOlxuICAgICAgICAgICAgICAgIHJldHVybiBnZXN0dXJlc19jb21tb25fMS5Ub3VjaEFjdGlvbi51cDtcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3Lk1vdGlvbkV2ZW50LkFDVElPTl9DQU5DRUw6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdlc3R1cmVzX2NvbW1vbl8xLlRvdWNoQWN0aW9uLmNhbmNlbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9O1xuICAgIHJldHVybiBUb3VjaEdlc3R1cmVFdmVudERhdGE7XG59KCkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z2VzdHVyZXMuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBIdG1sVmlld0Jhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhIdG1sVmlld0Jhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSHRtbFZpZXdCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEh0bWxWaWV3QmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIkh0bWxWaWV3XCIpXG4gICAgXSwgSHRtbFZpZXdCYXNlKTtcbiAgICByZXR1cm4gSHRtbFZpZXdCYXNlO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5IdG1sVmlld0Jhc2UgPSBIdG1sVmlld0Jhc2U7XG5IdG1sVmlld0Jhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLmh0bWxQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImh0bWxcIiwgZGVmYXVsdFZhbHVlOiBcIlwiLCBhZmZlY3RzTGF5b3V0OiB0cnVlIH0pO1xuZXhwb3J0cy5odG1sUHJvcGVydHkucmVnaXN0ZXIoSHRtbFZpZXdCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWh0bWwtdmlldy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBodG1sX3ZpZXdfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9odG1sLXZpZXctY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vaHRtbC12aWV3LWNvbW1vblwiKSk7XG52YXIgSHRtbFZpZXcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhIdG1sVmlldywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBIdG1sVmlldygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBIdG1sVmlldy5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBhbmRyb2lkLndpZGdldC5UZXh0Vmlldyh0aGlzLl9jb250ZXh0KTtcbiAgICB9O1xuICAgIEh0bWxWaWV3LnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRMaW5rc0NsaWNrYWJsZSh0cnVlKTtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRNb3ZlbWVudE1ldGhvZChhbmRyb2lkLnRleHQubWV0aG9kLkxpbmtNb3ZlbWVudE1ldGhvZC5nZXRJbnN0YW5jZSgpKTtcbiAgICB9O1xuICAgIEh0bWxWaWV3LnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRBdXRvTGlua01hc2soMCk7XG4gICAgfTtcbiAgICBIdG1sVmlldy5wcm90b3R5cGVbaHRtbF92aWV3X2NvbW1vbl8xLmh0bWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfTtcbiAgICBIdG1sVmlldy5wcm90b3R5cGVbaHRtbF92aWV3X2NvbW1vbl8xLmh0bWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBtYXNrID0gMTU7XG4gICAgICAgIGlmICh2YWx1ZS5zZWFyY2goLzxhXFxzL2kpID49IDApIHtcbiAgICAgICAgICAgIG1hc2sgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRBdXRvTGlua01hc2sobWFzayk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUZXh0KGFuZHJvaWQudGV4dC5IdG1sLmZyb21IdG1sKHZhbHVlKSk7XG4gICAgfTtcbiAgICByZXR1cm4gSHRtbFZpZXc7XG59KGh0bWxfdmlld19jb21tb25fMS5IdG1sVmlld0Jhc2UpKTtcbmV4cG9ydHMuSHRtbFZpZXcgPSBIdG1sVmlldztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWh0bWwtdmlldy5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBpbWFnZV9hc3NldF8xID0gcmVxdWlyZShcIi4uLy4uL2ltYWdlLWFzc2V0XCIpO1xuZXhwb3J0cy5JbWFnZUFzc2V0ID0gaW1hZ2VfYXNzZXRfMS5JbWFnZUFzc2V0O1xudmFyIGltYWdlX3NvdXJjZV8xID0gcmVxdWlyZShcIi4uLy4uL2ltYWdlLXNvdXJjZVwiKTtcbmV4cG9ydHMuSW1hZ2VTb3VyY2UgPSBpbWFnZV9zb3VyY2VfMS5JbWFnZVNvdXJjZTtcbmV4cG9ydHMuZnJvbUFzc2V0ID0gaW1hZ2Vfc291cmNlXzEuZnJvbUFzc2V0O1xuZXhwb3J0cy5mcm9tTmF0aXZlU291cmNlID0gaW1hZ2Vfc291cmNlXzEuZnJvbU5hdGl2ZVNvdXJjZTtcbmV4cG9ydHMuZnJvbVVybCA9IGltYWdlX3NvdXJjZV8xLmZyb21Vcmw7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbmV4cG9ydHMuaXNEYXRhVVJJID0gdXRpbHNfMS5pc0RhdGFVUkk7XG5leHBvcnRzLmlzRm9udEljb25VUkkgPSB1dGlsc18xLmlzRm9udEljb25VUkk7XG5leHBvcnRzLmlzRmlsZU9yUmVzb3VyY2VQYXRoID0gdXRpbHNfMS5pc0ZpbGVPclJlc291cmNlUGF0aDtcbmV4cG9ydHMuUkVTT1VSQ0VfUFJFRklYID0gdXRpbHNfMS5SRVNPVVJDRV9QUkVGSVg7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBJbWFnZUJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJbWFnZUJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW1hZ2VCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbWFnZUJhc2UucHJvdG90eXBlLCBcInRpbnRDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGludENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50aW50Q29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgSW1hZ2VCYXNlLnByb3RvdHlwZS5fY3JlYXRlSW1hZ2VTb3VyY2VGcm9tU3JjID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBvcmlnaW5hbFZhbHVlID0gdmFsdWU7XG4gICAgICAgIHZhciBzeW5jID0gdGhpcy5sb2FkTW9kZSA9PT0gXCJzeW5jXCI7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgfHwgdmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcpIHtcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgdGhpcy5pbWFnZVNvdXJjZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzW1wiX3VybFwiXSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHNvdXJjZV8xID0gbmV3IGltYWdlX3NvdXJjZV8xLkltYWdlU291cmNlKCk7XG4gICAgICAgICAgICB2YXIgaW1hZ2VMb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IF90aGlzLnNyYztcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlICE9PSBvcmlnaW5hbFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3RoaXMuaW1hZ2VTb3VyY2UgPSBzb3VyY2VfMTtcbiAgICAgICAgICAgICAgICBfdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodXRpbHNfMS5pc0ZvbnRJY29uVVJJKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHZhciBmb250SWNvbkNvZGUgPSB2YWx1ZS5zcGxpdChcIi8vXCIpWzFdO1xuICAgICAgICAgICAgICAgIGlmIChmb250SWNvbkNvZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm9udCA9IHRoaXMuc3R5bGUuZm9udEludGVybmFsO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sb3IgPSB0aGlzLnN0eWxlLmNvbG9yO1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VfMS5sb2FkRnJvbUZvbnRJY29uQ29kZShmb250SWNvbkNvZGUsIGZvbnQsIGNvbG9yKTtcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2VMb2FkZWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh1dGlsc18xLmlzRGF0YVVSSSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgYmFzZTY0RGF0YSA9IHZhbHVlLnNwbGl0KFwiLFwiKVsxXTtcbiAgICAgICAgICAgICAgICBpZiAoYmFzZTY0RGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzeW5jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VfMS5sb2FkRnJvbUJhc2U2NChiYXNlNjREYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlTG9hZGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VfMS5mcm9tQmFzZTY0KGJhc2U2NERhdGEpLnRoZW4oaW1hZ2VMb2FkZWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodXRpbHNfMS5pc0ZpbGVPclJlc291cmNlUGF0aCh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUuaW5kZXhPZih1dGlsc18xLlJFU09VUkNFX1BSRUZJWCkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc1BhdGggPSB2YWx1ZS5zdWJzdHIodXRpbHNfMS5SRVNPVVJDRV9QUkVGSVgubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN5bmMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZV8xLmxvYWRGcm9tUmVzb3VyY2UocmVzUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZUxvYWRlZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbWFnZVNvdXJjZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VfMS5mcm9tUmVzb3VyY2UocmVzUGF0aCkudGhlbihpbWFnZUxvYWRlZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzeW5jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VfMS5sb2FkRnJvbUZpbGUodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VMb2FkZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VTb3VyY2UgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlXzEuZnJvbUZpbGUodmFsdWUpLnRoZW4oaW1hZ2VMb2FkZWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbWFnZVNvdXJjZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgaW1hZ2Vfc291cmNlXzEuZnJvbVVybCh2YWx1ZSkudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXNbXCJfdXJsXCJdID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW1hZ2VTb3VyY2UgPSByO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmlld18xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVyciA9PT0gXCJvYmplY3RcIiAmJiBlcnIubWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IGVyci5tZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmlld18xLnRyYWNlV3JpdGUoZXJyLCB2aWV3XzEudHJhY2VDYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgaW1hZ2Vfc291cmNlXzEuSW1hZ2VTb3VyY2UpIHtcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VTb3VyY2UgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBpbWFnZV9hc3NldF8xLkltYWdlQXNzZXQpIHtcbiAgICAgICAgICAgIGltYWdlX3NvdXJjZV8xLmZyb21Bc3NldCh2YWx1ZSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaW1hZ2VTb3VyY2UgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VTb3VyY2UgPSBpbWFnZV9zb3VyY2VfMS5mcm9tTmF0aXZlU291cmNlKHZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEltYWdlQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIkltYWdlXCIpXG4gICAgXSwgSW1hZ2VCYXNlKTtcbiAgICByZXR1cm4gSW1hZ2VCYXNlO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5JbWFnZUJhc2UgPSBJbWFnZUJhc2U7XG5JbWFnZUJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLmltYWdlU291cmNlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJpbWFnZVNvdXJjZVwiIH0pO1xuZXhwb3J0cy5pbWFnZVNvdXJjZVByb3BlcnR5LnJlZ2lzdGVyKEltYWdlQmFzZSk7XG5leHBvcnRzLnNyY1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwic3JjXCIgfSk7XG5leHBvcnRzLnNyY1Byb3BlcnR5LnJlZ2lzdGVyKEltYWdlQmFzZSk7XG5leHBvcnRzLmxvYWRNb2RlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJsb2FkTW9kZVwiLCBkZWZhdWx0VmFsdWU6IFwic3luY1wiIH0pO1xuZXhwb3J0cy5sb2FkTW9kZVByb3BlcnR5LnJlZ2lzdGVyKEltYWdlQmFzZSk7XG5leHBvcnRzLmlzTG9hZGluZ1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaXNMb2FkaW5nXCIsIGRlZmF1bHRWYWx1ZTogZmFsc2UsIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuaXNMb2FkaW5nUHJvcGVydHkucmVnaXN0ZXIoSW1hZ2VCYXNlKTtcbmV4cG9ydHMuc3RyZXRjaFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwic3RyZXRjaFwiLCBkZWZhdWx0VmFsdWU6IFwiYXNwZWN0Rml0XCIsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUyB9KTtcbmV4cG9ydHMuc3RyZXRjaFByb3BlcnR5LnJlZ2lzdGVyKEltYWdlQmFzZSk7XG5leHBvcnRzLnRpbnRDb2xvclByb3BlcnR5ID0gbmV3IHZpZXdfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7IG5hbWU6IFwidGludENvbG9yXCIsIGNzc05hbWU6IFwidGludC1jb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBuZXcgdmlld18xLkNvbG9yKHZhbHVlKTsgfSB9KTtcbmV4cG9ydHMudGludENvbG9yUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbmV4cG9ydHMuZGVjb2RlSGVpZ2h0UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJkZWNvZGVIZWlnaHRcIiwgZGVmYXVsdFZhbHVlOiB7IHZhbHVlOiAwLCB1bml0OiBcImRpcFwiIH0sIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuTGVuZ3RoLnBhcnNlIH0pO1xuZXhwb3J0cy5kZWNvZGVIZWlnaHRQcm9wZXJ0eS5yZWdpc3RlcihJbWFnZUJhc2UpO1xuZXhwb3J0cy5kZWNvZGVXaWR0aFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiZGVjb2RlV2lkdGhcIiwgZGVmYXVsdFZhbHVlOiB7IHZhbHVlOiAwLCB1bml0OiBcImRpcFwiIH0sIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuTGVuZ3RoLnBhcnNlIH0pO1xuZXhwb3J0cy5kZWNvZGVXaWR0aFByb3BlcnR5LnJlZ2lzdGVyKEltYWdlQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBpbWFnZV9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2ltYWdlLWNvbW1vblwiKTtcbnZhciBmaWxlX3N5c3RlbV8xID0gcmVxdWlyZShcIi4uLy4uL2ZpbGUtc3lzdGVtXCIpO1xudmFyIHBsYXRmb3JtID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vaW1hZ2UtY29tbW9uXCIpKTtcbnZhciBGSUxFX1BSRUZJWCA9IFwiZmlsZTovLy9cIjtcbnZhciBBU1lOQyA9IFwiYXN5bmNcIjtcbnZhciBBbmRyb2lkSW1hZ2VWaWV3O1xudmFyIEltYWdlTG9hZGVkTGlzdGVuZXI7XG5mdW5jdGlvbiBpbml0aWFsaXplSW1hZ2VMb2FkZWRMaXN0ZW5lcigpIHtcbiAgICBpZiAoSW1hZ2VMb2FkZWRMaXN0ZW5lcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBJbWFnZUxvYWRlZExpc3RlbmVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhJbWFnZUxvYWRlZExpc3RlbmVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gSW1hZ2VMb2FkZWRMaXN0ZW5lckltcGwob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgSW1hZ2VMb2FkZWRMaXN0ZW5lckltcGwucHJvdG90eXBlLm9uSW1hZ2VMb2FkZWQgPSBmdW5jdGlvbiAoc3VjY2Vzcykge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgICAgIG93bmVyLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBJbWFnZUxvYWRlZExpc3RlbmVySW1wbCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgSW50ZXJmYWNlcyhbb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLmltYWdlLldvcmtlci5PbkltYWdlTG9hZGVkTGlzdGVuZXJdKVxuICAgICAgICBdLCBJbWFnZUxvYWRlZExpc3RlbmVySW1wbCk7XG4gICAgICAgIHJldHVybiBJbWFnZUxvYWRlZExpc3RlbmVySW1wbDtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICBJbWFnZUxvYWRlZExpc3RlbmVyID0gSW1hZ2VMb2FkZWRMaXN0ZW5lckltcGw7XG59XG52YXIgSW1hZ2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJbWFnZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBJbWFnZSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnVzZUNhY2hlID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBJbWFnZS5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFBbmRyb2lkSW1hZ2VWaWV3KSB7XG4gICAgICAgICAgICBBbmRyb2lkSW1hZ2VWaWV3ID0gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkltYWdlVmlldztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IEFuZHJvaWRJbWFnZVZpZXcodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgaW5pdGlhbGl6ZUltYWdlTG9hZGVkTGlzdGVuZXIoKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IG5ldyBJbWFnZUxvYWRlZExpc3RlbmVyKHRoaXMpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldEltYWdlTG9hZGVkTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgICAgICBuYXRpdmVWaWV3Lmxpc3RlbmVyID0gbGlzdGVuZXI7XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5saXN0ZW5lci5vd25lciA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIEltYWdlLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRJbWFnZU1hdHJpeChuZXcgYW5kcm9pZC5ncmFwaGljcy5NYXRyaXgoKSk7XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGUuX2NyZWF0ZUltYWdlU291cmNlRnJvbVNyYyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaW1hZ2VWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAoIWltYWdlVmlldykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgIGltYWdlVmlldy5zZXRVcmkobnVsbCwgMCwgMCwgZmFsc2UsIGZhbHNlLCB0cnVlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2NyZWVuID0gcGxhdGZvcm0uc2NyZWVuLm1haW5TY3JlZW47XG4gICAgICAgIHZhciBkZWNvZGVXaWR0aCA9IE1hdGgubWluKGltYWdlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh0aGlzLmRlY29kZVdpZHRoLCAwKSwgc2NyZWVuLndpZHRoUGl4ZWxzKTtcbiAgICAgICAgdmFyIGRlY29kZUhlaWdodCA9IE1hdGgubWluKGltYWdlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh0aGlzLmRlY29kZUhlaWdodCwgMCksIHNjcmVlbi5oZWlnaHRQaXhlbHMpO1xuICAgICAgICB2YXIga2VlcEFzcGVjdFJhdGlvID0gdGhpcy5fY2FsY3VsYXRlS2VlcEFzcGVjdFJhdGlvKCk7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGltYWdlX2NvbW1vbl8xLkltYWdlQXNzZXQpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZS5vcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgZGVjb2RlV2lkdGggPSB2YWx1ZS5vcHRpb25zLndpZHRoIHx8IGRlY29kZVdpZHRoO1xuICAgICAgICAgICAgICAgIGRlY29kZUhlaWdodCA9IHZhbHVlLm9wdGlvbnMuaGVpZ2h0IHx8IGRlY29kZUhlaWdodDtcbiAgICAgICAgICAgICAgICBrZWVwQXNwZWN0UmF0aW8gPSAhIXZhbHVlLm9wdGlvbnMua2VlcEFzcGVjdFJhdGlvO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5hbmRyb2lkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhc3luYyA9IHRoaXMubG9hZE1vZGUgPT09IEFTWU5DO1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiIHx8IHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChpbWFnZV9jb21tb25fMS5pc0ZvbnRJY29uVVJJKHZhbHVlKSB8fCBpbWFnZV9jb21tb25fMS5pc0RhdGFVUkkodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fY3JlYXRlSW1hZ2VTb3VyY2VGcm9tU3JjLmNhbGwodGhpcywgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaW1hZ2VfY29tbW9uXzEuaXNGaWxlT3JSZXNvdXJjZVBhdGgodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLmluZGV4T2YoaW1hZ2VfY29tbW9uXzEuUkVTT1VSQ0VfUFJFRklYKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBpbWFnZVZpZXcuc2V0VXJpKHZhbHVlLCBkZWNvZGVXaWR0aCwgZGVjb2RlSGVpZ2h0LCBrZWVwQXNwZWN0UmF0aW8sIHRoaXMudXNlQ2FjaGUsIGFzeW5jKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmaWxlTmFtZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZU5hbWUuaW5kZXhPZihcIn4vXCIpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlTmFtZSA9IGZpbGVfc3lzdGVtXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoICsgXCIvXCIgKyBmaWxlTmFtZS5yZXBsYWNlKFwifi9cIiwgXCJcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaW1hZ2VWaWV3LnNldFVyaShGSUxFX1BSRUZJWCArIGZpbGVOYW1lLCBkZWNvZGVXaWR0aCwgZGVjb2RlSGVpZ2h0LCBrZWVwQXNwZWN0UmF0aW8sIHRoaXMudXNlQ2FjaGUsIGFzeW5jKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbWFnZVZpZXcuc2V0VXJpKHZhbHVlLCBkZWNvZGVXaWR0aCwgZGVjb2RlSGVpZ2h0LCBrZWVwQXNwZWN0UmF0aW8sIHRoaXMudXNlQ2FjaGUsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fY3JlYXRlSW1hZ2VTb3VyY2VGcm9tU3JjLmNhbGwodGhpcywgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGUuX2NhbGN1bGF0ZUtlZXBBc3BlY3RSYXRpbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RyZXRjaCA9PT0gXCJmaWxsXCIgPyBmYWxzZSA6IHRydWU7XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGVbaW1hZ2VfY29tbW9uXzEuc3RyZXRjaFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJhc3BlY3RGaXRcIjtcbiAgICB9O1xuICAgIEltYWdlLnByb3RvdHlwZVtpbWFnZV9jb21tb25fMS5zdHJldGNoUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICBjYXNlIFwiYXNwZWN0Rml0XCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFNjYWxlVHlwZShhbmRyb2lkLndpZGdldC5JbWFnZVZpZXcuU2NhbGVUeXBlLkZJVF9DRU5URVIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImFzcGVjdEZpbGxcIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0U2NhbGVUeXBlKGFuZHJvaWQud2lkZ2V0LkltYWdlVmlldy5TY2FsZVR5cGUuQ0VOVEVSX0NST1ApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImZpbGxcIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0U2NhbGVUeXBlKGFuZHJvaWQud2lkZ2V0LkltYWdlVmlldy5TY2FsZVR5cGUuRklUX1hZKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJub25lXCI6XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRTY2FsZVR5cGUoYW5kcm9pZC53aWRnZXQuSW1hZ2VWaWV3LlNjYWxlVHlwZS5NQVRSSVgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGVbaW1hZ2VfY29tbW9uXzEudGludENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGVbaW1hZ2VfY29tbW9uXzEudGludENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNsZWFyQ29sb3JGaWx0ZXIoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRDb2xvckZpbHRlcih2YWx1ZS5hbmRyb2lkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlW2ltYWdlX2NvbW1vbl8xLmltYWdlU291cmNlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGVbaW1hZ2VfY29tbW9uXzEuaW1hZ2VTb3VyY2VQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAodmFsdWUgJiYgdmFsdWUuYW5kcm9pZCkge1xuICAgICAgICAgICAgdmFyIHJvdGF0aW9uID0gdmFsdWUucm90YXRpb25BbmdsZSA/IHZhbHVlLnJvdGF0aW9uQW5nbGUgOiAwO1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRSb3RhdGlvbkFuZ2xlKHJvdGF0aW9uKTtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0SW1hZ2VCaXRtYXAodmFsdWUuYW5kcm9pZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldFJvdGF0aW9uQW5nbGUoMCk7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldEltYWdlQml0bWFwKG51bGwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGVbaW1hZ2VfY29tbW9uXzEuc3JjUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGVbaW1hZ2VfY29tbW9uXzEuc3JjUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9jcmVhdGVJbWFnZVNvdXJjZUZyb21TcmModmFsdWUpO1xuICAgIH07XG4gICAgcmV0dXJuIEltYWdlO1xufShpbWFnZV9jb21tb25fMS5JbWFnZUJhc2UpKTtcbmV4cG9ydHMuSW1hZ2UgPSBJbWFnZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWltYWdlLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0ZXh0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vcHJvZmlsaW5nXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL3RleHQtYmFzZVwiKSk7XG52YXIgVGV4dFZpZXc7XG52YXIgTGFiZWwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhMYWJlbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMYWJlbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGFiZWwucHJvdG90eXBlLCBcInRleHRXcmFwXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS53aGl0ZVNwYWNlID09PSBcIm5vcm1hbFwiO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdGV4dF9iYXNlXzEuYm9vbGVhbkNvbnZlcnRlcih2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnN0eWxlLndoaXRlU3BhY2UgPSB2YWx1ZSA/IFwibm9ybWFsXCIgOiBcIm5vd3JhcFwiO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBMYWJlbC5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFUZXh0Vmlldykge1xuICAgICAgICAgICAgVGV4dFZpZXcgPSBhbmRyb2lkLndpZGdldC5UZXh0VmlldztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFRleHRWaWV3KHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgTGFiZWwucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciB0ZXh0VmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHRleHRWaWV3LnNldFNpbmdsZUxpbmUodHJ1ZSk7XG4gICAgICAgIHRleHRWaWV3LnNldEVsbGlwc2l6ZShhbmRyb2lkLnRleHQuVGV4dFV0aWxzLlRydW5jYXRlQXQuRU5EKTtcbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS53aGl0ZVNwYWNlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmV3VmFsdWUgPSB2YWx1ZSA9PT0gXCJpbml0aWFsXCIgPyBcIm5vd3JhcFwiIDogdmFsdWU7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGVbdGV4dF9iYXNlXzEud2hpdGVTcGFjZVByb3BlcnR5LnNldE5hdGl2ZV0uY2FsbCh0aGlzLCBuZXdWYWx1ZSk7XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIExhYmVsLnByb3RvdHlwZSwgXCJjcmVhdGVOYXRpdmVWaWV3XCIsIG51bGwpO1xuICAgIExhYmVsID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHRleHRfYmFzZV8xLkNTU1R5cGUoXCJMYWJlbFwiKVxuICAgIF0sIExhYmVsKTtcbiAgICByZXR1cm4gTGFiZWw7XG59KHRleHRfYmFzZV8xLlRleHRCYXNlKSk7XG5leHBvcnRzLkxhYmVsID0gTGFiZWw7XG5MYWJlbC5wcm90b3R5cGUuX2lzU2luZ2xlTGluZSA9IHRydWU7XG5MYWJlbC5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxhYmVsLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBsYXlvdXRfYmFzZV8xID0gcmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpKTtcbmxheW91dF9iYXNlXzEuVmlldy5wcm90b3R5cGUuZWZmZWN0aXZlTGVmdCA9IDA7XG5sYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLmVmZmVjdGl2ZVRvcCA9IDA7XG5mdW5jdGlvbiB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkge1xuICAgIGlmICghZWxlbWVudCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJlbGVtZW50IGNhbm5vdCBiZSBudWxsIG9yIHVuZGVmaW5pZWQuXCIpO1xuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudDtcbn1cbnZhciBBYnNvbHV0ZUxheW91dEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhBYnNvbHV0ZUxheW91dEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQWJzb2x1dGVMYXlvdXRCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEFic29sdXRlTGF5b3V0QmFzZS5nZXRMZWZ0ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyhlbGVtZW50KS5sZWZ0O1xuICAgIH07XG4gICAgQWJzb2x1dGVMYXlvdXRCYXNlLnNldExlZnQgPSBmdW5jdGlvbiAoZWxlbWVudCwgdmFsdWUpIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKGVsZW1lbnQpLmxlZnQgPSB2YWx1ZTtcbiAgICB9O1xuICAgIEFic29sdXRlTGF5b3V0QmFzZS5nZXRUb3AgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGVBcmdzKGVsZW1lbnQpLnRvcDtcbiAgICB9O1xuICAgIEFic29sdXRlTGF5b3V0QmFzZS5zZXRUb3AgPSBmdW5jdGlvbiAoZWxlbWVudCwgdmFsdWUpIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKGVsZW1lbnQpLnRvcCA9IHZhbHVlO1xuICAgIH07XG4gICAgQWJzb2x1dGVMYXlvdXRCYXNlLnByb3RvdHlwZS5vbkxlZnRDaGFuZ2VkID0gZnVuY3Rpb24gKHZpZXcsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgIH07XG4gICAgQWJzb2x1dGVMYXlvdXRCYXNlLnByb3RvdHlwZS5vblRvcENoYW5nZWQgPSBmdW5jdGlvbiAodmlldywgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgfTtcbiAgICBBYnNvbHV0ZUxheW91dEJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgbGF5b3V0X2Jhc2VfMS5DU1NUeXBlKFwiQWJzb2x1dGVMYXlvdXRcIilcbiAgICBdLCBBYnNvbHV0ZUxheW91dEJhc2UpO1xuICAgIHJldHVybiBBYnNvbHV0ZUxheW91dEJhc2U7XG59KGxheW91dF9iYXNlXzEuTGF5b3V0QmFzZSkpO1xuZXhwb3J0cy5BYnNvbHV0ZUxheW91dEJhc2UgPSBBYnNvbHV0ZUxheW91dEJhc2U7XG5BYnNvbHV0ZUxheW91dEJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLmxlZnRQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImxlZnRcIiwgZGVmYXVsdFZhbHVlOiBsYXlvdXRfYmFzZV8xLnplcm9MZW5ndGgsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0LmVmZmVjdGl2ZUxlZnQgPSBsYXlvdXRfYmFzZV8xLkxlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIHZhciBsYXlvdXQgPSB0YXJnZXQucGFyZW50O1xuICAgICAgICBpZiAobGF5b3V0IGluc3RhbmNlb2YgQWJzb2x1dGVMYXlvdXRCYXNlKSB7XG4gICAgICAgICAgICBsYXlvdXQub25MZWZ0Q2hhbmdlZCh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIGxheW91dF9iYXNlXzEuTGVuZ3RoLnBhcnNlKHYpOyB9XG59KTtcbmV4cG9ydHMubGVmdFByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuVmlldyk7XG5leHBvcnRzLnRvcFByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidG9wXCIsIGRlZmF1bHRWYWx1ZTogbGF5b3V0X2Jhc2VfMS56ZXJvTGVuZ3RoLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5lZmZlY3RpdmVUb3AgPSBsYXlvdXRfYmFzZV8xLkxlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIHZhciBsYXlvdXQgPSB0YXJnZXQucGFyZW50O1xuICAgICAgICBpZiAobGF5b3V0IGluc3RhbmNlb2YgQWJzb2x1dGVMYXlvdXRCYXNlKSB7XG4gICAgICAgICAgICBsYXlvdXQub25Ub3BDaGFuZ2VkKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbGF5b3V0X2Jhc2VfMS5MZW5ndGgucGFyc2Uodik7IH1cbn0pO1xuZXhwb3J0cy50b3BQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlZpZXcpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWJzb2x1dGUtbGF5b3V0LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGFic29sdXRlX2xheW91dF9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2Fic29sdXRlLWxheW91dC1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9hYnNvbHV0ZS1sYXlvdXQtY29tbW9uXCIpKTtcbmZ1bmN0aW9uIG1ha2VOYXRpdmVTZXR0ZXIoc2V0dGVyKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGxwID0gbmF0aXZlVmlldy5nZXRMYXlvdXRQYXJhbXMoKSB8fCBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbW1vbkxheW91dFBhcmFtcygpO1xuICAgICAgICBpZiAobHAgaW5zdGFuY2VvZiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ29tbW9uTGF5b3V0UGFyYW1zKSB7XG4gICAgICAgICAgICBzZXR0ZXIuY2FsbCh0aGlzLCBscCwgdmFsdWUpO1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRMYXlvdXRQYXJhbXMobHApO1xuICAgICAgICB9XG4gICAgfTtcbn1cbmFic29sdXRlX2xheW91dF9jb21tb25fMS5WaWV3LnByb3RvdHlwZVthYnNvbHV0ZV9sYXlvdXRfY29tbW9uXzEudG9wUHJvcGVydHkuc2V0TmF0aXZlXSA9IG1ha2VOYXRpdmVTZXR0ZXIoZnVuY3Rpb24gKGxwLCB2YWx1ZSkgeyBscC50b3AgPSBhYnNvbHV0ZV9sYXlvdXRfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHZhbHVlLCAwKTsgfSk7XG5hYnNvbHV0ZV9sYXlvdXRfY29tbW9uXzEuVmlldy5wcm90b3R5cGVbYWJzb2x1dGVfbGF5b3V0X2NvbW1vbl8xLmxlZnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gbWFrZU5hdGl2ZVNldHRlcihmdW5jdGlvbiAobHAsIHZhbHVlKSB7IGxwLmxlZnQgPSBhYnNvbHV0ZV9sYXlvdXRfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHZhbHVlLCAwKTsgfSk7XG52YXIgQWJzb2x1dGVMYXlvdXQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhBYnNvbHV0ZUxheW91dCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBYnNvbHV0ZUxheW91dCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBBYnNvbHV0ZUxheW91dC5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQWJzb2x1dGVMYXlvdXQodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICByZXR1cm4gQWJzb2x1dGVMYXlvdXQ7XG59KGFic29sdXRlX2xheW91dF9jb21tb25fMS5BYnNvbHV0ZUxheW91dEJhc2UpKTtcbmV4cG9ydHMuQWJzb2x1dGVMYXlvdXQgPSBBYnNvbHV0ZUxheW91dDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFic29sdXRlLWxheW91dC5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGF5b3V0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKTtcbmZ1bmN0aW9uIHZhbGlkYXRlQXJncyhlbGVtZW50KSB7XG4gICAgaWYgKCFlbGVtZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImVsZW1lbnQgY2Fubm90IGJlIG51bGwgb3IgdW5kZWZpbmllZC5cIik7XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50O1xufVxuX19leHBvcnQocmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpKTtcbnZhciBEb2NrTGF5b3V0QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKERvY2tMYXlvdXRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIERvY2tMYXlvdXRCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIERvY2tMYXlvdXRCYXNlLmdldERvY2sgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGVBcmdzKGVsZW1lbnQpLmRvY2s7XG4gICAgfTtcbiAgICBEb2NrTGF5b3V0QmFzZS5zZXREb2NrID0gZnVuY3Rpb24gKGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgICAgIHZhbGlkYXRlQXJncyhlbGVtZW50KS5kb2NrID0gdmFsdWU7XG4gICAgfTtcbiAgICBEb2NrTGF5b3V0QmFzZS5wcm90b3R5cGUub25Eb2NrQ2hhbmdlZCA9IGZ1bmN0aW9uICh2aWV3LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICB9O1xuICAgIERvY2tMYXlvdXRCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGxheW91dF9iYXNlXzEuQ1NTVHlwZShcIkRvY2tMYXlvdXRcIilcbiAgICBdLCBEb2NrTGF5b3V0QmFzZSk7XG4gICAgcmV0dXJuIERvY2tMYXlvdXRCYXNlO1xufShsYXlvdXRfYmFzZV8xLkxheW91dEJhc2UpKTtcbmV4cG9ydHMuRG9ja0xheW91dEJhc2UgPSBEb2NrTGF5b3V0QmFzZTtcbkRvY2tMYXlvdXRCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xudmFyIGRvY2tDb252ZXJ0ZXIgPSBsYXlvdXRfYmFzZV8xLm1ha2VQYXJzZXIobGF5b3V0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKFwibGVmdFwiLCBcInRvcFwiLCBcInJpZ2h0XCIsIFwiYm90dG9tXCIpKTtcbmV4cG9ydHMuZG9ja1Byb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZG9ja1wiLCBkZWZhdWx0VmFsdWU6IFwibGVmdFwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgbGF5b3V0X2Jhc2VfMS5WaWV3KSB7XG4gICAgICAgICAgICB2YXIgbGF5b3V0ID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgICAgIGlmIChsYXlvdXQgaW5zdGFuY2VvZiBEb2NrTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgICAgIGxheW91dC5vbkRvY2tDaGFuZ2VkKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBkb2NrQ29udmVydGVyXG59KTtcbmV4cG9ydHMuZG9ja1Byb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuVmlldyk7XG5leHBvcnRzLnN0cmV0Y2hMYXN0Q2hpbGRQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInN0cmV0Y2hMYXN0Q2hpbGRcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLCBhZmZlY3RzTGF5b3V0OiBsYXlvdXRfYmFzZV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogbGF5b3V0X2Jhc2VfMS5ib29sZWFuQ29udmVydGVyXG59KTtcbmV4cG9ydHMuc3RyZXRjaExhc3RDaGlsZFByb3BlcnR5LnJlZ2lzdGVyKERvY2tMYXlvdXRCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRvY2stbGF5b3V0LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGRvY2tfbGF5b3V0X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vZG9jay1sYXlvdXQtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vZG9jay1sYXlvdXQtY29tbW9uXCIpKTtcbmRvY2tfbGF5b3V0X2NvbW1vbl8xLlZpZXcucHJvdG90eXBlW2RvY2tfbGF5b3V0X2NvbW1vbl8xLmRvY2tQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgdmFyIGxwID0gbmF0aXZlVmlldy5nZXRMYXlvdXRQYXJhbXMoKSB8fCBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbW1vbkxheW91dFBhcmFtcygpO1xuICAgIGlmIChscCBpbnN0YW5jZW9mIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Db21tb25MYXlvdXRQYXJhbXMpIHtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcImxlZnRcIjpcbiAgICAgICAgICAgICAgICBscC5kb2NrID0gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkRvY2subGVmdDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ0b3BcIjpcbiAgICAgICAgICAgICAgICBscC5kb2NrID0gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkRvY2sudG9wO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInJpZ2h0XCI6XG4gICAgICAgICAgICAgICAgbHAuZG9jayA9IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Eb2NrLnJpZ2h0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImJvdHRvbVwiOlxuICAgICAgICAgICAgICAgIGxwLmRvY2sgPSBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuRG9jay5ib3R0b207XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWUgZm9yIGRvY2sgcHJvcGVydHk6IFwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0TGF5b3V0UGFyYW1zKGxwKTtcbiAgICB9XG59O1xudmFyIERvY2tMYXlvdXQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhEb2NrTGF5b3V0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIERvY2tMYXlvdXQoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgRG9ja0xheW91dC5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuRG9ja0xheW91dCh0aGlzLl9jb250ZXh0KTtcbiAgICB9O1xuICAgIERvY2tMYXlvdXQucHJvdG90eXBlW2RvY2tfbGF5b3V0X2NvbW1vbl8xLnN0cmV0Y2hMYXN0Q2hpbGRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBEb2NrTGF5b3V0LnByb3RvdHlwZVtkb2NrX2xheW91dF9jb21tb25fMS5zdHJldGNoTGFzdENoaWxkUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0U3RyZXRjaExhc3RDaGlsZCh2YWx1ZSk7XG4gICAgfTtcbiAgICByZXR1cm4gRG9ja0xheW91dDtcbn0oZG9ja19sYXlvdXRfY29tbW9uXzEuRG9ja0xheW91dEJhc2UpKTtcbmV4cG9ydHMuRG9ja0xheW91dCA9IERvY2tMYXlvdXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kb2NrLWxheW91dC5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGF5b3V0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKSk7XG5leHBvcnRzLk9SREVSX0RFRkFVTFQgPSAxO1xuZXhwb3J0cy5GTEVYX0dST1dfREVGQVVMVCA9IDAuMDtcbmV4cG9ydHMuRkxFWF9TSFJJTktfREVGQVVMVCA9IDEuMDtcbnZhciBGbGV4RGlyZWN0aW9uO1xuKGZ1bmN0aW9uIChGbGV4RGlyZWN0aW9uKSB7XG4gICAgRmxleERpcmVjdGlvbi5ST1cgPSBcInJvd1wiO1xuICAgIEZsZXhEaXJlY3Rpb24uUk9XX1JFVkVSU0UgPSBcInJvdy1yZXZlcnNlXCI7XG4gICAgRmxleERpcmVjdGlvbi5DT0xVTU4gPSBcImNvbHVtblwiO1xuICAgIEZsZXhEaXJlY3Rpb24uQ09MVU1OX1JFVkVSU0UgPSBcImNvbHVtbi1yZXZlcnNlXCI7XG4gICAgRmxleERpcmVjdGlvbi5pc1ZhbGlkID0gbGF5b3V0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKEZsZXhEaXJlY3Rpb24uUk9XLCBGbGV4RGlyZWN0aW9uLlJPV19SRVZFUlNFLCBGbGV4RGlyZWN0aW9uLkNPTFVNTiwgRmxleERpcmVjdGlvbi5DT0xVTU5fUkVWRVJTRSk7XG4gICAgRmxleERpcmVjdGlvbi5wYXJzZSA9IGxheW91dF9iYXNlXzEubWFrZVBhcnNlcihGbGV4RGlyZWN0aW9uLmlzVmFsaWQpO1xufSkoRmxleERpcmVjdGlvbiA9IGV4cG9ydHMuRmxleERpcmVjdGlvbiB8fCAoZXhwb3J0cy5GbGV4RGlyZWN0aW9uID0ge30pKTtcbnZhciBGbGV4V3JhcDtcbihmdW5jdGlvbiAoRmxleFdyYXApIHtcbiAgICBGbGV4V3JhcC5OT1dSQVAgPSBcIm5vd3JhcFwiO1xuICAgIEZsZXhXcmFwLldSQVAgPSBcIndyYXBcIjtcbiAgICBGbGV4V3JhcC5XUkFQX1JFVkVSU0UgPSBcIndyYXAtcmV2ZXJzZVwiO1xuICAgIEZsZXhXcmFwLmlzVmFsaWQgPSBsYXlvdXRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoRmxleFdyYXAuTk9XUkFQLCBGbGV4V3JhcC5XUkFQLCBGbGV4V3JhcC5XUkFQX1JFVkVSU0UpO1xuICAgIEZsZXhXcmFwLnBhcnNlID0gbGF5b3V0X2Jhc2VfMS5tYWtlUGFyc2VyKEZsZXhXcmFwLmlzVmFsaWQpO1xufSkoRmxleFdyYXAgPSBleHBvcnRzLkZsZXhXcmFwIHx8IChleHBvcnRzLkZsZXhXcmFwID0ge30pKTtcbnZhciBKdXN0aWZ5Q29udGVudDtcbihmdW5jdGlvbiAoSnVzdGlmeUNvbnRlbnQpIHtcbiAgICBKdXN0aWZ5Q29udGVudC5GTEVYX1NUQVJUID0gXCJmbGV4LXN0YXJ0XCI7XG4gICAgSnVzdGlmeUNvbnRlbnQuRkxFWF9FTkQgPSBcImZsZXgtZW5kXCI7XG4gICAgSnVzdGlmeUNvbnRlbnQuQ0VOVEVSID0gXCJjZW50ZXJcIjtcbiAgICBKdXN0aWZ5Q29udGVudC5TUEFDRV9CRVRXRUVOID0gXCJzcGFjZS1iZXR3ZWVuXCI7XG4gICAgSnVzdGlmeUNvbnRlbnQuU1BBQ0VfQVJPVU5EID0gXCJzcGFjZS1hcm91bmRcIjtcbiAgICBKdXN0aWZ5Q29udGVudC5pc1ZhbGlkID0gbGF5b3V0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKEp1c3RpZnlDb250ZW50LkZMRVhfU1RBUlQsIEp1c3RpZnlDb250ZW50LkZMRVhfRU5ELCBKdXN0aWZ5Q29udGVudC5DRU5URVIsIEp1c3RpZnlDb250ZW50LlNQQUNFX0JFVFdFRU4sIEp1c3RpZnlDb250ZW50LlNQQUNFX0FST1VORCk7XG4gICAgSnVzdGlmeUNvbnRlbnQucGFyc2UgPSBsYXlvdXRfYmFzZV8xLm1ha2VQYXJzZXIoSnVzdGlmeUNvbnRlbnQuaXNWYWxpZCk7XG59KShKdXN0aWZ5Q29udGVudCA9IGV4cG9ydHMuSnVzdGlmeUNvbnRlbnQgfHwgKGV4cG9ydHMuSnVzdGlmeUNvbnRlbnQgPSB7fSkpO1xudmFyIEZsZXhCYXNpc1BlcmNlbnQ7XG4oZnVuY3Rpb24gKEZsZXhCYXNpc1BlcmNlbnQpIHtcbiAgICBGbGV4QmFzaXNQZXJjZW50LkRFRkFVTFQgPSAtMTtcbn0pKEZsZXhCYXNpc1BlcmNlbnQgPSBleHBvcnRzLkZsZXhCYXNpc1BlcmNlbnQgfHwgKGV4cG9ydHMuRmxleEJhc2lzUGVyY2VudCA9IHt9KSk7XG52YXIgQWxpZ25JdGVtcztcbihmdW5jdGlvbiAoQWxpZ25JdGVtcykge1xuICAgIEFsaWduSXRlbXMuRkxFWF9TVEFSVCA9IFwiZmxleC1zdGFydFwiO1xuICAgIEFsaWduSXRlbXMuRkxFWF9FTkQgPSBcImZsZXgtZW5kXCI7XG4gICAgQWxpZ25JdGVtcy5DRU5URVIgPSBcImNlbnRlclwiO1xuICAgIEFsaWduSXRlbXMuQkFTRUxJTkUgPSBcImJhc2VsaW5lXCI7XG4gICAgQWxpZ25JdGVtcy5TVFJFVENIID0gXCJzdHJldGNoXCI7XG4gICAgQWxpZ25JdGVtcy5pc1ZhbGlkID0gbGF5b3V0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKEFsaWduSXRlbXMuRkxFWF9TVEFSVCwgQWxpZ25JdGVtcy5GTEVYX0VORCwgQWxpZ25JdGVtcy5DRU5URVIsIEFsaWduSXRlbXMuQkFTRUxJTkUsIEFsaWduSXRlbXMuU1RSRVRDSCk7XG4gICAgQWxpZ25JdGVtcy5wYXJzZSA9IGxheW91dF9iYXNlXzEubWFrZVBhcnNlcihBbGlnbkl0ZW1zLmlzVmFsaWQpO1xufSkoQWxpZ25JdGVtcyA9IGV4cG9ydHMuQWxpZ25JdGVtcyB8fCAoZXhwb3J0cy5BbGlnbkl0ZW1zID0ge30pKTtcbnZhciBBbGlnbkNvbnRlbnQ7XG4oZnVuY3Rpb24gKEFsaWduQ29udGVudCkge1xuICAgIEFsaWduQ29udGVudC5GTEVYX1NUQVJUID0gXCJmbGV4LXN0YXJ0XCI7XG4gICAgQWxpZ25Db250ZW50LkZMRVhfRU5EID0gXCJmbGV4LWVuZFwiO1xuICAgIEFsaWduQ29udGVudC5DRU5URVIgPSBcImNlbnRlclwiO1xuICAgIEFsaWduQ29udGVudC5TUEFDRV9CRVRXRUVOID0gXCJzcGFjZS1iZXR3ZWVuXCI7XG4gICAgQWxpZ25Db250ZW50LlNQQUNFX0FST1VORCA9IFwic3BhY2UtYXJvdW5kXCI7XG4gICAgQWxpZ25Db250ZW50LlNUUkVUQ0ggPSBcInN0cmV0Y2hcIjtcbiAgICBBbGlnbkNvbnRlbnQuaXNWYWxpZCA9IGxheW91dF9iYXNlXzEubWFrZVZhbGlkYXRvcihBbGlnbkNvbnRlbnQuRkxFWF9TVEFSVCwgQWxpZ25Db250ZW50LkZMRVhfRU5ELCBBbGlnbkNvbnRlbnQuQ0VOVEVSLCBBbGlnbkNvbnRlbnQuU1BBQ0VfQkVUV0VFTiwgQWxpZ25Db250ZW50LlNQQUNFX0FST1VORCwgQWxpZ25Db250ZW50LlNUUkVUQ0gpO1xuICAgIEFsaWduQ29udGVudC5wYXJzZSA9IGxheW91dF9iYXNlXzEubWFrZVBhcnNlcihBbGlnbkNvbnRlbnQuaXNWYWxpZCk7XG59KShBbGlnbkNvbnRlbnQgPSBleHBvcnRzLkFsaWduQ29udGVudCB8fCAoZXhwb3J0cy5BbGlnbkNvbnRlbnQgPSB7fSkpO1xudmFyIE9yZGVyO1xuKGZ1bmN0aW9uIChPcmRlcikge1xuICAgIGZ1bmN0aW9uIGlzVmFsaWQodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGlzRmluaXRlKHBhcnNlSW50KHZhbHVlKSk7XG4gICAgfVxuICAgIE9yZGVyLmlzVmFsaWQgPSBpc1ZhbGlkO1xuICAgIE9yZGVyLnBhcnNlID0gcGFyc2VJbnQ7XG59KShPcmRlciA9IGV4cG9ydHMuT3JkZXIgfHwgKGV4cG9ydHMuT3JkZXIgPSB7fSkpO1xudmFyIEZsZXhHcm93O1xuKGZ1bmN0aW9uIChGbGV4R3Jvdykge1xuICAgIGZ1bmN0aW9uIGlzVmFsaWQodmFsdWUpIHtcbiAgICAgICAgdmFyIHBhcnNlZCA9IHBhcnNlSW50KHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIGlzRmluaXRlKHBhcnNlZCkgJiYgdmFsdWUgPj0gMDtcbiAgICB9XG4gICAgRmxleEdyb3cuaXNWYWxpZCA9IGlzVmFsaWQ7XG4gICAgRmxleEdyb3cucGFyc2UgPSBwYXJzZUZsb2F0O1xufSkoRmxleEdyb3cgPSBleHBvcnRzLkZsZXhHcm93IHx8IChleHBvcnRzLkZsZXhHcm93ID0ge30pKTtcbnZhciBGbGV4U2hyaW5rO1xuKGZ1bmN0aW9uIChGbGV4U2hyaW5rKSB7XG4gICAgZnVuY3Rpb24gaXNWYWxpZCh2YWx1ZSkge1xuICAgICAgICB2YXIgcGFyc2VkID0gcGFyc2VJbnQodmFsdWUpO1xuICAgICAgICByZXR1cm4gaXNGaW5pdGUocGFyc2VkKSAmJiB2YWx1ZSA+PSAwO1xuICAgIH1cbiAgICBGbGV4U2hyaW5rLmlzVmFsaWQgPSBpc1ZhbGlkO1xuICAgIEZsZXhTaHJpbmsucGFyc2UgPSBwYXJzZUZsb2F0O1xufSkoRmxleFNocmluayA9IGV4cG9ydHMuRmxleFNocmluayB8fCAoZXhwb3J0cy5GbGV4U2hyaW5rID0ge30pKTtcbnZhciBGbGV4V3JhcEJlZm9yZTtcbihmdW5jdGlvbiAoRmxleFdyYXBCZWZvcmUpIHtcbiAgICBmdW5jdGlvbiBpc1ZhbGlkKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiYm9vbGVhblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB2YXIgc3RyID0gdmFsdWUudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICByZXR1cm4gc3RyID09PSBcInRydWVcIiB8fCBzdHIgPT09IFwiZmFsc2VcIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIEZsZXhXcmFwQmVmb3JlLmlzVmFsaWQgPSBpc1ZhbGlkO1xuICAgIGZ1bmN0aW9uIHBhcnNlKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSAmJiB2YWx1ZS50b1N0cmluZygpLnRyaW0oKS50b0xvd2VyQ2FzZSgpID09PSBcInRydWVcIjtcbiAgICB9XG4gICAgRmxleFdyYXBCZWZvcmUucGFyc2UgPSBwYXJzZTtcbn0pKEZsZXhXcmFwQmVmb3JlID0gZXhwb3J0cy5GbGV4V3JhcEJlZm9yZSB8fCAoZXhwb3J0cy5GbGV4V3JhcEJlZm9yZSA9IHt9KSk7XG52YXIgQWxpZ25TZWxmO1xuKGZ1bmN0aW9uIChBbGlnblNlbGYpIHtcbiAgICBBbGlnblNlbGYuQVVUTyA9IFwiYXV0b1wiO1xuICAgIEFsaWduU2VsZi5GTEVYX1NUQVJUID0gXCJmbGV4LXN0YXJ0XCI7XG4gICAgQWxpZ25TZWxmLkZMRVhfRU5EID0gXCJmbGV4LWVuZFwiO1xuICAgIEFsaWduU2VsZi5DRU5URVIgPSBcImNlbnRlclwiO1xuICAgIEFsaWduU2VsZi5CQVNFTElORSA9IFwiYmFzZWxpbmVcIjtcbiAgICBBbGlnblNlbGYuU1RSRVRDSCA9IFwic3RyZXRjaFwiO1xuICAgIEFsaWduU2VsZi5pc1ZhbGlkID0gbGF5b3V0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKEFsaWduU2VsZi5BVVRPLCBBbGlnblNlbGYuRkxFWF9TVEFSVCwgQWxpZ25TZWxmLkZMRVhfRU5ELCBBbGlnblNlbGYuQ0VOVEVSLCBBbGlnblNlbGYuQkFTRUxJTkUsIEFsaWduU2VsZi5TVFJFVENIKTtcbiAgICBBbGlnblNlbGYucGFyc2UgPSBsYXlvdXRfYmFzZV8xLm1ha2VQYXJzZXIoQWxpZ25TZWxmLmlzVmFsaWQpO1xufSkoQWxpZ25TZWxmID0gZXhwb3J0cy5BbGlnblNlbGYgfHwgKGV4cG9ydHMuQWxpZ25TZWxmID0ge30pKTtcbmZ1bmN0aW9uIHZhbGlkYXRlQXJncyhlbGVtZW50KSB7XG4gICAgaWYgKCFlbGVtZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImVsZW1lbnQgY2Fubm90IGJlIG51bGwgb3IgdW5kZWZpbmllZC5cIik7XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50O1xufVxudmFyIEZsZXhib3hMYXlvdXRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRmxleGJveExheW91dEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRmxleGJveExheW91dEJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZsZXhib3hMYXlvdXRCYXNlLnByb3RvdHlwZSwgXCJmbGV4RGlyZWN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mbGV4RGlyZWN0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mbGV4RGlyZWN0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbGV4Ym94TGF5b3V0QmFzZS5wcm90b3R5cGUsIFwiZmxleFdyYXBcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZsZXhXcmFwO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mbGV4V3JhcCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmxleGJveExheW91dEJhc2UucHJvdG90eXBlLCBcImp1c3RpZnlDb250ZW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5qdXN0aWZ5Q29udGVudDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZsZXhib3hMYXlvdXRCYXNlLnByb3RvdHlwZSwgXCJhbGlnbkl0ZW1zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5hbGlnbkl0ZW1zO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5hbGlnbkl0ZW1zID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbGV4Ym94TGF5b3V0QmFzZS5wcm90b3R5cGUsIFwiYWxpZ25Db250ZW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5hbGlnbkNvbnRlbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmFsaWduQ29udGVudCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGbGV4Ym94TGF5b3V0QmFzZS5zZXRPcmRlciA9IGZ1bmN0aW9uICh2aWV3LCBvcmRlcikge1xuICAgICAgICB2YWxpZGF0ZUFyZ3Modmlldykuc3R5bGUub3JkZXIgPSBvcmRlcjtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXRCYXNlLmdldE9yZGVyID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyh2aWV3KS5zdHlsZS5vcmRlcjtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXRCYXNlLnNldEZsZXhHcm93ID0gZnVuY3Rpb24gKHZpZXcsIGdyb3cpIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKHZpZXcpLnN0eWxlLmZsZXhHcm93ID0gZ3JvdztcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXRCYXNlLmdldEZsZXhHcm93ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyh2aWV3KS5zdHlsZS5mbGV4R3JvdztcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXRCYXNlLnNldEZsZXhTaHJpbmsgPSBmdW5jdGlvbiAodmlldywgc2hyaW5rKSB7XG4gICAgICAgIHZhbGlkYXRlQXJncyh2aWV3KS5zdHlsZS5mbGV4U2hyaW5rID0gc2hyaW5rO1xuICAgIH07XG4gICAgRmxleGJveExheW91dEJhc2UuZ2V0RmxleFNocmluayA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZUFyZ3Modmlldykuc3R5bGUuZmxleFNocmluaztcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXRCYXNlLnNldEFsaWduU2VsZiA9IGZ1bmN0aW9uICh2aWV3LCBhbGlnbikge1xuICAgICAgICB2YWxpZGF0ZUFyZ3Modmlldykuc3R5bGUuYWxpZ25TZWxmID0gYWxpZ247XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0QmFzZS5nZXRBbGlnblNlbGYgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGVBcmdzKHZpZXcpLnN0eWxlLmFsaWduU2VsZjtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXRCYXNlLnNldEZsZXhXcmFwQmVmb3JlID0gZnVuY3Rpb24gKHZpZXcsIHdyYXApIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKHZpZXcpLnN0eWxlLmZsZXhXcmFwQmVmb3JlID0gd3JhcDtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXRCYXNlLmdldEZsZXhXcmFwQmVmb3JlID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyh2aWV3KS5zdHlsZS5mbGV4V3JhcEJlZm9yZTtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXRCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGxheW91dF9iYXNlXzEuQ1NTVHlwZShcIkZsZXhib3hMYXlvdXRcIilcbiAgICBdLCBGbGV4Ym94TGF5b3V0QmFzZSk7XG4gICAgcmV0dXJuIEZsZXhib3hMYXlvdXRCYXNlO1xufShsYXlvdXRfYmFzZV8xLkxheW91dEJhc2UpKTtcbmV4cG9ydHMuRmxleGJveExheW91dEJhc2UgPSBGbGV4Ym94TGF5b3V0QmFzZTtcbkZsZXhib3hMYXlvdXRCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy5mbGV4RGlyZWN0aW9uUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiZmxleERpcmVjdGlvblwiLCBjc3NOYW1lOiBcImZsZXgtZGlyZWN0aW9uXCIsIGRlZmF1bHRWYWx1ZTogRmxleERpcmVjdGlvbi5ST1csIGFmZmVjdHNMYXlvdXQ6IGxheW91dF9iYXNlXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBGbGV4RGlyZWN0aW9uLnBhcnNlIH0pO1xuZXhwb3J0cy5mbGV4RGlyZWN0aW9uUHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5TdHlsZSk7XG5leHBvcnRzLmZsZXhXcmFwUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiZmxleFdyYXBcIiwgY3NzTmFtZTogXCJmbGV4LXdyYXBcIiwgZGVmYXVsdFZhbHVlOiBcIm5vd3JhcFwiLCBhZmZlY3RzTGF5b3V0OiBsYXlvdXRfYmFzZV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogRmxleFdyYXAucGFyc2UgfSk7XG5leHBvcnRzLmZsZXhXcmFwUHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5TdHlsZSk7XG5leHBvcnRzLmp1c3RpZnlDb250ZW50UHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwianVzdGlmeUNvbnRlbnRcIiwgY3NzTmFtZTogXCJqdXN0aWZ5LWNvbnRlbnRcIiwgZGVmYXVsdFZhbHVlOiBKdXN0aWZ5Q29udGVudC5GTEVYX1NUQVJULCBhZmZlY3RzTGF5b3V0OiBsYXlvdXRfYmFzZV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogSnVzdGlmeUNvbnRlbnQucGFyc2UgfSk7XG5leHBvcnRzLmp1c3RpZnlDb250ZW50UHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5TdHlsZSk7XG5leHBvcnRzLmFsaWduSXRlbXNQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJhbGlnbkl0ZW1zXCIsIGNzc05hbWU6IFwiYWxpZ24taXRlbXNcIiwgZGVmYXVsdFZhbHVlOiBBbGlnbkl0ZW1zLlNUUkVUQ0gsIGFmZmVjdHNMYXlvdXQ6IGxheW91dF9iYXNlXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBBbGlnbkl0ZW1zLnBhcnNlIH0pO1xuZXhwb3J0cy5hbGlnbkl0ZW1zUHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5TdHlsZSk7XG5leHBvcnRzLmFsaWduQ29udGVudFByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImFsaWduQ29udGVudFwiLCBjc3NOYW1lOiBcImFsaWduLWNvbnRlbnRcIiwgZGVmYXVsdFZhbHVlOiBBbGlnbkNvbnRlbnQuU1RSRVRDSCwgYWZmZWN0c0xheW91dDogbGF5b3V0X2Jhc2VfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IEFsaWduQ29udGVudC5wYXJzZSB9KTtcbmV4cG9ydHMuYWxpZ25Db250ZW50UHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5TdHlsZSk7XG5leHBvcnRzLm9yZGVyUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwib3JkZXJcIiwgY3NzTmFtZTogXCJvcmRlclwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuT1JERVJfREVGQVVMVCwgdmFsdWVDb252ZXJ0ZXI6IE9yZGVyLnBhcnNlIH0pO1xuZXhwb3J0cy5vcmRlclByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuU3R5bGUpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGxheW91dF9iYXNlXzEuVmlldy5wcm90b3R5cGUsIFwib3JkZXJcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5vcmRlcjtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc3R5bGUub3JkZXIgPSB2YWx1ZTtcbiAgICB9LFxuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlXG59KTtcbmV4cG9ydHMuZmxleEdyb3dQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJmbGV4R3Jvd1wiLCBjc3NOYW1lOiBcImZsZXgtZ3Jvd1wiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuRkxFWF9HUk9XX0RFRkFVTFQsIHZhbHVlQ29udmVydGVyOiBGbGV4R3Jvdy5wYXJzZSB9KTtcbmV4cG9ydHMuZmxleEdyb3dQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlN0eWxlKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShsYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLCBcImZsZXhHcm93XCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZmxleEdyb3c7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnN0eWxlLmZsZXhHcm93ID0gdmFsdWU7XG4gICAgfSxcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxufSk7XG5leHBvcnRzLmZsZXhTaHJpbmtQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJmbGV4U2hyaW5rXCIsIGNzc05hbWU6IFwiZmxleC1zaHJpbmtcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLkZMRVhfU0hSSU5LX0RFRkFVTFQsIHZhbHVlQ29udmVydGVyOiBGbGV4U2hyaW5rLnBhcnNlIH0pO1xuZXhwb3J0cy5mbGV4U2hyaW5rUHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5TdHlsZSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkobGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZSwgXCJmbGV4U2hyaW5rXCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZmxleFNocmluaztcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc3R5bGUuZmxleFNocmluayA9IHZhbHVlO1xuICAgIH0sXG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBjb25maWd1cmFibGU6IHRydWVcbn0pO1xuZXhwb3J0cy5mbGV4V3JhcEJlZm9yZVByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImZsZXhXcmFwQmVmb3JlXCIsIGNzc05hbWU6IFwiZmxleC13cmFwLWJlZm9yZVwiLCBkZWZhdWx0VmFsdWU6IGZhbHNlLCB2YWx1ZUNvbnZlcnRlcjogRmxleFdyYXBCZWZvcmUucGFyc2UgfSk7XG5leHBvcnRzLmZsZXhXcmFwQmVmb3JlUHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5TdHlsZSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkobGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZSwgXCJmbGV4V3JhcEJlZm9yZVwiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZsZXhXcmFwQmVmb3JlO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zdHlsZS5mbGV4V3JhcEJlZm9yZSA9IHZhbHVlO1xuICAgIH0sXG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBjb25maWd1cmFibGU6IHRydWVcbn0pO1xuZXhwb3J0cy5hbGlnblNlbGZQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJhbGlnblNlbGZcIiwgY3NzTmFtZTogXCJhbGlnbi1zZWxmXCIsIGRlZmF1bHRWYWx1ZTogQWxpZ25TZWxmLkFVVE8sIHZhbHVlQ29udmVydGVyOiBBbGlnblNlbGYucGFyc2UgfSk7XG5leHBvcnRzLmFsaWduU2VsZlByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuU3R5bGUpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGxheW91dF9iYXNlXzEuVmlldy5wcm90b3R5cGUsIFwiYWxpZ25TZWxmXCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYWxpZ25TZWxmO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zdHlsZS5hbGlnblNlbGYgPSB2YWx1ZTtcbiAgICB9LFxuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlXG59KTtcbnZhciBmbGV4Rmxvd1Byb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZmxleEZsb3dcIiwgY3NzTmFtZTogXCJmbGV4LWZsb3dcIixcbiAgICBnZXR0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmxleERpcmVjdGlvbiArIFwiIFwiICsgdGhpcy5mbGV4V3JhcDtcbiAgICB9LFxuICAgIGNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwcm9wZXJ0aWVzID0gW107XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbGF5b3V0X2Jhc2VfMS51bnNldFZhbHVlKSB7XG4gICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleERpcmVjdGlvblByb3BlcnR5LCB2YWx1ZV0pO1xuICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhXcmFwUHJvcGVydHksIHZhbHVlXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgdHJpbW1lZCA9IHZhbHVlICYmIHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIGlmICh0cmltbWVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlcyA9IHRyaW1tZWQuc3BsaXQoL1xccysvKTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzLmxlbmd0aCA+PSAxICYmIEZsZXhEaXJlY3Rpb24uaXNWYWxpZCh2YWx1ZXNbMF0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4RGlyZWN0aW9uUHJvcGVydHksIEZsZXhEaXJlY3Rpb24ucGFyc2UodmFsdWVzWzBdKV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodmFsdWUubGVuZ3RoID49IDIgJiYgRmxleFdyYXAuaXNWYWxpZCh2YWx1ZXNbMV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4V3JhcFByb3BlcnR5LCBGbGV4V3JhcC5wYXJzZSh2YWx1ZXNbMV0pXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9wZXJ0aWVzO1xuICAgIH1cbn0pO1xuZmxleEZsb3dQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlN0eWxlKTtcbnZhciBmbGV4UHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJmbGV4XCIsIGNzc05hbWU6IFwiZmxleFwiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mbGV4R3JvdyArIFwiIFwiICsgdGhpcy5mbGV4U2hyaW5rO1xuICAgIH0sXG4gICAgY29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHByb3BlcnRpZXMgPSBbXTtcbiAgICAgICAgaWYgKHZhbHVlID09PSBsYXlvdXRfYmFzZV8xLnVuc2V0VmFsdWUpIHtcbiAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4R3Jvd1Byb3BlcnR5LCB2YWx1ZV0pO1xuICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhTaHJpbmtQcm9wZXJ0eSwgdmFsdWVdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciB0cmltbWVkID0gdmFsdWUgJiYgdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgaWYgKHRyaW1tZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWVzID0gdHJpbW1lZC5zcGxpdCgvXFxzKy8pO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodmFsdWVzWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaW5pdGFsXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhHcm93UHJvcGVydHksIDBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleFNocmlua1Byb3BlcnR5LCAxXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYXV0b1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4R3Jvd1Byb3BlcnR5LCAxXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhTaHJpbmtQcm9wZXJ0eSwgMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm5vbmVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleEdyb3dQcm9wZXJ0eSwgMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4U2hyaW5rUHJvcGVydHksIDBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZsZXhHcm93LmlzVmFsaWQodmFsdWVzWzBdKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleEdyb3dQcm9wZXJ0eSwgRmxleEdyb3cucGFyc2UodmFsdWVzWzBdKV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleFNocmlua1Byb3BlcnR5LCAxXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID49IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKEZsZXhHcm93LmlzVmFsaWQodmFsdWVzWzBdKSAmJiBGbGV4U2hyaW5rLmlzVmFsaWQodmFsdWVzWzFdKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhHcm93UHJvcGVydHksIEZsZXhHcm93LnBhcnNlKHZhbHVlc1swXSldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4U2hyaW5rUHJvcGVydHksIEZsZXhTaHJpbmsucGFyc2UodmFsdWVzWzFdKV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9wZXJ0aWVzO1xuICAgIH1cbn0pO1xuZmxleFByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuU3R5bGUpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmxleGJveC1sYXlvdXQtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG52YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmbGV4Ym94X2xheW91dF9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2ZsZXhib3gtbGF5b3V0LWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2ZsZXhib3gtbGF5b3V0LWNvbW1vblwiKSk7XG52YXIgd2lkZ2V0RmxleGJveExheW91dDtcbnZhciB3aWRnZXRMYXlvdXRQYXJhbXM7XG5mdW5jdGlvbiBtYWtlTmF0aXZlU2V0dGVyKHNldHRlcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBscCA9IG5hdGl2ZVZpZXcuZ2V0TGF5b3V0UGFyYW1zKCkgfHwgbmV3IHdpZGdldExheW91dFBhcmFtcygpO1xuICAgICAgICBpZiAobHAgaW5zdGFuY2VvZiB3aWRnZXRMYXlvdXRQYXJhbXMpIHtcbiAgICAgICAgICAgIHNldHRlcihscCwgdmFsdWUpO1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRMYXlvdXRQYXJhbXMobHApO1xuICAgICAgICB9XG4gICAgfTtcbn1cbmZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLlZpZXcucHJvdG90eXBlW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLm9yZGVyUHJvcGVydHkuc2V0TmF0aXZlXSA9IG1ha2VOYXRpdmVTZXR0ZXIoZnVuY3Rpb24gKGxwLCB2YWx1ZSkgeyByZXR1cm4gbHAub3JkZXIgPSB2YWx1ZTsgfSk7XG5mbGV4Ym94X2xheW91dF9jb21tb25fMS5WaWV3LnByb3RvdHlwZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5mbGV4R3Jvd1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBtYWtlTmF0aXZlU2V0dGVyKGZ1bmN0aW9uIChscCwgdmFsdWUpIHsgcmV0dXJuIGxwLmZsZXhHcm93ID0gdmFsdWU7IH0pO1xuZmxleGJveF9sYXlvdXRfY29tbW9uXzEuVmlldy5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuZmxleFNocmlua1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBtYWtlTmF0aXZlU2V0dGVyKGZ1bmN0aW9uIChscCwgdmFsdWUpIHsgcmV0dXJuIGxwLmZsZXhTaHJpbmsgPSB2YWx1ZTsgfSk7XG5mbGV4Ym94X2xheW91dF9jb21tb25fMS5WaWV3LnByb3RvdHlwZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5mbGV4V3JhcEJlZm9yZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBtYWtlTmF0aXZlU2V0dGVyKGZ1bmN0aW9uIChscCwgdmFsdWUpIHsgcmV0dXJuIGxwLndyYXBCZWZvcmUgPSB2YWx1ZTsgfSk7XG5mbGV4Ym94X2xheW91dF9jb21tb25fMS5WaWV3LnByb3RvdHlwZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5hbGlnblNlbGZQcm9wZXJ0eS5zZXROYXRpdmVdID0gbWFrZU5hdGl2ZVNldHRlcihmdW5jdGlvbiAobHAsIHZhbHVlKSB7IHJldHVybiBscC5hbGlnblNlbGYgPSBhbGlnblNlbGZNYXBbdmFsdWVdOyB9KTtcbnZhciBmbGV4RGlyZWN0aW9uTWFwID0gKF9hID0ge30sXG4gICAgX2FbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5ST1ddID0gMCxcbiAgICBfYVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4RGlyZWN0aW9uLlJPV19SRVZFUlNFXSA9IDEsXG4gICAgX2FbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5DT0xVTU5dID0gMixcbiAgICBfYVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4RGlyZWN0aW9uLkNPTFVNTl9SRVZFUlNFXSA9IDMsXG4gICAgX2EpO1xudmFyIGZsZXhXcmFwTWFwID0gKF9iID0ge30sXG4gICAgX2JbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleFdyYXAuTk9XUkFQXSA9IDAsXG4gICAgX2JbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleFdyYXAuV1JBUF0gPSAxLFxuICAgIF9iW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhXcmFwLldSQVBfUkVWRVJTRV0gPSAyLFxuICAgIF9iKTtcbnZhciBqdXN0aWZ5Q29udGVudE1hcCA9IChfYyA9IHt9LFxuICAgIF9jW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkp1c3RpZnlDb250ZW50LkZMRVhfU1RBUlRdID0gMCxcbiAgICBfY1tmbGV4Ym94X2xheW91dF9jb21tb25fMS5KdXN0aWZ5Q29udGVudC5GTEVYX0VORF0gPSAxLFxuICAgIF9jW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkp1c3RpZnlDb250ZW50LkNFTlRFUl0gPSAyLFxuICAgIF9jW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkp1c3RpZnlDb250ZW50LlNQQUNFX0JFVFdFRU5dID0gMyxcbiAgICBfY1tmbGV4Ym94X2xheW91dF9jb21tb25fMS5KdXN0aWZ5Q29udGVudC5TUEFDRV9BUk9VTkRdID0gNCxcbiAgICBfYyk7XG52YXIgYWxpZ25JdGVtc01hcCA9IChfZCA9IHt9LFxuICAgIF9kW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduSXRlbXMuRkxFWF9TVEFSVF0gPSAwLFxuICAgIF9kW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduSXRlbXMuRkxFWF9FTkRdID0gMSxcbiAgICBfZFtmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnbkl0ZW1zLkNFTlRFUl0gPSAyLFxuICAgIF9kW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduSXRlbXMuQkFTRUxJTkVdID0gMyxcbiAgICBfZFtmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnbkl0ZW1zLlNUUkVUQ0hdID0gNCxcbiAgICBfZCk7XG52YXIgYWxpZ25Db250ZW50TWFwID0gKF9lID0ge30sXG4gICAgX2VbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25Db250ZW50LkZMRVhfU1RBUlRdID0gMCxcbiAgICBfZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnbkNvbnRlbnQuRkxFWF9FTkRdID0gMSxcbiAgICBfZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnbkNvbnRlbnQuQ0VOVEVSXSA9IDIsXG4gICAgX2VbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25Db250ZW50LlNQQUNFX0JFVFdFRU5dID0gMyxcbiAgICBfZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnbkNvbnRlbnQuU1BBQ0VfQVJPVU5EXSA9IDQsXG4gICAgX2VbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25Db250ZW50LlNUUkVUQ0hdID0gNSxcbiAgICBfZSk7XG52YXIgYWxpZ25TZWxmTWFwID0gKF9mID0ge30sXG4gICAgX2ZbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25TZWxmLkFVVE9dID0gLTEsXG4gICAgX2ZbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25TZWxmLkZMRVhfU1RBUlRdID0gMCxcbiAgICBfZltmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnblNlbGYuRkxFWF9FTkRdID0gMSxcbiAgICBfZltmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnblNlbGYuQ0VOVEVSXSA9IDIsXG4gICAgX2ZbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25TZWxmLkJBU0VMSU5FXSA9IDMsXG4gICAgX2ZbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25TZWxmLlNUUkVUQ0hdID0gNCxcbiAgICBfZik7XG52YXIgRmxleGJveExheW91dCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZsZXhib3hMYXlvdXQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRmxleGJveExheW91dCgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgaWYgKCF3aWRnZXRGbGV4Ym94TGF5b3V0KSB7XG4gICAgICAgICAgICB3aWRnZXRGbGV4Ym94TGF5b3V0ID0gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkZsZXhib3hMYXlvdXQ7XG4gICAgICAgICAgICB3aWRnZXRMYXlvdXRQYXJhbXMgPSB3aWRnZXRGbGV4Ym94TGF5b3V0LkxheW91dFBhcmFtcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgd2lkZ2V0RmxleGJveExheW91dCh0aGlzLl9jb250ZXh0KTtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmludmFsaWRhdGVPcmRlcnNDYWNoZSgpO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuZmxleERpcmVjdGlvblByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuZmxleERpcmVjdGlvblByb3BlcnR5LmRlZmF1bHRWYWx1ZTtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmZsZXhEaXJlY3Rpb25Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKGZsZXhEaXJlY3Rpb24pIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEZsZXhEaXJlY3Rpb24oZmxleERpcmVjdGlvbk1hcFtmbGV4RGlyZWN0aW9uXSk7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5mbGV4V3JhcFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuZmxleFdyYXBQcm9wZXJ0eS5kZWZhdWx0VmFsdWU7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5mbGV4V3JhcFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAoZmxleFdyYXApIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEZsZXhXcmFwKGZsZXhXcmFwTWFwW2ZsZXhXcmFwXSk7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5qdXN0aWZ5Q29udGVudFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuanVzdGlmeUNvbnRlbnRQcm9wZXJ0eS5kZWZhdWx0VmFsdWU7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5qdXN0aWZ5Q29udGVudFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAoanVzdGlmeUNvbnRlbnQpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEp1c3RpZnlDb250ZW50KGp1c3RpZnlDb250ZW50TWFwW2p1c3RpZnlDb250ZW50XSk7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5hbGlnbkl0ZW1zUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBmbGV4Ym94X2xheW91dF9jb21tb25fMS5hbGlnbkl0ZW1zUHJvcGVydHkuZGVmYXVsdFZhbHVlO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuYWxpZ25JdGVtc1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAoYWxpZ25JdGVtcykge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0QWxpZ25JdGVtcyhhbGlnbkl0ZW1zTWFwW2FsaWduSXRlbXNdKTtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmFsaWduQ29udGVudFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuYWxpZ25Db250ZW50UHJvcGVydHkuZGVmYXVsdFZhbHVlO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuYWxpZ25Db250ZW50UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uIChhbGlnbkNvbnRlbnQpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEFsaWduQ29udGVudChhbGlnbkNvbnRlbnRNYXBbYWxpZ25Db250ZW50XSk7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fdXBkYXRlTmF0aXZlTGF5b3V0UGFyYW1zID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3VwZGF0ZU5hdGl2ZUxheW91dFBhcmFtcy5jYWxsKHRoaXMsIGNoaWxkKTtcbiAgICAgICAgdmFyIGxwID0gY2hpbGQubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRMYXlvdXRQYXJhbXMoKTtcbiAgICAgICAgdmFyIHN0eWxlID0gY2hpbGQuc3R5bGU7XG4gICAgICAgIGxwLm9yZGVyID0gc3R5bGUub3JkZXI7XG4gICAgICAgIGxwLmZsZXhHcm93ID0gc3R5bGUuZmxleEdyb3c7XG4gICAgICAgIGxwLmZsZXhTaHJpbmsgPSBzdHlsZS5mbGV4U2hyaW5rO1xuICAgICAgICBscC53cmFwQmVmb3JlID0gc3R5bGUuZmxleFdyYXBCZWZvcmU7XG4gICAgICAgIGxwLmFsaWduU2VsZiA9IGFsaWduU2VsZk1hcFtzdHlsZS5hbGlnblNlbGZdO1xuICAgICAgICBjaGlsZC5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldExheW91dFBhcmFtcyhscCk7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fc2V0Q2hpbGRNaW5XaWR0aE5hdGl2ZSA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICBjaGlsZC5fc2V0TWluV2lkdGhOYXRpdmUoMCk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gY2hpbGQubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGxwID0gbmF0aXZlVmlldy5nZXRMYXlvdXRQYXJhbXMoKTtcbiAgICAgICAgaWYgKGxwIGluc3RhbmNlb2Ygd2lkZ2V0TGF5b3V0UGFyYW1zKSB7XG4gICAgICAgICAgICBscC5taW5XaWR0aCA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyhjaGlsZC5zdHlsZS5taW5XaWR0aCwgMCk7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldExheW91dFBhcmFtcyhscCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlLl9zZXRDaGlsZE1pbkhlaWdodE5hdGl2ZSA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICBjaGlsZC5fc2V0TWluSGVpZ2h0TmF0aXZlKDApO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBscCA9IG5hdGl2ZVZpZXcuZ2V0TGF5b3V0UGFyYW1zKCk7XG4gICAgICAgIGlmIChscCBpbnN0YW5jZW9mIHdpZGdldExheW91dFBhcmFtcykge1xuICAgICAgICAgICAgbHAubWluSGVpZ2h0ID0gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKGNoaWxkLnN0eWxlLm1pbkhlaWdodCwgMCk7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldExheW91dFBhcmFtcyhscCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBGbGV4Ym94TGF5b3V0O1xufShmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4Ym94TGF5b3V0QmFzZSkpO1xuZXhwb3J0cy5GbGV4Ym94TGF5b3V0ID0gRmxleGJveExheW91dDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZsZXhib3gtbGF5b3V0LmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBsYXlvdXRfYmFzZV8xID0gcmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpKTtcbmZ1bmN0aW9uIHZhbGlkYXRlQXJncyhlbGVtZW50KSB7XG4gICAgaWYgKCFlbGVtZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImVsZW1lbnQgY2Fubm90IGJlIG51bGwgb3IgdW5kZWZpbmVkLlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG59XG5sYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLnJvdyA9IDA7XG5sYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLmNvbCA9IDA7XG5sYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLnJvd1NwYW4gPSAxO1xubGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZS5jb2xTcGFuID0gMTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShsYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLCBcImNvbHVtblwiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmNvbDsgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkgeyB0aGlzLmNvbCA9IHZhbHVlOyB9LFxuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlXG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShsYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLCBcImNvbHVtblNwYW5cIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5jb2xTcGFuOyB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7IHRoaXMuY29sU3BhbiA9IHZhbHVlOyB9LFxuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlXG59KTtcbmZ1bmN0aW9uIHZhbGlkYXRlSXRlbVNwZWMoaXRlbVNwZWMpIHtcbiAgICBpZiAoIWl0ZW1TcGVjKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlIGNhbm5vdCBiZSB1bmRlZmluZWQuXCIpO1xuICAgIH1cbiAgICBpZiAoaXRlbVNwZWMub3duZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaXRlbVNwZWMgaXMgYWxyZWFkeSBhZGRlZCB0byBHcmlkTGF5b3V0LlwiKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjb252ZXJ0R3JpZExlbmd0aCh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gR3JpZFVuaXRUeXBlLkFVVE8pIHtcbiAgICAgICAgcmV0dXJuIEl0ZW1TcGVjLmNyZWF0ZSgxLCBHcmlkVW5pdFR5cGUuQVVUTyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHZhbHVlLmluZGV4T2YoXCIqXCIpICE9PSAtMSkge1xuICAgICAgICB2YXIgc3RhckNvdW50ID0gcGFyc2VJbnQodmFsdWUucmVwbGFjZShcIipcIiwgXCJcIikgfHwgXCIxXCIpO1xuICAgICAgICByZXR1cm4gSXRlbVNwZWMuY3JlYXRlKHN0YXJDb3VudCwgR3JpZFVuaXRUeXBlLlNUQVIpO1xuICAgIH1cbiAgICBlbHNlIGlmICghaXNOYU4ocGFyc2VJbnQodmFsdWUpKSkge1xuICAgICAgICByZXR1cm4gSXRlbVNwZWMuY3JlYXRlKHBhcnNlSW50KHZhbHVlKSwgR3JpZFVuaXRUeXBlLlBJWEVMKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBwYXJzZSBpdGVtIHNwZWMgZnJvbSBzdHJpbmc6IFwiICsgdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHBhcnNlQW5kQWRkSXRlbVNwZWNzKHZhbHVlLCBmdW5jKSB7XG4gICAgdmFyIGFyciA9IHZhbHVlLnNwbGl0KC9bXFxzLF0rLyk7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpKyspIHtcbiAgICAgICAgdmFyIHN0ciA9IGFycltpXS50cmltKCk7XG4gICAgICAgIGlmIChzdHIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZnVuYyhjb252ZXJ0R3JpZExlbmd0aChhcnJbaV0udHJpbSgpKSk7XG4gICAgICAgIH1cbiAgICB9XG59XG52YXIgSXRlbVNwZWMgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJdGVtU3BlYywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBJdGVtU3BlYygpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2FjdHVhbExlbmd0aCA9IDA7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBfdGhpcy5fdmFsdWUgPSAxO1xuICAgICAgICAgICAgX3RoaXMuX3VuaXRUeXBlID0gR3JpZFVuaXRUeXBlLlNUQVI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgdmFyIHR5cGUgPSBhcmd1bWVudHNbMV07XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiICYmIHR5cGVvZiB0eXBlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMCB8fCBpc05hTih2YWx1ZSkgfHwgIWlzRmluaXRlKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBzaG91bGQgbm90IGJlIG5lZ2F0aXZlLCBOYU4gb3IgSW5maW5pdHk6IFwiICsgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5fdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBfdGhpcy5fdW5pdFR5cGUgPSBHcmlkVW5pdFR5cGUucGFyc2UodHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGaXJzdCBhcmd1bWVudCBzaG91bGQgYmUgbnVtYmVyLCBzZWNvbmQgYXJndW1lbnQgc2hvdWxkIGJlIHN0cmluZy5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJdGVtU3BlYyBleHBlY3RzIDAgb3IgMiBhcmd1bWVudHNcIik7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMuaW5kZXggPSAtMTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBJdGVtU3BlYy5jcmVhdGUgPSBmdW5jdGlvbiAodmFsdWUsIHR5cGUpIHtcbiAgICAgICAgdmFyIHNwZWMgPSBuZXcgSXRlbVNwZWMoKTtcbiAgICAgICAgc3BlYy5fdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgc3BlYy5fdW5pdFR5cGUgPSB0eXBlO1xuICAgICAgICByZXR1cm4gc3BlYztcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVtU3BlYy5wcm90b3R5cGUsIFwiYWN0dWFsTGVuZ3RoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWN0dWFsTGVuZ3RoO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBJdGVtU3BlYy5lcXVhbHMgPSBmdW5jdGlvbiAodmFsdWUxLCB2YWx1ZTIpIHtcbiAgICAgICAgcmV0dXJuICh2YWx1ZTEuZ3JpZFVuaXRUeXBlID09PSB2YWx1ZTIuZ3JpZFVuaXRUeXBlKSAmJiAodmFsdWUxLnZhbHVlID09PSB2YWx1ZTIudmFsdWUpICYmICh2YWx1ZTEub3duZXIgPT09IHZhbHVlMi5vd25lcikgJiYgKHZhbHVlMS5pbmRleCA9PT0gdmFsdWUyLmluZGV4KTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVtU3BlYy5wcm90b3R5cGUsIFwiZ3JpZFVuaXRUeXBlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdW5pdFR5cGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVtU3BlYy5wcm90b3R5cGUsIFwiaXNBYnNvbHV0ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VuaXRUeXBlID09PSBHcmlkVW5pdFR5cGUuUElYRUw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVtU3BlYy5wcm90b3R5cGUsIFwiaXNBdXRvXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdW5pdFR5cGUgPT09IEdyaWRVbml0VHlwZS5BVVRPO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSXRlbVNwZWMucHJvdG90eXBlLCBcImlzU3RhclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VuaXRUeXBlID09PSBHcmlkVW5pdFR5cGUuU1RBUjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEl0ZW1TcGVjLnByb3RvdHlwZSwgXCJ2YWx1ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gSXRlbVNwZWM7XG59KGxheW91dF9iYXNlXzEuT2JzZXJ2YWJsZSkpO1xuZXhwb3J0cy5JdGVtU3BlYyA9IEl0ZW1TcGVjO1xudmFyIEdyaWRMYXlvdXRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoR3JpZExheW91dEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gR3JpZExheW91dEJhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fcm93cyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBfdGhpcy5fY29scyA9IG5ldyBBcnJheSgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEdyaWRMYXlvdXRCYXNlXzEgPSBHcmlkTGF5b3V0QmFzZTtcbiAgICBHcmlkTGF5b3V0QmFzZS5nZXRDb2x1bW4gPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGVBcmdzKGVsZW1lbnQpLmNvbDtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnNldENvbHVtbiA9IGZ1bmN0aW9uIChlbGVtZW50LCB2YWx1ZSkge1xuICAgICAgICB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkuY29sID0gdmFsdWU7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5nZXRDb2x1bW5TcGFuID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyhlbGVtZW50KS5jb2xTcGFuO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2Uuc2V0Q29sdW1uU3BhbiA9IGZ1bmN0aW9uIChlbGVtZW50LCB2YWx1ZSkge1xuICAgICAgICB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkuY29sU3BhbiA9IHZhbHVlO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UuZ2V0Um93ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyhlbGVtZW50KS5yb3c7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5zZXRSb3cgPSBmdW5jdGlvbiAoZWxlbWVudCwgdmFsdWUpIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKGVsZW1lbnQpLnJvdyA9IHZhbHVlO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UuZ2V0Um93U3BhbiA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkucm93U3BhbjtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnNldFJvd1NwYW4gPSBmdW5jdGlvbiAoZWxlbWVudCwgdmFsdWUpIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKGVsZW1lbnQpLnJvd1NwYW4gPSB2YWx1ZTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5hZGRSb3cgPSBmdW5jdGlvbiAoaXRlbVNwZWMpIHtcbiAgICAgICAgdmFsaWRhdGVJdGVtU3BlYyhpdGVtU3BlYyk7XG4gICAgICAgIGl0ZW1TcGVjLm93bmVyID0gdGhpcztcbiAgICAgICAgdGhpcy5fcm93cy5wdXNoKGl0ZW1TcGVjKTtcbiAgICAgICAgdGhpcy5fb25Sb3dBZGRlZChpdGVtU3BlYyk7XG4gICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLmFkZENvbHVtbiA9IGZ1bmN0aW9uIChpdGVtU3BlYykge1xuICAgICAgICB2YWxpZGF0ZUl0ZW1TcGVjKGl0ZW1TcGVjKTtcbiAgICAgICAgaXRlbVNwZWMub3duZXIgPSB0aGlzO1xuICAgICAgICB0aGlzLl9jb2xzLnB1c2goaXRlbVNwZWMpO1xuICAgICAgICB0aGlzLl9vbkNvbHVtbkFkZGVkKGl0ZW1TcGVjKTtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUuYWRkQ2hpbGRBdENlbGwgPSBmdW5jdGlvbiAodmlldywgcm93LCBjb2x1bW4sIHJvd1NwYW4sIGNvbHVtblNwYW4pIHtcbiAgICAgICAgdGhpcy5hZGRDaGlsZCh2aWV3KTtcbiAgICAgICAgR3JpZExheW91dEJhc2VfMS5zZXRSb3codmlldywgcm93KTtcbiAgICAgICAgR3JpZExheW91dEJhc2VfMS5zZXRDb2x1bW4odmlldywgY29sdW1uKTtcbiAgICAgICAgaWYgKHJvd1NwYW4pIHtcbiAgICAgICAgICAgIEdyaWRMYXlvdXRCYXNlXzEuc2V0Um93U3Bhbih2aWV3LCByb3dTcGFuKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29sdW1uU3Bhbikge1xuICAgICAgICAgICAgR3JpZExheW91dEJhc2VfMS5zZXRDb2x1bW5TcGFuKHZpZXcsIGNvbHVtblNwYW4pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUucmVtb3ZlUm93ID0gZnVuY3Rpb24gKGl0ZW1TcGVjKSB7XG4gICAgICAgIGlmICghaXRlbVNwZWMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlIGlzIG51bGwuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMuX3Jvd3MuaW5kZXhPZihpdGVtU3BlYyk7XG4gICAgICAgIGlmIChpdGVtU3BlYy5vd25lciAhPT0gdGhpcyB8fCBpbmRleCA8IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJvdyBpcyBub3QgY2hpbGQgb2YgdGhpcyBHcmlkTGF5b3V0XCIpO1xuICAgICAgICB9XG4gICAgICAgIGl0ZW1TcGVjLmluZGV4ID0gLTE7XG4gICAgICAgIHRoaXMuX3Jvd3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5fb25Sb3dSZW1vdmVkKGl0ZW1TcGVjLCBpbmRleCk7XG4gICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLnJlbW92ZUNvbHVtbiA9IGZ1bmN0aW9uIChpdGVtU3BlYykge1xuICAgICAgICBpZiAoIWl0ZW1TcGVjKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBpcyBudWxsLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9jb2xzLmluZGV4T2YoaXRlbVNwZWMpO1xuICAgICAgICBpZiAoaXRlbVNwZWMub3duZXIgIT09IHRoaXMgfHwgaW5kZXggPCAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb2x1bW4gaXMgbm90IGNoaWxkIG9mIHRoaXMgR3JpZExheW91dFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpdGVtU3BlYy5pbmRleCA9IC0xO1xuICAgICAgICB0aGlzLl9jb2xzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIHRoaXMuX29uQ29sdW1uUmVtb3ZlZChpdGVtU3BlYywgaW5kZXgpO1xuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5yZW1vdmVDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fY29scy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIGNvbFNwZWMgPSB0aGlzLl9jb2xzW2ldO1xuICAgICAgICAgICAgdGhpcy5fb25Db2x1bW5SZW1vdmVkKGNvbFNwZWMsIGkpO1xuICAgICAgICAgICAgY29sU3BlYy5pbmRleCA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NvbHMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUucmVtb3ZlUm93cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuX3Jvd3MubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciByb3dTcGVjID0gdGhpcy5fcm93c1tpXTtcbiAgICAgICAgICAgIHRoaXMuX29uUm93UmVtb3ZlZChyb3dTcGVjLCBpKTtcbiAgICAgICAgICAgIHJvd1NwZWMuaW5kZXggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yb3dzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLm9uUm93Q2hhbmdlZCA9IGZ1bmN0aW9uIChlbGVtZW50LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUub25Sb3dTcGFuQ2hhbmdlZCA9IGZ1bmN0aW9uIChlbGVtZW50LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUub25Db2x1bW5DaGFuZ2VkID0gZnVuY3Rpb24gKGVsZW1lbnQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5vbkNvbHVtblNwYW5DaGFuZ2VkID0gZnVuY3Rpb24gKGVsZW1lbnQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5fb25Sb3dBZGRlZCA9IGZ1bmN0aW9uIChpdGVtU3BlYykge1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLl9vbkNvbHVtbkFkZGVkID0gZnVuY3Rpb24gKGl0ZW1TcGVjKSB7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUuX29uUm93UmVtb3ZlZCA9IGZ1bmN0aW9uIChpdGVtU3BlYywgaW5kZXgpIHtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5fb25Db2x1bW5SZW1vdmVkID0gZnVuY3Rpb24gKGl0ZW1TcGVjLCBpbmRleCkge1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLmdldENvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb2xzLnNsaWNlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUuZ2V0Um93cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Jvd3Muc2xpY2UoKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUsIFwiY29sdW1uc0ludGVybmFsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29scztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZSwgXCJyb3dzSW50ZXJuYWxcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yb3dzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUuaW52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUsIFwicm93c1wiLCB7XG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVSb3dzKCk7XG4gICAgICAgICAgICBwYXJzZUFuZEFkZEl0ZW1TcGVjcyh2YWx1ZSwgZnVuY3Rpb24gKHNwZWMpIHsgcmV0dXJuIF90aGlzLmFkZFJvdyhzcGVjKTsgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUsIFwiY29sdW1uc1wiLCB7XG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVDb2x1bW5zKCk7XG4gICAgICAgICAgICBwYXJzZUFuZEFkZEl0ZW1TcGVjcyh2YWx1ZSwgZnVuY3Rpb24gKHNwZWMpIHsgcmV0dXJuIF90aGlzLmFkZENvbHVtbihzcGVjKTsgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHZhciBHcmlkTGF5b3V0QmFzZV8xO1xuICAgIEdyaWRMYXlvdXRCYXNlID0gR3JpZExheW91dEJhc2VfMSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBsYXlvdXRfYmFzZV8xLkNTU1R5cGUoXCJHcmlkTGF5b3V0XCIpXG4gICAgXSwgR3JpZExheW91dEJhc2UpO1xuICAgIHJldHVybiBHcmlkTGF5b3V0QmFzZTtcbn0obGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSk7XG5leHBvcnRzLkdyaWRMYXlvdXRCYXNlID0gR3JpZExheW91dEJhc2U7XG5HcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuY29sdW1uUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJjb2xcIiwgZGVmYXVsdFZhbHVlOiAwLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBncmlkID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgaWYgKGdyaWQgaW5zdGFuY2VvZiBHcmlkTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgZ3JpZC5vbkNvbHVtbkNoYW5nZWQodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIE1hdGgubWF4KDAsIHBhcnNlSW50KHYpKTsgfVxufSk7XG5leHBvcnRzLmNvbHVtblByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuVmlldyk7XG5leHBvcnRzLmNvbHVtblNwYW5Qcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImNvbFNwYW5cIiwgZGVmYXVsdFZhbHVlOiAxLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBncmlkID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgaWYgKGdyaWQgaW5zdGFuY2VvZiBHcmlkTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgZ3JpZC5vbkNvbHVtblNwYW5DaGFuZ2VkKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBNYXRoLm1heCgxLCBwYXJzZUludCh2KSk7IH1cbn0pO1xuZXhwb3J0cy5jb2x1bW5TcGFuUHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5WaWV3KTtcbmV4cG9ydHMucm93UHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJyb3dcIiwgZGVmYXVsdFZhbHVlOiAwLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBncmlkID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgaWYgKGdyaWQgaW5zdGFuY2VvZiBHcmlkTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgZ3JpZC5vblJvd0NoYW5nZWQodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIE1hdGgubWF4KDAsIHBhcnNlSW50KHYpKTsgfVxufSk7XG5leHBvcnRzLnJvd1Byb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuVmlldyk7XG5leHBvcnRzLnJvd1NwYW5Qcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInJvd1NwYW5cIiwgZGVmYXVsdFZhbHVlOiAxLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBncmlkID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgaWYgKGdyaWQgaW5zdGFuY2VvZiBHcmlkTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgZ3JpZC5vblJvd1NwYW5DaGFuZ2VkKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBNYXRoLm1heCgxLCBwYXJzZUludCh2KSk7IH1cbn0pO1xuZXhwb3J0cy5yb3dTcGFuUHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5WaWV3KTtcbnZhciBHcmlkVW5pdFR5cGU7XG4oZnVuY3Rpb24gKEdyaWRVbml0VHlwZSkge1xuICAgIEdyaWRVbml0VHlwZS5QSVhFTCA9IFwicGl4ZWxcIjtcbiAgICBHcmlkVW5pdFR5cGUuU1RBUiA9IFwic3RhclwiO1xuICAgIEdyaWRVbml0VHlwZS5BVVRPID0gXCJhdXRvXCI7XG4gICAgR3JpZFVuaXRUeXBlLmlzVmFsaWQgPSBsYXlvdXRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoR3JpZFVuaXRUeXBlLlBJWEVMLCBHcmlkVW5pdFR5cGUuU1RBUiwgR3JpZFVuaXRUeXBlLkFVVE8pO1xuICAgIEdyaWRVbml0VHlwZS5wYXJzZSA9IGxheW91dF9iYXNlXzEubWFrZVBhcnNlcihHcmlkVW5pdFR5cGUuaXNWYWxpZCk7XG59KShHcmlkVW5pdFR5cGUgPSBleHBvcnRzLkdyaWRVbml0VHlwZSB8fCAoZXhwb3J0cy5HcmlkVW5pdFR5cGUgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z3JpZC1sYXlvdXQtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZ3JpZF9sYXlvdXRfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9ncmlkLWxheW91dC1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9ncmlkLWxheW91dC1jb21tb25cIikpO1xuZnVuY3Rpb24gbWFrZU5hdGl2ZVNldHRlcihzZXR0ZXIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgbHAgPSBuYXRpdmVWaWV3LmdldExheW91dFBhcmFtcygpIHx8IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ29tbW9uTGF5b3V0UGFyYW1zKCk7XG4gICAgICAgIGlmIChscCBpbnN0YW5jZW9mIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Db21tb25MYXlvdXRQYXJhbXMpIHtcbiAgICAgICAgICAgIHNldHRlcihscCwgdmFsdWUpO1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRMYXlvdXRQYXJhbXMobHApO1xuICAgICAgICB9XG4gICAgfTtcbn1cbmdyaWRfbGF5b3V0X2NvbW1vbl8xLlZpZXcucHJvdG90eXBlW2dyaWRfbGF5b3V0X2NvbW1vbl8xLnJvd1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBtYWtlTmF0aXZlU2V0dGVyKGZ1bmN0aW9uIChscCwgdmFsdWUpIHsgcmV0dXJuIGxwLnJvdyA9IHZhbHVlOyB9KTtcbmdyaWRfbGF5b3V0X2NvbW1vbl8xLlZpZXcucHJvdG90eXBlW2dyaWRfbGF5b3V0X2NvbW1vbl8xLmNvbHVtblByb3BlcnR5LnNldE5hdGl2ZV0gPSBtYWtlTmF0aXZlU2V0dGVyKGZ1bmN0aW9uIChscCwgdmFsdWUpIHsgcmV0dXJuIGxwLmNvbHVtbiA9IHZhbHVlOyB9KTtcbmdyaWRfbGF5b3V0X2NvbW1vbl8xLlZpZXcucHJvdG90eXBlW2dyaWRfbGF5b3V0X2NvbW1vbl8xLnJvd1NwYW5Qcm9wZXJ0eS5zZXROYXRpdmVdID0gbWFrZU5hdGl2ZVNldHRlcihmdW5jdGlvbiAobHAsIHZhbHVlKSB7IHJldHVybiBscC5yb3dTcGFuID0gdmFsdWU7IH0pO1xuZ3JpZF9sYXlvdXRfY29tbW9uXzEuVmlldy5wcm90b3R5cGVbZ3JpZF9sYXlvdXRfY29tbW9uXzEuY29sdW1uU3BhblByb3BlcnR5LnNldE5hdGl2ZV0gPSBtYWtlTmF0aXZlU2V0dGVyKGZ1bmN0aW9uIChscCwgdmFsdWUpIHsgcmV0dXJuIGxwLmNvbHVtblNwYW4gPSB2YWx1ZTsgfSk7XG5mdW5jdGlvbiBjcmVhdGVOYXRpdmVTcGVjKGl0ZW1TcGVjKSB7XG4gICAgc3dpdGNoIChpdGVtU3BlYy5ncmlkVW5pdFR5cGUpIHtcbiAgICAgICAgY2FzZSBncmlkX2xheW91dF9jb21tb25fMS5HcmlkVW5pdFR5cGUuQVVUTzpcbiAgICAgICAgICAgIHJldHVybiBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkl0ZW1TcGVjKGl0ZW1TcGVjLnZhbHVlLCBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZFVuaXRUeXBlLmF1dG8pO1xuICAgICAgICBjYXNlIGdyaWRfbGF5b3V0X2NvbW1vbl8xLkdyaWRVbml0VHlwZS5TVEFSOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuSXRlbVNwZWMoaXRlbVNwZWMudmFsdWUsIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkVW5pdFR5cGUuc3Rhcik7XG4gICAgICAgIGNhc2UgZ3JpZF9sYXlvdXRfY29tbW9uXzEuR3JpZFVuaXRUeXBlLlBJWEVMOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuSXRlbVNwZWMoaXRlbVNwZWMudmFsdWUgKiBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKSwgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRVbml0VHlwZS5waXhlbCk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGdyaWRVbml0VHlwZTogXCIgKyBpdGVtU3BlYy5ncmlkVW5pdFR5cGUpO1xuICAgIH1cbn1cbnZhciBJdGVtU3BlYyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEl0ZW1TcGVjLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEl0ZW1TcGVjKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVtU3BlYy5wcm90b3R5cGUsIFwiYWN0dWFsTGVuZ3RoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5uYXRpdmVTcGVjKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQodGhpcy5uYXRpdmVTcGVjLmdldEFjdHVhbExlbmd0aCgpIC8gZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBJdGVtU3BlYztcbn0oZ3JpZF9sYXlvdXRfY29tbW9uXzEuSXRlbVNwZWMpKTtcbmV4cG9ydHMuSXRlbVNwZWMgPSBJdGVtU3BlYztcbnZhciBHcmlkTGF5b3V0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoR3JpZExheW91dCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBHcmlkTGF5b3V0KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRMYXlvdXQodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0LnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLnJvd3NJbnRlcm5hbC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtU3BlYywgaW5kZXgsIHJvd3MpIHsgX3RoaXMuX29uUm93QWRkZWQoaXRlbVNwZWMpOyB9LCB0aGlzKTtcbiAgICAgICAgdGhpcy5jb2x1bW5zSW50ZXJuYWwuZm9yRWFjaChmdW5jdGlvbiAoaXRlbVNwZWMsIGluZGV4LCByb3dzKSB7IF90aGlzLl9vbkNvbHVtbkFkZGVkKGl0ZW1TcGVjKTsgfSwgdGhpcyk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0LnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLnJvd3NJbnRlcm5hbC5sZW5ndGg7IGktLTsgaSA+PSAwKSB7XG4gICAgICAgICAgICB2YXIgaXRlbVNwZWMgPSB0aGlzLnJvd3NJbnRlcm5hbFtpXTtcbiAgICAgICAgICAgIHRoaXMuX29uUm93UmVtb3ZlZChpdGVtU3BlYywgaSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuY29sdW1uc0ludGVybmFsLmxlbmd0aDsgaS0tOyBpID49IDApIHtcbiAgICAgICAgICAgIHZhciBpdGVtU3BlYyA9IHRoaXMuY29sdW1uc0ludGVybmFsW2ldO1xuICAgICAgICAgICAgdGhpcy5fb25Db2x1bW5SZW1vdmVkKGl0ZW1TcGVjLCBpKTtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgR3JpZExheW91dC5wcm90b3R5cGUuX29uUm93QWRkZWQgPSBmdW5jdGlvbiAoaXRlbVNwZWMpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZVNwZWMgPSBjcmVhdGVOYXRpdmVTcGVjKGl0ZW1TcGVjKTtcbiAgICAgICAgICAgIGl0ZW1TcGVjLm5hdGl2ZVNwZWMgPSBuYXRpdmVTcGVjO1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmFkZFJvdyhuYXRpdmVTcGVjKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZExheW91dC5wcm90b3R5cGUuX29uQ29sdW1uQWRkZWQgPSBmdW5jdGlvbiAoaXRlbVNwZWMpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZVNwZWMgPSBjcmVhdGVOYXRpdmVTcGVjKGl0ZW1TcGVjKTtcbiAgICAgICAgICAgIGl0ZW1TcGVjLm5hdGl2ZVNwZWMgPSBuYXRpdmVTcGVjO1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmFkZENvbHVtbihuYXRpdmVTcGVjKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZExheW91dC5wcm90b3R5cGUuX29uUm93UmVtb3ZlZCA9IGZ1bmN0aW9uIChpdGVtU3BlYywgaW5kZXgpIHtcbiAgICAgICAgaXRlbVNwZWMubmF0aXZlU3BlYyA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5yZW1vdmVSb3dBdChpbmRleCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLl9vbkNvbHVtblJlbW92ZWQgPSBmdW5jdGlvbiAoaXRlbVNwZWMsIGluZGV4KSB7XG4gICAgICAgIGl0ZW1TcGVjLm5hdGl2ZVNwZWMgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQucmVtb3ZlQ29sdW1uQXQoaW5kZXgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0LnByb3RvdHlwZS5pbnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgcmV0dXJuIEdyaWRMYXlvdXQ7XG59KGdyaWRfbGF5b3V0X2NvbW1vbl8xLkdyaWRMYXlvdXRCYXNlKSk7XG5leHBvcnRzLkdyaWRMYXlvdXQgPSBHcmlkTGF5b3V0O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z3JpZC1sYXlvdXQuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBMYXlvdXRCYXNlQ29tbW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTGF5b3V0QmFzZUNvbW1vbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMYXlvdXRCYXNlQ29tbW9uKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3N1YlZpZXdzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2Ygdmlld18xLlZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQodmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZS5nZXRDaGlsZHJlbkNvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3ViVmlld3MubGVuZ3RoO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLCBcIl9jaGlsZHJlbkNvdW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3ViVmlld3MubGVuZ3RoO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZS5nZXRDaGlsZEF0ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdWJWaWV3c1tpbmRleF07XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZS5nZXRDaGlsZEluZGV4ID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdWJWaWV3cy5pbmRleE9mKGNoaWxkKTtcbiAgICB9O1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLmdldENoaWxkQnlJZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICByZXR1cm4gdmlld18xLmdldFZpZXdCeUlkKHRoaXMsIGlkKTtcbiAgICB9O1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLl9yZWdpc3RlckxheW91dENoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZS5fdW5yZWdpc3RlckxheW91dENoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZS5hZGRDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICB0aGlzLl9zdWJWaWV3cy5wdXNoKGNoaWxkKTtcbiAgICAgICAgdGhpcy5fYWRkVmlldyhjaGlsZCk7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyTGF5b3V0Q2hpbGQoY2hpbGQpO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuaW5zZXJ0Q2hpbGQgPSBmdW5jdGlvbiAoY2hpbGQsIGF0SW5kZXgpIHtcbiAgICAgICAgdGhpcy5fc3ViVmlld3Muc3BsaWNlKGF0SW5kZXgsIDAsIGNoaWxkKTtcbiAgICAgICAgdGhpcy5fYWRkVmlldyhjaGlsZCwgYXRJbmRleCk7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyTGF5b3V0Q2hpbGQoY2hpbGQpO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUucmVtb3ZlQ2hpbGQgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgdGhpcy5fcmVtb3ZlVmlldyhjaGlsZCk7XG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMuX3N1YlZpZXdzLmluZGV4T2YoY2hpbGQpO1xuICAgICAgICB0aGlzLl9zdWJWaWV3cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB0aGlzLl91bnJlZ2lzdGVyTGF5b3V0Q2hpbGQoY2hpbGQpO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUucmVtb3ZlQ2hpbGRyZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHdoaWxlICh0aGlzLmdldENoaWxkcmVuQ291bnQoKSAhPT0gMCkge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVDaGlsZCh0aGlzLl9zdWJWaWV3c1t0aGlzLmdldENoaWxkcmVuQ291bnQoKSAtIDFdKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInBhZGRpbmdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnBhZGRpbmc7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmcgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInBhZGRpbmdUb3BcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnBhZGRpbmdUb3A7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmdUb3AgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInBhZGRpbmdSaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUucGFkZGluZ1JpZ2h0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nUmlnaHQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInBhZGRpbmdCb3R0b21cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnBhZGRpbmdCb3R0b207XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmdCb3R0b20gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInBhZGRpbmdMZWZ0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nTGVmdDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUucGFkZGluZ0xlZnQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuX2NoaWxkSW5kZXhUb05hdGl2ZUNoaWxkSW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgaWYgKGluZGV4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5kZXggJiYgaSA8IHRoaXMuX3N1YlZpZXdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5fc3ViVmlld3NbaV0uX2dldE5hdGl2ZVZpZXdzQ291bnQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuZWFjaENoaWxkVmlldyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSB0aGlzLl9zdWJWaWV3cy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcmV0VmFsID0gY2FsbGJhY2sodGhpcy5fc3ViVmlld3NbaV0pO1xuICAgICAgICAgICAgaWYgKHJldFZhbCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuZWFjaExheW91dENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBsYXN0Q2hpbGQgPSBudWxsO1xuICAgICAgICB0aGlzLmVhY2hDaGlsZFZpZXcoZnVuY3Rpb24gKGN2KSB7XG4gICAgICAgICAgICBjdi5fZWFjaExheW91dFZpZXcoZnVuY3Rpb24gKGx2KSB7XG4gICAgICAgICAgICAgICAgaWYgKGxhc3RDaGlsZCAmJiAhbGFzdENoaWxkLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGxhc3RDaGlsZCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsYXN0Q2hpbGQgPSBsdjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAobGFzdENoaWxkICYmICFsYXN0Q2hpbGQuaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGxhc3RDaGlsZCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBMYXlvdXRCYXNlQ29tbW9uO1xufSh2aWV3XzEuQ3VzdG9tTGF5b3V0VmlldykpO1xuZXhwb3J0cy5MYXlvdXRCYXNlQ29tbW9uID0gTGF5b3V0QmFzZUNvbW1vbjtcbmV4cG9ydHMuY2xpcFRvQm91bmRzUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJjbGlwVG9Cb3VuZHNcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLCB2YWx1ZUNvbnZlcnRlcjogdmlld18xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmNsaXBUb0JvdW5kc1Byb3BlcnR5LnJlZ2lzdGVyKExheW91dEJhc2VDb21tb24pO1xuZXhwb3J0cy5pc1Bhc3NUaHJvdWdoUGFyZW50RW5hYmxlZFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaXNQYXNzVGhyb3VnaFBhcmVudEVuYWJsZWRcIiwgZGVmYXVsdFZhbHVlOiBmYWxzZSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5pc1Bhc3NUaHJvdWdoUGFyZW50RW5hYmxlZFByb3BlcnR5LnJlZ2lzdGVyKExheW91dEJhc2VDb21tb24pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bGF5b3V0LWJhc2UtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGF5b3V0X2Jhc2VfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9sYXlvdXQtYmFzZS1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9sYXlvdXQtYmFzZS1jb21tb25cIikpO1xudmFyIExheW91dEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhMYXlvdXRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIExheW91dEJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGVbbGF5b3V0X2Jhc2VfY29tbW9uXzEuY2xpcFRvQm91bmRzUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGVbbGF5b3V0X2Jhc2VfY29tbW9uXzEuY2xpcFRvQm91bmRzUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJjbGlwVG9Cb3VuZHMgd2l0aCB2YWx1ZSBmYWxzZSBpcyBub3Qgc3VwcG9ydGVkIG9uIEFuZHJvaWQuIFlvdSBjYW4gdXNlIHRoaXMuYW5kcm9pZC5nZXRQYXJlbnQoKS5zZXRDbGlwQ2hpbGRyZW4oZmFsc2UpIGFzIGFuIGFsdGVybmF0aXZlXCIpO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGVbbGF5b3V0X2Jhc2VfY29tbW9uXzEuaXNQYXNzVGhyb3VnaFBhcmVudEVuYWJsZWRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRQYXNzVGhyb3VnaFBhcmVudCh2YWx1ZSk7XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlLnByb3RvdHlwZVtsYXlvdXRfYmFzZV9jb21tb25fMS5wYWRkaW5nVG9wUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IHZhbHVlOiB0aGlzLl9kZWZhdWx0UGFkZGluZ1RvcCwgdW5pdDogXCJweFwiIH07XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlLnByb3RvdHlwZVtsYXlvdXRfYmFzZV9jb21tb25fMS5wYWRkaW5nVG9wUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRQYWRkaW5nVG9wKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgbGF5b3V0X2Jhc2VfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHZhbHVlLCAwKSArIGxheW91dF9iYXNlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh0aGlzLnN0eWxlLmJvcmRlclRvcFdpZHRoLCAwKSk7XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlLnByb3RvdHlwZVtsYXlvdXRfYmFzZV9jb21tb25fMS5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHRoaXMuX2RlZmF1bHRQYWRkaW5nUmlnaHQsIHVuaXQ6IFwicHhcIiB9O1xuICAgIH07XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGVbbGF5b3V0X2Jhc2VfY29tbW9uXzEucGFkZGluZ1JpZ2h0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRQYWRkaW5nUmlnaHQodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCBsYXlvdXRfYmFzZV9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModmFsdWUsIDApICsgbGF5b3V0X2Jhc2VfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHRoaXMuc3R5bGUuYm9yZGVyUmlnaHRXaWR0aCwgMCkpO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGVbbGF5b3V0X2Jhc2VfY29tbW9uXzEucGFkZGluZ0JvdHRvbVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4geyB2YWx1ZTogdGhpcy5fZGVmYXVsdFBhZGRpbmdCb3R0b20sIHVuaXQ6IFwicHhcIiB9O1xuICAgIH07XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGVbbGF5b3V0X2Jhc2VfY29tbW9uXzEucGFkZGluZ0JvdHRvbVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0UGFkZGluZ0JvdHRvbSh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIGxheW91dF9iYXNlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgMCkgKyBsYXlvdXRfYmFzZV9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModGhpcy5zdHlsZS5ib3JkZXJCb3R0b21XaWR0aCwgMCkpO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGVbbGF5b3V0X2Jhc2VfY29tbW9uXzEucGFkZGluZ0xlZnRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHRoaXMuX2RlZmF1bHRQYWRkaW5nTGVmdCwgdW5pdDogXCJweFwiIH07XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlLnByb3RvdHlwZVtsYXlvdXRfYmFzZV9jb21tb25fMS5wYWRkaW5nTGVmdFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0UGFkZGluZ0xlZnQodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCBsYXlvdXRfYmFzZV9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModmFsdWUsIDApICsgbGF5b3V0X2Jhc2VfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHRoaXMuc3R5bGUuYm9yZGVyTGVmdFdpZHRoLCAwKSk7XG4gICAgfTtcbiAgICByZXR1cm4gTGF5b3V0QmFzZTtcbn0obGF5b3V0X2Jhc2VfY29tbW9uXzEuTGF5b3V0QmFzZUNvbW1vbikpO1xuZXhwb3J0cy5MYXlvdXRCYXNlID0gTGF5b3V0QmFzZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxheW91dC1iYXNlLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBsYXlvdXRfYmFzZV8xID0gcmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpKTtcbnZhciBTdGFja0xheW91dEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTdGFja0xheW91dEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3RhY2tMYXlvdXRCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFN0YWNrTGF5b3V0QmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBsYXlvdXRfYmFzZV8xLkNTU1R5cGUoXCJTdGFja0xheW91dFwiKVxuICAgIF0sIFN0YWNrTGF5b3V0QmFzZSk7XG4gICAgcmV0dXJuIFN0YWNrTGF5b3V0QmFzZTtcbn0obGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSk7XG5leHBvcnRzLlN0YWNrTGF5b3V0QmFzZSA9IFN0YWNrTGF5b3V0QmFzZTtcblN0YWNrTGF5b3V0QmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbnZhciBjb252ZXJ0ZXIgPSBsYXlvdXRfYmFzZV8xLm1ha2VQYXJzZXIobGF5b3V0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKFwiaG9yaXpvbnRhbFwiLCBcInZlcnRpY2FsXCIpKTtcbmV4cG9ydHMub3JpZW50YXRpb25Qcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJvcmllbnRhdGlvblwiLCBkZWZhdWx0VmFsdWU6IFwidmVydGljYWxcIiwgYWZmZWN0c0xheW91dDogbGF5b3V0X2Jhc2VfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IGNvbnZlcnRlciB9KTtcbmV4cG9ydHMub3JpZW50YXRpb25Qcm9wZXJ0eS5yZWdpc3RlcihTdGFja0xheW91dEJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RhY2stbGF5b3V0LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHN0YWNrX2xheW91dF9jb21tb25fMSA9IHJlcXVpcmUoXCIuL3N0YWNrLWxheW91dC1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9zdGFjay1sYXlvdXQtY29tbW9uXCIpKTtcbnZhciBTdGFja0xheW91dCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFN0YWNrTGF5b3V0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN0YWNrTGF5b3V0KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFN0YWNrTGF5b3V0LnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5TdGFja0xheW91dCh0aGlzLl9jb250ZXh0KTtcbiAgICB9O1xuICAgIFN0YWNrTGF5b3V0LnByb3RvdHlwZVtzdGFja19sYXlvdXRfY29tbW9uXzEub3JpZW50YXRpb25Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRPcmllbnRhdGlvbih2YWx1ZSA9PT0gXCJ2ZXJ0aWNhbFwiID8gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLk9yaWVudGF0aW9uLnZlcnRpY2FsIDogb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLk9yaWVudGF0aW9uLmhvcml6b250YWwpO1xuICAgIH07XG4gICAgcmV0dXJuIFN0YWNrTGF5b3V0O1xufShzdGFja19sYXlvdXRfY29tbW9uXzEuU3RhY2tMYXlvdXRCYXNlKSk7XG5leHBvcnRzLlN0YWNrTGF5b3V0ID0gU3RhY2tMYXlvdXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdGFjay1sYXlvdXQuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxheW91dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vbGF5b3V0LWJhc2VcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vbGF5b3V0LWJhc2VcIikpO1xudmFyIFdyYXBMYXlvdXRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoV3JhcExheW91dEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gV3JhcExheW91dEJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgV3JhcExheW91dEJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgbGF5b3V0X2Jhc2VfMS5DU1NUeXBlKFwiV3JhcExheW91dFwiKVxuICAgIF0sIFdyYXBMYXlvdXRCYXNlKTtcbiAgICByZXR1cm4gV3JhcExheW91dEJhc2U7XG59KGxheW91dF9iYXNlXzEuTGF5b3V0QmFzZSkpO1xuZXhwb3J0cy5XcmFwTGF5b3V0QmFzZSA9IFdyYXBMYXlvdXRCYXNlO1xuV3JhcExheW91dEJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLml0ZW1XaWR0aFByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbVdpZHRoXCIsIGRlZmF1bHRWYWx1ZTogXCJhdXRvXCIsIGFmZmVjdHNMYXlvdXQ6IGxheW91dF9iYXNlXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbGF5b3V0X2Jhc2VfMS5MZW5ndGgucGFyc2Uodik7IH0sXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHsgcmV0dXJuIHRhcmdldC5lZmZlY3RpdmVJdGVtV2lkdGggPSBsYXlvdXRfYmFzZV8xLkxlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgLTEpOyB9XG59KTtcbmV4cG9ydHMuaXRlbVdpZHRoUHJvcGVydHkucmVnaXN0ZXIoV3JhcExheW91dEJhc2UpO1xuZXhwb3J0cy5pdGVtSGVpZ2h0UHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpdGVtSGVpZ2h0XCIsIGRlZmF1bHRWYWx1ZTogXCJhdXRvXCIsIGFmZmVjdHNMYXlvdXQ6IGxheW91dF9iYXNlXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbGF5b3V0X2Jhc2VfMS5MZW5ndGgucGFyc2Uodik7IH0sXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHsgcmV0dXJuIHRhcmdldC5lZmZlY3RpdmVJdGVtSGVpZ2h0ID0gbGF5b3V0X2Jhc2VfMS5MZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIC0xKTsgfVxufSk7XG5leHBvcnRzLml0ZW1IZWlnaHRQcm9wZXJ0eS5yZWdpc3RlcihXcmFwTGF5b3V0QmFzZSk7XG52YXIgY29udmVydGVyID0gbGF5b3V0X2Jhc2VfMS5tYWtlUGFyc2VyKGxheW91dF9iYXNlXzEubWFrZVZhbGlkYXRvcihcImhvcml6b250YWxcIiwgXCJ2ZXJ0aWNhbFwiKSk7XG5leHBvcnRzLm9yaWVudGF0aW9uUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwib3JpZW50YXRpb25cIiwgZGVmYXVsdFZhbHVlOiBcImhvcml6b250YWxcIiwgYWZmZWN0c0xheW91dDogbGF5b3V0X2Jhc2VfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IGNvbnZlcnRlciB9KTtcbmV4cG9ydHMub3JpZW50YXRpb25Qcm9wZXJ0eS5yZWdpc3RlcihXcmFwTGF5b3V0QmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD13cmFwLWxheW91dC1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB3cmFwX2xheW91dF9jb21tb25fMSA9IHJlcXVpcmUoXCIuL3dyYXAtbGF5b3V0LWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3dyYXAtbGF5b3V0LWNvbW1vblwiKSk7XG52YXIgV3JhcExheW91dCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFdyYXBMYXlvdXQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gV3JhcExheW91dCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBXcmFwTGF5b3V0LnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5XcmFwTGF5b3V0KHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgV3JhcExheW91dC5wcm90b3R5cGVbd3JhcF9sYXlvdXRfY29tbW9uXzEub3JpZW50YXRpb25Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRPcmllbnRhdGlvbih2YWx1ZSA9PT0gXCJ2ZXJ0aWNhbFwiID8gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLk9yaWVudGF0aW9uLnZlcnRpY2FsIDogb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLk9yaWVudGF0aW9uLmhvcml6b250YWwpO1xuICAgIH07XG4gICAgV3JhcExheW91dC5wcm90b3R5cGVbd3JhcF9sYXlvdXRfY29tbW9uXzEuaXRlbVdpZHRoUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0SXRlbVdpZHRoKHdyYXBfbGF5b3V0X2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgLTEpKTtcbiAgICB9O1xuICAgIFdyYXBMYXlvdXQucHJvdG90eXBlW3dyYXBfbGF5b3V0X2NvbW1vbl8xLml0ZW1IZWlnaHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRJdGVtSGVpZ2h0KHdyYXBfbGF5b3V0X2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgLTEpKTtcbiAgICB9O1xuICAgIHJldHVybiBXcmFwTGF5b3V0O1xufSh3cmFwX2xheW91dF9jb21tb25fMS5XcmFwTGF5b3V0QmFzZSkpO1xuZXhwb3J0cy5XcmFwTGF5b3V0ID0gV3JhcExheW91dDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXdyYXAtbGF5b3V0LmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgTGlzdFBpY2tlckJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhMaXN0UGlja2VyQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMaXN0UGlja2VyQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBMaXN0UGlja2VyQmFzZS5wcm90b3R5cGUuX2dldEl0ZW1Bc1N0cmluZyA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICBpZiAoIWl0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gXCIgXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLmlzSXRlbXNTb3VyY2UgPyB0aGlzLml0ZW1zLmdldEl0ZW0oaW5kZXgpIDogdGhpcy5pdGVtc1tpbmRleF07XG4gICAgICAgIHJldHVybiAoaXRlbSA9PT0gdW5kZWZpbmVkIHx8IGl0ZW0gPT09IG51bGwpID8gaW5kZXggKyBcIlwiIDogdGhpcy5wYXJzZUl0ZW0oaXRlbSk7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyQmFzZS5wcm90b3R5cGUucGFyc2VJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGV4dEZpZWxkID8gaXRlbVt0aGlzLnRleHRGaWVsZF0gKyBcIlwiIDogaXRlbSArIFwiXCI7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyQmFzZS5wcm90b3R5cGUudXBkYXRlU2VsZWN0ZWRWYWx1ZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB2YXIgbmV3VmFsID0gbnVsbDtcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5pdGVtc1tpbmRleF07XG4gICAgICAgICAgICBuZXdWYWwgPSB0aGlzLnZhbHVlRmllbGQgPyBpdGVtW3RoaXMudmFsdWVGaWVsZF0gOiBpdGVtO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkVmFsdWUgIT09IG5ld1ZhbCkge1xuICAgICAgICAgICAgdGhpcy5zZXQoXCJzZWxlY3RlZFZhbHVlXCIsIG5ld1ZhbCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExpc3RQaWNrZXJCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiTGlzdFBpY2tlclwiKVxuICAgIF0sIExpc3RQaWNrZXJCYXNlKTtcbiAgICByZXR1cm4gTGlzdFBpY2tlckJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLkxpc3RQaWNrZXJCYXNlID0gTGlzdFBpY2tlckJhc2U7XG5MaXN0UGlja2VyQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Db2VyY2libGVQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJzZWxlY3RlZEluZGV4XCIsIGRlZmF1bHRWYWx1ZTogLTEsXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfSxcbiAgICBjb2VyY2VWYWx1ZTogZnVuY3Rpb24gKHRhcmdldCwgdmFsdWUpIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGFyZ2V0Lml0ZW1zO1xuICAgICAgICBpZiAoaXRlbXMpIHtcbiAgICAgICAgICAgIHZhciBtYXggPSBpdGVtcy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgaWYgKHZhbHVlIDwgMCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2YWx1ZSA+IG1heCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gbWF4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFsdWUgPSAtMTtcbiAgICAgICAgfVxuICAgICAgICB0YXJnZXQudXBkYXRlU2VsZWN0ZWRWYWx1ZSh2YWx1ZSk7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG59KTtcbmV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5LnJlZ2lzdGVyKExpc3RQaWNrZXJCYXNlKTtcbmV4cG9ydHMuaXRlbXNQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbXNcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGdldEl0ZW0gPSBuZXdWYWx1ZSAmJiBuZXdWYWx1ZS5nZXRJdGVtO1xuICAgICAgICB0YXJnZXQuaXNJdGVtc1NvdXJjZSA9IHR5cGVvZiBnZXRJdGVtID09PSBcImZ1bmN0aW9uXCI7XG4gICAgfVxufSk7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkucmVnaXN0ZXIoTGlzdFBpY2tlckJhc2UpO1xuZXhwb3J0cy50ZXh0RmllbGRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidGV4dEZpZWxkXCIsXG4gICAgZGVmYXVsdFZhbHVlOiBcIlwiXG59KTtcbmV4cG9ydHMudGV4dEZpZWxkUHJvcGVydHkucmVnaXN0ZXIoTGlzdFBpY2tlckJhc2UpO1xuZXhwb3J0cy52YWx1ZUZpZWxkUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInZhbHVlRmllbGRcIixcbiAgICBkZWZhdWx0VmFsdWU6IFwiXCJcbn0pO1xuZXhwb3J0cy52YWx1ZUZpZWxkUHJvcGVydHkucmVnaXN0ZXIoTGlzdFBpY2tlckJhc2UpO1xuZXhwb3J0cy5zZWxlY3RlZFZhbHVlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInNlbGVjdGVkVmFsdWVcIixcbiAgICBkZWZhdWx0VmFsdWU6IG51bGxcbn0pO1xuZXhwb3J0cy5zZWxlY3RlZFZhbHVlUHJvcGVydHkucmVnaXN0ZXIoTGlzdFBpY2tlckJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bGlzdC1waWNrZXItY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGlzdF9waWNrZXJfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9saXN0LXBpY2tlci1jb21tb25cIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybVwiKTtcbnZhciBsYXp5XzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvbGF6eVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2xpc3QtcGlja2VyLWNvbW1vblwiKSk7XG52YXIgc2RrVmVyc2lvbiA9IGxhenlfMS5kZWZhdWx0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBhcnNlSW50KHBsYXRmb3JtXzEuZGV2aWNlLnNka1ZlcnNpb24pOyB9KTtcbnZhciBGb3JtYXR0ZXI7XG52YXIgVmFsdWVDaGFuZ2VMaXN0ZW5lcjtcbmZ1bmN0aW9uIGluaXRpYWxpemVOYXRpdmVDbGFzc2VzKCkge1xuICAgIGlmIChGb3JtYXR0ZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgRm9ybWF0dGVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhGb3JtYXR0ZXJJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBGb3JtYXR0ZXJJbXBsKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIEZvcm1hdHRlckltcGwucHJvdG90eXBlLmZvcm1hdCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3duZXIuX2dldEl0ZW1Bc1N0cmluZyhpbmRleCk7XG4gICAgICAgIH07XG4gICAgICAgIEZvcm1hdHRlckltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWQud2lkZ2V0Lk51bWJlclBpY2tlci5Gb3JtYXR0ZXJdKVxuICAgICAgICBdLCBGb3JtYXR0ZXJJbXBsKTtcbiAgICAgICAgcmV0dXJuIEZvcm1hdHRlckltcGw7XG4gICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgdmFyIFZhbHVlQ2hhbmdlTGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFZhbHVlQ2hhbmdlTGlzdGVuZXJJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBWYWx1ZUNoYW5nZUxpc3RlbmVySW1wbChvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBWYWx1ZUNoYW5nZUxpc3RlbmVySW1wbC5wcm90b3R5cGUub25WYWx1ZUNoYW5nZSA9IGZ1bmN0aW9uIChwaWNrZXIsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgbGlzdF9waWNrZXJfY29tbW9uXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKHRoaXMub3duZXIsIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMub3duZXIudXBkYXRlU2VsZWN0ZWRWYWx1ZShuZXdWYWx1ZSk7XG4gICAgICAgIH07XG4gICAgICAgIFZhbHVlQ2hhbmdlTGlzdGVuZXJJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLndpZGdldC5OdW1iZXJQaWNrZXIuT25WYWx1ZUNoYW5nZUxpc3RlbmVyXSlcbiAgICAgICAgXSwgVmFsdWVDaGFuZ2VMaXN0ZW5lckltcGwpO1xuICAgICAgICByZXR1cm4gVmFsdWVDaGFuZ2VMaXN0ZW5lckltcGw7XG4gICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgRm9ybWF0dGVyID0gRm9ybWF0dGVySW1wbDtcbiAgICBWYWx1ZUNoYW5nZUxpc3RlbmVyID0gVmFsdWVDaGFuZ2VMaXN0ZW5lckltcGw7XG59XG5mdW5jdGlvbiBnZXRFZGl0VGV4dChwaWNrZXIpIHtcbiAgICBmb3IgKHZhciBpID0gMCwgY291bnQgPSBwaWNrZXIuZ2V0Q2hpbGRDb3VudCgpOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICB2YXIgY2hpbGQgPSBwaWNrZXIuZ2V0Q2hpbGRBdChpKTtcbiAgICAgICAgaWYgKGNoaWxkIGluc3RhbmNlb2YgYW5kcm9pZC53aWRnZXQuRWRpdFRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBjaGlsZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbnZhciBzZWxlY3RvcldoZWVsUGFpbnRGaWVsZDtcbmZ1bmN0aW9uIGdldFNlbGVjdG9yV2hlZWxQYWludChwaWNrZXIpIHtcbiAgICBpZiAoIXNlbGVjdG9yV2hlZWxQYWludEZpZWxkKSB7XG4gICAgICAgIHNlbGVjdG9yV2hlZWxQYWludEZpZWxkID0gcGlja2VyLmdldENsYXNzKCkuZ2V0RGVjbGFyZWRGaWVsZChcIm1TZWxlY3RvcldoZWVsUGFpbnRcIik7XG4gICAgICAgIHNlbGVjdG9yV2hlZWxQYWludEZpZWxkLnNldEFjY2Vzc2libGUodHJ1ZSk7XG4gICAgfVxuICAgIHJldHVybiBzZWxlY3RvcldoZWVsUGFpbnRGaWVsZC5nZXQocGlja2VyKTtcbn1cbnZhciBMaXN0UGlja2VyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTGlzdFBpY2tlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMaXN0UGlja2VyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIExpc3RQaWNrZXIucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwaWNrZXIgPSBuZXcgYW5kcm9pZC53aWRnZXQuTnVtYmVyUGlja2VyKHRoaXMuX2NvbnRleHQpO1xuICAgICAgICBwaWNrZXIuc2V0RGVzY2VuZGFudEZvY3VzYWJpbGl0eShhbmRyb2lkLndpZGdldC5OdW1iZXJQaWNrZXIuRk9DVVNfQkxPQ0tfREVTQ0VOREFOVFMpO1xuICAgICAgICBwaWNrZXIuc2V0TWluVmFsdWUoMCk7XG4gICAgICAgIHBpY2tlci5zZXRNYXhWYWx1ZSgwKTtcbiAgICAgICAgcGlja2VyLnNldFZhbHVlKDApO1xuICAgICAgICBwaWNrZXIuc2V0V3JhcFNlbGVjdG9yV2hlZWwoZmFsc2UpO1xuICAgICAgICByZXR1cm4gcGlja2VyO1xuICAgIH07XG4gICAgTGlzdFBpY2tlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgaW5pdGlhbGl6ZU5hdGl2ZUNsYXNzZXMoKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChzZGtWZXJzaW9uKCkgPCAyOSkge1xuICAgICAgICAgICAgdGhpcy5fc2VsZWN0b3JXaGVlbFBhaW50ID0gZ2V0U2VsZWN0b3JXaGVlbFBhaW50KG5hdGl2ZVZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmb3JtYXR0ZXIgPSBuZXcgRm9ybWF0dGVyKHRoaXMpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldEZvcm1hdHRlcihmb3JtYXR0ZXIpO1xuICAgICAgICBuYXRpdmVWaWV3LmZvcm1hdHRlciA9IGZvcm1hdHRlcjtcbiAgICAgICAgdmFyIHZhbHVlQ2hhbmdlZExpc3RlbmVyID0gbmV3IFZhbHVlQ2hhbmdlTGlzdGVuZXIodGhpcyk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0T25WYWx1ZUNoYW5nZWRMaXN0ZW5lcih2YWx1ZUNoYW5nZWRMaXN0ZW5lcik7XG4gICAgICAgIG5hdGl2ZVZpZXcudmFsdWVDaGFuZ2VkTGlzdGVuZXIgPSB2YWx1ZUNoYW5nZWRMaXN0ZW5lcjtcbiAgICAgICAgdmFyIGVkaXRUZXh0ID0gZ2V0RWRpdFRleHQobmF0aXZlVmlldyk7XG4gICAgICAgIGlmIChlZGl0VGV4dCkge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5lZGl0VGV4dCA9IGVkaXRUZXh0O1xuICAgICAgICAgICAgZWRpdFRleHQuc2V0RmlsdGVycyhbXSk7XG4gICAgICAgICAgICBlZGl0VGV4dC5zZXRUZXh0KFwiIFwiLCBhbmRyb2lkLndpZGdldC5UZXh0Vmlldy5CdWZmZXJUeXBlLk5PUk1BTCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExpc3RQaWNrZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgbmF0aXZlVmlldy5mb3JtYXR0ZXIub3duZXIgPSBudWxsO1xuICAgICAgICBuYXRpdmVWaWV3LnZhbHVlQ2hhbmdlZExpc3RlbmVyLm93bmVyID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgTGlzdFBpY2tlci5wcm90b3R5cGUuX2ZpeE51bWJlclBpY2tlclJlbmRlcmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0Rm9ybWF0dGVyKG51bGwpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldEZvcm1hdHRlcihuYXRpdmVWaWV3LmZvcm1hdHRlcik7XG4gICAgICAgIHZhciBlZGl0VGV4dCA9IG5hdGl2ZVZpZXcuZWRpdFRleHQ7XG4gICAgICAgIGlmIChlZGl0VGV4dCkge1xuICAgICAgICAgICAgZWRpdFRleHQuc2V0RmlsdGVycyhbXSk7XG4gICAgICAgICAgICBlZGl0VGV4dC5pbnZhbGlkYXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgbmF0aXZlVmlldy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyLnByb3RvdHlwZVtsaXN0X3BpY2tlcl9jb21tb25fMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIExpc3RQaWNrZXIucHJvdG90eXBlW2xpc3RfcGlja2VyX2NvbW1vbl8xLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA+PSAwKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VmFsdWUodmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBMaXN0UGlja2VyLnByb3RvdHlwZVtsaXN0X3BpY2tlcl9jb21tb25fMS5pdGVtc1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIExpc3RQaWNrZXIucHJvdG90eXBlW2xpc3RfcGlja2VyX2NvbW1vbl8xLml0ZW1zUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbWF4VmFsdWUgPSB2YWx1ZSAmJiB2YWx1ZS5sZW5ndGggPiAwID8gdmFsdWUubGVuZ3RoIC0gMSA6IDA7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRNYXhWYWx1ZShtYXhWYWx1ZSk7XG4gICAgICAgIHRoaXMuX2ZpeE51bWJlclBpY2tlclJlbmRlcmluZygpO1xuICAgICAgICBsaXN0X3BpY2tlcl9jb21tb25fMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuY29lcmNlKHRoaXMpO1xuICAgIH07XG4gICAgTGlzdFBpY2tlci5wcm90b3R5cGVbbGlzdF9waWNrZXJfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3NlbGVjdG9yV2hlZWxQYWludCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdG9yV2hlZWxQYWludC5nZXRDb2xvcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXcuZ2V0VGV4dENvbG9yKCk7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyLnByb3RvdHlwZVtsaXN0X3BpY2tlcl9jb21tb25fMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBsaXN0X3BpY2tlcl9jb21tb25fMS5Db2xvciA/IHZhbHVlLmFuZHJvaWQgOiB2YWx1ZTtcbiAgICAgICAgaWYgKHRoaXMuX3NlbGVjdG9yV2hlZWxQYWludCkge1xuICAgICAgICAgICAgdGhpcy5fc2VsZWN0b3JXaGVlbFBhaW50LnNldENvbG9yKGNvbG9yKTtcbiAgICAgICAgICAgIHZhciBlZGl0VGV4dCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5lZGl0VGV4dDtcbiAgICAgICAgICAgIGlmIChlZGl0VGV4dCkge1xuICAgICAgICAgICAgICAgIGVkaXRUZXh0LnNldFRleHRDb2xvcihjb2xvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXcuc2V0VGV4dENvbG9yKGNvbG9yKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIExpc3RQaWNrZXI7XG59KGxpc3RfcGlja2VyX2NvbW1vbl8xLkxpc3RQaWNrZXJCYXNlKSk7XG5leHBvcnRzLkxpc3RQaWNrZXIgPSBMaXN0UGlja2VyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bGlzdC1waWNrZXIuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG52YXIgYnVpbGRlcl8xID0gcmVxdWlyZShcIi4uL2J1aWxkZXJcIik7XG52YXIgbGFiZWxfMSA9IHJlcXVpcmUoXCIuLi9sYWJlbFwiKTtcbnZhciBvYnNlcnZhYmxlX2FycmF5XzEgPSByZXF1aXJlKFwiLi4vLi4vZGF0YS9vYnNlcnZhYmxlLWFycmF5XCIpO1xudmFyIHdlYWtfZXZlbnRfbGlzdGVuZXJfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3dlYWstZXZlbnQtbGlzdGVuZXJcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBrbm93blRlbXBsYXRlcztcbihmdW5jdGlvbiAoa25vd25UZW1wbGF0ZXMpIHtcbiAgICBrbm93blRlbXBsYXRlcy5pdGVtVGVtcGxhdGUgPSBcIml0ZW1UZW1wbGF0ZVwiO1xufSkoa25vd25UZW1wbGF0ZXMgPSBleHBvcnRzLmtub3duVGVtcGxhdGVzIHx8IChleHBvcnRzLmtub3duVGVtcGxhdGVzID0ge30pKTtcbnZhciBrbm93bk11bHRpVGVtcGxhdGVzO1xuKGZ1bmN0aW9uIChrbm93bk11bHRpVGVtcGxhdGVzKSB7XG4gICAga25vd25NdWx0aVRlbXBsYXRlcy5pdGVtVGVtcGxhdGVzID0gXCJpdGVtVGVtcGxhdGVzXCI7XG59KShrbm93bk11bHRpVGVtcGxhdGVzID0gZXhwb3J0cy5rbm93bk11bHRpVGVtcGxhdGVzIHx8IChleHBvcnRzLmtub3duTXVsdGlUZW1wbGF0ZXMgPSB7fSkpO1xudmFyIGF1dG9FZmZlY3RpdmVSb3dIZWlnaHQgPSAtMTtcbnZhciBMaXN0Vmlld0Jhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhMaXN0Vmlld0Jhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTGlzdFZpZXdCYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2l0ZW1JZEdlbmVyYXRvciA9IGZ1bmN0aW9uIChfaXRlbSwgaW5kZXgpIHsgcmV0dXJuIGluZGV4OyB9O1xuICAgICAgICBfdGhpcy5faXRlbVRlbXBsYXRlU2VsZWN0b3JCaW5kYWJsZSA9IG5ldyBsYWJlbF8xLkxhYmVsKCk7XG4gICAgICAgIF90aGlzLl9kZWZhdWx0VGVtcGxhdGUgPSB7XG4gICAgICAgICAgICBrZXk6IFwiZGVmYXVsdFwiLFxuICAgICAgICAgICAgY3JlYXRlVmlldzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pdGVtVGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkZXJfMS5wYXJzZShfdGhpcy5pdGVtVGVtcGxhdGUsIF90aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuX2l0ZW1UZW1wbGF0ZXNJbnRlcm5hbCA9IG5ldyBBcnJheShfdGhpcy5fZGVmYXVsdFRlbXBsYXRlKTtcbiAgICAgICAgX3RoaXMuX2VmZmVjdGl2ZVJvd0hlaWdodCA9IGF1dG9FZmZlY3RpdmVSb3dIZWlnaHQ7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExpc3RWaWV3QmFzZS5wcm90b3R5cGUsIFwic2VwYXJhdG9yQ29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnNlcGFyYXRvckNvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5zZXBhcmF0b3JDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGlzdFZpZXdCYXNlLnByb3RvdHlwZSwgXCJpdGVtVGVtcGxhdGVTZWxlY3RvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1UZW1wbGF0ZVNlbGVjdG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pdGVtVGVtcGxhdGVTZWxlY3RvckJpbmRhYmxlLmJpbmQoe1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VQcm9wZXJ0eTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UHJvcGVydHk6IFwidGVtcGxhdGVLZXlcIixcbiAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogdmFsdWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9pdGVtVGVtcGxhdGVTZWxlY3RvciA9IGZ1bmN0aW9uIChpdGVtLCBpbmRleCwgaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbVtcIiRpbmRleFwiXSA9IGluZGV4O1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX2l0ZW1UZW1wbGF0ZVNlbGVjdG9yQmluZGFibGUuYmluZGluZ0NvbnRleHQgPT09IGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9pdGVtVGVtcGxhdGVTZWxlY3RvckJpbmRhYmxlLmJpbmRpbmdDb250ZXh0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5faXRlbVRlbXBsYXRlU2VsZWN0b3JCaW5kYWJsZS5iaW5kaW5nQ29udGV4dCA9IGl0ZW07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5faXRlbVRlbXBsYXRlU2VsZWN0b3JCaW5kYWJsZS5nZXQoXCJ0ZW1wbGF0ZUtleVwiKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pdGVtVGVtcGxhdGVTZWxlY3RvciA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGlzdFZpZXdCYXNlLnByb3RvdHlwZSwgXCJpdGVtSWRHZW5lcmF0b3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pdGVtSWRHZW5lcmF0b3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGdlbmVyYXRvckZuKSB7XG4gICAgICAgICAgICB0aGlzLl9pdGVtSWRHZW5lcmF0b3IgPSBnZW5lcmF0b3JGbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTGlzdFZpZXdCYXNlLnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgTGlzdFZpZXdCYXNlLnByb3RvdHlwZS5zY3JvbGxUb0luZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgfTtcbiAgICBMaXN0Vmlld0Jhc2UucHJvdG90eXBlLnNjcm9sbFRvSW5kZXhBbmltYXRlZCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgIH07XG4gICAgTGlzdFZpZXdCYXNlLnByb3RvdHlwZS5fZ2V0SXRlbVRlbXBsYXRlID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHZhciB0ZW1wbGF0ZUtleSA9IFwiZGVmYXVsdFwiO1xuICAgICAgICBpZiAodGhpcy5pdGVtVGVtcGxhdGVTZWxlY3Rvcikge1xuICAgICAgICAgICAgdmFyIGRhdGFJdGVtID0gdGhpcy5fZ2V0RGF0YUl0ZW0oaW5kZXgpO1xuICAgICAgICAgICAgdGVtcGxhdGVLZXkgPSB0aGlzLl9pdGVtVGVtcGxhdGVTZWxlY3RvcihkYXRhSXRlbSwgaW5kZXgsIHRoaXMuaXRlbXMpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IHRoaXMuX2l0ZW1UZW1wbGF0ZXNJbnRlcm5hbC5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5faXRlbVRlbXBsYXRlc0ludGVybmFsW2ldLmtleSA9PT0gdGVtcGxhdGVLZXkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faXRlbVRlbXBsYXRlc0ludGVybmFsW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9pdGVtVGVtcGxhdGVzSW50ZXJuYWxbMF07XG4gICAgfTtcbiAgICBMaXN0Vmlld0Jhc2UucHJvdG90eXBlLl9wcmVwYXJlSXRlbSA9IGZ1bmN0aW9uIChpdGVtLCBpbmRleCkge1xuICAgICAgICBpZiAoaXRlbSkge1xuICAgICAgICAgICAgaXRlbS5iaW5kaW5nQ29udGV4dCA9IHRoaXMuX2dldERhdGFJdGVtKGluZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTGlzdFZpZXdCYXNlLnByb3RvdHlwZS5fZ2V0RGF0YUl0ZW0gPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIHRoaXNJdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIHJldHVybiB0aGlzSXRlbXMuZ2V0SXRlbSA/IHRoaXNJdGVtcy5nZXRJdGVtKGluZGV4KSA6IHRoaXNJdGVtc1tpbmRleF07XG4gICAgfTtcbiAgICBMaXN0Vmlld0Jhc2UucHJvdG90eXBlLl9nZXREZWZhdWx0SXRlbUNvbnRlbnQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIGxibCA9IG5ldyBsYWJlbF8xLkxhYmVsKCk7XG4gICAgICAgIGxibC5iaW5kKHtcbiAgICAgICAgICAgIHRhcmdldFByb3BlcnR5OiBcInRleHRcIixcbiAgICAgICAgICAgIHNvdXJjZVByb3BlcnR5OiBcIiR2YWx1ZVwiXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbGJsO1xuICAgIH07XG4gICAgTGlzdFZpZXdCYXNlLnByb3RvdHlwZS5fb25JdGVtc0NoYW5nZWQgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICB9O1xuICAgIExpc3RWaWV3QmFzZS5wcm90b3R5cGUuX29uUm93SGVpZ2h0UHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICB9O1xuICAgIExpc3RWaWV3QmFzZS5wcm90b3R5cGUuaXNJdGVtQXRJbmRleFZpc2libGUgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgTGlzdFZpZXdCYXNlLnByb3RvdHlwZS51cGRhdGVFZmZlY3RpdmVSb3dIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGV4cG9ydHMucm93SGVpZ2h0UHJvcGVydHkuY29lcmNlKHRoaXMpO1xuICAgIH07XG4gICAgTGlzdFZpZXdCYXNlLml0ZW1Mb2FkaW5nRXZlbnQgPSBcIml0ZW1Mb2FkaW5nXCI7XG4gICAgTGlzdFZpZXdCYXNlLml0ZW1UYXBFdmVudCA9IFwiaXRlbVRhcFwiO1xuICAgIExpc3RWaWV3QmFzZS5sb2FkTW9yZUl0ZW1zRXZlbnQgPSBcImxvYWRNb3JlSXRlbXNcIjtcbiAgICBMaXN0Vmlld0Jhc2Uua25vd25GdW5jdGlvbnMgPSBbXCJpdGVtVGVtcGxhdGVTZWxlY3RvclwiLCBcIml0ZW1JZEdlbmVyYXRvclwiXTtcbiAgICBMaXN0Vmlld0Jhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJMaXN0Vmlld1wiKVxuICAgIF0sIExpc3RWaWV3QmFzZSk7XG4gICAgcmV0dXJuIExpc3RWaWV3QmFzZTtcbn0odmlld18xLkNvbnRhaW5lclZpZXcpKTtcbmV4cG9ydHMuTGlzdFZpZXdCYXNlID0gTGlzdFZpZXdCYXNlO1xuTGlzdFZpZXdCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpdGVtc1wiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAob2xkVmFsdWUgaW5zdGFuY2VvZiB2aWV3XzEuT2JzZXJ2YWJsZSkge1xuICAgICAgICAgICAgd2Vha19ldmVudF9saXN0ZW5lcl8xLnJlbW92ZVdlYWtFdmVudExpc3RlbmVyKG9sZFZhbHVlLCBvYnNlcnZhYmxlX2FycmF5XzEuT2JzZXJ2YWJsZUFycmF5LmNoYW5nZUV2ZW50LCB0YXJnZXQuX29uSXRlbXNDaGFuZ2VkLCB0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdWYWx1ZSBpbnN0YW5jZW9mIHZpZXdfMS5PYnNlcnZhYmxlKSB7XG4gICAgICAgICAgICB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEuYWRkV2Vha0V2ZW50TGlzdGVuZXIobmV3VmFsdWUsIG9ic2VydmFibGVfYXJyYXlfMS5PYnNlcnZhYmxlQXJyYXkuY2hhbmdlRXZlbnQsIHRhcmdldC5fb25JdGVtc0NoYW5nZWQsIHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgdGFyZ2V0LnJlZnJlc2goKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuaXRlbXNQcm9wZXJ0eS5yZWdpc3RlcihMaXN0Vmlld0Jhc2UpO1xuZXhwb3J0cy5pdGVtVGVtcGxhdGVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbVRlbXBsYXRlXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgICB0YXJnZXQucmVmcmVzaCgpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pdGVtVGVtcGxhdGVQcm9wZXJ0eS5yZWdpc3RlcihMaXN0Vmlld0Jhc2UpO1xuZXhwb3J0cy5pdGVtVGVtcGxhdGVzUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1UZW1wbGF0ZXNcIiwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gYnVpbGRlcl8xLnBhcnNlTXVsdGlwbGVUZW1wbGF0ZXModmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG59KTtcbmV4cG9ydHMuaXRlbVRlbXBsYXRlc1Byb3BlcnR5LnJlZ2lzdGVyKExpc3RWaWV3QmFzZSk7XG52YXIgZGVmYXVsdFJvd0hlaWdodCA9IFwiYXV0b1wiO1xuZXhwb3J0cy5yb3dIZWlnaHRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ29lcmNpYmxlUHJvcGVydHkoe1xuICAgIG5hbWU6IFwicm93SGVpZ2h0XCIsIGRlZmF1bHRWYWx1ZTogZGVmYXVsdFJvd0hlaWdodCwgZXF1YWxpdHlDb21wYXJlcjogdmlld18xLkxlbmd0aC5lcXVhbHMsXG4gICAgY29lcmNlVmFsdWU6IGZ1bmN0aW9uICh0YXJnZXQsIHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB0YXJnZXQubmF0aXZlVmlld1Byb3RlY3RlZCA/IHZhbHVlIDogZGVmYXVsdFJvd0hlaWdodDtcbiAgICB9LFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5fZWZmZWN0aXZlUm93SGVpZ2h0ID0gdmlld18xLkxlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgYXV0b0VmZmVjdGl2ZVJvd0hlaWdodCk7XG4gICAgICAgIHRhcmdldC5fb25Sb3dIZWlnaHRQcm9wZXJ0eUNoYW5nZWQob2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogdmlld18xLkxlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLnJvd0hlaWdodFByb3BlcnR5LnJlZ2lzdGVyKExpc3RWaWV3QmFzZSk7XG5leHBvcnRzLmlvc0VzdGltYXRlZFJvd0hlaWdodFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpb3NFc3RpbWF0ZWRSb3dIZWlnaHRcIiwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiB2aWV3XzEuTGVuZ3RoLnBhcnNlKHYpOyB9XG59KTtcbmV4cG9ydHMuaW9zRXN0aW1hdGVkUm93SGVpZ2h0UHJvcGVydHkucmVnaXN0ZXIoTGlzdFZpZXdCYXNlKTtcbmV4cG9ydHMuc2VwYXJhdG9yQ29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcInNlcGFyYXRvckNvbG9yXCIsIGNzc05hbWU6IFwic2VwYXJhdG9yLWNvbG9yXCIsIGVxdWFsaXR5Q29tcGFyZXI6IHZpZXdfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IHZpZXdfMS5Db2xvcih2KTsgfSB9KTtcbmV4cG9ydHMuc2VwYXJhdG9yQ29sb3JQcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bGlzdC12aWV3LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxpc3Rfdmlld19jb21tb25fMSA9IHJlcXVpcmUoXCIuL2xpc3Qtdmlldy1jb21tb25cIik7XG52YXIgc3RhY2tfbGF5b3V0XzEgPSByZXF1aXJlKFwiLi4vbGF5b3V0cy9zdGFjay1sYXlvdXRcIik7XG52YXIgcHJveHlfdmlld19jb250YWluZXJfMSA9IHJlcXVpcmUoXCIuLi9wcm94eS12aWV3LWNvbnRhaW5lclwiKTtcbnZhciBsYXlvdXRfYmFzZV8xID0gcmVxdWlyZShcIi4uL2xheW91dHMvbGF5b3V0LWJhc2VcIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vcHJvZmlsaW5nXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vbGlzdC12aWV3LWNvbW1vblwiKSk7XG52YXIgSVRFTUxPQURJTkcgPSBsaXN0X3ZpZXdfY29tbW9uXzEuTGlzdFZpZXdCYXNlLml0ZW1Mb2FkaW5nRXZlbnQ7XG52YXIgTE9BRE1PUkVJVEVNUyA9IGxpc3Rfdmlld19jb21tb25fMS5MaXN0Vmlld0Jhc2UubG9hZE1vcmVJdGVtc0V2ZW50O1xudmFyIElURU1UQVAgPSBsaXN0X3ZpZXdfY29tbW9uXzEuTGlzdFZpZXdCYXNlLml0ZW1UYXBFdmVudDtcbnZhciBJdGVtQ2xpY2tMaXN0ZW5lcjtcbmZ1bmN0aW9uIGluaXRpYWxpemVJdGVtQ2xpY2tMaXN0ZW5lcigpIHtcbiAgICBpZiAoSXRlbUNsaWNrTGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgSXRlbUNsaWNrTGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKEl0ZW1DbGlja0xpc3RlbmVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gSXRlbUNsaWNrTGlzdGVuZXJJbXBsKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIEl0ZW1DbGlja0xpc3RlbmVySW1wbC5wcm90b3R5cGUub25JdGVtQ2xpY2sgPSBmdW5jdGlvbiAocGFyZW50LCBjb252ZXJ0VmlldywgaW5kZXgsIGlkKSB7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgdmFyIHZpZXcgPSBvd25lci5fcmVhbGl6ZWRUZW1wbGF0ZXMuZ2V0KG93bmVyLl9nZXRJdGVtVGVtcGxhdGUoaW5kZXgpLmtleSkuZ2V0KGNvbnZlcnRWaWV3KTtcbiAgICAgICAgICAgIG93bmVyLm5vdGlmeSh7IGV2ZW50TmFtZTogSVRFTVRBUCwgb2JqZWN0OiBvd25lciwgaW5kZXg6IGluZGV4LCB2aWV3OiB2aWV3IH0pO1xuICAgICAgICB9O1xuICAgICAgICBJdGVtQ2xpY2tMaXN0ZW5lckltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWQud2lkZ2V0LkFkYXB0ZXJWaWV3Lk9uSXRlbUNsaWNrTGlzdGVuZXJdKVxuICAgICAgICBdLCBJdGVtQ2xpY2tMaXN0ZW5lckltcGwpO1xuICAgICAgICByZXR1cm4gSXRlbUNsaWNrTGlzdGVuZXJJbXBsO1xuICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgIEl0ZW1DbGlja0xpc3RlbmVyID0gSXRlbUNsaWNrTGlzdGVuZXJJbXBsO1xufVxudmFyIExpc3RWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTGlzdFZpZXcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTGlzdFZpZXcoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fYW5kcm9pZFZpZXdJZCA9IC0xO1xuICAgICAgICBfdGhpcy5fcmVhbGl6ZWRJdGVtcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgX3RoaXMuX3JlYWxpemVkVGVtcGxhdGVzID0gbmV3IE1hcCgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIExpc3RWaWV3LnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbGlzdFZpZXcgPSBuZXcgYW5kcm9pZC53aWRnZXQuTGlzdFZpZXcodGhpcy5fY29udGV4dCk7XG4gICAgICAgIGxpc3RWaWV3LnNldERlc2NlbmRhbnRGb2N1c2FiaWxpdHkoYW5kcm9pZC52aWV3LlZpZXdHcm91cC5GT0NVU19BRlRFUl9ERVNDRU5EQU5UUyk7XG4gICAgICAgIGxpc3RWaWV3LnNldENhY2hlQ29sb3JIaW50KGFuZHJvaWQuZ3JhcGhpY3MuQ29sb3IuVFJBTlNQQVJFTlQpO1xuICAgICAgICByZXR1cm4gbGlzdFZpZXc7XG4gICAgfTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy51cGRhdGVFZmZlY3RpdmVSb3dIZWlnaHQoKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGluaXRpYWxpemVJdGVtQ2xpY2tMaXN0ZW5lcigpO1xuICAgICAgICBlbnN1cmVMaXN0Vmlld0FkYXB0ZXJDbGFzcygpO1xuICAgICAgICB2YXIgYWRhcHRlciA9IG5ldyBMaXN0Vmlld0FkYXB0ZXJDbGFzcyh0aGlzKTtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRBZGFwdGVyKGFkYXB0ZXIpO1xuICAgICAgICBuYXRpdmVWaWV3LmFkYXB0ZXIgPSBhZGFwdGVyO1xuICAgICAgICB2YXIgaXRlbUNsaWNrTGlzdGVuZXIgPSBuZXcgSXRlbUNsaWNrTGlzdGVuZXIodGhpcyk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0T25JdGVtQ2xpY2tMaXN0ZW5lcihpdGVtQ2xpY2tMaXN0ZW5lcik7XG4gICAgICAgIG5hdGl2ZVZpZXcuaXRlbUNsaWNrTGlzdGVuZXIgPSBpdGVtQ2xpY2tMaXN0ZW5lcjtcbiAgICAgICAgaWYgKHRoaXMuX2FuZHJvaWRWaWV3SWQgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLl9hbmRyb2lkVmlld0lkID0gYW5kcm9pZC52aWV3LlZpZXcuZ2VuZXJhdGVWaWV3SWQoKTtcbiAgICAgICAgfVxuICAgICAgICBuYXRpdmVWaWV3LnNldElkKHRoaXMuX2FuZHJvaWRWaWV3SWQpO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRBZGFwdGVyKG51bGwpO1xuICAgICAgICBuYXRpdmVWaWV3Lml0ZW1DbGlja0xpc3RlbmVyLm93bmVyID0gbnVsbDtcbiAgICAgICAgbmF0aXZlVmlldy5hZGFwdGVyLm93bmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5jbGVhclJlYWxpemVkQ2VsbHMoKTtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMucmVxdWVzdExheW91dCgpO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAoIW5hdGl2ZVZpZXcgfHwgIW5hdGl2ZVZpZXcuZ2V0QWRhcHRlcigpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcmVhbGl6ZWRJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uICh2aWV3LCBuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICBpZiAoISh2aWV3LmJpbmRpbmdDb250ZXh0IGluc3RhbmNlb2YgbGlzdF92aWV3X2NvbW1vbl8xLk9ic2VydmFibGUpKSB7XG4gICAgICAgICAgICAgICAgdmlldy5iaW5kaW5nQ29udGV4dCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBuYXRpdmVWaWV3LmdldEFkYXB0ZXIoKS5ub3RpZnlEYXRhU2V0Q2hhbmdlZCgpO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLnNjcm9sbFRvSW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldFNlbGVjdGlvbihpbmRleCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5zY3JvbGxUb0luZGV4QW5pbWF0ZWQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNtb290aFNjcm9sbFRvUG9zaXRpb24oaW5kZXgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGlzdFZpZXcucHJvdG90eXBlLCBcIl9jaGlsZHJlbkNvdW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVhbGl6ZWRJdGVtcy5zaXplO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGUuZWFjaENoaWxkVmlldyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLl9yZWFsaXplZEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKHZpZXcsIG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIGlmICh2aWV3LnBhcmVudCBpbnN0YW5jZW9mIExpc3RWaWV3KSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sodmlldyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodmlldy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sodmlldy5wYXJlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGUuX2R1bXBSZWFsaXplZFRlbXBsYXRlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJSZWFsaXplZCBUZW1wbGF0ZXM6XCIpO1xuICAgICAgICB0aGlzLl9yZWFsaXplZFRlbXBsYXRlcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiXFx0XCIgKyBpbmRleCArIFwiOlwiKTtcbiAgICAgICAgICAgIHZhbHVlLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBpbmRleCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiXFx0XFx0XCIgKyBpbmRleC5oYXNoQ29kZSgpICsgXCI6IFwiICsgdmFsdWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZyhcIlJlYWxpemVkIEl0ZW1zIFNpemU6IFwiICsgdGhpcy5fcmVhbGl6ZWRJdGVtcy5zaXplKTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5jbGVhclJlYWxpemVkQ2VsbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuX3JlYWxpemVkSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAodmlldywgbmF0aXZlVmlldykge1xuICAgICAgICAgICAgaWYgKHZpZXcucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKCEodmlldy5wYXJlbnQgaW5zdGFuY2VvZiBMaXN0VmlldykpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3JlbW92ZVZpZXcodmlldy5wYXJlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2aWV3LnBhcmVudC5fcmVtb3ZlVmlldyh2aWV3KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3JlYWxpemVkSXRlbXMuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5fcmVhbGl6ZWRUZW1wbGF0ZXMuY2xlYXIoKTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5pc0l0ZW1BdEluZGV4VmlzaWJsZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIHN0YXJ0ID0gbmF0aXZlVmlldy5nZXRGaXJzdFZpc2libGVQb3NpdGlvbigpO1xuICAgICAgICB2YXIgZW5kID0gbmF0aXZlVmlldy5nZXRMYXN0VmlzaWJsZVBvc2l0aW9uKCk7XG4gICAgICAgIHJldHVybiAoaW5kZXggPj0gc3RhcnQgJiYgaW5kZXggPD0gZW5kKTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZVtsaXN0X3ZpZXdfY29tbW9uXzEuc2VwYXJhdG9yQ29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkaXZpZGVySGVpZ2h0OiBuYXRpdmVWaWV3LmdldERpdmlkZXJIZWlnaHQoKSxcbiAgICAgICAgICAgIGRpdmlkZXI6IG5hdGl2ZVZpZXcuZ2V0RGl2aWRlcigpXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGVbbGlzdF92aWV3X2NvbW1vbl8xLnNlcGFyYXRvckNvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgbGlzdF92aWV3X2NvbW1vbl8xLkNvbG9yKSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldERpdmlkZXIobmV3IGFuZHJvaWQuZ3JhcGhpY3MuZHJhd2FibGUuQ29sb3JEcmF3YWJsZSh2YWx1ZS5hbmRyb2lkKSk7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldERpdmlkZXJIZWlnaHQoMSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldERpdmlkZXIodmFsdWUuZGl2aWRlcik7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldERpdmlkZXJIZWlnaHQodmFsdWUuZGl2aWRlckhlaWdodCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZVtsaXN0X3ZpZXdfY29tbW9uXzEuaXRlbVRlbXBsYXRlc1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZVtsaXN0X3ZpZXdfY29tbW9uXzEuaXRlbVRlbXBsYXRlc1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5faXRlbVRlbXBsYXRlc0ludGVybmFsID0gbmV3IEFycmF5KHRoaXMuX2RlZmF1bHRUZW1wbGF0ZSk7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5faXRlbVRlbXBsYXRlc0ludGVybmFsID0gdGhpcy5faXRlbVRlbXBsYXRlc0ludGVybmFsLmNvbmNhdCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEFkYXB0ZXIobmV3IExpc3RWaWV3QWRhcHRlckNsYXNzKHRoaXMpKTtcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIExpc3RWaWV3LnByb3RvdHlwZSwgXCJjcmVhdGVOYXRpdmVWaWV3XCIsIG51bGwpO1xuICAgIHJldHVybiBMaXN0Vmlldztcbn0obGlzdF92aWV3X2NvbW1vbl8xLkxpc3RWaWV3QmFzZSkpO1xuZXhwb3J0cy5MaXN0VmlldyA9IExpc3RWaWV3O1xudmFyIExpc3RWaWV3QWRhcHRlckNsYXNzO1xuZnVuY3Rpb24gZW5zdXJlTGlzdFZpZXdBZGFwdGVyQ2xhc3MoKSB7XG4gICAgaWYgKExpc3RWaWV3QWRhcHRlckNsYXNzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIExpc3RWaWV3QWRhcHRlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhMaXN0Vmlld0FkYXB0ZXIsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIExpc3RWaWV3QWRhcHRlcihvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBMaXN0Vmlld0FkYXB0ZXIucHJvdG90eXBlLmdldENvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3duZXIgJiYgdGhpcy5vd25lci5pdGVtcyAmJiB0aGlzLm93bmVyLml0ZW1zLmxlbmd0aCA/IHRoaXMub3duZXIuaXRlbXMubGVuZ3RoIDogMDtcbiAgICAgICAgfTtcbiAgICAgICAgTGlzdFZpZXdBZGFwdGVyLnByb3RvdHlwZS5nZXRJdGVtID0gZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm93bmVyICYmIHRoaXMub3duZXIuaXRlbXMgJiYgaSA8IHRoaXMub3duZXIuaXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGdldEl0ZW0gPSB0aGlzLm93bmVyLml0ZW1zLmdldEl0ZW07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEl0ZW0gPyBnZXRJdGVtLmNhbGwodGhpcy5vd25lci5pdGVtcywgaSkgOiB0aGlzLm93bmVyLml0ZW1zW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIExpc3RWaWV3QWRhcHRlci5wcm90b3R5cGUuZ2V0SXRlbUlkID0gZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5nZXRJdGVtKGkpO1xuICAgICAgICAgICAgdmFyIGlkID0gaTtcbiAgICAgICAgICAgIGlmICh0aGlzLm93bmVyICYmIGl0ZW0gJiYgdGhpcy5vd25lci5pdGVtcykge1xuICAgICAgICAgICAgICAgIGlkID0gdGhpcy5vd25lci5pdGVtSWRHZW5lcmF0b3IoaXRlbSwgaSwgdGhpcy5vd25lci5pdGVtcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbG9uZyhpZCk7XG4gICAgICAgIH07XG4gICAgICAgIExpc3RWaWV3QWRhcHRlci5wcm90b3R5cGUuaGFzU3RhYmxlSWRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIExpc3RWaWV3QWRhcHRlci5wcm90b3R5cGUuZ2V0Vmlld1R5cGVDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm93bmVyLl9pdGVtVGVtcGxhdGVzSW50ZXJuYWwubGVuZ3RoO1xuICAgICAgICB9O1xuICAgICAgICBMaXN0Vmlld0FkYXB0ZXIucHJvdG90eXBlLmdldEl0ZW1WaWV3VHlwZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gdGhpcy5vd25lci5fZ2V0SXRlbVRlbXBsYXRlKGluZGV4KTtcbiAgICAgICAgICAgIHZhciBpdGVtVmlld1R5cGUgPSB0aGlzLm93bmVyLl9pdGVtVGVtcGxhdGVzSW50ZXJuYWwuaW5kZXhPZih0ZW1wbGF0ZSk7XG4gICAgICAgICAgICByZXR1cm4gaXRlbVZpZXdUeXBlO1xuICAgICAgICB9O1xuICAgICAgICBMaXN0Vmlld0FkYXB0ZXIucHJvdG90eXBlLmdldFZpZXcgPSBmdW5jdGlvbiAoaW5kZXgsIGNvbnZlcnRWaWV3LCBwYXJlbnQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5vd25lcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRvdGFsSXRlbUNvdW50ID0gdGhpcy5vd25lci5pdGVtcyA/IHRoaXMub3duZXIuaXRlbXMubGVuZ3RoIDogMDtcbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gKHRvdGFsSXRlbUNvdW50IC0gMSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm93bmVyLm5vdGlmeSh7IGV2ZW50TmFtZTogTE9BRE1PUkVJVEVNUywgb2JqZWN0OiB0aGlzLm93bmVyIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gdGhpcy5vd25lci5fZ2V0SXRlbVRlbXBsYXRlKGluZGV4KTtcbiAgICAgICAgICAgIHZhciB2aWV3O1xuICAgICAgICAgICAgaWYgKGNvbnZlcnRWaWV3KSB7XG4gICAgICAgICAgICAgICAgdmlldyA9IHRoaXMub3duZXIuX3JlYWxpemVkVGVtcGxhdGVzLmdldCh0ZW1wbGF0ZS5rZXkpLmdldChjb252ZXJ0Vmlldyk7XG4gICAgICAgICAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZXJlIGlzIG5vIGVudHJ5IHdpdGgga2V5ICdcIiArIGNvbnZlcnRWaWV3ICsgXCInIGluIHRoZSByZWFsaXplZCB2aWV3cyBjYWNoZSBmb3IgdGVtcGxhdGUgd2l0aCBrZXknXCIgKyB0ZW1wbGF0ZS5rZXkgKyBcIicuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZpZXcgPSB0ZW1wbGF0ZS5jcmVhdGVWaWV3KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgICAgICBldmVudE5hbWU6IElURU1MT0FESU5HLCBvYmplY3Q6IHRoaXMub3duZXIsIGluZGV4OiBpbmRleCwgdmlldzogdmlldyxcbiAgICAgICAgICAgICAgICBhbmRyb2lkOiBwYXJlbnQsXG4gICAgICAgICAgICAgICAgaW9zOiB1bmRlZmluZWRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLm93bmVyLm5vdGlmeShhcmdzKTtcbiAgICAgICAgICAgIGlmICghYXJncy52aWV3KSB7XG4gICAgICAgICAgICAgICAgYXJncy52aWV3ID0gdGhpcy5vd25lci5fZ2V0RGVmYXVsdEl0ZW1Db250ZW50KGluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcmdzLnZpZXcpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vd25lci5fZWZmZWN0aXZlUm93SGVpZ2h0ID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJncy52aWV3LmhlaWdodCA9IHRoaXMub3duZXIucm93SGVpZ2h0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYXJncy52aWV3LmhlaWdodCA9IGxpc3Rfdmlld19jb21tb25fMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLm93bmVyLl9wcmVwYXJlSXRlbShhcmdzLnZpZXcsIGluZGV4KTtcbiAgICAgICAgICAgICAgICBpZiAoIWFyZ3Mudmlldy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MudmlldyBpbnN0YW5jZW9mIGxheW91dF9iYXNlXzEuTGF5b3V0QmFzZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgIShhcmdzLnZpZXcgaW5zdGFuY2VvZiBwcm94eV92aWV3X2NvbnRhaW5lcl8xLlByb3h5Vmlld0NvbnRhaW5lcikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3duZXIuX2FkZFZpZXcoYXJncy52aWV3KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnZlcnRWaWV3ID0gYXJncy52aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3AgPSBuZXcgc3RhY2tfbGF5b3V0XzEuU3RhY2tMYXlvdXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwLmFkZENoaWxkKGFyZ3Mudmlldyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm93bmVyLl9hZGRWaWV3KHNwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnZlcnRWaWV3ID0gc3AubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVhbGl6ZWRJdGVtc0ZvclRlbXBsYXRlS2V5ID0gdGhpcy5vd25lci5fcmVhbGl6ZWRUZW1wbGF0ZXMuZ2V0KHRlbXBsYXRlLmtleSk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZWFsaXplZEl0ZW1zRm9yVGVtcGxhdGVLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVhbGl6ZWRJdGVtc0ZvclRlbXBsYXRlS2V5ID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm93bmVyLl9yZWFsaXplZFRlbXBsYXRlcy5zZXQodGVtcGxhdGUua2V5LCByZWFsaXplZEl0ZW1zRm9yVGVtcGxhdGVLZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZWFsaXplZEl0ZW1zRm9yVGVtcGxhdGVLZXkuc2V0KGNvbnZlcnRWaWV3LCBhcmdzLnZpZXcpO1xuICAgICAgICAgICAgICAgIHRoaXMub3duZXIuX3JlYWxpemVkSXRlbXMuc2V0KGNvbnZlcnRWaWV3LCBhcmdzLnZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbnZlcnRWaWV3O1xuICAgICAgICB9O1xuICAgICAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICAgICAgXSwgTGlzdFZpZXdBZGFwdGVyLnByb3RvdHlwZSwgXCJnZXRWaWV3XCIsIG51bGwpO1xuICAgICAgICByZXR1cm4gTGlzdFZpZXdBZGFwdGVyO1xuICAgIH0oYW5kcm9pZC53aWRnZXQuQmFzZUFkYXB0ZXIpKTtcbiAgICBMaXN0Vmlld0FkYXB0ZXJDbGFzcyA9IExpc3RWaWV3QWRhcHRlcjtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxpc3Qtdmlldy5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29udGVudF92aWV3XzEgPSByZXF1aXJlKFwiLi4vY29udGVudC12aWV3XCIpO1xudmFyIGZyYW1lXzEgPSByZXF1aXJlKFwiLi4vZnJhbWVcIik7XG52YXIgYWN0aW9uX2Jhcl8xID0gcmVxdWlyZShcIi4uL2FjdGlvbi1iYXJcIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vcHJvZmlsaW5nXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvbnRlbnQtdmlld1wiKSk7XG52YXIgUGFnZUJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhQYWdlQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQYWdlQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBQYWdlQmFzZV8xID0gUGFnZUJhc2U7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhZ2VCYXNlLnByb3RvdHlwZSwgXCJuYXZpZ2F0aW9uQ29udGV4dFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25hdmlnYXRpb25Db250ZXh0O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFnZUJhc2UucHJvdG90eXBlLCBcImFjdGlvbkJhclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9hY3Rpb25CYXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhc0FjdGlvbkJhciA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWN0aW9uQmFyID0gbmV3IGFjdGlvbl9iYXJfMS5BY3Rpb25CYXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHRoaXMuX2FjdGlvbkJhcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWN0aW9uQmFyO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFjdGlvbkJhciBjYW5ub3QgYmUgbnVsbCBvciB1bmRlZmluZWQuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX2FjdGlvbkJhciAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWN0aW9uQmFyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVZpZXcodGhpcy5fYWN0aW9uQmFyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5oYXNBY3Rpb25CYXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvbkJhciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodGhpcy5fYWN0aW9uQmFyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhZ2VCYXNlLnByb3RvdHlwZSwgXCJzdGF0dXNCYXJTdHlsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuc3RhdHVzQmFyU3R5bGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnN0YXR1c0JhclN0eWxlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYWdlQmFzZS5wcm90b3R5cGUsIFwiYW5kcm9pZFN0YXR1c0JhckJhY2tncm91bmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmFuZHJvaWRTdGF0dXNCYXJCYWNrZ3JvdW5kO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5hbmRyb2lkU3RhdHVzQmFyQmFja2dyb3VuZCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFnZUJhc2UucHJvdG90eXBlLCBcInBhZ2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBQYWdlQmFzZS5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgYWN0aW9uX2Jhcl8xLkFjdGlvbkJhcikge1xuICAgICAgICAgICAgdGhpcy5hY3Rpb25CYXIgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIuY2FsbCh0aGlzLCBuYW1lLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBhZ2VCYXNlLnByb3RvdHlwZS5nZXRLZXlmcmFtZUFuaW1hdGlvbldpdGhOYW1lID0gZnVuY3Rpb24gKGFuaW1hdGlvbk5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlU2NvcGUuZ2V0S2V5ZnJhbWVBbmltYXRpb25XaXRoTmFtZShhbmltYXRpb25OYW1lKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYWdlQmFzZS5wcm90b3R5cGUsIFwiZnJhbWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBmcmFtZSA9IHRoaXMucGFyZW50O1xuICAgICAgICAgICAgcmV0dXJuIGZyYW1lIGluc3RhbmNlb2YgZnJhbWVfMS5GcmFtZSA/IGZyYW1lIDogdW5kZWZpbmVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBQYWdlQmFzZS5wcm90b3R5cGUuY3JlYXRlTmF2aWdhdGVkRGF0YSA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGlzQmFja05hdmlnYXRpb24pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogZXZlbnROYW1lLFxuICAgICAgICAgICAgb2JqZWN0OiB0aGlzLFxuICAgICAgICAgICAgY29udGV4dDogdGhpcy5uYXZpZ2F0aW9uQ29udGV4dCxcbiAgICAgICAgICAgIGlzQmFja05hdmlnYXRpb246IGlzQmFja05hdmlnYXRpb25cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFBhZ2VCYXNlLnByb3RvdHlwZS5vbk5hdmlnYXRpbmdUbyA9IGZ1bmN0aW9uIChjb250ZXh0LCBpc0JhY2tOYXZpZ2F0aW9uLCBiaW5kaW5nQ29udGV4dCkge1xuICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uQ29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIGlmIChpc0JhY2tOYXZpZ2F0aW9uICYmIHRoaXMuX3N0eWxlU2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0eWxlU2NvcGUuZW5zdXJlU2VsZWN0b3JzKCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2Nzc1N0YXRlLmlzU2VsZWN0b3JzTGF0ZXN0VmVyc2lvbkFwcGxpZWQoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uQ3NzU3RhdGVDaGFuZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzQmFja05hdmlnYXRpb24gJiYgYmluZGluZ0NvbnRleHQgIT09IHVuZGVmaW5lZCAmJiBiaW5kaW5nQ29udGV4dCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5iaW5kaW5nQ29udGV4dCA9IGJpbmRpbmdDb250ZXh0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuY3JlYXRlTmF2aWdhdGVkRGF0YShQYWdlQmFzZV8xLm5hdmlnYXRpbmdUb0V2ZW50LCBpc0JhY2tOYXZpZ2F0aW9uKSk7XG4gICAgfTtcbiAgICBQYWdlQmFzZS5wcm90b3R5cGUub25OYXZpZ2F0ZWRUbyA9IGZ1bmN0aW9uIChpc0JhY2tOYXZpZ2F0aW9uKSB7XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuY3JlYXRlTmF2aWdhdGVkRGF0YShQYWdlQmFzZV8xLm5hdmlnYXRlZFRvRXZlbnQsIGlzQmFja05hdmlnYXRpb24pKTtcbiAgICB9O1xuICAgIFBhZ2VCYXNlLnByb3RvdHlwZS5vbk5hdmlnYXRpbmdGcm9tID0gZnVuY3Rpb24gKGlzQmFja05hdmlnYXRpb24pIHtcbiAgICAgICAgdGhpcy5ub3RpZnkodGhpcy5jcmVhdGVOYXZpZ2F0ZWREYXRhKFBhZ2VCYXNlXzEubmF2aWdhdGluZ0Zyb21FdmVudCwgaXNCYWNrTmF2aWdhdGlvbikpO1xuICAgIH07XG4gICAgUGFnZUJhc2UucHJvdG90eXBlLm9uTmF2aWdhdGVkRnJvbSA9IGZ1bmN0aW9uIChpc0JhY2tOYXZpZ2F0aW9uKSB7XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuY3JlYXRlTmF2aWdhdGVkRGF0YShQYWdlQmFzZV8xLm5hdmlnYXRlZEZyb21FdmVudCwgaXNCYWNrTmF2aWdhdGlvbikpO1xuICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uQ29udGV4dCA9IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFBhZ2VCYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZWFjaENoaWxkVmlldy5jYWxsKHRoaXMsIGNhbGxiYWNrKTtcbiAgICAgICAgaWYgKHRoaXMuYWN0aW9uQmFyKSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aGlzLmFjdGlvbkJhcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYWdlQmFzZS5wcm90b3R5cGUsIFwiX2NoaWxkcmVuQ291bnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5jb250ZW50ID8gMSA6IDApICsgKHRoaXMuX2FjdGlvbkJhciA/IDEgOiAwKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgdmFyIFBhZ2VCYXNlXzE7XG4gICAgUGFnZUJhc2UubmF2aWdhdGluZ1RvRXZlbnQgPSBcIm5hdmlnYXRpbmdUb1wiO1xuICAgIFBhZ2VCYXNlLm5hdmlnYXRlZFRvRXZlbnQgPSBcIm5hdmlnYXRlZFRvXCI7XG4gICAgUGFnZUJhc2UubmF2aWdhdGluZ0Zyb21FdmVudCA9IFwibmF2aWdhdGluZ0Zyb21cIjtcbiAgICBQYWdlQmFzZS5uYXZpZ2F0ZWRGcm9tRXZlbnQgPSBcIm5hdmlnYXRlZEZyb21cIjtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFBhZ2VCYXNlLnByb3RvdHlwZSwgXCJvbk5hdmlnYXRpbmdUb1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFBhZ2VCYXNlLnByb3RvdHlwZSwgXCJvbk5hdmlnYXRlZFRvXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgUGFnZUJhc2UucHJvdG90eXBlLCBcIm9uTmF2aWdhdGluZ0Zyb21cIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBQYWdlQmFzZS5wcm90b3R5cGUsIFwib25OYXZpZ2F0ZWRGcm9tXCIsIG51bGwpO1xuICAgIFBhZ2VCYXNlID0gUGFnZUJhc2VfMSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBjb250ZW50X3ZpZXdfMS5DU1NUeXBlKFwiUGFnZVwiKVxuICAgIF0sIFBhZ2VCYXNlKTtcbiAgICByZXR1cm4gUGFnZUJhc2U7XG59KGNvbnRlbnRfdmlld18xLkNvbnRlbnRWaWV3KSk7XG5leHBvcnRzLlBhZ2VCYXNlID0gUGFnZUJhc2U7XG5QYWdlQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcIm5ldmVyXCI7XG5leHBvcnRzLmFjdGlvbkJhckhpZGRlblByb3BlcnR5ID0gbmV3IGNvbnRlbnRfdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJhY3Rpb25CYXJIaWRkZW5cIiwgYWZmZWN0c0xheW91dDogY29udGVudF92aWV3XzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBjb250ZW50X3ZpZXdfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5hY3Rpb25CYXJIaWRkZW5Qcm9wZXJ0eS5yZWdpc3RlcihQYWdlQmFzZSk7XG5leHBvcnRzLmJhY2tncm91bmRTcGFuVW5kZXJTdGF0dXNCYXJQcm9wZXJ0eSA9IG5ldyBjb250ZW50X3ZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYmFja2dyb3VuZFNwYW5VbmRlclN0YXR1c0JhclwiLCBkZWZhdWx0VmFsdWU6IGZhbHNlLCBhZmZlY3RzTGF5b3V0OiBjb250ZW50X3ZpZXdfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IGNvbnRlbnRfdmlld18xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmJhY2tncm91bmRTcGFuVW5kZXJTdGF0dXNCYXJQcm9wZXJ0eS5yZWdpc3RlcihQYWdlQmFzZSk7XG5leHBvcnRzLmVuYWJsZVN3aXBlQmFja05hdmlnYXRpb25Qcm9wZXJ0eSA9IG5ldyBjb250ZW50X3ZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiZW5hYmxlU3dpcGVCYWNrTmF2aWdhdGlvblwiLCBkZWZhdWx0VmFsdWU6IHRydWUsIHZhbHVlQ29udmVydGVyOiBjb250ZW50X3ZpZXdfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5lbmFibGVTd2lwZUJhY2tOYXZpZ2F0aW9uUHJvcGVydHkucmVnaXN0ZXIoUGFnZUJhc2UpO1xuZXhwb3J0cy5zdGF0dXNCYXJTdHlsZVByb3BlcnR5ID0gbmV3IGNvbnRlbnRfdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJzdGF0dXNCYXJTdHlsZVwiLCBjc3NOYW1lOiBcInN0YXR1cy1iYXItc3R5bGVcIiB9KTtcbmV4cG9ydHMuc3RhdHVzQmFyU3R5bGVQcm9wZXJ0eS5yZWdpc3Rlcihjb250ZW50X3ZpZXdfMS5TdHlsZSk7XG5leHBvcnRzLmFuZHJvaWRTdGF0dXNCYXJCYWNrZ3JvdW5kUHJvcGVydHkgPSBuZXcgY29udGVudF92aWV3XzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYW5kcm9pZFN0YXR1c0JhckJhY2tncm91bmRcIiwgY3NzTmFtZTogXCJhbmRyb2lkLXN0YXR1cy1iYXItYmFja2dyb3VuZFwiLFxuICAgIGVxdWFsaXR5Q29tcGFyZXI6IGNvbnRlbnRfdmlld18xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgY29udGVudF92aWV3XzEuQ29sb3Iodik7IH1cbn0pO1xuZXhwb3J0cy5hbmRyb2lkU3RhdHVzQmFyQmFja2dyb3VuZFByb3BlcnR5LnJlZ2lzdGVyKGNvbnRlbnRfdmlld18xLlN0eWxlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2UtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcGFnZV9jb21tb25fMSA9IHJlcXVpcmUoXCIuL3BhZ2UtY29tbW9uXCIpO1xudmFyIGFjdGlvbl9iYXJfMSA9IHJlcXVpcmUoXCIuLi9hY3Rpb24tYmFyXCIpO1xudmFyIGdyaWRfbGF5b3V0XzEgPSByZXF1aXJlKFwiLi4vbGF5b3V0cy9ncmlkLWxheW91dFwiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3BhZ2UtY29tbW9uXCIpKTtcbnZhciBTWVNURU1fVUlfRkxBR19MSUdIVF9TVEFUVVNfQkFSID0gMHgwMDAwMjAwMDtcbnZhciBTVEFUVVNfQkFSX0xJR0hUX0JDS0cgPSAtNjU3OTMxO1xudmFyIFNUQVRVU19CQVJfREFSS19CQ0tHID0gMTcxMTI3NjAzMjtcbnZhciBQYWdlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUGFnZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQYWdlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFBhZ2UucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsYXlvdXQgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRMYXlvdXQodGhpcy5fY29udGV4dCk7XG4gICAgICAgIGxheW91dC5hZGRSb3cobmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5JdGVtU3BlYygxLCBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZFVuaXRUeXBlLmF1dG8pKTtcbiAgICAgICAgbGF5b3V0LmFkZFJvdyhuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkl0ZW1TcGVjKDEsIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkVW5pdFR5cGUuc3RhcikpO1xuICAgICAgICByZXR1cm4gbGF5b3V0O1xuICAgIH07XG4gICAgUGFnZS5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEJhY2tncm91bmRDb2xvcigtMSk7XG4gICAgfTtcbiAgICBQYWdlLnByb3RvdHlwZS5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZSA9IGZ1bmN0aW9uIChjaGlsZCwgYXRJbmRleCkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkICYmIGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIGFjdGlvbl9iYXJfMS5BY3Rpb25CYXIpIHtcbiAgICAgICAgICAgICAgICBncmlkX2xheW91dF8xLkdyaWRMYXlvdXQuc2V0Um93KGNoaWxkLCAwKTtcbiAgICAgICAgICAgICAgICBjaGlsZC5ob3Jpem9udGFsQWxpZ25tZW50ID0gXCJzdHJldGNoXCI7XG4gICAgICAgICAgICAgICAgY2hpbGQudmVydGljYWxBbGlnbm1lbnQgPSBcInRvcFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZ3JpZF9sYXlvdXRfMS5HcmlkTGF5b3V0LnNldFJvdyhjaGlsZCwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUuY2FsbCh0aGlzLCBjaGlsZCwgYXRJbmRleCk7XG4gICAgfTtcbiAgICBQYWdlLnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5hY3Rpb25CYXJIaWRkZW4gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVBY3Rpb25CYXIoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZS5wcm90b3R5cGUudXBkYXRlQWN0aW9uQmFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmFjdGlvbkJhci51cGRhdGUoKTtcbiAgICB9O1xuICAgIFBhZ2UucHJvdG90eXBlW3BhZ2VfY29tbW9uXzEuYWN0aW9uQmFySGlkZGVuUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnVwZGF0ZUFjdGlvbkJhcigpO1xuICAgIH07XG4gICAgUGFnZS5wcm90b3R5cGVbcGFnZV9jb21tb25fMS5zdGF0dXNCYXJTdHlsZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAocGxhdGZvcm1fMS5kZXZpY2Uuc2RrVmVyc2lvbiA+PSBcIjIxXCIpIHtcbiAgICAgICAgICAgIHZhciB3aW5kb3dfMSA9IHRoaXMuX2NvbnRleHQuZ2V0V2luZG93KCk7XG4gICAgICAgICAgICB2YXIgZGVjb3JWaWV3ID0gd2luZG93XzEuZ2V0RGVjb3JWaWV3KCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGNvbG9yOiB3aW5kb3dfMS5nZXRTdGF0dXNCYXJDb2xvcigpLFxuICAgICAgICAgICAgICAgIHN5c3RlbVVpVmlzaWJpbGl0eTogZGVjb3JWaWV3LmdldFN5c3RlbVVpVmlzaWJpbGl0eSgpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgUGFnZS5wcm90b3R5cGVbcGFnZV9jb21tb25fMS5zdGF0dXNCYXJTdHlsZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuZGV2aWNlLnNka1ZlcnNpb24gPj0gXCIyMVwiKSB7XG4gICAgICAgICAgICB2YXIgd2luZG93XzIgPSB0aGlzLl9jb250ZXh0LmdldFdpbmRvdygpO1xuICAgICAgICAgICAgdmFyIGRlY29yVmlldyA9IHdpbmRvd18yLmdldERlY29yVmlldygpO1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBcImxpZ2h0XCIpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3dfMi5zZXRTdGF0dXNCYXJDb2xvcihTVEFUVVNfQkFSX0xJR0hUX0JDS0cpO1xuICAgICAgICAgICAgICAgIGRlY29yVmlldy5zZXRTeXN0ZW1VaVZpc2liaWxpdHkoU1lTVEVNX1VJX0ZMQUdfTElHSFRfU1RBVFVTX0JBUik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA9PT0gXCJkYXJrXCIpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3dfMi5zZXRTdGF0dXNCYXJDb2xvcihTVEFUVVNfQkFSX0RBUktfQkNLRyk7XG4gICAgICAgICAgICAgICAgZGVjb3JWaWV3LnNldFN5c3RlbVVpVmlzaWJpbGl0eSgwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHdpbmRvd18yLnNldFN0YXR1c0JhckNvbG9yKHZhbHVlLmNvbG9yKTtcbiAgICAgICAgICAgICAgICBkZWNvclZpZXcuc2V0U3lzdGVtVWlWaXNpYmlsaXR5KHZhbHVlLnN5c3RlbVVpVmlzaWJpbGl0eSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBhZ2UucHJvdG90eXBlW3BhZ2VfY29tbW9uXzEuYW5kcm9pZFN0YXR1c0JhckJhY2tncm91bmRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuZGV2aWNlLnNka1ZlcnNpb24gPj0gXCIyMVwiKSB7XG4gICAgICAgICAgICB2YXIgd2luZG93XzMgPSB0aGlzLl9jb250ZXh0LmdldFdpbmRvdygpO1xuICAgICAgICAgICAgcmV0dXJuIHdpbmRvd18zLmdldFN0YXR1c0JhckNvbG9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBQYWdlLnByb3RvdHlwZVtwYWdlX2NvbW1vbl8xLmFuZHJvaWRTdGF0dXNCYXJCYWNrZ3JvdW5kUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAocGxhdGZvcm1fMS5kZXZpY2Uuc2RrVmVyc2lvbiA+PSBcIjIxXCIpIHtcbiAgICAgICAgICAgIHZhciB3aW5kb3dfNCA9IHRoaXMuX2NvbnRleHQuZ2V0V2luZG93KCk7XG4gICAgICAgICAgICB2YXIgY29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIHBhZ2VfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5hbmRyb2lkIDogdmFsdWU7XG4gICAgICAgICAgICB3aW5kb3dfNC5zZXRTdGF0dXNCYXJDb2xvcihjb2xvcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgUGFnZS5wcm90b3R5cGUsIFwib25Mb2FkZWRcIiwgbnVsbCk7XG4gICAgcmV0dXJuIFBhZ2U7XG59KHBhZ2VfY29tbW9uXzEuUGFnZUJhc2UpKTtcbmV4cG9ydHMuUGFnZSA9IFBhZ2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG52YXIgUGxhY2Vob2xkZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhQbGFjZWhvbGRlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQbGFjZWhvbGRlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBQbGFjZWhvbGRlcl8xID0gUGxhY2Vob2xkZXI7XG4gICAgUGxhY2Vob2xkZXIucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhcmdzID0geyBldmVudE5hbWU6IFBsYWNlaG9sZGVyXzEuY3JlYXRpbmdWaWV3RXZlbnQsIG9iamVjdDogdGhpcywgdmlldzogdW5kZWZpbmVkLCBjb250ZXh0OiB0aGlzLl9jb250ZXh0IH07XG4gICAgICAgIHRoaXMubm90aWZ5KGFyZ3MpO1xuICAgICAgICByZXR1cm4gYXJncy52aWV3O1xuICAgIH07XG4gICAgdmFyIFBsYWNlaG9sZGVyXzE7XG4gICAgUGxhY2Vob2xkZXIuY3JlYXRpbmdWaWV3RXZlbnQgPSBcImNyZWF0aW5nVmlld1wiO1xuICAgIFBsYWNlaG9sZGVyID0gUGxhY2Vob2xkZXJfMSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIlBsYWNlaG9sZGVyXCIpXG4gICAgXSwgUGxhY2Vob2xkZXIpO1xuICAgIHJldHVybiBQbGFjZWhvbGRlcjtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuUGxhY2Vob2xkZXIgPSBQbGFjZWhvbGRlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBsYWNlaG9sZGVyLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgUHJvZ3Jlc3NCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUHJvZ3Jlc3NCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFByb2dyZXNzQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBQcm9ncmVzc0Jhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJQcm9ncmVzc1wiKVxuICAgIF0sIFByb2dyZXNzQmFzZSk7XG4gICAgcmV0dXJuIFByb2dyZXNzQmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuUHJvZ3Jlc3NCYXNlID0gUHJvZ3Jlc3NCYXNlO1xuUHJvZ3Jlc3NCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy52YWx1ZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Db2VyY2libGVQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJ2YWx1ZVwiLFxuICAgIGRlZmF1bHRWYWx1ZTogMCxcbiAgICBjb2VyY2VWYWx1ZTogZnVuY3Rpb24gKHQsIHYpIHtcbiAgICAgICAgcmV0dXJuIHYgPCAwID8gMCA6IE1hdGgubWluKHYsIHQubWF4VmFsdWUpO1xuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLnZhbHVlUHJvcGVydHkucmVnaXN0ZXIoUHJvZ3Jlc3NCYXNlKTtcbmV4cG9ydHMubWF4VmFsdWVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWF4VmFsdWVcIixcbiAgICBkZWZhdWx0VmFsdWU6IDEwMCxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBleHBvcnRzLnZhbHVlUHJvcGVydHkuY29lcmNlKHRhcmdldCk7XG4gICAgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMubWF4VmFsdWVQcm9wZXJ0eS5yZWdpc3RlcihQcm9ncmVzc0Jhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cHJvZ3Jlc3MtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvZ3Jlc3NfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9wcm9ncmVzcy1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9wcm9ncmVzcy1jb21tb25cIikpO1xudmFyIFJfQVRUUl9QUk9HUkVTU19CQVJfU1RZTEVfSE9SSVpPTlRBTCA9IDB4MDEwMTAwNzg7XG52YXIgUHJvZ3Jlc3MgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhQcm9ncmVzcywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQcm9ncmVzcygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBQcm9ncmVzcy5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBhbmRyb2lkLndpZGdldC5Qcm9ncmVzc0Jhcih0aGlzLl9jb250ZXh0LCBudWxsLCBSX0FUVFJfUFJPR1JFU1NfQkFSX1NUWUxFX0hPUklaT05UQUwpO1xuICAgIH07XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLnZhbHVlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLnZhbHVlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0UHJvZ3Jlc3ModmFsdWUpO1xuICAgIH07XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLm1heFZhbHVlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAxMDA7XG4gICAgfTtcbiAgICBQcm9ncmVzcy5wcm90b3R5cGVbcHJvZ3Jlc3NfY29tbW9uXzEubWF4VmFsdWVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRNYXgodmFsdWUpO1xuICAgIH07XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcHJvZ3Jlc3NEcmF3YWJsZSA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRQcm9ncmVzc0RyYXdhYmxlKCk7XG4gICAgICAgIGlmICghcHJvZ3Jlc3NEcmF3YWJsZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHByb2dyZXNzX2NvbW1vbl8xLkNvbG9yKSB7XG4gICAgICAgICAgICBwcm9ncmVzc0RyYXdhYmxlLnNldENvbG9yRmlsdGVyKHZhbHVlLmFuZHJvaWQsIGFuZHJvaWQuZ3JhcGhpY3MuUG9ydGVyRHVmZi5Nb2RlLlNSQ19JTik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwcm9ncmVzc0RyYXdhYmxlLmNsZWFyQ29sb3JGaWx0ZXIoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFByb2dyZXNzLnByb3RvdHlwZVtwcm9ncmVzc19jb21tb25fMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwcm9ncmVzc0RyYXdhYmxlID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFByb2dyZXNzRHJhd2FibGUoKTtcbiAgICAgICAgaWYgKCFwcm9ncmVzc0RyYXdhYmxlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByb2dyZXNzRHJhd2FibGUgaW5zdGFuY2VvZiBhbmRyb2lkLmdyYXBoaWNzLmRyYXdhYmxlLkxheWVyRHJhd2FibGUgJiYgcHJvZ3Jlc3NEcmF3YWJsZS5nZXROdW1iZXJPZkxheWVycygpID4gMCkge1xuICAgICAgICAgICAgdmFyIGJhY2tncm91bmREcmF3YWJsZSA9IHByb2dyZXNzRHJhd2FibGUuZ2V0RHJhd2FibGUoMCk7XG4gICAgICAgICAgICBpZiAoYmFja2dyb3VuZERyYXdhYmxlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgcHJvZ3Jlc3NfY29tbW9uXzEuQ29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZERyYXdhYmxlLnNldENvbG9yRmlsdGVyKHZhbHVlLmFuZHJvaWQsIGFuZHJvaWQuZ3JhcGhpY3MuUG9ydGVyRHVmZi5Nb2RlLlNSQ19JTik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kRHJhd2FibGUuY2xlYXJDb2xvckZpbHRlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFByb2dyZXNzLnByb3RvdHlwZVtwcm9ncmVzc19jb21tb25fMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICByZXR1cm4gUHJvZ3Jlc3M7XG59KHByb2dyZXNzX2NvbW1vbl8xLlByb2dyZXNzQmFzZSkpO1xuZXhwb3J0cy5Qcm9ncmVzcyA9IFByb2dyZXNzO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cHJvZ3Jlc3MuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGF5b3V0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi9sYXlvdXRzL2xheW91dC1iYXNlXCIpO1xudmFyIFByb3h5Vmlld0NvbnRhaW5lciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFByb3h5Vmlld0NvbnRhaW5lciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQcm94eVZpZXdDb250YWluZXIoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFByb3h5Vmlld0NvbnRhaW5lci5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFByb3h5Vmlld0NvbnRhaW5lci5wcm90b3R5cGUsIFwiYW5kcm9pZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLCBcImlzTGF5b3V0UmVxdWVzdGVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFByb3h5Vmlld0NvbnRhaW5lci5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFByb3h5Vmlld0NvbnRhaW5lci5wcm90b3R5cGUuX2dldE5hdGl2ZVZpZXdzQ291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSAwO1xuICAgICAgICB0aGlzLmVhY2hDaGlsZFZpZXcoZnVuY3Rpb24gKGN2KSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gY3YuX2dldE5hdGl2ZVZpZXdzQ291bnQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFByb3h5Vmlld0NvbnRhaW5lci5wcm90b3R5cGUuX2VhY2hMYXlvdXRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuZWFjaENoaWxkVmlldyhmdW5jdGlvbiAoY3YpIHtcbiAgICAgICAgICAgIGlmICghY3YuaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgICAgICBjdi5fZWFjaExheW91dFZpZXcoY2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUHJveHlWaWV3Q29udGFpbmVyLnByb3RvdHlwZS5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZSA9IGZ1bmN0aW9uIChjaGlsZCwgYXRJbmRleCkge1xuICAgICAgICBpZiAobGF5b3V0X2Jhc2VfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgbGF5b3V0X2Jhc2VfMS50cmFjZVdyaXRlKFwiVmlld0NvbnRhaW5lci5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZSBmb3IgYSBjaGlsZCBcIiArIGNoaWxkICsgXCIgVmlld0NvbnRhaW5lci5wYXJlbnQ6IFwiICsgdGhpcy5wYXJlbnQsIGxheW91dF9iYXNlXzEudHJhY2VDYXRlZ29yaWVzLlZpZXdIaWVyYXJjaHkpO1xuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUuY2FsbCh0aGlzLCBjaGlsZCk7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIGxheW91dF9iYXNlXzEuVmlldykge1xuICAgICAgICAgICAgdmFyIGJhc2VJbmRleCA9IDA7XG4gICAgICAgICAgICB2YXIgaW5zaWRlSW5kZXggPSAwO1xuICAgICAgICAgICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIGxheW91dF9iYXNlXzEuTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgICAgIGJhc2VJbmRleCA9IHBhcmVudC5fY2hpbGRJbmRleFRvTmF0aXZlQ2hpbGRJbmRleChwYXJlbnQuZ2V0Q2hpbGRJbmRleCh0aGlzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXRJbmRleCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5zaWRlSW5kZXggPSB0aGlzLl9jaGlsZEluZGV4VG9OYXRpdmVDaGlsZEluZGV4KGF0SW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5zaWRlSW5kZXggPSB0aGlzLl9nZXROYXRpdmVWaWV3c0NvdW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGF5b3V0X2Jhc2VfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIGxheW91dF9iYXNlXzEudHJhY2VXcml0ZShcIlByb3h5Vmlld0NvbnRhaW5lci5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZSBhdDogXCIgKyBhdEluZGV4ICsgXCIgYmFzZTogXCIgKyBiYXNlSW5kZXggKyBcIiBhZGRpdGlvbmFsOiBcIiArIGluc2lkZUluZGV4LCBsYXlvdXRfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5WaWV3SGllcmFyY2h5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwYXJlbnQuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUoY2hpbGQsIGJhc2VJbmRleCArIGluc2lkZUluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLl9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgaWYgKGxheW91dF9iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGxheW91dF9iYXNlXzEudHJhY2VXcml0ZShcIlByb3h5Vmlld0NvbnRhaW5lci5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlIGZvciBhIGNoaWxkIFwiICsgY2hpbGQgKyBcIiBWaWV3Q29udGFpbmVyLnBhcmVudDogXCIgKyB0aGlzLnBhcmVudCwgbGF5b3V0X2Jhc2VfMS50cmFjZUNhdGVnb3JpZXMuVmlld0hpZXJhcmNoeSk7XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlLmNhbGwodGhpcywgY2hpbGQpO1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChwYXJlbnQgaW5zdGFuY2VvZiBsYXlvdXRfYmFzZV8xLlZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJlbnQuX3JlbW92ZVZpZXdGcm9tTmF0aXZlVmlzdWFsVHJlZShjaGlsZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFByb3h5Vmlld0NvbnRhaW5lci5wcm90b3R5cGUuX3JlZ2lzdGVyTGF5b3V0Q2hpbGQgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAocGFyZW50IGluc3RhbmNlb2YgbGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSB7XG4gICAgICAgICAgICBwYXJlbnQuX3JlZ2lzdGVyTGF5b3V0Q2hpbGQoY2hpbGQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLl91bnJlZ2lzdGVyTGF5b3V0Q2hpbGQgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAocGFyZW50IGluc3RhbmNlb2YgbGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSB7XG4gICAgICAgICAgICBwYXJlbnQuX3VucmVnaXN0ZXJMYXlvdXRDaGlsZChjaGlsZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFByb3h5Vmlld0NvbnRhaW5lci5wcm90b3R5cGUuX3BhcmVudENoYW5nZWQgPSBmdW5jdGlvbiAob2xkUGFyZW50KSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3BhcmVudENoYW5nZWQuY2FsbCh0aGlzLCBvbGRQYXJlbnQpO1xuICAgICAgICB2YXIgYWRkaW5nVG9QYXJlbnQgPSB0aGlzLnBhcmVudCAmJiAhb2xkUGFyZW50O1xuICAgICAgICB2YXIgbmV3TGF5b3V0ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciBvbGRMYXlvdXQgPSBvbGRQYXJlbnQ7XG4gICAgICAgIGlmIChhZGRpbmdUb1BhcmVudCAmJiBuZXdMYXlvdXQgaW5zdGFuY2VvZiBsYXlvdXRfYmFzZV8xLkxheW91dEJhc2UpIHtcbiAgICAgICAgICAgIHRoaXMuZWFjaExheW91dENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgICAgIG5ld0xheW91dC5fcmVnaXN0ZXJMYXlvdXRDaGlsZChjaGlsZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChvbGRMYXlvdXQgaW5zdGFuY2VvZiBsYXlvdXRfYmFzZV8xLkxheW91dEJhc2UpIHtcbiAgICAgICAgICAgIHRoaXMuZWFjaExheW91dENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgICAgIG9sZExheW91dC5fdW5yZWdpc3RlckxheW91dENoaWxkKGNoaWxkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQcm94eVZpZXdDb250YWluZXIgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgbGF5b3V0X2Jhc2VfMS5DU1NUeXBlKFwiUHJveHlWaWV3Q29udGFpbmVyXCIpXG4gICAgXSwgUHJveHlWaWV3Q29udGFpbmVyKTtcbiAgICByZXR1cm4gUHJveHlWaWV3Q29udGFpbmVyO1xufShsYXlvdXRfYmFzZV8xLkxheW91dEJhc2UpKTtcbmV4cG9ydHMuUHJveHlWaWV3Q29udGFpbmVyID0gUHJveHlWaWV3Q29udGFpbmVyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cHJveHktdmlldy1jb250YWluZXIuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBsYWJlbF8xID0gcmVxdWlyZShcIi4uL2xhYmVsXCIpO1xudmFyIGxheW91dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vbGF5b3V0cy9sYXlvdXQtYmFzZVwiKTtcbnZhciBzdGFja19sYXlvdXRfMSA9IHJlcXVpcmUoXCIuLi9sYXlvdXRzL3N0YWNrLWxheW91dFwiKTtcbnZhciBvYnNlcnZhYmxlX2FycmF5XzEgPSByZXF1aXJlKFwiLi4vLi4vZGF0YS9vYnNlcnZhYmxlLWFycmF5XCIpO1xudmFyIHdlYWtfZXZlbnRfbGlzdGVuZXJfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3dlYWstZXZlbnQtbGlzdGVuZXJcIik7XG52YXIgYnVpbGRlcl8xID0gcmVxdWlyZShcIi4uL2J1aWxkZXJcIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vcHJvZmlsaW5nXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2xheW91dHMvbGF5b3V0LWJhc2VcIikpO1xudmFyIGtub3duVGVtcGxhdGVzO1xuKGZ1bmN0aW9uIChrbm93blRlbXBsYXRlcykge1xuICAgIGtub3duVGVtcGxhdGVzLml0ZW1UZW1wbGF0ZSA9IFwiaXRlbVRlbXBsYXRlXCI7XG59KShrbm93blRlbXBsYXRlcyA9IGV4cG9ydHMua25vd25UZW1wbGF0ZXMgfHwgKGV4cG9ydHMua25vd25UZW1wbGF0ZXMgPSB7fSkpO1xudmFyIFJlcGVhdGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUmVwZWF0ZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUmVwZWF0ZXIoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9pc0RpcnR5ID0gZmFsc2U7XG4gICAgICAgIF90aGlzLml0ZW1zTGF5b3V0ID0gbmV3IHN0YWNrX2xheW91dF8xLlN0YWNrTGF5b3V0KCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgUmVwZWF0ZXIucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5faXNEaXJ0eSkge1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgUmVwZWF0ZXIucHJvdG90eXBlLl9yZXF1ZXN0UmVmcmVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5faXNEaXJ0eSA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUmVwZWF0ZXIucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLml0ZW1zTGF5b3V0KSB7XG4gICAgICAgICAgICB0aGlzLml0ZW1zTGF5b3V0LnJlbW92ZUNoaWxkcmVuKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLml0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxlbmd0aCA9IHRoaXMuaXRlbXMubGVuZ3RoO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdmlld1RvQWRkID0gdGhpcy5pdGVtVGVtcGxhdGUgPyBidWlsZGVyXzEucGFyc2UodGhpcy5pdGVtVGVtcGxhdGUsIHRoaXMpIDogdGhpcy5fZ2V0RGVmYXVsdEl0ZW1Db250ZW50KGkpO1xuICAgICAgICAgICAgdmFyIGRhdGFJdGVtID0gdGhpcy5fZ2V0RGF0YUl0ZW0oaSk7XG4gICAgICAgICAgICB2aWV3VG9BZGQuYmluZGluZ0NvbnRleHQgPSBkYXRhSXRlbTtcbiAgICAgICAgICAgIHRoaXMuaXRlbXNMYXlvdXQuYWRkQ2hpbGQodmlld1RvQWRkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pc0RpcnR5ID0gZmFsc2U7XG4gICAgfTtcbiAgICBSZXBlYXRlci5wcm90b3R5cGUuX29uSXRlbXNDaGFuZ2VkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdGhpcy5fcmVxdWVzdFJlZnJlc2goKTtcbiAgICB9O1xuICAgIFJlcGVhdGVyLnByb3RvdHlwZS5fZ2V0RGVmYXVsdEl0ZW1Db250ZW50ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHZhciBsYmwgPSBuZXcgbGFiZWxfMS5MYWJlbCgpO1xuICAgICAgICBsYmwuYmluZCh7XG4gICAgICAgICAgICB0YXJnZXRQcm9wZXJ0eTogXCJ0ZXh0XCIsXG4gICAgICAgICAgICBzb3VyY2VQcm9wZXJ0eTogXCIkdmFsdWVcIlxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGxibDtcbiAgICB9O1xuICAgIFJlcGVhdGVyLnByb3RvdHlwZS5fZ2V0RGF0YUl0ZW0gPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgcmV0dXJuIGl0ZW1zLmdldEl0ZW0gPyBpdGVtcy5nZXRJdGVtKGluZGV4KSA6IHRoaXMuaXRlbXNbaW5kZXhdO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlcGVhdGVyLnByb3RvdHlwZSwgXCJfY2hpbGRyZW5Db3VudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXRlbXNMYXlvdXQgPyAxIDogMDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgUmVwZWF0ZXIucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHRoaXMuaXRlbXNMYXlvdXQpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRoaXMuaXRlbXNMYXlvdXQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBSZXBlYXRlci5wcm90b3R5cGUub25MYXlvdXQgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgICAgIHZhciBpbnNldHMgPSB0aGlzLmdldFNhZmVBcmVhSW5zZXRzKCk7XG4gICAgICAgIHZhciBwYWRkaW5nTGVmdCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIGluc2V0cy5sZWZ0O1xuICAgICAgICB2YXIgcGFkZGluZ1RvcCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGggKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdUb3AgKyBpbnNldHMudG9wO1xuICAgICAgICB2YXIgcGFkZGluZ1JpZ2h0ID0gdGhpcy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQgKyBpbnNldHMucmlnaHQ7XG4gICAgICAgIHZhciBwYWRkaW5nQm90dG9tID0gdGhpcy5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSArIGluc2V0cy5ib3R0b207XG4gICAgICAgIHZhciBjaGlsZExlZnQgPSBwYWRkaW5nTGVmdDtcbiAgICAgICAgdmFyIGNoaWxkVG9wID0gcGFkZGluZ1RvcDtcbiAgICAgICAgdmFyIGNoaWxkUmlnaHQgPSByaWdodCAtIGxlZnQgLSBwYWRkaW5nUmlnaHQ7XG4gICAgICAgIHZhciBjaGlsZEJvdHRvbSA9IGJvdHRvbSAtIHRvcCAtIHBhZGRpbmdCb3R0b207XG4gICAgICAgIGxheW91dF9iYXNlXzEuVmlldy5sYXlvdXRDaGlsZCh0aGlzLCB0aGlzLml0ZW1zTGF5b3V0LCBjaGlsZExlZnQsIGNoaWxkVG9wLCBjaGlsZFJpZ2h0LCBjaGlsZEJvdHRvbSk7XG4gICAgfTtcbiAgICBSZXBlYXRlci5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBsYXlvdXRfYmFzZV8xLlZpZXcubWVhc3VyZUNoaWxkKHRoaXMsIHRoaXMuaXRlbXNMYXlvdXQsIHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoID0gbGF5b3V0X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgd2lkdGhNb2RlID0gbGF5b3V0X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gbGF5b3V0X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodE1vZGUgPSBsYXlvdXRfYmFzZV8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgd2lkdGhBbmRTdGF0ZSA9IGxheW91dF9iYXNlXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKHJlc3VsdC5tZWFzdXJlZFdpZHRoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgdmFyIGhlaWdodEFuZFN0YXRlID0gbGF5b3V0X2Jhc2VfMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUocmVzdWx0Lm1lYXN1cmVkSGVpZ2h0LCBoZWlnaHQsIGhlaWdodE1vZGUsIDApO1xuICAgICAgICB0aGlzLnNldE1lYXN1cmVkRGltZW5zaW9uKHdpZHRoQW5kU3RhdGUsIGhlaWdodEFuZFN0YXRlKTtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgUmVwZWF0ZXIucHJvdG90eXBlLCBcIm9uTG9hZGVkXCIsIG51bGwpO1xuICAgIFJlcGVhdGVyID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGxheW91dF9iYXNlXzEuQ1NTVHlwZShcIlJlcGVhdGVyXCIpXG4gICAgXSwgUmVwZWF0ZXIpO1xuICAgIHJldHVybiBSZXBlYXRlcjtcbn0obGF5b3V0X2Jhc2VfMS5DdXN0b21MYXlvdXRWaWV3KSk7XG5leHBvcnRzLlJlcGVhdGVyID0gUmVwZWF0ZXI7XG5SZXBlYXRlci5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuaXRlbVRlbXBsYXRlUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpdGVtVGVtcGxhdGVcIiwgYWZmZWN0c0xheW91dDogdHJ1ZSwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgIHRhcmdldC5fcmVxdWVzdFJlZnJlc2goKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuaXRlbVRlbXBsYXRlUHJvcGVydHkucmVnaXN0ZXIoUmVwZWF0ZXIpO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbXNcIiwgYWZmZWN0c0xheW91dDogdHJ1ZSwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKG9sZFZhbHVlIGluc3RhbmNlb2Ygb2JzZXJ2YWJsZV9hcnJheV8xLk9ic2VydmFibGVBcnJheSkge1xuICAgICAgICAgICAgd2Vha19ldmVudF9saXN0ZW5lcl8xLnJlbW92ZVdlYWtFdmVudExpc3RlbmVyKG9sZFZhbHVlLCBvYnNlcnZhYmxlX2FycmF5XzEuT2JzZXJ2YWJsZUFycmF5LmNoYW5nZUV2ZW50LCB0YXJnZXQuX29uSXRlbXNDaGFuZ2VkLCB0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdWYWx1ZSBpbnN0YW5jZW9mIG9ic2VydmFibGVfYXJyYXlfMS5PYnNlcnZhYmxlQXJyYXkpIHtcbiAgICAgICAgICAgIHdlYWtfZXZlbnRfbGlzdGVuZXJfMS5hZGRXZWFrRXZlbnRMaXN0ZW5lcihuZXdWYWx1ZSwgb2JzZXJ2YWJsZV9hcnJheV8xLk9ic2VydmFibGVBcnJheS5jaGFuZ2VFdmVudCwgdGFyZ2V0Ll9vbkl0ZW1zQ2hhbmdlZCwgdGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICB0YXJnZXQuX3JlcXVlc3RSZWZyZXNoKCk7XG4gICAgfVxufSk7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkucmVnaXN0ZXIoUmVwZWF0ZXIpO1xuZXhwb3J0cy5pdGVtc0xheW91dFByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbXNMYXlvdXRcIiwgYWZmZWN0c0xheW91dDogdHJ1ZSwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKG9sZFZhbHVlKSB7XG4gICAgICAgICAgICB0YXJnZXQuX3JlbW92ZVZpZXcob2xkVmFsdWUpO1xuICAgICAgICAgICAgb2xkVmFsdWUucmVtb3ZlQ2hpbGRyZW4oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHRhcmdldC5fYWRkVmlldyhuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGFyZ2V0Ll9yZXF1ZXN0UmVmcmVzaCgpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pdGVtc0xheW91dFByb3BlcnR5LnJlZ2lzdGVyKFJlcGVhdGVyKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJlcGVhdGVyLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29udGVudF92aWV3XzEgPSByZXF1aXJlKFwiLi4vY29udGVudC12aWV3XCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb250ZW50LXZpZXdcIikpO1xudmFyIFNjcm9sbFZpZXdCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2Nyb2xsVmlld0Jhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2Nyb2xsVmlld0Jhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fc2Nyb2xsQ2hhbmdlQ291bnQgPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFNjcm9sbFZpZXdCYXNlXzEgPSBTY3JvbGxWaWV3QmFzZTtcbiAgICBTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhcmcsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIGFyZywgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICBpZiAoYXJnID09PSBTY3JvbGxWaWV3QmFzZV8xLnNjcm9sbEV2ZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9zY3JvbGxDaGFuZ2VDb3VudCsrO1xuICAgICAgICAgICAgdGhpcy5hdHRhY2goKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoYXJnLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCBhcmcsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgaWYgKGFyZyA9PT0gU2Nyb2xsVmlld0Jhc2VfMS5zY3JvbGxFdmVudCkge1xuICAgICAgICAgICAgdGhpcy5fc2Nyb2xsQ2hhbmdlQ291bnQtLTtcbiAgICAgICAgICAgIHRoaXMuZGV0dGFjaCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5hdHRhY2goKTtcbiAgICB9O1xuICAgIFNjcm9sbFZpZXdCYXNlLnByb3RvdHlwZS5vblVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uVW5sb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5kZXR0YWNoKCk7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUuYXR0YWNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fc2Nyb2xsQ2hhbmdlQ291bnQgPiAwICYmIHRoaXMuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHRoaXMuYXR0YWNoTmF0aXZlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNjcm9sbFZpZXdCYXNlLnByb3RvdHlwZS5kZXR0YWNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fc2Nyb2xsQ2hhbmdlQ291bnQgPT09IDAgJiYgdGhpcy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgdGhpcy5kZXR0YWNoTmF0aXZlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNjcm9sbFZpZXdCYXNlLnByb3RvdHlwZS5hdHRhY2hOYXRpdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUuZGV0dGFjaE5hdGl2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUsIFwiaG9yaXpvbnRhbE9mZnNldFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUsIFwidmVydGljYWxPZmZzZXRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLCBcInNjcm9sbGFibGVXaWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUsIFwic2Nyb2xsYWJsZUhlaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHZhciBTY3JvbGxWaWV3QmFzZV8xO1xuICAgIFNjcm9sbFZpZXdCYXNlLnNjcm9sbEV2ZW50ID0gXCJzY3JvbGxcIjtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFNjcm9sbFZpZXdCYXNlLnByb3RvdHlwZSwgXCJvbkxvYWRlZFwiLCBudWxsKTtcbiAgICBTY3JvbGxWaWV3QmFzZSA9IFNjcm9sbFZpZXdCYXNlXzEgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgY29udGVudF92aWV3XzEuQ1NTVHlwZShcIlNjcm9sbFZpZXdcIilcbiAgICBdLCBTY3JvbGxWaWV3QmFzZSk7XG4gICAgcmV0dXJuIFNjcm9sbFZpZXdCYXNlO1xufShjb250ZW50X3ZpZXdfMS5Db250ZW50VmlldykpO1xuZXhwb3J0cy5TY3JvbGxWaWV3QmFzZSA9IFNjcm9sbFZpZXdCYXNlO1xudmFyIGNvbnZlcnRlciA9IGNvbnRlbnRfdmlld18xLm1ha2VQYXJzZXIoY29udGVudF92aWV3XzEubWFrZVZhbGlkYXRvcihcImhvcml6b250YWxcIiwgXCJ2ZXJ0aWNhbFwiKSk7XG5leHBvcnRzLm9yaWVudGF0aW9uUHJvcGVydHkgPSBuZXcgY29udGVudF92aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwib3JpZW50YXRpb25cIiwgZGVmYXVsdFZhbHVlOiBcInZlcnRpY2FsXCIsIGFmZmVjdHNMYXlvdXQ6IHRydWUsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0Ll9vbk9yaWVudGF0aW9uQ2hhbmdlZCgpO1xuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGNvbnZlcnRlclxufSk7XG5leHBvcnRzLm9yaWVudGF0aW9uUHJvcGVydHkucmVnaXN0ZXIoU2Nyb2xsVmlld0Jhc2UpO1xuZXhwb3J0cy5zY3JvbGxCYXJJbmRpY2F0b3JWaXNpYmxlUHJvcGVydHkgPSBuZXcgY29udGVudF92aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwic2Nyb2xsQmFySW5kaWNhdG9yVmlzaWJsZVwiLCBkZWZhdWx0VmFsdWU6IHRydWUsXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGNvbnRlbnRfdmlld18xLmJvb2xlYW5Db252ZXJ0ZXJcbn0pO1xuZXhwb3J0cy5zY3JvbGxCYXJJbmRpY2F0b3JWaXNpYmxlUHJvcGVydHkucmVnaXN0ZXIoU2Nyb2xsVmlld0Jhc2UpO1xuZXhwb3J0cy5pc1Njcm9sbEVuYWJsZWRQcm9wZXJ0eSA9IG5ldyBjb250ZW50X3ZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpc1Njcm9sbEVuYWJsZWRcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLFxuICAgIHZhbHVlQ29udmVydGVyOiBjb250ZW50X3ZpZXdfMS5ib29sZWFuQ29udmVydGVyXG59KTtcbmV4cG9ydHMuaXNTY3JvbGxFbmFibGVkUHJvcGVydHkucmVnaXN0ZXIoU2Nyb2xsVmlld0Jhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2Nyb2xsLXZpZXctY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgc2Nyb2xsX3ZpZXdfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9zY3JvbGwtdmlldy1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9zY3JvbGwtdmlldy1jb21tb25cIikpO1xudmFyIFNjcm9sbFZpZXcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTY3JvbGxWaWV3LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNjcm9sbFZpZXcoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fYW5kcm9pZFZpZXdJZCA9IC0xO1xuICAgICAgICBfdGhpcy5fbGFzdFNjcm9sbFggPSAtMTtcbiAgICAgICAgX3RoaXMuX2xhc3RTY3JvbGxZID0gLTE7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNjcm9sbFZpZXcucHJvdG90eXBlLCBcImhvcml6b250YWxPZmZzZXRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgaWYgKCFuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmF0aXZlVmlldy5nZXRTY3JvbGxYKCkgLyBzY3JvbGxfdmlld19jb21tb25fMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNjcm9sbFZpZXcucHJvdG90eXBlLCBcInZlcnRpY2FsT2Zmc2V0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgICAgIGlmICghbmF0aXZlVmlldykge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXcuZ2V0U2Nyb2xsWSgpIC8gc2Nyb2xsX3ZpZXdfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTY3JvbGxWaWV3LnByb3RvdHlwZSwgXCJzY3JvbGxhYmxlV2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgaWYgKCFuYXRpdmVWaWV3IHx8IHRoaXMub3JpZW50YXRpb24gIT09IFwiaG9yaXpvbnRhbFwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmF0aXZlVmlldy5nZXRTY3JvbGxhYmxlTGVuZ3RoKCkgLyBzY3JvbGxfdmlld19jb21tb25fMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNjcm9sbFZpZXcucHJvdG90eXBlLCBcInNjcm9sbGFibGVIZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgaWYgKCFuYXRpdmVWaWV3IHx8IHRoaXMub3JpZW50YXRpb24gIT09IFwidmVydGljYWxcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXcuZ2V0U2Nyb2xsYWJsZUxlbmd0aCgpIC8gc2Nyb2xsX3ZpZXdfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFNjcm9sbFZpZXcucHJvdG90eXBlW3Njcm9sbF92aWV3X2NvbW1vbl8xLmlzVXNlckludGVyYWN0aW9uRW5hYmxlZFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldENsaWNrYWJsZSh2YWx1ZSk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRGb2N1c2FibGUodmFsdWUpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0U2Nyb2xsRW5hYmxlZCh2YWx1ZSk7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZVtzY3JvbGxfdmlld19jb21tb25fMS5pc1Njcm9sbEVuYWJsZWRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRTY3JvbGxFbmFibGVkKCk7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZVtzY3JvbGxfdmlld19jb21tb25fMS5pc1Njcm9sbEVuYWJsZWRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRTY3JvbGxFbmFibGVkKHZhbHVlKTtcbiAgICB9O1xuICAgIFNjcm9sbFZpZXcucHJvdG90eXBlW3Njcm9sbF92aWV3X2NvbW1vbl8xLnNjcm9sbEJhckluZGljYXRvclZpc2libGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZVtzY3JvbGxfdmlld19jb21tb25fMS5zY3JvbGxCYXJJbmRpY2F0b3JWaXNpYmxlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5vcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRIb3Jpem9udGFsU2Nyb2xsQmFyRW5hYmxlZCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VmVydGljYWxTY3JvbGxCYXJFbmFibGVkKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGUuc2Nyb2xsVG9WZXJ0aWNhbE9mZnNldCA9IGZ1bmN0aW9uICh2YWx1ZSwgYW5pbWF0ZWQpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3ICYmIHRoaXMub3JpZW50YXRpb24gPT09IFwidmVydGljYWxcIiAmJiB0aGlzLmlzU2Nyb2xsRW5hYmxlZCkge1xuICAgICAgICAgICAgdmFsdWUgKj0gc2Nyb2xsX3ZpZXdfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgICAgICBpZiAoYW5pbWF0ZWQpIHtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnNtb290aFNjcm9sbFRvKDAsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2Nyb2xsVG8oMCwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZS5zY3JvbGxUb0hvcml6b250YWxPZmZzZXQgPSBmdW5jdGlvbiAodmFsdWUsIGFuaW1hdGVkKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldyAmJiB0aGlzLm9yaWVudGF0aW9uID09PSBcImhvcml6b250YWxcIiAmJiB0aGlzLmlzU2Nyb2xsRW5hYmxlZCkge1xuICAgICAgICAgICAgdmFsdWUgKj0gc2Nyb2xsX3ZpZXdfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgICAgICBpZiAoYW5pbWF0ZWQpIHtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnNtb290aFNjcm9sbFRvKHZhbHVlLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2Nyb2xsVG8odmFsdWUsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCIgPyBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkhvcml6b250YWxTY3JvbGxWaWV3KHRoaXMuX2NvbnRleHQpIDogbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WZXJ0aWNhbFNjcm9sbFZpZXcodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5fYW5kcm9pZFZpZXdJZCA8IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2FuZHJvaWRWaWV3SWQgPSBhbmRyb2lkLnZpZXcuVmlldy5nZW5lcmF0ZVZpZXdJZCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRJZCh0aGlzLl9hbmRyb2lkVmlld0lkKTtcbiAgICB9O1xuICAgIFNjcm9sbFZpZXcucHJvdG90eXBlLl9vbk9yaWVudGF0aW9uQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdmFyIHBhcmVudF8xID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICBpZiAocGFyZW50XzEpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRfMS5fcmVtb3ZlVmlldyh0aGlzKTtcbiAgICAgICAgICAgICAgICBwYXJlbnRfMS5fYWRkVmlldyh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGUuYXR0YWNoTmF0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGhhdCA9IG5ldyBXZWFrUmVmKHRoaXMpO1xuICAgICAgICB0aGlzLmhhbmRsZXIgPSBuZXcgYW5kcm9pZC52aWV3LlZpZXdUcmVlT2JzZXJ2ZXIuT25TY3JvbGxDaGFuZ2VkTGlzdGVuZXIoe1xuICAgICAgICAgICAgb25TY3JvbGxDaGFuZ2VkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG93bmVyID0gdGhhdC5nZXQoKTtcbiAgICAgICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXIuX29uU2Nyb2xsQ2hhbmdlZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRWaWV3VHJlZU9ic2VydmVyKCkuYWRkT25TY3JvbGxDaGFuZ2VkTGlzdGVuZXIodGhpcy5oYW5kbGVyKTtcbiAgICB9O1xuICAgIFNjcm9sbFZpZXcucHJvdG90eXBlLl9vblNjcm9sbENoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldykge1xuICAgICAgICAgICAgdmFyIG5ld1Njcm9sbFggPSBuYXRpdmVWaWV3LmdldFNjcm9sbFgoKTtcbiAgICAgICAgICAgIHZhciBuZXdTY3JvbGxZID0gbmF0aXZlVmlldy5nZXRTY3JvbGxZKCk7XG4gICAgICAgICAgICBpZiAobmV3U2Nyb2xsWCAhPT0gdGhpcy5fbGFzdFNjcm9sbFggfHwgbmV3U2Nyb2xsWSAhPT0gdGhpcy5fbGFzdFNjcm9sbFkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeSh7XG4gICAgICAgICAgICAgICAgICAgIG9iamVjdDogdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgZXZlbnROYW1lOiBTY3JvbGxWaWV3LnNjcm9sbEV2ZW50LFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxYOiBuZXdTY3JvbGxYIC8gc2Nyb2xsX3ZpZXdfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCksXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFk6IG5ld1Njcm9sbFkgLyBzY3JvbGxfdmlld19jb21tb25fMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RTY3JvbGxYID0gbmV3U2Nyb2xsWDtcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0U2Nyb2xsWSA9IG5ld1Njcm9sbFk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNjcm9sbFZpZXcucHJvdG90eXBlLmRldHRhY2hOYXRpdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRWaWV3VHJlZU9ic2VydmVyKCkucmVtb3ZlT25TY3JvbGxDaGFuZ2VkTGlzdGVuZXIodGhpcy5oYW5kbGVyKTtcbiAgICAgICAgdGhpcy5oYW5kbGVyID0gbnVsbDtcbiAgICB9O1xuICAgIHJldHVybiBTY3JvbGxWaWV3O1xufShzY3JvbGxfdmlld19jb21tb25fMS5TY3JvbGxWaWV3QmFzZSkpO1xuZXhwb3J0cy5TY3JvbGxWaWV3ID0gU2Nyb2xsVmlldztcblNjcm9sbFZpZXcucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJuZXZlclwiO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2Nyb2xsLXZpZXcuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBTZWFyY2hCYXJCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2VhcmNoQmFyQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTZWFyY2hCYXJCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFNlYXJjaEJhckJhc2Uuc3VibWl0RXZlbnQgPSBcInN1Ym1pdFwiO1xuICAgIFNlYXJjaEJhckJhc2UuY2xlYXJFdmVudCA9IFwiY2xlYXJcIjtcbiAgICBTZWFyY2hCYXJCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiU2VhcmNoQmFyXCIpXG4gICAgXSwgU2VhcmNoQmFyQmFzZSk7XG4gICAgcmV0dXJuIFNlYXJjaEJhckJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlNlYXJjaEJhckJhc2UgPSBTZWFyY2hCYXJCYXNlO1xuU2VhcmNoQmFyQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMudGV4dFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwidGV4dFwiLCBkZWZhdWx0VmFsdWU6IFwiXCIsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUyB9KTtcbmV4cG9ydHMudGV4dFByb3BlcnR5LnJlZ2lzdGVyKFNlYXJjaEJhckJhc2UpO1xuZXhwb3J0cy5oaW50UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJoaW50XCIsIGRlZmF1bHRWYWx1ZTogXCJcIiB9KTtcbmV4cG9ydHMuaGludFByb3BlcnR5LnJlZ2lzdGVyKFNlYXJjaEJhckJhc2UpO1xuZXhwb3J0cy50ZXh0RmllbGRIaW50Q29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcInRleHRGaWVsZEhpbnRDb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyB2aWV3XzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLnRleHRGaWVsZEhpbnRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKFNlYXJjaEJhckJhc2UpO1xuZXhwb3J0cy50ZXh0RmllbGRCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcInRleHRGaWVsZEJhY2tncm91bmRDb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyB2aWV3XzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLnRleHRGaWVsZEJhY2tncm91bmRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKFNlYXJjaEJhckJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VhcmNoLWJhci1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmb250XzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9mb250XCIpO1xudmFyIHNlYXJjaF9iYXJfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9zZWFyY2gtYmFyLWNvbW1vblwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3V0aWxzXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vc2VhcmNoLWJhci1jb21tb25cIikpO1xudmFyIFNFQVJDSFRFWFQgPSBTeW1ib2woXCJzZWFyY2hUZXh0XCIpO1xudmFyIFFVRVJZID0gU3ltYm9sKFwicXVlcnlcIik7XG52YXIgUXVlcnlUZXh0TGlzdGVuZXI7XG52YXIgQ2xvc2VMaXN0ZW5lcjtcbmZ1bmN0aW9uIGluaXRpYWxpemVOYXRpdmVDbGFzc2VzKCkge1xuICAgIGlmIChRdWVyeVRleHRMaXN0ZW5lcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBDb21wYXRRdWVyeVRleHRMaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoQ29tcGF0UXVlcnlUZXh0TGlzdGVuZXJJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBDb21wYXRRdWVyeVRleHRMaXN0ZW5lckltcGwob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgQ29tcGF0UXVlcnlUZXh0TGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblF1ZXJ5VGV4dENoYW5nZSA9IGZ1bmN0aW9uIChuZXdUZXh0KSB7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgc2VhcmNoX2Jhcl9jb21tb25fMS50ZXh0UHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIG5ld1RleHQpO1xuICAgICAgICAgICAgaWYgKG5ld1RleHQgPT09IFwiXCIgJiYgdGhpc1tTRUFSQ0hURVhUXSAhPT0gbmV3VGV4dCkge1xuICAgICAgICAgICAgICAgIG93bmVyLl9lbWl0KHNlYXJjaF9iYXJfY29tbW9uXzEuU2VhcmNoQmFyQmFzZS5jbGVhckV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXNbU0VBUkNIVEVYVF0gPSBuZXdUZXh0O1xuICAgICAgICAgICAgdGhpc1tRVUVSWV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tcGF0UXVlcnlUZXh0TGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblF1ZXJ5VGV4dFN1Ym1pdCA9IGZ1bmN0aW9uIChxdWVyeSkge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIGlmIChxdWVyeSAhPT0gXCJcIiAmJiB0aGlzW1FVRVJZXSAhPT0gcXVlcnkpIHtcbiAgICAgICAgICAgICAgICBvd25lci5fZW1pdChzZWFyY2hfYmFyX2NvbW1vbl8xLlNlYXJjaEJhckJhc2Uuc3VibWl0RXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpc1tRVUVSWV0gPSBxdWVyeTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBDb21wYXRRdWVyeVRleHRMaXN0ZW5lckltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWR4LmFwcGNvbXBhdC53aWRnZXQuU2VhcmNoVmlldy5PblF1ZXJ5VGV4dExpc3RlbmVyXSlcbiAgICAgICAgXSwgQ29tcGF0UXVlcnlUZXh0TGlzdGVuZXJJbXBsKTtcbiAgICAgICAgcmV0dXJuIENvbXBhdFF1ZXJ5VGV4dExpc3RlbmVySW1wbDtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICB2YXIgQ29tcGF0Q2xvc2VMaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoQ29tcGF0Q2xvc2VMaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIENvbXBhdENsb3NlTGlzdGVuZXJJbXBsKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIENvbXBhdENsb3NlTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vbkNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5vd25lci5fZW1pdChzZWFyY2hfYmFyX2NvbW1vbl8xLlNlYXJjaEJhckJhc2UuY2xlYXJFdmVudCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tcGF0Q2xvc2VMaXN0ZW5lckltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWR4LmFwcGNvbXBhdC53aWRnZXQuU2VhcmNoVmlldy5PbkNsb3NlTGlzdGVuZXJdKVxuICAgICAgICBdLCBDb21wYXRDbG9zZUxpc3RlbmVySW1wbCk7XG4gICAgICAgIHJldHVybiBDb21wYXRDbG9zZUxpc3RlbmVySW1wbDtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICBRdWVyeVRleHRMaXN0ZW5lciA9IENvbXBhdFF1ZXJ5VGV4dExpc3RlbmVySW1wbDtcbiAgICBDbG9zZUxpc3RlbmVyID0gQ29tcGF0Q2xvc2VMaXN0ZW5lckltcGw7XG59XG5mdW5jdGlvbiBlbmFibGVTZWFyY2hWaWV3KG5hdGl2ZVZpZXcsIHZhbHVlKSB7XG4gICAgbmF0aXZlVmlldy5zZXRFbmFibGVkKHZhbHVlKTtcbiAgICBpZiAoIShuYXRpdmVWaWV3IGluc3RhbmNlb2YgYW5kcm9pZC52aWV3LlZpZXdHcm91cCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5hdGl2ZVZpZXcuZ2V0Q2hpbGRDb3VudCgpOyBpKyspIHtcbiAgICAgICAgdmFyIGNoaWxkID0gbmF0aXZlVmlldy5nZXRDaGlsZEF0KGkpO1xuICAgICAgICBlbmFibGVTZWFyY2hWaWV3KGNoaWxkLCB2YWx1ZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gZW5hYmxlVXNlckludGVyYWN0aW9uU2VhcmNoVmlldyhuYXRpdmVWaWV3LCB2YWx1ZSkge1xuICAgIG5hdGl2ZVZpZXcuc2V0Q2xpY2thYmxlKHZhbHVlKTtcbiAgICBuYXRpdmVWaWV3LnNldEZvY3VzYWJsZSh2YWx1ZSk7XG4gICAgaWYgKCEobmF0aXZlVmlldyBpbnN0YW5jZW9mIGFuZHJvaWQudmlldy5WaWV3R3JvdXApKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuYXRpdmVWaWV3LmdldENoaWxkQ291bnQoKTsgaSsrKSB7XG4gICAgICAgIHZhciBjaGlsZCA9IG5hdGl2ZVZpZXcuZ2V0Q2hpbGRBdChpKTtcbiAgICAgICAgZW5hYmxlVXNlckludGVyYWN0aW9uU2VhcmNoVmlldyhjaGlsZCwgdmFsdWUpO1xuICAgIH1cbn1cbnZhciBTZWFyY2hCYXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTZWFyY2hCYXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2VhcmNoQmFyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFNlYXJjaEJhci5wcm90b3R5cGUuZGlzbWlzc1NvZnRJbnB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdXRpbHNfMS5hZC5kaXNtaXNzU29mdElucHV0KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCk7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gX3N1cGVyLnByb3RvdHlwZS5mb2N1cy5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICB1dGlsc18xLmFkLnNob3dTb2Z0SW5wdXQodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IG5ldyBhbmRyb2lkeC5hcHBjb21wYXQud2lkZ2V0LlNlYXJjaFZpZXcodGhpcy5fY29udGV4dCk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0SWNvbmlmaWVkKGZhbHNlKTtcbiAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXc7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpbml0aWFsaXplTmF0aXZlQ2xhc3NlcygpO1xuICAgICAgICB2YXIgcXVlcnlUZXh0TGlzdGVuZXIgPSBuZXcgUXVlcnlUZXh0TGlzdGVuZXIodGhpcyk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0T25RdWVyeVRleHRMaXN0ZW5lcihxdWVyeVRleHRMaXN0ZW5lcik7XG4gICAgICAgIG5hdGl2ZVZpZXcucXVlcnlUZXh0TGlzdGVuZXIgPSBxdWVyeVRleHRMaXN0ZW5lcjtcbiAgICAgICAgdmFyIGNsb3NlTGlzdGVuZXIgPSBuZXcgQ2xvc2VMaXN0ZW5lcih0aGlzKTtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRPbkNsb3NlTGlzdGVuZXIoY2xvc2VMaXN0ZW5lcik7XG4gICAgICAgIG5hdGl2ZVZpZXcuY2xvc2VMaXN0ZW5lciA9IGNsb3NlTGlzdGVuZXI7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgbmF0aXZlVmlldy5jbG9zZUxpc3RlbmVyLm93bmVyID0gbnVsbDtcbiAgICAgICAgbmF0aXZlVmlldy5xdWVyeVRleHRMaXN0ZW5lci5vd25lciA9IG51bGw7XG4gICAgICAgIHRoaXMuX3NlYXJjaFBsYXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fc2VhcmNoVGV4dFZpZXcgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEuaXNFbmFibGVkUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBlbmFibGVTZWFyY2hWaWV3KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgdmFsdWUpO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLmlzVXNlckludGVyYWN0aW9uRW5hYmxlZFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgZW5hYmxlVXNlckludGVyYWN0aW9uU2VhcmNoVmlldyh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIHZhbHVlKTtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXREcmF3aW5nQ2FjaGVCYWNrZ3JvdW5kQ29sb3IoKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb2xvcjtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgY29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbG9yID0gdmFsdWUuYW5kcm9pZDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0QmFja2dyb3VuZENvbG9yKGNvbG9yKTtcbiAgICAgICAgdmFyIHNlYXJjaFBsYXRlID0gdGhpcy5fZ2V0U2VhcmNoUGxhdGUoKTtcbiAgICAgICAgc2VhcmNoUGxhdGUuc2V0QmFja2dyb3VuZENvbG9yKGNvbG9yKTtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5jb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGV4dFZpZXcgPSB0aGlzLl9nZXRUZXh0VmlldygpO1xuICAgICAgICByZXR1cm4gdGV4dFZpZXcuZ2V0Q3VycmVudFRleHRDb2xvcigpO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY29sb3IgPSAodHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiKSA/IHZhbHVlIDogdmFsdWUuYW5kcm9pZDtcbiAgICAgICAgdmFyIHRleHRWaWV3ID0gdGhpcy5fZ2V0VGV4dFZpZXcoKTtcbiAgICAgICAgdGV4dFZpZXcuc2V0VGV4dENvbG9yKGNvbG9yKTtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5mb250U2l6ZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4geyBuYXRpdmVTaXplOiB0aGlzLl9nZXRUZXh0VmlldygpLmdldFRleHRTaXplKCkgfTtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5mb250U2l6ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgdGhpcy5fZ2V0VGV4dFZpZXcoKS5zZXRUZXh0U2l6ZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9nZXRUZXh0VmlldygpLnNldFRleHRTaXplKGFuZHJvaWQudXRpbC5UeXBlZFZhbHVlLkNPTVBMRVhfVU5JVF9QWCwgdmFsdWUubmF0aXZlU2l6ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldFRleHRWaWV3KCkuZ2V0VHlwZWZhY2UoKTtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2dldFRleHRWaWV3KCkuc2V0VHlwZWZhY2UodmFsdWUgaW5zdGFuY2VvZiBmb250XzEuRm9udCA/IHZhbHVlLmdldEFuZHJvaWRUeXBlZmFjZSgpIDogdmFsdWUpO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEudGV4dFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS50ZXh0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgdGV4dCA9ICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSA/IFwiXCIgOiB2YWx1ZS50b1N0cmluZygpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0UXVlcnkodGV4dCwgZmFsc2UpO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLmhpbnRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEuaGludFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRRdWVyeUhpbnQobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0UXVlcnlIaW50KHZhbHVlLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEudGV4dEZpZWxkQmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0ZXh0VmlldyA9IHRoaXMuX2dldFRleHRWaWV3KCk7XG4gICAgICAgIHJldHVybiB0ZXh0Vmlldy5nZXRCYWNrZ3JvdW5kKCk7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEudGV4dEZpZWxkQmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgdGV4dFZpZXcgPSB0aGlzLl9nZXRUZXh0VmlldygpO1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBzZWFyY2hfYmFyX2NvbW1vbl8xLkNvbG9yKSB7XG4gICAgICAgICAgICB0ZXh0Vmlldy5zZXRCYWNrZ3JvdW5kQ29sb3IodmFsdWUuYW5kcm9pZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0ZXh0Vmlldy5zZXRCYWNrZ3JvdW5kKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLnRleHRGaWVsZEhpbnRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGV4dFZpZXcgPSB0aGlzLl9nZXRUZXh0VmlldygpO1xuICAgICAgICByZXR1cm4gdGV4dFZpZXcuZ2V0Q3VycmVudFRleHRDb2xvcigpO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLnRleHRGaWVsZEhpbnRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHRleHRWaWV3ID0gdGhpcy5fZ2V0VGV4dFZpZXcoKTtcbiAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBzZWFyY2hfYmFyX2NvbW1vbl8xLkNvbG9yID8gdmFsdWUuYW5kcm9pZCA6IHZhbHVlO1xuICAgICAgICB0ZXh0Vmlldy5zZXRIaW50VGV4dENvbG9yKGNvbG9yKTtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGUuX2dldFRleHRWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX3NlYXJjaFRleHRWaWV3KSB7XG4gICAgICAgICAgICB2YXIgcGtnTmFtZSA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRDb250ZXh0KCkuZ2V0UGFja2FnZU5hbWUoKTtcbiAgICAgICAgICAgIHZhciBpZCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRDb250ZXh0KCkuZ2V0UmVzb3VyY2VzKCkuZ2V0SWRlbnRpZmllcihcInNlYXJjaF9zcmNfdGV4dFwiLCBcImlkXCIsIHBrZ05hbWUpO1xuICAgICAgICAgICAgdGhpcy5fc2VhcmNoVGV4dFZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZmluZFZpZXdCeUlkKGlkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fc2VhcmNoVGV4dFZpZXc7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlLl9nZXRTZWFyY2hQbGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9zZWFyY2hQbGF0ZSkge1xuICAgICAgICAgICAgdmFyIHBrZ05hbWUgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0Q29udGV4dCgpLmdldFBhY2thZ2VOYW1lKCk7XG4gICAgICAgICAgICB2YXIgaWQgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0Q29udGV4dCgpLmdldFJlc291cmNlcygpLmdldElkZW50aWZpZXIoXCJzZWFyY2hfcGxhdGVcIiwgXCJpZFwiLCBwa2dOYW1lKTtcbiAgICAgICAgICAgIHRoaXMuX3NlYXJjaFBsYXRlID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmZpbmRWaWV3QnlJZChpZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3NlYXJjaFBsYXRlO1xuICAgIH07XG4gICAgcmV0dXJuIFNlYXJjaEJhcjtcbn0oc2VhcmNoX2Jhcl9jb21tb25fMS5TZWFyY2hCYXJCYXNlKSk7XG5leHBvcnRzLlNlYXJjaEJhciA9IFNlYXJjaEJhcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlYXJjaC1iYXIuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBrbm93bkNvbGxlY3Rpb25zO1xuKGZ1bmN0aW9uIChrbm93bkNvbGxlY3Rpb25zKSB7XG4gICAga25vd25Db2xsZWN0aW9ucy5pdGVtcyA9IFwiaXRlbXNcIjtcbn0pKGtub3duQ29sbGVjdGlvbnMgPSBleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgfHwgKGV4cG9ydHMua25vd25Db2xsZWN0aW9ucyA9IHt9KSk7XG52YXIgU2VnbWVudGVkQmFySXRlbUJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTZWdtZW50ZWRCYXJJdGVtQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTZWdtZW50ZWRCYXJJdGVtQmFzZSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl90aXRsZSA9IFwiXCI7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNlZ21lbnRlZEJhckl0ZW1CYXNlLnByb3RvdHlwZSwgXCJ0aXRsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RpdGxlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHN0clZhbHVlID0gKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQpID8gdmFsdWUudG9TdHJpbmcoKSA6IFwiXCI7XG4gICAgICAgICAgICBpZiAodGhpcy5fdGl0bGUgIT09IHN0clZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGl0bGUgPSBzdHJWYWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU2VnbWVudGVkQmFySXRlbUJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJTZWdtZW50ZWRCYXJJdGVtXCIpXG4gICAgXSwgU2VnbWVudGVkQmFySXRlbUJhc2UpO1xuICAgIHJldHVybiBTZWdtZW50ZWRCYXJJdGVtQmFzZTtcbn0odmlld18xLlZpZXdCYXNlKSk7XG5leHBvcnRzLlNlZ21lbnRlZEJhckl0ZW1CYXNlID0gU2VnbWVudGVkQmFySXRlbUJhc2U7XG52YXIgU2VnbWVudGVkQmFyQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNlZ21lbnRlZEJhckJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2VnbWVudGVkQmFyQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2VnbWVudGVkQmFyQmFzZS5wcm90b3R5cGUsIFwic2VsZWN0ZWRCYWNrZ3JvdW5kQ29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnNlbGVjdGVkQmFja2dyb3VuZENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5zZWxlY3RlZEJhY2tncm91bmRDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTZWdtZW50ZWRCYXJCYXNlLnByb3RvdHlwZS5fYWRkQXJyYXlGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJpdGVtc1wiKSB7XG4gICAgICAgICAgICB0aGlzLml0ZW1zID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhckJhc2UucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmIChuYW1lID09PSBcIlNlZ21lbnRlZEJhckl0ZW1cIikge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgICAgICBpZiAoIWl0ZW1zKSB7XG4gICAgICAgICAgICAgICAgaXRlbXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgICAgICAgICBpdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMgPSBpdGVtcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGl0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWRkVmlldyhpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzW2V4cG9ydHMuaXRlbXNQcm9wZXJ0eS5zZXROYXRpdmVdKGl0ZW1zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VnbWVudGVkQmFyQmFzZS5wcm90b3R5cGUub25JdGVtc0NoYW5nZWQgPSBmdW5jdGlvbiAob2xkSXRlbXMsIG5ld0l0ZW1zKSB7XG4gICAgICAgIGlmIChvbGRJdGVtcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNvdW50ID0gb2xkSXRlbXMubGVuZ3RoOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVZpZXcob2xkSXRlbXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdJdGVtcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGNvdW50ID0gbmV3SXRlbXMubGVuZ3RoOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcobmV3SXRlbXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXJCYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soaXRlbSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VnbWVudGVkQmFyQmFzZS5zZWxlY3RlZEluZGV4Q2hhbmdlZEV2ZW50ID0gXCJzZWxlY3RlZEluZGV4Q2hhbmdlZFwiO1xuICAgIFNlZ21lbnRlZEJhckJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJTZWdtZW50ZWRCYXJcIilcbiAgICBdLCBTZWdtZW50ZWRCYXJCYXNlKTtcbiAgICByZXR1cm4gU2VnbWVudGVkQmFyQmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuU2VnbWVudGVkQmFyQmFzZSA9IFNlZ21lbnRlZEJhckJhc2U7XG5TZWdtZW50ZWRCYXJCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy5zZWxlY3RlZEluZGV4UHJvcGVydHkgPSBuZXcgdmlld18xLkNvZXJjaWJsZVByb3BlcnR5KHtcbiAgICBuYW1lOiBcInNlbGVjdGVkSW5kZXhcIiwgZGVmYXVsdFZhbHVlOiAtMSxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0YXJnZXQubm90aWZ5KHsgZXZlbnROYW1lOiBTZWdtZW50ZWRCYXJCYXNlLnNlbGVjdGVkSW5kZXhDaGFuZ2VkRXZlbnQsIG9iamVjdDogdGFyZ2V0LCBvbGRJbmRleDogb2xkVmFsdWUsIG5ld0luZGV4OiBuZXdWYWx1ZSB9KTtcbiAgICB9LFxuICAgIGNvZXJjZVZhbHVlOiBmdW5jdGlvbiAodGFyZ2V0LCB2YWx1ZSkge1xuICAgICAgICB2YXIgaXRlbXMgPSB0YXJnZXQuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgdmFyIG1heCA9IGl0ZW1zLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICBpZiAodmFsdWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlID4gbWF4KSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBtYXg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YWx1ZSA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5zZWxlY3RlZEluZGV4UHJvcGVydHkucmVnaXN0ZXIoU2VnbWVudGVkQmFyQmFzZSk7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1zXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5vbkl0ZW1zQ2hhbmdlZChvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5LnJlZ2lzdGVyKFNlZ21lbnRlZEJhckJhc2UpO1xuZXhwb3J0cy5zZWxlY3RlZEJhY2tncm91bmRDb2xvclByb3BlcnR5ID0gbmV3IHZpZXdfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7IG5hbWU6IFwic2VsZWN0ZWRCYWNrZ3JvdW5kQ29sb3JcIiwgY3NzTmFtZTogXCJzZWxlY3RlZC1iYWNrZ3JvdW5kLWNvbG9yXCIsIGVxdWFsaXR5Q29tcGFyZXI6IHZpZXdfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IHZpZXdfMS5Db2xvcih2KTsgfSB9KTtcbmV4cG9ydHMuc2VsZWN0ZWRCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VnbWVudGVkLWJhci1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmb250XzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9mb250XCIpO1xudmFyIHNlZ21lbnRlZF9iYXJfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9zZWdtZW50ZWQtYmFyLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3NlZ21lbnRlZC1iYXItY29tbW9uXCIpKTtcbnZhciBSX0lEX1RBQlMgPSAweDAxMDIwMDEzO1xudmFyIFJfSURfVEFCQ09OVEVOVCA9IDB4MDEwMjAwMTE7XG52YXIgUl9BVFRSX1NUQVRFX1NFTEVDVEVEID0gMHgwMTAxMDBhMTtcbnZhciBUSVRMRV9URVhUX1ZJRVdfSUQgPSAxNjkwODMxMDtcbnZhciBhcGlMZXZlbDtcbnZhciBzZWxlY3RlZEluZGljYXRvclRoaWNrbmVzcztcbnZhciBUYWJIb3N0O1xudmFyIFRhYkNoYW5nZUxpc3RlbmVyO1xudmFyIFRhYkNvbnRlbnRGYWN0b3J5O1xuZnVuY3Rpb24gaW5pdGlhbGl6ZU5hdGl2ZUNsYXNzZXMoKSB7XG4gICAgaWYgKFRhYkNoYW5nZUxpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYXBpTGV2ZWwgPSBhbmRyb2lkLm9zLkJ1aWxkLlZFUlNJT04uU0RLX0lOVDtcbiAgICBzZWxlY3RlZEluZGljYXRvclRoaWNrbmVzcyA9IHNlZ21lbnRlZF9iYXJfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGFwaUxldmVsID49IDIxID8gMiA6IDUpO1xuICAgIHZhciBUYWJDaGFuZ2VMaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoVGFiQ2hhbmdlTGlzdGVuZXJJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBUYWJDaGFuZ2VMaXN0ZW5lckltcGwob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgVGFiQ2hhbmdlTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblRhYkNoYW5nZWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAob3duZXIuc2hvdWxkQ2hhbmdlU2VsZWN0ZWRJbmRleCgpKSB7XG4gICAgICAgICAgICAgICAgb3duZXIuc2VsZWN0ZWRJbmRleCA9IHBhcnNlSW50KGlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVGFiQ2hhbmdlTGlzdGVuZXJJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLndpZGdldC5UYWJIb3N0Lk9uVGFiQ2hhbmdlTGlzdGVuZXJdKVxuICAgICAgICBdLCBUYWJDaGFuZ2VMaXN0ZW5lckltcGwpO1xuICAgICAgICByZXR1cm4gVGFiQ2hhbmdlTGlzdGVuZXJJbXBsO1xuICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgIHZhciBUYWJDb250ZW50RmFjdG9yeUltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoVGFiQ29udGVudEZhY3RvcnlJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBUYWJDb250ZW50RmFjdG9yeUltcGwob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgVGFiQ29udGVudEZhY3RvcnlJbXBsLnByb3RvdHlwZS5jcmVhdGVUYWJDb250ZW50ID0gZnVuY3Rpb24gKHRhZykge1xuICAgICAgICAgICAgdmFyIHR2ID0gbmV3IGFuZHJvaWQud2lkZ2V0LlRleHRWaWV3KHRoaXMub3duZXIuX2NvbnRleHQpO1xuICAgICAgICAgICAgdHYuc2V0VmlzaWJpbGl0eShhbmRyb2lkLnZpZXcuVmlldy5HT05FKTtcbiAgICAgICAgICAgIHR2LnNldE1heExpbmVzKDEpO1xuICAgICAgICAgICAgdHYuc2V0RWxsaXBzaXplKGFuZHJvaWQudGV4dC5UZXh0VXRpbHMuVHJ1bmNhdGVBdC5FTkQpO1xuICAgICAgICAgICAgcmV0dXJuIHR2O1xuICAgICAgICB9O1xuICAgICAgICBUYWJDb250ZW50RmFjdG9yeUltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWQud2lkZ2V0LlRhYkhvc3QuVGFiQ29udGVudEZhY3RvcnldKVxuICAgICAgICBdLCBUYWJDb250ZW50RmFjdG9yeUltcGwpO1xuICAgICAgICByZXR1cm4gVGFiQ29udGVudEZhY3RvcnlJbXBsO1xuICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgIHZhciBUYWJIb3N0SW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhUYWJIb3N0SW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gVGFiSG9zdEltcGwoY29udGV4dCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGNvbnRleHQsIGF0dHJzKSB8fCB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgVGFiSG9zdEltcGwucHJvdG90eXBlLm9uQXR0YWNoZWRUb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFRhYkhvc3RJbXBsO1xuICAgIH0oYW5kcm9pZC53aWRnZXQuVGFiSG9zdCkpO1xuICAgIFRhYkhvc3QgPSBUYWJIb3N0SW1wbDtcbiAgICBUYWJDaGFuZ2VMaXN0ZW5lciA9IFRhYkNoYW5nZUxpc3RlbmVySW1wbDtcbiAgICBUYWJDb250ZW50RmFjdG9yeSA9IFRhYkNvbnRlbnRGYWN0b3J5SW1wbDtcbn1cbnZhciBTZWdtZW50ZWRCYXJJdGVtID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2VnbWVudGVkQmFySXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTZWdtZW50ZWRCYXJJdGVtKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFNlZ21lbnRlZEJhckl0ZW0ucHJvdG90eXBlLnNldHVwTmF0aXZlVmlldyA9IGZ1bmN0aW9uICh0YWJJbmRleCkge1xuICAgICAgICB2YXIgdGl0bGVUZXh0VmlldyA9IHRoaXMucGFyZW50Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0VGFiV2lkZ2V0KCkuZ2V0Q2hpbGRBdCh0YWJJbmRleCkuZmluZFZpZXdCeUlkKFRJVExFX1RFWFRfVklFV19JRCk7XG4gICAgICAgIHRoaXMuc2V0TmF0aXZlVmlldyh0aXRsZVRleHRWaWV3KTtcbiAgICAgICAgaWYgKHRpdGxlVGV4dFZpZXcpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRpdGxlRGlydHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VnbWVudGVkQmFySXRlbS5wcm90b3R5cGUuX3VwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHR2ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAodHYpIHtcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMudGl0bGU7XG4gICAgICAgICAgICB0aXRsZSA9ICh0aXRsZSA9PT0gbnVsbCB8fCB0aXRsZSA9PT0gdW5kZWZpbmVkKSA/IFwiXCIgOiB0aXRsZTtcbiAgICAgICAgICAgIHR2LnNldFRleHQodGl0bGUpO1xuICAgICAgICAgICAgdGhpcy50aXRsZURpcnR5ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRGlydHkgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXJJdGVtLnByb3RvdHlwZVtzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0Q3VycmVudFRleHRDb2xvcigpO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFySXRlbS5wcm90b3R5cGVbc2VnbWVudGVkX2Jhcl9jb21tb25fMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLkNvbG9yID8gdmFsdWUuYW5kcm9pZCA6IHZhbHVlO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VGV4dENvbG9yKGNvbG9yKTtcbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhckl0ZW0ucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuZm9udFNpemVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgbmF0aXZlU2l6ZTogdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFRleHRTaXplKCkgfTtcbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhckl0ZW0ucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuZm9udFNpemVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUZXh0U2l6ZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VGV4dFNpemUoYW5kcm9pZC51dGlsLlR5cGVkVmFsdWUuQ09NUExFWF9VTklUX1BYLCB2YWx1ZS5uYXRpdmVTaXplKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VnbWVudGVkQmFySXRlbS5wcm90b3R5cGVbc2VnbWVudGVkX2Jhcl9jb21tb25fMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRUeXBlZmFjZSgpO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFySXRlbS5wcm90b3R5cGVbc2VnbWVudGVkX2Jhcl9jb21tb25fMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUeXBlZmFjZSh2YWx1ZSBpbnN0YW5jZW9mIGZvbnRfMS5Gb250ID8gdmFsdWUuZ2V0QW5kcm9pZFR5cGVmYWNlKCkgOiB2YWx1ZSk7XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXJJdGVtLnByb3RvdHlwZVtzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLnNlbGVjdGVkQmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2aWV3R3JvdXAgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0UGFyZW50KCk7XG4gICAgICAgIHJldHVybiB2aWV3R3JvdXAuZ2V0QmFja2dyb3VuZCgpO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFySXRlbS5wcm90b3R5cGVbc2VnbWVudGVkX2Jhcl9jb21tb25fMS5zZWxlY3RlZEJhY2tncm91bmRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciB2aWV3R3JvdXAgPSBuYXRpdmVWaWV3LmdldFBhcmVudCgpO1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLkNvbG9yKSB7XG4gICAgICAgICAgICB2YXIgY29sb3IgPSB2YWx1ZS5hbmRyb2lkO1xuICAgICAgICAgICAgdmFyIGJhY2tncm91bmREcmF3YWJsZSA9IHZpZXdHcm91cC5nZXRCYWNrZ3JvdW5kKCk7XG4gICAgICAgICAgICBpZiAoYXBpTGV2ZWwgPiAyMSAmJiBiYWNrZ3JvdW5kRHJhd2FibGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3RHJhd2FibGUgPSB0cnlDbG9uZURyYXdhYmxlKGJhY2tncm91bmREcmF3YWJsZSwgbmF0aXZlVmlldy5nZXRSZXNvdXJjZXMoKSk7XG4gICAgICAgICAgICAgICAgbmV3RHJhd2FibGUuc2V0Q29sb3JGaWx0ZXIoY29sb3IsIGFuZHJvaWQuZ3JhcGhpY3MuUG9ydGVyRHVmZi5Nb2RlLlNSQ19JTik7XG4gICAgICAgICAgICAgICAgdmlld0dyb3VwLnNldEJhY2tncm91bmQobmV3RHJhd2FibGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlRHJhd2FibGUgPSBuZXcgYW5kcm9pZC5ncmFwaGljcy5kcmF3YWJsZS5TdGF0ZUxpc3REcmF3YWJsZSgpO1xuICAgICAgICAgICAgICAgIHZhciBjb2xvckRyYXdhYmxlID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5TZWdtZW50ZWRCYXJDb2xvckRyYXdhYmxlKGNvbG9yLCBzZWxlY3RlZEluZGljYXRvclRoaWNrbmVzcyk7XG4gICAgICAgICAgICAgICAgdmFyIGFyciA9IEFycmF5LmNyZWF0ZShcImludFwiLCAxKTtcbiAgICAgICAgICAgICAgICBhcnJbMF0gPSBSX0FUVFJfU1RBVEVfU0VMRUNURUQ7XG4gICAgICAgICAgICAgICAgc3RhdGVEcmF3YWJsZS5hZGRTdGF0ZShhcnIsIGNvbG9yRHJhd2FibGUpO1xuICAgICAgICAgICAgICAgIHN0YXRlRHJhd2FibGUuc2V0Qm91bmRzKDAsIDE1LCB2aWV3R3JvdXAuZ2V0UmlnaHQoKSwgdmlld0dyb3VwLmdldEJvdHRvbSgpKTtcbiAgICAgICAgICAgICAgICB2aWV3R3JvdXAuc2V0QmFja2dyb3VuZChzdGF0ZURyYXdhYmxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBiYWNrZ3JvdW5kRHJhd2FibGUgPSB0cnlDbG9uZURyYXdhYmxlKHZhbHVlLCBuYXRpdmVWaWV3LmdldFJlc291cmNlcygpKTtcbiAgICAgICAgICAgIHZpZXdHcm91cC5zZXRCYWNrZ3JvdW5kKGJhY2tncm91bmREcmF3YWJsZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBTZWdtZW50ZWRCYXJJdGVtO1xufShzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLlNlZ21lbnRlZEJhckl0ZW1CYXNlKSk7XG5leHBvcnRzLlNlZ21lbnRlZEJhckl0ZW0gPSBTZWdtZW50ZWRCYXJJdGVtO1xuZnVuY3Rpb24gdHJ5Q2xvbmVEcmF3YWJsZSh2YWx1ZSwgcmVzb3VyY2VzKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb25zdGFudFN0YXRlID0gdmFsdWUuZ2V0Q29uc3RhbnRTdGF0ZSgpO1xuICAgICAgICBpZiAoY29uc3RhbnRTdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50U3RhdGUubmV3RHJhd2FibGUocmVzb3VyY2VzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG52YXIgU2VnbWVudGVkQmFyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2VnbWVudGVkQmFyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNlZ21lbnRlZEJhcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTZWdtZW50ZWRCYXIucHJvdG90eXBlLnNob3VsZENoYW5nZVNlbGVjdGVkSW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5fYWRkaW5nVGFiO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFyLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpbml0aWFsaXplTmF0aXZlQ2xhc3NlcygpO1xuICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuX2NvbnRleHQ7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gbmV3IFRhYkhvc3QoY29udGV4dCwgbnVsbCk7XG4gICAgICAgIHZhciB0YWJIb3N0TGF5b3V0ID0gbmV3IGFuZHJvaWQud2lkZ2V0LkxpbmVhckxheW91dChjb250ZXh0KTtcbiAgICAgICAgdGFiSG9zdExheW91dC5zZXRPcmllbnRhdGlvbihhbmRyb2lkLndpZGdldC5MaW5lYXJMYXlvdXQuVkVSVElDQUwpO1xuICAgICAgICB2YXIgdGFiV2lkZ2V0ID0gbmV3IGFuZHJvaWQud2lkZ2V0LlRhYldpZGdldChjb250ZXh0KTtcbiAgICAgICAgdGFiV2lkZ2V0LnNldElkKFJfSURfVEFCUyk7XG4gICAgICAgIHRhYkhvc3RMYXlvdXQuYWRkVmlldyh0YWJXaWRnZXQpO1xuICAgICAgICB2YXIgZnJhbWUgPSBuZXcgYW5kcm9pZC53aWRnZXQuRnJhbWVMYXlvdXQoY29udGV4dCk7XG4gICAgICAgIGZyYW1lLnNldElkKFJfSURfVEFCQ09OVEVOVCk7XG4gICAgICAgIGZyYW1lLnNldFZpc2liaWxpdHkoYW5kcm9pZC52aWV3LlZpZXcuR09ORSk7XG4gICAgICAgIHRhYkhvc3RMYXlvdXQuYWRkVmlldyhmcmFtZSk7XG4gICAgICAgIG5hdGl2ZVZpZXcuYWRkVmlldyh0YWJIb3N0TGF5b3V0KTtcbiAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXc7XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgbGlzdGVuZXIgPSBuZXcgVGFiQ2hhbmdlTGlzdGVuZXIodGhpcyk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0T25UYWJDaGFuZ2VkTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgICAgICBuYXRpdmVWaWV3Lmxpc3RlbmVyID0gbGlzdGVuZXI7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0dXAoKTtcbiAgICAgICAgdGhpcy5fdGFiQ29udGVudEZhY3RvcnkgPSB0aGlzLl90YWJDb250ZW50RmFjdG9yeSB8fCBuZXcgVGFiQ29udGVudEZhY3RvcnkodGhpcyk7XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgbmF0aXZlVmlldy5saXN0ZW5lci5vd25lciA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhci5wcm90b3R5cGUuaW5zZXJ0VGFiID0gZnVuY3Rpb24gKHRhYkl0ZW0sIGluZGV4KSB7XG4gICAgICAgIHZhciB0YWJIb3N0ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgdGFiID0gdGFiSG9zdC5uZXdUYWJTcGVjKGluZGV4ICsgXCJcIik7XG4gICAgICAgIHRhYi5zZXRJbmRpY2F0b3IodGFiSXRlbS50aXRsZSArIFwiXCIpO1xuICAgICAgICB0YWIuc2V0Q29udGVudCh0aGlzLl90YWJDb250ZW50RmFjdG9yeSk7XG4gICAgICAgIHRoaXMuX2FkZGluZ1RhYiA9IHRydWU7XG4gICAgICAgIHRhYkhvc3QuYWRkVGFiKHRhYik7XG4gICAgICAgIHRhYkl0ZW0uc2V0dXBOYXRpdmVWaWV3KGluZGV4KTtcbiAgICAgICAgdGhpcy5fYWRkaW5nVGFiID0gZmFsc2U7XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXIucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXIucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEN1cnJlbnRUYWIodmFsdWUpO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFyLnByb3RvdHlwZVtzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLml0ZW1zUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFyLnByb3RvdHlwZVtzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLml0ZW1zUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY2xlYXJBbGxUYWJzKCk7XG4gICAgICAgIHZhciBuZXdJdGVtcyA9IHZhbHVlO1xuICAgICAgICBpZiAobmV3SXRlbXMpIHtcbiAgICAgICAgICAgIG5ld0l0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGksIGFycikgeyByZXR1cm4gX3RoaXMuaW5zZXJ0VGFiKGl0ZW0sIGkpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5jb2VyY2UodGhpcyk7XG4gICAgfTtcbiAgICByZXR1cm4gU2VnbWVudGVkQmFyO1xufShzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLlNlZ21lbnRlZEJhckJhc2UpKTtcbmV4cG9ydHMuU2VnbWVudGVkQmFyID0gU2VnbWVudGVkQmFyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VnbWVudGVkLWJhci5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIFNsaWRlckJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTbGlkZXJCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNsaWRlckJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU2xpZGVyQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIlNsaWRlclwiKVxuICAgIF0sIFNsaWRlckJhc2UpO1xuICAgIHJldHVybiBTbGlkZXJCYXNlO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5TbGlkZXJCYXNlID0gU2xpZGVyQmFzZTtcblNsaWRlckJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLnZhbHVlUHJvcGVydHkgPSBuZXcgdmlld18xLkNvZXJjaWJsZVByb3BlcnR5KHtcbiAgICBuYW1lOiBcInZhbHVlXCIsIGRlZmF1bHRWYWx1ZTogMCwgY29lcmNlVmFsdWU6IGZ1bmN0aW9uICh0YXJnZXQsIHZhbHVlKSB7XG4gICAgICAgIHZhbHVlID0gTWF0aC5tYXgodmFsdWUsIHRhcmdldC5taW5WYWx1ZSk7XG4gICAgICAgIHZhbHVlID0gTWF0aC5taW4odmFsdWUsIHRhcmdldC5tYXhWYWx1ZSk7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHZpZXdfMS5pc0lPUyA/IHBhcnNlRmxvYXQodikgOiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLnZhbHVlUHJvcGVydHkucmVnaXN0ZXIoU2xpZGVyQmFzZSk7XG5leHBvcnRzLm1pblZhbHVlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1pblZhbHVlXCIsIGRlZmF1bHRWYWx1ZTogMCwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgZXhwb3J0cy5tYXhWYWx1ZVByb3BlcnR5LmNvZXJjZSh0YXJnZXQpO1xuICAgICAgICBleHBvcnRzLnZhbHVlUHJvcGVydHkuY29lcmNlKHRhcmdldCk7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiB2aWV3XzEuaXNJT1MgPyBwYXJzZUZsb2F0KHYpIDogcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5taW5WYWx1ZVByb3BlcnR5LnJlZ2lzdGVyKFNsaWRlckJhc2UpO1xuZXhwb3J0cy5tYXhWYWx1ZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Db2VyY2libGVQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtYXhWYWx1ZVwiLCBkZWZhdWx0VmFsdWU6IDEwMCwgY29lcmNlVmFsdWU6IGZ1bmN0aW9uICh0YXJnZXQsIHZhbHVlKSB7XG4gICAgICAgIHZhciBtaW5WYWx1ZSA9IHRhcmdldC5taW5WYWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlIDwgbWluVmFsdWUpIHtcbiAgICAgICAgICAgIHZhbHVlID0gbWluVmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHsgcmV0dXJuIGV4cG9ydHMudmFsdWVQcm9wZXJ0eS5jb2VyY2UodGFyZ2V0KTsgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHZpZXdfMS5pc0lPUyA/IHBhcnNlRmxvYXQodikgOiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLm1heFZhbHVlUHJvcGVydHkucmVnaXN0ZXIoU2xpZGVyQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zbGlkZXItY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgc2xpZGVyX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vc2xpZGVyLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3NsaWRlci1jb21tb25cIikpO1xudmFyIFNlZWtCYXI7XG52YXIgU2Vla0JhckNoYW5nZUxpc3RlbmVyO1xuZnVuY3Rpb24gaW5pdGlhbGl6ZUxpc3RlbmVyQ2xhc3MoKSB7XG4gICAgaWYgKCFTZWVrQmFyQ2hhbmdlTGlzdGVuZXIpIHtcbiAgICAgICAgdmFyIFNlZWtCYXJDaGFuZ2VMaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICAgICAgX19leHRlbmRzKFNlZWtCYXJDaGFuZ2VMaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgICAgICBmdW5jdGlvbiBTZWVrQmFyQ2hhbmdlTGlzdGVuZXJJbXBsKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBTZWVrQmFyQ2hhbmdlTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblByb2dyZXNzQ2hhbmdlZCA9IGZ1bmN0aW9uIChzZWVrQmFyLCBwcm9ncmVzcywgZnJvbVVzZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3duZXIgPSBzZWVrQmFyLm93bmVyO1xuICAgICAgICAgICAgICAgIGlmIChvd25lciAmJiAhb3duZXIuX3N1cHJlc3NOYXRpdmVWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSBwcm9ncmVzcyArIG93bmVyLm1pblZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBzbGlkZXJfY29tbW9uXzEudmFsdWVQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgbmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBTZWVrQmFyQ2hhbmdlTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblN0YXJ0VHJhY2tpbmdUb3VjaCA9IGZ1bmN0aW9uIChzZWVrQmFyKSB7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgU2Vla0JhckNoYW5nZUxpc3RlbmVySW1wbC5wcm90b3R5cGUub25TdG9wVHJhY2tpbmdUb3VjaCA9IGZ1bmN0aW9uIChzZWVrQmFyKSB7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgU2Vla0JhckNoYW5nZUxpc3RlbmVySW1wbCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWQud2lkZ2V0LlNlZWtCYXIuT25TZWVrQmFyQ2hhbmdlTGlzdGVuZXJdKVxuICAgICAgICAgICAgXSwgU2Vla0JhckNoYW5nZUxpc3RlbmVySW1wbCk7XG4gICAgICAgICAgICByZXR1cm4gU2Vla0JhckNoYW5nZUxpc3RlbmVySW1wbDtcbiAgICAgICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgICAgIFNlZWtCYXJDaGFuZ2VMaXN0ZW5lciA9IG5ldyBTZWVrQmFyQ2hhbmdlTGlzdGVuZXJJbXBsKCk7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0TGlzdGVuZXIoKSB7XG4gICAgcmV0dXJuIFNlZWtCYXJDaGFuZ2VMaXN0ZW5lcjtcbn1cbnZhciBTbGlkZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTbGlkZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2xpZGVyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFNsaWRlci5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFTZWVrQmFyKSB7XG4gICAgICAgICAgICBTZWVrQmFyID0gYW5kcm9pZC53aWRnZXQuU2Vla0JhcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFNlZWtCYXIodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBuYXRpdmVWaWV3Lm93bmVyID0gdGhpcztcbiAgICAgICAgaW5pdGlhbGl6ZUxpc3RlbmVyQ2xhc3MoKTtcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gZ2V0TGlzdGVuZXIoKTtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRPblNlZWtCYXJDaGFuZ2VMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQub3duZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0TWF4KDEwMCk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0UHJvZ3Jlc3MoMCk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0S2V5UHJvZ3Jlc3NJbmNyZW1lbnQoMSk7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlLnNldE5hdGl2ZVZhbHVlc1NpbGVudGx5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdXByZXNzTmF0aXZlVmFsdWUgPSB0cnVlO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0TWF4KHRoaXMubWF4VmFsdWUgLSB0aGlzLm1pblZhbHVlKTtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0UHJvZ3Jlc3ModGhpcy52YWx1ZSAtIHRoaXMubWluVmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5fc3VwcmVzc05hdGl2ZVZhbHVlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNsaWRlci5wcm90b3R5cGVbc2xpZGVyX2NvbW1vbl8xLnZhbHVlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnNldE5hdGl2ZVZhbHVlc1NpbGVudGx5KCk7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlW3NsaWRlcl9jb21tb25fMS5taW5WYWx1ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zZXROYXRpdmVWYWx1ZXNTaWxlbnRseSgpO1xuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZVtzbGlkZXJfY29tbW9uXzEubWF4VmFsdWVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDEwMDtcbiAgICB9O1xuICAgIFNsaWRlci5wcm90b3R5cGVbc2xpZGVyX2NvbW1vbl8xLm1heFZhbHVlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnNldE5hdGl2ZVZhbHVlc1NpbGVudGx5KCk7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlW3NsaWRlcl9jb21tb25fMS5jb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlW3NsaWRlcl9jb21tb25fMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2Ygc2xpZGVyX2NvbW1vbl8xLkNvbG9yKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0VGh1bWIoKS5zZXRDb2xvckZpbHRlcih2YWx1ZS5hbmRyb2lkLCBhbmRyb2lkLmdyYXBoaWNzLlBvcnRlckR1ZmYuTW9kZS5TUkNfSU4pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFRodW1iKCkuY2xlYXJDb2xvckZpbHRlcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlW3NsaWRlcl9jb21tb25fMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZVtzbGlkZXJfY29tbW9uXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBzbGlkZXJfY29tbW9uXzEuQ29sb3IpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRQcm9ncmVzc0RyYXdhYmxlKCkuc2V0Q29sb3JGaWx0ZXIodmFsdWUuYW5kcm9pZCwgYW5kcm9pZC5ncmFwaGljcy5Qb3J0ZXJEdWZmLk1vZGUuU1JDX0lOKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRQcm9ncmVzc0RyYXdhYmxlKCkuY2xlYXJDb2xvckZpbHRlcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlW3NsaWRlcl9jb21tb25fMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlW3NsaWRlcl9jb21tb25fMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICByZXR1cm4gU2xpZGVyO1xufShzbGlkZXJfY29tbW9uXzEuU2xpZGVyQmFzZSkpO1xuZXhwb3J0cy5TbGlkZXIgPSBTbGlkZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zbGlkZXIuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGluZWFyX2dyYWRpZW50XzEgPSByZXF1aXJlKFwiLi9saW5lYXItZ3JhZGllbnRcIik7XG52YXIgY29sb3JfMSA9IHJlcXVpcmUoXCIuLi8uLi9jb2xvclwiKTtcbnZhciBCYWNrZ3JvdW5kID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBCYWNrZ3JvdW5kKCkge1xuICAgICAgICB0aGlzLmJvcmRlclRvcFdpZHRoID0gMDtcbiAgICAgICAgdGhpcy5ib3JkZXJSaWdodFdpZHRoID0gMDtcbiAgICAgICAgdGhpcy5ib3JkZXJCb3R0b21XaWR0aCA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyTGVmdFdpZHRoID0gMDtcbiAgICAgICAgdGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzID0gMDtcbiAgICAgICAgdGhpcy5ib3JkZXJUb3BSaWdodFJhZGl1cyA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyQm90dG9tTGVmdFJhZGl1cyA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXMgPSAwO1xuICAgIH1cbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNsb25lID0gbmV3IEJhY2tncm91bmQoKTtcbiAgICAgICAgY2xvbmUuY29sb3IgPSB0aGlzLmNvbG9yO1xuICAgICAgICBjbG9uZS5pbWFnZSA9IHRoaXMuaW1hZ2U7XG4gICAgICAgIGNsb25lLnJlcGVhdCA9IHRoaXMucmVwZWF0O1xuICAgICAgICBjbG9uZS5wb3NpdGlvbiA9IHRoaXMucG9zaXRpb247XG4gICAgICAgIGNsb25lLnNpemUgPSB0aGlzLnNpemU7XG4gICAgICAgIGNsb25lLmJvcmRlclRvcENvbG9yID0gdGhpcy5ib3JkZXJUb3BDb2xvcjtcbiAgICAgICAgY2xvbmUuYm9yZGVyUmlnaHRDb2xvciA9IHRoaXMuYm9yZGVyUmlnaHRDb2xvcjtcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tQ29sb3IgPSB0aGlzLmJvcmRlckJvdHRvbUNvbG9yO1xuICAgICAgICBjbG9uZS5ib3JkZXJMZWZ0Q29sb3IgPSB0aGlzLmJvcmRlckxlZnRDb2xvcjtcbiAgICAgICAgY2xvbmUuYm9yZGVyVG9wV2lkdGggPSB0aGlzLmJvcmRlclRvcFdpZHRoO1xuICAgICAgICBjbG9uZS5ib3JkZXJSaWdodFdpZHRoID0gdGhpcy5ib3JkZXJSaWdodFdpZHRoO1xuICAgICAgICBjbG9uZS5ib3JkZXJCb3R0b21XaWR0aCA9IHRoaXMuYm9yZGVyQm90dG9tV2lkdGg7XG4gICAgICAgIGNsb25lLmJvcmRlckxlZnRXaWR0aCA9IHRoaXMuYm9yZGVyTGVmdFdpZHRoO1xuICAgICAgICBjbG9uZS5ib3JkZXJUb3BMZWZ0UmFkaXVzID0gdGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzO1xuICAgICAgICBjbG9uZS5ib3JkZXJUb3BSaWdodFJhZGl1cyA9IHRoaXMuYm9yZGVyVG9wUmlnaHRSYWRpdXM7XG4gICAgICAgIGNsb25lLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID0gdGhpcy5ib3JkZXJCb3R0b21SaWdodFJhZGl1cztcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tTGVmdFJhZGl1cyA9IHRoaXMuYm9yZGVyQm90dG9tTGVmdFJhZGl1cztcbiAgICAgICAgY2xvbmUuY2xpcFBhdGggPSB0aGlzLmNsaXBQYXRoO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQ29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5jb2xvciA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoSW1hZ2UgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5pbWFnZSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoUmVwZWF0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUucmVwZWF0ID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhQb3NpdGlvbiA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLnBvc2l0aW9uID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhTaXplID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuc2l6ZSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQm9yZGVyVG9wQ29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJUb3BDb2xvciA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQm9yZGVyUmlnaHRDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlclJpZ2h0Q29sb3IgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlckJvdHRvbUNvbG9yID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlckxlZnRDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlckxlZnRDb2xvciA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQm9yZGVyVG9wV2lkdGggPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJUb3BXaWR0aCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQm9yZGVyUmlnaHRXaWR0aCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlclJpZ2h0V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlckJvdHRvbVdpZHRoID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tV2lkdGggPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlckxlZnRXaWR0aCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlckxlZnRXaWR0aCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQm9yZGVyVG9wTGVmdFJhZGl1cyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlclRvcExlZnRSYWRpdXMgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlclRvcFJpZ2h0UmFkaXVzID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyVG9wUmlnaHRSYWRpdXMgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXMgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlckJvdHRvbUxlZnRSYWRpdXMgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhDbGlwUGF0aCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmNsaXBQYXRoID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5jb2xvclxuICAgICAgICAgICAgJiYgIXRoaXMuaW1hZ2VcbiAgICAgICAgICAgICYmICF0aGlzLmhhc0JvcmRlcldpZHRoKClcbiAgICAgICAgICAgICYmICF0aGlzLmhhc0JvcmRlclJhZGl1cygpXG4gICAgICAgICAgICAmJiAhdGhpcy5jbGlwUGF0aDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQuZXF1YWxzID0gZnVuY3Rpb24gKHZhbHVlMSwgdmFsdWUyKSB7XG4gICAgICAgIGlmICghdmFsdWUxICYmICF2YWx1ZTIpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdmFsdWUxIHx8ICF2YWx1ZTIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW1hZ2VzRXF1YWwgPSBmYWxzZTtcbiAgICAgICAgaWYgKHZhbHVlMSBpbnN0YW5jZW9mIGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50ICYmIHZhbHVlMiBpbnN0YW5jZW9mIGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50KSB7XG4gICAgICAgICAgICBpbWFnZXNFcXVhbCA9IGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50LmVxdWFscyh2YWx1ZTEsIHZhbHVlMik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpbWFnZXNFcXVhbCA9IHZhbHVlMS5pbWFnZSA9PT0gdmFsdWUyLmltYWdlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb2xvcl8xLkNvbG9yLmVxdWFscyh2YWx1ZTEuY29sb3IsIHZhbHVlMi5jb2xvcilcbiAgICAgICAgICAgICYmIGltYWdlc0VxdWFsXG4gICAgICAgICAgICAmJiB2YWx1ZTEucG9zaXRpb24gPT09IHZhbHVlMi5wb3NpdGlvblxuICAgICAgICAgICAgJiYgdmFsdWUxLnJlcGVhdCA9PT0gdmFsdWUyLnJlcGVhdFxuICAgICAgICAgICAgJiYgdmFsdWUxLnNpemUgPT09IHZhbHVlMi5zaXplXG4gICAgICAgICAgICAmJiBjb2xvcl8xLkNvbG9yLmVxdWFscyh2YWx1ZTEuYm9yZGVyVG9wQ29sb3IsIHZhbHVlMi5ib3JkZXJUb3BDb2xvcilcbiAgICAgICAgICAgICYmIGNvbG9yXzEuQ29sb3IuZXF1YWxzKHZhbHVlMS5ib3JkZXJSaWdodENvbG9yLCB2YWx1ZTIuYm9yZGVyUmlnaHRDb2xvcilcbiAgICAgICAgICAgICYmIGNvbG9yXzEuQ29sb3IuZXF1YWxzKHZhbHVlMS5ib3JkZXJCb3R0b21Db2xvciwgdmFsdWUyLmJvcmRlckJvdHRvbUNvbG9yKVxuICAgICAgICAgICAgJiYgY29sb3JfMS5Db2xvci5lcXVhbHModmFsdWUxLmJvcmRlckxlZnRDb2xvciwgdmFsdWUyLmJvcmRlckxlZnRDb2xvcilcbiAgICAgICAgICAgICYmIHZhbHVlMS5ib3JkZXJUb3BXaWR0aCA9PT0gdmFsdWUyLmJvcmRlclRvcFdpZHRoXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyUmlnaHRXaWR0aCA9PT0gdmFsdWUyLmJvcmRlclJpZ2h0V2lkdGhcbiAgICAgICAgICAgICYmIHZhbHVlMS5ib3JkZXJCb3R0b21XaWR0aCA9PT0gdmFsdWUyLmJvcmRlckJvdHRvbVdpZHRoXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyTGVmdFdpZHRoID09PSB2YWx1ZTIuYm9yZGVyTGVmdFdpZHRoXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyVG9wTGVmdFJhZGl1cyA9PT0gdmFsdWUyLmJvcmRlclRvcExlZnRSYWRpdXNcbiAgICAgICAgICAgICYmIHZhbHVlMS5ib3JkZXJUb3BSaWdodFJhZGl1cyA9PT0gdmFsdWUyLmJvcmRlclRvcFJpZ2h0UmFkaXVzXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXMgPT09IHZhbHVlMi5ib3JkZXJCb3R0b21SaWdodFJhZGl1c1xuICAgICAgICAgICAgJiYgdmFsdWUxLmJvcmRlckJvdHRvbUxlZnRSYWRpdXMgPT09IHZhbHVlMi5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzXG4gICAgICAgICAgICAmJiB2YWx1ZTEuY2xpcFBhdGggPT09IHZhbHVlMi5jbGlwUGF0aDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmhhc0JvcmRlckNvbG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gISF0aGlzLmJvcmRlclRvcENvbG9yIHx8ICEhdGhpcy5ib3JkZXJSaWdodENvbG9yIHx8ICEhdGhpcy5ib3JkZXJCb3R0b21Db2xvciB8fCAhIXRoaXMuYm9yZGVyTGVmdENvbG9yO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUuaGFzQm9yZGVyV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcFdpZHRoID4gMFxuICAgICAgICAgICAgfHwgdGhpcy5ib3JkZXJSaWdodFdpZHRoID4gMFxuICAgICAgICAgICAgfHwgdGhpcy5ib3JkZXJCb3R0b21XaWR0aCA+IDBcbiAgICAgICAgICAgIHx8IHRoaXMuYm9yZGVyTGVmdFdpZHRoID4gMDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmhhc0JvcmRlclJhZGl1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cyA+IDBcbiAgICAgICAgICAgIHx8IHRoaXMuYm9yZGVyVG9wUmlnaHRSYWRpdXMgPiAwXG4gICAgICAgICAgICB8fCB0aGlzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID4gMFxuICAgICAgICAgICAgfHwgdGhpcy5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzID4gMDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmhhc1VuaWZvcm1Cb3JkZXJDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGNvbG9yXzEuQ29sb3IuZXF1YWxzKHRoaXMuYm9yZGVyVG9wQ29sb3IsIHRoaXMuYm9yZGVyUmlnaHRDb2xvcilcbiAgICAgICAgICAgICYmIGNvbG9yXzEuQ29sb3IuZXF1YWxzKHRoaXMuYm9yZGVyVG9wQ29sb3IsIHRoaXMuYm9yZGVyQm90dG9tQ29sb3IpXG4gICAgICAgICAgICAmJiBjb2xvcl8xLkNvbG9yLmVxdWFscyh0aGlzLmJvcmRlclRvcENvbG9yLCB0aGlzLmJvcmRlckxlZnRDb2xvcik7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5oYXNVbmlmb3JtQm9yZGVyV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcFdpZHRoID09PSB0aGlzLmJvcmRlclJpZ2h0V2lkdGhcbiAgICAgICAgICAgICYmIHRoaXMuYm9yZGVyVG9wV2lkdGggPT09IHRoaXMuYm9yZGVyQm90dG9tV2lkdGhcbiAgICAgICAgICAgICYmIHRoaXMuYm9yZGVyVG9wV2lkdGggPT09IHRoaXMuYm9yZGVyTGVmdFdpZHRoO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUuaGFzVW5pZm9ybUJvcmRlclJhZGl1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cyA9PT0gdGhpcy5ib3JkZXJUb3BSaWdodFJhZGl1c1xuICAgICAgICAgICAgJiYgdGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzID09PSB0aGlzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzXG4gICAgICAgICAgICAmJiB0aGlzLmJvcmRlclRvcExlZnRSYWRpdXMgPT09IHRoaXMuYm9yZGVyQm90dG9tTGVmdFJhZGl1cztcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmhhc1VuaWZvcm1Cb3JkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc1VuaWZvcm1Cb3JkZXJDb2xvcigpXG4gICAgICAgICAgICAmJiB0aGlzLmhhc1VuaWZvcm1Cb3JkZXJXaWR0aCgpXG4gICAgICAgICAgICAmJiB0aGlzLmhhc1VuaWZvcm1Cb3JkZXJSYWRpdXMoKTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmdldFVuaWZvcm1Cb3JkZXJDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaGFzVW5pZm9ybUJvcmRlckNvbG9yKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcENvbG9yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5nZXRVbmlmb3JtQm9yZGVyV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmhhc1VuaWZvcm1Cb3JkZXJXaWR0aCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BXaWR0aDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmdldFVuaWZvcm1Cb3JkZXJSYWRpdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmhhc1VuaWZvcm1Cb3JkZXJSYWRpdXMoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJpc0VtcHR5OiBcIiArIHRoaXMuaXNFbXB0eSgpICsgXCI7IGNvbG9yOiBcIiArIHRoaXMuY29sb3IgKyBcIjsgaW1hZ2U6IFwiICsgdGhpcy5pbWFnZSArIFwiOyByZXBlYXQ6IFwiICsgdGhpcy5yZXBlYXQgKyBcIjsgcG9zaXRpb246IFwiICsgdGhpcy5wb3NpdGlvbiArIFwiOyBzaXplOiBcIiArIHRoaXMuc2l6ZSArIFwiOyBib3JkZXJUb3BDb2xvcjogXCIgKyB0aGlzLmJvcmRlclRvcENvbG9yICsgXCI7IGJvcmRlclJpZ2h0Q29sb3I6IFwiICsgdGhpcy5ib3JkZXJSaWdodENvbG9yICsgXCI7IGJvcmRlckJvdHRvbUNvbG9yOiBcIiArIHRoaXMuYm9yZGVyQm90dG9tQ29sb3IgKyBcIjsgYm9yZGVyTGVmdENvbG9yOiBcIiArIHRoaXMuYm9yZGVyTGVmdENvbG9yICsgXCI7IGJvcmRlclRvcFdpZHRoOiBcIiArIHRoaXMuYm9yZGVyVG9wV2lkdGggKyBcIjsgYm9yZGVyUmlnaHRXaWR0aDogXCIgKyB0aGlzLmJvcmRlclJpZ2h0V2lkdGggKyBcIjsgYm9yZGVyQm90dG9tV2lkdGg6IFwiICsgdGhpcy5ib3JkZXJCb3R0b21XaWR0aCArIFwiOyBib3JkZXJMZWZ0V2lkdGg6IFwiICsgdGhpcy5ib3JkZXJMZWZ0V2lkdGggKyBcIjsgYm9yZGVyVG9wTGVmdFJhZGl1czogXCIgKyB0aGlzLmJvcmRlclRvcExlZnRSYWRpdXMgKyBcIjsgYm9yZGVyVG9wUmlnaHRSYWRpdXM6IFwiICsgdGhpcy5ib3JkZXJUb3BSaWdodFJhZGl1cyArIFwiOyBib3JkZXJCb3R0b21SaWdodFJhZGl1czogXCIgKyB0aGlzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzICsgXCI7IGJvcmRlckJvdHRvbUxlZnRSYWRpdXM6IFwiICsgdGhpcy5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzICsgXCI7IGNsaXBQYXRoOiBcIiArIHRoaXMuY2xpcFBhdGggKyBcIjtcIjtcbiAgICB9O1xuICAgIEJhY2tncm91bmQuZGVmYXVsdCA9IG5ldyBCYWNrZ3JvdW5kKCk7XG4gICAgcmV0dXJuIEJhY2tncm91bmQ7XG59KCkpO1xuZXhwb3J0cy5CYWNrZ3JvdW5kID0gQmFja2dyb3VuZDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhY2tncm91bmQtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGluZWFyX2dyYWRpZW50XzEgPSByZXF1aXJlKFwiLi9saW5lYXItZ3JhZGllbnRcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciBjc3NfdmFsdWVfMSA9IHJlcXVpcmUoXCIuLi8uLi9jc3MtdmFsdWVcIik7XG52YXIgZmlsZV9zeXN0ZW1fMSA9IHJlcXVpcmUoXCIuLi8uLi9maWxlLXN5c3RlbVwiKTtcbnZhciBhcHBsaWNhdGlvbiA9IHJlcXVpcmUoXCIuLi8uLi9hcHBsaWNhdGlvblwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9iYWNrZ3JvdW5kLWNvbW1vblwiKSk7XG52YXIgYWQ7XG4oZnVuY3Rpb24gKGFkKSB7XG4gICAgdmFyIFNESztcbiAgICBmdW5jdGlvbiBnZXRTREsoKSB7XG4gICAgICAgIGlmICghU0RLKSB7XG4gICAgICAgICAgICBTREsgPSBhbmRyb2lkLm9zLkJ1aWxkLlZFUlNJT04uU0RLX0lOVDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gU0RLO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpc1NldENvbG9yRmlsdGVyT25seVdpZGdldChuYXRpdmVWaWV3KSB7XG4gICAgICAgIHJldHVybiAobmF0aXZlVmlldyBpbnN0YW5jZW9mIGFuZHJvaWQud2lkZ2V0LkJ1dHRvbiB8fFxuICAgICAgICAgICAgKG5hdGl2ZVZpZXcgaW5zdGFuY2VvZiBhbmRyb2lkeC5hcHBjb21wYXQud2lkZ2V0LlRvb2xiYXJcbiAgICAgICAgICAgICAgICAmJiBnZXRTREsoKSA+PSAyMSkpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbkJhY2tncm91bmRPckJvcmRlclByb3BlcnR5Q2hhbmdlZCh2aWV3KSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAoIW5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHZpZXcuc3R5bGUuYmFja2dyb3VuZEludGVybmFsO1xuICAgICAgICB2YXIgZHJhd2FibGUgPSBuYXRpdmVWaWV3LmdldEJhY2tncm91bmQoKTtcbiAgICAgICAgdmFyIGFuZHJvaWRWaWV3ID0gdmlldztcbiAgICAgICAgaWYgKGFuZHJvaWRWaWV3Ll9jYWNoZWREcmF3YWJsZSA9PT0gdW5kZWZpbmVkICYmIGRyYXdhYmxlKSB7XG4gICAgICAgICAgICB2YXIgY29uc3RhbnRTdGF0ZSA9IGRyYXdhYmxlLmdldENvbnN0YW50U3RhdGUoKTtcbiAgICAgICAgICAgIGFuZHJvaWRWaWV3Ll9jYWNoZWREcmF3YWJsZSA9IGNvbnN0YW50U3RhdGUgfHwgZHJhd2FibGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzU2V0Q29sb3JGaWx0ZXJPbmx5V2lkZ2V0KG5hdGl2ZVZpZXcpXG4gICAgICAgICAgICAmJiBkcmF3YWJsZVxuICAgICAgICAgICAgJiYgIShkcmF3YWJsZSBpbnN0YW5jZW9mIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Cb3JkZXJEcmF3YWJsZSlcbiAgICAgICAgICAgICYmICFiYWNrZ3JvdW5kLmhhc0JvcmRlcldpZHRoKClcbiAgICAgICAgICAgICYmICFiYWNrZ3JvdW5kLmhhc0JvcmRlclJhZGl1cygpXG4gICAgICAgICAgICAmJiAhYmFja2dyb3VuZC5jbGlwUGF0aFxuICAgICAgICAgICAgJiYgIWJhY2tncm91bmQuaW1hZ2VcbiAgICAgICAgICAgICYmIGJhY2tncm91bmQuY29sb3IpIHtcbiAgICAgICAgICAgIHZhciBiYWNrZ3JvdW5kQ29sb3IgPSBkcmF3YWJsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kLmNvbG9yLmFuZHJvaWQ7XG4gICAgICAgICAgICBkcmF3YWJsZS5tdXRhdGUoKTtcbiAgICAgICAgICAgIGRyYXdhYmxlLnNldENvbG9yRmlsdGVyKGJhY2tncm91bmRDb2xvciwgYW5kcm9pZC5ncmFwaGljcy5Qb3J0ZXJEdWZmLk1vZGUuU1JDX0lOKTtcbiAgICAgICAgICAgIGRyYXdhYmxlLmludmFsaWRhdGVTZWxmKCk7XG4gICAgICAgICAgICBkcmF3YWJsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWJhY2tncm91bmQuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICB2YXIgYmFja2dyb3VuZERyYXdhYmxlID0gZHJhd2FibGU7XG4gICAgICAgICAgICBpZiAoIShkcmF3YWJsZSBpbnN0YW5jZW9mIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Cb3JkZXJEcmF3YWJsZSkpIHtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kRHJhd2FibGUgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkJvcmRlckRyYXdhYmxlKHV0aWxzXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCksIHZpZXcudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgcmVmcmVzaEJvcmRlckRyYXdhYmxlKHZpZXcsIGJhY2tncm91bmREcmF3YWJsZSk7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRCYWNrZ3JvdW5kKGJhY2tncm91bmREcmF3YWJsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWZyZXNoQm9yZGVyRHJhd2FibGUodmlldywgYmFja2dyb3VuZERyYXdhYmxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBjYWNoZWREcmF3YWJsZSA9IGFuZHJvaWRWaWV3Ll9jYWNoZWREcmF3YWJsZTtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0RHJhd2FibGUgPSB2b2lkIDA7XG4gICAgICAgICAgICBpZiAoY2FjaGVkRHJhd2FibGUgaW5zdGFuY2VvZiBhbmRyb2lkLmdyYXBoaWNzLmRyYXdhYmxlLkRyYXdhYmxlLkNvbnN0YW50U3RhdGUpIHtcbiAgICAgICAgICAgICAgICBkZWZhdWx0RHJhd2FibGUgPSBjYWNoZWREcmF3YWJsZS5uZXdEcmF3YWJsZShuYXRpdmVWaWV3LmdldFJlc291cmNlcygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNhY2hlZERyYXdhYmxlIGluc3RhbmNlb2YgYW5kcm9pZC5ncmFwaGljcy5kcmF3YWJsZS5EcmF3YWJsZSkge1xuICAgICAgICAgICAgICAgIGRlZmF1bHREcmF3YWJsZSA9IGNhY2hlZERyYXdhYmxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZGVmYXVsdERyYXdhYmxlID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0QmFja2dyb3VuZChkZWZhdWx0RHJhd2FibGUpO1xuICAgICAgICAgICAgYW5kcm9pZFZpZXcuX2NhY2hlZERyYXdhYmxlID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsZWZ0UGFkZGluZyA9IE1hdGguY2VpbCh2aWV3LmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCArIHZpZXcuZWZmZWN0aXZlUGFkZGluZ0xlZnQpO1xuICAgICAgICB2YXIgdG9wUGFkZGluZyA9IE1hdGguY2VpbCh2aWV3LmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoICsgdmlldy5lZmZlY3RpdmVQYWRkaW5nVG9wKTtcbiAgICAgICAgdmFyIHJpZ2h0UGFkZGluZyA9IE1hdGguY2VpbCh2aWV3LmVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGggKyB2aWV3LmVmZmVjdGl2ZVBhZGRpbmdSaWdodCk7XG4gICAgICAgIHZhciBib3R0b21QYWRkaW5nID0gTWF0aC5jZWlsKHZpZXcuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGggKyB2aWV3LmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20pO1xuICAgICAgICBuYXRpdmVWaWV3LnNldFBhZGRpbmcobGVmdFBhZGRpbmcsIHRvcFBhZGRpbmcsIHJpZ2h0UGFkZGluZywgYm90dG9tUGFkZGluZyk7XG4gICAgfVxuICAgIGFkLm9uQmFja2dyb3VuZE9yQm9yZGVyUHJvcGVydHlDaGFuZ2VkID0gb25CYWNrZ3JvdW5kT3JCb3JkZXJQcm9wZXJ0eUNoYW5nZWQ7XG59KShhZCA9IGV4cG9ydHMuYWQgfHwgKGV4cG9ydHMuYWQgPSB7fSkpO1xuZnVuY3Rpb24gZnJvbUJhc2U2NChzb3VyY2UpIHtcbiAgICB2YXIgYnl0ZXMgPSBhbmRyb2lkLnV0aWwuQmFzZTY0LmRlY29kZShzb3VyY2UsIGFuZHJvaWQudXRpbC5CYXNlNjQuREVGQVVMVCk7XG4gICAgcmV0dXJuIGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwRmFjdG9yeS5kZWNvZGVCeXRlQXJyYXkoYnl0ZXMsIDAsIGJ5dGVzLmxlbmd0aCk7XG59XG5mdW5jdGlvbiBmcm9tR3JhZGllbnQoZ3JhZGllbnQpIHtcbiAgICB2YXIgY29sb3JzID0gQXJyYXkuY3JlYXRlKFwiaW50XCIsIGdyYWRpZW50LmNvbG9yU3RvcHMubGVuZ3RoKTtcbiAgICB2YXIgc3RvcHMgPSBBcnJheS5jcmVhdGUoXCJmbG9hdFwiLCBncmFkaWVudC5jb2xvclN0b3BzLmxlbmd0aCk7XG4gICAgdmFyIGhhc1N0b3BzID0gZmFsc2U7XG4gICAgZ3JhZGllbnQuY29sb3JTdG9wcy5mb3JFYWNoKGZ1bmN0aW9uIChzdG9wLCBpbmRleCkge1xuICAgICAgICBjb2xvcnNbaW5kZXhdID0gc3RvcC5jb2xvci5hbmRyb2lkO1xuICAgICAgICBpZiAoc3RvcC5vZmZzZXQpIHtcbiAgICAgICAgICAgIHN0b3BzW2luZGV4XSA9IHN0b3Aub2Zmc2V0LnZhbHVlO1xuICAgICAgICAgICAgaGFzU3RvcHMgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgdmFyIGFscGhhID0gZ3JhZGllbnQuYW5nbGUgLyAoTWF0aC5QSSAqIDIpO1xuICAgIHZhciBzdGFydFggPSBNYXRoLnBvdyhNYXRoLnNpbihNYXRoLlBJICogKGFscGhhICsgMC43NSkpLCAyKTtcbiAgICB2YXIgc3RhcnRZID0gTWF0aC5wb3coTWF0aC5zaW4oTWF0aC5QSSAqIChhbHBoYSArIDAuNSkpLCAyKTtcbiAgICB2YXIgZW5kWCA9IE1hdGgucG93KE1hdGguc2luKE1hdGguUEkgKiAoYWxwaGEgKyAwLjI1KSksIDIpO1xuICAgIHZhciBlbmRZID0gTWF0aC5wb3coTWF0aC5zaW4oTWF0aC5QSSAqIGFscGhhKSwgMik7XG4gICAgcmV0dXJuIG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuTGluZWFyR3JhZGllbnREZWZpbml0aW9uKHN0YXJ0WCwgc3RhcnRZLCBlbmRYLCBlbmRZLCBjb2xvcnMsIGhhc1N0b3BzID8gc3RvcHMgOiBudWxsKTtcbn1cbnZhciBwYXR0ZXJuID0gL3VybFxcKCgnfFwiKSguKj8pXFwxXFwpLztcbmZ1bmN0aW9uIHJlZnJlc2hCb3JkZXJEcmF3YWJsZSh2aWV3LCBib3JkZXJEcmF3YWJsZSkge1xuICAgIHZhciBuYXRpdmVWaWV3ID0gdmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgIHZhciBjb250ZXh0ID0gbmF0aXZlVmlldy5nZXRDb250ZXh0KCk7XG4gICAgdmFyIGJhY2tncm91bmQgPSB2aWV3LnN0eWxlLmJhY2tncm91bmRJbnRlcm5hbDtcbiAgICBpZiAoYmFja2dyb3VuZCkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZFBvc2l0aW9uUGFyc2VkQ1NTVmFsdWVzID0gY3JlYXRlTmF0aXZlQ1NTVmFsdWVBcnJheShiYWNrZ3JvdW5kLnBvc2l0aW9uKTtcbiAgICAgICAgdmFyIGJhY2tncm91bmRTaXplUGFyc2VkQ1NTVmFsdWVzID0gY3JlYXRlTmF0aXZlQ1NTVmFsdWVBcnJheShiYWNrZ3JvdW5kLnNpemUpO1xuICAgICAgICB2YXIgYmxhY2tDb2xvciA9IC0xNjc3NzIxNjtcbiAgICAgICAgdmFyIGltYWdlVXJpID0gdm9pZCAwO1xuICAgICAgICBpZiAoYmFja2dyb3VuZC5pbWFnZSAmJiB0eXBlb2YgYmFja2dyb3VuZC5pbWFnZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgaW1hZ2VVcmkgPSBiYWNrZ3JvdW5kLmltYWdlO1xuICAgICAgICAgICAgdmFyIG1hdGNoID0gaW1hZ2VVcmkubWF0Y2gocGF0dGVybik7XG4gICAgICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMl0pIHtcbiAgICAgICAgICAgICAgICBpbWFnZVVyaSA9IG1hdGNoWzJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBiaXRtYXAgPSBudWxsO1xuICAgICAgICBpZiAodXRpbHNfMS5pc0RhdGFVUkkoaW1hZ2VVcmkpKSB7XG4gICAgICAgICAgICB2YXIgYmFzZTY0RGF0YSA9IGltYWdlVXJpLnNwbGl0KFwiLFwiKVsxXTtcbiAgICAgICAgICAgIGlmIChiYXNlNjREYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBiaXRtYXAgPSBmcm9tQmFzZTY0KGJhc2U2NERhdGEpO1xuICAgICAgICAgICAgICAgIGltYWdlVXJpID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh1dGlsc18xLmlzRmlsZU9yUmVzb3VyY2VQYXRoKGltYWdlVXJpKSkge1xuICAgICAgICAgICAgaWYgKGltYWdlVXJpLmluZGV4T2YodXRpbHNfMS5SRVNPVVJDRV9QUkVGSVgpICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpbGVOYW1lID0gaW1hZ2VVcmk7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGVOYW1lLmluZGV4T2YoXCJ+L1wiKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmaWxlTmFtZSA9IGZpbGVfc3lzdGVtXzEucGF0aC5qb2luKGZpbGVfc3lzdGVtXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoLCBmaWxlTmFtZS5yZXBsYWNlKFwifi9cIiwgXCJcIikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpbWFnZVVyaSA9IHV0aWxzXzEuRklMRV9QUkVGSVggKyBmaWxlTmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZ3JhZGllbnQgPSBudWxsO1xuICAgICAgICBpZiAoYmFja2dyb3VuZC5pbWFnZSAmJiBiYWNrZ3JvdW5kLmltYWdlIGluc3RhbmNlb2YgbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQpIHtcbiAgICAgICAgICAgIGdyYWRpZW50ID0gZnJvbUdyYWRpZW50KGJhY2tncm91bmQuaW1hZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGJvcmRlckRyYXdhYmxlLnJlZnJlc2goYmFja2dyb3VuZC5ib3JkZXJUb3BDb2xvciA/IGJhY2tncm91bmQuYm9yZGVyVG9wQ29sb3IuYW5kcm9pZCA6IGJsYWNrQ29sb3IsIGJhY2tncm91bmQuYm9yZGVyUmlnaHRDb2xvciA/IGJhY2tncm91bmQuYm9yZGVyUmlnaHRDb2xvci5hbmRyb2lkIDogYmxhY2tDb2xvciwgYmFja2dyb3VuZC5ib3JkZXJCb3R0b21Db2xvciA/IGJhY2tncm91bmQuYm9yZGVyQm90dG9tQ29sb3IuYW5kcm9pZCA6IGJsYWNrQ29sb3IsIGJhY2tncm91bmQuYm9yZGVyTGVmdENvbG9yID8gYmFja2dyb3VuZC5ib3JkZXJMZWZ0Q29sb3IuYW5kcm9pZCA6IGJsYWNrQ29sb3IsIGJhY2tncm91bmQuYm9yZGVyVG9wV2lkdGgsIGJhY2tncm91bmQuYm9yZGVyUmlnaHRXaWR0aCwgYmFja2dyb3VuZC5ib3JkZXJCb3R0b21XaWR0aCwgYmFja2dyb3VuZC5ib3JkZXJMZWZ0V2lkdGgsIGJhY2tncm91bmQuYm9yZGVyVG9wTGVmdFJhZGl1cywgYmFja2dyb3VuZC5ib3JkZXJUb3BSaWdodFJhZGl1cywgYmFja2dyb3VuZC5ib3JkZXJCb3R0b21SaWdodFJhZGl1cywgYmFja2dyb3VuZC5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzLCBiYWNrZ3JvdW5kLmNsaXBQYXRoLCBiYWNrZ3JvdW5kLmNvbG9yID8gYmFja2dyb3VuZC5jb2xvci5hbmRyb2lkIDogMCwgaW1hZ2VVcmksIGJpdG1hcCwgZ3JhZGllbnQsIGNvbnRleHQsIGJhY2tncm91bmQucmVwZWF0LCBiYWNrZ3JvdW5kLnBvc2l0aW9uLCBiYWNrZ3JvdW5kUG9zaXRpb25QYXJzZWRDU1NWYWx1ZXMsIGJhY2tncm91bmQuc2l6ZSwgYmFja2dyb3VuZFNpemVQYXJzZWRDU1NWYWx1ZXMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZU5hdGl2ZUNTU1ZhbHVlQXJyYXkoY3NzKSB7XG4gICAgaWYgKCFjc3MpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBjc3NWYWx1ZXMgPSBjc3NfdmFsdWVfMS5wYXJzZShjc3MpO1xuICAgIHZhciBuYXRpdmVBcnJheSA9IEFycmF5LmNyZWF0ZShvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ1NTVmFsdWUsIGNzc1ZhbHVlcy5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNzc1ZhbHVlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgIG5hdGl2ZUFycmF5W2ldID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5DU1NWYWx1ZShjc3NWYWx1ZXNbaV0udHlwZSwgY3NzVmFsdWVzW2ldLnN0cmluZywgY3NzVmFsdWVzW2ldLnVuaXQsIGNzc1ZhbHVlc1tpXS52YWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiBuYXRpdmVBcnJheTtcbn1cbnZhciBDYWNoZU1vZGU7XG4oZnVuY3Rpb24gKENhY2hlTW9kZSkge1xuICAgIENhY2hlTW9kZVtDYWNoZU1vZGVbXCJub25lXCJdID0gMF0gPSBcIm5vbmVcIjtcbiAgICBDYWNoZU1vZGVbQ2FjaGVNb2RlW1wibWVtb3J5XCJdID0gMV0gPSBcIm1lbW9yeVwiO1xuICAgIENhY2hlTW9kZVtDYWNoZU1vZGVbXCJkaXNrQW5kTWVtb3J5XCJdID0gMl0gPSBcImRpc2tBbmRNZW1vcnlcIjtcbn0pKENhY2hlTW9kZSA9IGV4cG9ydHMuQ2FjaGVNb2RlIHx8IChleHBvcnRzLkNhY2hlTW9kZSA9IHt9KSk7XG52YXIgY3VycmVudENhY2hlTW9kZTtcbnZhciBpbWFnZUZldGNoZXI7XG5mdW5jdGlvbiBpbml0SW1hZ2VDYWNoZShjb250ZXh0LCBtb2RlLCBtZW1vcnlDYWNoZVNpemUsIGRpc2tDYWNoZVNpemUpIHtcbiAgICBpZiAobW9kZSA9PT0gdm9pZCAwKSB7IG1vZGUgPSBDYWNoZU1vZGUuZGlza0FuZE1lbW9yeTsgfVxuICAgIGlmIChtZW1vcnlDYWNoZVNpemUgPT09IHZvaWQgMCkgeyBtZW1vcnlDYWNoZVNpemUgPSAwLjI1OyB9XG4gICAgaWYgKGRpc2tDYWNoZVNpemUgPT09IHZvaWQgMCkgeyBkaXNrQ2FjaGVTaXplID0gMTAgKiAxMDI0ICogMTAyNDsgfVxuICAgIGlmIChjdXJyZW50Q2FjaGVNb2RlID09PSBtb2RlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY3VycmVudENhY2hlTW9kZSA9IG1vZGU7XG4gICAgaWYgKCFpbWFnZUZldGNoZXIpIHtcbiAgICAgICAgaW1hZ2VGZXRjaGVyID0gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLmltYWdlLkZldGNoZXIuZ2V0SW5zdGFuY2UoY29udGV4dCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpbWFnZUZldGNoZXIuY2xlYXJDYWNoZSgpO1xuICAgIH1cbiAgICB2YXIgcGFyYW1zID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5pbWFnZS5DYWNoZS5DYWNoZVBhcmFtcygpO1xuICAgIHBhcmFtcy5tZW1vcnlDYWNoZUVuYWJsZWQgPSBtb2RlICE9PSBDYWNoZU1vZGUubm9uZTtcbiAgICBwYXJhbXMuc2V0TWVtQ2FjaGVTaXplUGVyY2VudChtZW1vcnlDYWNoZVNpemUpO1xuICAgIHBhcmFtcy5kaXNrQ2FjaGVFbmFibGVkID0gbW9kZSA9PT0gQ2FjaGVNb2RlLmRpc2tBbmRNZW1vcnk7XG4gICAgcGFyYW1zLmRpc2tDYWNoZVNpemUgPSBkaXNrQ2FjaGVTaXplO1xuICAgIHZhciBpbWFnZUNhY2hlID0gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLmltYWdlLkNhY2hlLmdldEluc3RhbmNlKHBhcmFtcyk7XG4gICAgaW1hZ2VGZXRjaGVyLmFkZEltYWdlQ2FjaGUoaW1hZ2VDYWNoZSk7XG4gICAgaW1hZ2VGZXRjaGVyLmluaXRDYWNoZSgpO1xufVxuZXhwb3J0cy5pbml0SW1hZ2VDYWNoZSA9IGluaXRJbWFnZUNhY2hlO1xuZnVuY3Rpb24gb25MaXZlc3luYyhhcmdzKSB7XG4gICAgaWYgKGltYWdlRmV0Y2hlcikge1xuICAgICAgICBpbWFnZUZldGNoZXIuY2xlYXJDYWNoZSgpO1xuICAgIH1cbn1cbmFwcGxpY2F0aW9uLm9uKFwibGl2ZXN5bmNcIiwgb25MaXZlc3luYyk7XG5hcHBsaWNhdGlvbi5hbmRyb2lkLm9uKFwiYWN0aXZpdHlTdGFydGVkXCIsIHByb2ZpbGluZ18xLnByb2ZpbGUoXCJpbml0SW1hZ2VDYWNoZVwiLCBmdW5jdGlvbiAoYXJncykge1xuICAgIGlmICghaW1hZ2VGZXRjaGVyKSB7XG4gICAgICAgIGluaXRJbWFnZUNhY2hlKGFyZ3MuYWN0aXZpdHkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaW1hZ2VGZXRjaGVyLmluaXRDYWNoZSgpO1xuICAgIH1cbn0pKTtcbmFwcGxpY2F0aW9uLmFuZHJvaWQub24oXCJhY3Rpdml0eVN0b3BwZWRcIiwgcHJvZmlsaW5nXzEucHJvZmlsZShcImNsb3NlSW1hZ2VDYWNoZVwiLCBmdW5jdGlvbiAoYXJncykge1xuICAgIGlmIChpbWFnZUZldGNoZXIpIHtcbiAgICAgICAgaW1hZ2VGZXRjaGVyLmNsb3NlQ2FjaGUoKTtcbiAgICB9XG59KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYWNrZ3JvdW5kLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGVudW1zXzEgPSByZXF1aXJlKFwiLi4vZW51bXNcIik7XG52YXIgU1RZTEVfQ1VSVkVfTUFQID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgXCJlYXNlXCI6IGVudW1zXzEuQW5pbWF0aW9uQ3VydmUuZWFzZSxcbiAgICBcImxpbmVhclwiOiBlbnVtc18xLkFuaW1hdGlvbkN1cnZlLmxpbmVhcixcbiAgICBcImVhc2UtaW5cIjogZW51bXNfMS5BbmltYXRpb25DdXJ2ZS5lYXNlSW4sXG4gICAgXCJlYXNlLW91dFwiOiBlbnVtc18xLkFuaW1hdGlvbkN1cnZlLmVhc2VPdXQsXG4gICAgXCJlYXNlLWluLW91dFwiOiBlbnVtc18xLkFuaW1hdGlvbkN1cnZlLmVhc2VJbk91dCxcbiAgICBcInNwcmluZ1wiOiBlbnVtc18xLkFuaW1hdGlvbkN1cnZlLnNwcmluZyxcbn0pO1xuZnVuY3Rpb24gdGltZUNvbnZlcnRlcih2YWx1ZSkge1xuICAgIHZhciByZXN1bHQgPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgICBpZiAodmFsdWUuaW5kZXhPZihcIm1zXCIpID09PSAtMSkge1xuICAgICAgICByZXN1bHQgPSByZXN1bHQgKiAxMDAwO1xuICAgIH1cbiAgICByZXR1cm4gTWF0aC5tYXgoMC4wLCByZXN1bHQpO1xufVxuZXhwb3J0cy50aW1lQ29udmVydGVyID0gdGltZUNvbnZlcnRlcjtcbmZ1bmN0aW9uIGFuaW1hdGlvblRpbWluZ0Z1bmN0aW9uQ29udmVydGVyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID9cbiAgICAgICAgU1RZTEVfQ1VSVkVfTUFQW3ZhbHVlXSB8fCBwYXJzZUN1YmljQmV6aWVyQ3VydmUodmFsdWUpIDpcbiAgICAgICAgZW51bXNfMS5BbmltYXRpb25DdXJ2ZS5lYXNlO1xufVxuZXhwb3J0cy5hbmltYXRpb25UaW1pbmdGdW5jdGlvbkNvbnZlcnRlciA9IGFuaW1hdGlvblRpbWluZ0Z1bmN0aW9uQ29udmVydGVyO1xuZnVuY3Rpb24gcGFyc2VDdWJpY0JlemllckN1cnZlKHZhbHVlKSB7XG4gICAgdmFyIGNvb3Jkc1N0cmluZyA9IC9cXCgoLio/KVxcKS8uZXhlYyh2YWx1ZSk7XG4gICAgdmFyIGNvb3JkcyA9IGNvb3Jkc1N0cmluZyAmJiBjb29yZHNTdHJpbmdbMV1cbiAgICAgICAgLnNwbGl0KFwiLFwiKVxuICAgICAgICAubWFwKHN0cmluZ1RvQmV6aWVDb29yZHMpO1xuICAgIGlmICh2YWx1ZS5zdGFydHNXaXRoKFwiY3ViaWMtYmV6aWVyXCIpICYmXG4gICAgICAgIGNvb3Jkc1N0cmluZyAmJlxuICAgICAgICBjb29yZHMubGVuZ3RoID09PSA0KSB7XG4gICAgICAgIHZhciBfYSA9IF9fc3ByZWFkQXJyYXlzKGNvb3JkcyksIHgxID0gX2FbMF0sIHgyID0gX2FbMV0sIHkxXzEgPSBfYVsyXSwgeTIgPSBfYVszXTtcbiAgICAgICAgcmV0dXJuIGVudW1zXzEuQW5pbWF0aW9uQ3VydmUuY3ViaWNCZXppZXIoeDEsIHgyLCB5MV8xLCB5Mik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZhbHVlIGZvciBhbmltYXRpb246IFwiICsgdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHN0cmluZ1RvQmV6aWVDb29yZHModmFsdWUpIHtcbiAgICB2YXIgcmVzdWx0ID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgaWYgKHJlc3VsdCA8IDApIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGVsc2UgaWYgKHJlc3VsdCA+IDEpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb252ZXJ0ZXJzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vY29yZS9wcm9wZXJ0aWVzXCIpO1xudmFyIGtleWZyYW1lX2FuaW1hdGlvbl8xID0gcmVxdWlyZShcIi4uL2FuaW1hdGlvbi9rZXlmcmFtZS1hbmltYXRpb25cIik7XG52YXIgY29udmVydGVyc18xID0gcmVxdWlyZShcIi4uL3N0eWxpbmcvY29udmVydGVyc1wiKTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIEFOSU1BVElPTl9QUk9QRVJUWV9IQU5ETEVSUyA9IE9iamVjdC5mcmVlemUoe1xuICAgIFwiYW5pbWF0aW9uLW5hbWVcIjogZnVuY3Rpb24gKGluZm8sIHZhbHVlKSB7IHJldHVybiBpbmZvLm5hbWUgPSB2YWx1ZTsgfSxcbiAgICBcImFuaW1hdGlvbi1kdXJhdGlvblwiOiBmdW5jdGlvbiAoaW5mbywgdmFsdWUpIHsgcmV0dXJuIGluZm8uZHVyYXRpb24gPSBjb252ZXJ0ZXJzXzEudGltZUNvbnZlcnRlcih2YWx1ZSk7IH0sXG4gICAgXCJhbmltYXRpb24tZGVsYXlcIjogZnVuY3Rpb24gKGluZm8sIHZhbHVlKSB7IHJldHVybiBpbmZvLmRlbGF5ID0gY29udmVydGVyc18xLnRpbWVDb252ZXJ0ZXIodmFsdWUpOyB9LFxuICAgIFwiYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvblwiOiBmdW5jdGlvbiAoaW5mbywgdmFsdWUpIHsgcmV0dXJuIGluZm8uY3VydmUgPSBjb252ZXJ0ZXJzXzEuYW5pbWF0aW9uVGltaW5nRnVuY3Rpb25Db252ZXJ0ZXIodmFsdWUpOyB9LFxuICAgIFwiYW5pbWF0aW9uLWl0ZXJhdGlvbi1jb3VudFwiOiBmdW5jdGlvbiAoaW5mbywgdmFsdWUpIHsgcmV0dXJuIGluZm8uaXRlcmF0aW9ucyA9IHZhbHVlID09PSBcImluZmluaXRlXCIgPyBOdW1iZXIuTUFYX1ZBTFVFIDogcGFyc2VGbG9hdCh2YWx1ZSk7IH0sXG4gICAgXCJhbmltYXRpb24tZGlyZWN0aW9uXCI6IGZ1bmN0aW9uIChpbmZvLCB2YWx1ZSkgeyByZXR1cm4gaW5mby5pc1JldmVyc2UgPSB2YWx1ZSA9PT0gXCJyZXZlcnNlXCI7IH0sXG4gICAgXCJhbmltYXRpb24tZmlsbC1tb2RlXCI6IGZ1bmN0aW9uIChpbmZvLCB2YWx1ZSkgeyByZXR1cm4gaW5mby5pc0ZvcndhcmRzID0gdmFsdWUgPT09IFwiZm9yd2FyZHNcIjsgfVxufSk7XG52YXIgQ3NzQW5pbWF0aW9uUGFyc2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDc3NBbmltYXRpb25QYXJzZXIoKSB7XG4gICAgfVxuICAgIENzc0FuaW1hdGlvblBhcnNlci5rZXlmcmFtZUFuaW1hdGlvbnNGcm9tQ1NTRGVjbGFyYXRpb25zID0gZnVuY3Rpb24gKGRlY2xhcmF0aW9ucykge1xuICAgICAgICBpZiAoZGVjbGFyYXRpb25zID09PSBudWxsIHx8IGRlY2xhcmF0aW9ucyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhbmltYXRpb25zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHZhciBhbmltYXRpb25JbmZvID0gdW5kZWZpbmVkO1xuICAgICAgICBkZWNsYXJhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0eSA9IF9hLnByb3BlcnR5LCB2YWx1ZSA9IF9hLnZhbHVlO1xuICAgICAgICAgICAgaWYgKHByb3BlcnR5ID09PSBcImFuaW1hdGlvblwiKSB7XG4gICAgICAgICAgICAgICAga2V5ZnJhbWVBbmltYXRpb25zRnJvbUNTU1Byb3BlcnR5KHZhbHVlLCBhbmltYXRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wZXJ0eUhhbmRsZXIgPSBBTklNQVRJT05fUFJPUEVSVFlfSEFORExFUlNbcHJvcGVydHldO1xuICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eUhhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbkluZm8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uSW5mbyA9IG5ldyBrZXlmcmFtZV9hbmltYXRpb25fMS5LZXlmcmFtZUFuaW1hdGlvbkluZm8oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbnMucHVzaChhbmltYXRpb25JbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUhhbmRsZXIoYW5pbWF0aW9uSW5mbywgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhbmltYXRpb25zLmxlbmd0aCA9PT0gMCA/IHVuZGVmaW5lZCA6IGFuaW1hdGlvbnM7XG4gICAgfTtcbiAgICBDc3NBbmltYXRpb25QYXJzZXIua2V5ZnJhbWVzQXJyYXlGcm9tQ1NTID0gZnVuY3Rpb24gKGtleWZyYW1lcykge1xuICAgICAgICB2YXIgcGFyc2VkS2V5ZnJhbWVzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwga2V5ZnJhbWVzXzEgPSBrZXlmcmFtZXM7IF9pIDwga2V5ZnJhbWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIga2V5ZnJhbWUgPSBrZXlmcmFtZXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgZGVjbGFyYXRpb25zID0gcGFyc2VLZXlmcmFtZURlY2xhcmF0aW9ucyhrZXlmcmFtZS5kZWNsYXJhdGlvbnMpO1xuICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBfYiA9IGtleWZyYW1lLnZhbHVlczsgX2EgPCBfYi5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGltZV8xID0gX2JbX2FdO1xuICAgICAgICAgICAgICAgIGlmICh0aW1lXzEgPT09IFwiZnJvbVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpbWVfMSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRpbWVfMSA9PT0gXCJ0b1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpbWVfMSA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aW1lXzEgPSBwYXJzZUZsb2F0KHRpbWVfMSkgLyAxMDA7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aW1lXzEgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lXzEgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aW1lXzEgPiAxMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVfMSA9IDEwMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudCA9IHBhcnNlZEtleWZyYW1lc1t0aW1lXzFdO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmR1cmF0aW9uID0gdGltZV8xO1xuICAgICAgICAgICAgICAgICAgICBwYXJzZWRLZXlmcmFtZXNbdGltZV8xXSA9IGN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9jID0gMCwgX2QgPSBrZXlmcmFtZS5kZWNsYXJhdGlvbnM7IF9jIDwgX2QubGVuZ3RoOyBfYysrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWNsYXJhdGlvbiA9IF9kW19jXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlY2xhcmF0aW9uLnByb3BlcnR5ID09PSBcImFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5jdXJ2ZSA9IGNvbnZlcnRlcnNfMS5hbmltYXRpb25UaW1pbmdGdW5jdGlvbkNvbnZlcnRlcihkZWNsYXJhdGlvbi52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY3VycmVudC5kZWNsYXJhdGlvbnMgPSBkZWNsYXJhdGlvbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFycmF5ID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAodmFyIHBhcnNlZEtleWZyYW1lIGluIHBhcnNlZEtleWZyYW1lcykge1xuICAgICAgICAgICAgYXJyYXkucHVzaChwYXJzZWRLZXlmcmFtZXNbcGFyc2VkS2V5ZnJhbWVdKTtcbiAgICAgICAgfVxuICAgICAgICBhcnJheS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLmR1cmF0aW9uIC0gYi5kdXJhdGlvbjsgfSk7XG4gICAgICAgIHJldHVybiBhcnJheTtcbiAgICB9O1xuICAgIHJldHVybiBDc3NBbmltYXRpb25QYXJzZXI7XG59KCkpO1xuZXhwb3J0cy5Dc3NBbmltYXRpb25QYXJzZXIgPSBDc3NBbmltYXRpb25QYXJzZXI7XG5mdW5jdGlvbiBrZXlmcmFtZUFuaW1hdGlvbnNGcm9tQ1NTUHJvcGVydHkodmFsdWUsIGFuaW1hdGlvbnMpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHZhciB2YWx1ZXMgPSB2YWx1ZS5zcGxpdCgvWyxdKy8pO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHZhbHVlc18xID0gdmFsdWVzOyBfaSA8IHZhbHVlc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHBhcnNlZFZhbHVlID0gdmFsdWVzXzFbX2ldO1xuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbkluZm8gPSBuZXcga2V5ZnJhbWVfYW5pbWF0aW9uXzEuS2V5ZnJhbWVBbmltYXRpb25JbmZvKCk7XG4gICAgICAgICAgICB2YXIgYXJyID0gcGFyc2VkVmFsdWUudHJpbSgpLnNwbGl0KC9bIF0rLyk7XG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25JbmZvLm5hbWUgPSBhcnJbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25JbmZvLmR1cmF0aW9uID0gY29udmVydGVyc18xLnRpbWVDb252ZXJ0ZXIoYXJyWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkluZm8uY3VydmUgPSBjb252ZXJ0ZXJzXzEuYW5pbWF0aW9uVGltaW5nRnVuY3Rpb25Db252ZXJ0ZXIoYXJyWzJdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gMykge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkluZm8uZGVsYXkgPSBjb252ZXJ0ZXJzXzEudGltZUNvbnZlcnRlcihhcnJbM10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPiA0KSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uSW5mby5pdGVyYXRpb25zID0gcGFyc2VJbnQoYXJyWzRdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gNSkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkluZm8uaXNSZXZlcnNlID0gYXJyWzRdID09PSBcInJldmVyc2VcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gNikge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkluZm8uaXNGb3J3YXJkcyA9IGFycls1XSA9PT0gXCJmb3J3YXJkc1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPiA3KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZSBmb3IgYW5pbWF0aW9uOiBcIiArIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFuaW1hdGlvbnMucHVzaChhbmltYXRpb25JbmZvKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHBhcnNlS2V5ZnJhbWVEZWNsYXJhdGlvbnModW5wYXJzZWRLZXlmcmFtZURlY2xhcmF0aW9ucykge1xuICAgIHZhciBkZWNsYXJhdGlvbnMgPSB1bnBhcnNlZEtleWZyYW1lRGVjbGFyYXRpb25zXG4gICAgICAgIC5yZWR1Y2UoZnVuY3Rpb24gKGRlY2xhcmF0aW9ucywgX2EpIHtcbiAgICAgICAgdmFyIHVucGFyc2VkUHJvcGVydHkgPSBfYS5wcm9wZXJ0eSwgdW5wYXJzZWRWYWx1ZSA9IF9hLnZhbHVlO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBwcm9wZXJ0aWVzXzEuQ3NzQW5pbWF0aW9uUHJvcGVydHkuX2dldEJ5Q3NzTmFtZSh1bnBhcnNlZFByb3BlcnR5KTtcbiAgICAgICAgaWYgKHR5cGVvZiB1bnBhcnNlZFByb3BlcnR5ID09PSBcInN0cmluZ1wiICYmIHByb3BlcnR5ICYmIHByb3BlcnR5Ll92YWx1ZUNvbnZlcnRlcikge1xuICAgICAgICAgICAgZGVjbGFyYXRpb25zW3Byb3BlcnR5Lm5hbWVdID0gcHJvcGVydHkuX3ZhbHVlQ29udmVydGVyKHVucGFyc2VkVmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB1bnBhcnNlZFZhbHVlID09PSBcInN0cmluZ1wiICYmIHVucGFyc2VkUHJvcGVydHkgPT09IFwidHJhbnNmb3JtXCIpIHtcbiAgICAgICAgICAgIHZhciB0cmFuc2Zvcm1hdGlvbnMgPSBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNmb3JtQ29udmVydGVyKHVucGFyc2VkVmFsdWUpO1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihkZWNsYXJhdGlvbnMsIHRyYW5zZm9ybWF0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlY2xhcmF0aW9ucztcbiAgICB9LCB7fSk7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKGRlY2xhcmF0aW9ucykubWFwKGZ1bmN0aW9uIChwcm9wZXJ0eSkgeyByZXR1cm4gKHsgcHJvcGVydHk6IHByb3BlcnR5LCB2YWx1ZTogZGVjbGFyYXRpb25zW3Byb3BlcnR5XSB9KTsgfSk7XG59XG5leHBvcnRzLnBhcnNlS2V5ZnJhbWVEZWNsYXJhdGlvbnMgPSBwYXJzZUtleWZyYW1lRGVjbGFyYXRpb25zO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y3NzLWFuaW1hdGlvbi1wYXJzZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHR5cGVzXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbHMvdHlwZXNcIik7XG52YXIgdXRpbHNfY29tbW9uXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbHMvdXRpbHMtY29tbW9uXCIpO1xudmFyIHBhcnNlciA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jc3MvcGFyc2VyXCIpO1xudmFyIE1hdGNoO1xuKGZ1bmN0aW9uIChNYXRjaCkge1xuICAgIE1hdGNoLkR5bmFtaWMgPSB0cnVlO1xuICAgIE1hdGNoLlN0YXRpYyA9IGZhbHNlO1xufSkoTWF0Y2ggfHwgKE1hdGNoID0ge30pKTtcbmZ1bmN0aW9uIGdldE5vZGVEaXJlY3RTaWJsaW5nKG5vZGUpIHtcbiAgICBpZiAoIW5vZGUucGFyZW50IHx8ICFub2RlLnBhcmVudC5nZXRDaGlsZEluZGV4IHx8ICFub2RlLnBhcmVudC5nZXRDaGlsZEF0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgbm9kZUluZGV4ID0gbm9kZS5wYXJlbnQuZ2V0Q2hpbGRJbmRleChub2RlKTtcbiAgICBpZiAobm9kZUluZGV4ID09PSAwKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gbm9kZS5wYXJlbnQuZ2V0Q2hpbGRBdChub2RlSW5kZXggLSAxKTtcbn1cbmZ1bmN0aW9uIFNlbGVjdG9yUHJvcGVydGllcyhzcGVjaWZpY2l0eSwgcmFyaXR5LCBkeW5hbWljKSB7XG4gICAgaWYgKGR5bmFtaWMgPT09IHZvaWQgMCkgeyBkeW5hbWljID0gZmFsc2U7IH1cbiAgICByZXR1cm4gZnVuY3Rpb24gKGNscykge1xuICAgICAgICBjbHMucHJvdG90eXBlLnNwZWNpZmljaXR5ID0gc3BlY2lmaWNpdHk7XG4gICAgICAgIGNscy5wcm90b3R5cGUucmFyaXR5ID0gcmFyaXR5O1xuICAgICAgICBjbHMucHJvdG90eXBlLmNvbWJpbmF0b3IgPSB1bmRlZmluZWQ7XG4gICAgICAgIGNscy5wcm90b3R5cGUuZHluYW1pYyA9IGR5bmFtaWM7XG4gICAgICAgIHJldHVybiBjbHM7XG4gICAgfTtcbn1cbnZhciBTZWxlY3RvckNvcmUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNlbGVjdG9yQ29yZSgpIHtcbiAgICB9XG4gICAgU2VsZWN0b3JDb3JlLnByb3RvdHlwZS5sb29rdXBTb3J0ID0gZnVuY3Rpb24gKHNvcnRlciwgYmFzZSkgeyBzb3J0ZXIuc29ydEFzVW5pdmVyc2FsKGJhc2UgfHwgdGhpcyk7IH07XG4gICAgU2VsZWN0b3JDb3JlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIFNlbGVjdG9yUHJvcGVydGllcygwLCAwLCBNYXRjaC5TdGF0aWMpXG4gICAgXSwgU2VsZWN0b3JDb3JlKTtcbiAgICByZXR1cm4gU2VsZWN0b3JDb3JlO1xufSgpKTtcbmV4cG9ydHMuU2VsZWN0b3JDb3JlID0gU2VsZWN0b3JDb3JlO1xudmFyIFNpbXBsZVNlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2ltcGxlU2VsZWN0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2ltcGxlU2VsZWN0b3IoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU2ltcGxlU2VsZWN0b3IucHJvdG90eXBlLmFjY3VtdWxhdGVDaGFuZ2VzID0gZnVuY3Rpb24gKG5vZGUsIG1hcCkge1xuICAgICAgICBpZiAoIXRoaXMuZHluYW1pYykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0Y2gobm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5tYXlNYXRjaChub2RlKSkge1xuICAgICAgICAgICAgdGhpcy50cmFja0NoYW5nZXMobm9kZSwgbWFwKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFNpbXBsZVNlbGVjdG9yLnByb3RvdHlwZS5tYXlNYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiB0aGlzLm1hdGNoKG5vZGUpOyB9O1xuICAgIFNpbXBsZVNlbGVjdG9yLnByb3RvdHlwZS50cmFja0NoYW5nZXMgPSBmdW5jdGlvbiAobm9kZSwgbWFwKSB7XG4gICAgfTtcbiAgICByZXR1cm4gU2ltcGxlU2VsZWN0b3I7XG59KFNlbGVjdG9yQ29yZSkpO1xuZXhwb3J0cy5TaW1wbGVTZWxlY3RvciA9IFNpbXBsZVNlbGVjdG9yO1xuZnVuY3Rpb24gd3JhcCh0ZXh0KSB7XG4gICAgcmV0dXJuIHRleHQgPyBcIiBcIiArIHRleHQgKyBcIiBcIiA6IFwiXCI7XG59XG52YXIgSW52YWxpZFNlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSW52YWxpZFNlbGVjdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEludmFsaWRTZWxlY3RvcihlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmUgPSBlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEludmFsaWRTZWxlY3Rvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcIjxlcnJvcjogXCIgKyB0aGlzLmUgKyBcIj5cIjsgfTtcbiAgICBJbnZhbGlkU2VsZWN0b3IucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIGZhbHNlOyB9O1xuICAgIEludmFsaWRTZWxlY3Rvci5wcm90b3R5cGUubG9va3VwU29ydCA9IGZ1bmN0aW9uIChzb3J0ZXIsIGJhc2UpIHtcbiAgICB9O1xuICAgIEludmFsaWRTZWxlY3RvciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBTZWxlY3RvclByb3BlcnRpZXMoMCwgNCwgTWF0Y2guU3RhdGljKVxuICAgIF0sIEludmFsaWRTZWxlY3Rvcik7XG4gICAgcmV0dXJuIEludmFsaWRTZWxlY3Rvcjtcbn0oU2ltcGxlU2VsZWN0b3IpKTtcbmV4cG9ydHMuSW52YWxpZFNlbGVjdG9yID0gSW52YWxpZFNlbGVjdG9yO1xudmFyIFVuaXZlcnNhbFNlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVW5pdmVyc2FsU2VsZWN0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVW5pdmVyc2FsU2VsZWN0b3IoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVW5pdmVyc2FsU2VsZWN0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gXCIqXCIgKyB3cmFwKHRoaXMuY29tYmluYXRvcik7IH07XG4gICAgVW5pdmVyc2FsU2VsZWN0b3IucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIHRydWU7IH07XG4gICAgVW5pdmVyc2FsU2VsZWN0b3IgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgU2VsZWN0b3JQcm9wZXJ0aWVzKDAsIDAsIE1hdGNoLlN0YXRpYylcbiAgICBdLCBVbml2ZXJzYWxTZWxlY3Rvcik7XG4gICAgcmV0dXJuIFVuaXZlcnNhbFNlbGVjdG9yO1xufShTaW1wbGVTZWxlY3RvcikpO1xuZXhwb3J0cy5Vbml2ZXJzYWxTZWxlY3RvciA9IFVuaXZlcnNhbFNlbGVjdG9yO1xudmFyIElkU2VsZWN0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJZFNlbGVjdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIElkU2VsZWN0b3IoaWQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuaWQgPSBpZDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBJZFNlbGVjdG9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiI1wiICsgdGhpcy5pZCArIHdyYXAodGhpcy5jb21iaW5hdG9yKTsgfTtcbiAgICBJZFNlbGVjdG9yLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBub2RlLmlkID09PSB0aGlzLmlkOyB9O1xuICAgIElkU2VsZWN0b3IucHJvdG90eXBlLmxvb2t1cFNvcnQgPSBmdW5jdGlvbiAoc29ydGVyLCBiYXNlKSB7IHNvcnRlci5zb3J0QnlJZCh0aGlzLmlkLCBiYXNlIHx8IHRoaXMpOyB9O1xuICAgIElkU2VsZWN0b3IgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgU2VsZWN0b3JQcm9wZXJ0aWVzKDY1NTM2LCAzLCBNYXRjaC5TdGF0aWMpXG4gICAgXSwgSWRTZWxlY3Rvcik7XG4gICAgcmV0dXJuIElkU2VsZWN0b3I7XG59KFNpbXBsZVNlbGVjdG9yKSk7XG5leHBvcnRzLklkU2VsZWN0b3IgPSBJZFNlbGVjdG9yO1xudmFyIFR5cGVTZWxlY3RvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFR5cGVTZWxlY3RvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUeXBlU2VsZWN0b3IoY3NzVHlwZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5jc3NUeXBlID0gY3NzVHlwZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBUeXBlU2VsZWN0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gXCJcIiArIHRoaXMuY3NzVHlwZSArIHdyYXAodGhpcy5jb21iaW5hdG9yKTsgfTtcbiAgICBUeXBlU2VsZWN0b3IucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIG5vZGUuY3NzVHlwZSA9PT0gdGhpcy5jc3NUeXBlOyB9O1xuICAgIFR5cGVTZWxlY3Rvci5wcm90b3R5cGUubG9va3VwU29ydCA9IGZ1bmN0aW9uIChzb3J0ZXIsIGJhc2UpIHsgc29ydGVyLnNvcnRCeVR5cGUodGhpcy5jc3NUeXBlLCBiYXNlIHx8IHRoaXMpOyB9O1xuICAgIFR5cGVTZWxlY3RvciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBTZWxlY3RvclByb3BlcnRpZXMoMSwgMSwgTWF0Y2guU3RhdGljKVxuICAgIF0sIFR5cGVTZWxlY3Rvcik7XG4gICAgcmV0dXJuIFR5cGVTZWxlY3Rvcjtcbn0oU2ltcGxlU2VsZWN0b3IpKTtcbmV4cG9ydHMuVHlwZVNlbGVjdG9yID0gVHlwZVNlbGVjdG9yO1xudmFyIENsYXNzU2VsZWN0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDbGFzc1NlbGVjdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENsYXNzU2VsZWN0b3IoY3NzQ2xhc3MpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuY3NzQ2xhc3MgPSBjc3NDbGFzcztcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBDbGFzc1NlbGVjdG9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiLlwiICsgdGhpcy5jc3NDbGFzcyArIHdyYXAodGhpcy5jb21iaW5hdG9yKTsgfTtcbiAgICBDbGFzc1NlbGVjdG9yLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBub2RlLmNzc0NsYXNzZXMgJiYgbm9kZS5jc3NDbGFzc2VzLmhhcyh0aGlzLmNzc0NsYXNzKTsgfTtcbiAgICBDbGFzc1NlbGVjdG9yLnByb3RvdHlwZS5sb29rdXBTb3J0ID0gZnVuY3Rpb24gKHNvcnRlciwgYmFzZSkgeyBzb3J0ZXIuc29ydEJ5Q2xhc3ModGhpcy5jc3NDbGFzcywgYmFzZSB8fCB0aGlzKTsgfTtcbiAgICBDbGFzc1NlbGVjdG9yID0gX19kZWNvcmF0ZShbXG4gICAgICAgIFNlbGVjdG9yUHJvcGVydGllcygyNTYsIDIsIE1hdGNoLlN0YXRpYylcbiAgICBdLCBDbGFzc1NlbGVjdG9yKTtcbiAgICByZXR1cm4gQ2xhc3NTZWxlY3Rvcjtcbn0oU2ltcGxlU2VsZWN0b3IpKTtcbmV4cG9ydHMuQ2xhc3NTZWxlY3RvciA9IENsYXNzU2VsZWN0b3I7XG52YXIgQXR0cmlidXRlU2VsZWN0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhBdHRyaWJ1dGVTZWxlY3RvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBdHRyaWJ1dGVTZWxlY3RvcihhdHRyaWJ1dGUsIHRlc3QsIHZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmF0dHJpYnV0ZSA9IGF0dHJpYnV0ZTtcbiAgICAgICAgX3RoaXMudGVzdCA9IHRlc3Q7XG4gICAgICAgIF90aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIGlmICghdGVzdCkge1xuICAgICAgICAgICAgX3RoaXMubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gIXR5cGVzXzEuaXNOdWxsT3JVbmRlZmluZWQobm9kZVthdHRyaWJ1dGVdKTsgfTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICBfdGhpcy5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBmYWxzZTsgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZXNjYXBlZFZhbHVlID0gdXRpbHNfY29tbW9uXzEuZXNjYXBlUmVnZXhTeW1ib2xzKHZhbHVlKTtcbiAgICAgICAgdmFyIHJlZ2V4cCA9IG51bGw7XG4gICAgICAgIHN3aXRjaCAodGVzdCkge1xuICAgICAgICAgICAgY2FzZSBcIl49XCI6XG4gICAgICAgICAgICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cChcIl5cIiArIGVzY2FwZWRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiJD1cIjpcbiAgICAgICAgICAgICAgICByZWdleHAgPSBuZXcgUmVnRXhwKGVzY2FwZWRWYWx1ZSArIFwiJFwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCIqPVwiOlxuICAgICAgICAgICAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoZXNjYXBlZFZhbHVlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCI9XCI6XG4gICAgICAgICAgICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cChcIl5cIiArIGVzY2FwZWRWYWx1ZSArIFwiJFwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ+PVwiOlxuICAgICAgICAgICAgICAgIGlmICgvXFxzLy50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBmYWxzZTsgfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZWdleHAgPSBuZXcgUmVnRXhwKFwiKF58XFxcXHMpXCIgKyBlc2NhcGVkVmFsdWUgKyBcIihcXFxcc3wkKVwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ8PVwiOlxuICAgICAgICAgICAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoXCJeXCIgKyBlc2NhcGVkVmFsdWUgKyBcIigtfCQpXCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZWdleHApIHtcbiAgICAgICAgICAgIF90aGlzLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIHJlZ2V4cC50ZXN0KG5vZGVbYXR0cmlidXRlXSArIFwiXCIpOyB9O1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgX3RoaXMubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gZmFsc2U7IH07XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgQXR0cmlidXRlU2VsZWN0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gXCJbXCIgKyB0aGlzLmF0dHJpYnV0ZSArIHdyYXAodGhpcy50ZXN0KSArICgodGhpcy50ZXN0ICYmIHRoaXMudmFsdWUpIHx8IFwiXCIpICsgXCJdXCIgKyB3cmFwKHRoaXMuY29tYmluYXRvcik7IH07XG4gICAgQXR0cmlidXRlU2VsZWN0b3IucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIGZhbHNlOyB9O1xuICAgIEF0dHJpYnV0ZVNlbGVjdG9yLnByb3RvdHlwZS5tYXlNYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiB0cnVlOyB9O1xuICAgIEF0dHJpYnV0ZVNlbGVjdG9yLnByb3RvdHlwZS50cmFja0NoYW5nZXMgPSBmdW5jdGlvbiAobm9kZSwgbWFwKSB7IG1hcC5hZGRBdHRyaWJ1dGUobm9kZSwgdGhpcy5hdHRyaWJ1dGUpOyB9O1xuICAgIEF0dHJpYnV0ZVNlbGVjdG9yID0gX19kZWNvcmF0ZShbXG4gICAgICAgIFNlbGVjdG9yUHJvcGVydGllcygyNTYsIDAsIE1hdGNoLkR5bmFtaWMpXG4gICAgXSwgQXR0cmlidXRlU2VsZWN0b3IpO1xuICAgIHJldHVybiBBdHRyaWJ1dGVTZWxlY3Rvcjtcbn0oU2ltcGxlU2VsZWN0b3IpKTtcbmV4cG9ydHMuQXR0cmlidXRlU2VsZWN0b3IgPSBBdHRyaWJ1dGVTZWxlY3RvcjtcbnZhciBQc2V1ZG9DbGFzc1NlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUHNldWRvQ2xhc3NTZWxlY3RvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQc2V1ZG9DbGFzc1NlbGVjdG9yKGNzc1BzZXVkb0NsYXNzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNzc1BzZXVkb0NsYXNzID0gY3NzUHNldWRvQ2xhc3M7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgUHNldWRvQ2xhc3NTZWxlY3Rvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcIjpcIiArIHRoaXMuY3NzUHNldWRvQ2xhc3MgKyB3cmFwKHRoaXMuY29tYmluYXRvcik7IH07XG4gICAgUHNldWRvQ2xhc3NTZWxlY3Rvci5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gbm9kZS5jc3NQc2V1ZG9DbGFzc2VzICYmIG5vZGUuY3NzUHNldWRvQ2xhc3Nlcy5oYXModGhpcy5jc3NQc2V1ZG9DbGFzcyk7IH07XG4gICAgUHNldWRvQ2xhc3NTZWxlY3Rvci5wcm90b3R5cGUubWF5TWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gdHJ1ZTsgfTtcbiAgICBQc2V1ZG9DbGFzc1NlbGVjdG9yLnByb3RvdHlwZS50cmFja0NoYW5nZXMgPSBmdW5jdGlvbiAobm9kZSwgbWFwKSB7IG1hcC5hZGRQc2V1ZG9DbGFzcyhub2RlLCB0aGlzLmNzc1BzZXVkb0NsYXNzKTsgfTtcbiAgICBQc2V1ZG9DbGFzc1NlbGVjdG9yID0gX19kZWNvcmF0ZShbXG4gICAgICAgIFNlbGVjdG9yUHJvcGVydGllcygyNTYsIDAsIE1hdGNoLkR5bmFtaWMpXG4gICAgXSwgUHNldWRvQ2xhc3NTZWxlY3Rvcik7XG4gICAgcmV0dXJuIFBzZXVkb0NsYXNzU2VsZWN0b3I7XG59KFNpbXBsZVNlbGVjdG9yKSk7XG5leHBvcnRzLlBzZXVkb0NsYXNzU2VsZWN0b3IgPSBQc2V1ZG9DbGFzc1NlbGVjdG9yO1xudmFyIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTaW1wbGVTZWxlY3RvclNlcXVlbmNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2Uoc2VsZWN0b3JzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnNlbGVjdG9ycyA9IHNlbGVjdG9ycztcbiAgICAgICAgX3RoaXMuc3BlY2lmaWNpdHkgPSBzZWxlY3RvcnMucmVkdWNlKGZ1bmN0aW9uIChzdW0sIHNlbCkgeyByZXR1cm4gc2VsLnNwZWNpZmljaXR5ICsgc3VtOyB9LCAwKTtcbiAgICAgICAgX3RoaXMuaGVhZCA9IF90aGlzLnNlbGVjdG9ycy5yZWR1Y2UoZnVuY3Rpb24gKHByZXYsIGN1cnIpIHsgcmV0dXJuICFwcmV2IHx8IChjdXJyLnJhcml0eSA+IHByZXYucmFyaXR5KSA/IGN1cnIgOiBwcmV2OyB9LCBudWxsKTtcbiAgICAgICAgX3RoaXMuZHluYW1pYyA9IHNlbGVjdG9ycy5zb21lKGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5keW5hbWljOyB9KTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTaW1wbGVTZWxlY3RvclNlcXVlbmNlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiXCIgKyB0aGlzLnNlbGVjdG9ycy5qb2luKFwiXCIpICsgd3JhcCh0aGlzLmNvbWJpbmF0b3IpOyB9O1xuICAgIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2UucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIHRoaXMuc2VsZWN0b3JzLmV2ZXJ5KGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5tYXRjaChub2RlKTsgfSk7IH07XG4gICAgU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZS5wcm90b3R5cGUubWF5TWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RvcnMuZXZlcnkoZnVuY3Rpb24gKHNlbCkgeyByZXR1cm4gc2VsLm1heU1hdGNoKG5vZGUpOyB9KTtcbiAgICB9O1xuICAgIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2UucHJvdG90eXBlLnRyYWNrQ2hhbmdlcyA9IGZ1bmN0aW9uIChub2RlLCBtYXApIHtcbiAgICAgICAgdGhpcy5zZWxlY3RvcnMuZm9yRWFjaChmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwudHJhY2tDaGFuZ2VzKG5vZGUsIG1hcCk7IH0pO1xuICAgIH07XG4gICAgU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZS5wcm90b3R5cGUubG9va3VwU29ydCA9IGZ1bmN0aW9uIChzb3J0ZXIsIGJhc2UpIHtcbiAgICAgICAgdGhpcy5oZWFkLmxvb2t1cFNvcnQoc29ydGVyLCBiYXNlIHx8IHRoaXMpO1xuICAgIH07XG4gICAgcmV0dXJuIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2U7XG59KFNpbXBsZVNlbGVjdG9yKSk7XG5leHBvcnRzLlNpbXBsZVNlbGVjdG9yU2VxdWVuY2UgPSBTaW1wbGVTZWxlY3RvclNlcXVlbmNlO1xudmFyIFNlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2VsZWN0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2VsZWN0b3Ioc2VsZWN0b3JzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnNlbGVjdG9ycyA9IHNlbGVjdG9ycztcbiAgICAgICAgdmFyIHN1cHBvcnRlZENvbWJpbmF0b3IgPSBbdW5kZWZpbmVkLCBcIiBcIiwgXCI+XCIsIFwiK1wiXTtcbiAgICAgICAgdmFyIHNpYmxpbmdHcm91cDtcbiAgICAgICAgdmFyIGxhc3RHcm91cDtcbiAgICAgICAgdmFyIGdyb3VwcyA9IFtdO1xuICAgICAgICBzZWxlY3RvcnMucmV2ZXJzZSgpLmZvckVhY2goZnVuY3Rpb24gKHNlbCkge1xuICAgICAgICAgICAgaWYgKHN1cHBvcnRlZENvbWJpbmF0b3IuaW5kZXhPZihzZWwuY29tYmluYXRvcikgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5zdXBwb3J0ZWQgY29tYmluYXRvciBcXFwiXCIgKyBzZWwuY29tYmluYXRvciArIFwiXFxcIi5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsLmNvbWJpbmF0b3IgPT09IHVuZGVmaW5lZCB8fCBzZWwuY29tYmluYXRvciA9PT0gXCIgXCIpIHtcbiAgICAgICAgICAgICAgICBncm91cHMucHVzaChsYXN0R3JvdXAgPSBbc2libGluZ0dyb3VwID0gW11dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWwuY29tYmluYXRvciA9PT0gXCI+XCIpIHtcbiAgICAgICAgICAgICAgICBsYXN0R3JvdXAucHVzaChzaWJsaW5nR3JvdXAgPSBbXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzaWJsaW5nR3JvdXAucHVzaChzZWwpO1xuICAgICAgICB9KTtcbiAgICAgICAgX3RoaXMuZ3JvdXBzID0gZ3JvdXBzLm1hcChmdW5jdGlvbiAoZykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBTZWxlY3Rvci5DaGlsZEdyb3VwKGcubWFwKGZ1bmN0aW9uIChzZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2VsZWN0b3IuU2libGluZ0dyb3VwKHNnKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSk7XG4gICAgICAgIF90aGlzLmxhc3QgPSBzZWxlY3RvcnNbMF07XG4gICAgICAgIF90aGlzLnNwZWNpZmljaXR5ID0gc2VsZWN0b3JzLnJlZHVjZShmdW5jdGlvbiAoc3VtLCBzZWwpIHsgcmV0dXJuIHNlbC5zcGVjaWZpY2l0eSArIHN1bTsgfSwgMCk7XG4gICAgICAgIF90aGlzLmR5bmFtaWMgPSBzZWxlY3RvcnMuc29tZShmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwuZHluYW1pYzsgfSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU2VsZWN0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5zZWxlY3RvcnMuam9pbihcIlwiKTsgfTtcbiAgICBTZWxlY3Rvci5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5ncm91cHMuZXZlcnkoZnVuY3Rpb24gKGdyb3VwLCBpKSB7XG4gICAgICAgICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIG5vZGUgPSBncm91cC5tYXRjaChub2RlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gISFub2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9yID0gbm9kZTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUgPSBncm91cC5tYXRjaChhbmNlc3RvcikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBTZWxlY3Rvci5wcm90b3R5cGUubG9va3VwU29ydCA9IGZ1bmN0aW9uIChzb3J0ZXIsIGJhc2UpIHtcbiAgICAgICAgdGhpcy5sYXN0Lmxvb2t1cFNvcnQoc29ydGVyLCB0aGlzKTtcbiAgICB9O1xuICAgIFNlbGVjdG9yLnByb3RvdHlwZS5hY2N1bXVsYXRlQ2hhbmdlcyA9IGZ1bmN0aW9uIChub2RlLCBtYXApIHtcbiAgICAgICAgaWYgKCF0aGlzLmR5bmFtaWMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1hdGNoKG5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBib3VuZHMgPSBbXTtcbiAgICAgICAgdmFyIG1heU1hdGNoID0gdGhpcy5ncm91cHMuZXZlcnkoZnVuY3Rpb24gKGdyb3VwLCBpKSB7XG4gICAgICAgICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHZhciBuZXh0Tm9kZSA9IGdyb3VwLm1heU1hdGNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIGJvdW5kcy5wdXNoKHsgbGVmdDogbm9kZSwgcmlnaHQ6IG5vZGUgfSk7XG4gICAgICAgICAgICAgICAgbm9kZSA9IG5leHROb2RlO1xuICAgICAgICAgICAgICAgIHJldHVybiAhIW5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3IgPSBub2RlO1xuICAgICAgICAgICAgICAgIHdoaWxlIChhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dE5vZGUgPSBncm91cC5tYXlNYXRjaChhbmNlc3Rvcik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXh0Tm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYm91bmRzLnB1c2goeyBsZWZ0OiBhbmNlc3RvciwgcmlnaHQ6IG51bGwgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gbmV4dE5vZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIW1heU1hdGNoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFtYXApIHtcbiAgICAgICAgICAgIHJldHVybiBtYXlNYXRjaDtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZ3JvdXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZ3JvdXBfMSA9IHRoaXMuZ3JvdXBzW2ldO1xuICAgICAgICAgICAgaWYgKCFncm91cF8xLmR5bmFtaWMpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBib3VuZCA9IGJvdW5kc1tpXTtcbiAgICAgICAgICAgIHZhciBub2RlXzEgPSBib3VuZC5sZWZ0O1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGlmIChncm91cF8xLm1heU1hdGNoKG5vZGVfMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBfMS50cmFja0NoYW5nZXMobm9kZV8xLCBtYXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKChub2RlXzEgIT09IGJvdW5kLnJpZ2h0KSAmJiAobm9kZV8xID0gbm9kZV8xLnBhcmVudCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtYXlNYXRjaDtcbiAgICB9O1xuICAgIHJldHVybiBTZWxlY3Rvcjtcbn0oU2VsZWN0b3JDb3JlKSk7XG5leHBvcnRzLlNlbGVjdG9yID0gU2VsZWN0b3I7XG4oZnVuY3Rpb24gKFNlbGVjdG9yKSB7XG4gICAgdmFyIENoaWxkR3JvdXAgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBDaGlsZEdyb3VwKHNlbGVjdG9ycykge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XG4gICAgICAgICAgICB0aGlzLmR5bmFtaWMgPSBzZWxlY3RvcnMuc29tZShmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwuZHluYW1pYzsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgQ2hpbGRHcm91cC5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0b3JzLmV2ZXJ5KGZ1bmN0aW9uIChzZWwsIGkpIHsgcmV0dXJuIChpID09PSAwID8gbm9kZSA6IG5vZGUgPSBub2RlLnBhcmVudCkgJiYgISFzZWwubWF0Y2gobm9kZSk7IH0pID8gbm9kZSA6IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIENoaWxkR3JvdXAucHJvdG90eXBlLm1heU1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdG9ycy5ldmVyeShmdW5jdGlvbiAoc2VsLCBpKSB7IHJldHVybiAoaSA9PT0gMCA/IG5vZGUgOiBub2RlID0gbm9kZS5wYXJlbnQpICYmICEhc2VsLm1heU1hdGNoKG5vZGUpOyB9KSA/IG5vZGUgOiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBDaGlsZEdyb3VwLnByb3RvdHlwZS50cmFja0NoYW5nZXMgPSBmdW5jdGlvbiAobm9kZSwgbWFwKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChzZWwsIGkpIHsgcmV0dXJuIChpID09PSAwID8gbm9kZSA6IG5vZGUgPSBub2RlLnBhcmVudCkgJiYgc2VsLnRyYWNrQ2hhbmdlcyhub2RlLCBtYXApOyB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIENoaWxkR3JvdXA7XG4gICAgfSgpKTtcbiAgICBTZWxlY3Rvci5DaGlsZEdyb3VwID0gQ2hpbGRHcm91cDtcbiAgICB2YXIgU2libGluZ0dyb3VwID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gU2libGluZ0dyb3VwKHNlbGVjdG9ycykge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XG4gICAgICAgICAgICB0aGlzLmR5bmFtaWMgPSBzZWxlY3RvcnMuc29tZShmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwuZHluYW1pYzsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgU2libGluZ0dyb3VwLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RvcnMuZXZlcnkoZnVuY3Rpb24gKHNlbCwgaSkgeyByZXR1cm4gKGkgPT09IDAgPyBub2RlIDogbm9kZSA9IGdldE5vZGVEaXJlY3RTaWJsaW5nKG5vZGUpKSAmJiBzZWwubWF0Y2gobm9kZSk7IH0pID8gbm9kZSA6IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIFNpYmxpbmdHcm91cC5wcm90b3R5cGUubWF5TWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0b3JzLmV2ZXJ5KGZ1bmN0aW9uIChzZWwsIGkpIHsgcmV0dXJuIChpID09PSAwID8gbm9kZSA6IG5vZGUgPSBnZXROb2RlRGlyZWN0U2libGluZyhub2RlKSkgJiYgc2VsLm1heU1hdGNoKG5vZGUpOyB9KSA/IG5vZGUgOiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBTaWJsaW5nR3JvdXAucHJvdG90eXBlLnRyYWNrQ2hhbmdlcyA9IGZ1bmN0aW9uIChub2RlLCBtYXApIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24gKHNlbCwgaSkgeyByZXR1cm4gKGkgPT09IDAgPyBub2RlIDogbm9kZSA9IGdldE5vZGVEaXJlY3RTaWJsaW5nKG5vZGUpKSAmJiBzZWwudHJhY2tDaGFuZ2VzKG5vZGUsIG1hcCk7IH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gU2libGluZ0dyb3VwO1xuICAgIH0oKSk7XG4gICAgU2VsZWN0b3IuU2libGluZ0dyb3VwID0gU2libGluZ0dyb3VwO1xufSkoU2VsZWN0b3IgPSBleHBvcnRzLlNlbGVjdG9yIHx8IChleHBvcnRzLlNlbGVjdG9yID0ge30pKTtcbmV4cG9ydHMuU2VsZWN0b3IgPSBTZWxlY3RvcjtcbnZhciBSdWxlU2V0ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSdWxlU2V0KHNlbGVjdG9ycywgZGVjbGFyYXRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc2VsZWN0b3JzID0gc2VsZWN0b3JzO1xuICAgICAgICB0aGlzLmRlY2xhcmF0aW9ucyA9IGRlY2xhcmF0aW9ucztcbiAgICAgICAgdGhpcy5zZWxlY3RvcnMuZm9yRWFjaChmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwucnVsZXNldCA9IF90aGlzOyB9KTtcbiAgICB9XG4gICAgUnVsZVNldC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLnNlbGVjdG9ycy5qb2luKFwiLCBcIikgKyBcIiB7XCIgKyB0aGlzLmRlY2xhcmF0aW9ucy5tYXAoZnVuY3Rpb24gKGQsIGkpIHsgcmV0dXJuIFwiXCIgKyAoaSA9PT0gMCA/IFwiIFwiIDogXCJcIikgKyBkLnByb3BlcnR5ICsgXCI6IFwiICsgZC52YWx1ZTsgfSkuam9pbihcIjsgXCIpICsgXCIgfVwiOyB9O1xuICAgIFJ1bGVTZXQucHJvdG90eXBlLmxvb2t1cFNvcnQgPSBmdW5jdGlvbiAoc29ydGVyKSB7IHRoaXMuc2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24gKHNlbCkgeyByZXR1cm4gc2VsLmxvb2t1cFNvcnQoc29ydGVyKTsgfSk7IH07XG4gICAgcmV0dXJuIFJ1bGVTZXQ7XG59KCkpO1xuZXhwb3J0cy5SdWxlU2V0ID0gUnVsZVNldDtcbmZ1bmN0aW9uIGZyb21Bc3ROb2Rlcyhhc3RSdWxlcykge1xuICAgIHJldHVybiBhc3RSdWxlcy5maWx0ZXIoaXNSdWxlKS5tYXAoZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgdmFyIGRlY2xhcmF0aW9ucyA9IHJ1bGUuZGVjbGFyYXRpb25zLmZpbHRlcihpc0RlY2xhcmF0aW9uKS5tYXAoY3JlYXRlRGVjbGFyYXRpb24pO1xuICAgICAgICB2YXIgc2VsZWN0b3JzID0gcnVsZS5zZWxlY3RvcnMubWFwKGNyZWF0ZVNlbGVjdG9yKTtcbiAgICAgICAgdmFyIHJ1bGVzZXQgPSBuZXcgUnVsZVNldChzZWxlY3RvcnMsIGRlY2xhcmF0aW9ucyk7XG4gICAgICAgIHJldHVybiBydWxlc2V0O1xuICAgIH0pO1xufVxuZXhwb3J0cy5mcm9tQXN0Tm9kZXMgPSBmcm9tQXN0Tm9kZXM7XG5mdW5jdGlvbiBjcmVhdGVEZWNsYXJhdGlvbihkZWNsKSB7XG4gICAgcmV0dXJuIHsgcHJvcGVydHk6IGRlY2wucHJvcGVydHkudG9Mb3dlckNhc2UoKSwgdmFsdWU6IGRlY2wudmFsdWUgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZVNpbXBsZVNlbGVjdG9yRnJvbUFzdChhc3QpIHtcbiAgICBzd2l0Y2ggKGFzdC50eXBlKSB7XG4gICAgICAgIGNhc2UgXCIqXCI6IHJldHVybiBuZXcgVW5pdmVyc2FsU2VsZWN0b3IoKTtcbiAgICAgICAgY2FzZSBcIiNcIjogcmV0dXJuIG5ldyBJZFNlbGVjdG9yKGFzdC5pZGVudGlmaWVyKTtcbiAgICAgICAgY2FzZSBcIlwiOiByZXR1cm4gbmV3IFR5cGVTZWxlY3Rvcihhc3QuaWRlbnRpZmllci5yZXBsYWNlKC8tLywgXCJcIikudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIGNhc2UgXCIuXCI6IHJldHVybiBuZXcgQ2xhc3NTZWxlY3Rvcihhc3QuaWRlbnRpZmllcik7XG4gICAgICAgIGNhc2UgXCI6XCI6IHJldHVybiBuZXcgUHNldWRvQ2xhc3NTZWxlY3Rvcihhc3QuaWRlbnRpZmllcik7XG4gICAgICAgIGNhc2UgXCJbXVwiOiByZXR1cm4gYXN0LnRlc3QgPyBuZXcgQXR0cmlidXRlU2VsZWN0b3IoYXN0LnByb3BlcnR5LCBhc3QudGVzdCwgYXN0LnZhbHVlKSA6IG5ldyBBdHRyaWJ1dGVTZWxlY3Rvcihhc3QucHJvcGVydHkpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZVNpbXBsZVNlbGVjdG9yU2VxdWVuY2VGcm9tQXN0KGFzdCkge1xuICAgIGlmIChhc3QubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW52YWxpZFNlbGVjdG9yKG5ldyBFcnJvcihcIkVtcHR5IHNpbXBsZSBzZWxlY3RvciBzZXF1ZW5jZS5cIikpO1xuICAgIH1cbiAgICBlbHNlIGlmIChhc3QubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVTaW1wbGVTZWxlY3RvckZyb21Bc3QoYXN0WzBdKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZShhc3QubWFwKGNyZWF0ZVNpbXBsZVNlbGVjdG9yRnJvbUFzdCkpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZVNlbGVjdG9yRnJvbUFzdChhc3QpIHtcbiAgICBpZiAoYXN0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gbmV3IEludmFsaWRTZWxlY3RvcihuZXcgRXJyb3IoXCJFbXB0eSBzZWxlY3Rvci5cIikpO1xuICAgIH1cbiAgICBlbHNlIGlmIChhc3QubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVTaW1wbGVTZWxlY3RvclNlcXVlbmNlRnJvbUFzdChhc3RbMF1bMF0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHNpbXBsZVNlbGVjdG9yU2VxdWVuY2VzID0gW107XG4gICAgICAgIHZhciBzaW1wbGVTZWxlY3RvclNlcXVlbmNlID0gdm9pZCAwO1xuICAgICAgICB2YXIgY29tYmluYXRvciA9IHZvaWQgMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHNpbXBsZVNlbGVjdG9yU2VxdWVuY2UgPSBjcmVhdGVTaW1wbGVTZWxlY3RvclNlcXVlbmNlRnJvbUFzdChhc3RbaV1bMF0pO1xuICAgICAgICAgICAgY29tYmluYXRvciA9IGFzdFtpXVsxXTtcbiAgICAgICAgICAgIGlmIChjb21iaW5hdG9yKSB7XG4gICAgICAgICAgICAgICAgc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZS5jb21iaW5hdG9yID0gY29tYmluYXRvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNpbXBsZVNlbGVjdG9yU2VxdWVuY2VzLnB1c2goc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBTZWxlY3RvcihzaW1wbGVTZWxlY3RvclNlcXVlbmNlcyk7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlU2VsZWN0b3Ioc2VsKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIHBhcnNlZFNlbGVjdG9yID0gcGFyc2VyLnBhcnNlU2VsZWN0b3Ioc2VsKTtcbiAgICAgICAgaWYgKCFwYXJzZWRTZWxlY3Rvcikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBJbnZhbGlkU2VsZWN0b3IobmV3IEVycm9yKFwiRW1wdHkgc2VsZWN0b3JcIikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjcmVhdGVTZWxlY3RvckZyb21Bc3QocGFyc2VkU2VsZWN0b3IudmFsdWUpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gbmV3IEludmFsaWRTZWxlY3RvcihlKTtcbiAgICB9XG59XG5leHBvcnRzLmNyZWF0ZVNlbGVjdG9yID0gY3JlYXRlU2VsZWN0b3I7XG5mdW5jdGlvbiBpc1J1bGUobm9kZSkge1xuICAgIHJldHVybiBub2RlLnR5cGUgPT09IFwicnVsZVwiO1xufVxuZnVuY3Rpb24gaXNEZWNsYXJhdGlvbihub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUudHlwZSA9PT0gXCJkZWNsYXJhdGlvblwiO1xufVxudmFyIFNlbGVjdG9yc01hcCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2VsZWN0b3JzTWFwKHJ1bGVzZXRzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuaWQgPSB7fTtcbiAgICAgICAgdGhpcy5jbGFzcyA9IHt9O1xuICAgICAgICB0aGlzLnR5cGUgPSB7fTtcbiAgICAgICAgdGhpcy51bml2ZXJzYWwgPSBbXTtcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IDA7XG4gICAgICAgIHJ1bGVzZXRzLmZvckVhY2goZnVuY3Rpb24gKHJ1bGUpIHsgcmV0dXJuIHJ1bGUubG9va3VwU29ydChfdGhpcyk7IH0pO1xuICAgIH1cbiAgICBTZWxlY3RvcnNNYXAucHJvdG90eXBlLnF1ZXJ5ID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHNlbGVjdG9yQ2xhc3NlcyA9IFtcbiAgICAgICAgICAgIHRoaXMudW5pdmVyc2FsLFxuICAgICAgICAgICAgdGhpcy5pZFtub2RlLmlkXSxcbiAgICAgICAgICAgIHRoaXMudHlwZVtub2RlLmNzc1R5cGVdXG4gICAgICAgIF07XG4gICAgICAgIGlmIChub2RlLmNzc0NsYXNzZXMpIHtcbiAgICAgICAgICAgIG5vZGUuY3NzQ2xhc3Nlcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7IHJldHVybiBzZWxlY3RvckNsYXNzZXMucHVzaChfdGhpcy5jbGFzc1tjXSk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZWxlY3RvcnMgPSBzZWxlY3RvckNsYXNzZXNcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGFycikgeyByZXR1cm4gISFhcnI7IH0pXG4gICAgICAgICAgICAucmVkdWNlKGZ1bmN0aW9uIChjdXIsIG5leHQpIHsgcmV0dXJuIGN1ci5jb25jYXQobmV4dCk7IH0sIFtdKTtcbiAgICAgICAgdmFyIHNlbGVjdG9yc01hdGNoID0gbmV3IFNlbGVjdG9yc01hdGNoKCk7XG4gICAgICAgIHNlbGVjdG9yc01hdGNoLnNlbGVjdG9ycyA9IHNlbGVjdG9yc1xuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwuc2VsLmFjY3VtdWxhdGVDaGFuZ2VzKG5vZGUsIHNlbGVjdG9yc01hdGNoKTsgfSlcbiAgICAgICAgICAgIC5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLnNlbC5zcGVjaWZpY2l0eSAtIGIuc2VsLnNwZWNpZmljaXR5IHx8IGEucG9zIC0gYi5wb3M7IH0pXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChkb2NTZWwpIHsgcmV0dXJuIGRvY1NlbC5zZWw7IH0pO1xuICAgICAgICByZXR1cm4gc2VsZWN0b3JzTWF0Y2g7XG4gICAgfTtcbiAgICBTZWxlY3RvcnNNYXAucHJvdG90eXBlLnNvcnRCeUlkID0gZnVuY3Rpb24gKGlkLCBzZWwpIHsgdGhpcy5hZGRUb01hcCh0aGlzLmlkLCBpZCwgc2VsKTsgfTtcbiAgICBTZWxlY3RvcnNNYXAucHJvdG90eXBlLnNvcnRCeUNsYXNzID0gZnVuY3Rpb24gKGNzc0NsYXNzLCBzZWwpIHtcbiAgICAgICAgdGhpcy5hZGRUb01hcCh0aGlzLmNsYXNzLCBjc3NDbGFzcywgc2VsKTtcbiAgICB9O1xuICAgIFNlbGVjdG9yc01hcC5wcm90b3R5cGUuc29ydEJ5VHlwZSA9IGZ1bmN0aW9uIChjc3NUeXBlLCBzZWwpIHtcbiAgICAgICAgdGhpcy5hZGRUb01hcCh0aGlzLnR5cGUsIGNzc1R5cGUsIHNlbCk7XG4gICAgfTtcbiAgICBTZWxlY3RvcnNNYXAucHJvdG90eXBlLnNvcnRBc1VuaXZlcnNhbCA9IGZ1bmN0aW9uIChzZWwpIHsgdGhpcy51bml2ZXJzYWwucHVzaCh0aGlzLm1ha2VEb2NTZWxlY3RvcihzZWwpKTsgfTtcbiAgICBTZWxlY3RvcnNNYXAucHJvdG90eXBlLmFkZFRvTWFwID0gZnVuY3Rpb24gKG1hcCwgaGVhZCwgc2VsKSB7XG4gICAgICAgIHRoaXMucG9zaXRpb24rKztcbiAgICAgICAgdmFyIGxpc3QgPSBtYXBbaGVhZF07XG4gICAgICAgIGlmIChsaXN0KSB7XG4gICAgICAgICAgICBsaXN0LnB1c2godGhpcy5tYWtlRG9jU2VsZWN0b3Ioc2VsKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBtYXBbaGVhZF0gPSBbdGhpcy5tYWtlRG9jU2VsZWN0b3Ioc2VsKV07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdG9yc01hcC5wcm90b3R5cGUubWFrZURvY1NlbGVjdG9yID0gZnVuY3Rpb24gKHNlbCkge1xuICAgICAgICByZXR1cm4geyBzZWw6IHNlbCwgcG9zOiB0aGlzLnBvc2l0aW9uKysgfTtcbiAgICB9O1xuICAgIHJldHVybiBTZWxlY3RvcnNNYXA7XG59KCkpO1xuZXhwb3J0cy5TZWxlY3RvcnNNYXAgPSBTZWxlY3RvcnNNYXA7XG52YXIgU2VsZWN0b3JzTWF0Y2ggPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNlbGVjdG9yc01hdGNoKCkge1xuICAgICAgICB0aGlzLmNoYW5nZU1hcCA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgU2VsZWN0b3JzTWF0Y2gucHJvdG90eXBlLmFkZEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChub2RlLCBhdHRyaWJ1dGUpIHtcbiAgICAgICAgdmFyIGRlcHMgPSB0aGlzLnByb3BlcnRpZXMobm9kZSk7XG4gICAgICAgIGlmICghZGVwcy5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBkZXBzLmF0dHJpYnV0ZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZGVwcy5hdHRyaWJ1dGVzLmFkZChhdHRyaWJ1dGUpO1xuICAgIH07XG4gICAgU2VsZWN0b3JzTWF0Y2gucHJvdG90eXBlLmFkZFBzZXVkb0NsYXNzID0gZnVuY3Rpb24gKG5vZGUsIHBzZXVkb0NsYXNzKSB7XG4gICAgICAgIHZhciBkZXBzID0gdGhpcy5wcm9wZXJ0aWVzKG5vZGUpO1xuICAgICAgICBpZiAoIWRlcHMucHNldWRvQ2xhc3Nlcykge1xuICAgICAgICAgICAgZGVwcy5wc2V1ZG9DbGFzc2VzID0gbmV3IFNldCgpO1xuICAgICAgICB9XG4gICAgICAgIGRlcHMucHNldWRvQ2xhc3Nlcy5hZGQocHNldWRvQ2xhc3MpO1xuICAgIH07XG4gICAgU2VsZWN0b3JzTWF0Y2gucHJvdG90eXBlLnByb3BlcnRpZXMgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICB2YXIgc2V0ID0gdGhpcy5jaGFuZ2VNYXAuZ2V0KG5vZGUpO1xuICAgICAgICBpZiAoIXNldCkge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VNYXAuc2V0KG5vZGUsIHNldCA9IHt9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2V0O1xuICAgIH07XG4gICAgcmV0dXJuIFNlbGVjdG9yc01hdGNoO1xufSgpKTtcbmV4cG9ydHMuU2VsZWN0b3JzTWF0Y2ggPSBTZWxlY3RvcnNNYXRjaDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNzcy1zZWxlY3Rvci5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL2NvcmUvcHJvcGVydGllc1wiKTtcbnZhciBGb250ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGb250KGZvbnRGYW1pbHksIGZvbnRTaXplLCBmb250U3R5bGUsIGZvbnRXZWlnaHQpIHtcbiAgICAgICAgdGhpcy5mb250RmFtaWx5ID0gZm9udEZhbWlseTtcbiAgICAgICAgdGhpcy5mb250U2l6ZSA9IGZvbnRTaXplO1xuICAgICAgICB0aGlzLmZvbnRTdHlsZSA9IGZvbnRTdHlsZTtcbiAgICAgICAgdGhpcy5mb250V2VpZ2h0ID0gZm9udFdlaWdodDtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvbnQucHJvdG90eXBlLCBcImlzSXRhbGljXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mb250U3R5bGUgPT09IEZvbnRTdHlsZS5JVEFMSUM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb250LnByb3RvdHlwZSwgXCJpc0JvbGRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZvbnRXZWlnaHQgPT09IEZvbnRXZWlnaHQuU0VNSV9CT0xEIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5mb250V2VpZ2h0ID09PSBGb250V2VpZ2h0LkJPTEQgfHxcbiAgICAgICAgICAgICAgICB0aGlzLmZvbnRXZWlnaHQgPT09IFwiNzAwXCIgfHxcbiAgICAgICAgICAgICAgICB0aGlzLmZvbnRXZWlnaHQgPT09IEZvbnRXZWlnaHQuRVhUUkFfQk9MRCB8fFxuICAgICAgICAgICAgICAgIHRoaXMuZm9udFdlaWdodCA9PT0gRm9udFdlaWdodC5CTEFDSztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRm9udC5lcXVhbHMgPSBmdW5jdGlvbiAodmFsdWUxLCB2YWx1ZTIpIHtcbiAgICAgICAgaWYgKCF2YWx1ZTEgJiYgIXZhbHVlMikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF2YWx1ZTEgfHwgIXZhbHVlMikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTEuZm9udEZhbWlseSA9PT0gdmFsdWUyLmZvbnRGYW1pbHkgJiZcbiAgICAgICAgICAgIHZhbHVlMS5mb250U2l6ZSA9PT0gdmFsdWUyLmZvbnRTaXplICYmXG4gICAgICAgICAgICB2YWx1ZTEuZm9udFN0eWxlID09PSB2YWx1ZTIuZm9udFN0eWxlICYmXG4gICAgICAgICAgICB2YWx1ZTEuZm9udFdlaWdodCA9PT0gdmFsdWUyLmZvbnRXZWlnaHQ7XG4gICAgfTtcbiAgICBGb250LmRlZmF1bHQgPSB1bmRlZmluZWQ7XG4gICAgcmV0dXJuIEZvbnQ7XG59KCkpO1xuZXhwb3J0cy5Gb250ID0gRm9udDtcbnZhciBGb250U3R5bGU7XG4oZnVuY3Rpb24gKEZvbnRTdHlsZSkge1xuICAgIEZvbnRTdHlsZS5OT1JNQUwgPSBcIm5vcm1hbFwiO1xuICAgIEZvbnRTdHlsZS5JVEFMSUMgPSBcIml0YWxpY1wiO1xuICAgIEZvbnRTdHlsZS5pc1ZhbGlkID0gcHJvcGVydGllc18xLm1ha2VWYWxpZGF0b3IoRm9udFN0eWxlLk5PUk1BTCwgRm9udFN0eWxlLklUQUxJQyk7XG4gICAgRm9udFN0eWxlLnBhcnNlID0gcHJvcGVydGllc18xLm1ha2VQYXJzZXIoRm9udFN0eWxlLmlzVmFsaWQpO1xufSkoRm9udFN0eWxlID0gZXhwb3J0cy5Gb250U3R5bGUgfHwgKGV4cG9ydHMuRm9udFN0eWxlID0ge30pKTtcbnZhciBGb250V2VpZ2h0O1xuKGZ1bmN0aW9uIChGb250V2VpZ2h0KSB7XG4gICAgRm9udFdlaWdodC5USElOID0gXCIxMDBcIjtcbiAgICBGb250V2VpZ2h0LkVYVFJBX0xJR0hUID0gXCIyMDBcIjtcbiAgICBGb250V2VpZ2h0LkxJR0hUID0gXCIzMDBcIjtcbiAgICBGb250V2VpZ2h0Lk5PUk1BTCA9IFwibm9ybWFsXCI7XG4gICAgRm9udFdlaWdodC5NRURJVU0gPSBcIjUwMFwiO1xuICAgIEZvbnRXZWlnaHQuU0VNSV9CT0xEID0gXCI2MDBcIjtcbiAgICBGb250V2VpZ2h0LkJPTEQgPSBcImJvbGRcIjtcbiAgICBGb250V2VpZ2h0LkVYVFJBX0JPTEQgPSBcIjgwMFwiO1xuICAgIEZvbnRXZWlnaHQuQkxBQ0sgPSBcIjkwMFwiO1xuICAgIEZvbnRXZWlnaHQuaXNWYWxpZCA9IHByb3BlcnRpZXNfMS5tYWtlVmFsaWRhdG9yKEZvbnRXZWlnaHQuVEhJTiwgRm9udFdlaWdodC5FWFRSQV9MSUdIVCwgRm9udFdlaWdodC5MSUdIVCwgRm9udFdlaWdodC5OT1JNQUwsIFwiNDAwXCIsIEZvbnRXZWlnaHQuTUVESVVNLCBGb250V2VpZ2h0LlNFTUlfQk9MRCwgRm9udFdlaWdodC5CT0xELCBcIjcwMFwiLCBGb250V2VpZ2h0LkVYVFJBX0JPTEQsIEZvbnRXZWlnaHQuQkxBQ0spO1xuICAgIEZvbnRXZWlnaHQucGFyc2UgPSBwcm9wZXJ0aWVzXzEubWFrZVBhcnNlcihGb250V2VpZ2h0LmlzVmFsaWQpO1xufSkoRm9udFdlaWdodCA9IGV4cG9ydHMuRm9udFdlaWdodCB8fCAoZXhwb3J0cy5Gb250V2VpZ2h0ID0ge30pKTtcbmZ1bmN0aW9uIHBhcnNlRm9udEZhbWlseSh2YWx1ZSkge1xuICAgIHZhciByZXN1bHQgPSBuZXcgQXJyYXkoKTtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHZhciBzcGxpdCA9IHZhbHVlLnNwbGl0KFwiLFwiKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNwbGl0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBzdHIgPSBzcGxpdFtpXS50cmltKCkucmVwbGFjZSgvWydcIl0rL2csIFwiXCIpO1xuICAgICAgICBpZiAoc3RyKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChzdHIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLnBhcnNlRm9udEZhbWlseSA9IHBhcnNlRm9udEZhbWlseTtcbnZhciBnZW5lcmljRm9udEZhbWlsaWVzO1xuKGZ1bmN0aW9uIChnZW5lcmljRm9udEZhbWlsaWVzKSB7XG4gICAgZ2VuZXJpY0ZvbnRGYW1pbGllcy5zZXJpZiA9IFwic2VyaWZcIjtcbiAgICBnZW5lcmljRm9udEZhbWlsaWVzLnNhbnNTZXJpZiA9IFwic2Fucy1zZXJpZlwiO1xuICAgIGdlbmVyaWNGb250RmFtaWxpZXMubW9ub3NwYWNlID0gXCJtb25vc3BhY2VcIjtcbiAgICBnZW5lcmljRm9udEZhbWlsaWVzLnN5c3RlbSA9IFwic3lzdGVtXCI7XG59KShnZW5lcmljRm9udEZhbWlsaWVzID0gZXhwb3J0cy5nZW5lcmljRm9udEZhbWlsaWVzIHx8IChleHBvcnRzLmdlbmVyaWNGb250RmFtaWxpZXMgPSB7fSkpO1xudmFyIHN0eWxlcyA9IG5ldyBTZXQoKTtcbltcbiAgICBGb250U3R5bGUuTk9STUFMLFxuICAgIEZvbnRTdHlsZS5JVEFMSUNcbl0uZm9yRWFjaChmdW5jdGlvbiAodmFsLCBpLCBhKSB7IHJldHVybiBzdHlsZXMuYWRkKHZhbCk7IH0pO1xudmFyIHdlaWdodHMgPSBuZXcgU2V0KCk7XG5bXG4gICAgRm9udFdlaWdodC5USElOLFxuICAgIEZvbnRXZWlnaHQuRVhUUkFfTElHSFQsXG4gICAgRm9udFdlaWdodC5MSUdIVCxcbiAgICBGb250V2VpZ2h0Lk5PUk1BTCxcbiAgICBcIjQwMFwiLFxuICAgIEZvbnRXZWlnaHQuTUVESVVNLFxuICAgIEZvbnRXZWlnaHQuU0VNSV9CT0xELFxuICAgIEZvbnRXZWlnaHQuQk9MRCxcbiAgICBcIjcwMFwiLFxuICAgIEZvbnRXZWlnaHQuRVhUUkFfQk9MRCxcbiAgICBGb250V2VpZ2h0LkJMQUNLXG5dLmZvckVhY2goZnVuY3Rpb24gKHZhbCwgaSwgYSkgeyByZXR1cm4gd2VpZ2h0cy5hZGQodmFsKTsgfSk7XG5mdW5jdGlvbiBwYXJzZUZvbnQoZm9udFZhbHVlKSB7XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgZm9udFN0eWxlOiBcIm5vcm1hbFwiLFxuICAgICAgICBmb250VmFyaWFudDogXCJub3JtYWxcIixcbiAgICAgICAgZm9udFdlaWdodDogXCJub3JtYWxcIlxuICAgIH07XG4gICAgdmFyIHBhcnRzID0gZm9udFZhbHVlLnNwbGl0KC9cXHMrLyk7XG4gICAgdmFyIHBhcnQ7XG4gICAgd2hpbGUgKHBhcnQgPSBwYXJ0cy5zaGlmdCgpKSB7XG4gICAgICAgIGlmIChwYXJ0ID09PSBcIm5vcm1hbFwiKSB7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocGFydCA9PT0gXCJzbWFsbC1jYXBzXCIpIHtcbiAgICAgICAgICAgIHJlc3VsdC5mb250VmFyaWFudCA9IHBhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc3R5bGVzLmhhcyhwYXJ0KSkge1xuICAgICAgICAgICAgcmVzdWx0LmZvbnRTdHlsZSA9IHBhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAod2VpZ2h0cy5oYXMocGFydCkpIHtcbiAgICAgICAgICAgIHJlc3VsdC5mb250V2VpZ2h0ID0gcGFydDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghcmVzdWx0LmZvbnRTaXplKSB7XG4gICAgICAgICAgICB2YXIgc2l6ZXMgPSBwYXJ0LnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgIHJlc3VsdC5mb250U2l6ZSA9IHNpemVzWzBdO1xuICAgICAgICAgICAgcmVzdWx0LmxpbmVIZWlnaHQgPSBzaXplcy5sZW5ndGggPiAxID8gc2l6ZXNbMV0gOiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQuZm9udEZhbWlseSA9IHBhcnQ7XG4gICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LmZvbnRGYW1pbHkgKz0gXCIgXCIgKyBwYXJ0cy5qb2luKFwiIFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLnBhcnNlRm9udCA9IHBhcnNlRm9udDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZvbnQtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZm9udF9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2ZvbnQtY29tbW9uXCIpO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vdHJhY2VcIik7XG52YXIgYXBwbGljYXRpb24gPSByZXF1aXJlKFwiLi4vLi4vYXBwbGljYXRpb25cIik7XG52YXIgZnMgPSByZXF1aXJlKFwiLi4vLi4vZmlsZS1zeXN0ZW1cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9mb250LWNvbW1vblwiKSk7XG52YXIgRk9OVFNfQkFTRV9QQVRIID0gXCIvZm9udHMvXCI7XG52YXIgdHlwZWZhY2VDYWNoZSA9IG5ldyBNYXAoKTtcbnZhciBhcHBBc3NldHM7XG52YXIgRm9udCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZvbnQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRm9udChmYW1pbHksIHNpemUsIHN0eWxlLCB3ZWlnaHQpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGZhbWlseSwgc2l6ZSwgc3R5bGUsIHdlaWdodCkgfHwgdGhpcztcbiAgICB9XG4gICAgRm9udC5wcm90b3R5cGUud2l0aEZvbnRGYW1pbHkgPSBmdW5jdGlvbiAoZmFtaWx5KSB7XG4gICAgICAgIHJldHVybiBuZXcgRm9udChmYW1pbHksIHRoaXMuZm9udFNpemUsIHRoaXMuZm9udFN0eWxlLCB0aGlzLmZvbnRXZWlnaHQpO1xuICAgIH07XG4gICAgRm9udC5wcm90b3R5cGUud2l0aEZvbnRTdHlsZSA9IGZ1bmN0aW9uIChzdHlsZSkge1xuICAgICAgICByZXR1cm4gbmV3IEZvbnQodGhpcy5mb250RmFtaWx5LCB0aGlzLmZvbnRTaXplLCBzdHlsZSwgdGhpcy5mb250V2VpZ2h0KTtcbiAgICB9O1xuICAgIEZvbnQucHJvdG90eXBlLndpdGhGb250V2VpZ2h0ID0gZnVuY3Rpb24gKHdlaWdodCkge1xuICAgICAgICByZXR1cm4gbmV3IEZvbnQodGhpcy5mb250RmFtaWx5LCB0aGlzLmZvbnRTaXplLCB0aGlzLmZvbnRTdHlsZSwgd2VpZ2h0KTtcbiAgICB9O1xuICAgIEZvbnQucHJvdG90eXBlLndpdGhGb250U2l6ZSA9IGZ1bmN0aW9uIChzaXplKSB7XG4gICAgICAgIHJldHVybiBuZXcgRm9udCh0aGlzLmZvbnRGYW1pbHksIHNpemUsIHRoaXMuZm9udFN0eWxlLCB0aGlzLmZvbnRXZWlnaHQpO1xuICAgIH07XG4gICAgRm9udC5wcm90b3R5cGUuZ2V0QW5kcm9pZFR5cGVmYWNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX3R5cGVmYWNlKSB7XG4gICAgICAgICAgICB0aGlzLl90eXBlZmFjZSA9IGNyZWF0ZVR5cGVmYWNlKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl90eXBlZmFjZTtcbiAgICB9O1xuICAgIEZvbnQucHJvdG90eXBlLmdldFVJRm9udCA9IGZ1bmN0aW9uIChkZWZhdWx0Rm9udCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgRm9udC5kZWZhdWx0ID0gbmV3IEZvbnQodW5kZWZpbmVkLCB1bmRlZmluZWQsIFwibm9ybWFsXCIsIFwibm9ybWFsXCIpO1xuICAgIHJldHVybiBGb250O1xufShmb250X2NvbW1vbl8xLkZvbnQpKTtcbmV4cG9ydHMuRm9udCA9IEZvbnQ7XG5mdW5jdGlvbiBsb2FkRm9udEZyb21GaWxlKGZvbnRGYW1pbHkpIHtcbiAgICBhcHBBc3NldHMgPSBhcHBBc3NldHMgfHwgYXBwbGljYXRpb24uYW5kcm9pZC5jb250ZXh0LmdldEFzc2V0cygpO1xuICAgIGlmICghYXBwQXNzZXRzKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gdHlwZWZhY2VDYWNoZS5nZXQoZm9udEZhbWlseSk7XG4gICAgaWYgKHJlc3VsdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJlc3VsdCA9IG51bGw7XG4gICAgICAgIHZhciBmb250QXNzZXRQYXRoID0gdm9pZCAwO1xuICAgICAgICB2YXIgYmFzZVBhdGggPSBmcy5wYXRoLmpvaW4oZnMua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoLCBcImZvbnRzXCIsIGZvbnRGYW1pbHkpO1xuICAgICAgICBpZiAoZnMuRmlsZS5leGlzdHMoYmFzZVBhdGggKyBcIi50dGZcIikpIHtcbiAgICAgICAgICAgIGZvbnRBc3NldFBhdGggPSBGT05UU19CQVNFX1BBVEggKyBmb250RmFtaWx5ICsgXCIudHRmXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZnMuRmlsZS5leGlzdHMoYmFzZVBhdGggKyBcIi5vdGZcIikpIHtcbiAgICAgICAgICAgIGZvbnRBc3NldFBhdGggPSBGT05UU19CQVNFX1BBVEggKyBmb250RmFtaWx5ICsgXCIub3RmXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDb3VsZCBub3QgZmluZCBmb250IGZpbGUgZm9yIFwiICsgZm9udEZhbWlseSwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZm9udEFzc2V0UGF0aCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBmb250QXNzZXRQYXRoID0gZnMucGF0aC5qb2luKGZzLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCwgZm9udEFzc2V0UGF0aCk7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gYW5kcm9pZC5ncmFwaGljcy5UeXBlZmFjZS5jcmVhdGVGcm9tRmlsZShmb250QXNzZXRQYXRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkVycm9yIGxvYWRpbmcgZm9udCBhc3NldDogXCIgKyBmb250QXNzZXRQYXRoLCB0cmFjZV8xLmNhdGVnb3JpZXMuRXJyb3IsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0eXBlZmFjZUNhY2hlLnNldChmb250RmFtaWx5LCByZXN1bHQpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gY3JlYXRlVHlwZWZhY2UoZm9udCkge1xuICAgIHZhciBmb250U3R5bGUgPSAwO1xuICAgIGlmIChmb250LmlzQm9sZCkge1xuICAgICAgICBmb250U3R5bGUgfD0gYW5kcm9pZC5ncmFwaGljcy5UeXBlZmFjZS5CT0xEO1xuICAgIH1cbiAgICBpZiAoZm9udC5pc0l0YWxpYykge1xuICAgICAgICBmb250U3R5bGUgfD0gYW5kcm9pZC5ncmFwaGljcy5UeXBlZmFjZS5JVEFMSUM7XG4gICAgfVxuICAgIHZhciBmb250cyA9IGZvbnRfY29tbW9uXzEucGFyc2VGb250RmFtaWx5KGZvbnQuZm9udEZhbWlseSk7XG4gICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmb250cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBzd2l0Y2ggKGZvbnRzW2ldLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5nZW5lcmljRm9udEZhbWlsaWVzLnNlcmlmOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFuZHJvaWQuZ3JhcGhpY3MuVHlwZWZhY2UuY3JlYXRlKFwic2VyaWZcIiArIGdldEZvbnRXZWlnaHRTdWZmaXgoZm9udC5mb250V2VpZ2h0KSwgZm9udFN0eWxlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5nZW5lcmljRm9udEZhbWlsaWVzLnNhbnNTZXJpZjpcbiAgICAgICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5nZW5lcmljRm9udEZhbWlsaWVzLnN5c3RlbTpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBhbmRyb2lkLmdyYXBoaWNzLlR5cGVmYWNlLmNyZWF0ZShcInNhbnMtc2VyaWZcIiArIGdldEZvbnRXZWlnaHRTdWZmaXgoZm9udC5mb250V2VpZ2h0KSwgZm9udFN0eWxlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5nZW5lcmljRm9udEZhbWlsaWVzLm1vbm9zcGFjZTpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBhbmRyb2lkLmdyYXBoaWNzLlR5cGVmYWNlLmNyZWF0ZShcIm1vbm9zcGFjZVwiICsgZ2V0Rm9udFdlaWdodFN1ZmZpeChmb250LmZvbnRXZWlnaHQpLCBmb250U3R5bGUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBsb2FkRm9udEZyb21GaWxlKGZvbnRzW2ldKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICYmIGZvbnRTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhbmRyb2lkLmdyYXBoaWNzLlR5cGVmYWNlLmNyZWF0ZShyZXN1bHQsIGZvbnRTdHlsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJlc3VsdCA9IGFuZHJvaWQuZ3JhcGhpY3MuVHlwZWZhY2UuY3JlYXRlKFwic2Fucy1zZXJpZlwiICsgZ2V0Rm9udFdlaWdodFN1ZmZpeChmb250LmZvbnRXZWlnaHQpLCBmb250U3R5bGUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gZ2V0Rm9udFdlaWdodFN1ZmZpeChmb250V2VpZ2h0KSB7XG4gICAgc3dpdGNoIChmb250V2VpZ2h0KSB7XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0LlRISU46XG4gICAgICAgICAgICByZXR1cm4gYW5kcm9pZC5vcy5CdWlsZC5WRVJTSU9OLlNES19JTlQgPj0gMTYgPyBcIi10aGluXCIgOiBcIlwiO1xuICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuRm9udFdlaWdodC5FWFRSQV9MSUdIVDpcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuTElHSFQ6XG4gICAgICAgICAgICByZXR1cm4gYW5kcm9pZC5vcy5CdWlsZC5WRVJTSU9OLlNES19JTlQgPj0gMTYgPyBcIi1saWdodFwiIDogXCJcIjtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuTk9STUFMOlxuICAgICAgICBjYXNlIFwiNDAwXCI6XG4gICAgICAgIGNhc2UgdW5kZWZpbmVkOlxuICAgICAgICBjYXNlIG51bGw6XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuTUVESVVNOlxuICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuRm9udFdlaWdodC5TRU1JX0JPTEQ6XG4gICAgICAgICAgICByZXR1cm4gYW5kcm9pZC5vcy5CdWlsZC5WRVJTSU9OLlNES19JTlQgPj0gMjEgPyBcIi1tZWRpdW1cIiA6IFwiXCI7XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0LkJPTEQ6XG4gICAgICAgIGNhc2UgXCI3MDBcIjpcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuRVhUUkFfQk9MRDpcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuRm9udFdlaWdodC5CTEFDSzpcbiAgICAgICAgICAgIHJldHVybiBhbmRyb2lkLm9zLkJ1aWxkLlZFUlNJT04uU0RLX0lOVCA+PSAyMSA/IFwiLWJsYWNrXCIgOiBcIlwiO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBmb250IHdlaWdodDogXFxcIlwiICsgZm9udFdlaWdodCArIFwiXFxcIlwiKTtcbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mb250LmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vY29sb3JcIik7XG52YXIgTGluZWFyR3JhZGllbnQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIExpbmVhckdyYWRpZW50KCkge1xuICAgIH1cbiAgICBMaW5lYXJHcmFkaWVudC5wYXJzZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IExpbmVhckdyYWRpZW50KCk7XG4gICAgICAgIHJlc3VsdC5hbmdsZSA9IHZhbHVlLmFuZ2xlO1xuICAgICAgICByZXN1bHQuY29sb3JTdG9wcyA9IHZhbHVlLmNvbG9ycy5tYXAoZnVuY3Rpb24gKGNvbG9yKSB7XG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gY29sb3Iub2Zmc2V0IHx8IG51bGw7XG4gICAgICAgICAgICB2YXIgb2Zmc2V0VW5pdDtcbiAgICAgICAgICAgIGlmIChvZmZzZXQgJiYgb2Zmc2V0LnVuaXQgPT09IFwiJVwiKSB7XG4gICAgICAgICAgICAgICAgb2Zmc2V0VW5pdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgdW5pdDogXCIlXCIsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvZmZzZXQudmFsdWVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjb2xvcjogbmV3IGNvbG9yXzEuQ29sb3IoY29sb3IuYXJnYiksXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBvZmZzZXRVbml0XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIExpbmVhckdyYWRpZW50LmVxdWFscyA9IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIGlmICghZmlyc3QgJiYgIXNlY29uZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWZpcnN0IHx8ICFzZWNvbmQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlyc3QuYW5nbGUgIT09IHNlY29uZC5hbmdsZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaXJzdC5jb2xvclN0b3BzLmxlbmd0aCAhPT0gc2Vjb25kLmNvbG9yU3RvcHMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaXJzdC5jb2xvclN0b3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZmlyc3RTdG9wID0gZmlyc3QuY29sb3JTdG9wc1tpXTtcbiAgICAgICAgICAgIHZhciBzZWNvbmRTdG9wID0gc2Vjb25kLmNvbG9yU3RvcHNbaV07XG4gICAgICAgICAgICBpZiAoZmlyc3RTdG9wLm9mZnNldCAhPT0gc2Vjb25kU3RvcC5vZmZzZXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWNvbG9yXzEuQ29sb3IuZXF1YWxzKGZpcnN0U3RvcC5jb2xvciwgc2Vjb25kU3RvcC5jb2xvcikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICByZXR1cm4gTGluZWFyR3JhZGllbnQ7XG59KCkpO1xuZXhwb3J0cy5MaW5lYXJHcmFkaWVudCA9IExpbmVhckdyYWRpZW50O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bGluZWFyLWdyYWRpZW50LmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vY29yZS9wcm9wZXJ0aWVzXCIpO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vY29sb3JcIik7XG52YXIgZm9udF8xID0gcmVxdWlyZShcIi4uLy4uL3VpL3N0eWxpbmcvZm9udFwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3V0aWxzXCIpO1xudmFyIGJhY2tncm91bmRfMSA9IHJlcXVpcmUoXCIuLi8uLi91aS9zdHlsaW5nL2JhY2tncm91bmRcIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybVwiKTtcbnZhciBudW1iZXJfdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy9udW1iZXItdXRpbHNcIik7XG52YXIgbWF0cml4XzEgPSByZXF1aXJlKFwiLi4vLi4vbWF0cml4XCIpO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vdHJhY2VcIik7XG52YXIgcGFyc2VyID0gcmVxdWlyZShcIi4uLy4uL2Nzcy9wYXJzZXJcIik7XG52YXIgbGluZWFyX2dyYWRpZW50XzEgPSByZXF1aXJlKFwiLi9saW5lYXItZ3JhZGllbnRcIik7XG5mdW5jdGlvbiBlcXVhbHNDb21tb24oYSwgYikge1xuICAgIGlmIChhID09IFwiYXV0b1wiKSB7XG4gICAgICAgIHJldHVybiBiID09IFwiYXV0b1wiO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGEgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgaWYgKGIgPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBhID09IGI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFiKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGIudW5pdCA9PSBcImRpcFwiICYmIGEgPT0gYi52YWx1ZTtcbiAgICB9XG4gICAgaWYgKGIgPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgcmV0dXJuIGEgPyAoYS51bml0ID09IFwiZGlwXCIgJiYgYS52YWx1ZSA9PSBiKSA6IGZhbHNlO1xuICAgIH1cbiAgICBpZiAoIWEgfHwgIWIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gYS52YWx1ZSA9PSBiLnZhbHVlICYmIGEudW5pdCA9PSBiLnVuaXQ7XG59XG5mdW5jdGlvbiBjb252ZXJ0VG9TdHJpbmdDb21tb24obGVuZ3RoKSB7XG4gICAgaWYgKGxlbmd0aCA9PSBcImF1dG9cIikge1xuICAgICAgICByZXR1cm4gXCJhdXRvXCI7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgbGVuZ3RoID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHJldHVybiBsZW5ndGgudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgdmFyIHZhbCA9IGxlbmd0aC52YWx1ZTtcbiAgICBpZiAobGVuZ3RoLnVuaXQgPT09IFwiJVwiKSB7XG4gICAgICAgIHZhbCAqPSAxMDA7XG4gICAgfVxuICAgIHJldHVybiB2YWwgKyBsZW5ndGgudW5pdDtcbn1cbmZ1bmN0aW9uIHRvRGV2aWNlUGl4ZWxzQ29tbW9uKGxlbmd0aCwgYXV0bywgcGFyZW50QXZhaWxhYmxlV2lkdGgpIHtcbiAgICBpZiAoYXV0byA9PT0gdm9pZCAwKSB7IGF1dG8gPSBOdW1iZXIuTmFOOyB9XG4gICAgaWYgKHBhcmVudEF2YWlsYWJsZVdpZHRoID09PSB2b2lkIDApIHsgcGFyZW50QXZhaWxhYmxlV2lkdGggPSBOdW1iZXIuTmFOOyB9XG4gICAgaWYgKGxlbmd0aCA9PSBcImF1dG9cIikge1xuICAgICAgICByZXR1cm4gYXV0bztcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBsZW5ndGggPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgcmV0dXJuIHV0aWxzXzEubGF5b3V0LnJvdW5kKHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGxlbmd0aCkpO1xuICAgIH1cbiAgICBpZiAoIWxlbmd0aCkge1xuICAgICAgICByZXR1cm4gYXV0bztcbiAgICB9XG4gICAgc3dpdGNoIChsZW5ndGgudW5pdCkge1xuICAgICAgICBjYXNlIFwicHhcIjpcbiAgICAgICAgICAgIHJldHVybiB1dGlsc18xLmxheW91dC5yb3VuZChsZW5ndGgudmFsdWUpO1xuICAgICAgICBjYXNlIFwiJVwiOlxuICAgICAgICAgICAgcmV0dXJuIHV0aWxzXzEubGF5b3V0LnJvdW5kKHBhcmVudEF2YWlsYWJsZVdpZHRoICogbGVuZ3RoLnZhbHVlKTtcbiAgICAgICAgY2FzZSBcImRpcFwiOlxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHV0aWxzXzEubGF5b3V0LnJvdW5kKHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGxlbmd0aC52YWx1ZSkpO1xuICAgIH1cbn1cbnZhciBQZXJjZW50TGVuZ3RoO1xuKGZ1bmN0aW9uIChQZXJjZW50TGVuZ3RoKSB7XG4gICAgZnVuY3Rpb24gcGFyc2UoZnJvbVZhbHVlKSB7XG4gICAgICAgIGlmIChmcm9tVmFsdWUgPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBcImF1dG9cIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGZyb21WYWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIHN0cmluZ1ZhbHVlID0gZnJvbVZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIHZhciBwZXJjZW50SW5kZXggPSBzdHJpbmdWYWx1ZS5pbmRleE9mKFwiJVwiKTtcbiAgICAgICAgICAgIGlmIChwZXJjZW50SW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIGlmIChwZXJjZW50SW5kZXggIT09IChzdHJpbmdWYWx1ZS5sZW5ndGggLSAxKSB8fCBwZXJjZW50SW5kZXggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBOdW1iZXIuTmFOO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBwYXJzZUZsb2F0KHN0cmluZ1ZhbHVlLnN1YnN0cmluZygwLCBzdHJpbmdWYWx1ZS5sZW5ndGggLSAxKS50cmltKCkpIC8gMTAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8ICFpc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyBmcm9tVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4geyB1bml0OiBcIiVcIiwgdmFsdWU6IHZhbHVlIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzdHJpbmdWYWx1ZS5pbmRleE9mKFwicHhcIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZS5yZXBsYWNlKFwicHhcIiwgXCJcIikudHJpbSgpO1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHBhcnNlRmxvYXQoc3RyaW5nVmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChpc05hTih2YWx1ZSkgfHwgIWlzRmluaXRlKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZhbHVlOiBcIiArIGZyb21WYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB7IHVuaXQ6IFwicHhcIiwgdmFsdWU6IHZhbHVlIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8ICFpc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyBmcm9tVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZnJvbVZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIFBlcmNlbnRMZW5ndGgucGFyc2UgPSBwYXJzZTtcbiAgICBQZXJjZW50TGVuZ3RoLmVxdWFscyA9IGVxdWFsc0NvbW1vbjtcbiAgICBQZXJjZW50TGVuZ3RoLnRvRGV2aWNlUGl4ZWxzID0gdG9EZXZpY2VQaXhlbHNDb21tb247XG4gICAgUGVyY2VudExlbmd0aC5jb252ZXJ0VG9TdHJpbmcgPSBjb252ZXJ0VG9TdHJpbmdDb21tb247XG59KShQZXJjZW50TGVuZ3RoID0gZXhwb3J0cy5QZXJjZW50TGVuZ3RoIHx8IChleHBvcnRzLlBlcmNlbnRMZW5ndGggPSB7fSkpO1xudmFyIExlbmd0aDtcbihmdW5jdGlvbiAoTGVuZ3RoKSB7XG4gICAgZnVuY3Rpb24gcGFyc2UoZnJvbVZhbHVlKSB7XG4gICAgICAgIGlmIChmcm9tVmFsdWUgPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBcImF1dG9cIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGZyb21WYWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIHN0cmluZ1ZhbHVlID0gZnJvbVZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIGlmIChzdHJpbmdWYWx1ZS5pbmRleE9mKFwicHhcIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZS5yZXBsYWNlKFwicHhcIiwgXCJcIikudHJpbSgpO1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHBhcnNlRmxvYXQoc3RyaW5nVmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChpc05hTih2YWx1ZSkgfHwgIWlzRmluaXRlKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZhbHVlOiBcIiArIHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgdW5pdDogXCJweFwiLCB2YWx1ZTogdmFsdWUgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHBhcnNlRmxvYXQoc3RyaW5nVmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChpc05hTih2YWx1ZSkgfHwgIWlzRmluaXRlKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZhbHVlOiBcIiArIHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZyb21WYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBMZW5ndGgucGFyc2UgPSBwYXJzZTtcbiAgICBMZW5ndGguZXF1YWxzID0gZXF1YWxzQ29tbW9uO1xuICAgIExlbmd0aC50b0RldmljZVBpeGVscyA9IHRvRGV2aWNlUGl4ZWxzQ29tbW9uO1xuICAgIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcgPSBjb252ZXJ0VG9TdHJpbmdDb21tb247XG59KShMZW5ndGggPSBleHBvcnRzLkxlbmd0aCB8fCAoZXhwb3J0cy5MZW5ndGggPSB7fSkpO1xuZXhwb3J0cy56ZXJvTGVuZ3RoID0geyB2YWx1ZTogMCwgdW5pdDogXCJweFwiIH07XG5leHBvcnRzLm1pbldpZHRoUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1pbldpZHRoXCIsIGNzc05hbWU6IFwibWluLXdpZHRoXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZU1pbldpZHRoID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMubWluV2lkdGhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5taW5IZWlnaHRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWluSGVpZ2h0XCIsIGNzc05hbWU6IFwibWluLWhlaWdodFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVNaW5IZWlnaHQgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5taW5IZWlnaHRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy53aWR0aFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJ3aWR0aFwiLCBjc3NOYW1lOiBcIndpZHRoXCIsIGRlZmF1bHRWYWx1ZTogXCJhdXRvXCIsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuaXNJT1MpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgICAgIHZpZXcucmVxdWVzdExheW91dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IFBlcmNlbnRMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy53aWR0aFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmhlaWdodFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJoZWlnaHRcIiwgY3NzTmFtZTogXCJoZWlnaHRcIiwgZGVmYXVsdFZhbHVlOiBcImF1dG9cIiwgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAocGxhdGZvcm1fMS5pc0lPUykge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICAgICAgdmlldy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogUGVyY2VudExlbmd0aC5wYXJzZSxcbn0pO1xuZXhwb3J0cy5oZWlnaHRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIG1hcmdpblByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtYXJnaW5cIiwgY3NzTmFtZTogXCJtYXJnaW5cIixcbiAgICBnZXR0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKFBlcmNlbnRMZW5ndGguZXF1YWxzKHRoaXMubWFyZ2luVG9wLCB0aGlzLm1hcmdpblJpZ2h0KSAmJlxuICAgICAgICAgICAgUGVyY2VudExlbmd0aC5lcXVhbHModGhpcy5tYXJnaW5Ub3AsIHRoaXMubWFyZ2luQm90dG9tKSAmJlxuICAgICAgICAgICAgUGVyY2VudExlbmd0aC5lcXVhbHModGhpcy5tYXJnaW5Ub3AsIHRoaXMubWFyZ2luTGVmdCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1hcmdpblRvcDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUGVyY2VudExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5tYXJnaW5Ub3ApICsgXCIgXCIgKyBQZXJjZW50TGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLm1hcmdpblJpZ2h0KSArIFwiIFwiICsgUGVyY2VudExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5tYXJnaW5Cb3R0b20pICsgXCIgXCIgKyBQZXJjZW50TGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLm1hcmdpbkxlZnQpO1xuICAgIH0sXG4gICAgY29udmVydGVyOiBjb252ZXJ0VG9NYXJnaW5zXG59KTtcbm1hcmdpblByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLm1hcmdpbkxlZnRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcIm1hcmdpbkxlZnRcIiwgY3NzTmFtZTogXCJtYXJnaW4tbGVmdFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IFBlcmNlbnRMZW5ndGgucGFyc2UgfSk7XG5leHBvcnRzLm1hcmdpbkxlZnRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5tYXJnaW5SaWdodFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwibWFyZ2luUmlnaHRcIiwgY3NzTmFtZTogXCJtYXJnaW4tcmlnaHRcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBQZXJjZW50TGVuZ3RoLnBhcnNlIH0pO1xuZXhwb3J0cy5tYXJnaW5SaWdodFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLm1hcmdpblRvcFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwibWFyZ2luVG9wXCIsIGNzc05hbWU6IFwibWFyZ2luLXRvcFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IFBlcmNlbnRMZW5ndGgucGFyc2UgfSk7XG5leHBvcnRzLm1hcmdpblRvcFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLm1hcmdpbkJvdHRvbVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwibWFyZ2luQm90dG9tXCIsIGNzc05hbWU6IFwibWFyZ2luLWJvdHRvbVwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IFBlcmNlbnRMZW5ndGgucGFyc2UgfSk7XG5leHBvcnRzLm1hcmdpbkJvdHRvbVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG52YXIgcGFkZGluZ1Byb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJwYWRkaW5nXCIsIGNzc05hbWU6IFwicGFkZGluZ1wiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoTGVuZ3RoLmVxdWFscyh0aGlzLnBhZGRpbmdUb3AsIHRoaXMucGFkZGluZ1JpZ2h0KSAmJlxuICAgICAgICAgICAgTGVuZ3RoLmVxdWFscyh0aGlzLnBhZGRpbmdUb3AsIHRoaXMucGFkZGluZ0JvdHRvbSkgJiZcbiAgICAgICAgICAgIExlbmd0aC5lcXVhbHModGhpcy5wYWRkaW5nVG9wLCB0aGlzLnBhZGRpbmdMZWZ0KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFkZGluZ1RvcDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLnBhZGRpbmdUb3ApICsgXCIgXCIgKyBMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMucGFkZGluZ1JpZ2h0KSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLnBhZGRpbmdCb3R0b20pICsgXCIgXCIgKyBMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMucGFkZGluZ0xlZnQpO1xuICAgIH0sXG4gICAgY29udmVydGVyOiBjb252ZXJ0VG9QYWRkaW5nc1xufSk7XG5wYWRkaW5nUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMucGFkZGluZ0xlZnRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwicGFkZGluZ0xlZnRcIiwgY3NzTmFtZTogXCJwYWRkaW5nLWxlZnRcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcuZWZmZWN0aXZlUGFkZGluZ0xlZnQgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5wYWRkaW5nTGVmdFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnBhZGRpbmdSaWdodFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJwYWRkaW5nUmlnaHRcIiwgY3NzTmFtZTogXCJwYWRkaW5nLXJpZ2h0XCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZVBhZGRpbmdSaWdodCA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLnBhZGRpbmdSaWdodFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnBhZGRpbmdUb3BQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwicGFkZGluZ1RvcFwiLCBjc3NOYW1lOiBcInBhZGRpbmctdG9wXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZVBhZGRpbmdUb3AgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5wYWRkaW5nVG9wUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMucGFkZGluZ0JvdHRvbVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJwYWRkaW5nQm90dG9tXCIsIGNzc05hbWU6IFwicGFkZGluZy1ib3R0b21cIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIEhvcml6b250YWxBbGlnbm1lbnQ7XG4oZnVuY3Rpb24gKEhvcml6b250YWxBbGlnbm1lbnQpIHtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LkxFRlQgPSBcImxlZnRcIjtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LkNFTlRFUiA9IFwiY2VudGVyXCI7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5SSUdIVCA9IFwicmlnaHRcIjtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LlNUUkVUQ0ggPSBcInN0cmV0Y2hcIjtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LmlzVmFsaWQgPSBwcm9wZXJ0aWVzXzEubWFrZVZhbGlkYXRvcihIb3Jpem9udGFsQWxpZ25tZW50LkxFRlQsIEhvcml6b250YWxBbGlnbm1lbnQuQ0VOVEVSLCBIb3Jpem9udGFsQWxpZ25tZW50LlJJR0hULCBIb3Jpem9udGFsQWxpZ25tZW50LlNUUkVUQ0gpO1xuICAgIEhvcml6b250YWxBbGlnbm1lbnQucGFyc2UgPSBwcm9wZXJ0aWVzXzEubWFrZVBhcnNlcihIb3Jpem9udGFsQWxpZ25tZW50LmlzVmFsaWQpO1xufSkoSG9yaXpvbnRhbEFsaWdubWVudCA9IGV4cG9ydHMuSG9yaXpvbnRhbEFsaWdubWVudCB8fCAoZXhwb3J0cy5Ib3Jpem9udGFsQWxpZ25tZW50ID0ge30pKTtcbmV4cG9ydHMuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiaG9yaXpvbnRhbEFsaWdubWVudFwiLCBjc3NOYW1lOiBcImhvcml6b250YWwtYWxpZ25cIiwgZGVmYXVsdFZhbHVlOiBIb3Jpem9udGFsQWxpZ25tZW50LlNUUkVUQ0gsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBIb3Jpem9udGFsQWxpZ25tZW50LnBhcnNlIH0pO1xuZXhwb3J0cy5ob3Jpem9udGFsQWxpZ25tZW50UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBWZXJ0aWNhbEFsaWdubWVudDtcbihmdW5jdGlvbiAoVmVydGljYWxBbGlnbm1lbnQpIHtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC5UT1AgPSBcInRvcFwiO1xuICAgIFZlcnRpY2FsQWxpZ25tZW50Lk1JRERMRSA9IFwibWlkZGxlXCI7XG4gICAgVmVydGljYWxBbGlnbm1lbnQuQk9UVE9NID0gXCJib3R0b21cIjtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC5TVFJFVENIID0gXCJzdHJldGNoXCI7XG4gICAgVmVydGljYWxBbGlnbm1lbnQuaXNWYWxpZCA9IHByb3BlcnRpZXNfMS5tYWtlVmFsaWRhdG9yKFZlcnRpY2FsQWxpZ25tZW50LlRPUCwgVmVydGljYWxBbGlnbm1lbnQuTUlERExFLCBWZXJ0aWNhbEFsaWdubWVudC5CT1RUT00sIFZlcnRpY2FsQWxpZ25tZW50LlNUUkVUQ0gpO1xuICAgIFZlcnRpY2FsQWxpZ25tZW50LnBhcnNlID0gZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiB2YWx1ZS50b0xvd2VyQ2FzZSgpID09PSBcImNlbnRlclwiID8gVmVydGljYWxBbGlnbm1lbnQuTUlERExFIDogcGFyc2VTdHJpY3QodmFsdWUpOyB9O1xuICAgIHZhciBwYXJzZVN0cmljdCA9IHByb3BlcnRpZXNfMS5tYWtlUGFyc2VyKFZlcnRpY2FsQWxpZ25tZW50LmlzVmFsaWQpO1xufSkoVmVydGljYWxBbGlnbm1lbnQgPSBleHBvcnRzLlZlcnRpY2FsQWxpZ25tZW50IHx8IChleHBvcnRzLlZlcnRpY2FsQWxpZ25tZW50ID0ge30pKTtcbmV4cG9ydHMudmVydGljYWxBbGlnbm1lbnRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcInZlcnRpY2FsQWxpZ25tZW50XCIsIGNzc05hbWU6IFwidmVydGljYWwtYWxpZ25cIiwgZGVmYXVsdFZhbHVlOiBWZXJ0aWNhbEFsaWdubWVudC5TVFJFVENILCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogVmVydGljYWxBbGlnbm1lbnQucGFyc2UgfSk7XG5leHBvcnRzLnZlcnRpY2FsQWxpZ25tZW50UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmZ1bmN0aW9uIHBhcnNlVGhpY2tuZXNzKHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB2YXIgYXJyID0gdmFsdWUuc3BsaXQoL1sgLF0rLyk7XG4gICAgICAgIHZhciB0b3BfMTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gdm9pZCAwO1xuICAgICAgICB2YXIgYm90dG9tID0gdm9pZCAwO1xuICAgICAgICB2YXIgbGVmdCA9IHZvaWQgMDtcbiAgICAgICAgaWYgKGFyci5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHRvcF8xID0gYXJyWzBdO1xuICAgICAgICAgICAgcmlnaHQgPSBhcnJbMF07XG4gICAgICAgICAgICBib3R0b20gPSBhcnJbMF07XG4gICAgICAgICAgICBsZWZ0ID0gYXJyWzBdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgIHRvcF8xID0gYXJyWzBdO1xuICAgICAgICAgICAgYm90dG9tID0gYXJyWzBdO1xuICAgICAgICAgICAgcmlnaHQgPSBhcnJbMV07XG4gICAgICAgICAgICBsZWZ0ID0gYXJyWzFdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgICAgIHRvcF8xID0gYXJyWzBdO1xuICAgICAgICAgICAgcmlnaHQgPSBhcnJbMV07XG4gICAgICAgICAgICBsZWZ0ID0gYXJyWzFdO1xuICAgICAgICAgICAgYm90dG9tID0gYXJyWzJdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDQpIHtcbiAgICAgICAgICAgIHRvcF8xID0gYXJyWzBdO1xuICAgICAgICAgICAgcmlnaHQgPSBhcnJbMV07XG4gICAgICAgICAgICBib3R0b20gPSBhcnJbMl07XG4gICAgICAgICAgICBsZWZ0ID0gYXJyWzNdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXhwZWN0ZWQgMSwgMiwgMyBvciA0IHBhcmFtZXRlcnMuIEFjdHVhbDogXCIgKyB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRvcDogdG9wXzEsXG4gICAgICAgICAgICByaWdodDogcmlnaHQsXG4gICAgICAgICAgICBib3R0b206IGJvdHRvbSxcbiAgICAgICAgICAgIGxlZnQ6IGxlZnRcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG59XG5mdW5jdGlvbiBjb252ZXJ0VG9NYXJnaW5zKHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiB2YWx1ZSAhPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgdmFyIHRoaWNrbmVzcyA9IHBhcnNlVGhpY2tuZXNzKHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFtleHBvcnRzLm1hcmdpblRvcFByb3BlcnR5LCBQZXJjZW50TGVuZ3RoLnBhcnNlKHRoaWNrbmVzcy50b3ApXSxcbiAgICAgICAgICAgIFtleHBvcnRzLm1hcmdpblJpZ2h0UHJvcGVydHksIFBlcmNlbnRMZW5ndGgucGFyc2UodGhpY2tuZXNzLnJpZ2h0KV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5Cb3R0b21Qcm9wZXJ0eSwgUGVyY2VudExlbmd0aC5wYXJzZSh0aGlja25lc3MuYm90dG9tKV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5MZWZ0UHJvcGVydHksIFBlcmNlbnRMZW5ndGgucGFyc2UodGhpY2tuZXNzLmxlZnQpXVxuICAgICAgICBdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFtleHBvcnRzLm1hcmdpblRvcFByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5SaWdodFByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5Cb3R0b21Qcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgW2V4cG9ydHMubWFyZ2luTGVmdFByb3BlcnR5LCB2YWx1ZV1cbiAgICAgICAgXTtcbiAgICB9XG59XG5mdW5jdGlvbiBjb252ZXJ0VG9QYWRkaW5ncyh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUgIT09IFwiYXV0b1wiKSB7XG4gICAgICAgIHZhciB0aGlja25lc3MgPSBwYXJzZVRoaWNrbmVzcyh2YWx1ZSk7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBbZXhwb3J0cy5wYWRkaW5nVG9wUHJvcGVydHksIExlbmd0aC5wYXJzZSh0aGlja25lc3MudG9wKV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5wYWRkaW5nUmlnaHRQcm9wZXJ0eSwgTGVuZ3RoLnBhcnNlKHRoaWNrbmVzcy5yaWdodCldLFxuICAgICAgICAgICAgW2V4cG9ydHMucGFkZGluZ0JvdHRvbVByb3BlcnR5LCBMZW5ndGgucGFyc2UodGhpY2tuZXNzLmJvdHRvbSldLFxuICAgICAgICAgICAgW2V4cG9ydHMucGFkZGluZ0xlZnRQcm9wZXJ0eSwgTGVuZ3RoLnBhcnNlKHRoaWNrbmVzcy5sZWZ0KV1cbiAgICAgICAgXTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBbZXhwb3J0cy5wYWRkaW5nVG9wUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgIFtleHBvcnRzLnBhZGRpbmdSaWdodFByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5wYWRkaW5nQm90dG9tUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgIFtleHBvcnRzLnBhZGRpbmdMZWZ0UHJvcGVydHksIHZhbHVlXVxuICAgICAgICBdO1xuICAgIH1cbn1cbmV4cG9ydHMucm90YXRlUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc0FuaW1hdGlvblByb3BlcnR5KHsgbmFtZTogXCJyb3RhdGVcIiwgY3NzTmFtZTogXCJyb3RhdGVcIiwgZGVmYXVsdFZhbHVlOiAwLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VGbG9hdCB9KTtcbmV4cG9ydHMucm90YXRlUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuc2NhbGVYUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc0FuaW1hdGlvblByb3BlcnR5KHsgbmFtZTogXCJzY2FsZVhcIiwgY3NzTmFtZTogXCJzY2FsZVhcIiwgZGVmYXVsdFZhbHVlOiAxLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VGbG9hdCB9KTtcbmV4cG9ydHMuc2NhbGVYUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuc2NhbGVZUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc0FuaW1hdGlvblByb3BlcnR5KHsgbmFtZTogXCJzY2FsZVlcIiwgY3NzTmFtZTogXCJzY2FsZVlcIiwgZGVmYXVsdFZhbHVlOiAxLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VGbG9hdCB9KTtcbmV4cG9ydHMuc2NhbGVZUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmZ1bmN0aW9uIHBhcnNlRElQcyh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZS5pbmRleE9mKFwicHhcIikgIT09IC0xKSB7XG4gICAgICAgIHJldHVybiB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHBhcnNlRmxvYXQodmFsdWUucmVwbGFjZShcInB4XCIsIFwiXCIpLnRyaW0oKSkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQodmFsdWUucmVwbGFjZShcImRpcFwiLCBcIlwiKS50cmltKCkpO1xuICAgIH1cbn1cbmV4cG9ydHMudHJhbnNsYXRlWFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7IG5hbWU6IFwidHJhbnNsYXRlWFwiLCBjc3NOYW1lOiBcInRyYW5zbGF0ZVhcIiwgZGVmYXVsdFZhbHVlOiAwLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VESVBzIH0pO1xuZXhwb3J0cy50cmFuc2xhdGVYUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMudHJhbnNsYXRlWVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7IG5hbWU6IFwidHJhbnNsYXRlWVwiLCBjc3NOYW1lOiBcInRyYW5zbGF0ZVlcIiwgZGVmYXVsdFZhbHVlOiAwLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VESVBzIH0pO1xuZXhwb3J0cy50cmFuc2xhdGVZUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciB0cmFuc2Zvcm1Qcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidHJhbnNmb3JtXCIsIGNzc05hbWU6IFwidHJhbnNmb3JtXCIsXG4gICAgZ2V0dGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzY2FsZVggPSB0aGlzLnNjYWxlWDtcbiAgICAgICAgdmFyIHNjYWxlWSA9IHRoaXMuc2NhbGVZO1xuICAgICAgICB2YXIgdHJhbnNsYXRlWCA9IHRoaXMudHJhbnNsYXRlWDtcbiAgICAgICAgdmFyIHRyYW5zbGF0ZVkgPSB0aGlzLnRyYW5zbGF0ZVk7XG4gICAgICAgIHZhciByb3RhdGUgPSB0aGlzLnJvdGF0ZTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFwiXCI7XG4gICAgICAgIGlmICh0cmFuc2xhdGVYICE9PSAwIHx8IHRyYW5zbGF0ZVkgIT09IDApIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcInRyYW5zbGF0ZShcIiArIHRyYW5zbGF0ZVggKyBcIiwgXCIgKyB0cmFuc2xhdGVZICsgXCIpIFwiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzY2FsZVggIT09IDEgfHwgc2NhbGVZICE9PSAxKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJzY2FsZShcIiArIHNjYWxlWCArIFwiLCBcIiArIHNjYWxlWSArIFwiKSBcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAocm90YXRlICE9PSAwKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJyb3RhdGUgKFwiICsgcm90YXRlICsgXCIpXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdC50cmltKCk7XG4gICAgfSxcbiAgICBjb252ZXJ0ZXI6IGNvbnZlcnRUb1RyYW5zZm9ybVxufSk7XG50cmFuc2Zvcm1Qcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIElERU5USVRZX1RSQU5TRk9STUFUSU9OID0ge1xuICAgIHRyYW5zbGF0ZTogeyB4OiAwLCB5OiAwIH0sXG4gICAgcm90YXRlOiAwLFxuICAgIHNjYWxlOiB7IHg6IDEsIHk6IDEgfSxcbn07XG52YXIgVFJBTlNGT1JNX1NQTElUVEVSID0gbmV3IFJlZ0V4cCgvXFxzKiguKz8pXFwoKC4qPylcXCkvZyk7XG52YXIgVFJBTlNGT1JNQVRJT05TID0gT2JqZWN0LmZyZWV6ZShbXG4gICAgXCJyb3RhdGVcIixcbiAgICBcInRyYW5zbGF0ZVwiLFxuICAgIFwidHJhbnNsYXRlM2RcIixcbiAgICBcInRyYW5zbGF0ZVhcIixcbiAgICBcInRyYW5zbGF0ZVlcIixcbiAgICBcInNjYWxlXCIsXG4gICAgXCJzY2FsZTNkXCIsXG4gICAgXCJzY2FsZVhcIixcbiAgICBcInNjYWxlWVwiLFxuXSk7XG52YXIgU1RZTEVfVFJBTlNGT1JNQVRJT05fTUFQID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgXCJzY2FsZVwiOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuICh7IHByb3BlcnR5OiBcInNjYWxlXCIsIHZhbHVlOiB2YWx1ZSB9KTsgfSxcbiAgICBcInNjYWxlM2RcIjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiAoeyBwcm9wZXJ0eTogXCJzY2FsZVwiLCB2YWx1ZTogdmFsdWUgfSk7IH0sXG4gICAgXCJzY2FsZVhcIjogZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgIHZhciB4ID0gX2EueDtcbiAgICAgICAgcmV0dXJuICh7IHByb3BlcnR5OiBcInNjYWxlXCIsIHZhbHVlOiB7IHg6IHgsIHk6IElERU5USVRZX1RSQU5TRk9STUFUSU9OLnNjYWxlLnkgfSB9KTtcbiAgICB9LFxuICAgIFwic2NhbGVZXCI6IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgeSA9IF9hLnk7XG4gICAgICAgIHJldHVybiAoeyBwcm9wZXJ0eTogXCJzY2FsZVwiLCB2YWx1ZTogeyB5OiB5LCB4OiBJREVOVElUWV9UUkFOU0ZPUk1BVElPTi5zY2FsZS54IH0gfSk7XG4gICAgfSxcbiAgICBcInRyYW5zbGF0ZVwiOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuICh7IHByb3BlcnR5OiBcInRyYW5zbGF0ZVwiLCB2YWx1ZTogdmFsdWUgfSk7IH0sXG4gICAgXCJ0cmFuc2xhdGUzZFwiOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuICh7IHByb3BlcnR5OiBcInRyYW5zbGF0ZVwiLCB2YWx1ZTogdmFsdWUgfSk7IH0sXG4gICAgXCJ0cmFuc2xhdGVYXCI6IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgeCA9IF9hLng7XG4gICAgICAgIHJldHVybiAoeyBwcm9wZXJ0eTogXCJ0cmFuc2xhdGVcIiwgdmFsdWU6IHsgeDogeCwgeTogSURFTlRJVFlfVFJBTlNGT1JNQVRJT04udHJhbnNsYXRlLnkgfSB9KTtcbiAgICB9LFxuICAgIFwidHJhbnNsYXRlWVwiOiBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIHkgPSBfYS55O1xuICAgICAgICByZXR1cm4gKHsgcHJvcGVydHk6IFwidHJhbnNsYXRlXCIsIHZhbHVlOiB7IHk6IHksIHg6IElERU5USVRZX1RSQU5TRk9STUFUSU9OLnRyYW5zbGF0ZS54IH0gfSk7XG4gICAgfSxcbiAgICBcInJvdGF0ZVwiOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuICh7IHByb3BlcnR5OiBcInJvdGF0ZVwiLCB2YWx1ZTogdmFsdWUgfSk7IH0sXG59KTtcbmZ1bmN0aW9uIGNvbnZlcnRUb1RyYW5zZm9ybSh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gcHJvcGVydGllc18xLnVuc2V0VmFsdWUpIHtcbiAgICAgICAgdmFsdWUgPSBcIm5vbmVcIjtcbiAgICB9XG4gICAgdmFyIF9hID0gdHJhbnNmb3JtQ29udmVydGVyKHZhbHVlKSwgdHJhbnNsYXRlID0gX2EudHJhbnNsYXRlLCByb3RhdGUgPSBfYS5yb3RhdGUsIHNjYWxlID0gX2Euc2NhbGU7XG4gICAgcmV0dXJuIFtcbiAgICAgICAgW2V4cG9ydHMudHJhbnNsYXRlWFByb3BlcnR5LCB0cmFuc2xhdGUueF0sXG4gICAgICAgIFtleHBvcnRzLnRyYW5zbGF0ZVlQcm9wZXJ0eSwgdHJhbnNsYXRlLnldLFxuICAgICAgICBbZXhwb3J0cy5zY2FsZVhQcm9wZXJ0eSwgc2NhbGUueF0sXG4gICAgICAgIFtleHBvcnRzLnNjYWxlWVByb3BlcnR5LCBzY2FsZS55XSxcbiAgICAgICAgW2V4cG9ydHMucm90YXRlUHJvcGVydHksIHJvdGF0ZV0sXG4gICAgXTtcbn1cbmZ1bmN0aW9uIHRyYW5zZm9ybUNvbnZlcnRlcih0ZXh0KSB7XG4gICAgdmFyIHRyYW5zZm9ybWF0aW9ucyA9IHBhcnNlVHJhbnNmb3JtU3RyaW5nKHRleHQpO1xuICAgIGlmICh0ZXh0ID09PSBcIm5vbmVcIiB8fCB0ZXh0ID09PSBcIlwiIHx8ICF0cmFuc2Zvcm1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBJREVOVElUWV9UUkFOU0ZPUk1BVElPTjtcbiAgICB9XG4gICAgdmFyIHVzZWRUcmFuc2Zvcm1zID0gdHJhbnNmb3JtYXRpb25zLm1hcChmdW5jdGlvbiAodCkgeyByZXR1cm4gdC5wcm9wZXJ0eTsgfSk7XG4gICAgaWYgKCF1dGlsc18xLmhhc0R1cGxpY2F0ZXModXNlZFRyYW5zZm9ybXMpKSB7XG4gICAgICAgIHZhciBmdWxsVHJhbnNmb3JtYXRpb25zXzEgPSBfX2Fzc2lnbih7fSwgSURFTlRJVFlfVFJBTlNGT1JNQVRJT04pO1xuICAgICAgICB0cmFuc2Zvcm1hdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAodHJhbnNmb3JtKSB7XG4gICAgICAgICAgICBmdWxsVHJhbnNmb3JtYXRpb25zXzFbdHJhbnNmb3JtLnByb3BlcnR5XSA9IHRyYW5zZm9ybS52YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmdWxsVHJhbnNmb3JtYXRpb25zXzE7XG4gICAgfVxuICAgIHZhciBhZmZpbmVNYXRyaXggPSB0cmFuc2Zvcm1hdGlvbnNcbiAgICAgICAgLm1hcChtYXRyaXhfMS5nZXRUcmFuc2Zvcm1NYXRyaXgpXG4gICAgICAgIC5yZWR1Y2UobWF0cml4XzEubXVsdGlwbHlBZmZpbmUyZCk7XG4gICAgdmFyIGNzc01hdHJpeCA9IG1hdHJpeF8xLm1hdHJpeEFycmF5VG9Dc3NNYXRyaXgoYWZmaW5lTWF0cml4KTtcbiAgICByZXR1cm4gbWF0cml4XzEuZGVjb21wb3NlMkRUcmFuc2Zvcm1NYXRyaXgoY3NzTWF0cml4KTtcbn1cbmV4cG9ydHMudHJhbnNmb3JtQ29udmVydGVyID0gdHJhbnNmb3JtQ29udmVydGVyO1xuZnVuY3Rpb24gcGFyc2VUcmFuc2Zvcm1TdHJpbmcodGV4dCkge1xuICAgIHZhciBtYXRjaGVzID0gW107XG4gICAgdmFyIG1hdGNoO1xuICAgIHdoaWxlICgobWF0Y2ggPSBUUkFOU0ZPUk1fU1BMSVRURVIuZXhlYyh0ZXh0KSkgIT09IG51bGwpIHtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gbWF0Y2hbMV07XG4gICAgICAgIHZhciB2YWx1ZSA9IGNvbnZlcnRUcmFuc2Zvcm1WYWx1ZShwcm9wZXJ0eSwgbWF0Y2hbMl0pO1xuICAgICAgICBpZiAoVFJBTlNGT1JNQVRJT05TLmluZGV4T2YocHJvcGVydHkpICE9PSAtMSkge1xuICAgICAgICAgICAgbWF0Y2hlcy5wdXNoKG5vcm1hbGl6ZVRyYW5zZm9ybWF0aW9uKHsgcHJvcGVydHk6IHByb3BlcnR5LCB2YWx1ZTogdmFsdWUgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXRjaGVzO1xufVxuZnVuY3Rpb24gbm9ybWFsaXplVHJhbnNmb3JtYXRpb24oX2EpIHtcbiAgICB2YXIgcHJvcGVydHkgPSBfYS5wcm9wZXJ0eSwgdmFsdWUgPSBfYS52YWx1ZTtcbiAgICByZXR1cm4gU1RZTEVfVFJBTlNGT1JNQVRJT05fTUFQW3Byb3BlcnR5XSh2YWx1ZSk7XG59XG5mdW5jdGlvbiBjb252ZXJ0VHJhbnNmb3JtVmFsdWUocHJvcGVydHksIHN0cmluZ1ZhbHVlKSB7XG4gICAgdmFyIF9hID0gc3RyaW5nVmFsdWUuc3BsaXQoXCIsXCIpLm1hcChwYXJzZUZsb2F0KSwgeCA9IF9hWzBdLCBfYiA9IF9hWzFdLCB5ID0gX2IgPT09IHZvaWQgMCA/IHggOiBfYjtcbiAgICBpZiAocHJvcGVydHkgPT09IFwicm90YXRlXCIpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZ1ZhbHVlLnNsaWNlKC0zKSA9PT0gXCJyYWRcIiA/IG51bWJlcl91dGlsc18xLnJhZGlhbnNUb0RlZ3JlZXMoeCkgOiB4O1xuICAgIH1cbiAgICByZXR1cm4geyB4OiB4LCB5OiB5IH07XG59XG52YXIgYmFja2dyb3VuZFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kXCIsIGNzc05hbWU6IFwiYmFja2dyb3VuZFwiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYWNrZ3JvdW5kQ29sb3IgKyBcIiBcIiArIHRoaXMuYmFja2dyb3VuZEltYWdlICsgXCIgXCIgKyB0aGlzLmJhY2tncm91bmRSZXBlYXQgKyBcIiBcIiArIHRoaXMuYmFja2dyb3VuZFBvc2l0aW9uO1xuICAgIH0sXG4gICAgY29udmVydGVyOiBjb252ZXJ0VG9CYWNrZ3JvdW5kc1xufSk7XG5iYWNrZ3JvdW5kUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJhY2tncm91bmRJbnRlcm5hbFwiLFxuICAgIGNzc05hbWU6IFwiX2JhY2tncm91bmRJbnRlcm5hbFwiLFxuICAgIGRlZmF1bHRWYWx1ZTogYmFja2dyb3VuZF8xLkJhY2tncm91bmQuZGVmYXVsdFxufSk7XG5leHBvcnRzLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJhY2tncm91bmRJbWFnZVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kSW1hZ2VcIiwgY3NzTmFtZTogXCJiYWNrZ3JvdW5kLWltYWdlXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoSW1hZ2UobmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LFxuICAgIGVxdWFsaXR5Q29tcGFyZXI6IGZ1bmN0aW9uICh2YWx1ZTEsIHZhbHVlMikge1xuICAgICAgICBpZiAodmFsdWUxIGluc3RhbmNlb2YgbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQgJiYgdmFsdWUyIGluc3RhbmNlb2YgbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudC5lcXVhbHModmFsdWUxLCB2YWx1ZTIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlMSA9PT0gdmFsdWUyO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBwYXJzZWQgPSBwYXJzZXIucGFyc2VCYWNrZ3JvdW5kKHZhbHVlKTtcbiAgICAgICAgICAgIGlmIChwYXJzZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHBhcnNlZC52YWx1ZTtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9ICh0eXBlb2YgYmFja2dyb3VuZC5pbWFnZSA9PT0gXCJvYmplY3RcIikgPyBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudC5wYXJzZShiYWNrZ3JvdW5kLmltYWdlKSA6IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG59KTtcbmV4cG9ydHMuYmFja2dyb3VuZEltYWdlUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYmFja2dyb3VuZENvbG9yUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc0FuaW1hdGlvblByb3BlcnR5KHtcbiAgICBuYW1lOiBcImJhY2tncm91bmRDb2xvclwiLCBjc3NOYW1lOiBcImJhY2tncm91bmQtY29sb3JcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhDb2xvcihuZXdWYWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIGVxdWFsaXR5Q29tcGFyZXI6IGNvbG9yXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBuZXcgY29sb3JfMS5Db2xvcih2YWx1ZSk7IH1cbn0pO1xuZXhwb3J0cy5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIEJhY2tncm91bmRSZXBlYXQ7XG4oZnVuY3Rpb24gKEJhY2tncm91bmRSZXBlYXQpIHtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0LlJFUEVBVCA9IFwicmVwZWF0XCI7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5SRVBFQVRfWCA9IFwicmVwZWF0LXhcIjtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0LlJFUEVBVF9ZID0gXCJyZXBlYXQteVwiO1xuICAgIEJhY2tncm91bmRSZXBlYXQuTk9fUkVQRUFUID0gXCJuby1yZXBlYXRcIjtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0LmlzVmFsaWQgPSBwcm9wZXJ0aWVzXzEubWFrZVZhbGlkYXRvcihCYWNrZ3JvdW5kUmVwZWF0LlJFUEVBVCwgQmFja2dyb3VuZFJlcGVhdC5SRVBFQVRfWCwgQmFja2dyb3VuZFJlcGVhdC5SRVBFQVRfWSwgQmFja2dyb3VuZFJlcGVhdC5OT19SRVBFQVQpO1xuICAgIEJhY2tncm91bmRSZXBlYXQucGFyc2UgPSBwcm9wZXJ0aWVzXzEubWFrZVBhcnNlcihCYWNrZ3JvdW5kUmVwZWF0LmlzVmFsaWQpO1xufSkoQmFja2dyb3VuZFJlcGVhdCA9IGV4cG9ydHMuQmFja2dyb3VuZFJlcGVhdCB8fCAoZXhwb3J0cy5CYWNrZ3JvdW5kUmVwZWF0ID0ge30pKTtcbmV4cG9ydHMuYmFja2dyb3VuZFJlcGVhdFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kUmVwZWF0XCIsIGNzc05hbWU6IFwiYmFja2dyb3VuZC1yZXBlYXRcIiwgdmFsdWVDb252ZXJ0ZXI6IEJhY2tncm91bmRSZXBlYXQucGFyc2UsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhSZXBlYXQobmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9XG59KTtcbmV4cG9ydHMuYmFja2dyb3VuZFJlcGVhdFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJhY2tncm91bmRTaXplUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJhY2tncm91bmRTaXplXCIsIGNzc05hbWU6IFwiYmFja2dyb3VuZC1zaXplXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoU2l6ZShuZXdWYWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5iYWNrZ3JvdW5kU2l6ZVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJhY2tncm91bmRQb3NpdGlvblByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kUG9zaXRpb25cIiwgY3NzTmFtZTogXCJiYWNrZ3JvdW5kLXBvc2l0aW9uXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoUG9zaXRpb24obmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9XG59KTtcbmV4cG9ydHMuYmFja2dyb3VuZFBvc2l0aW9uUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmZ1bmN0aW9uIGNvbnZlcnRUb0JhY2tncm91bmRzKHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB2YXIgYmFja2dyb3VuZHMgPSBwYXJzZXIucGFyc2VCYWNrZ3JvdW5kKHZhbHVlKS52YWx1ZTtcbiAgICAgICAgdmFyIGJhY2tncm91bmRDb2xvciA9IGJhY2tncm91bmRzLmNvbG9yID8gbmV3IGNvbG9yXzEuQ29sb3IoYmFja2dyb3VuZHMuY29sb3IpIDogcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kSW1hZ2UgPSB2b2lkIDA7XG4gICAgICAgIGlmICh0eXBlb2YgYmFja2dyb3VuZHMuaW1hZ2UgPT09IFwib2JqZWN0XCIgJiYgYmFja2dyb3VuZHMuaW1hZ2UpIHtcbiAgICAgICAgICAgIGJhY2tncm91bmRJbWFnZSA9IGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50LnBhcnNlKGJhY2tncm91bmRzLmltYWdlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJhY2tncm91bmRJbWFnZSA9IGJhY2tncm91bmRzLmltYWdlIHx8IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kUmVwZWF0ID0gYmFja2dyb3VuZHMucmVwZWF0IHx8IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICB2YXIgYmFja2dyb3VuZFBvc2l0aW9uID0gYmFja2dyb3VuZHMucG9zaXRpb24gPyBiYWNrZ3JvdW5kcy5wb3NpdGlvbi50ZXh0IDogcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBbZXhwb3J0cy5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eSwgYmFja2dyb3VuZENvbG9yXSxcbiAgICAgICAgICAgIFtleHBvcnRzLmJhY2tncm91bmRJbWFnZVByb3BlcnR5LCBiYWNrZ3JvdW5kSW1hZ2VdLFxuICAgICAgICAgICAgW2V4cG9ydHMuYmFja2dyb3VuZFJlcGVhdFByb3BlcnR5LCBiYWNrZ3JvdW5kUmVwZWF0XSxcbiAgICAgICAgICAgIFtleHBvcnRzLmJhY2tncm91bmRQb3NpdGlvblByb3BlcnR5LCBiYWNrZ3JvdW5kUG9zaXRpb25dXG4gICAgICAgIF07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgW2V4cG9ydHMuYmFja2dyb3VuZENvbG9yUHJvcGVydHksIHByb3BlcnRpZXNfMS51bnNldFZhbHVlXSxcbiAgICAgICAgICAgIFtleHBvcnRzLmJhY2tncm91bmRJbWFnZVByb3BlcnR5LCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5iYWNrZ3JvdW5kUmVwZWF0UHJvcGVydHksIHByb3BlcnRpZXNfMS51bnNldFZhbHVlXSxcbiAgICAgICAgICAgIFtleHBvcnRzLmJhY2tncm91bmRQb3NpdGlvblByb3BlcnR5LCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZV1cbiAgICAgICAgXTtcbiAgICB9XG59XG5mdW5jdGlvbiBwYXJzZUJvcmRlckNvbG9yKHZhbHVlKSB7XG4gICAgdmFyIHJlc3VsdCA9IHsgdG9wOiB1bmRlZmluZWQsIHJpZ2h0OiB1bmRlZmluZWQsIGJvdHRvbTogdW5kZWZpbmVkLCBsZWZ0OiB1bmRlZmluZWQgfTtcbiAgICBpZiAodmFsdWUuaW5kZXhPZihcInJnYlwiKSA9PT0gMCkge1xuICAgICAgICByZXN1bHQudG9wID0gcmVzdWx0LnJpZ2h0ID0gcmVzdWx0LmJvdHRvbSA9IHJlc3VsdC5sZWZ0ID0gbmV3IGNvbG9yXzEuQ29sb3IodmFsdWUpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB2YXIgYXJyID0gdmFsdWUuc3BsaXQoL1sgLF0rLyk7XG4gICAgaWYgKGFyci5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgdmFyIGFycjAgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbMF0pO1xuICAgICAgICByZXN1bHQudG9wID0gYXJyMDtcbiAgICAgICAgcmVzdWx0LnJpZ2h0ID0gYXJyMDtcbiAgICAgICAgcmVzdWx0LmJvdHRvbSA9IGFycjA7XG4gICAgICAgIHJlc3VsdC5sZWZ0ID0gYXJyMDtcbiAgICB9XG4gICAgZWxzZSBpZiAoYXJyLmxlbmd0aCA9PT0gMikge1xuICAgICAgICB2YXIgYXJyMCA9IG5ldyBjb2xvcl8xLkNvbG9yKGFyclswXSk7XG4gICAgICAgIHZhciBhcnIxID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzFdKTtcbiAgICAgICAgcmVzdWx0LnRvcCA9IGFycjA7XG4gICAgICAgIHJlc3VsdC5yaWdodCA9IGFycjE7XG4gICAgICAgIHJlc3VsdC5ib3R0b20gPSBhcnIwO1xuICAgICAgICByZXN1bHQubGVmdCA9IGFycjE7XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgdmFyIGFycjAgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbMF0pO1xuICAgICAgICB2YXIgYXJyMSA9IG5ldyBjb2xvcl8xLkNvbG9yKGFyclsxXSk7XG4gICAgICAgIHZhciBhcnIyID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzJdKTtcbiAgICAgICAgcmVzdWx0LnRvcCA9IGFycjA7XG4gICAgICAgIHJlc3VsdC5yaWdodCA9IGFycjE7XG4gICAgICAgIHJlc3VsdC5ib3R0b20gPSBhcnIyO1xuICAgICAgICByZXN1bHQubGVmdCA9IGFycjE7XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDQpIHtcbiAgICAgICAgdmFyIGFycjAgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbMF0pO1xuICAgICAgICB2YXIgYXJyMSA9IG5ldyBjb2xvcl8xLkNvbG9yKGFyclsxXSk7XG4gICAgICAgIHZhciBhcnIyID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzJdKTtcbiAgICAgICAgdmFyIGFycjMgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbM10pO1xuICAgICAgICByZXN1bHQudG9wID0gYXJyMDtcbiAgICAgICAgcmVzdWx0LnJpZ2h0ID0gYXJyMTtcbiAgICAgICAgcmVzdWx0LmJvdHRvbSA9IGFycjI7XG4gICAgICAgIHJlc3VsdC5sZWZ0ID0gYXJyMztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV4cGVjdGVkIDEsIDIsIDMgb3IgNCBwYXJhbWV0ZXJzLiBBY3R1YWw6IFwiICsgdmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxudmFyIGJvcmRlckNvbG9yUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLlNob3J0aGFuZFByb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlckNvbG9yXCIsIGNzc05hbWU6IFwiYm9yZGVyLWNvbG9yXCIsXG4gICAgZ2V0dGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChjb2xvcl8xLkNvbG9yLmVxdWFscyh0aGlzLmJvcmRlclRvcENvbG9yLCB0aGlzLmJvcmRlclJpZ2h0Q29sb3IpICYmXG4gICAgICAgICAgICBjb2xvcl8xLkNvbG9yLmVxdWFscyh0aGlzLmJvcmRlclRvcENvbG9yLCB0aGlzLmJvcmRlckJvdHRvbUNvbG9yKSAmJlxuICAgICAgICAgICAgY29sb3JfMS5Db2xvci5lcXVhbHModGhpcy5ib3JkZXJUb3BDb2xvciwgdGhpcy5ib3JkZXJMZWZ0Q29sb3IpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BDb2xvcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcENvbG9yICsgXCIgXCIgKyB0aGlzLmJvcmRlclJpZ2h0Q29sb3IgKyBcIiBcIiArIHRoaXMuYm9yZGVyQm90dG9tQ29sb3IgKyBcIiBcIiArIHRoaXMuYm9yZGVyTGVmdENvbG9yO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBjb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB2YXIgZm91ckNvbG9ycyA9IHBhcnNlQm9yZGVyQ29sb3IodmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJUb3BDb2xvclByb3BlcnR5LCBmb3VyQ29sb3JzLnRvcF0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyUmlnaHRDb2xvclByb3BlcnR5LCBmb3VyQ29sb3JzLnJpZ2h0XSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJCb3R0b21Db2xvclByb3BlcnR5LCBmb3VyQ29sb3JzLmJvdHRvbV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyTGVmdENvbG9yUHJvcGVydHksIGZvdXJDb2xvcnMubGVmdF1cbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlclRvcENvbG9yUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJSaWdodENvbG9yUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJCb3R0b21Db2xvclByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyTGVmdENvbG9yUHJvcGVydHksIHZhbHVlXVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuYm9yZGVyQ29sb3JQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJUb3BDb2xvclByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJUb3BDb2xvclwiLCBjc3NOYW1lOiBcImJvcmRlci10b3AtY29sb3JcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJUb3BDb2xvcihuZXdWYWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIGVxdWFsaXR5Q29tcGFyZXI6IGNvbG9yXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBuZXcgY29sb3JfMS5Db2xvcih2YWx1ZSk7IH1cbn0pO1xuZXhwb3J0cy5ib3JkZXJUb3BDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlclJpZ2h0Q29sb3JQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYm9yZGVyUmlnaHRDb2xvclwiLCBjc3NOYW1lOiBcImJvcmRlci1yaWdodC1jb2xvclwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlclJpZ2h0Q29sb3IobmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCBlcXVhbGl0eUNvbXBhcmVyOiBjb2xvcl8xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gbmV3IGNvbG9yXzEuQ29sb3IodmFsdWUpOyB9XG59KTtcbmV4cG9ydHMuYm9yZGVyUmlnaHRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlckJvdHRvbUNvbG9yUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlckJvdHRvbUNvbG9yXCIsIGNzc05hbWU6IFwiYm9yZGVyLWJvdHRvbS1jb2xvclwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlckJvdHRvbUNvbG9yKG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgZXF1YWxpdHlDb21wYXJlcjogY29sb3JfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIG5ldyBjb2xvcl8xLkNvbG9yKHZhbHVlKTsgfVxufSk7XG5leHBvcnRzLmJvcmRlckJvdHRvbUNvbG9yUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyTGVmdENvbG9yUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlckxlZnRDb2xvclwiLCBjc3NOYW1lOiBcImJvcmRlci1sZWZ0LWNvbG9yXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoQm9yZGVyTGVmdENvbG9yKG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgZXF1YWxpdHlDb21wYXJlcjogY29sb3JfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIG5ldyBjb2xvcl8xLkNvbG9yKHZhbHVlKTsgfVxufSk7XG5leHBvcnRzLmJvcmRlckxlZnRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG52YXIgYm9yZGVyV2lkdGhQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYm9yZGVyV2lkdGhcIiwgY3NzTmFtZTogXCJib3JkZXItd2lkdGhcIixcbiAgICBnZXR0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKExlbmd0aC5lcXVhbHModGhpcy5ib3JkZXJUb3BXaWR0aCwgdGhpcy5ib3JkZXJSaWdodFdpZHRoKSAmJlxuICAgICAgICAgICAgTGVuZ3RoLmVxdWFscyh0aGlzLmJvcmRlclRvcFdpZHRoLCB0aGlzLmJvcmRlckJvdHRvbVdpZHRoKSAmJlxuICAgICAgICAgICAgTGVuZ3RoLmVxdWFscyh0aGlzLmJvcmRlclRvcFdpZHRoLCB0aGlzLmJvcmRlckxlZnRXaWR0aCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcFdpZHRoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJUb3BXaWR0aCkgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJSaWdodFdpZHRoKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLmJvcmRlckJvdHRvbVdpZHRoKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLmJvcmRlckxlZnRXaWR0aCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUgIT09IFwiYXV0b1wiKSB7XG4gICAgICAgICAgICB2YXIgYm9yZGVyV2lkdGhzID0gcGFyc2VUaGlja25lc3ModmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJUb3BXaWR0aFByb3BlcnR5LCBib3JkZXJXaWR0aHMudG9wXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJSaWdodFdpZHRoUHJvcGVydHksIGJvcmRlcldpZHRocy5yaWdodF0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyQm90dG9tV2lkdGhQcm9wZXJ0eSwgYm9yZGVyV2lkdGhzLmJvdHRvbV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyTGVmdFdpZHRoUHJvcGVydHksIGJvcmRlcldpZHRocy5sZWZ0XVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wV2lkdGhQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlclJpZ2h0V2lkdGhQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckJvdHRvbVdpZHRoUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJMZWZ0V2lkdGhQcm9wZXJ0eSwgdmFsdWVdXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5ib3JkZXJXaWR0aFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlclRvcFdpZHRoUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlclRvcFdpZHRoXCIsIGNzc05hbWU6IFwiYm9yZGVyLXRvcC13aWR0aFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICBpZiAoIWlzTm9uTmVnYXRpdmVGaW5pdGVOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJib3JkZXItdG9wLXdpZHRoIHNob3VsZCBiZSBOb24tTmVnYXRpdmUgRmluaXRlIG51bWJlci4gVmFsdWU6IFwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoQm9yZGVyVG9wV2lkdGgodmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMuYm9yZGVyVG9wV2lkdGhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJSaWdodFdpZHRoUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlclJpZ2h0V2lkdGhcIiwgY3NzTmFtZTogXCJib3JkZXItcmlnaHQtd2lkdGhcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgaWYgKCFpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9yZGVyLXJpZ2h0LXdpZHRoIHNob3VsZCBiZSBOb24tTmVnYXRpdmUgRmluaXRlIG51bWJlci4gVmFsdWU6IFwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJSaWdodFdpZHRoKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlclJpZ2h0V2lkdGhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJCb3R0b21XaWR0aFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJCb3R0b21XaWR0aFwiLCBjc3NOYW1lOiBcImJvcmRlci1ib3R0b20td2lkdGhcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgaWYgKCFpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9yZGVyLWJvdHRvbS13aWR0aCBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlckJvdHRvbVdpZHRoKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlckJvdHRvbVdpZHRoUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyTGVmdFdpZHRoUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlckxlZnRXaWR0aFwiLCBjc3NOYW1lOiBcImJvcmRlci1sZWZ0LXdpZHRoXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIGlmICghaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvcmRlci1sZWZ0LXdpZHRoIHNob3VsZCBiZSBOb24tTmVnYXRpdmUgRmluaXRlIG51bWJlci4gVmFsdWU6IFwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlckxlZnRXaWR0aCh2YWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5ib3JkZXJMZWZ0V2lkdGhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIGJvcmRlclJhZGl1c1Byb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJSYWRpdXNcIiwgY3NzTmFtZTogXCJib3JkZXItcmFkaXVzXCIsXG4gICAgZ2V0dGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChMZW5ndGguZXF1YWxzKHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cywgdGhpcy5ib3JkZXJUb3BSaWdodFJhZGl1cykgJiZcbiAgICAgICAgICAgIExlbmd0aC5lcXVhbHModGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzLCB0aGlzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzKSAmJlxuICAgICAgICAgICAgTGVuZ3RoLmVxdWFscyh0aGlzLmJvcmRlclRvcExlZnRSYWRpdXMsIHRoaXMuYm9yZGVyQm90dG9tTGVmdFJhZGl1cykpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcExlZnRSYWRpdXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLmJvcmRlclRvcFJpZ2h0UmFkaXVzKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXMpO1xuICAgIH0sXG4gICAgY29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIGJvcmRlclJhZGl1cyA9IHBhcnNlVGhpY2tuZXNzKHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wTGVmdFJhZGl1c1Byb3BlcnR5LCBib3JkZXJSYWRpdXMudG9wXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJUb3BSaWdodFJhZGl1c1Byb3BlcnR5LCBib3JkZXJSYWRpdXMucmlnaHRdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzUHJvcGVydHksIGJvcmRlclJhZGl1cy5ib3R0b21dLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXNQcm9wZXJ0eSwgYm9yZGVyUmFkaXVzLmxlZnRdXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJUb3BMZWZ0UmFkaXVzUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJUb3BSaWdodFJhZGl1c1Byb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXNQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXNQcm9wZXJ0eSwgdmFsdWVdXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5ib3JkZXJSYWRpdXNQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJUb3BMZWZ0UmFkaXVzUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlclRvcExlZnRSYWRpdXNcIiwgY3NzTmFtZTogXCJib3JkZXItdG9wLWxlZnQtcmFkaXVzXCIsIGRlZmF1bHRWYWx1ZTogMCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgaWYgKCFpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9yZGVyLXRvcC1sZWZ0LXJhZGl1cyBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlclRvcExlZnRSYWRpdXModmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMuYm9yZGVyVG9wTGVmdFJhZGl1c1Byb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlclRvcFJpZ2h0UmFkaXVzUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlclRvcFJpZ2h0UmFkaXVzXCIsIGNzc05hbWU6IFwiYm9yZGVyLXRvcC1yaWdodC1yYWRpdXNcIiwgZGVmYXVsdFZhbHVlOiAwLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICBpZiAoIWlzTm9uTmVnYXRpdmVGaW5pdGVOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJib3JkZXItdG9wLXJpZ2h0LXJhZGl1cyBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlclRvcFJpZ2h0UmFkaXVzKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlclRvcFJpZ2h0UmFkaXVzUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXNQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYm9yZGVyQm90dG9tUmlnaHRSYWRpdXNcIiwgY3NzTmFtZTogXCJib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1c1wiLCBkZWZhdWx0VmFsdWU6IDAsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIGlmICghaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzIHNob3VsZCBiZSBOb24tTmVnYXRpdmUgRmluaXRlIG51bWJlci4gVmFsdWU6IFwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoQm9yZGVyQm90dG9tUmlnaHRSYWRpdXModmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXNQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlckJvdHRvbUxlZnRSYWRpdXNcIiwgY3NzTmFtZTogXCJib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzXCIsIGRlZmF1bHRWYWx1ZTogMCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgaWYgKCFpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1cyBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlckJvdHRvbUxlZnRSYWRpdXModmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMuYm9yZGVyQm90dG9tTGVmdFJhZGl1c1Byb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5mdW5jdGlvbiBpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSB7XG4gICAgcmV0dXJuIGlzRmluaXRlKHZhbHVlKSAmJiAhaXNOYU4odmFsdWUpICYmIHZhbHVlID49IDA7XG59XG52YXIgc3VwcG9ydGVkUGF0aHMgPSBbXCJyZWN0XCIsIFwiY2lyY2xlXCIsIFwiZWxsaXBzZVwiLCBcInBvbHlnb25cIiwgXCJpbnNldFwiXTtcbmZ1bmN0aW9uIGlzQ2xpcFBhdGhWYWxpZCh2YWx1ZSkge1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHZhciBmdW5jdGlvbk5hbWUgPSB2YWx1ZS5zdWJzdHJpbmcoMCwgdmFsdWUuaW5kZXhPZihcIihcIikpLnRyaW0oKTtcbiAgICByZXR1cm4gc3VwcG9ydGVkUGF0aHMuaW5kZXhPZihmdW5jdGlvbk5hbWUpICE9PSAtMTtcbn1cbmV4cG9ydHMuY2xpcFBhdGhQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiY2xpcFBhdGhcIiwgY3NzTmFtZTogXCJjbGlwLXBhdGhcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKCFpc0NsaXBQYXRoVmFsaWQobmV3VmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjbGlwLXBhdGggaXMgbm90IHZhbGlkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aENsaXBQYXRoKG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfVxufSk7XG5leHBvcnRzLmNsaXBQYXRoUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmZ1bmN0aW9uIGlzRmxvYXRWYWx1ZUNvbnZlcnRlcih2YWx1ZSkge1xuICAgIHZhciBuZXdWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgIGlmIChpc05hTihuZXdWYWx1ZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyBuZXdWYWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiBuZXdWYWx1ZTtcbn1cbmV4cG9ydHMuekluZGV4UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJ6SW5kZXhcIiwgY3NzTmFtZTogXCJ6LWluZGV4XCIsIHZhbHVlQ29udmVydGVyOiBpc0Zsb2F0VmFsdWVDb252ZXJ0ZXIgfSk7XG5leHBvcnRzLnpJbmRleFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5mdW5jdGlvbiBvcGFjaXR5Q29udmVydGVyKHZhbHVlKSB7XG4gICAgdmFyIG5ld1ZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgaWYgKCFpc05hTihuZXdWYWx1ZSkgJiYgMCA8PSBuZXdWYWx1ZSAmJiBuZXdWYWx1ZSA8PSAxKSB7XG4gICAgICAgIHJldHVybiBuZXdWYWx1ZTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiT3BhY2l0eSBzaG91bGQgYmUgYmV0d2VlbiBbMCwgMV0uIFZhbHVlOiBcIiArIG5ld1ZhbHVlKTtcbn1cbmV4cG9ydHMub3BhY2l0eVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7IG5hbWU6IFwib3BhY2l0eVwiLCBjc3NOYW1lOiBcIm9wYWNpdHlcIiwgZGVmYXVsdFZhbHVlOiAxLCB2YWx1ZUNvbnZlcnRlcjogb3BhY2l0eUNvbnZlcnRlciB9KTtcbmV4cG9ydHMub3BhY2l0eVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmNvbG9yUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkluaGVyaXRlZENzc1Byb3BlcnR5KHsgbmFtZTogXCJjb2xvclwiLCBjc3NOYW1lOiBcImNvbG9yXCIsIGVxdWFsaXR5Q29tcGFyZXI6IGNvbG9yXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBjb2xvcl8xLkNvbG9yKHYpOyB9IH0pO1xuZXhwb3J0cy5jb2xvclByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmZvbnRJbnRlcm5hbFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiZm9udEludGVybmFsXCIsIGNzc05hbWU6IFwiX2ZvbnRJbnRlcm5hbFwiLCBkZWZhdWx0VmFsdWU6IGZvbnRfMS5Gb250LmRlZmF1bHQgfSk7XG5leHBvcnRzLmZvbnRJbnRlcm5hbFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmZvbnRGYW1pbHlQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuSW5oZXJpdGVkQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZm9udEZhbWlseVwiLCBjc3NOYW1lOiBcImZvbnQtZmFtaWx5XCIsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBjdXJyZW50Rm9udCA9IHRhcmdldC5mb250SW50ZXJuYWw7XG4gICAgICAgIGlmIChjdXJyZW50Rm9udC5mb250RmFtaWx5ICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIG5ld0ZvbnQgPSBjdXJyZW50Rm9udC53aXRoRm9udEZhbWlseShuZXdWYWx1ZSk7XG4gICAgICAgICAgICB0YXJnZXQuZm9udEludGVybmFsID0gZm9udF8xLkZvbnQuZXF1YWxzKGZvbnRfMS5Gb250LmRlZmF1bHQsIG5ld0ZvbnQpID8gcHJvcGVydGllc18xLnVuc2V0VmFsdWUgOiBuZXdGb250O1xuICAgICAgICB9XG4gICAgfVxufSk7XG5leHBvcnRzLmZvbnRGYW1pbHlQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5mb250U2l6ZVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJmb250U2l6ZVwiLCBjc3NOYW1lOiBcImZvbnQtc2l6ZVwiLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgY3VycmVudEZvbnQgPSB0YXJnZXQuZm9udEludGVybmFsO1xuICAgICAgICBpZiAoY3VycmVudEZvbnQuZm9udFNpemUgIT09IG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgbmV3Rm9udCA9IGN1cnJlbnRGb250LndpdGhGb250U2l6ZShuZXdWYWx1ZSk7XG4gICAgICAgICAgICB0YXJnZXQuZm9udEludGVybmFsID0gZm9udF8xLkZvbnQuZXF1YWxzKGZvbnRfMS5Gb250LmRlZmF1bHQsIG5ld0ZvbnQpID8gcHJvcGVydGllc18xLnVuc2V0VmFsdWUgOiBuZXdGb250O1xuICAgICAgICB9XG4gICAgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlRmxvYXQodik7IH1cbn0pO1xuZXhwb3J0cy5mb250U2l6ZVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmZvbnRTdHlsZVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJmb250U3R5bGVcIiwgY3NzTmFtZTogXCJmb250LXN0eWxlXCIsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGRlZmF1bHRWYWx1ZTogZm9udF8xLkZvbnRTdHlsZS5OT1JNQUwsIHZhbHVlQ29udmVydGVyOiBmb250XzEuRm9udFN0eWxlLnBhcnNlLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgY3VycmVudEZvbnQgPSB0YXJnZXQuZm9udEludGVybmFsO1xuICAgICAgICBpZiAoY3VycmVudEZvbnQuZm9udFN0eWxlICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIG5ld0ZvbnQgPSBjdXJyZW50Rm9udC53aXRoRm9udFN0eWxlKG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIHRhcmdldC5mb250SW50ZXJuYWwgPSBmb250XzEuRm9udC5lcXVhbHMoZm9udF8xLkZvbnQuZGVmYXVsdCwgbmV3Rm9udCkgPyBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZSA6IG5ld0ZvbnQ7XG4gICAgICAgIH1cbiAgICB9XG59KTtcbmV4cG9ydHMuZm9udFN0eWxlUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuZm9udFdlaWdodFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJmb250V2VpZ2h0XCIsIGNzc05hbWU6IFwiZm9udC13ZWlnaHRcIiwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZGVmYXVsdFZhbHVlOiBmb250XzEuRm9udFdlaWdodC5OT1JNQUwsIHZhbHVlQ29udmVydGVyOiBmb250XzEuRm9udFdlaWdodC5wYXJzZSwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRGb250ID0gdGFyZ2V0LmZvbnRJbnRlcm5hbDtcbiAgICAgICAgaWYgKGN1cnJlbnRGb250LmZvbnRXZWlnaHQgIT09IG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgbmV3Rm9udCA9IGN1cnJlbnRGb250LndpdGhGb250V2VpZ2h0KG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIHRhcmdldC5mb250SW50ZXJuYWwgPSBmb250XzEuRm9udC5lcXVhbHMoZm9udF8xLkZvbnQuZGVmYXVsdCwgbmV3Rm9udCkgPyBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZSA6IG5ld0ZvbnQ7XG4gICAgICAgIH1cbiAgICB9XG59KTtcbmV4cG9ydHMuZm9udFdlaWdodFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG52YXIgZm9udFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJmb250XCIsIGNzc05hbWU6IFwiZm9udFwiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mb250U3R5bGUgKyBcIiBcIiArIHRoaXMuZm9udFdlaWdodCArIFwiIFwiICsgdGhpcy5mb250U2l6ZSArIFwiIFwiICsgdGhpcy5mb250RmFtaWx5O1xuICAgIH0sXG4gICAgY29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250U3R5bGVQcm9wZXJ0eSwgcHJvcGVydGllc18xLnVuc2V0VmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmZvbnRXZWlnaHRQcm9wZXJ0eSwgcHJvcGVydGllc18xLnVuc2V0VmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmZvbnRTaXplUHJvcGVydHksIHByb3BlcnRpZXNfMS51bnNldFZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250RmFtaWx5UHJvcGVydHksIHByb3BlcnRpZXNfMS51bnNldFZhbHVlXVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBmb250ID0gZm9udF8xLnBhcnNlRm9udCh2YWx1ZSk7XG4gICAgICAgICAgICB2YXIgZm9udFNpemUgPSBwYXJzZUZsb2F0KGZvbnQuZm9udFNpemUpO1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250U3R5bGVQcm9wZXJ0eSwgZm9udC5mb250U3R5bGVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmZvbnRXZWlnaHRQcm9wZXJ0eSwgZm9udC5mb250V2VpZ2h0XSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250U2l6ZVByb3BlcnR5LCBmb250U2l6ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuZm9udEZhbWlseVByb3BlcnR5LCBmb250LmZvbnRGYW1pbHldXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5mb250UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBWaXNpYmlsaXR5O1xuKGZ1bmN0aW9uIChWaXNpYmlsaXR5KSB7XG4gICAgVmlzaWJpbGl0eS5WSVNJQkxFID0gXCJ2aXNpYmxlXCI7XG4gICAgVmlzaWJpbGl0eS5ISURERU4gPSBcImhpZGRlblwiO1xuICAgIFZpc2liaWxpdHkuQ09MTEFQU0UgPSBcImNvbGxhcHNlXCI7XG4gICAgVmlzaWJpbGl0eS5pc1ZhbGlkID0gcHJvcGVydGllc18xLm1ha2VWYWxpZGF0b3IoVmlzaWJpbGl0eS5WSVNJQkxFLCBWaXNpYmlsaXR5LkhJRERFTiwgVmlzaWJpbGl0eS5DT0xMQVBTRSk7XG4gICAgVmlzaWJpbGl0eS5wYXJzZSA9IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJjb2xsYXBzZWRcIiA/IFZpc2liaWxpdHkuQ09MTEFQU0UgOiBwYXJzZVN0cmljdCh2YWx1ZSk7IH07XG4gICAgdmFyIHBhcnNlU3RyaWN0ID0gcHJvcGVydGllc18xLm1ha2VQYXJzZXIoVmlzaWJpbGl0eS5pc1ZhbGlkKTtcbn0pKFZpc2liaWxpdHkgPSBleHBvcnRzLlZpc2liaWxpdHkgfHwgKGV4cG9ydHMuVmlzaWJpbGl0eSA9IHt9KSk7XG5leHBvcnRzLnZpc2liaWxpdHlQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidmlzaWJpbGl0eVwiLCBjc3NOYW1lOiBcInZpc2liaWxpdHlcIiwgZGVmYXVsdFZhbHVlOiBWaXNpYmlsaXR5LlZJU0lCTEUsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBWaXNpYmlsaXR5LnBhcnNlLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5pc0NvbGxhcHNlZCA9IChuZXdWYWx1ZSA9PT0gVmlzaWJpbGl0eS5DT0xMQVBTRSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5leHBvcnRzLnZpc2liaWxpdHlQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5hbmRyb2lkRWxldmF0aW9uUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJhbmRyb2lkRWxldmF0aW9uXCIsIGNzc05hbWU6IFwiYW5kcm9pZC1lbGV2YXRpb25cIiwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRmxvYXQgfSk7XG5leHBvcnRzLmFuZHJvaWRFbGV2YXRpb25Qcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5hbmRyb2lkRHluYW1pY0VsZXZhdGlvbk9mZnNldFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXRcIiwgY3NzTmFtZTogXCJhbmRyb2lkLWR5bmFtaWMtZWxldmF0aW9uLW9mZnNldFwiLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VGbG9hdCB9KTtcbmV4cG9ydHMuYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3R5bGUtcHJvcGVydGllcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL2NvcmUvcHJvcGVydGllc1wiKTtcbnZhciBjc3NfMSA9IHJlcXVpcmUoXCIuLi8uLi9jc3NcIik7XG52YXIgcGFyc2VyXzEgPSByZXF1aXJlKFwiLi4vLi4vY3NzL3BhcnNlclwiKTtcbnZhciBjc3Nfc2VsZWN0b3JfMSA9IHJlcXVpcmUoXCIuL2Nzcy1zZWxlY3RvclwiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uL3RyYWNlXCIpO1xudmFyIGZpbGVfc3lzdGVtXzEgPSByZXF1aXJlKFwiLi4vLi4vZmlsZS1zeXN0ZW1cIik7XG52YXIgYXBwbGljYXRpb25Db21tb24gPSByZXF1aXJlKFwiLi4vLi4vYXBwbGljYXRpb24vYXBwbGljYXRpb24tY29tbW9uXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbnZhciBrZXlmcmFtZUFuaW1hdGlvbk1vZHVsZTtcbmZ1bmN0aW9uIGVuc3VyZUtleWZyYW1lQW5pbWF0aW9uTW9kdWxlKCkge1xuICAgIGlmICgha2V5ZnJhbWVBbmltYXRpb25Nb2R1bGUpIHtcbiAgICAgICAga2V5ZnJhbWVBbmltYXRpb25Nb2R1bGUgPSByZXF1aXJlKFwiLi4vYW5pbWF0aW9uL2tleWZyYW1lLWFuaW1hdGlvblwiKTtcbiAgICB9XG59XG52YXIgbW9kdWxlX25hbWVfc2FuaXRpemVyXzEgPSByZXF1aXJlKFwiLi4vYnVpbGRlci9tb2R1bGUtbmFtZS1zYW5pdGl6ZXJcIik7XG52YXIgbW9kdWxlX25hbWVfcmVzb2x2ZXJfMSA9IHJlcXVpcmUoXCIuLi8uLi9tb2R1bGUtbmFtZS1yZXNvbHZlclwiKTtcbnZhciBjc3NBbmltYXRpb25QYXJzZXJNb2R1bGU7XG5mdW5jdGlvbiBlbnN1cmVDc3NBbmltYXRpb25QYXJzZXJNb2R1bGUoKSB7XG4gICAgaWYgKCFjc3NBbmltYXRpb25QYXJzZXJNb2R1bGUpIHtcbiAgICAgICAgY3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlID0gcmVxdWlyZShcIi4vY3NzLWFuaW1hdGlvbi1wYXJzZXJcIik7XG4gICAgfVxufVxudmFyIHBhcnNlciA9IFwicmV3b3JrXCI7XG50cnkge1xuICAgIHZhciBhcHBDb25maWcgPSByZXF1aXJlKFwifi9wYWNrYWdlLmpzb25cIik7XG4gICAgaWYgKGFwcENvbmZpZyAmJiBhcHBDb25maWcuY3NzUGFyc2VyID09PSBcIm5hdGl2ZXNjcmlwdFwiKSB7XG4gICAgICAgIHBhcnNlciA9IFwibmF0aXZlc2NyaXB0XCI7XG4gICAgfVxufVxuY2F0Y2ggKGUpIHtcbn1cbmZ1bmN0aW9uIGV2YWx1YXRlQ3NzRXhwcmVzc2lvbnModmlldywgcHJvcGVydHksIHZhbHVlKSB7XG4gICAgdmFyIG5ld1ZhbHVlID0gcHJvcGVydGllc18xLl9ldmFsdWF0ZUNzc1ZhcmlhYmxlRXhwcmVzc2lvbih2aWV3LCBwcm9wZXJ0eSwgdmFsdWUpO1xuICAgIGlmIChuZXdWYWx1ZSA9PT0gXCJ1bnNldFwiKSB7XG4gICAgICAgIHJldHVybiBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICB9XG4gICAgdmFsdWUgPSBuZXdWYWx1ZTtcbiAgICB0cnkge1xuICAgICAgICB2YWx1ZSA9IHByb3BlcnRpZXNfMS5fZXZhbHVhdGVDc3NDYWxjRXhwcmVzc2lvbih2YWx1ZSk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHRyYWNlXzEud3JpdGUoXCJGYWlsZWQgdG8gZXZhbHVhdGUgY3NzLWNhbGMgZm9yIHByb3BlcnR5IFtcIiArIHByb3BlcnR5ICsgXCJdIGZvciBleHByZXNzaW9uIFtcIiArIHZhbHVlICsgXCJdIHRvIFwiICsgdmlldyArIFwiLiBcIiArIGUuc3RhY2ssIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgIHJldHVybiBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gbWVyZ2VDc3NTZWxlY3RvcnMoKSB7XG4gICAgYXBwbGljYXRpb25Dc3NTZWxlY3RvcnMgPSBhcHBsaWNhdGlvblNlbGVjdG9ycy5zbGljZSgpO1xuICAgIGFwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzLnB1c2guYXBwbHkoYXBwbGljYXRpb25Dc3NTZWxlY3RvcnMsIGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycyk7XG4gICAgYXBwbGljYXRpb25Dc3NTZWxlY3RvclZlcnNpb24rKztcbn1cbmV4cG9ydHMubWVyZ2VDc3NTZWxlY3RvcnMgPSBtZXJnZUNzc1NlbGVjdG9ycztcbnZhciBhcHBsaWNhdGlvbkNzc1NlbGVjdG9ycyA9IFtdO1xudmFyIGFwcGxpY2F0aW9uQ3NzU2VsZWN0b3JWZXJzaW9uID0gMDtcbnZhciBhcHBsaWNhdGlvblNlbGVjdG9ycyA9IFtdO1xudmFyIGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycyA9IFtdO1xudmFyIGFwcGxpY2F0aW9uS2V5ZnJhbWVzID0ge307XG52YXIgYW5pbWF0aW9uc1N5bWJvbCA9IFN5bWJvbChcImFuaW1hdGlvbnNcIik7XG52YXIgcGF0dGVybiA9IC8oJ3xcIikoLio/KVxcMS87XG52YXIgQ1NTU291cmNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDU1NTb3VyY2UoX2FzdCwgX3VybCwgX2ZpbGUsIF9rZXlmcmFtZXMsIF9zb3VyY2UpIHtcbiAgICAgICAgdGhpcy5fYXN0ID0gX2FzdDtcbiAgICAgICAgdGhpcy5fdXJsID0gX3VybDtcbiAgICAgICAgdGhpcy5fZmlsZSA9IF9maWxlO1xuICAgICAgICB0aGlzLl9rZXlmcmFtZXMgPSBfa2V5ZnJhbWVzO1xuICAgICAgICB0aGlzLl9zb3VyY2UgPSBfc291cmNlO1xuICAgICAgICB0aGlzLl9zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgdGhpcy5wYXJzZSgpO1xuICAgIH1cbiAgICBDU1NTb3VyY2UuZnJvbVVSSSA9IGZ1bmN0aW9uICh1cmksIGtleWZyYW1lcykge1xuICAgICAgICB2YXIgYXBwUmVsYXRpdmVVcmkgPSBDU1NTb3VyY2UucGF0aFJlbGF0aXZlVG9BcHAodXJpKTtcbiAgICAgICAgdmFyIHNhbml0aXplZE1vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMS5zYW5pdGl6ZU1vZHVsZU5hbWUoYXBwUmVsYXRpdmVVcmkpO1xuICAgICAgICB2YXIgcmVzb2x2ZWRNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfcmVzb2x2ZXJfMS5yZXNvbHZlTW9kdWxlTmFtZShzYW5pdGl6ZWRNb2R1bGVOYW1lLCBcImNzc1wiKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBjc3NPckFzdCA9IGdsb2JhbC5sb2FkTW9kdWxlKHJlc29sdmVkTW9kdWxlTmFtZSwgdHJ1ZSk7XG4gICAgICAgICAgICBpZiAoY3NzT3JBc3QpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNzc09yQXN0ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBDU1NTb3VyY2UuZnJvbVNvdXJjZShjc3NPckFzdCwga2V5ZnJhbWVzLCByZXNvbHZlZE1vZHVsZU5hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgY3NzT3JBc3QgPT09IFwib2JqZWN0XCIgJiYgY3NzT3JBc3QudHlwZSA9PT0gXCJzdHlsZXNoZWV0XCIgJiYgY3NzT3JBc3Quc3R5bGVzaGVldCAmJiBjc3NPckFzdC5zdHlsZXNoZWV0LnJ1bGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBDU1NTb3VyY2UuZnJvbUFTVChjc3NPckFzdCwga2V5ZnJhbWVzLCByZXNvbHZlZE1vZHVsZU5hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIENTU1NvdXJjZS5mcm9tU291cmNlKGNzc09yQXN0LnRvU3RyaW5nKCksIGtleWZyYW1lcywgcmVzb2x2ZWRNb2R1bGVOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDb3VsZCBub3QgbG9hZCBDU1MgZnJvbSBcIiArIHVyaSArIFwiOiBcIiArIGUsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIENTU1NvdXJjZS5mcm9tRmlsZShhcHBSZWxhdGl2ZVVyaSwga2V5ZnJhbWVzKTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5wYXRoUmVsYXRpdmVUb0FwcCA9IGZ1bmN0aW9uICh1cmkpIHtcbiAgICAgICAgaWYgKCF1cmkuc3RhcnRzV2l0aChcIi9cIikpIHtcbiAgICAgICAgICAgIHJldHVybiB1cmk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFwcFBhdGggPSBmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aDtcbiAgICAgICAgaWYgKCF1cmkuc3RhcnRzV2l0aChhcHBQYXRoKSkge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZSh1cmkgKyBcIiBkb2VzIG5vdCBzdGFydCB3aXRoIFwiICsgYXBwUGF0aCwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB1cmk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlbGF0aXZlVXJpID0gXCIuXCIgKyB1cmkuc3Vic3RyKGFwcFBhdGgubGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIHJlbGF0aXZlVXJpO1xuICAgIH07XG4gICAgQ1NTU291cmNlLmZyb21GaWxlID0gZnVuY3Rpb24gKHVybCwga2V5ZnJhbWVzKSB7XG4gICAgICAgIHZhciBjc3NGaWxlVXJsID0gdXJsLnJlcGxhY2UoL1xcLi5cXHcrJC8sIFwiLmNzc1wiKTtcbiAgICAgICAgaWYgKGNzc0ZpbGVVcmwgIT09IHVybCkge1xuICAgICAgICAgICAgdmFyIGNzc0ZpbGUgPSBDU1NTb3VyY2UucmVzb2x2ZUNTU1BhdGhGcm9tVVJMKGNzc0ZpbGVVcmwpO1xuICAgICAgICAgICAgaWYgKGNzc0ZpbGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENTU1NvdXJjZSh1bmRlZmluZWQsIHVybCwgY3NzRmlsZSwga2V5ZnJhbWVzLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBmaWxlID0gQ1NTU291cmNlLnJlc29sdmVDU1NQYXRoRnJvbVVSTCh1cmwpO1xuICAgICAgICByZXR1cm4gbmV3IENTU1NvdXJjZSh1bmRlZmluZWQsIHVybCwgZmlsZSwga2V5ZnJhbWVzLCB1bmRlZmluZWQpO1xuICAgIH07XG4gICAgQ1NTU291cmNlLmZyb21GaWxlSW1wb3J0ID0gZnVuY3Rpb24gKHVybCwga2V5ZnJhbWVzLCBpbXBvcnRTb3VyY2UpIHtcbiAgICAgICAgdmFyIGZpbGUgPSBDU1NTb3VyY2UucmVzb2x2ZUNTU1BhdGhGcm9tVVJMKHVybCwgaW1wb3J0U291cmNlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBDU1NTb3VyY2UodW5kZWZpbmVkLCB1cmwsIGZpbGUsIGtleWZyYW1lcywgdW5kZWZpbmVkKTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5yZXNvbHZlQ1NTUGF0aEZyb21VUkwgPSBmdW5jdGlvbiAodXJsLCBpbXBvcnRTb3VyY2UpIHtcbiAgICAgICAgdmFyIGFwcCA9IGZpbGVfc3lzdGVtXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoO1xuICAgICAgICB2YXIgZmlsZSA9IHJlc29sdmVGaWxlTmFtZUZyb21VcmwodXJsLCBhcHAsIGZpbGVfc3lzdGVtXzEuRmlsZS5leGlzdHMsIGltcG9ydFNvdXJjZSk7XG4gICAgICAgIHJldHVybiBmaWxlO1xuICAgIH07XG4gICAgQ1NTU291cmNlLmZyb21Tb3VyY2UgPSBmdW5jdGlvbiAoc291cmNlLCBrZXlmcmFtZXMsIHVybCkge1xuICAgICAgICByZXR1cm4gbmV3IENTU1NvdXJjZSh1bmRlZmluZWQsIHVybCwgdW5kZWZpbmVkLCBrZXlmcmFtZXMsIHNvdXJjZSk7XG4gICAgfTtcbiAgICBDU1NTb3VyY2UuZnJvbUFTVCA9IGZ1bmN0aW9uIChhc3QsIGtleWZyYW1lcywgdXJsKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ1NTU291cmNlKGFzdCwgdXJsLCB1bmRlZmluZWQsIGtleWZyYW1lcywgdW5kZWZpbmVkKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDU1NTb3VyY2UucHJvdG90eXBlLCBcInNlbGVjdG9yc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fc2VsZWN0b3JzOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ1NTU291cmNlLnByb3RvdHlwZSwgXCJzb3VyY2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX3NvdXJjZTsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQ1NTU291cmNlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZmlsZSA9IGZpbGVfc3lzdGVtXzEuRmlsZS5mcm9tUGF0aCh0aGlzLl9maWxlKTtcbiAgICAgICAgdGhpcy5fc291cmNlID0gZmlsZS5yZWFkVGV4dFN5bmMoKTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2FzdCkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fc291cmNlICYmIHRoaXMuX2ZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zb3VyY2UgJiYgdGhpcy5zb3VyY2UgIT09IFwiW29iamVjdCBPYmplY3RdXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZUNTU0FzdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9hc3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZVNlbGVjdG9ycygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0b3JzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDc3Mgc3R5bGluZyBmYWlsZWQ6IFwiICsgZSwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdG9ycyA9IFtdO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDU1NTb3VyY2UucHJvdG90eXBlLnBhcnNlQ1NTQXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fc291cmNlKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHBhcnNlcikge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJuYXRpdmVzY3JpcHRcIjpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNzc3BhcnNlciA9IG5ldyBwYXJzZXJfMS5DU1MzUGFyc2VyKHRoaXMuX3NvdXJjZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdHlsZXNoZWV0ID0gY3NzcGFyc2VyLnBhcnNlQVN0eWxlc2hlZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNzc05TID0gbmV3IHBhcnNlcl8xLkNTU05hdGl2ZVNjcmlwdCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hc3QgPSBjc3NOUy5wYXJzZVN0eWxlc2hlZXQoc3R5bGVzaGVldCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICBjYXNlIFwicmV3b3JrXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FzdCA9IGNzc18xLnBhcnNlKHRoaXMuX3NvdXJjZSwgeyBzb3VyY2U6IHRoaXMuX2ZpbGUgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ1NTU291cmNlLnByb3RvdHlwZS5jcmVhdGVTZWxlY3RvcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9hc3QpIHtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdG9ycyA9IF9fc3ByZWFkQXJyYXlzKHRoaXMuY3JlYXRlU2VsZWN0b3JzRnJvbUltcG9ydHMoKSwgdGhpcy5jcmVhdGVTZWxlY3RvcnNGcm9tU3ludGF4VHJlZSgpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ1NTU291cmNlLnByb3RvdHlwZS5jcmVhdGVTZWxlY3RvcnNGcm9tSW1wb3J0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGltcG9ydHMgPSB0aGlzLl9hc3RbXCJzdHlsZXNoZWV0XCJdW1wicnVsZXNcIl0uZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnR5cGUgPT09IFwiaW1wb3J0XCI7IH0pO1xuICAgICAgICB2YXIgdXJsRnJvbUltcG9ydE9iamVjdCA9IGZ1bmN0aW9uIChpbXBvcnRPYmplY3QpIHtcbiAgICAgICAgICAgIHZhciBpbXBvcnRJdGVtID0gaW1wb3J0T2JqZWN0W1wiaW1wb3J0XCJdO1xuICAgICAgICAgICAgdmFyIHVybE1hdGNoID0gaW1wb3J0SXRlbSAmJiBpbXBvcnRJdGVtLm1hdGNoKHBhdHRlcm4pO1xuICAgICAgICAgICAgcmV0dXJuIHVybE1hdGNoICYmIHVybE1hdGNoWzJdO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgc291cmNlRnJvbUltcG9ydE9iamVjdCA9IGZ1bmN0aW9uIChpbXBvcnRPYmplY3QpIHtcbiAgICAgICAgICAgIHJldHVybiBpbXBvcnRPYmplY3RbXCJwb3NpdGlvblwiXSAmJiBpbXBvcnRPYmplY3RbXCJwb3NpdGlvblwiXVtcInNvdXJjZVwiXTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHRvVXJsU291cmNlUGFpciA9IGZ1bmN0aW9uIChpbXBvcnRPYmplY3QpIHsgcmV0dXJuICh7XG4gICAgICAgICAgICB1cmw6IHVybEZyb21JbXBvcnRPYmplY3QoaW1wb3J0T2JqZWN0KSxcbiAgICAgICAgICAgIHNvdXJjZTogc291cmNlRnJvbUltcG9ydE9iamVjdChpbXBvcnRPYmplY3QpLFxuICAgICAgICB9KTsgfTtcbiAgICAgICAgdmFyIGdldENzc0ZpbGUgPSBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBfYS51cmwsIHNvdXJjZSA9IF9hLnNvdXJjZTtcbiAgICAgICAgICAgIHJldHVybiBzb3VyY2UgP1xuICAgICAgICAgICAgICAgIENTU1NvdXJjZS5mcm9tRmlsZUltcG9ydCh1cmwsIF90aGlzLl9rZXlmcmFtZXMsIHNvdXJjZSkgOlxuICAgICAgICAgICAgICAgIENTU1NvdXJjZS5mcm9tVVJJKHVybCwgX3RoaXMuX2tleWZyYW1lcyk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBjc3NGaWxlcyA9IGltcG9ydHNcbiAgICAgICAgICAgIC5tYXAodG9VcmxTb3VyY2VQYWlyKVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBfYS51cmw7XG4gICAgICAgICAgICByZXR1cm4gISF1cmw7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAubWFwKGdldENzc0ZpbGUpO1xuICAgICAgICB2YXIgc2VsZWN0b3JzID0gY3NzRmlsZXMubWFwKGZ1bmN0aW9uIChmaWxlKSB7IHJldHVybiAoZmlsZSAmJiBmaWxlLnNlbGVjdG9ycykgfHwgW107IH0pO1xuICAgICAgICByZXR1cm4gc2VsZWN0b3JzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCB2YWwpIHsgcmV0dXJuIGFjYy5jb25jYXQodmFsKTsgfSwgW10pO1xuICAgIH07XG4gICAgQ1NTU291cmNlLnByb3RvdHlwZS5jcmVhdGVTZWxlY3RvcnNGcm9tU3ludGF4VHJlZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIG5vZGVzID0gdGhpcy5fYXN0LnN0eWxlc2hlZXQucnVsZXM7XG4gICAgICAgIG5vZGVzLmZpbHRlcihpc0tleWZyYW1lKS5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBfdGhpcy5fa2V5ZnJhbWVzW25vZGUubmFtZV0gPSBub2RlOyB9KTtcbiAgICAgICAgdmFyIHJ1bGVzZXRzID0gY3NzX3NlbGVjdG9yXzEuZnJvbUFzdE5vZGVzKG5vZGVzKTtcbiAgICAgICAgaWYgKHJ1bGVzZXRzICYmIHJ1bGVzZXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgZW5zdXJlQ3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlKCk7XG4gICAgICAgICAgICBydWxlc2V0cy5mb3JFYWNoKGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgICAgICAgICAgcnVsZVthbmltYXRpb25zU3ltYm9sXSA9IGNzc0FuaW1hdGlvblBhcnNlck1vZHVsZS5Dc3NBbmltYXRpb25QYXJzZXJcbiAgICAgICAgICAgICAgICAgICAgLmtleWZyYW1lQW5pbWF0aW9uc0Zyb21DU1NEZWNsYXJhdGlvbnMocnVsZS5kZWNsYXJhdGlvbnMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJ1bGVzZXRzO1xuICAgIH07XG4gICAgQ1NTU291cmNlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbGUgfHwgdGhpcy5fdXJsIHx8IFwiKGluLW1lbW9yeSlcIjtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQ1NTU291cmNlLnByb3RvdHlwZSwgXCJsb2FkXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQ1NTU291cmNlLnByb3RvdHlwZSwgXCJwYXJzZVwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIENTU1NvdXJjZS5wcm90b3R5cGUsIFwicGFyc2VDU1NBc3RcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBDU1NTb3VyY2UucHJvdG90eXBlLCBcImNyZWF0ZVNlbGVjdG9yc1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIENTU1NvdXJjZSwgXCJyZXNvbHZlQ1NTUGF0aEZyb21VUkxcIiwgbnVsbCk7XG4gICAgcmV0dXJuIENTU1NvdXJjZTtcbn0oKSk7XG5mdW5jdGlvbiByZW1vdmVUYWdnZWRBZGRpdGlvbmFsQ1NTKHRhZykge1xuICAgIHZhciBjaGFuZ2VkID0gZmFsc2U7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcHBsaWNhdGlvbkFkZGl0aW9uYWxTZWxlY3RvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9yc1tpXS50YWcgPT09IHRhZykge1xuICAgICAgICAgICAgYXBwbGljYXRpb25BZGRpdGlvbmFsU2VsZWN0b3JzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIGktLTtcbiAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgIG1lcmdlQ3NzU2VsZWN0b3JzKCk7XG4gICAgfVxuICAgIHJldHVybiBjaGFuZ2VkO1xufVxuZXhwb3J0cy5yZW1vdmVUYWdnZWRBZGRpdGlvbmFsQ1NTID0gcmVtb3ZlVGFnZ2VkQWRkaXRpb25hbENTUztcbmZ1bmN0aW9uIGFkZFRhZ2dlZEFkZGl0aW9uYWxDU1MoY3NzVGV4dCwgdGFnKSB7XG4gICAgdmFyIHBhcnNlZCA9IENTU1NvdXJjZS5mcm9tU291cmNlKGNzc1RleHQsIGFwcGxpY2F0aW9uS2V5ZnJhbWVzLCB1bmRlZmluZWQpLnNlbGVjdG9ycztcbiAgICB2YXIgY2hhbmdlZCA9IGZhbHNlO1xuICAgIGlmIChwYXJzZWQgJiYgcGFyc2VkLmxlbmd0aCkge1xuICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRhZyAhPSBudWxsKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcnNlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHBhcnNlZFtpXS50YWcgPSB0YWc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXBwbGljYXRpb25BZGRpdGlvbmFsU2VsZWN0b3JzLnB1c2guYXBwbHkoYXBwbGljYXRpb25BZGRpdGlvbmFsU2VsZWN0b3JzLCBwYXJzZWQpO1xuICAgICAgICBtZXJnZUNzc1NlbGVjdG9ycygpO1xuICAgIH1cbiAgICByZXR1cm4gY2hhbmdlZDtcbn1cbmV4cG9ydHMuYWRkVGFnZ2VkQWRkaXRpb25hbENTUyA9IGFkZFRhZ2dlZEFkZGl0aW9uYWxDU1M7XG52YXIgb25Dc3NDaGFuZ2VkID0gcHJvZmlsaW5nXzEucHJvZmlsZShcIlxcXCJzdHlsZS1zY29wZVxcXCIub25Dc3NDaGFuZ2VkXCIsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgaWYgKGFyZ3MuY3NzVGV4dCkge1xuICAgICAgICB2YXIgcGFyc2VkID0gQ1NTU291cmNlLmZyb21Tb3VyY2UoYXJncy5jc3NUZXh0LCBhcHBsaWNhdGlvbktleWZyYW1lcywgYXJncy5jc3NGaWxlKS5zZWxlY3RvcnM7XG4gICAgICAgIGlmIChwYXJzZWQpIHtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycy5wdXNoLmFwcGx5KGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycywgcGFyc2VkKTtcbiAgICAgICAgICAgIG1lcmdlQ3NzU2VsZWN0b3JzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoYXJncy5jc3NGaWxlKSB7XG4gICAgICAgIGxvYWRDc3MoYXJncy5jc3NGaWxlKTtcbiAgICB9XG59KTtcbmZ1bmN0aW9uIG9uTGl2ZVN5bmMoYXJncykge1xuICAgIGxvYWRDc3MoYXBwbGljYXRpb25Db21tb24uZ2V0Q3NzRmlsZU5hbWUoKSk7XG59XG52YXIgbG9hZENzcyA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJcXFwic3R5bGUtc2NvcGVcXFwiLmxvYWRDc3NcIiwgZnVuY3Rpb24gKGNzc01vZHVsZSkge1xuICAgIGlmICghY3NzTW9kdWxlKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGlmIChjc3NNb2R1bGUuc3RhcnRzV2l0aChcIi4vXCIpKSB7XG4gICAgICAgIGNzc01vZHVsZSA9IGNzc01vZHVsZS5zdWJzdHIoMik7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSBDU1NTb3VyY2UuZnJvbVVSSShjc3NNb2R1bGUsIGFwcGxpY2F0aW9uS2V5ZnJhbWVzKS5zZWxlY3RvcnM7XG4gICAgaWYgKHJlc3VsdC5sZW5ndGggPiAwKSB7XG4gICAgICAgIGFwcGxpY2F0aW9uU2VsZWN0b3JzID0gcmVzdWx0O1xuICAgICAgICBtZXJnZUNzc1NlbGVjdG9ycygpO1xuICAgIH1cbn0pO1xuYXBwbGljYXRpb25Db21tb24ub24oXCJjc3NDaGFuZ2VkXCIsIG9uQ3NzQ2hhbmdlZCk7XG5hcHBsaWNhdGlvbkNvbW1vbi5vbihcImxpdmVzeW5jXCIsIG9uTGl2ZVN5bmMpO1xuZXhwb3J0cy5sb2FkQXBwQ1NTID0gcHJvZmlsaW5nXzEucHJvZmlsZShcIlxcXCJzdHlsZS1zY29wZVxcXCIubG9hZEFwcENTU1wiLCBmdW5jdGlvbiAoYXJncykge1xuICAgIGxvYWRDc3MoYXJncy5jc3NGaWxlKTtcbiAgICBhcHBsaWNhdGlvbkNvbW1vbi5vZmYoXCJsb2FkQXBwQ3NzXCIsIGV4cG9ydHMubG9hZEFwcENTUyk7XG59KTtcbmlmIChhcHBsaWNhdGlvbkNvbW1vbi5oYXNMYXVuY2hlZCgpKSB7XG4gICAgZXhwb3J0cy5sb2FkQXBwQ1NTKHsgZXZlbnROYW1lOiBcImxvYWRBcHBDc3NcIiwgb2JqZWN0OiBhcHBsaWNhdGlvbkNvbW1vbiwgY3NzRmlsZTogYXBwbGljYXRpb25Db21tb24uZ2V0Q3NzRmlsZU5hbWUoKSB9KTtcbn1cbmVsc2Uge1xuICAgIGFwcGxpY2F0aW9uQ29tbW9uLm9uKFwibG9hZEFwcENzc1wiLCBleHBvcnRzLmxvYWRBcHBDU1MpO1xufVxudmFyIENzc1N0YXRlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDc3NTdGF0ZSh2aWV3UmVmKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMudmlld1JlZiA9IHZpZXdSZWY7XG4gICAgICAgIHRoaXMuX29uRHluYW1pY1N0YXRlQ2hhbmdlSGFuZGxlciA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnVwZGF0ZUR5bmFtaWNTdGF0ZSgpOyB9O1xuICAgIH1cbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUub25DaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldyAmJiB2aWV3LmlzTG9hZGVkKSB7XG4gICAgICAgICAgICB0aGlzLnVuc3Vic2NyaWJlRnJvbUR5bmFtaWNVcGRhdGVzKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1hdGNoKCk7XG4gICAgICAgICAgICB0aGlzLnN1YnNjcmliZUZvckR5bmFtaWNVcGRhdGVzKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUR5bmFtaWNTdGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fbWF0Y2hJbnZhbGlkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLmlzU2VsZWN0b3JzTGF0ZXN0VmVyc2lvbkFwcGxpZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJpc1NlbGVjdG9yc0xhdGVzdFZlcnNpb25BcHBsaWVkIHJldHVybnMgZGVmYXVsdCB2YWx1ZSBcXFwiZmFsc2VcXFwiIGJlY2F1c2UgXFxcInRoaXMudmlld1JlZlxcXCIgY2xlYXJlZC5cIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdSZWYuZ2V0KCkuX3N0eWxlU2NvcGUuX2dldFNlbGVjdG9yc1ZlcnNpb24oKSA9PT0gdGhpcy5fYXBwbGllZFNlbGVjdG9yc1ZlcnNpb247XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9tYXRjaEludmFsaWQpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTWF0Y2goKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN1YnNjcmliZUZvckR5bmFtaWNVcGRhdGVzKCk7XG4gICAgICAgIHRoaXMudXBkYXRlRHluYW1pY1N0YXRlKCk7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZUZyb21EeW5hbWljVXBkYXRlcygpO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLnVwZGF0ZU1hdGNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcgJiYgdmlldy5fc3R5bGVTY29wZSkge1xuICAgICAgICAgICAgdGhpcy5fbWF0Y2ggPSB2aWV3Ll9zdHlsZVNjb3BlLm1hdGNoU2VsZWN0b3JzKHZpZXcpO1xuICAgICAgICAgICAgdGhpcy5fYXBwbGllZFNlbGVjdG9yc1ZlcnNpb24gPSB2aWV3Ll9zdHlsZVNjb3BlLl9nZXRTZWxlY3RvcnNWZXJzaW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9tYXRjaCA9IENzc1N0YXRlLmVtcHR5TWF0Y2g7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbWF0Y2hJbnZhbGlkID0gZmFsc2U7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUudXBkYXRlRHluYW1pY1N0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwidXBkYXRlRHluYW1pY1N0YXRlIG5vdCBleGVjdXRlZCB0byB2aWV3IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWF0Y2hpbmdTZWxlY3RvcnMgPSB0aGlzLl9tYXRjaC5zZWxlY3RvcnMuZmlsdGVyKGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5keW5hbWljID8gc2VsLm1hdGNoKHZpZXcpIDogdHJ1ZTsgfSk7XG4gICAgICAgIHZpZXcuX2JhdGNoVXBkYXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLnN0b3BLZXlmcmFtZUFuaW1hdGlvbnMoKTtcbiAgICAgICAgICAgIF90aGlzLnNldFByb3BlcnR5VmFsdWVzKG1hdGNoaW5nU2VsZWN0b3JzKTtcbiAgICAgICAgICAgIF90aGlzLnBsYXlLZXlmcmFtZUFuaW1hdGlvbnMobWF0Y2hpbmdTZWxlY3RvcnMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS5wbGF5S2V5ZnJhbWVBbmltYXRpb25zID0gZnVuY3Rpb24gKG1hdGNoaW5nU2VsZWN0b3JzKSB7XG4gICAgICAgIHZhciBhbmltYXRpb25zID0gW107XG4gICAgICAgIG1hdGNoaW5nU2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICB2YXIgcnVsZUFuaW1hdGlvbnMgPSBzZWxlY3Rvci5ydWxlc2V0W2FuaW1hdGlvbnNTeW1ib2xdO1xuICAgICAgICAgICAgaWYgKHJ1bGVBbmltYXRpb25zKSB7XG4gICAgICAgICAgICAgICAgZW5zdXJlS2V5ZnJhbWVBbmltYXRpb25Nb2R1bGUoKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJ1bGVBbmltYXRpb25zXzEgPSBydWxlQW5pbWF0aW9uczsgX2kgPCBydWxlQW5pbWF0aW9uc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW5pbWF0aW9uSW5mbyA9IHJ1bGVBbmltYXRpb25zXzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW5pbWF0aW9uID0ga2V5ZnJhbWVBbmltYXRpb25Nb2R1bGUuS2V5ZnJhbWVBbmltYXRpb24ua2V5ZnJhbWVBbmltYXRpb25Gcm9tSW5mbyhhbmltYXRpb25JbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9ucy5wdXNoKGFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5fcGxheXNLZXlmcmFtZUFuaW1hdGlvbnMgPSBhbmltYXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciB2aWV3XzEgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIXZpZXdfMSkge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJLZXlmcmFtZUFuaW1hdGlvbnMgY2Fubm90IHBsYXkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbiwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbmltYXRpb25zLm1hcChmdW5jdGlvbiAoYW5pbWF0aW9uKSB7IHJldHVybiBhbmltYXRpb24ucGxheSh2aWV3XzEpOyB9KTtcbiAgICAgICAgICAgIE9iamVjdC5mcmVlemUoYW5pbWF0aW9ucyk7XG4gICAgICAgICAgICB0aGlzLl9hcHBsaWVkQW5pbWF0aW9ucyA9IGFuaW1hdGlvbnM7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS5zdG9wS2V5ZnJhbWVBbmltYXRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX3BsYXlzS2V5ZnJhbWVBbmltYXRpb25zKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYXBwbGllZEFuaW1hdGlvbnNcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGFuaW1hdGlvbikgeyByZXR1cm4gYW5pbWF0aW9uLmlzUGxheWluZzsgfSlcbiAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChhbmltYXRpb24pIHsgcmV0dXJuIGFuaW1hdGlvbi5jYW5jZWwoKTsgfSk7XG4gICAgICAgIHRoaXMuX2FwcGxpZWRBbmltYXRpb25zID0gQ3NzU3RhdGUuZW1wdHlBbmltYXRpb25BcnJheTtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW1wia2V5ZnJhbWU6cm90YXRlXCJdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW1wia2V5ZnJhbWU6c2NhbGVYXCJdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW1wia2V5ZnJhbWU6c2NhbGVZXCJdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW1wia2V5ZnJhbWU6dHJhbnNsYXRlWFwiXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmlldy5zdHlsZVtcImtleWZyYW1lOnRyYW5zbGF0ZVlcIl0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbXCJrZXlmcmFtZTpiYWNrZ3JvdW5kQ29sb3JcIl0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbXCJrZXlmcmFtZTpvcGFjaXR5XCJdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiS2V5ZnJhbWVBbmltYXRpb25zIGNhbm5vdCBiZSBzdG9wcGVkIGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcGxheXNLZXlmcmFtZUFuaW1hdGlvbnMgPSBmYWxzZTtcbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS5zZXRQcm9wZXJ0eVZhbHVlcyA9IGZ1bmN0aW9uIChtYXRjaGluZ1NlbGVjdG9ycykge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG1hdGNoaW5nU2VsZWN0b3JzICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuZXdQcm9wZXJ0eVZhbHVlcyA9IG5ldyB2aWV3LnN0eWxlLlByb3BlcnR5QmFnKCk7XG4gICAgICAgIG1hdGNoaW5nU2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZWN0b3IucnVsZXNldC5kZWNsYXJhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZGVjbGFyYXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3UHJvcGVydHlWYWx1ZXNbZGVjbGFyYXRpb24ucHJvcGVydHldID0gZGVjbGFyYXRpb24udmFsdWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBvbGRQcm9wZXJ0aWVzID0gdGhpcy5fYXBwbGllZFByb3BlcnR5VmFsdWVzO1xuICAgICAgICB2YXIgaXNDc3NFeHByZXNzaW9uSW5Vc2UgPSBmYWxzZTtcbiAgICAgICAgdmlldy5zdHlsZS5yZXNldFNjb3BlZENzc1ZhcmlhYmxlcygpO1xuICAgICAgICBmb3IgKHZhciBwcm9wZXJ0eSBpbiBuZXdQcm9wZXJ0eVZhbHVlcykge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gbmV3UHJvcGVydHlWYWx1ZXNbcHJvcGVydHldO1xuICAgICAgICAgICAgaWYgKHByb3BlcnRpZXNfMS5pc0Nzc1ZhcmlhYmxlKHByb3BlcnR5KSkge1xuICAgICAgICAgICAgICAgIHZpZXcuc3R5bGUuc2V0U2NvcGVkQ3NzVmFyaWFibGUocHJvcGVydHksIHZhbHVlKTtcbiAgICAgICAgICAgICAgICBkZWxldGUgbmV3UHJvcGVydHlWYWx1ZXNbcHJvcGVydHldO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXNDc3NFeHByZXNzaW9uSW5Vc2UgPSBpc0Nzc0V4cHJlc3Npb25JblVzZSB8fCBwcm9wZXJ0aWVzXzEuaXNDc3NWYXJpYWJsZUV4cHJlc3Npb24odmFsdWUpIHx8IHByb3BlcnRpZXNfMS5pc0Nzc0NhbGNFeHByZXNzaW9uKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNDc3NFeHByZXNzaW9uSW5Vc2UpIHtcbiAgICAgICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIG5ld1Byb3BlcnR5VmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZXZhbHVhdGVDc3NFeHByZXNzaW9ucyh2aWV3LCBwcm9wZXJ0eSwgbmV3UHJvcGVydHlWYWx1ZXNbcHJvcGVydHldKTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IHByb3BlcnRpZXNfMS51bnNldFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBuZXdQcm9wZXJ0eVZhbHVlc1twcm9wZXJ0eV07XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuZXdQcm9wZXJ0eVZhbHVlc1twcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBPYmplY3QuZnJlZXplKG5ld1Byb3BlcnR5VmFsdWVzKTtcbiAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gb2xkUHJvcGVydGllcykge1xuICAgICAgICAgICAgaWYgKCEocHJvcGVydHkgaW4gbmV3UHJvcGVydHlWYWx1ZXMpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5IGluIHZpZXcuc3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5zdHlsZVtcImNzczpcIiArIHByb3BlcnR5XSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gbmV3UHJvcGVydHlWYWx1ZXMpIHtcbiAgICAgICAgICAgIGlmIChvbGRQcm9wZXJ0aWVzICYmIHByb3BlcnR5IGluIG9sZFByb3BlcnRpZXMgJiYgb2xkUHJvcGVydGllc1twcm9wZXJ0eV0gPT09IG5ld1Byb3BlcnR5VmFsdWVzW3Byb3BlcnR5XSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZhbHVlID0gbmV3UHJvcGVydHlWYWx1ZXNbcHJvcGVydHldO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAocHJvcGVydHkgaW4gdmlldy5zdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW1wiY3NzOlwiICsgcHJvcGVydHldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FtZWxDYXNlZFByb3BlcnR5ID0gcHJvcGVydHkucmVwbGFjZSgvLShbYS16XSkvZywgZnVuY3Rpb24gKGcpIHsgcmV0dXJuIGdbMV0udG9VcHBlckNhc2UoKTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZpZXdbY2FtZWxDYXNlZFByb3BlcnR5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkZhaWxlZCB0byBhcHBseSBwcm9wZXJ0eSBbXCIgKyBwcm9wZXJ0eSArIFwiXSB3aXRoIHZhbHVlIFtcIiArIHZhbHVlICsgXCJdIHRvIFwiICsgdmlldyArIFwiLiBcIiArIGUuc3RhY2ssIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYXBwbGllZFByb3BlcnR5VmFsdWVzID0gbmV3UHJvcGVydHlWYWx1ZXM7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUuc3Vic2NyaWJlRm9yRHluYW1pY1VwZGF0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBjaGFuZ2VNYXAgPSB0aGlzLl9tYXRjaC5jaGFuZ2VNYXA7XG4gICAgICAgIGNoYW5nZU1hcC5mb3JFYWNoKGZ1bmN0aW9uIChjaGFuZ2VzLCB2aWV3KSB7XG4gICAgICAgICAgICBpZiAoY2hhbmdlcy5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlcy5hdHRyaWJ1dGVzLmZvckVhY2goZnVuY3Rpb24gKGF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LmFkZEV2ZW50TGlzdGVuZXIoYXR0cmlidXRlICsgXCJDaGFuZ2VcIiwgX3RoaXMuX29uRHluYW1pY1N0YXRlQ2hhbmdlSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2hhbmdlcy5wc2V1ZG9DbGFzc2VzKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlcy5wc2V1ZG9DbGFzc2VzLmZvckVhY2goZnVuY3Rpb24gKHBzZXVkb0NsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBldmVudE5hbWUgPSBcIjpcIiArIHBzZXVkb0NsYXNzO1xuICAgICAgICAgICAgICAgICAgICB2aWV3LmFkZEV2ZW50TGlzdGVuZXIoXCI6XCIgKyBwc2V1ZG9DbGFzcywgX3RoaXMuX29uRHluYW1pY1N0YXRlQ2hhbmdlSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3W2V2ZW50TmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbZXZlbnROYW1lXSgrMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2FwcGxpZWRDaGFuZ2VNYXAgPSBjaGFuZ2VNYXA7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUudW5zdWJzY3JpYmVGcm9tRHluYW1pY1VwZGF0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuX2FwcGxpZWRDaGFuZ2VNYXAuZm9yRWFjaChmdW5jdGlvbiAoY2hhbmdlcywgdmlldykge1xuICAgICAgICAgICAgaWYgKGNoYW5nZXMuYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIGNoYW5nZXMuYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5yZW1vdmVFdmVudExpc3RlbmVyKGF0dHJpYnV0ZSArIFwiQ2hhbmdlXCIsIF90aGlzLl9vbkR5bmFtaWNTdGF0ZUNoYW5nZUhhbmRsZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNoYW5nZXMucHNldWRvQ2xhc3Nlcykge1xuICAgICAgICAgICAgICAgIGNoYW5nZXMucHNldWRvQ2xhc3Nlcy5mb3JFYWNoKGZ1bmN0aW9uIChwc2V1ZG9DbGFzcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnROYW1lID0gXCI6XCIgKyBwc2V1ZG9DbGFzcztcbiAgICAgICAgICAgICAgICAgICAgdmlldy5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgX3RoaXMuX29uRHluYW1pY1N0YXRlQ2hhbmdlSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3W2V2ZW50TmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbZXZlbnROYW1lXSgtMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2FwcGxpZWRDaGFuZ2VNYXAgPSBDc3NTdGF0ZS5lbXB0eUNoYW5nZU1hcDtcbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcInRvU3RyaW5nKCkgb2YgQ3NzU3RhdGUgY2Fubm90IGV4ZWN1dGUgY29ycmVjdGx5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmlldyArIFwiLl9jc3NTdGF0ZVwiO1xuICAgIH07XG4gICAgQ3NzU3RhdGUuZW1wdHlDaGFuZ2VNYXAgPSBPYmplY3QuZnJlZXplKG5ldyBNYXAoKSk7XG4gICAgQ3NzU3RhdGUuZW1wdHlQcm9wZXJ0eUJhZyA9IE9iamVjdC5mcmVlemUoe30pO1xuICAgIENzc1N0YXRlLmVtcHR5QW5pbWF0aW9uQXJyYXkgPSBPYmplY3QuZnJlZXplKFtdKTtcbiAgICBDc3NTdGF0ZS5lbXB0eU1hdGNoID0geyBzZWxlY3RvcnM6IFtdLCBjaGFuZ2VNYXA6IG5ldyBNYXAoKSB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQ3NzU3RhdGUucHJvdG90eXBlLCBcInVwZGF0ZU1hdGNoXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQ3NzU3RhdGUucHJvdG90eXBlLCBcInVwZGF0ZUR5bmFtaWNTdGF0ZVwiLCBudWxsKTtcbiAgICByZXR1cm4gQ3NzU3RhdGU7XG59KCkpO1xuZXhwb3J0cy5Dc3NTdGF0ZSA9IENzc1N0YXRlO1xuQ3NzU3RhdGUucHJvdG90eXBlLl9hcHBsaWVkQ2hhbmdlTWFwID0gQ3NzU3RhdGUuZW1wdHlDaGFuZ2VNYXA7XG5Dc3NTdGF0ZS5wcm90b3R5cGUuX2FwcGxpZWRQcm9wZXJ0eVZhbHVlcyA9IENzc1N0YXRlLmVtcHR5UHJvcGVydHlCYWc7XG5Dc3NTdGF0ZS5wcm90b3R5cGUuX2FwcGxpZWRBbmltYXRpb25zID0gQ3NzU3RhdGUuZW1wdHlBbmltYXRpb25BcnJheTtcbkNzc1N0YXRlLnByb3RvdHlwZS5fbWF0Y2hJbnZhbGlkID0gdHJ1ZTtcbnZhciBTdHlsZVNjb3BlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTdHlsZVNjb3BlKCkge1xuICAgICAgICB0aGlzLl9jc3MgPSBcIlwiO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9ycyA9IFtdO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9yVmVyc2lvbiA9IDA7XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzQXBwbGllZFZlcnNpb24gPSAwO1xuICAgICAgICB0aGlzLl9hcHBsaWNhdGlvbkNzc1NlbGVjdG9yc0FwcGxpZWRWZXJzaW9uID0gMDtcbiAgICAgICAgdGhpcy5fa2V5ZnJhbWVzID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3R5bGVTY29wZS5wcm90b3R5cGUsIFwiY3NzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY3NzO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zZXRDc3ModmFsdWUpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5hZGRDc3MgPSBmdW5jdGlvbiAoY3NzU3RyaW5nLCBjc3NGaWxlTmFtZSkge1xuICAgICAgICB0aGlzLmFwcGVuZENzcyhjc3NTdHJpbmcsIGNzc0ZpbGVOYW1lKTtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmFkZENzc0ZpbGUgPSBmdW5jdGlvbiAoY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmRDc3MobnVsbCwgY3NzRmlsZU5hbWUpO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuY2hhbmdlQ3NzRmlsZSA9IGZ1bmN0aW9uIChjc3NGaWxlTmFtZSkge1xuICAgICAgICBpZiAoIWNzc0ZpbGVOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNzc1NlbGVjdG9ycyA9IENTU1NvdXJjZS5mcm9tVVJJKGNzc0ZpbGVOYW1lLCB0aGlzLl9rZXlmcmFtZXMpO1xuICAgICAgICB0aGlzLl9jc3MgPSBjc3NTZWxlY3RvcnMuc291cmNlO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9ycyA9IGNzc1NlbGVjdG9ycy5zZWxlY3RvcnM7XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JWZXJzaW9uKys7XG4gICAgICAgIHRoaXMuZW5zdXJlU2VsZWN0b3JzKCk7XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5zZXRDc3MgPSBmdW5jdGlvbiAoY3NzU3RyaW5nLCBjc3NGaWxlTmFtZSkge1xuICAgICAgICB0aGlzLl9jc3MgPSBjc3NTdHJpbmc7XG4gICAgICAgIHZhciBjc3NGaWxlID0gQ1NTU291cmNlLmZyb21Tb3VyY2UoY3NzU3RyaW5nLCB0aGlzLl9rZXlmcmFtZXMsIGNzc0ZpbGVOYW1lKTtcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvcnMgPSBjc3NGaWxlLnNlbGVjdG9ycztcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvclZlcnNpb24rKztcbiAgICAgICAgdGhpcy5lbnN1cmVTZWxlY3RvcnMoKTtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmFwcGVuZENzcyA9IGZ1bmN0aW9uIChjc3NTdHJpbmcsIGNzc0ZpbGVOYW1lKSB7XG4gICAgICAgIGlmICghY3NzU3RyaW5nICYmICFjc3NGaWxlTmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJzZWRDc3NTZWxlY3RvcnMgPSBjc3NTdHJpbmcgPyBDU1NTb3VyY2UuZnJvbVNvdXJjZShjc3NTdHJpbmcsIHRoaXMuX2tleWZyYW1lcywgY3NzRmlsZU5hbWUpIDogQ1NTU291cmNlLmZyb21VUkkoY3NzRmlsZU5hbWUsIHRoaXMuX2tleWZyYW1lcyk7XG4gICAgICAgIHRoaXMuX2NzcyA9IHRoaXMuX2NzcyArIHBhcnNlZENzc1NlbGVjdG9ycy5zb3VyY2U7XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzLnB1c2guYXBwbHkodGhpcy5fbG9jYWxDc3NTZWxlY3RvcnMsIHBhcnNlZENzc1NlbGVjdG9ycy5zZWxlY3RvcnMpO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9yVmVyc2lvbisrO1xuICAgICAgICB0aGlzLmVuc3VyZVNlbGVjdG9ycygpO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuZ2V0S2V5ZnJhbWVBbmltYXRpb25XaXRoTmFtZSA9IGZ1bmN0aW9uIChhbmltYXRpb25OYW1lKSB7XG4gICAgICAgIHZhciBjc3NLZXlmcmFtZXMgPSB0aGlzLl9rZXlmcmFtZXNbYW5pbWF0aW9uTmFtZV07XG4gICAgICAgIGlmICghY3NzS2V5ZnJhbWVzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZW5zdXJlS2V5ZnJhbWVBbmltYXRpb25Nb2R1bGUoKTtcbiAgICAgICAgdmFyIGFuaW1hdGlvbiA9IG5ldyBrZXlmcmFtZUFuaW1hdGlvbk1vZHVsZS5LZXlmcmFtZUFuaW1hdGlvbkluZm8oKTtcbiAgICAgICAgZW5zdXJlQ3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlKCk7XG4gICAgICAgIGFuaW1hdGlvbi5rZXlmcmFtZXMgPSBjc3NBbmltYXRpb25QYXJzZXJNb2R1bGVcbiAgICAgICAgICAgIC5Dc3NBbmltYXRpb25QYXJzZXIua2V5ZnJhbWVzQXJyYXlGcm9tQ1NTKGNzc0tleWZyYW1lcy5rZXlmcmFtZXMpO1xuICAgICAgICByZXR1cm4gYW5pbWF0aW9uO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuZW5zdXJlU2VsZWN0b3JzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNBcHBsaWNhdGlvbkNzc1NlbGVjdG9yc0xhdGVzdFZlcnNpb25BcHBsaWVkKCkgfHxcbiAgICAgICAgICAgICF0aGlzLmlzTG9jYWxDc3NTZWxlY3RvcnNMYXRlc3RWZXJzaW9uQXBwbGllZCgpIHx8XG4gICAgICAgICAgICAhdGhpcy5fbWVyZ2VkQ3NzU2VsZWN0b3JzKSB7XG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVTZWxlY3RvcnMoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0U2VsZWN0b3JzVmVyc2lvbigpO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuaXNBcHBsaWNhdGlvbkNzc1NlbGVjdG9yc0xhdGVzdFZlcnNpb25BcHBsaWVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXBwbGljYXRpb25Dc3NTZWxlY3RvcnNBcHBsaWVkVmVyc2lvbiA9PT0gYXBwbGljYXRpb25Dc3NTZWxlY3RvclZlcnNpb247XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5pc0xvY2FsQ3NzU2VsZWN0b3JzTGF0ZXN0VmVyc2lvbkFwcGxpZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sb2NhbENzc1NlbGVjdG9yc0FwcGxpZWRWZXJzaW9uID09PSB0aGlzLl9sb2NhbENzc1NlbGVjdG9yVmVyc2lvbjtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLl9jcmVhdGVTZWxlY3RvcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b01lcmdlID0gW107XG4gICAgICAgIHRvTWVyZ2UucHVzaChhcHBsaWNhdGlvbkNzc1NlbGVjdG9ycyk7XG4gICAgICAgIHRoaXMuX2FwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzQXBwbGllZFZlcnNpb24gPSBhcHBsaWNhdGlvbkNzc1NlbGVjdG9yVmVyc2lvbjtcbiAgICAgICAgdG9NZXJnZS5wdXNoKHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzKTtcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvcnNBcHBsaWVkVmVyc2lvbiA9IHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JWZXJzaW9uO1xuICAgICAgICBmb3IgKHZhciBrZXlmcmFtZSBpbiBhcHBsaWNhdGlvbktleWZyYW1lcykge1xuICAgICAgICAgICAgdGhpcy5fa2V5ZnJhbWVzW2tleWZyYW1lXSA9IGFwcGxpY2F0aW9uS2V5ZnJhbWVzW2tleWZyYW1lXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodG9NZXJnZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLl9tZXJnZWRDc3NTZWxlY3RvcnMgPSB0b01lcmdlLmZpbHRlcihmdW5jdGlvbiAobSkgeyByZXR1cm4gISFtOyB9KS5yZWR1Y2UoZnVuY3Rpb24gKG1lcmdlZCwgbmV4dCkgeyByZXR1cm4gbWVyZ2VkLmNvbmNhdChuZXh0KTsgfSwgW10pO1xuICAgICAgICAgICAgdGhpcy5fYXBwbHlLZXlmcmFtZXNPblNlbGVjdG9ycygpO1xuICAgICAgICAgICAgdGhpcy5fc2VsZWN0b3JzID0gbmV3IGNzc19zZWxlY3Rvcl8xLlNlbGVjdG9yc01hcCh0aGlzLl9tZXJnZWRDc3NTZWxlY3RvcnMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5tYXRjaFNlbGVjdG9ycyA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHRoaXMuZW5zdXJlU2VsZWN0b3JzKCk7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3RvcnMucXVlcnkodmlldyk7XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5xdWVyeSA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlU2VsZWN0b3JzKCk7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3RvcnMucXVlcnkobm9kZSkuc2VsZWN0b3JzO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuX2dldFNlbGVjdG9yc1ZlcnNpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAxMDAwMDAgKiB0aGlzLl9hcHBsaWNhdGlvbkNzc1NlbGVjdG9yc0FwcGxpZWRWZXJzaW9uICsgdGhpcy5fbG9jYWxDc3NTZWxlY3RvcnNBcHBsaWVkVmVyc2lvbjtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLl9hcHBseUtleWZyYW1lc09uU2VsZWN0b3JzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fbWVyZ2VkQ3NzU2VsZWN0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgcnVsZXNldCA9IHRoaXMuX21lcmdlZENzc1NlbGVjdG9yc1tpXTtcbiAgICAgICAgICAgIHZhciBhbmltYXRpb25zID0gcnVsZXNldFthbmltYXRpb25zU3ltYm9sXTtcbiAgICAgICAgICAgIGlmIChhbmltYXRpb25zICE9PSB1bmRlZmluZWQgJiYgYW5pbWF0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBlbnN1cmVDc3NBbmltYXRpb25QYXJzZXJNb2R1bGUoKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGFuaW1hdGlvbnNfMSA9IGFuaW1hdGlvbnM7IF9pIDwgYW5pbWF0aW9uc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW5pbWF0aW9uID0gYW5pbWF0aW9uc18xW19pXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNzc0tleWZyYW1lID0gdGhpcy5fa2V5ZnJhbWVzW2FuaW1hdGlvbi5uYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNzc0tleWZyYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5rZXlmcmFtZXMgPSBjc3NBbmltYXRpb25QYXJzZXJNb2R1bGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuQ3NzQW5pbWF0aW9uUGFyc2VyLmtleWZyYW1lc0FycmF5RnJvbUNTUyhjc3NLZXlmcmFtZS5rZXlmcmFtZXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5nZXRBbmltYXRpb25zID0gZnVuY3Rpb24gKHJ1bGVzZXQpIHtcbiAgICAgICAgcmV0dXJuIHJ1bGVzZXRbYW5pbWF0aW9uc1N5bWJvbF07XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFN0eWxlU2NvcGUucHJvdG90eXBlLCBcInNldENzc1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFN0eWxlU2NvcGUucHJvdG90eXBlLCBcImFwcGVuZENzc1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFN0eWxlU2NvcGUucHJvdG90eXBlLCBcIl9jcmVhdGVTZWxlY3RvcnNcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBTdHlsZVNjb3BlLnByb3RvdHlwZSwgXCJtYXRjaFNlbGVjdG9yc1wiLCBudWxsKTtcbiAgICByZXR1cm4gU3R5bGVTY29wZTtcbn0oKSk7XG5leHBvcnRzLlN0eWxlU2NvcGUgPSBTdHlsZVNjb3BlO1xuZnVuY3Rpb24gcmVzb2x2ZUZpbGVOYW1lRnJvbVVybCh1cmwsIGFwcERpcmVjdG9yeSwgZmlsZUV4aXN0cywgaW1wb3J0U291cmNlKSB7XG4gICAgdmFyIGZpbGVOYW1lID0gdHlwZW9mIHVybCA9PT0gXCJzdHJpbmdcIiA/IHVybC50cmltKCkgOiBcIlwiO1xuICAgIGlmIChmaWxlTmFtZS5pbmRleE9mKFwifi9cIikgPT09IDApIHtcbiAgICAgICAgZmlsZU5hbWUgPSBmaWxlTmFtZS5yZXBsYWNlKFwifi9cIiwgXCJcIik7XG4gICAgfVxuICAgIHZhciBpc0Fic29sdXRlUGF0aCA9IGZpbGVOYW1lLmluZGV4T2YoXCIvXCIpID09PSAwO1xuICAgIHZhciBhYnNvbHV0ZVBhdGggPSBpc0Fic29sdXRlUGF0aCA/IGZpbGVOYW1lIDogZmlsZV9zeXN0ZW1fMS5wYXRoLmpvaW4oYXBwRGlyZWN0b3J5LCBmaWxlTmFtZSk7XG4gICAgaWYgKGZpbGVFeGlzdHMoYWJzb2x1dGVQYXRoKSkge1xuICAgICAgICByZXR1cm4gYWJzb2x1dGVQYXRoO1xuICAgIH1cbiAgICBpZiAoIWlzQWJzb2x1dGVQYXRoKSB7XG4gICAgICAgIGlmIChmaWxlTmFtZVswXSA9PT0gXCJ+XCIgJiYgZmlsZU5hbWVbMV0gIT09IFwiL1wiICYmIGZpbGVOYW1lWzFdICE9PSBcIlxcXCJcIikge1xuICAgICAgICAgICAgZmlsZU5hbWUgPSBmaWxlTmFtZS5zdWJzdHIoMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGltcG9ydFNvdXJjZSkge1xuICAgICAgICAgICAgdmFyIGltcG9ydEZpbGUgPSByZXNvbHZlRmlsZVBhdGhGcm9tSW1wb3J0KGltcG9ydFNvdXJjZSwgZmlsZU5hbWUpO1xuICAgICAgICAgICAgaWYgKGZpbGVFeGlzdHMoaW1wb3J0RmlsZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW1wb3J0RmlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZXh0ZXJuYWxfMSA9IGZpbGVfc3lzdGVtXzEucGF0aC5qb2luKGFwcERpcmVjdG9yeSwgXCJ0bnNfbW9kdWxlc1wiLCBmaWxlTmFtZSk7XG4gICAgICAgIGlmIChmaWxlRXhpc3RzKGV4dGVybmFsXzEpKSB7XG4gICAgICAgICAgICByZXR1cm4gZXh0ZXJuYWxfMTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydHMucmVzb2x2ZUZpbGVOYW1lRnJvbVVybCA9IHJlc29sdmVGaWxlTmFtZUZyb21Vcmw7XG5mdW5jdGlvbiByZXNvbHZlRmlsZVBhdGhGcm9tSW1wb3J0KGltcG9ydFNvdXJjZSwgZmlsZU5hbWUpIHtcbiAgICB2YXIgaW1wb3J0U291cmNlUGFydHMgPSBpbXBvcnRTb3VyY2Uuc3BsaXQoZmlsZV9zeXN0ZW1fMS5wYXRoLnNlcGFyYXRvcik7XG4gICAgdmFyIGZpbGVOYW1lUGFydHMgPSBmaWxlTmFtZS5zcGxpdChmaWxlX3N5c3RlbV8xLnBhdGguc2VwYXJhdG9yKVxuICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChwKSB7IHJldHVybiAhaXNDdXJyZW50RGlyZWN0b3J5KHApOyB9KTtcbiAgICBpbXBvcnRTb3VyY2VQYXJ0cy5wb3AoKTtcbiAgICBmaWxlTmFtZVBhcnRzLmZvckVhY2goZnVuY3Rpb24gKHApIHsgcmV0dXJuIGlzUGFyZW50RGlyZWN0b3J5KHApID8gaW1wb3J0U291cmNlUGFydHMucG9wKCkgOiBpbXBvcnRTb3VyY2VQYXJ0cy5wdXNoKHApOyB9KTtcbiAgICByZXR1cm4gaW1wb3J0U291cmNlUGFydHMuam9pbihmaWxlX3N5c3RlbV8xLnBhdGguc2VwYXJhdG9yKTtcbn1cbmV4cG9ydHMuYXBwbHlJbmxpbmVTdHlsZSA9IHByb2ZpbGluZ18xLnByb2ZpbGUoZnVuY3Rpb24gYXBwbHlJbmxpbmVTdHlsZSh2aWV3LCBzdHlsZVN0cikge1xuICAgIHZhciBsb2NhbFN0eWxlID0gXCJsb2NhbCB7IFwiICsgc3R5bGVTdHIgKyBcIiB9XCI7XG4gICAgdmFyIGlubGluZVJ1bGVTZXQgPSBDU1NTb3VyY2UuZnJvbVNvdXJjZShsb2NhbFN0eWxlLCBuZXcgTWFwKCkpLnNlbGVjdG9ycztcbiAgICB2aWV3LnN0eWxlLnJlc2V0VW5zY29wZWRDc3NWYXJpYWJsZXMoKTtcbiAgICBpbmxpbmVSdWxlU2V0WzBdLmRlY2xhcmF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IGQucHJvcGVydHk7XG4gICAgICAgIGlmIChwcm9wZXJ0aWVzXzEuaXNDc3NWYXJpYWJsZShwcm9wZXJ0eSkpIHtcbiAgICAgICAgICAgIHZpZXcuc3R5bGUuc2V0VW5zY29wZWRDc3NWYXJpYWJsZShwcm9wZXJ0eSwgZC52YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpbmxpbmVSdWxlU2V0WzBdLmRlY2xhcmF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IGQucHJvcGVydHk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAocHJvcGVydGllc18xLmlzQ3NzVmFyaWFibGUocHJvcGVydHkpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZhbHVlID0gZXZhbHVhdGVDc3NFeHByZXNzaW9ucyh2aWV3LCBwcm9wZXJ0eSwgZC52YWx1ZSk7XG4gICAgICAgICAgICBpZiAocHJvcGVydHkgaW4gdmlldy5zdHlsZSkge1xuICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbcHJvcGVydHldID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2aWV3W3Byb3BlcnR5XSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiRmFpbGVkIHRvIGFwcGx5IHByb3BlcnR5IFtcIiArIGQucHJvcGVydHkgKyBcIl0gd2l0aCB2YWx1ZSBbXCIgKyBkLnZhbHVlICsgXCJdIHRvIFwiICsgdmlldyArIFwiLiBcIiArIGUsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICB2aWV3Ll9vbkNzc1N0YXRlQ2hhbmdlKCk7XG59KTtcbmZ1bmN0aW9uIGlzQ3VycmVudERpcmVjdG9yeSh1cmlQYXJ0KSB7XG4gICAgcmV0dXJuIHVyaVBhcnQgPT09IFwiLlwiO1xufVxuZnVuY3Rpb24gaXNQYXJlbnREaXJlY3RvcnkodXJpUGFydCkge1xuICAgIHJldHVybiB1cmlQYXJ0ID09PSBcIi4uXCI7XG59XG5mdW5jdGlvbiBpc0tleWZyYW1lKG5vZGUpIHtcbiAgICByZXR1cm4gbm9kZS50eXBlID09PSBcImtleWZyYW1lc1wiO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3R5bGUtc2NvcGUuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIG9ic2VydmFibGVfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9kYXRhL29ic2VydmFibGVcIik7XG52YXIgdHJhY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi90cmFjZVwiKTtcbnZhciBTdHlsZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFN0eWxlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN0eWxlKG93bmVyVmlldykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy51bnNjb3BlZENzc1ZhcmlhYmxlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgX3RoaXMuc2NvcGVkQ3NzVmFyaWFibGVzID0gbmV3IE1hcCgpO1xuICAgICAgICBpZiAob3duZXJWaWV3LmNvbnN0cnVjdG9yLnRvU3RyaW5nKCkuaW5kZXhPZihcIltuYXRpdmUgY29kZV1cIikgIT09IC0xKSB7XG4gICAgICAgICAgICBfdGhpcy52aWV3UmVmID0gb3duZXJWaWV3O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgX3RoaXMudmlld1JlZiA9IG5ldyBXZWFrUmVmKG93bmVyVmlldyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTdHlsZS5wcm90b3R5cGUuc2V0U2NvcGVkQ3NzVmFyaWFibGUgPSBmdW5jdGlvbiAodmFyTmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5zY29wZWRDc3NWYXJpYWJsZXMuc2V0KHZhck5hbWUsIHZhbHVlKTtcbiAgICB9O1xuICAgIFN0eWxlLnByb3RvdHlwZS5zZXRVbnNjb3BlZENzc1ZhcmlhYmxlID0gZnVuY3Rpb24gKHZhck5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHRoaXMudW5zY29wZWRDc3NWYXJpYWJsZXMuc2V0KHZhck5hbWUsIHZhbHVlKTtcbiAgICB9O1xuICAgIFN0eWxlLnByb3RvdHlwZS5nZXRDc3NWYXJpYWJsZSA9IGZ1bmN0aW9uICh2YXJOYW1lKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3O1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnVuc2NvcGVkQ3NzVmFyaWFibGVzLmhhcyh2YXJOYW1lKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudW5zY29wZWRDc3NWYXJpYWJsZXMuZ2V0KHZhck5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNjb3BlZENzc1ZhcmlhYmxlcy5oYXModmFyTmFtZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNjb3BlZENzc1ZhcmlhYmxlcy5nZXQodmFyTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF2aWV3LnBhcmVudCB8fCAhdmlldy5wYXJlbnQuc3R5bGUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2aWV3LnBhcmVudC5zdHlsZS5nZXRDc3NWYXJpYWJsZSh2YXJOYW1lKTtcbiAgICB9O1xuICAgIFN0eWxlLnByb3RvdHlwZS5yZXNldFNjb3BlZENzc1ZhcmlhYmxlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zY29wZWRDc3NWYXJpYWJsZXMuY2xlYXIoKTtcbiAgICB9O1xuICAgIFN0eWxlLnByb3RvdHlwZS5yZXNldFVuc2NvcGVkQ3NzVmFyaWFibGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnVuc2NvcGVkQ3NzVmFyaWFibGVzLmNsZWFyKCk7XG4gICAgfTtcbiAgICBTdHlsZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJ0b1N0cmluZygpIG9mIFN0eWxlIGNhbm5vdCBleGVjdXRlIGNvcnJlY3RseSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZpZXcgKyBcIi5zdHlsZVwiO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0eWxlLnByb3RvdHlwZSwgXCJ2aWV3XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy52aWV3UmVmKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBTdHlsZTtcbn0ob2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpKTtcbmV4cG9ydHMuU3R5bGUgPSBTdHlsZTtcblN0eWxlLnByb3RvdHlwZS5Qcm9wZXJ0eUJhZyA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gY2xhc3NfMSgpIHtcbiAgICB9XG4gICAgcmV0dXJuIGNsYXNzXzE7XG59KCkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3R5bGUuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vY29sb3JcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBTd2l0Y2hCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3dpdGNoQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTd2l0Y2hCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFN3aXRjaEJhc2UucHJvdG90eXBlLl9vbkNoZWNrZWRQcm9wZXJ0eUNoYW5nZWQgPSBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICB9O1xuICAgIFN3aXRjaEJhc2UuY2hlY2tlZENoYW5nZUV2ZW50ID0gXCJjaGVja2VkQ2hhbmdlXCI7XG4gICAgU3dpdGNoQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIlN3aXRjaFwiKVxuICAgIF0sIFN3aXRjaEJhc2UpO1xuICAgIHJldHVybiBTd2l0Y2hCYXNlO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5Td2l0Y2hCYXNlID0gU3dpdGNoQmFzZTtcblN3aXRjaEJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5mdW5jdGlvbiBvbkNoZWNrZWRQcm9wZXJ0eUNoYW5nZWQoc3dpdGNoQmFzZSwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgc3dpdGNoQmFzZS5fb25DaGVja2VkUHJvcGVydHlDaGFuZ2VkKG5ld1ZhbHVlKTtcbn1cbmV4cG9ydHMuY2hlY2tlZFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiY2hlY2tlZFwiLCBkZWZhdWx0VmFsdWU6IGZhbHNlLCB2YWx1ZUNvbnZlcnRlcjogdmlld18xLmJvb2xlYW5Db252ZXJ0ZXIsIHZhbHVlQ2hhbmdlZDogb25DaGVja2VkUHJvcGVydHlDaGFuZ2VkIH0pO1xuZXhwb3J0cy5jaGVja2VkUHJvcGVydHkucmVnaXN0ZXIoU3dpdGNoQmFzZSk7XG5leHBvcnRzLm9mZkJhY2tncm91bmRDb2xvclByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwib2ZmQmFja2dyb3VuZENvbG9yXCIsIGVxdWFsaXR5Q29tcGFyZXI6IGNvbG9yXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBjb2xvcl8xLkNvbG9yKHYpOyB9IH0pO1xuZXhwb3J0cy5vZmZCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5yZWdpc3RlcihTd2l0Y2hCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN3aXRjaC1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBzd2l0Y2hfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9zd2l0Y2gtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vc3dpdGNoLWNvbW1vblwiKSk7XG52YXIgQ2hlY2tlZENoYW5nZUxpc3RlbmVyO1xuZnVuY3Rpb24gaW5pdGlhbGl6ZUNoZWNrZWRDaGFuZ2VMaXN0ZW5lcigpIHtcbiAgICBpZiAoQ2hlY2tlZENoYW5nZUxpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIENoZWNrZWRDaGFuZ2VMaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoQ2hlY2tlZENoYW5nZUxpc3RlbmVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gQ2hlY2tlZENoYW5nZUxpc3RlbmVySW1wbChvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBDaGVja2VkQ2hhbmdlTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vbkNoZWNrZWRDaGFuZ2VkID0gZnVuY3Rpb24gKGJ1dHRvblZpZXcsIGlzQ2hlY2tlZCkge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIHN3aXRjaF9jb21tb25fMS5jaGVja2VkUHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIGlzQ2hlY2tlZCk7XG4gICAgICAgIH07XG4gICAgICAgIENoZWNrZWRDaGFuZ2VMaXN0ZW5lckltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWQud2lkZ2V0LkNvbXBvdW5kQnV0dG9uLk9uQ2hlY2tlZENoYW5nZUxpc3RlbmVyXSlcbiAgICAgICAgXSwgQ2hlY2tlZENoYW5nZUxpc3RlbmVySW1wbCk7XG4gICAgICAgIHJldHVybiBDaGVja2VkQ2hhbmdlTGlzdGVuZXJJbXBsO1xuICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgIENoZWNrZWRDaGFuZ2VMaXN0ZW5lciA9IENoZWNrZWRDaGFuZ2VMaXN0ZW5lckltcGw7XG59XG52YXIgU3dpdGNoID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3dpdGNoLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN3aXRjaCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTd2l0Y2gucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgYW5kcm9pZC53aWRnZXQuU3dpdGNoKHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaW5pdGlhbGl6ZUNoZWNrZWRDaGFuZ2VMaXN0ZW5lcigpO1xuICAgICAgICB2YXIgbGlzdGVuZXIgPSBuZXcgQ2hlY2tlZENoYW5nZUxpc3RlbmVyKHRoaXMpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldE9uQ2hlY2tlZENoYW5nZUxpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICAgICAgbmF0aXZlVmlldy5saXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIG5hdGl2ZVZpZXcubGlzdGVuZXIub3duZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlLnNldE5hdGl2ZUJhY2tncm91bmRDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBzd2l0Y2hfY29tbW9uXzEuQ29sb3IpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRUcmFja0RyYXdhYmxlKCkuc2V0Q29sb3JGaWx0ZXIodmFsdWUuYW5kcm9pZCwgYW5kcm9pZC5ncmFwaGljcy5Qb3J0ZXJEdWZmLk1vZGUuU1JDX0lOKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRUcmFja0RyYXdhYmxlKCkuY2xlYXJDb2xvckZpbHRlcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlLl9vbkNoZWNrZWRQcm9wZXJ0eUNoYW5nZWQgPSBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMub2ZmQmFja2dyb3VuZENvbG9yKSB7XG4gICAgICAgICAgICBpZiAoIW5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXROYXRpdmVCYWNrZ3JvdW5kQ29sb3IodGhpcy5vZmZCYWNrZ3JvdW5kQ29sb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXROYXRpdmVCYWNrZ3JvdW5kQ29sb3IodGhpcy5iYWNrZ3JvdW5kQ29sb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlW3N3aXRjaF9jb21tb25fMS5jaGVja2VkUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFN3aXRjaC5wcm90b3R5cGVbc3dpdGNoX2NvbW1vbl8xLmNoZWNrZWRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRDaGVja2VkKHZhbHVlKTtcbiAgICB9O1xuICAgIFN3aXRjaC5wcm90b3R5cGVbc3dpdGNoX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIFN3aXRjaC5wcm90b3R5cGVbc3dpdGNoX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBzd2l0Y2hfY29tbW9uXzEuQ29sb3IpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRUaHVtYkRyYXdhYmxlKCkuc2V0Q29sb3JGaWx0ZXIodmFsdWUuYW5kcm9pZCwgYW5kcm9pZC5ncmFwaGljcy5Qb3J0ZXJEdWZmLk1vZGUuU1JDX0lOKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRUaHVtYkRyYXdhYmxlKCkuY2xlYXJDb2xvckZpbHRlcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlW3N3aXRjaF9jb21tb25fMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoIXRoaXMub2ZmQmFja2dyb3VuZENvbG9yIHx8IHRoaXMuY2hlY2tlZCkge1xuICAgICAgICAgICAgdGhpcy5zZXROYXRpdmVCYWNrZ3JvdW5kQ29sb3IodmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlW3N3aXRjaF9jb21tb25fMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlW3N3aXRjaF9jb21tb25fMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlW3N3aXRjaF9jb21tb25fMS5vZmZCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEub2ZmQmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoIXRoaXMuY2hlY2tlZCkge1xuICAgICAgICAgICAgdGhpcy5zZXROYXRpdmVCYWNrZ3JvdW5kQ29sb3IodmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gU3dpdGNoO1xufShzd2l0Y2hfY29tbW9uXzEuU3dpdGNoQmFzZSkpO1xuZXhwb3J0cy5Td2l0Y2ggPSBTd2l0Y2g7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zd2l0Y2guYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uLy4uL2NvcmUvdmlld1wiKTtcbnZhciBjb250ZW50X3ZpZXdfMSA9IHJlcXVpcmUoXCIuLi8uLi9jb250ZW50LXZpZXdcIik7XG5leHBvcnRzLnRyYWNlQ2F0ZWdvcnkgPSBcIlRhYlZpZXdcIjtcbnZhciBUYWJDb250ZW50SXRlbUJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJDb250ZW50SXRlbUJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGFiQ29udGVudEl0ZW1CYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRhYkNvbnRlbnRJdGVtQmFzZS5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbnRlbnQpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRoaXMuY29udGVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYkNvbnRlbnRJdGVtQmFzZS5wcm90b3R5cGUubG9hZFZpZXcgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICB2YXIgdGFiVmlldyA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAodGFiVmlldyAmJiB0YWJWaWV3Lml0ZW1zKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jYW5CZUxvYWRlZCkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUubG9hZFZpZXcuY2FsbCh0aGlzLCB2aWV3KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiQ29udGVudEl0ZW1CYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiVGFiQ29udGVudEl0ZW1cIilcbiAgICBdLCBUYWJDb250ZW50SXRlbUJhc2UpO1xuICAgIHJldHVybiBUYWJDb250ZW50SXRlbUJhc2U7XG59KGNvbnRlbnRfdmlld18xLkNvbnRlbnRWaWV3KSk7XG5leHBvcnRzLlRhYkNvbnRlbnRJdGVtQmFzZSA9IFRhYkNvbnRlbnRJdGVtQmFzZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRhYi1jb250ZW50LWl0ZW0tY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZ3JpZF9sYXlvdXRfMSA9IHJlcXVpcmUoXCIuLi8uLi9sYXlvdXRzL2dyaWQtbGF5b3V0XCIpO1xudmFyIHRhYl9jb250ZW50X2l0ZW1fY29tbW9uXzEgPSByZXF1aXJlKFwiLi90YWItY29udGVudC1pdGVtLWNvbW1vblwiKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vdGFiLWNvbnRlbnQtaXRlbS1jb21tb25cIikpO1xudmFyIFRhYkNvbnRlbnRJdGVtID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGFiQ29udGVudEl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGFiQ29udGVudEl0ZW0oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYkNvbnRlbnRJdGVtLnByb3RvdHlwZSwgXCJfaGFzRnJhZ21lbnRzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGFiQ29udGVudEl0ZW0ucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsYXlvdXQgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRMYXlvdXQodGhpcy5fY29udGV4dCk7XG4gICAgICAgIGxheW91dC5hZGRSb3cobmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5JdGVtU3BlYygxLCBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZFVuaXRUeXBlLnN0YXIpKTtcbiAgICAgICAgcmV0dXJuIGxheW91dDtcbiAgICB9O1xuICAgIFRhYkNvbnRlbnRJdGVtLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgVGFiQ29udGVudEl0ZW0ucHJvdG90eXBlLl9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlID0gZnVuY3Rpb24gKGNoaWxkLCBhdEluZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgJiYgY2hpbGQubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgZ3JpZF9sYXlvdXRfMS5HcmlkTGF5b3V0LnNldFJvdyhjaGlsZCwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUuY2FsbCh0aGlzLCBjaGlsZCwgYXRJbmRleCk7XG4gICAgfTtcbiAgICBUYWJDb250ZW50SXRlbS5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5jYW5CZUxvYWRlZCA9IGZhbHNlO1xuICAgIH07XG4gICAgVGFiQ29udGVudEl0ZW0ucHJvdG90eXBlLl9nZXRDaGlsZEZyYWdtZW50TWFuYWdlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRhYlZpZXcgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIHRhYkZyYWdtZW50ID0gbnVsbDtcbiAgICAgICAgdmFyIGZyYWdtZW50TWFuYWdlciA9IHRhYlZpZXcuX2dldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMuaW5kZXggPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiQ3VycmVudCBUYWJDb250ZW50SXRlbSBpbmRleCBpcyBub3Qgc2V0XCIsIHRhYl9jb250ZW50X2l0ZW1fY29tbW9uXzEudHJhY2VDYXRlZ29yeSwgdmlld18xLnRyYWNlTWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBmcmFnbWVudE1hbmFnZXIuZ2V0RnJhZ21lbnRzKCkudG9BcnJheSgpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGZyYWdtZW50ID0gX2FbX2ldO1xuICAgICAgICAgICAgaWYgKGZyYWdtZW50LmluZGV4ID09PSB0aGlzLmluZGV4KSB7XG4gICAgICAgICAgICAgICAgdGFiRnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRhYkZyYWdtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gdGFiVmlldy5fZ2V0Um9vdEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YWJGcmFnbWVudC5nZXRDaGlsZEZyYWdtZW50TWFuYWdlcigpO1xuICAgIH07XG4gICAgcmV0dXJuIFRhYkNvbnRlbnRJdGVtO1xufSh0YWJfY29udGVudF9pdGVtX2NvbW1vbl8xLlRhYkNvbnRlbnRJdGVtQmFzZSkpO1xuZXhwb3J0cy5UYWJDb250ZW50SXRlbSA9IFRhYkNvbnRlbnRJdGVtO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFiLWNvbnRlbnQtaXRlbS5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vLi4vY29yZS92aWV3XCIpO1xudmFyIGtub3duQ29sbGVjdGlvbnM7XG4oZnVuY3Rpb24gKGtub3duQ29sbGVjdGlvbnMpIHtcbiAgICBrbm93bkNvbGxlY3Rpb25zLml0ZW1zID0gXCJpdGVtc1wiO1xufSkoa25vd25Db2xsZWN0aW9ucyA9IGV4cG9ydHMua25vd25Db2xsZWN0aW9ucyB8fCAoZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zID0ge30pKTtcbnZhciBUYWJOYXZpZ2F0aW9uQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRhYk5hdmlnYXRpb25CYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRhYk5hdmlnYXRpb25CYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5fYWRkQXJyYXlGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJpdGVtc1wiKSB7XG4gICAgICAgICAgICB0aGlzLml0ZW1zID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJUYWJDb250ZW50SXRlbVwiKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXRlbXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zID0gbmV3IEFycmF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5fYWRkVmlldyh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobmFtZSA9PT0gXCJUYWJTdHJpcFwiKSB7XG4gICAgICAgICAgICB0aGlzLnRhYlN0cmlwID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUsIFwiX3NlbGVjdGVkVmlld1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkSW5kZXggPSB0aGlzLnNlbGVjdGVkSW5kZXg7XG4gICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRJbmRleCA+IC0xID8gdGhpcy5pdGVtc1tzZWxlY3RlZEluZGV4XS5jb250ZW50IDogbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZSwgXCJfY2hpbGRyZW5Db3VudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgICAgIHJldHVybiBpdGVtcyA/IGl0ZW1zLmxlbmd0aCA6IDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soaXRlbSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGFiU3RyaXAgPSB0aGlzLnRhYlN0cmlwO1xuICAgICAgICBpZiAodGFiU3RyaXApIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRhYlN0cmlwKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soaXRlbS5jb250ZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUub25JdGVtc0NoYW5nZWQgPSBmdW5jdGlvbiAob2xkSXRlbXMsIG5ld0l0ZW1zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmIChvbGRJdGVtcykge1xuICAgICAgICAgICAgb2xkSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gX3RoaXMuX3JlbW92ZVZpZXcoaXRlbSk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdJdGVtcykge1xuICAgICAgICAgICAgbmV3SXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmICghaXRlbS5jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRhYkNvbnRlbnRJdGVtIG11c3QgaGF2ZSBhIGNvbnRlbnQgKHZpZXcpLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3RoaXMuX2FkZFZpZXcoaXRlbSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLm9uVGFiU3RyaXBDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZFRhYlN0cmlwLCBuZXdUYWJTdHJpcCkge1xuICAgICAgICBpZiAob2xkVGFiU3RyaXAgJiYgb2xkVGFiU3RyaXAucGFyZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9yZW1vdmVWaWV3KG9sZFRhYlN0cmlwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3VGFiU3RyaXApIHtcbiAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcobmV3VGFiU3RyaXApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUub25TZWxlY3RlZEluZGV4Q2hhbmdlZCA9IGZ1bmN0aW9uIChvbGRJbmRleCwgbmV3SW5kZXgpIHtcbiAgICAgICAgdGhpcy5ub3RpZnkoeyBldmVudE5hbWU6IFRhYk5hdmlnYXRpb25CYXNlLnNlbGVjdGVkSW5kZXhDaGFuZ2VkRXZlbnQsIG9iamVjdDogdGhpcywgb2xkSW5kZXg6IG9sZEluZGV4LCBuZXdJbmRleDogbmV3SW5kZXggfSk7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuZ2V0VGFiQmFyQmFja2dyb3VuZENvbG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJCYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5nZXRUYWJCYXJGb250SW50ZXJuYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLnNldFRhYkJhckZvbnRJbnRlcm5hbCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmdldFRhYkJhclRleHRUcmFuc2Zvcm0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLnNldFRhYkJhclRleHRUcmFuc2Zvcm0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5nZXRUYWJCYXJIaWdobGlnaHRDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJIaWdobGlnaHRDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmdldFRhYkJhckNvbG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLnNldFRhYkJhckl0ZW1UaXRsZSA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuZ2V0VGFiQmFySXRlbUJhY2tncm91bmRDb2xvciA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuc2V0VGFiQmFySXRlbUJhY2tncm91bmRDb2xvciA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuZ2V0VGFiQmFySXRlbUNvbG9yID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtQ29sb3IgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLnNldFRhYkJhckljb25Db2xvciA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuZ2V0VGFiQmFySXRlbUZvbnRTaXplID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtRm9udFNpemUgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmdldFRhYkJhckl0ZW1Gb250SW50ZXJuYWwgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLnNldFRhYkJhckl0ZW1Gb250SW50ZXJuYWwgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmdldFRhYkJhckl0ZW1UZXh0VHJhbnNmb3JtID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtVGV4dFRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5zZWxlY3RlZEluZGV4Q2hhbmdlZEV2ZW50ID0gXCJzZWxlY3RlZEluZGV4Q2hhbmdlZFwiO1xuICAgIHJldHVybiBUYWJOYXZpZ2F0aW9uQmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuVGFiTmF2aWdhdGlvbkJhc2UgPSBUYWJOYXZpZ2F0aW9uQmFzZTtcbnZhciBNSU5fSUNPTl9TSVpFID0gMjQ7XG52YXIgTUFYX0lDT05fV0lEVEggPSAzMTtcbnZhciBNQVhfSUNPTl9IRUlHSFQgPSAyODtcbmZ1bmN0aW9uIGdldEljb25TcGVjU2l6ZShzaXplKSB7XG4gICAgdmFyIGluV2lkdGggPSBzaXplLndpZHRoO1xuICAgIHZhciBpbkhlaWdodCA9IHNpemUuaGVpZ2h0O1xuICAgIHZhciBvdXRXaWR0aCA9IDA7XG4gICAgdmFyIG91dEhlaWdodCA9IDA7XG4gICAgaWYgKGluV2lkdGggPCBpbkhlaWdodCkge1xuICAgICAgICBvdXRXaWR0aCA9IE1JTl9JQ09OX1NJWkU7XG4gICAgICAgIG91dEhlaWdodCA9IChpbkhlaWdodCAqIE1JTl9JQ09OX1NJWkUpIC8gaW5XaWR0aDtcbiAgICAgICAgaWYgKG91dEhlaWdodCA+IE1BWF9JQ09OX0hFSUdIVCkge1xuICAgICAgICAgICAgb3V0SGVpZ2h0ID0gTUFYX0lDT05fSEVJR0hUO1xuICAgICAgICAgICAgb3V0V2lkdGggPSAoaW5XaWR0aCAqIE1BWF9JQ09OX0hFSUdIVCkgLyBpbkhlaWdodDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgb3V0SGVpZ2h0ID0gTUlOX0lDT05fU0laRTtcbiAgICAgICAgb3V0V2lkdGggPSAoaW5XaWR0aCAqIE1JTl9JQ09OX1NJWkUpIC8gaW5IZWlnaHQ7XG4gICAgICAgIGlmIChvdXRXaWR0aCA+IE1BWF9JQ09OX1dJRFRIKSB7XG4gICAgICAgICAgICBvdXRXaWR0aCA9IE1BWF9JQ09OX1dJRFRIO1xuICAgICAgICAgICAgb3V0SGVpZ2h0ID0gKGluSGVpZ2h0ICogTUFYX0lDT05fV0lEVEgpIC8gaW5XaWR0aDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4geyB3aWR0aDogb3V0V2lkdGgsIGhlaWdodDogb3V0SGVpZ2h0IH07XG59XG5leHBvcnRzLmdldEljb25TcGVjU2l6ZSA9IGdldEljb25TcGVjU2l6ZTtcbmV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Db2VyY2libGVQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJzZWxlY3RlZEluZGV4XCIsIGRlZmF1bHRWYWx1ZTogLTEsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0YXJnZXQub25TZWxlY3RlZEluZGV4Q2hhbmdlZChvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgIH0sXG4gICAgY29lcmNlVmFsdWU6IGZ1bmN0aW9uICh0YXJnZXQsIHZhbHVlKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRhcmdldC5pdGVtcztcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICB2YXIgbWF4ID0gaXRlbXMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA8IDApIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWUgPiBtYXgpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IG1heDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5yZWdpc3RlcihUYWJOYXZpZ2F0aW9uQmFzZSk7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1zXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5vbkl0ZW1zQ2hhbmdlZChvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5LnJlZ2lzdGVyKFRhYk5hdmlnYXRpb25CYXNlKTtcbmV4cG9ydHMudGFiU3RyaXBQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidGFiU3RyaXBcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0Lm9uVGFiU3RyaXBDaGFuZ2VkKG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgfVxufSk7XG5leHBvcnRzLnRhYlN0cmlwUHJvcGVydHkucmVnaXN0ZXIoVGFiTmF2aWdhdGlvbkJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFiLW5hdmlnYXRpb24tYmFzZS5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGltYWdlXzEgPSByZXF1aXJlKFwiLi4vLi4vaW1hZ2UvaW1hZ2VcIik7XG52YXIgbGFiZWxfMSA9IHJlcXVpcmUoXCIuLi8uLi9sYWJlbC9sYWJlbFwiKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vLi4vY29yZS92aWV3XCIpO1xudmFyIHRhYnNfMSA9IHJlcXVpcmUoXCIuLi8uLi90YWJzXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vcGxhdGZvcm1cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vLi4vY29yZS92aWV3XCIpKTtcbmV4cG9ydHMudHJhY2VDYXRlZ29yeSA9IFwiVGFiVmlld1wiO1xudmFyIFRhYlN0cmlwSXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRhYlN0cmlwSXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJTdHJpcEl0ZW0oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGFiU3RyaXBJdGVtXzEgPSBUYWJTdHJpcEl0ZW07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlN0cmlwSXRlbS5wcm90b3R5cGUsIFwidGl0bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubGFiZWwudGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90aXRsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX3RpdGxlID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubGFiZWwudGV4dCA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiU3RyaXBJdGVtLnByb3RvdHlwZSwgXCJpY29uU291cmNlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmltYWdlLnNyYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pY29uU291cmNlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5faWNvblNvdXJjZSA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmltYWdlLnNyYyA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUYWJTdHJpcEl0ZW0ucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMuaW1hZ2UpIHtcbiAgICAgICAgICAgIHZhciBpbWFnZSA9IG5ldyBpbWFnZV8xLkltYWdlKCk7XG4gICAgICAgICAgICBpbWFnZS5zcmMgPSB0aGlzLmljb25Tb3VyY2U7XG4gICAgICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7XG4gICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHRoaXMuaW1hZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5sYWJlbCkge1xuICAgICAgICAgICAgdmFyIGxhYmVsID0gbmV3IGxhYmVsXzEuTGFiZWwoKTtcbiAgICAgICAgICAgIGxhYmVsLnRleHQgPSB0aGlzLnRpdGxlO1xuICAgICAgICAgICAgdGhpcy5sYWJlbCA9IGxhYmVsO1xuICAgICAgICAgICAgdGhpcy5fYWRkVmlldyh0aGlzLmxhYmVsKTtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuX2xhYmVsQ29sb3JIYW5kbGVyID0gdGhpcy5fbGFiZWxDb2xvckhhbmRsZXIgfHwgKGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gX3RoaXMucGFyZW50O1xuICAgICAgICAgICAgdmFyIHRhYlN0cmlwUGFyZW50ID0gcGFyZW50ICYmIHBhcmVudC5wYXJlbnQ7XG4gICAgICAgICAgICByZXR1cm4gdGFiU3RyaXBQYXJlbnQgJiYgdGFiU3RyaXBQYXJlbnQuc2V0VGFiQmFySXRlbUNvbG9yKF90aGlzLCBhcmdzLnZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGFiZWwuc3R5bGUub24oXCJjb2xvckNoYW5nZVwiLCB0aGlzLl9sYWJlbENvbG9ySGFuZGxlcik7XG4gICAgICAgIHRoaXMuX2xhYmVsRm9udEhhbmRsZXIgPSB0aGlzLl9sYWJlbEZvbnRIYW5kbGVyIHx8IChmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdmFyIHBhcmVudCA9IF90aGlzLnBhcmVudDtcbiAgICAgICAgICAgIHZhciB0YWJTdHJpcFBhcmVudCA9IHBhcmVudCAmJiBwYXJlbnQucGFyZW50O1xuICAgICAgICAgICAgcmV0dXJuIHRhYlN0cmlwUGFyZW50ICYmIHRhYlN0cmlwUGFyZW50LnNldFRhYkJhckl0ZW1Gb250SW50ZXJuYWwoX3RoaXMsIGFyZ3MudmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5sYWJlbC5zdHlsZS5vbihcImZvbnRJbnRlcm5hbENoYW5nZVwiLCB0aGlzLl9sYWJlbEZvbnRIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5fbGFiZWxUZXh0VHJhbnNmb3JtSGFuZGxlciA9IHRoaXMuX2xhYmVsVGV4dFRyYW5zZm9ybUhhbmRsZXIgfHwgKGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gX3RoaXMucGFyZW50O1xuICAgICAgICAgICAgdmFyIHRhYlN0cmlwUGFyZW50ID0gcGFyZW50ICYmIHBhcmVudC5wYXJlbnQ7XG4gICAgICAgICAgICByZXR1cm4gdGFiU3RyaXBQYXJlbnQgJiYgdGFiU3RyaXBQYXJlbnQuc2V0VGFiQmFySXRlbVRleHRUcmFuc2Zvcm0oX3RoaXMsIGFyZ3MudmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5sYWJlbC5zdHlsZS5vbihcInRleHRUcmFuc2Zvcm1DaGFuZ2VcIiwgdGhpcy5fbGFiZWxUZXh0VHJhbnNmb3JtSGFuZGxlcik7XG4gICAgICAgIHRoaXMuX2xhYmVsVGV4dEhhbmRsZXIgPSB0aGlzLl9sYWJlbFRleHRIYW5kbGVyIHx8IChmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdmFyIHBhcmVudCA9IF90aGlzLnBhcmVudDtcbiAgICAgICAgICAgIHZhciB0YWJTdHJpcFBhcmVudCA9IHBhcmVudCAmJiBwYXJlbnQucGFyZW50O1xuICAgICAgICAgICAgcmV0dXJuIHRhYlN0cmlwUGFyZW50ICYmIHRhYlN0cmlwUGFyZW50LnNldFRhYkJhckl0ZW1UaXRsZShfdGhpcywgYXJncy52YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxhYmVsLm9uKFwidGV4dENoYW5nZVwiLCB0aGlzLl9sYWJlbFRleHRIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5faW1hZ2VDb2xvckhhbmRsZXIgPSB0aGlzLl9pbWFnZUNvbG9ySGFuZGxlciB8fCAoZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSBfdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICB2YXIgdGFiU3RyaXBQYXJlbnQgPSBwYXJlbnQgJiYgcGFyZW50LnBhcmVudDtcbiAgICAgICAgICAgIHJldHVybiB0YWJTdHJpcFBhcmVudCAmJiB0YWJTdHJpcFBhcmVudC5zZXRUYWJCYXJJY29uQ29sb3IoX3RoaXMsIGFyZ3MudmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pbWFnZS5zdHlsZS5vbihcImNvbG9yQ2hhbmdlXCIsIHRoaXMuX2ltYWdlQ29sb3JIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5faW1hZ2VGb250SGFuZGxlciA9IHRoaXMuX2ltYWdlRm9udEhhbmRsZXIgfHwgKGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gX3RoaXMucGFyZW50O1xuICAgICAgICAgICAgdmFyIHRhYlN0cmlwUGFyZW50ID0gcGFyZW50ICYmIHBhcmVudC5wYXJlbnQ7XG4gICAgICAgICAgICByZXR1cm4gdGFiU3RyaXBQYXJlbnQgJiYgdGFiU3RyaXBQYXJlbnQuc2V0VGFiQmFySWNvbkNvbG9yKF90aGlzLCBhcmdzLnZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaW1hZ2Uuc3R5bGUub24oXCJmb250SW50ZXJuYWxDaGFuZ2VcIiwgdGhpcy5faW1hZ2VGb250SGFuZGxlcik7XG4gICAgICAgIHRoaXMuX2ltYWdlU3JjSGFuZGxlciA9IHRoaXMuX2ltYWdlU3JjSGFuZGxlciB8fCAoZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSBfdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICB2YXIgdGFiU3RyaXBQYXJlbnQgPSBwYXJlbnQgJiYgcGFyZW50LnBhcmVudDtcbiAgICAgICAgICAgIHJldHVybiB0YWJTdHJpcFBhcmVudCAmJiB0YWJTdHJpcFBhcmVudC5zZXRUYWJCYXJJY29uQ29sb3IoX3RoaXMsIGFyZ3MudmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pbWFnZS5vbihcInNyY0NoYW5nZVwiLCB0aGlzLl9pbWFnZVNyY0hhbmRsZXIpO1xuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZS5vblVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uVW5sb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5sYWJlbC5zdHlsZS5vZmYoXCJjb2xvckNoYW5nZVwiLCB0aGlzLl9sYWJlbENvbG9ySGFuZGxlcik7XG4gICAgICAgIHRoaXMubGFiZWwuc3R5bGUub2ZmKFwiZm9udEludGVybmFsQ2hhbmdlXCIsIHRoaXMuX2xhYmVsRm9udEhhbmRsZXIpO1xuICAgICAgICB0aGlzLmxhYmVsLnN0eWxlLm9mZihcInRleHRUcmFuc2Zvcm1DaGFuZ2VcIiwgdGhpcy5fbGFiZWxUZXh0VHJhbnNmb3JtSGFuZGxlcik7XG4gICAgICAgIHRoaXMubGFiZWwuc3R5bGUub2ZmKFwidGV4dENoYW5nZVwiLCB0aGlzLl9sYWJlbFRleHRIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5pbWFnZS5zdHlsZS5vZmYoXCJjb2xvckNoYW5nZVwiLCB0aGlzLl9pbWFnZUNvbG9ySGFuZGxlcik7XG4gICAgICAgIHRoaXMuaW1hZ2Uuc3R5bGUub2ZmKFwiZm9udEludGVybmFsQ2hhbmdlXCIsIHRoaXMuX2ltYWdlRm9udEhhbmRsZXIpO1xuICAgICAgICB0aGlzLmltYWdlLnN0eWxlLm9mZihcInNyY0NoYW5nZVwiLCB0aGlzLl9pbWFnZVNyY0hhbmRsZXIpO1xuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHRoaXMubGFiZWwpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRoaXMubGFiZWwpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmltYWdlKSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aGlzLmltYWdlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJJbWFnZVwiKSB7XG4gICAgICAgICAgICB0aGlzLmltYWdlID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLmljb25Tb3VyY2UgPSB2YWx1ZS5zcmM7XG4gICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmFtZSA9PT0gXCJMYWJlbFwiKSB7XG4gICAgICAgICAgICB0aGlzLmxhYmVsID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnRpdGxlID0gdmFsdWUudGV4dDtcbiAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJTdHJpcEl0ZW0ucHJvdG90eXBlLnJlcXVlc3RMYXlvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgICAgcGFyZW50LnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZS5fdXBkYXRlVGFiU3RhdGVDaGFuZ2VIYW5kbGVyID0gZnVuY3Rpb24gKHN1YnNjcmliZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoc3Vic2NyaWJlKSB7XG4gICAgICAgICAgICB0aGlzLl9oaWdobGlnaHRlZEhhbmRsZXIgPSB0aGlzLl9oaWdobGlnaHRlZEhhbmRsZXIgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5fZ29Ub1Zpc3VhbFN0YXRlKFwiaGlnaGxpZ2h0ZWRcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX25vcm1hbEhhbmRsZXIgPSB0aGlzLl9ub3JtYWxIYW5kbGVyIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2dvVG9WaXN1YWxTdGF0ZShcIm5vcm1hbFwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5vbihUYWJTdHJpcEl0ZW1fMS5zZWxlY3RFdmVudCwgdGhpcy5faGlnaGxpZ2h0ZWRIYW5kbGVyKTtcbiAgICAgICAgICAgIHRoaXMub24oVGFiU3RyaXBJdGVtXzEudW5zZWxlY3RFdmVudCwgdGhpcy5fbm9ybWFsSGFuZGxlcik7XG4gICAgICAgICAgICB2YXIgcGFyZW50XzEgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgIHZhciB0YWJTdHJpcFBhcmVudCA9IHBhcmVudF8xICYmIHBhcmVudF8xLnBhcmVudDtcbiAgICAgICAgICAgIGlmICh0aGlzLmluZGV4ID09PSB0YWJTdHJpcFBhcmVudC5zZWxlY3RlZEluZGV4ICYmXG4gICAgICAgICAgICAgICAgIShwbGF0Zm9ybV8xLmlzSU9TICYmIHRhYlN0cmlwUGFyZW50IGluc3RhbmNlb2YgdGFic18xLlRhYnMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZ29Ub1Zpc3VhbFN0YXRlKFwiaGlnaGxpZ2h0ZWRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9mZihUYWJTdHJpcEl0ZW1fMS5zZWxlY3RFdmVudCwgdGhpcy5faGlnaGxpZ2h0ZWRIYW5kbGVyKTtcbiAgICAgICAgICAgIHRoaXMub2ZmKFRhYlN0cmlwSXRlbV8xLnVuc2VsZWN0RXZlbnQsIHRoaXMuX25vcm1hbEhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJTdHJpcEl0ZW0ucHJvdG90eXBlW3ZpZXdfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgdGFiU3RyaXBQYXJlbnQgPSBwYXJlbnQgJiYgcGFyZW50LnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHRhYlN0cmlwUGFyZW50ICYmIHRhYlN0cmlwUGFyZW50LmdldFRhYkJhckJhY2tncm91bmRDb2xvcigpO1xuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZVt2aWV3XzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciB0YWJTdHJpcFBhcmVudCA9IHBhcmVudCAmJiBwYXJlbnQucGFyZW50O1xuICAgICAgICByZXR1cm4gdGFiU3RyaXBQYXJlbnQgJiYgdGFiU3RyaXBQYXJlbnQuc2V0VGFiQmFySXRlbUJhY2tncm91bmRDb2xvcih0aGlzLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBUYWJTdHJpcEl0ZW0ucHJvdG90eXBlW3ZpZXdfMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJTdHJpcEl0ZW0ucHJvdG90eXBlW3ZpZXdfMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICB2YXIgVGFiU3RyaXBJdGVtXzE7XG4gICAgVGFiU3RyaXBJdGVtLnRhcEV2ZW50ID0gXCJ0YXBcIjtcbiAgICBUYWJTdHJpcEl0ZW0uc2VsZWN0RXZlbnQgPSBcInNlbGVjdFwiO1xuICAgIFRhYlN0cmlwSXRlbS51bnNlbGVjdEV2ZW50ID0gXCJ1bnNlbGVjdFwiO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuUHNldWRvQ2xhc3NIYW5kbGVyKFwibm9ybWFsXCIsIFwiaGlnaGxpZ2h0ZWRcIiwgXCJwcmVzc2VkXCIsIFwiYWN0aXZlXCIpXG4gICAgXSwgVGFiU3RyaXBJdGVtLnByb3RvdHlwZSwgXCJfdXBkYXRlVGFiU3RhdGVDaGFuZ2VIYW5kbGVyXCIsIG51bGwpO1xuICAgIFRhYlN0cmlwSXRlbSA9IFRhYlN0cmlwSXRlbV8xID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiVGFiU3RyaXBJdGVtXCIpXG4gICAgXSwgVGFiU3RyaXBJdGVtKTtcbiAgICByZXR1cm4gVGFiU3RyaXBJdGVtO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5UYWJTdHJpcEl0ZW0gPSBUYWJTdHJpcEl0ZW07XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YWItc3RyaXAtaXRlbS5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29sb3JfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jb2xvclwiKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vLi4vY29yZS92aWV3XCIpO1xudmFyIHRleHRfYmFzZV8xID0gcmVxdWlyZShcIi4uLy4uL3RleHQtYmFzZVwiKTtcbmV4cG9ydHMudHJhY2VDYXRlZ29yeSA9IFwiVGFiVmlld1wiO1xuZXhwb3J0cy5oaWdobGlnaHRDb2xvclByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaGlnaGxpZ2h0Q29sb3JcIiwgZXF1YWxpdHlDb21wYXJlcjogY29sb3JfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IGNvbG9yXzEuQ29sb3Iodik7IH0gfSk7XG52YXIgVGFiU3RyaXAgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJTdHJpcCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJTdHJpcCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUYWJTdHJpcC5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZS5fYWRkQXJyYXlGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJpdGVtc1wiKSB7XG4gICAgICAgICAgICB0aGlzLml0ZW1zID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJUYWJTdHJpcEl0ZW1cIikge1xuICAgICAgICAgICAgaWYgKCF0aGlzLml0ZW1zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGUub25JdGVtc0NoYW5nZWQgPSBmdW5jdGlvbiAob2xkSXRlbXMsIG5ld0l0ZW1zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmIChvbGRJdGVtcykge1xuICAgICAgICAgICAgb2xkSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gX3RoaXMuX3JlbW92ZVZpZXcoaXRlbSk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdJdGVtcykge1xuICAgICAgICAgICAgbmV3SXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIF90aGlzLl9hZGRWaWV3KGl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZVt2aWV3XzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuZ2V0VGFiQmFyQmFja2dyb3VuZENvbG9yKCk7XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGVbdmlld18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5zZXRUYWJCYXJCYWNrZ3JvdW5kQ29sb3IodmFsdWUpO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW3ZpZXdfMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGVbdmlld18xLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZVt2aWV3XzEuY29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5nZXRUYWJCYXJDb2xvcigpO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW3ZpZXdfMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5zZXRUYWJCYXJDb2xvcih2YWx1ZSk7XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGVbdmlld18xLmZvbnRJbnRlcm5hbFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50LmdldFRhYkJhckZvbnRJbnRlcm5hbCgpO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW3ZpZXdfMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuc2V0VGFiQmFyRm9udEludGVybmFsKHZhbHVlKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS50ZXh0VHJhbnNmb3JtUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuZ2V0VGFiQmFyVGV4dFRyYW5zZm9ybSgpO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW3RleHRfYmFzZV8xLnRleHRUcmFuc2Zvcm1Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuc2V0VGFiQmFyVGV4dFRyYW5zZm9ybSh2YWx1ZSk7XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGVbZXhwb3J0cy5oaWdobGlnaHRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50LmdldFRhYkJhckhpZ2hsaWdodENvbG9yKCk7XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGVbZXhwb3J0cy5oaWdobGlnaHRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5zZXRUYWJCYXJIaWdobGlnaHRDb2xvcih2YWx1ZSk7XG4gICAgfTtcbiAgICBUYWJTdHJpcC5pdGVtVGFwRXZlbnQgPSBcIml0ZW1UYXBcIjtcbiAgICBUYWJTdHJpcCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIlRhYlN0cmlwXCIpXG4gICAgXSwgVGFiU3RyaXApO1xuICAgIHJldHVybiBUYWJTdHJpcDtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuVGFiU3RyaXAgPSBUYWJTdHJpcDtcbmV4cG9ydHMuaXRlbXNQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbXNcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0Lm9uSXRlbXNDaGFuZ2VkKG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgfVxufSk7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkucmVnaXN0ZXIoVGFiU3RyaXApO1xuZXhwb3J0cy5pb3NJY29uUmVuZGVyaW5nTW9kZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaW9zSWNvblJlbmRlcmluZ01vZGVcIiwgZGVmYXVsdFZhbHVlOiBcImF1dG9tYXRpY1wiIH0pO1xuZXhwb3J0cy5pb3NJY29uUmVuZGVyaW5nTW9kZVByb3BlcnR5LnJlZ2lzdGVyKFRhYlN0cmlwKTtcbmV4cG9ydHMuaXNJY29uU2l6ZUZpeGVkUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImlzSWNvblNpemVGaXhlZFwiLCBkZWZhdWx0VmFsdWU6IHRydWUsIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuYm9vbGVhbkNvbnZlcnRlclxufSk7XG5leHBvcnRzLmlzSWNvblNpemVGaXhlZFByb3BlcnR5LnJlZ2lzdGVyKFRhYlN0cmlwKTtcbmV4cG9ydHMuaGlnaGxpZ2h0Q29sb3JQcm9wZXJ0eS5yZWdpc3RlcihUYWJTdHJpcCk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YWItc3RyaXAuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG5leHBvcnRzLnRyYWNlQ2F0ZWdvcnkgPSBcIlRhYlZpZXdcIjtcbnZhciBUYWJWaWV3SXRlbUJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJWaWV3SXRlbUJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGFiVmlld0l0ZW1CYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3RpdGxlID0gXCJcIjtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiVmlld0l0ZW1CYXNlLnByb3RvdHlwZSwgXCJ0ZXh0VHJhbnNmb3JtXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50ZXh0VHJhbnNmb3JtO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50ZXh0VHJhbnNmb3JtID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRhYlZpZXdJdGVtQmFzZS5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2Ygdmlld18xLlZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMudmlldyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiVmlld0l0ZW1CYXNlLnByb3RvdHlwZSwgXCJ0aXRsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RpdGxlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3RpdGxlICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RpdGxlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3SXRlbUJhc2UucHJvdG90eXBlLCBcInZpZXdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl92aWV3O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3ZpZXcgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3ZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2hhbmdpbmcgdGhlIHZpZXcgb2YgYW4gYWxyZWFkeSBsb2FkZWQgVGFiVmlld0l0ZW0gaXMgbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl92aWV3ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWRkVmlldyh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3SXRlbUJhc2UucHJvdG90eXBlLCBcImljb25Tb3VyY2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pY29uU291cmNlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2ljb25Tb3VyY2UgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faWNvblNvdXJjZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUYWJWaWV3SXRlbUJhc2UucHJvdG90eXBlLmVhY2hDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMuX3ZpZXc7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICBjYWxsYmFjayh2aWV3KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiVmlld0l0ZW1CYXNlLnByb3RvdHlwZS5sb2FkVmlldyA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHZhciB0YWJWaWV3ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmICh0YWJWaWV3ICYmIHRhYlZpZXcuaXRlbXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbkJlTG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5sb2FkVmlldy5jYWxsKHRoaXMsIHZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbUJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJUYWJWaWV3SXRlbVwiKVxuICAgIF0sIFRhYlZpZXdJdGVtQmFzZSk7XG4gICAgcmV0dXJuIFRhYlZpZXdJdGVtQmFzZTtcbn0odmlld18xLlZpZXdCYXNlKSk7XG5leHBvcnRzLlRhYlZpZXdJdGVtQmFzZSA9IFRhYlZpZXdJdGVtQmFzZTtcbnZhciBrbm93bkNvbGxlY3Rpb25zO1xuKGZ1bmN0aW9uIChrbm93bkNvbGxlY3Rpb25zKSB7XG4gICAga25vd25Db2xsZWN0aW9ucy5pdGVtcyA9IFwiaXRlbXNcIjtcbn0pKGtub3duQ29sbGVjdGlvbnMgPSBleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgfHwgKGV4cG9ydHMua25vd25Db2xsZWN0aW9ucyA9IHt9KSk7XG52YXIgVGFiVmlld0Jhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJWaWV3QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJWaWV3QmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUYWJWaWV3QmFzZV8xID0gVGFiVmlld0Jhc2U7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXdCYXNlLnByb3RvdHlwZSwgXCJhbmRyb2lkU2VsZWN0ZWRUYWJIaWdobGlnaHRDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYW5kcm9pZFNlbGVjdGVkVGFiSGlnaGxpZ2h0Q29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmFuZHJvaWRTZWxlY3RlZFRhYkhpZ2hsaWdodENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3QmFzZS5wcm90b3R5cGUsIFwidGFiVGV4dEZvbnRTaXplXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50YWJUZXh0Rm9udFNpemU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnRhYlRleHRGb250U2l6ZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiVmlld0Jhc2UucHJvdG90eXBlLCBcInRhYlRleHRDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGFiVGV4dENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50YWJUZXh0Q29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXdCYXNlLnByb3RvdHlwZSwgXCJ0YWJCYWNrZ3JvdW5kQ29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRhYkJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudGFiQmFja2dyb3VuZENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3QmFzZS5wcm90b3R5cGUsIFwic2VsZWN0ZWRUYWJUZXh0Q29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnNlbGVjdGVkVGFiVGV4dENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5zZWxlY3RlZFRhYlRleHRDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUYWJWaWV3QmFzZS5wcm90b3R5cGUuX2FkZEFycmF5RnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiaXRlbXNcIikge1xuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3QmFzZS5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiVGFiVmlld0l0ZW1cIikge1xuICAgICAgICAgICAgaWYgKCF0aGlzLml0ZW1zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodmFsdWUpO1xuICAgICAgICAgICAgZXhwb3J0cy5zZWxlY3RlZEluZGV4UHJvcGVydHkuY29lcmNlKHRoaXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiVmlld0Jhc2UucHJvdG90eXBlLCBcIl9zZWxlY3RlZFZpZXdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEluZGV4ID0gdGhpcy5zZWxlY3RlZEluZGV4O1xuICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkSW5kZXggPiAtMSA/IHRoaXMuaXRlbXNbc2VsZWN0ZWRJbmRleF0udmlldyA6IG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3QmFzZS5wcm90b3R5cGUsIFwiX2NoaWxkcmVuQ291bnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgICAgICByZXR1cm4gaXRlbXMgPyBpdGVtcy5sZW5ndGggOiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUYWJWaWV3QmFzZS5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXdCYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGl0ZW0udmlldyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiVmlld0Jhc2UucHJvdG90eXBlLm9uSXRlbXNDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZEl0ZW1zLCBuZXdJdGVtcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAob2xkSXRlbXMpIHtcbiAgICAgICAgICAgIG9sZEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIF90aGlzLl9yZW1vdmVWaWV3KGl0ZW0pOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3SXRlbXMpIHtcbiAgICAgICAgICAgIG5ld0l0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoIWl0ZW0udmlldykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUYWJWaWV3SXRlbSBtdXN0IGhhdmUgYSB2aWV3LlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3RoaXMuX2FkZFZpZXcoaXRlbSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiVmlld0Jhc2UucHJvdG90eXBlLm9uU2VsZWN0ZWRJbmRleENoYW5nZWQgPSBmdW5jdGlvbiAob2xkSW5kZXgsIG5ld0luZGV4KSB7XG4gICAgICAgIHRoaXMubm90aWZ5KHsgZXZlbnROYW1lOiBUYWJWaWV3QmFzZV8xLnNlbGVjdGVkSW5kZXhDaGFuZ2VkRXZlbnQsIG9iamVjdDogdGhpcywgb2xkSW5kZXg6IG9sZEluZGV4LCBuZXdJbmRleDogbmV3SW5kZXggfSk7XG4gICAgfTtcbiAgICB2YXIgVGFiVmlld0Jhc2VfMTtcbiAgICBUYWJWaWV3QmFzZS5zZWxlY3RlZEluZGV4Q2hhbmdlZEV2ZW50ID0gXCJzZWxlY3RlZEluZGV4Q2hhbmdlZFwiO1xuICAgIFRhYlZpZXdCYXNlID0gVGFiVmlld0Jhc2VfMSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIlRhYlZpZXdcIilcbiAgICBdLCBUYWJWaWV3QmFzZSk7XG4gICAgcmV0dXJuIFRhYlZpZXdCYXNlO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5UYWJWaWV3QmFzZSA9IFRhYlZpZXdCYXNlO1xuZnVuY3Rpb24gdHJhY2VNaXNzaW5nSWNvbihpY29uKSB7XG4gICAgdmlld18xLnRyYWNlV3JpdGUoXCJDb3VsZCBub3QgbG9hZCB0YWIgYmFyIGljb246IFwiICsgaWNvbiwgdmlld18xLnRyYWNlQ2F0ZWdvcmllcy5FcnJvciwgdmlld18xLnRyYWNlTWVzc2FnZVR5cGUuZXJyb3IpO1xufVxuZXhwb3J0cy50cmFjZU1pc3NpbmdJY29uID0gdHJhY2VNaXNzaW5nSWNvbjtcbmV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Db2VyY2libGVQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJzZWxlY3RlZEluZGV4XCIsIGRlZmF1bHRWYWx1ZTogLTEsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0YXJnZXQub25TZWxlY3RlZEluZGV4Q2hhbmdlZChvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgIH0sXG4gICAgY29lcmNlVmFsdWU6IGZ1bmN0aW9uICh0YXJnZXQsIHZhbHVlKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRhcmdldC5pdGVtcztcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICB2YXIgbWF4ID0gaXRlbXMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA8IDApIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWUgPiBtYXgpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IG1heDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5yZWdpc3RlcihUYWJWaWV3QmFzZSk7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1zXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5vbkl0ZW1zQ2hhbmdlZChvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5LnJlZ2lzdGVyKFRhYlZpZXdCYXNlKTtcbmV4cG9ydHMuaW9zSWNvblJlbmRlcmluZ01vZGVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImlvc0ljb25SZW5kZXJpbmdNb2RlXCIsIGRlZmF1bHRWYWx1ZTogXCJhdXRvbWF0aWNcIiB9KTtcbmV4cG9ydHMuaW9zSWNvblJlbmRlcmluZ01vZGVQcm9wZXJ0eS5yZWdpc3RlcihUYWJWaWV3QmFzZSk7XG5leHBvcnRzLmFuZHJvaWRPZmZzY3JlZW5UYWJMaW1pdFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJhbmRyb2lkT2Zmc2NyZWVuVGFiTGltaXRcIiwgZGVmYXVsdFZhbHVlOiAxLCBhZmZlY3RzTGF5b3V0OiB2aWV3XzEuaXNJT1MsXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLmFuZHJvaWRPZmZzY3JlZW5UYWJMaW1pdFByb3BlcnR5LnJlZ2lzdGVyKFRhYlZpZXdCYXNlKTtcbmV4cG9ydHMuYW5kcm9pZFRhYnNQb3NpdGlvblByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYW5kcm9pZFRhYnNQb3NpdGlvblwiLCBkZWZhdWx0VmFsdWU6IFwidG9wXCIgfSk7XG5leHBvcnRzLmFuZHJvaWRUYWJzUG9zaXRpb25Qcm9wZXJ0eS5yZWdpc3RlcihUYWJWaWV3QmFzZSk7XG5leHBvcnRzLmFuZHJvaWRTd2lwZUVuYWJsZWRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImFuZHJvaWRTd2lwZUVuYWJsZWRcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLCB2YWx1ZUNvbnZlcnRlcjogdmlld18xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmFuZHJvaWRTd2lwZUVuYWJsZWRQcm9wZXJ0eS5yZWdpc3RlcihUYWJWaWV3QmFzZSk7XG5leHBvcnRzLnRhYlRleHRGb250U2l6ZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwidGFiVGV4dEZvbnRTaXplXCIsIGNzc05hbWU6IFwidGFiLXRleHQtZm9udC1zaXplXCIsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VGbG9hdCh2KTsgfSB9KTtcbmV4cG9ydHMudGFiVGV4dEZvbnRTaXplUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbmV4cG9ydHMudGFiVGV4dENvbG9yUHJvcGVydHkgPSBuZXcgdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJ0YWJUZXh0Q29sb3JcIiwgY3NzTmFtZTogXCJ0YWItdGV4dC1jb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyB2aWV3XzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLnRhYlRleHRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG5leHBvcnRzLnRhYkJhY2tncm91bmRDb2xvclByb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwidGFiQmFja2dyb3VuZENvbG9yXCIsIGNzc05hbWU6IFwidGFiLWJhY2tncm91bmQtY29sb3JcIiwgZXF1YWxpdHlDb21wYXJlcjogdmlld18xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgdmlld18xLkNvbG9yKHYpOyB9IH0pO1xuZXhwb3J0cy50YWJCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xuZXhwb3J0cy5zZWxlY3RlZFRhYlRleHRDb2xvclByb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwic2VsZWN0ZWRUYWJUZXh0Q29sb3JcIiwgY3NzTmFtZTogXCJzZWxlY3RlZC10YWItdGV4dC1jb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyB2aWV3XzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLnNlbGVjdGVkVGFiVGV4dENvbG9yUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbmV4cG9ydHMuYW5kcm9pZFNlbGVjdGVkVGFiSGlnaGxpZ2h0Q29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImFuZHJvaWRTZWxlY3RlZFRhYkhpZ2hsaWdodENvbG9yXCIsIGNzc05hbWU6IFwiYW5kcm9pZC1zZWxlY3RlZC10YWItaGlnaGxpZ2h0LWNvbG9yXCIsIGVxdWFsaXR5Q29tcGFyZXI6IHZpZXdfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IHZpZXdfMS5Db2xvcih2KTsgfSB9KTtcbmV4cG9ydHMuYW5kcm9pZFNlbGVjdGVkVGFiSGlnaGxpZ2h0Q29sb3JQcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFiLXZpZXctY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZm9udF8xID0gcmVxdWlyZShcIi4uL3N0eWxpbmcvZm9udFwiKTtcbnZhciB0YWJfdmlld19jb21tb25fMSA9IHJlcXVpcmUoXCIuL3RhYi12aWV3LWNvbW1vblwiKTtcbnZhciB0ZXh0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIik7XG52YXIgaW1hZ2Vfc291cmNlXzEgPSByZXF1aXJlKFwiLi4vLi4vaW1hZ2Utc291cmNlXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdXRpbHNcIik7XG52YXIgZnJhbWVfMSA9IHJlcXVpcmUoXCIuLi9mcmFtZVwiKTtcbnZhciBhcHBsaWNhdGlvbiA9IHJlcXVpcmUoXCIuLi8uLi9hcHBsaWNhdGlvblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3RhYi12aWV3LWNvbW1vblwiKSk7XG52YXIgQUNDRU5UX0NPTE9SID0gXCJjb2xvckFjY2VudFwiO1xudmFyIFBSSU1BUllfQ09MT1IgPSBcImNvbG9yUHJpbWFyeVwiO1xudmFyIERFRkFVTFRfRUxFVkFUSU9OID0gNDtcbnZhciBUQUJJRCA9IFwiX3RhYklkXCI7XG52YXIgSU5ERVggPSBcIl9pbmRleFwiO1xudmFyIFBhZ2VyQWRhcHRlcjtcbmZ1bmN0aW9uIG1ha2VGcmFnbWVudE5hbWUodmlld0lkLCBpZCkge1xuICAgIHJldHVybiBcImFuZHJvaWQ6dmlld3BhZ2VyOlwiICsgdmlld0lkICsgXCI6XCIgKyBpZDtcbn1cbmZ1bmN0aW9uIGdldFRhYkJ5SWQoaWQpIHtcbiAgICB2YXIgcmVmID0gZXhwb3J0cy50YWJzLmZpbmQoZnVuY3Rpb24gKHJlZikge1xuICAgICAgICB2YXIgdGFiID0gcmVmLmdldCgpO1xuICAgICAgICByZXR1cm4gdGFiICYmIHRhYi5fZG9tSWQgPT09IGlkO1xuICAgIH0pO1xuICAgIHJldHVybiByZWYgJiYgcmVmLmdldCgpO1xufVxuZnVuY3Rpb24gaW5pdGlhbGl6ZU5hdGl2ZUNsYXNzZXMoKSB7XG4gICAgaWYgKFBhZ2VyQWRhcHRlcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24sIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbi5uZXdJbnN0YW5jZSA9IGZ1bmN0aW9uICh0YWJJZCwgaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gbmV3IGFuZHJvaWQub3MuQnVuZGxlKCk7XG4gICAgICAgICAgICBhcmdzLnB1dEludChUQUJJRCwgdGFiSWQpO1xuICAgICAgICAgICAgYXJncy5wdXRJbnQoSU5ERVgsIGluZGV4KTtcbiAgICAgICAgICAgIHZhciBmcmFnbWVudCA9IG5ldyBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uKCk7XG4gICAgICAgICAgICBmcmFnbWVudC5zZXRBcmd1bWVudHMoYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gZnJhZ21lbnQ7XG4gICAgICAgIH07XG4gICAgICAgIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uQ3JlYXRlID0gZnVuY3Rpb24gKHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkNyZWF0ZS5jYWxsKHRoaXMsIHNhdmVkSW5zdGFuY2VTdGF0ZSk7XG4gICAgICAgICAgICB2YXIgYXJncyA9IHRoaXMuZ2V0QXJndW1lbnRzKCk7XG4gICAgICAgICAgICB0aGlzLnRhYiA9IGdldFRhYkJ5SWQoYXJncy5nZXRJbnQoVEFCSUQpKTtcbiAgICAgICAgICAgIHRoaXMuaW5kZXggPSBhcmdzLmdldEludChJTkRFWCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMudGFiKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgVGFiVmlld1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25DcmVhdGVWaWV3ID0gZnVuY3Rpb24gKGluZmxhdGVyLCBjb250YWluZXIsIHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICAgICAgdmFyIHRhYkl0ZW0gPSB0aGlzLnRhYi5pdGVtc1t0aGlzLmluZGV4XTtcbiAgICAgICAgICAgIHJldHVybiB0YWJJdGVtLnZpZXcubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb247XG4gICAgfShvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuRnJhZ21lbnRCYXNlKSk7XG4gICAgdmFyIFBPU0lUSU9OX1VOQ0hBTkdFRCA9IC0xO1xuICAgIHZhciBQT1NJVElPTl9OT05FID0gLTI7XG4gICAgdmFyIEZyYWdtZW50UGFnZXJBZGFwdGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKEZyYWdtZW50UGFnZXJBZGFwdGVyLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBGcmFnbWVudFBhZ2VyQWRhcHRlcihvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW1zID8gaXRlbXMubGVuZ3RoIDogMDtcbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLmdldFBhZ2VUaXRsZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gaXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaXRlbXNbaW5kZXhdLnRpdGxlO1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuc3RhcnRVcGRhdGUgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7XG4gICAgICAgICAgICBpZiAoY29udGFpbmVyLmdldElkKCkgPT09IGFuZHJvaWQudmlldy5WaWV3Lk5PX0lEKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmlld1BhZ2VyIHdpdGggYWRhcHRlciBcIiArIHRoaXMgKyBcIiByZXF1aXJlcyBhIHZpZXcgY29udGFpbmVySWRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5pbnN0YW50aWF0ZUl0ZW0gPSBmdW5jdGlvbiAoY29udGFpbmVyLCBwb3NpdGlvbikge1xuICAgICAgICAgICAgdmFyIGZyYWdtZW50TWFuYWdlciA9IHRoaXMub3duZXIuX2dldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLm1DdXJUcmFuc2FjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMubUN1clRyYW5zYWN0aW9uID0gZnJhZ21lbnRNYW5hZ2VyLmJlZ2luVHJhbnNhY3Rpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpdGVtSWQgPSB0aGlzLmdldEl0ZW1JZChwb3NpdGlvbik7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IG1ha2VGcmFnbWVudE5hbWUoY29udGFpbmVyLmdldElkKCksIGl0ZW1JZCk7XG4gICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSBmcmFnbWVudE1hbmFnZXIuZmluZEZyYWdtZW50QnlUYWcobmFtZSk7XG4gICAgICAgICAgICBpZiAoZnJhZ21lbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMubUN1clRyYW5zYWN0aW9uLmF0dGFjaChmcmFnbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmcmFnbWVudCA9IFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24ubmV3SW5zdGFuY2UodGhpcy5vd25lci5fZG9tSWQsIHBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1DdXJUcmFuc2FjdGlvbi5hZGQoY29udGFpbmVyLmdldElkKCksIGZyYWdtZW50LCBuYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmcmFnbWVudCAhPT0gdGhpcy5tQ3VycmVudFByaW1hcnlJdGVtKSB7XG4gICAgICAgICAgICAgICAgZnJhZ21lbnQuc2V0TWVudVZpc2liaWxpdHkoZmFsc2UpO1xuICAgICAgICAgICAgICAgIGZyYWdtZW50LnNldFVzZXJWaXNpYmxlSGludChmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdGFiSXRlbXMgPSB0aGlzLm93bmVyLml0ZW1zO1xuICAgICAgICAgICAgdmFyIHRhYkl0ZW0gPSB0YWJJdGVtcyA/IHRhYkl0ZW1zW3Bvc2l0aW9uXSA6IG51bGw7XG4gICAgICAgICAgICBpZiAodGFiSXRlbSkge1xuICAgICAgICAgICAgICAgIHRhYkl0ZW0uY2FuQmVMb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZyYWdtZW50O1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuZ2V0SXRlbVBvc2l0aW9uID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXRlbXMgPyBQT1NJVElPTl9VTkNIQU5HRUQgOiBQT1NJVElPTl9OT05FO1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuZGVzdHJveUl0ZW0gPSBmdW5jdGlvbiAoY29udGFpbmVyLCBwb3NpdGlvbiwgb2JqZWN0KSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMubUN1clRyYW5zYWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyYWdtZW50TWFuYWdlciA9IHRoaXMub3duZXIuX2dldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICAgICAgICAgIHRoaXMubUN1clRyYW5zYWN0aW9uID0gZnJhZ21lbnRNYW5hZ2VyLmJlZ2luVHJhbnNhY3Rpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmcmFnbWVudCA9IG9iamVjdDtcbiAgICAgICAgICAgIHRoaXMubUN1clRyYW5zYWN0aW9uLmRldGFjaChmcmFnbWVudCk7XG4gICAgICAgICAgICBpZiAodGhpcy5tQ3VycmVudFByaW1hcnlJdGVtID09PSBmcmFnbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMubUN1cnJlbnRQcmltYXJ5SXRlbSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdGFiSXRlbXMgPSB0aGlzLm93bmVyLml0ZW1zO1xuICAgICAgICAgICAgdmFyIHRhYkl0ZW0gPSB0YWJJdGVtcyA/IHRhYkl0ZW1zW3Bvc2l0aW9uXSA6IG51bGw7XG4gICAgICAgICAgICBpZiAodGFiSXRlbSkge1xuICAgICAgICAgICAgICAgIHRhYkl0ZW0uY2FuQmVMb2FkZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLnNldFByaW1hcnlJdGVtID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgcG9zaXRpb24sIG9iamVjdCkge1xuICAgICAgICAgICAgdmFyIGZyYWdtZW50ID0gb2JqZWN0O1xuICAgICAgICAgICAgaWYgKGZyYWdtZW50ICE9PSB0aGlzLm1DdXJyZW50UHJpbWFyeUl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tQ3VycmVudFByaW1hcnlJdGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tQ3VycmVudFByaW1hcnlJdGVtLnNldE1lbnVWaXNpYmlsaXR5KGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tQ3VycmVudFByaW1hcnlJdGVtLnNldFVzZXJWaXNpYmxlSGludChmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmcmFnbWVudCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyYWdtZW50LnNldE1lbnVWaXNpYmlsaXR5KHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBmcmFnbWVudC5zZXRVc2VyVmlzaWJsZUhpbnQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMubUN1cnJlbnRQcmltYXJ5SXRlbSA9IGZyYWdtZW50O1xuICAgICAgICAgICAgICAgIHRoaXMub3duZXIuc2VsZWN0ZWRJbmRleCA9IHBvc2l0aW9uO1xuICAgICAgICAgICAgICAgIHZhciB0YWIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgICAgIHZhciB0YWJJdGVtcyA9IHRhYi5pdGVtcztcbiAgICAgICAgICAgICAgICB2YXIgbmV3VGFiSXRlbSA9IHRhYkl0ZW1zID8gdGFiSXRlbXNbcG9zaXRpb25dIDogbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAobmV3VGFiSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICB0YWIuX2xvYWRVbmxvYWRUYWJJdGVtcyh0YWIuc2VsZWN0ZWRJbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuZmluaXNoVXBkYXRlID0gZnVuY3Rpb24gKGNvbnRhaW5lcikge1xuICAgICAgICAgICAgdGhpcy5fY29tbWl0Q3VycmVudFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5pc1ZpZXdGcm9tT2JqZWN0ID0gZnVuY3Rpb24gKHZpZXcsIG9iamVjdCkge1xuICAgICAgICAgICAgcmV0dXJuIG9iamVjdC5nZXRWaWV3KCkgPT09IHZpZXc7XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5zYXZlU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLl9jb21taXRDdXJyZW50VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUucmVzdG9yZVN0YXRlID0gZnVuY3Rpb24gKHN0YXRlLCBsb2FkZXIpIHtcbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLmdldEl0ZW1JZCA9IGZ1bmN0aW9uIChwb3NpdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHBvc2l0aW9uO1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuX2NvbW1pdEN1cnJlbnRUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm1DdXJUcmFuc2FjdGlvbiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tQ3VyVHJhbnNhY3Rpb24uY29tbWl0Tm93QWxsb3dpbmdTdGF0ZUxvc3MoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1DdXJUcmFuc2FjdGlvbiA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBGcmFnbWVudFBhZ2VyQWRhcHRlcjtcbiAgICB9KGFuZHJvaWR4LnZpZXdwYWdlci53aWRnZXQuUGFnZXJBZGFwdGVyKSk7XG4gICAgUGFnZXJBZGFwdGVyID0gRnJhZ21lbnRQYWdlckFkYXB0ZXI7XG59XG5mdW5jdGlvbiBjcmVhdGVUYWJJdGVtU3BlYyhpdGVtKSB7XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVGFiSXRlbVNwZWMoKTtcbiAgICByZXN1bHQudGl0bGUgPSBpdGVtLnRpdGxlO1xuICAgIGlmIChpdGVtLmljb25Tb3VyY2UpIHtcbiAgICAgICAgaWYgKGl0ZW0uaWNvblNvdXJjZS5pbmRleE9mKHV0aWxzXzEuUkVTT1VSQ0VfUFJFRklYKSA9PT0gMCkge1xuICAgICAgICAgICAgcmVzdWx0Lmljb25JZCA9IHV0aWxzXzEuYWQucmVzb3VyY2VzLmdldERyYXdhYmxlSWQoaXRlbS5pY29uU291cmNlLnN1YnN0cih1dGlsc18xLlJFU09VUkNFX1BSRUZJWC5sZW5ndGgpKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuaWNvbklkID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGFiX3ZpZXdfY29tbW9uXzEudHJhY2VNaXNzaW5nSWNvbihpdGVtLmljb25Tb3VyY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGlzID0gaW1hZ2Vfc291cmNlXzEuZnJvbUZpbGVPclJlc291cmNlKGl0ZW0uaWNvblNvdXJjZSk7XG4gICAgICAgICAgICBpZiAoaXMpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQuaWNvbkRyYXdhYmxlID0gbmV3IGFuZHJvaWQuZ3JhcGhpY3MuZHJhd2FibGUuQml0bWFwRHJhd2FibGUoYXBwbGljYXRpb24uYW5kcm9pZC5jb250ZXh0LmdldFJlc291cmNlcygpLCBpcy5hbmRyb2lkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlTWlzc2luZ0ljb24oaXRlbS5pY29uU291cmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxudmFyIGRlZmF1bHRBY2NlbnRDb2xvciA9IHVuZGVmaW5lZDtcbmZ1bmN0aW9uIGdldERlZmF1bHRBY2NlbnRDb2xvcihjb250ZXh0KSB7XG4gICAgaWYgKGRlZmF1bHRBY2NlbnRDb2xvciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGRlZmF1bHRBY2NlbnRDb2xvciA9IHV0aWxzXzEuYWQucmVzb3VyY2VzLmdldFBhbGV0dGVDb2xvcihBQ0NFTlRfQ09MT1IsIGNvbnRleHQpIHx8IDB4RkYzM0I1RTU7XG4gICAgfVxuICAgIHJldHVybiBkZWZhdWx0QWNjZW50Q29sb3I7XG59XG52YXIgVGFiVmlld0l0ZW0gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJWaWV3SXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJWaWV3SXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiVmlld0l0ZW0ucHJvdG90eXBlLCBcIl9oYXNGcmFnbWVudHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdGhpcy5fZGVmYXVsdFRyYW5zZm9ybWF0aW9uTWV0aG9kID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFRyYW5zZm9ybWF0aW9uTWV0aG9kKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXdJdGVtLnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgVGFiVmlld0l0ZW0ucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFRyYW5zZm9ybWF0aW9uTWV0aG9kKHRoaXMuX2RlZmF1bHRUcmFuc2Zvcm1hdGlvbk1ldGhvZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXdJdGVtLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLmNhbkJlTG9hZGVkID0gZmFsc2U7XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICB9O1xuICAgIFRhYlZpZXdJdGVtLnByb3RvdHlwZS5fdXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdHYgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciB0YWJWaWV3ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmICh0diAmJiB0YWJWaWV3KSB7XG4gICAgICAgICAgICB0aGlzLnRhYkl0ZW1TcGVjID0gY3JlYXRlVGFiSXRlbVNwZWModGhpcyk7XG4gICAgICAgICAgICB0YWJWaWV3LnVwZGF0ZUFuZHJvaWRJdGVtQXQodGhpcy5pbmRleCwgdGhpcy50YWJJdGVtU3BlYyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXdJdGVtLnByb3RvdHlwZS5fZ2V0Q2hpbGRGcmFnbWVudE1hbmFnZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0YWJWaWV3ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciB0YWJGcmFnbWVudCA9IG51bGw7XG4gICAgICAgIHZhciBmcmFnbWVudE1hbmFnZXIgPSB0YWJWaWV3Ll9nZXRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGZyYWdtZW50TWFuYWdlci5nZXRGcmFnbWVudHMoKS50b0FycmF5KCk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSBfYVtfaV07XG4gICAgICAgICAgICBpZiAoZnJhZ21lbnQuaW5kZXggPT09IHRoaXMuaW5kZXgpIHtcbiAgICAgICAgICAgICAgICB0YWJGcmFnbWVudCA9IGZyYWdtZW50O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghdGFiRnJhZ21lbnQpIHtcbiAgICAgICAgICAgIGlmICh0YWJfdmlld19jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJDb3VsZCBub3QgZ2V0IGNoaWxkIGZyYWdtZW50IG1hbmFnZXIgZm9yIHRhYiBpdGVtIHdpdGggaW5kZXggXCIgKyB0aGlzLmluZGV4LCB0YWJfdmlld19jb21tb25fMS50cmFjZUNhdGVnb3J5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0YWJWaWV3Ll9nZXRSb290RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRhYkZyYWdtZW50LmdldENoaWxkRnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEuZm9udFNpemVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgbmF0aXZlU2l6ZTogdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFRleHRTaXplKCkgfTtcbiAgICB9O1xuICAgIFRhYlZpZXdJdGVtLnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5mb250U2l6ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFRleHRTaXplKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUZXh0U2l6ZShhbmRyb2lkLnV0aWwuVHlwZWRWYWx1ZS5DT01QTEVYX1VOSVRfUFgsIHZhbHVlLm5hdGl2ZVNpemUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEuZm9udEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0VHlwZWZhY2UoKTtcbiAgICB9O1xuICAgIFRhYlZpZXdJdGVtLnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUeXBlZmFjZSh2YWx1ZSBpbnN0YW5jZW9mIGZvbnRfMS5Gb250ID8gdmFsdWUuZ2V0QW5kcm9pZFR5cGVmYWNlKCkgOiB2YWx1ZSk7XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGVbdGV4dF9iYXNlXzEudGV4dFRyYW5zZm9ybVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJkZWZhdWx0XCI7XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGVbdGV4dF9iYXNlXzEudGV4dFRyYW5zZm9ybVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHR2ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAodmFsdWUgPT09IFwiZGVmYXVsdFwiKSB7XG4gICAgICAgICAgICB0di5zZXRUcmFuc2Zvcm1hdGlvbk1ldGhvZCh0aGlzLl9kZWZhdWx0VHJhbnNmb3JtYXRpb25NZXRob2QpO1xuICAgICAgICAgICAgdHYuc2V0VGV4dCh0aGlzLnRpdGxlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB0ZXh0X2Jhc2VfMS5nZXRUcmFuc2Zvcm1lZFRleHQodGhpcy50aXRsZSwgdmFsdWUpO1xuICAgICAgICAgICAgdHYuc2V0VGV4dChyZXN1bHQpO1xuICAgICAgICAgICAgdHYuc2V0VHJhbnNmb3JtYXRpb25NZXRob2QobnVsbCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBUYWJWaWV3SXRlbTtcbn0odGFiX3ZpZXdfY29tbW9uXzEuVGFiVmlld0l0ZW1CYXNlKSk7XG5leHBvcnRzLlRhYlZpZXdJdGVtID0gVGFiVmlld0l0ZW07XG5mdW5jdGlvbiBzZXRFbGV2YXRpb24oZ3JpZCwgdGFiTGF5b3V0KSB7XG4gICAgdmFyIGNvbXBhdCA9IGFuZHJvaWR4LmNvcmUudmlldy5WaWV3Q29tcGF0O1xuICAgIGlmIChjb21wYXQuc2V0RWxldmF0aW9uKSB7XG4gICAgICAgIHZhciB2YWwgPSBERUZBVUxUX0VMRVZBVElPTiAqIHRhYl92aWV3X2NvbW1vbl8xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgICAgICBjb21wYXQuc2V0RWxldmF0aW9uKGdyaWQsIHZhbCk7XG4gICAgICAgIGNvbXBhdC5zZXRFbGV2YXRpb24odGFiTGF5b3V0LCB2YWwpO1xuICAgIH1cbn1cbmV4cG9ydHMudGFicyA9IG5ldyBBcnJheSgpO1xuZnVuY3Rpb24gaXRlcmF0ZUluZGV4UmFuZ2UoaW5kZXgsIGVwcywgbGFzdEluZGV4LCBjYWxsYmFjaykge1xuICAgIHZhciByYW5nZVN0YXJ0ID0gTWF0aC5tYXgoMCwgaW5kZXggLSBlcHMpO1xuICAgIHZhciByYW5nZUVuZCA9IE1hdGgubWluKGluZGV4ICsgZXBzLCBsYXN0SW5kZXgpO1xuICAgIGZvciAodmFyIGkgPSByYW5nZVN0YXJ0OyBpIDw9IHJhbmdlRW5kOyBpKyspIHtcbiAgICAgICAgY2FsbGJhY2soaSk7XG4gICAgfVxufVxudmFyIFRhYlZpZXcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJWaWV3LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRhYlZpZXcoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9hbmRyb2lkVmlld0lkID0gLTE7XG4gICAgICAgIGV4cG9ydHMudGFicy5wdXNoKG5ldyBXZWFrUmVmKF90aGlzKSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXcucHJvdG90eXBlLCBcIl9oYXNGcmFnbWVudHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS5vbkl0ZW1zQ2hhbmdlZCA9IGZ1bmN0aW9uIChvbGRJdGVtcywgbmV3SXRlbXMpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkl0ZW1zQ2hhbmdlZC5jYWxsKHRoaXMsIG9sZEl0ZW1zLCBuZXdJdGVtcyk7XG4gICAgICAgIGlmIChvbGRJdGVtcykge1xuICAgICAgICAgICAgb2xkSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSwgYXJyKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5pbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgaXRlbS50YWJJdGVtU3BlYyA9IG51bGw7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXROYXRpdmVWaWV3KG51bGwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGluaXRpYWxpemVOYXRpdmVDbGFzc2VzKCk7XG4gICAgICAgIGlmICh0YWJfdmlld19jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdGFiX3ZpZXdfY29tbW9uXzEudHJhY2VXcml0ZShcIlRhYlZpZXcuX2NyZWF0ZVVJKFwiICsgdGhpcyArIFwiKTtcIiwgdGFiX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yeSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9jb250ZXh0O1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZExheW91dChjb250ZXh0KTtcbiAgICAgICAgdmFyIHZpZXdQYWdlciA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVGFiVmlld1BhZ2VyKGNvbnRleHQpO1xuICAgICAgICB2YXIgdGFiTGF5b3V0ID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5UYWJMYXlvdXQoY29udGV4dCk7XG4gICAgICAgIHZhciBscCA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ29tbW9uTGF5b3V0UGFyYW1zKCk7XG4gICAgICAgIHZhciBwcmltYXJ5Q29sb3IgPSB1dGlsc18xLmFkLnJlc291cmNlcy5nZXRQYWxldHRlQ29sb3IoUFJJTUFSWV9DT0xPUiwgY29udGV4dCk7XG4gICAgICAgIHZhciBhY2NlbnRDb2xvciA9IGdldERlZmF1bHRBY2NlbnRDb2xvcihjb250ZXh0KTtcbiAgICAgICAgbHAucm93ID0gMTtcbiAgICAgICAgaWYgKHRoaXMuYW5kcm9pZFRhYnNQb3NpdGlvbiA9PT0gXCJ0b3BcIikge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRSb3cobmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5JdGVtU3BlYygxLCBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZFVuaXRUeXBlLmF1dG8pKTtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkUm93KG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuSXRlbVNwZWMoMSwgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRVbml0VHlwZS5zdGFyKSk7XG4gICAgICAgICAgICB2aWV3UGFnZXIuc2V0TGF5b3V0UGFyYW1zKGxwKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5hbmRyb2lkU3dpcGVFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgdmlld1BhZ2VyLnNldFN3aXBlUGFnZUVuYWJsZWQoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRSb3cobmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5JdGVtU3BlYygxLCBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZFVuaXRUeXBlLnN0YXIpKTtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkUm93KG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuSXRlbVNwZWMoMSwgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRVbml0VHlwZS5hdXRvKSk7XG4gICAgICAgICAgICB0YWJMYXlvdXQuc2V0TGF5b3V0UGFyYW1zKGxwKTtcbiAgICAgICAgICAgIHZpZXdQYWdlci5zZXRTd2lwZVBhZ2VFbmFibGVkKGZhbHNlKTtcbiAgICAgICAgICAgIGFjY2VudENvbG9yID0gMHgwMEZGRkZGRjtcbiAgICAgICAgfVxuICAgICAgICBuYXRpdmVWaWV3LmFkZFZpZXcodmlld1BhZ2VyKTtcbiAgICAgICAgbmF0aXZlVmlldy52aWV3UGFnZXIgPSB2aWV3UGFnZXI7XG4gICAgICAgIHZhciBhZGFwdGVyID0gbmV3IFBhZ2VyQWRhcHRlcih0aGlzKTtcbiAgICAgICAgdmlld1BhZ2VyLnNldEFkYXB0ZXIoYWRhcHRlcik7XG4gICAgICAgIHZpZXdQYWdlci5hZGFwdGVyID0gYWRhcHRlcjtcbiAgICAgICAgbmF0aXZlVmlldy5hZGRWaWV3KHRhYkxheW91dCk7XG4gICAgICAgIG5hdGl2ZVZpZXcudGFiTGF5b3V0ID0gdGFiTGF5b3V0O1xuICAgICAgICBzZXRFbGV2YXRpb24obmF0aXZlVmlldywgdGFiTGF5b3V0KTtcbiAgICAgICAgaWYgKGFjY2VudENvbG9yKSB7XG4gICAgICAgICAgICB0YWJMYXlvdXQuc2V0U2VsZWN0ZWRJbmRpY2F0b3JDb2xvcnMoW2FjY2VudENvbG9yXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByaW1hcnlDb2xvcikge1xuICAgICAgICAgICAgdGFiTGF5b3V0LnNldEJhY2tncm91bmRDb2xvcihwcmltYXJ5Q29sb3IpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuYXRpdmVWaWV3O1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMuX2FuZHJvaWRWaWV3SWQgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLl9hbmRyb2lkVmlld0lkID0gYW5kcm9pZC52aWV3LlZpZXcuZ2VuZXJhdGVWaWV3SWQoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdGhpcy5fdGFiTGF5b3V0ID0gbmF0aXZlVmlldy50YWJMYXlvdXQ7XG4gICAgICAgIHZhciB2aWV3UGFnZXIgPSBuYXRpdmVWaWV3LnZpZXdQYWdlcjtcbiAgICAgICAgdmlld1BhZ2VyLnNldElkKHRoaXMuX2FuZHJvaWRWaWV3SWQpO1xuICAgICAgICB0aGlzLl92aWV3UGFnZXIgPSB2aWV3UGFnZXI7XG4gICAgICAgIHRoaXMuX3BhZ2VyQWRhcHRlciA9IHZpZXdQYWdlci5hZGFwdGVyO1xuICAgICAgICB0aGlzLl9wYWdlckFkYXB0ZXIub3duZXIgPSB0aGlzO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGUuX2xvYWRVbmxvYWRUYWJJdGVtcyA9IGZ1bmN0aW9uIChuZXdJbmRleCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICB2YXIgbGFzdEluZGV4ID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxO1xuICAgICAgICB2YXIgb2Zmc2lkZUl0ZW1zID0gdGhpcy5hbmRyb2lkVGFic1Bvc2l0aW9uID09PSBcInRvcFwiID8gdGhpcy5hbmRyb2lkT2Zmc2NyZWVuVGFiTGltaXQgOiAxO1xuICAgICAgICB2YXIgdG9VbmxvYWQgPSBbXTtcbiAgICAgICAgdmFyIHRvTG9hZCA9IFtdO1xuICAgICAgICBpdGVyYXRlSW5kZXhSYW5nZShuZXdJbmRleCwgb2Zmc2lkZUl0ZW1zLCBsYXN0SW5kZXgsIGZ1bmN0aW9uIChpKSB7IHJldHVybiB0b0xvYWQucHVzaChpKTsgfSk7XG4gICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGkpIHtcbiAgICAgICAgICAgIHZhciBpbmRleE9mSSA9IHRvTG9hZC5pbmRleE9mKGkpO1xuICAgICAgICAgICAgaWYgKGluZGV4T2ZJIDwgMCkge1xuICAgICAgICAgICAgICAgIHRvVW5sb2FkLnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0b1VubG9hZC5mb3JFYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc1tpbmRleF07XG4gICAgICAgICAgICBpZiAoaXRlbXNbaW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgaXRlbS51bmxvYWRWaWV3KGl0ZW0udmlldyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgbmV3SXRlbSA9IGl0ZW1zW25ld0luZGV4XTtcbiAgICAgICAgdmFyIHNlbGVjdGVkVmlldyA9IG5ld0l0ZW0gJiYgbmV3SXRlbS52aWV3O1xuICAgICAgICBpZiAoc2VsZWN0ZWRWaWV3IGluc3RhbmNlb2YgZnJhbWVfMS5GcmFtZSkge1xuICAgICAgICAgICAgc2VsZWN0ZWRWaWV3Ll9wdXNoSW5GcmFtZVN0YWNrUmVjdXJzaXZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdG9Mb2FkLmZvckVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGl0ZW1zW2luZGV4XTtcbiAgICAgICAgICAgIGlmIChfdGhpcy5pc0xvYWRlZCAmJiBpdGVtc1tpbmRleF0pIHtcbiAgICAgICAgICAgICAgICBpdGVtLmxvYWRWaWV3KGl0ZW0udmlldyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5zZXRBZGFwdGVySXRlbXModGhpcy5pdGVtcyk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS5vblVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uVW5sb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5zZXRBZGFwdGVySXRlbXMobnVsbCk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fdGFiTGF5b3V0LnNldEl0ZW1zKG51bGwsIG51bGwpO1xuICAgICAgICB0aGlzLl9wYWdlckFkYXB0ZXIub3duZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9wYWdlckFkYXB0ZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl90YWJMYXlvdXQgPSBudWxsO1xuICAgICAgICB0aGlzLl92aWV3UGFnZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS5fb25Sb290Vmlld1Jlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9vblJvb3RWaWV3UmVzZXQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudEZyYWdtZW50cygpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGUuZGlzcG9zZUN1cnJlbnRGcmFnbWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBmcmFnbWVudE1hbmFnZXIgPSB0aGlzLl9nZXRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gZnJhZ21lbnRNYW5hZ2VyLmJlZ2luVHJhbnNhY3Rpb24oKTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGZyYWdtZW50TWFuYWdlci5nZXRGcmFnbWVudHMoKS50b0FycmF5KCk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSBfYVtfaV07XG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5yZW1vdmUoZnJhZ21lbnQpO1xuICAgICAgICB9XG4gICAgICAgIHRyYW5zYWN0aW9uLmNvbW1pdE5vd0FsbG93aW5nU3RhdGVMb3NzKCk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS5zaG91bGRVcGRhdGVBZGFwdGVyID0gZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgIGlmICghdGhpcy5fcGFnZXJBZGFwdGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGN1cnJlbnRQYWdlckFkYXB0ZXJJdGVtcyA9IHRoaXMuX3BhZ2VyQWRhcHRlci5pdGVtcztcbiAgICAgICAgaWYgKCFpdGVtcyAmJiAhY3VycmVudFBhZ2VyQWRhcHRlckl0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpdGVtcyB8fCAhY3VycmVudFBhZ2VyQWRhcHRlckl0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXRlbXMubGVuZ3RoICE9PSBjdXJyZW50UGFnZXJBZGFwdGVySXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWF0Y2hpbmdJdGVtcyA9IGN1cnJlbnRQYWdlckFkYXB0ZXJJdGVtcy5maWx0ZXIoZnVuY3Rpb24gKGN1cnJlbnRJdGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gISFpdGVtcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5fZG9tSWQgPT09IGN1cnJlbnRJdGVtLl9kb21JZDtcbiAgICAgICAgICAgIH0pWzBdO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKG1hdGNoaW5nSXRlbXMubGVuZ3RoICE9PSBpdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlLnNldEFkYXB0ZXJJdGVtcyA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICBpZiAodGhpcy5zaG91bGRVcGRhdGVBZGFwdGVyKGl0ZW1zKSkge1xuICAgICAgICAgICAgdGhpcy5fcGFnZXJBZGFwdGVyLml0ZW1zID0gaXRlbXM7XG4gICAgICAgICAgICB2YXIgbGVuZ3RoXzEgPSBpdGVtcyA/IGl0ZW1zLmxlbmd0aCA6IDA7XG4gICAgICAgICAgICBpZiAobGVuZ3RoXzEgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90YWJMYXlvdXQuc2V0SXRlbXMobnVsbCwgbnVsbCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGFnZXJBZGFwdGVyLm5vdGlmeURhdGFTZXRDaGFuZ2VkKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRhYkl0ZW1zXzEgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGksIGFycikge1xuICAgICAgICAgICAgICAgIHZhciB0YWJJdGVtU3BlYyA9IGNyZWF0ZVRhYkl0ZW1TcGVjKGl0ZW0pO1xuICAgICAgICAgICAgICAgIGl0ZW0uaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgIGl0ZW0udGFiSXRlbVNwZWMgPSB0YWJJdGVtU3BlYztcbiAgICAgICAgICAgICAgICB0YWJJdGVtc18xLnB1c2godGFiSXRlbVNwZWMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgdGFiTGF5b3V0XzEgPSB0aGlzLl90YWJMYXlvdXQ7XG4gICAgICAgICAgICB0YWJMYXlvdXRfMS5zZXRJdGVtcyh0YWJJdGVtc18xLCB0aGlzLl92aWV3UGFnZXIpO1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSwgYXJyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHR2ID0gdGFiTGF5b3V0XzEuZ2V0VGV4dFZpZXdGb3JJdGVtQXQoaSk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXROYXRpdmVWaWV3KHR2KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fcGFnZXJBZGFwdGVyLm5vdGlmeURhdGFTZXRDaGFuZ2VkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlLnVwZGF0ZUFuZHJvaWRJdGVtQXQgPSBmdW5jdGlvbiAoaW5kZXgsIHNwZWMpIHtcbiAgICAgICAgdGhpcy5fdGFiTGF5b3V0LnVwZGF0ZUl0ZW1BdChpbmRleCwgc3BlYyk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5hbmRyb2lkT2Zmc2NyZWVuVGFiTGltaXRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZpZXdQYWdlci5nZXRPZmZzY3JlZW5QYWdlTGltaXQoKTtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLmFuZHJvaWRPZmZzY3JlZW5UYWJMaW1pdFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdmlld1BhZ2VyLnNldE9mZnNjcmVlblBhZ2VMaW1pdCh2YWx1ZSk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgc21vb3RoU2Nyb2xsID0gdGhpcy5hbmRyb2lkVGFic1Bvc2l0aW9uID09PSBcInRvcFwiO1xuICAgICAgICBpZiAodGFiX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJUYWJWaWV3IHRoaXMuX3ZpZXdQYWdlci5zZXRDdXJyZW50SXRlbShcIiArIHZhbHVlICsgXCIsIFwiICsgc21vb3RoU2Nyb2xsICsgXCIpO1wiLCB0YWJfdmlld19jb21tb25fMS50cmFjZUNhdGVnb3J5KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl92aWV3UGFnZXIuc2V0Q3VycmVudEl0ZW0odmFsdWUsIHNtb290aFNjcm9sbCk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5pdGVtc1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLml0ZW1zUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnNldEFkYXB0ZXJJdGVtcyh2YWx1ZSk7XG4gICAgICAgIHRhYl92aWV3X2NvbW1vbl8xLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5jb2VyY2UodGhpcyk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS50YWJCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RhYkxheW91dC5nZXRCYWNrZ3JvdW5kKCk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS50YWJCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHRhYl92aWV3X2NvbW1vbl8xLkNvbG9yKSB7XG4gICAgICAgICAgICB0aGlzLl90YWJMYXlvdXQuc2V0QmFja2dyb3VuZENvbG9yKHZhbHVlLmFuZHJvaWQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdGFiTGF5b3V0LnNldEJhY2tncm91bmQodHJ5Q2xvbmVEcmF3YWJsZSh2YWx1ZSwgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFJlc291cmNlcykpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS50YWJUZXh0Rm9udFNpemVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RhYkxheW91dC5nZXRUYWJUZXh0Rm9udFNpemUoKTtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLnRhYlRleHRGb250U2l6ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgdGhpcy5fdGFiTGF5b3V0LnNldFRhYlRleHRGb250U2l6ZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl90YWJMYXlvdXQuc2V0VGFiVGV4dEZvbnRTaXplKHZhbHVlLm5hdGl2ZVNpemUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS50YWJUZXh0Q29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RhYkxheW91dC5nZXRUYWJUZXh0Q29sb3IoKTtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLnRhYlRleHRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiB0YWJfdmlld19jb21tb25fMS5Db2xvciA/IHZhbHVlLmFuZHJvaWQgOiB2YWx1ZTtcbiAgICAgICAgdGhpcy5fdGFiTGF5b3V0LnNldFRhYlRleHRDb2xvcihjb2xvcik7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5zZWxlY3RlZFRhYlRleHRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGFiTGF5b3V0LmdldFNlbGVjdGVkVGFiVGV4dENvbG9yKCk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5zZWxlY3RlZFRhYlRleHRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiB0YWJfdmlld19jb21tb25fMS5Db2xvciA/IHZhbHVlLmFuZHJvaWQgOiB2YWx1ZTtcbiAgICAgICAgdGhpcy5fdGFiTGF5b3V0LnNldFNlbGVjdGVkVGFiVGV4dENvbG9yKGNvbG9yKTtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLmFuZHJvaWRTZWxlY3RlZFRhYkhpZ2hsaWdodENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBnZXREZWZhdWx0QWNjZW50Q29sb3IodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5hbmRyb2lkU2VsZWN0ZWRUYWJIaWdobGlnaHRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHRhYkxheW91dCA9IHRoaXMuX3RhYkxheW91dDtcbiAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiB0YWJfdmlld19jb21tb25fMS5Db2xvciA/IHZhbHVlLmFuZHJvaWQgOiB2YWx1ZTtcbiAgICAgICAgdGFiTGF5b3V0LnNldFNlbGVjdGVkSW5kaWNhdG9yQ29sb3JzKFtjb2xvcl0pO1xuICAgIH07XG4gICAgcmV0dXJuIFRhYlZpZXc7XG59KHRhYl92aWV3X2NvbW1vbl8xLlRhYlZpZXdCYXNlKSk7XG5leHBvcnRzLlRhYlZpZXcgPSBUYWJWaWV3O1xuZnVuY3Rpb24gdHJ5Q2xvbmVEcmF3YWJsZSh2YWx1ZSwgcmVzb3VyY2VzKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb25zdGFudFN0YXRlID0gdmFsdWUuZ2V0Q29uc3RhbnRTdGF0ZSgpO1xuICAgICAgICBpZiAoY29uc3RhbnRTdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50U3RhdGUubmV3RHJhd2FibGUocmVzb3VyY2VzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YWItdmlldy5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdGFiX25hdmlnYXRpb25fYmFzZV8xID0gcmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLW5hdmlnYXRpb24tYmFzZVwiKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIHByb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3Byb3BlcnRpZXNcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGFiLW5hdmlnYXRpb24tYmFzZS90YWItY29udGVudC1pdGVtXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1uYXZpZ2F0aW9uLWJhc2VcIikpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcC1pdGVtXCIpKTtcbmV4cG9ydHMudHJhY2VDYXRlZ29yeSA9IFwiVGFiVmlld1wiO1xudmFyIGtub3duQ29sbGVjdGlvbnM7XG4oZnVuY3Rpb24gKGtub3duQ29sbGVjdGlvbnMpIHtcbiAgICBrbm93bkNvbGxlY3Rpb25zLml0ZW1zID0gXCJpdGVtc1wiO1xufSkoa25vd25Db2xsZWN0aW9ucyA9IGV4cG9ydHMua25vd25Db2xsZWN0aW9ucyB8fCAoZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zID0ge30pKTtcbnZhciBUYWJzQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRhYnNCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRhYnNCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRhYnNCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiVGFic1wiKVxuICAgIF0sIFRhYnNCYXNlKTtcbiAgICByZXR1cm4gVGFic0Jhc2U7XG59KHRhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5UYWJOYXZpZ2F0aW9uQmFzZSkpO1xuZXhwb3J0cy5UYWJzQmFzZSA9IFRhYnNCYXNlO1xuZXhwb3J0cy5zd2lwZUVuYWJsZWRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwic3dpcGVFbmFibGVkXCIsIGRlZmF1bHRWYWx1ZTogdHJ1ZSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfMS5ib29sZWFuQ29udmVydGVyXG59KTtcbmV4cG9ydHMuc3dpcGVFbmFibGVkUHJvcGVydHkucmVnaXN0ZXIoVGFic0Jhc2UpO1xuZXhwb3J0cy5vZmZzY3JlZW5UYWJMaW1pdFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJvZmZzY3JlZW5UYWJMaW1pdFwiLCBkZWZhdWx0VmFsdWU6IDEsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5vZmZzY3JlZW5UYWJMaW1pdFByb3BlcnR5LnJlZ2lzdGVyKFRhYnNCYXNlKTtcbmV4cG9ydHMudGFic1Bvc2l0aW9uUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLlByb3BlcnR5KHsgbmFtZTogXCJ0YWJzUG9zaXRpb25cIiwgZGVmYXVsdFZhbHVlOiBcInRvcFwiIH0pO1xuZXhwb3J0cy50YWJzUG9zaXRpb25Qcm9wZXJ0eS5yZWdpc3RlcihUYWJzQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YWJzLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRhYl9zdHJpcF8xID0gcmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwXCIpO1xudmFyIHRhYl9zdHJpcF9pdGVtXzEgPSByZXF1aXJlKFwiLi4vdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXAtaXRlbVwiKTtcbnZhciBhcHBsaWNhdGlvbiA9IHJlcXVpcmUoXCIuLi8uLi9hcHBsaWNhdGlvblwiKTtcbnZhciBpbWFnZV9zb3VyY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi9pbWFnZS1zb3VyY2VcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIGZyYW1lXzEgPSByZXF1aXJlKFwiLi4vZnJhbWVcIik7XG52YXIgdGFiX25hdmlnYXRpb25fYmFzZV8xID0gcmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLW5hdmlnYXRpb24tYmFzZVwiKTtcbnZhciB0ZXh0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIik7XG52YXIgdGFic19jb21tb25fMSA9IHJlcXVpcmUoXCIuL3RhYnMtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vdGFicy1jb21tb25cIikpO1xudmFyIEFDQ0VOVF9DT0xPUiA9IFwiY29sb3JBY2NlbnRcIjtcbnZhciBQUklNQVJZX0NPTE9SID0gXCJjb2xvclByaW1hcnlcIjtcbnZhciBERUZBVUxUX0VMRVZBVElPTiA9IDQ7XG52YXIgVEFCSUQgPSBcIl90YWJJZFwiO1xudmFyIElOREVYID0gXCJfaW5kZXhcIjtcbnZhciBQYWdlckFkYXB0ZXI7XG52YXIgVGFic0JhcjtcbmZ1bmN0aW9uIG1ha2VGcmFnbWVudE5hbWUodmlld0lkLCBpZCkge1xuICAgIHJldHVybiBcImFuZHJvaWQ6dmlld3BhZ2VyOlwiICsgdmlld0lkICsgXCI6XCIgKyBpZDtcbn1cbmZ1bmN0aW9uIGdldFRhYkJ5SWQoaWQpIHtcbiAgICB2YXIgcmVmID0gZXhwb3J0cy50YWJzLmZpbmQoZnVuY3Rpb24gKHJlZikge1xuICAgICAgICB2YXIgdGFiID0gcmVmLmdldCgpO1xuICAgICAgICByZXR1cm4gdGFiICYmIHRhYi5fZG9tSWQgPT09IGlkO1xuICAgIH0pO1xuICAgIHJldHVybiByZWYgJiYgcmVmLmdldCgpO1xufVxuZnVuY3Rpb24gaW5pdGlhbGl6ZU5hdGl2ZUNsYXNzZXMoKSB7XG4gICAgaWYgKFBhZ2VyQWRhcHRlcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24sIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbi5uZXdJbnN0YW5jZSA9IGZ1bmN0aW9uICh0YWJJZCwgaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gbmV3IGFuZHJvaWQub3MuQnVuZGxlKCk7XG4gICAgICAgICAgICBhcmdzLnB1dEludChUQUJJRCwgdGFiSWQpO1xuICAgICAgICAgICAgYXJncy5wdXRJbnQoSU5ERVgsIGluZGV4KTtcbiAgICAgICAgICAgIHZhciBmcmFnbWVudCA9IG5ldyBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uKCk7XG4gICAgICAgICAgICBmcmFnbWVudC5zZXRBcmd1bWVudHMoYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gZnJhZ21lbnQ7XG4gICAgICAgIH07XG4gICAgICAgIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uQ3JlYXRlID0gZnVuY3Rpb24gKHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkNyZWF0ZS5jYWxsKHRoaXMsIHNhdmVkSW5zdGFuY2VTdGF0ZSk7XG4gICAgICAgICAgICB2YXIgYXJncyA9IHRoaXMuZ2V0QXJndW1lbnRzKCk7XG4gICAgICAgICAgICB0aGlzLnRhYiA9IGdldFRhYkJ5SWQoYXJncy5nZXRJbnQoVEFCSUQpKTtcbiAgICAgICAgICAgIHRoaXMuaW5kZXggPSBhcmdzLmdldEludChJTkRFWCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMudGFiKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgVGFiVmlld1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25DcmVhdGVWaWV3ID0gZnVuY3Rpb24gKGluZmxhdGVyLCBjb250YWluZXIsIHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICAgICAgdmFyIHRhYkl0ZW0gPSB0aGlzLnRhYi5pdGVtc1t0aGlzLmluZGV4XTtcbiAgICAgICAgICAgIHJldHVybiB0YWJJdGVtLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uO1xuICAgIH0ob3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkZyYWdtZW50QmFzZSkpO1xuICAgIHZhciBQT1NJVElPTl9VTkNIQU5HRUQgPSAtMTtcbiAgICB2YXIgUE9TSVRJT05fTk9ORSA9IC0yO1xuICAgIHZhciBGcmFnbWVudFBhZ2VyQWRhcHRlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhGcmFnbWVudFBhZ2VyQWRhcHRlciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gRnJhZ21lbnRQYWdlckFkYXB0ZXIob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLmdldENvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgICAgIHJldHVybiBpdGVtcyA/IGl0ZW1zLmxlbmd0aCA6IDA7XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5nZXRQYWdlVGl0bGUgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IGl0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5zdGFydFVwZGF0ZSA9IGZ1bmN0aW9uIChjb250YWluZXIpIHtcbiAgICAgICAgICAgIGlmIChjb250YWluZXIuZ2V0SWQoKSA9PT0gYW5kcm9pZC52aWV3LlZpZXcuTk9fSUQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWaWV3UGFnZXIgd2l0aCBhZGFwdGVyIFwiICsgdGhpcyArIFwiIHJlcXVpcmVzIGEgdmlldyBjb250YWluZXJJZFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLmluc3RhbnRpYXRlSXRlbSA9IGZ1bmN0aW9uIChjb250YWluZXIsIHBvc2l0aW9uKSB7XG4gICAgICAgICAgICB2YXIgZnJhZ21lbnRNYW5hZ2VyID0gdGhpcy5vd25lci5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMubUN1clRyYW5zYWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tQ3VyVHJhbnNhY3Rpb24gPSBmcmFnbWVudE1hbmFnZXIuYmVnaW5UcmFuc2FjdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGl0ZW1JZCA9IHRoaXMuZ2V0SXRlbUlkKHBvc2l0aW9uKTtcbiAgICAgICAgICAgIHZhciBuYW1lID0gbWFrZUZyYWdtZW50TmFtZShjb250YWluZXIuZ2V0SWQoKSwgaXRlbUlkKTtcbiAgICAgICAgICAgIHZhciBmcmFnbWVudCA9IGZyYWdtZW50TWFuYWdlci5maW5kRnJhZ21lbnRCeVRhZyhuYW1lKTtcbiAgICAgICAgICAgIGlmIChmcmFnbWVudCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tQ3VyVHJhbnNhY3Rpb24uYXR0YWNoKGZyYWdtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZyYWdtZW50ID0gVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbi5uZXdJbnN0YW5jZSh0aGlzLm93bmVyLl9kb21JZCwgcG9zaXRpb24pO1xuICAgICAgICAgICAgICAgIHRoaXMubUN1clRyYW5zYWN0aW9uLmFkZChjb250YWluZXIuZ2V0SWQoKSwgZnJhZ21lbnQsIG5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZyYWdtZW50ICE9PSB0aGlzLm1DdXJyZW50UHJpbWFyeUl0ZW0pIHtcbiAgICAgICAgICAgICAgICBmcmFnbWVudC5zZXRNZW51VmlzaWJpbGl0eShmYWxzZSk7XG4gICAgICAgICAgICAgICAgZnJhZ21lbnQuc2V0VXNlclZpc2libGVIaW50KGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0YWJJdGVtcyA9IHRoaXMub3duZXIuaXRlbXM7XG4gICAgICAgICAgICB2YXIgdGFiSXRlbSA9IHRhYkl0ZW1zID8gdGFiSXRlbXNbcG9zaXRpb25dIDogbnVsbDtcbiAgICAgICAgICAgIGlmICh0YWJJdGVtKSB7XG4gICAgICAgICAgICAgICAgdGFiSXRlbS5jYW5CZUxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZnJhZ21lbnQ7XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5nZXRJdGVtUG9zaXRpb24gPSBmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVtcyA/IFBPU0lUSU9OX1VOQ0hBTkdFRCA6IFBPU0lUSU9OX05PTkU7XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5kZXN0cm95SXRlbSA9IGZ1bmN0aW9uIChjb250YWluZXIsIHBvc2l0aW9uLCBvYmplY3QpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5tQ3VyVHJhbnNhY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJhZ21lbnRNYW5hZ2VyID0gdGhpcy5vd25lci5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tQ3VyVHJhbnNhY3Rpb24gPSBmcmFnbWVudE1hbmFnZXIuYmVnaW5UcmFuc2FjdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZyYWdtZW50ID0gb2JqZWN0O1xuICAgICAgICAgICAgdGhpcy5tQ3VyVHJhbnNhY3Rpb24uZGV0YWNoKGZyYWdtZW50KTtcbiAgICAgICAgICAgIGlmICh0aGlzLm1DdXJyZW50UHJpbWFyeUl0ZW0gPT09IGZyYWdtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tQ3VycmVudFByaW1hcnlJdGVtID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0YWJJdGVtcyA9IHRoaXMub3duZXIuaXRlbXM7XG4gICAgICAgICAgICB2YXIgdGFiSXRlbSA9IHRhYkl0ZW1zID8gdGFiSXRlbXNbcG9zaXRpb25dIDogbnVsbDtcbiAgICAgICAgICAgIGlmICh0YWJJdGVtKSB7XG4gICAgICAgICAgICAgICAgdGFiSXRlbS5jYW5CZUxvYWRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuc2V0UHJpbWFyeUl0ZW0gPSBmdW5jdGlvbiAoY29udGFpbmVyLCBwb3NpdGlvbiwgb2JqZWN0KSB7XG4gICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSBvYmplY3Q7XG4gICAgICAgICAgICBpZiAoZnJhZ21lbnQgIT09IHRoaXMubUN1cnJlbnRQcmltYXJ5SXRlbSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1DdXJyZW50UHJpbWFyeUl0ZW0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1DdXJyZW50UHJpbWFyeUl0ZW0uc2V0TWVudVZpc2liaWxpdHkoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1DdXJyZW50UHJpbWFyeUl0ZW0uc2V0VXNlclZpc2libGVIaW50KGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGZyYWdtZW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgZnJhZ21lbnQuc2V0TWVudVZpc2liaWxpdHkodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGZyYWdtZW50LnNldFVzZXJWaXNpYmxlSGludCh0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5tQ3VycmVudFByaW1hcnlJdGVtID0gZnJhZ21lbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5vd25lci5zZWxlY3RlZEluZGV4ID0gcG9zaXRpb247XG4gICAgICAgICAgICAgICAgdmFyIHRhYiA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICAgICAgdmFyIHRhYkl0ZW1zID0gdGFiLml0ZW1zO1xuICAgICAgICAgICAgICAgIHZhciBuZXdUYWJJdGVtID0gdGFiSXRlbXMgPyB0YWJJdGVtc1twb3NpdGlvbl0gOiBudWxsO1xuICAgICAgICAgICAgICAgIGlmIChuZXdUYWJJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYi5fbG9hZFVubG9hZFRhYkl0ZW1zKHRhYi5zZWxlY3RlZEluZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5maW5pc2hVcGRhdGUgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9jb21taXRDdXJyZW50VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLmlzVmlld0Zyb21PYmplY3QgPSBmdW5jdGlvbiAodmlldywgb2JqZWN0KSB7XG4gICAgICAgICAgICByZXR1cm4gb2JqZWN0LmdldFZpZXcoKSA9PT0gdmlldztcbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLnNhdmVTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbW1pdEN1cnJlbnRUcmFuc2FjdGlvbigpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5yZXN0b3JlU3RhdGUgPSBmdW5jdGlvbiAoc3RhdGUsIGxvYWRlcikge1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuZ2V0SXRlbUlkID0gZnVuY3Rpb24gKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gcG9zaXRpb247XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5fY29tbWl0Q3VycmVudFRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMubUN1clRyYW5zYWN0aW9uICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1DdXJUcmFuc2FjdGlvbi5jb21taXROb3dBbGxvd2luZ1N0YXRlTG9zcygpO1xuICAgICAgICAgICAgICAgIHRoaXMubUN1clRyYW5zYWN0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEZyYWdtZW50UGFnZXJBZGFwdGVyO1xuICAgIH0oYW5kcm9pZHgudmlld3BhZ2VyLndpZGdldC5QYWdlckFkYXB0ZXIpKTtcbiAgICB2YXIgVGFic0JhckltcGxlbWVudGF0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFRhYnNCYXJJbXBsZW1lbnRhdGlvbiwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gVGFic0JhckltcGxlbWVudGF0aW9uKGNvbnRleHQsIG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBjb250ZXh0KSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFRhYnNCYXJJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25TZWxlY3RlZFBvc2l0aW9uQ2hhbmdlID0gZnVuY3Rpb24gKHBvc2l0aW9uLCBwcmV2UG9zaXRpb24pIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAoIW93bmVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRhYlN0cmlwSXRlbXMgPSBvd25lci50YWJTdHJpcCAmJiBvd25lci50YWJTdHJpcC5pdGVtcztcbiAgICAgICAgICAgIGlmIChwb3NpdGlvbiA+PSAwICYmIHRhYlN0cmlwSXRlbXMgJiYgdGFiU3RyaXBJdGVtc1twb3NpdGlvbl0pIHtcbiAgICAgICAgICAgICAgICB0YWJTdHJpcEl0ZW1zW3Bvc2l0aW9uXS5fZW1pdCh0YWJfc3RyaXBfaXRlbV8xLlRhYlN0cmlwSXRlbS5zZWxlY3RFdmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocHJldlBvc2l0aW9uID49IDAgJiYgdGFiU3RyaXBJdGVtcyAmJiB0YWJTdHJpcEl0ZW1zW3ByZXZQb3NpdGlvbl0pIHtcbiAgICAgICAgICAgICAgICB0YWJTdHJpcEl0ZW1zW3ByZXZQb3NpdGlvbl0uX2VtaXQodGFiX3N0cmlwX2l0ZW1fMS5UYWJTdHJpcEl0ZW0udW5zZWxlY3RFdmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFRhYnNCYXJJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25UYXAgPSBmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAoIW93bmVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRhYlN0cmlwID0gb3duZXIudGFiU3RyaXA7XG4gICAgICAgICAgICB2YXIgdGFiU3RyaXBJdGVtcyA9IHRhYlN0cmlwICYmIHRhYlN0cmlwLml0ZW1zO1xuICAgICAgICAgICAgaWYgKHBvc2l0aW9uID49IDAgJiYgdGFiU3RyaXBJdGVtc1twb3NpdGlvbl0pIHtcbiAgICAgICAgICAgICAgICB0YWJTdHJpcEl0ZW1zW3Bvc2l0aW9uXS5fZW1pdCh0YWJfc3RyaXBfaXRlbV8xLlRhYlN0cmlwSXRlbS50YXBFdmVudCk7XG4gICAgICAgICAgICAgICAgdGFiU3RyaXAubm90aWZ5KHsgZXZlbnROYW1lOiB0YWJfc3RyaXBfMS5UYWJTdHJpcC5pdGVtVGFwRXZlbnQsIG9iamVjdDogdGFiU3RyaXAsIGluZGV4OiBwb3NpdGlvbiB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghb3duZXIuaXRlbXNbcG9zaXRpb25dKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBUYWJzQmFySW1wbGVtZW50YXRpb247XG4gICAgfShvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVGFic0JhcikpO1xuICAgIFBhZ2VyQWRhcHRlciA9IEZyYWdtZW50UGFnZXJBZGFwdGVyO1xuICAgIFRhYnNCYXIgPSBUYWJzQmFySW1wbGVtZW50YXRpb247XG59XG52YXIgZGVmYXVsdEFjY2VudENvbG9yID0gdW5kZWZpbmVkO1xuZnVuY3Rpb24gZ2V0RGVmYXVsdEFjY2VudENvbG9yKGNvbnRleHQpIHtcbiAgICBpZiAoZGVmYXVsdEFjY2VudENvbG9yID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZGVmYXVsdEFjY2VudENvbG9yID0gdXRpbHNfMS5hZC5yZXNvdXJjZXMuZ2V0UGFsZXR0ZUNvbG9yKEFDQ0VOVF9DT0xPUiwgY29udGV4dCkgfHwgMHhGRjMzQjVFNTtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmF1bHRBY2NlbnRDb2xvcjtcbn1cbmZ1bmN0aW9uIHNldEVsZXZhdGlvbihncmlkLCB0YWJzQmFyLCB0YWJzUG9zaXRpb24pIHtcbiAgICB2YXIgY29tcGF0ID0gYW5kcm9pZHguY29yZS52aWV3LlZpZXdDb21wYXQ7XG4gICAgaWYgKGNvbXBhdC5zZXRFbGV2YXRpb24pIHtcbiAgICAgICAgdmFyIHZhbCA9IERFRkFVTFRfRUxFVkFUSU9OICogdXRpbHNfMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICAgICAgaWYgKHRhYnNQb3NpdGlvbiA9PT0gXCJ0b3BcIikge1xuICAgICAgICAgICAgY29tcGF0LnNldEVsZXZhdGlvbihncmlkLCB2YWwpO1xuICAgICAgICB9XG4gICAgICAgIGNvbXBhdC5zZXRFbGV2YXRpb24odGFic0JhciwgdmFsKTtcbiAgICB9XG59XG5leHBvcnRzLnRhYnMgPSBuZXcgQXJyYXkoKTtcbmZ1bmN0aW9uIGl0ZXJhdGVJbmRleFJhbmdlKGluZGV4LCBlcHMsIGxhc3RJbmRleCwgY2FsbGJhY2spIHtcbiAgICB2YXIgcmFuZ2VTdGFydCA9IE1hdGgubWF4KDAsIGluZGV4IC0gZXBzKTtcbiAgICB2YXIgcmFuZ2VFbmQgPSBNYXRoLm1pbihpbmRleCArIGVwcywgbGFzdEluZGV4KTtcbiAgICBmb3IgKHZhciBpID0gcmFuZ2VTdGFydDsgaSA8PSByYW5nZUVuZDsgaSsrKSB7XG4gICAgICAgIGNhbGxiYWNrKGkpO1xuICAgIH1cbn1cbnZhciBUYWJzID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGFicywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJzKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fYW5kcm9pZFZpZXdJZCA9IC0xO1xuICAgICAgICBleHBvcnRzLnRhYnMucHVzaChuZXcgV2Vha1JlZihfdGhpcykpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJzLnByb3RvdHlwZSwgXCJfaGFzRnJhZ21lbnRzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGFicy5wcm90b3R5cGUub25JdGVtc0NoYW5nZWQgPSBmdW5jdGlvbiAob2xkSXRlbXMsIG5ld0l0ZW1zKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25JdGVtc0NoYW5nZWQuY2FsbCh0aGlzLCBvbGRJdGVtcywgbmV3SXRlbXMpO1xuICAgICAgICBpZiAob2xkSXRlbXMpIHtcbiAgICAgICAgICAgIG9sZEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGksIGFycikge1xuICAgICAgICAgICAgICAgIGl0ZW0uaW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIGl0ZW0udGFiSXRlbVNwZWMgPSBudWxsO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0TmF0aXZlVmlldyhudWxsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpbml0aWFsaXplTmF0aXZlQ2xhc3NlcygpO1xuICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuX2NvbnRleHQ7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkTGF5b3V0KGNvbnRleHQpO1xuICAgICAgICB2YXIgdmlld1BhZ2VyID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5UYWJWaWV3UGFnZXIoY29udGV4dCk7XG4gICAgICAgIHZhciB0YWJzQmFyID0gbmV3IFRhYnNCYXIoY29udGV4dCwgdGhpcyk7XG4gICAgICAgIHZhciBscCA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ29tbW9uTGF5b3V0UGFyYW1zKCk7XG4gICAgICAgIHZhciBwcmltYXJ5Q29sb3IgPSB1dGlsc18xLmFkLnJlc291cmNlcy5nZXRQYWxldHRlQ29sb3IoUFJJTUFSWV9DT0xPUiwgY29udGV4dCk7XG4gICAgICAgIHZhciBhY2NlbnRDb2xvciA9IGdldERlZmF1bHRBY2NlbnRDb2xvcihjb250ZXh0KTtcbiAgICAgICAgbHAucm93ID0gMTtcbiAgICAgICAgaWYgKHRoaXMudGFic1Bvc2l0aW9uID09PSBcInRvcFwiKSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LmFkZFJvdyhuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkl0ZW1TcGVjKDEsIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkVW5pdFR5cGUuYXV0bykpO1xuICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRSb3cobmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5JdGVtU3BlYygxLCBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZFVuaXRUeXBlLnN0YXIpKTtcbiAgICAgICAgICAgIHZpZXdQYWdlci5zZXRMYXlvdXRQYXJhbXMobHApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRSb3cobmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5JdGVtU3BlYygxLCBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZFVuaXRUeXBlLnN0YXIpKTtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkUm93KG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuSXRlbVNwZWMoMSwgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRVbml0VHlwZS5hdXRvKSk7XG4gICAgICAgICAgICB0YWJzQmFyLnNldExheW91dFBhcmFtcyhscCk7XG4gICAgICAgIH1cbiAgICAgICAgbmF0aXZlVmlldy5hZGRWaWV3KHZpZXdQYWdlcik7XG4gICAgICAgIG5hdGl2ZVZpZXcudmlld1BhZ2VyID0gdmlld1BhZ2VyO1xuICAgICAgICB2YXIgYWRhcHRlciA9IG5ldyBQYWdlckFkYXB0ZXIodGhpcyk7XG4gICAgICAgIHZpZXdQYWdlci5zZXRBZGFwdGVyKGFkYXB0ZXIpO1xuICAgICAgICB2aWV3UGFnZXIuYWRhcHRlciA9IGFkYXB0ZXI7XG4gICAgICAgIG5hdGl2ZVZpZXcuYWRkVmlldyh0YWJzQmFyKTtcbiAgICAgICAgbmF0aXZlVmlldy50YWJzQmFyID0gdGFic0JhcjtcbiAgICAgICAgc2V0RWxldmF0aW9uKG5hdGl2ZVZpZXcsIHRhYnNCYXIsIHRoaXMudGFic1Bvc2l0aW9uKTtcbiAgICAgICAgaWYgKGFjY2VudENvbG9yKSB7XG4gICAgICAgICAgICB0YWJzQmFyLnNldFNlbGVjdGVkSW5kaWNhdG9yQ29sb3JzKFthY2NlbnRDb2xvcl0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwcmltYXJ5Q29sb3IpIHtcbiAgICAgICAgICAgIHRhYnNCYXIuc2V0QmFja2dyb3VuZENvbG9yKHByaW1hcnlDb2xvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXc7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5fYW5kcm9pZFZpZXdJZCA8IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2FuZHJvaWRWaWV3SWQgPSBhbmRyb2lkLnZpZXcuVmlldy5nZW5lcmF0ZVZpZXdJZCgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB0aGlzLl90YWJzQmFyID0gbmF0aXZlVmlldy50YWJzQmFyO1xuICAgICAgICB2YXIgdmlld1BhZ2VyID0gbmF0aXZlVmlldy52aWV3UGFnZXI7XG4gICAgICAgIHZpZXdQYWdlci5zZXRJZCh0aGlzLl9hbmRyb2lkVmlld0lkKTtcbiAgICAgICAgdGhpcy5fdmlld1BhZ2VyID0gdmlld1BhZ2VyO1xuICAgICAgICB0aGlzLl9wYWdlckFkYXB0ZXIgPSB2aWV3UGFnZXIuYWRhcHRlcjtcbiAgICAgICAgdGhpcy5fcGFnZXJBZGFwdGVyLm93bmVyID0gdGhpcztcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLl9sb2FkVW5sb2FkVGFiSXRlbXMgPSBmdW5jdGlvbiAobmV3SW5kZXgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgdmFyIGxhc3RJbmRleCA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTtcbiAgICAgICAgdmFyIG9mZnNpZGVJdGVtcyA9IHRoaXMub2Zmc2NyZWVuVGFiTGltaXQ7XG4gICAgICAgIHZhciB0b1VubG9hZCA9IFtdO1xuICAgICAgICB2YXIgdG9Mb2FkID0gW107XG4gICAgICAgIGl0ZXJhdGVJbmRleFJhbmdlKG5ld0luZGV4LCBvZmZzaWRlSXRlbXMsIGxhc3RJbmRleCwgZnVuY3Rpb24gKGkpIHsgcmV0dXJuIHRvTG9hZC5wdXNoKGkpOyB9KTtcbiAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICAgICAgdmFyIGluZGV4T2ZJID0gdG9Mb2FkLmluZGV4T2YoaSk7XG4gICAgICAgICAgICBpZiAoaW5kZXhPZkkgPCAwKSB7XG4gICAgICAgICAgICAgICAgdG9VbmxvYWQucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRvVW5sb2FkLmZvckVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGl0ZW1zW2luZGV4XTtcbiAgICAgICAgICAgIGlmIChpdGVtc1tpbmRleF0pIHtcbiAgICAgICAgICAgICAgICBpdGVtLnVubG9hZFZpZXcoaXRlbS5jb250ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBuZXdJdGVtID0gaXRlbXNbbmV3SW5kZXhdO1xuICAgICAgICB2YXIgc2VsZWN0ZWRWaWV3ID0gbmV3SXRlbSAmJiBuZXdJdGVtLmNvbnRlbnQ7XG4gICAgICAgIGlmIChzZWxlY3RlZFZpZXcgaW5zdGFuY2VvZiBmcmFtZV8xLkZyYW1lKSB7XG4gICAgICAgICAgICBzZWxlY3RlZFZpZXcuX3B1c2hJbkZyYW1lU3RhY2tSZWN1cnNpdmUoKTtcbiAgICAgICAgfVxuICAgICAgICB0b0xvYWQuZm9yRWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gaXRlbXNbaW5kZXhdO1xuICAgICAgICAgICAgaWYgKF90aGlzLmlzTG9hZGVkICYmIGl0ZW1zW2luZGV4XSkge1xuICAgICAgICAgICAgICAgIGl0ZW0ubG9hZFZpZXcoaXRlbS5jb250ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLnNldEl0ZW1zKHRoaXMuaXRlbXMpO1xuICAgICAgICBpZiAodGhpcy50YWJTdHJpcCkge1xuICAgICAgICAgICAgdGhpcy5zZXRUYWJTdHJpcEl0ZW1zKHRoaXMudGFiU3RyaXAuaXRlbXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5vblVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uVW5sb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5zZXRJdGVtcyhudWxsKTtcbiAgICAgICAgdGhpcy5zZXRUYWJTdHJpcEl0ZW1zKG51bGwpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3RhYnNCYXIuc2V0SXRlbXMobnVsbCwgbnVsbCk7XG4gICAgICAgIHRoaXMuX3BhZ2VyQWRhcHRlci5vd25lciA9IG51bGw7XG4gICAgICAgIHRoaXMuX3BhZ2VyQWRhcHRlciA9IG51bGw7XG4gICAgICAgIHRoaXMuX3RhYnNCYXIgPSBudWxsO1xuICAgICAgICB0aGlzLl92aWV3UGFnZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5fb25Sb290Vmlld1Jlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9vblJvb3RWaWV3UmVzZXQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudEZyYWdtZW50cygpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuZGlzcG9zZUN1cnJlbnRGcmFnbWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBmcmFnbWVudE1hbmFnZXIgPSB0aGlzLl9nZXRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gZnJhZ21lbnRNYW5hZ2VyLmJlZ2luVHJhbnNhY3Rpb24oKTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGZyYWdtZW50TWFuYWdlci5nZXRGcmFnbWVudHMoKS50b0FycmF5KCk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSBfYVtfaV07XG4gICAgICAgICAgICB0cmFuc2FjdGlvbi5yZW1vdmUoZnJhZ21lbnQpO1xuICAgICAgICB9XG4gICAgICAgIHRyYW5zYWN0aW9uLmNvbW1pdE5vd0FsbG93aW5nU3RhdGVMb3NzKCk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zaG91bGRVcGRhdGVBZGFwdGVyID0gZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgIGlmICghdGhpcy5fcGFnZXJBZGFwdGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGN1cnJlbnRQYWdlckFkYXB0ZXJJdGVtcyA9IHRoaXMuX3BhZ2VyQWRhcHRlci5pdGVtcztcbiAgICAgICAgaWYgKCFpdGVtcyAmJiAhY3VycmVudFBhZ2VyQWRhcHRlckl0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpdGVtcyB8fCAhY3VycmVudFBhZ2VyQWRhcHRlckl0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXRlbXMubGVuZ3RoICE9PSBjdXJyZW50UGFnZXJBZGFwdGVySXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWF0Y2hpbmdJdGVtcyA9IGN1cnJlbnRQYWdlckFkYXB0ZXJJdGVtcy5maWx0ZXIoZnVuY3Rpb24gKGN1cnJlbnRJdGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gISFpdGVtcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5fZG9tSWQgPT09IGN1cnJlbnRJdGVtLl9kb21JZDtcbiAgICAgICAgICAgIH0pWzBdO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKG1hdGNoaW5nSXRlbXMubGVuZ3RoICE9PSBpdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLnNldEl0ZW1zID0gZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgIGlmICh0aGlzLnNob3VsZFVwZGF0ZUFkYXB0ZXIoaXRlbXMpKSB7XG4gICAgICAgICAgICB0aGlzLl9wYWdlckFkYXB0ZXIuaXRlbXMgPSBpdGVtcztcbiAgICAgICAgICAgIGlmIChpdGVtcyAmJiBpdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcGFnZXJBZGFwdGVyLm5vdGlmeURhdGFTZXRDaGFuZ2VkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLnNldFRhYlN0cmlwSXRlbXMgPSBmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGxlbmd0aCA9IGl0ZW1zID8gaXRlbXMubGVuZ3RoIDogMDtcbiAgICAgICAgaWYgKGxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5fdGFic0Jhci5zZXRJdGVtcyhudWxsLCBudWxsKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGFiSXRlbXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSwgYXJyKSB7XG4gICAgICAgICAgICBpdGVtLmluZGV4ID0gaTtcbiAgICAgICAgICAgIHZhciB0YWJJdGVtU3BlYyA9IF90aGlzLmNyZWF0ZVRhYkl0ZW1TcGVjKGl0ZW0pO1xuICAgICAgICAgICAgaXRlbS50YWJJdGVtU3BlYyA9IHRhYkl0ZW1TcGVjO1xuICAgICAgICAgICAgdGFiSXRlbXMucHVzaCh0YWJJdGVtU3BlYyk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgdGFic0JhciA9IHRoaXMuX3RhYnNCYXI7XG4gICAgICAgIHRhYnNCYXIuc2V0SXRlbXModGFiSXRlbXMsIHRoaXMuX3ZpZXdQYWdlcik7XG4gICAgICAgIHRoaXMudGFiU3RyaXAuc2V0TmF0aXZlVmlldyh0YWJzQmFyKTtcbiAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSwgYXJyKSB7XG4gICAgICAgICAgICB2YXIgdHYgPSB0YWJzQmFyLmdldFRleHRWaWV3Rm9ySXRlbUF0KGkpO1xuICAgICAgICAgICAgaXRlbS5zZXROYXRpdmVWaWV3KHR2KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5jcmVhdGVUYWJJdGVtU3BlYyA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0pIHtcbiAgICAgICAgdmFyIHRhYkl0ZW1TcGVjID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5UYWJJdGVtU3BlYygpO1xuICAgICAgICBpZiAodGFiU3RyaXBJdGVtLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICB2YXIgbmVzdGVkTGFiZWwgPSB0YWJTdHJpcEl0ZW0ubGFiZWw7XG4gICAgICAgICAgICB2YXIgdGl0bGUgPSBuZXN0ZWRMYWJlbC50ZXh0O1xuICAgICAgICAgICAgdmFyIHRleHRUcmFuc2Zvcm0gPSBuZXN0ZWRMYWJlbC5zdHlsZS50ZXh0VHJhbnNmb3JtO1xuICAgICAgICAgICAgaWYgKHRleHRUcmFuc2Zvcm0pIHtcbiAgICAgICAgICAgICAgICB0aXRsZSA9IHRleHRfYmFzZV8xLmdldFRyYW5zZm9ybWVkVGV4dCh0aXRsZSwgdGV4dFRyYW5zZm9ybSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YWJJdGVtU3BlYy50aXRsZSA9IHRpdGxlO1xuICAgICAgICAgICAgdmFyIGJhY2tncm91bmRDb2xvciA9IHRhYlN0cmlwSXRlbS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgICAgICBpZiAoYmFja2dyb3VuZENvbG9yKSB7XG4gICAgICAgICAgICAgICAgdGFiSXRlbVNwZWMuYmFja2dyb3VuZENvbG9yID0gYmFja2dyb3VuZENvbG9yLmFuZHJvaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY29sb3IgPSBuZXN0ZWRMYWJlbC5zdHlsZS5jb2xvcjtcbiAgICAgICAgICAgIGlmIChjb2xvcikge1xuICAgICAgICAgICAgICAgIHRhYkl0ZW1TcGVjLmNvbG9yID0gY29sb3IuYW5kcm9pZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmb250SW50ZXJuYWwgPSBuZXN0ZWRMYWJlbC5zdHlsZS5mb250SW50ZXJuYWw7XG4gICAgICAgICAgICBpZiAoZm9udEludGVybmFsKSB7XG4gICAgICAgICAgICAgICAgdGFiSXRlbVNwZWMuZm9udFNpemUgPSBmb250SW50ZXJuYWwuZm9udFNpemU7XG4gICAgICAgICAgICAgICAgdGFiSXRlbVNwZWMudHlwZUZhY2UgPSBmb250SW50ZXJuYWwuZ2V0QW5kcm9pZFR5cGVmYWNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaWNvblNvdXJjZSA9IHRhYlN0cmlwSXRlbS5pbWFnZSAmJiB0YWJTdHJpcEl0ZW0uaW1hZ2Uuc3JjO1xuICAgICAgICAgICAgaWYgKGljb25Tb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgaWNvbiA9IHRoaXMuZ2V0SWNvbih0YWJTdHJpcEl0ZW0pO1xuICAgICAgICAgICAgICAgIGlmIChpY29uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYkl0ZW1TcGVjLmljb25EcmF3YWJsZSA9IGljb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGFiSXRlbVNwZWM7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5nZXRJY29uID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSkge1xuICAgICAgICB2YXIgaWNvblNvdXJjZSA9IHRhYlN0cmlwSXRlbS5pbWFnZSAmJiB0YWJTdHJpcEl0ZW0uaW1hZ2Uuc3JjO1xuICAgICAgICB2YXIgaXM7XG4gICAgICAgIGlmICh1dGlsc18xLmlzRm9udEljb25VUkkoaWNvblNvdXJjZSkpIHtcbiAgICAgICAgICAgIHZhciBmb250SWNvbkNvZGUgPSBpY29uU291cmNlLnNwbGl0KFwiLy9cIilbMV07XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGFiU3RyaXBJdGVtLmltYWdlID8gdGFiU3RyaXBJdGVtLmltYWdlIDogdGFiU3RyaXBJdGVtO1xuICAgICAgICAgICAgdmFyIGZvbnQgPSB0YXJnZXQuc3R5bGUuZm9udEludGVybmFsO1xuICAgICAgICAgICAgdmFyIGNvbG9yID0gdGFyZ2V0LnN0eWxlLmNvbG9yO1xuICAgICAgICAgICAgaXMgPSBpbWFnZV9zb3VyY2VfMS5mcm9tRm9udEljb25Db2RlKGZvbnRJY29uQ29kZSwgZm9udCwgY29sb3IpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaXMgPSBpbWFnZV9zb3VyY2VfMS5mcm9tRmlsZU9yUmVzb3VyY2UoaWNvblNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGltYWdlRHJhd2FibGU7XG4gICAgICAgIGlmIChpcyAmJiBpcy5hbmRyb2lkKSB7XG4gICAgICAgICAgICB2YXIgaW1hZ2UgPSBpcy5hbmRyb2lkO1xuICAgICAgICAgICAgaWYgKHRoaXMudGFiU3RyaXAgJiYgdGhpcy50YWJTdHJpcC5pc0ljb25TaXplRml4ZWQpIHtcbiAgICAgICAgICAgICAgICBpbWFnZSA9IHRoaXMuZ2V0Rml4ZWRTaXplSWNvbihpbWFnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbWFnZURyYXdhYmxlID0gbmV3IGFuZHJvaWQuZ3JhcGhpY3MuZHJhd2FibGUuQml0bWFwRHJhd2FibGUoYXBwbGljYXRpb24uYW5kcm9pZC5jb250ZXh0LmdldFJlc291cmNlcygpLCBpbWFnZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGltYWdlRHJhd2FibGU7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5nZXRGaXhlZFNpemVJY29uID0gZnVuY3Rpb24gKGltYWdlKSB7XG4gICAgICAgIHZhciBpbldpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTtcbiAgICAgICAgdmFyIGluSGVpZ2h0ID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7XG4gICAgICAgIHZhciBpY29uU3BlY1NpemUgPSB0YWJfbmF2aWdhdGlvbl9iYXNlXzEuZ2V0SWNvblNwZWNTaXplKHsgd2lkdGg6IGluV2lkdGgsIGhlaWdodDogaW5IZWlnaHQgfSk7XG4gICAgICAgIHZhciB3aWR0aFBpeGVscyA9IGljb25TcGVjU2l6ZS53aWR0aCAqIHV0aWxzXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgIHZhciBoZWlnaHRQaXhlbHMgPSBpY29uU3BlY1NpemUuaGVpZ2h0ICogdXRpbHNfMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICAgICAgdmFyIHNjYWxlZEltYWdlID0gYW5kcm9pZC5ncmFwaGljcy5CaXRtYXAuY3JlYXRlU2NhbGVkQml0bWFwKGltYWdlLCB3aWR0aFBpeGVscywgaGVpZ2h0UGl4ZWxzLCB0cnVlKTtcbiAgICAgICAgcmV0dXJuIHNjYWxlZEltYWdlO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUudXBkYXRlQW5kcm9pZEl0ZW1BdCA9IGZ1bmN0aW9uIChpbmRleCwgc3BlYykge1xuICAgICAgICB0aGlzLl90YWJzQmFyLnVwZGF0ZUl0ZW1BdChpbmRleCwgc3BlYyk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5nZXRUYWJCYXJCYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90YWJzQmFyLmdldEJhY2tncm91bmQoKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLnNldFRhYkJhckJhY2tncm91bmRDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiB2aWV3XzEuQ29sb3IpIHtcbiAgICAgICAgICAgIHRoaXMuX3RhYnNCYXIuc2V0QmFja2dyb3VuZENvbG9yKHZhbHVlLmFuZHJvaWQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdGFic0Jhci5zZXRCYWNrZ3JvdW5kKHRyeUNsb25lRHJhd2FibGUodmFsdWUsIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRSZXNvdXJjZXMpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuZ2V0VGFiQmFySGlnaGxpZ2h0Q29sb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBnZXREZWZhdWx0QWNjZW50Q29sb3IodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zZXRUYWJCYXJIaWdobGlnaHRDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIHZpZXdfMS5Db2xvciA/IHZhbHVlLmFuZHJvaWQgOiB2YWx1ZTtcbiAgICAgICAgdGhpcy5fdGFic0Jhci5zZXRTZWxlY3RlZEluZGljYXRvckNvbG9ycyhbY29sb3JdKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLnNldFRhYkJhckl0ZW1UaXRsZSA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgICAgIHZhciB0YWJTdHJpcEl0ZW1JbmRleCA9IHRoaXMudGFiU3RyaXAuaXRlbXMuaW5kZXhPZih0YWJTdHJpcEl0ZW0pO1xuICAgICAgICB2YXIgdGFiSXRlbVNwZWMgPSB0aGlzLmNyZWF0ZVRhYkl0ZW1TcGVjKHRhYlN0cmlwSXRlbSk7XG4gICAgICAgIHRoaXMudXBkYXRlQW5kcm9pZEl0ZW1BdCh0YWJTdHJpcEl0ZW1JbmRleCwgdGFiSXRlbVNwZWMpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuc2V0VGFiQmFySXRlbUJhY2tncm91bmRDb2xvciA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgICAgIHZhciB0YWJTdHJpcEl0ZW1JbmRleCA9IHRoaXMudGFiU3RyaXAuaXRlbXMuaW5kZXhPZih0YWJTdHJpcEl0ZW0pO1xuICAgICAgICB2YXIgdGFiSXRlbVNwZWMgPSB0aGlzLmNyZWF0ZVRhYkl0ZW1TcGVjKHRhYlN0cmlwSXRlbSk7XG4gICAgICAgIHRoaXMudXBkYXRlQW5kcm9pZEl0ZW1BdCh0YWJTdHJpcEl0ZW1JbmRleCwgdGFiSXRlbVNwZWMpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuc2V0VGFiQmFySXRlbUNvbG9yID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgdGFiU3RyaXBJdGVtLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VGV4dENvbG9yKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRhYlN0cmlwSXRlbS5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFRleHRDb2xvcih2YWx1ZS5hbmRyb2lkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuc2V0VGFiQmFySWNvbkNvbG9yID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gdGFiU3RyaXBJdGVtLmluZGV4O1xuICAgICAgICB2YXIgdGFiQmFySXRlbSA9IHRoaXMuX3RhYnNCYXIuZ2V0Vmlld0Zvckl0ZW1BdChpbmRleCk7XG4gICAgICAgIHZhciBpbWdWaWV3ID0gdGFiQmFySXRlbS5nZXRDaGlsZEF0KDApO1xuICAgICAgICB2YXIgZHJhd2FibGUgPSB0aGlzLmdldEljb24odGFiU3RyaXBJdGVtKTtcbiAgICAgICAgaW1nVmlldy5zZXRJbWFnZURyYXdhYmxlKGRyYXdhYmxlKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLnNldFRhYkJhckl0ZW1Gb250SW50ZXJuYWwgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgICAgICB0YWJTdHJpcEl0ZW0ubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUZXh0U2l6ZSh2YWx1ZS5mb250U2l6ZSk7XG4gICAgICAgIHRhYlN0cmlwSXRlbS5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFR5cGVmYWNlKHZhbHVlLmdldEFuZHJvaWRUeXBlZmFjZSgpKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLnNldFRhYkJhckl0ZW1UZXh0VHJhbnNmb3JtID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIG5lc3RlZExhYmVsID0gdGFiU3RyaXBJdGVtLmxhYmVsO1xuICAgICAgICB2YXIgdGl0bGUgPSB0ZXh0X2Jhc2VfMS5nZXRUcmFuc2Zvcm1lZFRleHQobmVzdGVkTGFiZWwudGV4dCwgdmFsdWUpO1xuICAgICAgICB0YWJTdHJpcEl0ZW0ubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUZXh0KHRpdGxlKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgc21vb3RoU2Nyb2xsID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fdmlld1BhZ2VyLnNldEN1cnJlbnRJdGVtKHZhbHVlLCBzbW9vdGhTY3JvbGwpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGVbdGFiX25hdmlnYXRpb25fYmFzZV8xLml0ZW1zUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGVbdGFiX25hdmlnYXRpb25fYmFzZV8xLml0ZW1zUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnNldEl0ZW1zKHZhbHVlKTtcbiAgICAgICAgdGFiX25hdmlnYXRpb25fYmFzZV8xLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5jb2VyY2UodGhpcyk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZVt0YWJfbmF2aWdhdGlvbl9iYXNlXzEudGFiU3RyaXBQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZVt0YWJfbmF2aWdhdGlvbl9iYXNlXzEudGFiU3RyaXBQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc2V0VGFiU3RyaXBJdGVtcyh2YWx1ZS5pdGVtcyk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZVt0YWJzX2NvbW1vbl8xLnN3aXBlRW5hYmxlZFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlW3RhYnNfY29tbW9uXzEuc3dpcGVFbmFibGVkUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl92aWV3UGFnZXIuc2V0U3dpcGVQYWdlRW5hYmxlZCh2YWx1ZSk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZVt0YWJzX2NvbW1vbl8xLm9mZnNjcmVlblRhYkxpbWl0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl92aWV3UGFnZXIuZ2V0T2Zmc2NyZWVuUGFnZUxpbWl0KCk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZVt0YWJzX2NvbW1vbl8xLm9mZnNjcmVlblRhYkxpbWl0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl92aWV3UGFnZXIuc2V0T2Zmc2NyZWVuUGFnZUxpbWl0KHZhbHVlKTtcbiAgICB9O1xuICAgIHJldHVybiBUYWJzO1xufSh0YWJzX2NvbW1vbl8xLlRhYnNCYXNlKSk7XG5leHBvcnRzLlRhYnMgPSBUYWJzO1xuZnVuY3Rpb24gdHJ5Q2xvbmVEcmF3YWJsZSh2YWx1ZSwgcmVzb3VyY2VzKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb25zdGFudFN0YXRlID0gdmFsdWUuZ2V0Q29uc3RhbnRTdGF0ZSgpO1xuICAgICAgICBpZiAoY29uc3RhbnRTdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50U3RhdGUubmV3RHJhd2FibGUocmVzb3VyY2VzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YWJzLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIGZvcm1hdHRlZF9zdHJpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi90ZXh0L2Zvcm1hdHRlZC1zdHJpbmdcIik7XG5leHBvcnRzLkZvcm1hdHRlZFN0cmluZyA9IGZvcm1hdHRlZF9zdHJpbmdfMS5Gb3JtYXR0ZWRTdHJpbmc7XG5leHBvcnRzLlNwYW4gPSBmb3JtYXR0ZWRfc3RyaW5nXzEuU3Bhbjtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIENISUxEX1NQQU4gPSBcIlNwYW5cIjtcbnZhciBDSElMRF9GT1JNQVRURURfVEVYVCA9IFwiZm9ybWF0dGVkVGV4dFwiO1xudmFyIENISUxEX0ZPUk1BVFRFRF9TVFJJTkcgPSBcIkZvcm1hdHRlZFN0cmluZ1wiO1xudmFyIFRleHRCYXNlQ29tbW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGV4dEJhc2VDb21tb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGV4dEJhc2VDb21tb24oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJuYXRpdmVUZXh0Vmlld1Byb3RlY3RlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJmb250RmFtaWx5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250RmFtaWx5O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250RmFtaWx5ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwiZm9udFNpemVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRTaXplO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250U2l6ZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcImZvbnRTdHlsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udFN0eWxlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250U3R5bGUgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJmb250V2VpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250V2VpZ2h0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250V2VpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwibGV0dGVyU3BhY2luZ1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUubGV0dGVyU3BhY2luZztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubGV0dGVyU3BhY2luZyA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcImxpbmVIZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmxpbmVIZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmxpbmVIZWlnaHQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJ0ZXh0QWxpZ25tZW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50ZXh0QWxpZ25tZW50O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50ZXh0QWxpZ25tZW50ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwidGV4dERlY29yYXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRleHREZWNvcmF0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50ZXh0RGVjb3JhdGlvbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInRleHRUcmFuc2Zvcm1cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRleHRUcmFuc2Zvcm07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnRleHRUcmFuc2Zvcm0gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJ3aGl0ZVNwYWNlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS53aGl0ZVNwYWNlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS53aGl0ZVNwYWNlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwicGFkZGluZ1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUucGFkZGluZztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUucGFkZGluZyA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInBhZGRpbmdUb3BcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnBhZGRpbmdUb3A7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmdUb3AgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nUmlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnBhZGRpbmdSaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUucGFkZGluZ1JpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwicGFkZGluZ0JvdHRvbVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUucGFkZGluZ0JvdHRvbTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUucGFkZGluZ0JvdHRvbSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInBhZGRpbmdMZWZ0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nTGVmdDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUucGFkZGluZ0xlZnQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLl9vbkZvcm1hdHRlZFRleHRDb250ZW50c0NoYW5nZWQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzW2V4cG9ydHMuZm9ybWF0dGVkVGV4dFByb3BlcnR5LnNldE5hdGl2ZV0oZGF0YS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gQ0hJTERfU1BBTikge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmZvcm1hdHRlZFRleHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZm9ybWF0dGVkVGV4dCA9IG5ldyBmb3JtYXR0ZWRfc3RyaW5nXzEuRm9ybWF0dGVkU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkVGV4dC5zcGFucy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdHRlZFRleHQgPSBmb3JtYXR0ZWRUZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtYXR0ZWRUZXh0LnNwYW5zLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5hbWUgPT09IENISUxEX0ZPUk1BVFRFRF9URVhUIHx8IG5hbWUgPT09IENISUxEX0ZPUk1BVFRFRF9TVFJJTkcpIHtcbiAgICAgICAgICAgIHRoaXMuZm9ybWF0dGVkVGV4dCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUuX3JlcXVlc3RMYXlvdXRPblRleHRDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnJlcXVlc3RMYXlvdXQoKTtcbiAgICB9O1xuICAgIFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHRleHQgPSB0aGlzLmZvcm1hdHRlZFRleHQ7XG4gICAgICAgIGlmICh0ZXh0KSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0ZXh0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLl9zZXROYXRpdmVUZXh0ID0gZnVuY3Rpb24gKHJlc2V0KSB7XG4gICAgICAgIGlmIChyZXNldCA9PT0gdm9pZCAwKSB7IHJlc2V0ID0gZmFsc2U7IH1cbiAgICB9O1xuICAgIHJldHVybiBUZXh0QmFzZUNvbW1vbjtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuVGV4dEJhc2VDb21tb24gPSBUZXh0QmFzZUNvbW1vbjtcblRleHRCYXNlQ29tbW9uLnByb3RvdHlwZS5faXNTaW5nbGVMaW5lID0gZmFsc2U7XG5mdW5jdGlvbiBpc0JvbGQoZm9udFdlaWdodCkge1xuICAgIHJldHVybiBmb250V2VpZ2h0ID09PSBcImJvbGRcIiB8fCBmb250V2VpZ2h0ID09PSBcIjcwMFwiIHx8IGZvbnRXZWlnaHQgPT09IFwiODAwXCIgfHwgZm9udFdlaWdodCA9PT0gXCI5MDBcIjtcbn1cbmV4cG9ydHMuaXNCb2xkID0gaXNCb2xkO1xuZXhwb3J0cy50ZXh0UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJ0ZXh0XCIsIGRlZmF1bHRWYWx1ZTogXCJcIiwgYWZmZWN0c0xheW91dDogdmlld18xLmlzQW5kcm9pZCB9KTtcbmV4cG9ydHMudGV4dFByb3BlcnR5LnJlZ2lzdGVyKFRleHRCYXNlQ29tbW9uKTtcbmV4cG9ydHMuZm9ybWF0dGVkVGV4dFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiZm9ybWF0dGVkVGV4dFwiLCBhZmZlY3RzTGF5b3V0OiB0cnVlLCB2YWx1ZUNoYW5nZWQ6IG9uRm9ybWF0dGVkVGV4dFByb3BlcnR5Q2hhbmdlZCB9KTtcbmV4cG9ydHMuZm9ybWF0dGVkVGV4dFByb3BlcnR5LnJlZ2lzdGVyKFRleHRCYXNlQ29tbW9uKTtcbmZ1bmN0aW9uIG9uRm9ybWF0dGVkVGV4dFByb3BlcnR5Q2hhbmdlZCh0ZXh0QmFzZSwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgaWYgKG9sZFZhbHVlKSB7XG4gICAgICAgIG9sZFZhbHVlLm9mZih2aWV3XzEuT2JzZXJ2YWJsZS5wcm9wZXJ0eUNoYW5nZUV2ZW50LCB0ZXh0QmFzZS5fb25Gb3JtYXR0ZWRUZXh0Q29udGVudHNDaGFuZ2VkLCB0ZXh0QmFzZSk7XG4gICAgICAgIHRleHRCYXNlLl9yZW1vdmVWaWV3KG9sZFZhbHVlKTtcbiAgICB9XG4gICAgaWYgKG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBvbGRQYXJlbnQgPSBuZXdWYWx1ZS5wYXJlbnQ7XG4gICAgICAgIGlmIChvbGRQYXJlbnQpIHtcbiAgICAgICAgICAgIG9sZFBhcmVudC5fcmVtb3ZlVmlldyhuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGV4dEJhc2UuX2FkZFZpZXcobmV3VmFsdWUpO1xuICAgICAgICBuZXdWYWx1ZS5vbih2aWV3XzEuT2JzZXJ2YWJsZS5wcm9wZXJ0eUNoYW5nZUV2ZW50LCB0ZXh0QmFzZS5fb25Gb3JtYXR0ZWRUZXh0Q29udGVudHNDaGFuZ2VkLCB0ZXh0QmFzZSk7XG4gICAgfVxufVxudmFyIHRleHRBbGlnbm1lbnRDb252ZXJ0ZXIgPSB2aWV3XzEubWFrZVBhcnNlcih2aWV3XzEubWFrZVZhbGlkYXRvcihcImluaXRpYWxcIiwgXCJsZWZ0XCIsIFwiY2VudGVyXCIsIFwicmlnaHRcIikpO1xuZXhwb3J0cy50ZXh0QWxpZ25tZW50UHJvcGVydHkgPSBuZXcgdmlld18xLkluaGVyaXRlZENzc1Byb3BlcnR5KHsgbmFtZTogXCJ0ZXh0QWxpZ25tZW50XCIsIGNzc05hbWU6IFwidGV4dC1hbGlnblwiLCBkZWZhdWx0VmFsdWU6IFwiaW5pdGlhbFwiLCB2YWx1ZUNvbnZlcnRlcjogdGV4dEFsaWdubWVudENvbnZlcnRlciB9KTtcbmV4cG9ydHMudGV4dEFsaWdubWVudFByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG52YXIgdGV4dFRyYW5zZm9ybUNvbnZlcnRlciA9IHZpZXdfMS5tYWtlUGFyc2VyKHZpZXdfMS5tYWtlVmFsaWRhdG9yKFwiaW5pdGlhbFwiLCBcIm5vbmVcIiwgXCJjYXBpdGFsaXplXCIsIFwidXBwZXJjYXNlXCIsIFwibG93ZXJjYXNlXCIpKTtcbmV4cG9ydHMudGV4dFRyYW5zZm9ybVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwidGV4dFRyYW5zZm9ybVwiLCBjc3NOYW1lOiBcInRleHQtdHJhbnNmb3JtXCIsIGRlZmF1bHRWYWx1ZTogXCJpbml0aWFsXCIsIHZhbHVlQ29udmVydGVyOiB0ZXh0VHJhbnNmb3JtQ29udmVydGVyIH0pO1xuZXhwb3J0cy50ZXh0VHJhbnNmb3JtUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbnZhciB3aGl0ZVNwYWNlQ29udmVydGVyID0gdmlld18xLm1ha2VQYXJzZXIodmlld18xLm1ha2VWYWxpZGF0b3IoXCJpbml0aWFsXCIsIFwibm9ybWFsXCIsIFwibm93cmFwXCIpKTtcbmV4cG9ydHMud2hpdGVTcGFjZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwid2hpdGVTcGFjZVwiLCBjc3NOYW1lOiBcIndoaXRlLXNwYWNlXCIsIGRlZmF1bHRWYWx1ZTogXCJpbml0aWFsXCIsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IHdoaXRlU3BhY2VDb252ZXJ0ZXIgfSk7XG5leHBvcnRzLndoaXRlU3BhY2VQcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xudmFyIHRleHREZWNvcmF0aW9uQ29udmVydGVyID0gdmlld18xLm1ha2VQYXJzZXIodmlld18xLm1ha2VWYWxpZGF0b3IoXCJub25lXCIsIFwidW5kZXJsaW5lXCIsIFwibGluZS10aHJvdWdoXCIsIFwidW5kZXJsaW5lIGxpbmUtdGhyb3VnaFwiKSk7XG5leHBvcnRzLnRleHREZWNvcmF0aW9uUHJvcGVydHkgPSBuZXcgdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJ0ZXh0RGVjb3JhdGlvblwiLCBjc3NOYW1lOiBcInRleHQtZGVjb3JhdGlvblwiLCBkZWZhdWx0VmFsdWU6IFwibm9uZVwiLCB2YWx1ZUNvbnZlcnRlcjogdGV4dERlY29yYXRpb25Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLnRleHREZWNvcmF0aW9uUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbmV4cG9ydHMubGV0dGVyU3BhY2luZ1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwibGV0dGVyU3BhY2luZ1wiLCBjc3NOYW1lOiBcImxldHRlci1zcGFjaW5nXCIsIGRlZmF1bHRWYWx1ZTogMCwgYWZmZWN0c0xheW91dDogdmlld18xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlRmxvYXQodik7IH0gfSk7XG5leHBvcnRzLmxldHRlclNwYWNpbmdQcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xuZXhwb3J0cy5saW5lSGVpZ2h0UHJvcGVydHkgPSBuZXcgdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJsaW5lSGVpZ2h0XCIsIGNzc05hbWU6IFwibGluZS1oZWlnaHRcIiwgYWZmZWN0c0xheW91dDogdmlld18xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlRmxvYXQodik7IH0gfSk7XG5leHBvcnRzLmxpbmVIZWlnaHRQcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xuZXhwb3J0cy5yZXNldFN5bWJvbCA9IFN5bWJvbChcInRleHRQcm9wZXJ0eURlZmF1bHRcIik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10ZXh0LWJhc2UtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZm9udF8xID0gcmVxdWlyZShcIi4uL3N0eWxpbmcvZm9udFwiKTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIHRleHRfYmFzZV9jb21tb25fMSA9IHJlcXVpcmUoXCIuL3RleHQtYmFzZS1jb21tb25cIik7XG52YXIgdHlwZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy90eXBlc1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3RleHQtYmFzZS1jb21tb25cIikpO1xudmFyIFRleHRUcmFuc2Zvcm1hdGlvbjtcbmZ1bmN0aW9uIGluaXRpYWxpemVUZXh0VHJhbnNmb3JtYXRpb24oKSB7XG4gICAgaWYgKFRleHRUcmFuc2Zvcm1hdGlvbikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBUZXh0VHJhbnNmb3JtYXRpb25JbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFRleHRUcmFuc2Zvcm1hdGlvbkltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFRleHRUcmFuc2Zvcm1hdGlvbkltcGwodGV4dEJhc2UpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy50ZXh0QmFzZSA9IHRleHRCYXNlO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgVGV4dFRyYW5zZm9ybWF0aW9uSW1wbC5wcm90b3R5cGUuZ2V0VHJhbnNmb3JtYXRpb24gPSBmdW5jdGlvbiAoY2hhclNlcSwgdmlldykge1xuICAgICAgICAgICAgdmFyIGZvcm1hdHRlZFRleHQgPSB0aGlzLnRleHRCYXNlLmZvcm1hdHRlZFRleHQ7XG4gICAgICAgICAgICBpZiAoZm9ybWF0dGVkVGV4dCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVTcGFubmFibGVTdHJpbmdCdWlsZGVyKGZvcm1hdHRlZFRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHRleHQgPSB0aGlzLnRleHRCYXNlLnRleHQ7XG4gICAgICAgICAgICAgICAgdmFyIHN0cmluZ1ZhbHVlID0gKHRleHQgPT09IG51bGwgfHwgdGV4dCA9PT0gdW5kZWZpbmVkKSA/IFwiXCIgOiB0ZXh0LnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFRyYW5zZm9ybWVkVGV4dChzdHJpbmdWYWx1ZSwgdGhpcy50ZXh0QmFzZS50ZXh0VHJhbnNmb3JtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVGV4dFRyYW5zZm9ybWF0aW9uSW1wbC5wcm90b3R5cGUub25Gb2N1c0NoYW5nZWQgPSBmdW5jdGlvbiAodmlldywgc291cmNlVGV4dCwgZm9jdXNlZCwgZGlyZWN0aW9uLCBwcmV2aW91c2x5Rm9jdXNlZFJlY3QpIHtcbiAgICAgICAgfTtcbiAgICAgICAgVGV4dFRyYW5zZm9ybWF0aW9uSW1wbCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgSW50ZXJmYWNlcyhbYW5kcm9pZC50ZXh0Lm1ldGhvZC5UcmFuc2Zvcm1hdGlvbk1ldGhvZF0pXG4gICAgICAgIF0sIFRleHRUcmFuc2Zvcm1hdGlvbkltcGwpO1xuICAgICAgICByZXR1cm4gVGV4dFRyYW5zZm9ybWF0aW9uSW1wbDtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICBUZXh0VHJhbnNmb3JtYXRpb24gPSBUZXh0VHJhbnNmb3JtYXRpb25JbXBsO1xufVxudmFyIFRleHRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGV4dEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGV4dEJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGV4dEJhc2UucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIGluaXRpYWxpemVUZXh0VHJhbnNmb3JtYXRpb24oKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkO1xuICAgICAgICB0aGlzLl9kZWZhdWx0VHJhbnNmb3JtYXRpb25NZXRob2QgPSBuYXRpdmVWaWV3LmdldFRyYW5zZm9ybWF0aW9uTWV0aG9kKCk7XG4gICAgICAgIHRoaXMuX21pbkhlaWdodCA9IG5hdGl2ZVZpZXcuZ2V0TWluSGVpZ2h0KCk7XG4gICAgICAgIHRoaXMuX21heEhlaWdodCA9IG5hdGl2ZVZpZXcuZ2V0TWF4SGVpZ2h0KCk7XG4gICAgICAgIHRoaXMuX21pbkxpbmVzID0gbmF0aXZlVmlldy5nZXRNaW5MaW5lcygpO1xuICAgICAgICB0aGlzLl9tYXhMaW5lcyA9IG5hdGl2ZVZpZXcuZ2V0TWF4TGluZXMoKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRTaW5nbGVMaW5lKHRoaXMuX2lzU2luZ2xlTGluZSk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0VHJhbnNmb3JtYXRpb25NZXRob2QodGhpcy5fZGVmYXVsdFRyYW5zZm9ybWF0aW9uTWV0aG9kKTtcbiAgICAgICAgdGhpcy5fZGVmYXVsdFRyYW5zZm9ybWF0aW9uTWV0aG9kID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMuX3BhaW50RmxhZ3MgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRQYWludEZsYWdzKHRoaXMuX3BhaW50RmxhZ3MpO1xuICAgICAgICAgICAgdGhpcy5fcGFpbnRGbGFncyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fbWluTGluZXMgIT09IC0xKSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldE1pbkxpbmVzKHRoaXMuX21pbkxpbmVzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0TWluSGVpZ2h0KHRoaXMuX21pbkhlaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbWluSGVpZ2h0ID0gdGhpcy5fbWluTGluZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmICh0aGlzLl9tYXhMaW5lcyAhPT0gLTEpIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0TWF4TGluZXModGhpcy5fbWF4TGluZXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRNYXhIZWlnaHQodGhpcy5fbWF4SGVpZ2h0KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9tYXhIZWlnaHQgPSB0aGlzLl9tYXhMaW5lcyA9IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGV4dF9iYXNlX2NvbW1vbl8xLnJlc2V0U3ltYm9sO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS50ZXh0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcmVzZXQgPSB2YWx1ZSA9PT0gdGV4dF9iYXNlX2NvbW1vbl8xLnJlc2V0U3ltYm9sO1xuICAgICAgICBpZiAoIXJlc2V0ICYmIHRoaXMuZm9ybWF0dGVkVGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3NldE5hdGl2ZVRleHQocmVzZXQpO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5mb3JtYXR0ZWRUZXh0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChuYXRpdmVWaWV3IGluc3RhbmNlb2YgYW5kcm9pZC53aWRnZXQuQnV0dG9uICYmXG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5nZXRUcmFuc2Zvcm1hdGlvbk1ldGhvZCgpIGluc3RhbmNlb2YgVGV4dFRyYW5zZm9ybWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRUcmFuc2Zvcm1hdGlvbk1ldGhvZCh0aGlzLl9kZWZhdWx0VHJhbnNmb3JtYXRpb25NZXRob2QpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlY3VyZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzcGFubmFibGVTdHJpbmdCdWlsZGVyID0gY3JlYXRlU3Bhbm5hYmxlU3RyaW5nQnVpbGRlcih2YWx1ZSk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0VGV4dChzcGFubmFibGVTdHJpbmdCdWlsZGVyKTtcbiAgICAgICAgdGV4dF9iYXNlX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZSh0aGlzLCAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkgPyBcIlwiIDogdmFsdWUudG9TdHJpbmcoKSk7XG4gICAgICAgIGlmIChzcGFubmFibGVTdHJpbmdCdWlsZGVyICYmIG5hdGl2ZVZpZXcgaW5zdGFuY2VvZiBhbmRyb2lkLndpZGdldC5CdXR0b24gJiZcbiAgICAgICAgICAgICEobmF0aXZlVmlldy5nZXRUcmFuc2Zvcm1hdGlvbk1ldGhvZCgpIGluc3RhbmNlb2YgVGV4dFRyYW5zZm9ybWF0aW9uKSkge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRUcmFuc2Zvcm1hdGlvbk1ldGhvZChuZXcgVGV4dFRyYW5zZm9ybWF0aW9uKHRoaXMpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS50ZXh0VHJhbnNmb3JtUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgPT09IFwiaW5pdGlhbFwiKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldFRyYW5zZm9ybWF0aW9uTWV0aG9kKHRoaXMuX2RlZmF1bHRUcmFuc2Zvcm1hdGlvbk1ldGhvZCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc2VjdXJlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRUcmFuc2Zvcm1hdGlvbk1ldGhvZChuZXcgVGV4dFRyYW5zZm9ybWF0aW9uKHRoaXMpKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dEFsaWdubWVudFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJpbml0aWFsXCI7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnRleHRBbGlnbm1lbnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciB2ZXJ0aWNhbEdyYXZpdHkgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmdldEdyYXZpdHkoKSAmIGFuZHJvaWQudmlldy5HcmF2aXR5LlZFUlRJQ0FMX0dSQVZJVFlfTUFTSztcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcImluaXRpYWxcIjpcbiAgICAgICAgICAgIGNhc2UgXCJsZWZ0XCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRHcmF2aXR5KGFuZHJvaWQudmlldy5HcmF2aXR5LlNUQVJUIHwgdmVydGljYWxHcmF2aXR5KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJjZW50ZXJcIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldEdyYXZpdHkoYW5kcm9pZC52aWV3LkdyYXZpdHkuQ0VOVEVSX0hPUklaT05UQUwgfCB2ZXJ0aWNhbEdyYXZpdHkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInJpZ2h0XCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRHcmF2aXR5KGFuZHJvaWQudmlldy5HcmF2aXR5LkVORCB8IHZlcnRpY2FsR3Jhdml0eSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEud2hpdGVTcGFjZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkO1xuICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICBjYXNlIFwiaW5pdGlhbFwiOlxuICAgICAgICAgICAgY2FzZSBcIm5vcm1hbFwiOlxuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0U2luZ2xlTGluZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRFbGxpcHNpemUobnVsbCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibm93cmFwXCI6XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRTaW5nbGVMaW5lKHRydWUpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0RWxsaXBzaXplKGFuZHJvaWQudGV4dC5UZXh0VXRpbHMuVHJ1bmNhdGVBdC5FTkQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmdldFRleHRDb2xvcnMoKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICghdGhpcy5mb3JtYXR0ZWRUZXh0IHx8ICEodmFsdWUgaW5zdGFuY2VvZiB0ZXh0X2Jhc2VfY29tbW9uXzEuQ29sb3IpKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiB0ZXh0X2Jhc2VfY29tbW9uXzEuQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldFRleHRDb2xvcih2YWx1ZS5hbmRyb2lkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0VGV4dENvbG9yKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5mb250U2l6ZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4geyBuYXRpdmVTaXplOiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmdldFRleHRTaXplKCkgfTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEuZm9udFNpemVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICghdGhpcy5mb3JtYXR0ZWRUZXh0IHx8ICh0eXBlb2YgdmFsdWUgIT09IFwibnVtYmVyXCIpKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRUZXh0U2l6ZSh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldFRleHRTaXplKGFuZHJvaWQudXRpbC5UeXBlZFZhbHVlLkNPTVBMRVhfVU5JVF9QWCwgdmFsdWUubmF0aXZlU2l6ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEubGluZUhlaWdodFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5nZXRMaW5lU3BhY2luZ0V4dHJhKCkgLyB0ZXh0X2Jhc2VfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmxpbmVIZWlnaHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0TGluZVNwYWNpbmcodmFsdWUgKiB0ZXh0X2Jhc2VfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCksIDEpO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuZ2V0VHlwZWZhY2UoKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEuZm9udEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoIXRoaXMuZm9ybWF0dGVkVGV4dCB8fCAhKHZhbHVlIGluc3RhbmNlb2YgZm9udF8xLkZvbnQpKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldFR5cGVmYWNlKHZhbHVlIGluc3RhbmNlb2YgZm9udF8xLkZvbnQgPyB2YWx1ZS5nZXRBbmRyb2lkVHlwZWZhY2UoKSA6IHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS50ZXh0RGVjb3JhdGlvblByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYWludEZsYWdzID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5nZXRQYWludEZsYWdzKCk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnRleHREZWNvcmF0aW9uUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICBjYXNlIFwibm9uZVwiOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0UGFpbnRGbGFncygwKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ1bmRlcmxpbmVcIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldFBhaW50RmxhZ3MoYW5kcm9pZC5ncmFwaGljcy5QYWludC5VTkRFUkxJTkVfVEVYVF9GTEFHKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJsaW5lLXRocm91Z2hcIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldFBhaW50RmxhZ3MoYW5kcm9pZC5ncmFwaGljcy5QYWludC5TVFJJS0VfVEhSVV9URVhUX0ZMQUcpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInVuZGVybGluZSBsaW5lLXRocm91Z2hcIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldFBhaW50RmxhZ3MoYW5kcm9pZC5ncmFwaGljcy5QYWludC5VTkRFUkxJTkVfVEVYVF9GTEFHIHwgYW5kcm9pZC5ncmFwaGljcy5QYWludC5TVFJJS0VfVEhSVV9URVhUX0ZMQUcpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldFBhaW50RmxhZ3ModmFsdWUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmxldHRlclNwYWNpbmdQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLmdldExldHRlcnNwYWNpbmcodGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZCk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmxldHRlclNwYWNpbmdQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldExldHRlcnNwYWNpbmcodGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZCwgdmFsdWUpO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5wYWRkaW5nVG9wUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IHZhbHVlOiB0aGlzLl9kZWZhdWx0UGFkZGluZ1RvcCwgdW5pdDogXCJweFwiIH07XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnBhZGRpbmdUb3BQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldFBhZGRpbmdUb3AodGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZCwgdGV4dF9iYXNlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgMCkgKyB0ZXh0X2Jhc2VfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHRoaXMuc3R5bGUuYm9yZGVyVG9wV2lkdGgsIDApKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEucGFkZGluZ1JpZ2h0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IHZhbHVlOiB0aGlzLl9kZWZhdWx0UGFkZGluZ1JpZ2h0LCB1bml0OiBcInB4XCIgfTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEucGFkZGluZ1JpZ2h0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRQYWRkaW5nUmlnaHQodGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZCwgdGV4dF9iYXNlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgMCkgKyB0ZXh0X2Jhc2VfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHRoaXMuc3R5bGUuYm9yZGVyUmlnaHRXaWR0aCwgMCkpO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5wYWRkaW5nQm90dG9tUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IHZhbHVlOiB0aGlzLl9kZWZhdWx0UGFkZGluZ0JvdHRvbSwgdW5pdDogXCJweFwiIH07XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldFBhZGRpbmdCb3R0b20odGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZCwgdGV4dF9iYXNlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgMCkgKyB0ZXh0X2Jhc2VfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tV2lkdGgsIDApKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEucGFkZGluZ0xlZnRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHRoaXMuX2RlZmF1bHRQYWRkaW5nTGVmdCwgdW5pdDogXCJweFwiIH07XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRQYWRkaW5nTGVmdCh0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLCB0ZXh0X2Jhc2VfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHZhbHVlLCAwKSArIHRleHRfYmFzZV9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModGhpcy5zdHlsZS5ib3JkZXJMZWZ0V2lkdGgsIDApKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZS5fc2V0TmF0aXZlVGV4dCA9IGZ1bmN0aW9uIChyZXNldCkge1xuICAgICAgICBpZiAocmVzZXQgPT09IHZvaWQgMCkgeyByZXNldCA9IGZhbHNlOyB9XG4gICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRUZXh0KG51bGwpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0cmFuc2Zvcm1lZFRleHQ7XG4gICAgICAgIGlmICh0aGlzLmZvcm1hdHRlZFRleHQpIHtcbiAgICAgICAgICAgIHRyYW5zZm9ybWVkVGV4dCA9IGNyZWF0ZVNwYW5uYWJsZVN0cmluZ0J1aWxkZXIodGhpcy5mb3JtYXR0ZWRUZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciB0ZXh0ID0gdGhpcy50ZXh0O1xuICAgICAgICAgICAgdmFyIHN0cmluZ1ZhbHVlID0gKHRleHQgPT09IG51bGwgfHwgdGV4dCA9PT0gdW5kZWZpbmVkKSA/IFwiXCIgOiB0ZXh0LnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB0cmFuc2Zvcm1lZFRleHQgPSBnZXRUcmFuc2Zvcm1lZFRleHQoc3RyaW5nVmFsdWUsIHRoaXMudGV4dFRyYW5zZm9ybSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRUZXh0KHRyYW5zZm9ybWVkVGV4dCk7XG4gICAgfTtcbiAgICByZXR1cm4gVGV4dEJhc2U7XG59KHRleHRfYmFzZV9jb21tb25fMS5UZXh0QmFzZUNvbW1vbikpO1xuZXhwb3J0cy5UZXh0QmFzZSA9IFRleHRCYXNlO1xuZnVuY3Rpb24gZ2V0Q2FwaXRhbGl6ZWRTdHJpbmcoc3RyKSB7XG4gICAgdmFyIHdvcmRzID0gc3RyLnNwbGl0KFwiIFwiKTtcbiAgICB2YXIgbmV3V29yZHMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSB3b3Jkcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgIHZhciB3b3JkID0gd29yZHNbaV0udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgbmV3V29yZHMucHVzaCh3b3JkLnN1YnN0cigwLCAxKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zdWJzdHJpbmcoMSkpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3V29yZHMuam9pbihcIiBcIik7XG59XG5mdW5jdGlvbiBnZXRUcmFuc2Zvcm1lZFRleHQodGV4dCwgdGV4dFRyYW5zZm9ybSkge1xuICAgIGlmICghdGV4dCB8fCAhdHlwZXNfMS5pc1N0cmluZyh0ZXh0KSkge1xuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG4gICAgc3dpdGNoICh0ZXh0VHJhbnNmb3JtKSB7XG4gICAgICAgIGNhc2UgXCJ1cHBlcmNhc2VcIjpcbiAgICAgICAgICAgIHJldHVybiB0ZXh0LnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIGNhc2UgXCJsb3dlcmNhc2VcIjpcbiAgICAgICAgICAgIHJldHVybiB0ZXh0LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGNhc2UgXCJjYXBpdGFsaXplXCI6XG4gICAgICAgICAgICByZXR1cm4gZ2V0Q2FwaXRhbGl6ZWRTdHJpbmcodGV4dCk7XG4gICAgICAgIGNhc2UgXCJub25lXCI6XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gdGV4dDtcbiAgICB9XG59XG5leHBvcnRzLmdldFRyYW5zZm9ybWVkVGV4dCA9IGdldFRyYW5zZm9ybWVkVGV4dDtcbmZ1bmN0aW9uIGNyZWF0ZVNwYW5uYWJsZVN0cmluZ0J1aWxkZXIoZm9ybWF0dGVkU3RyaW5nKSB7XG4gICAgaWYgKCFmb3JtYXR0ZWRTdHJpbmcgfHwgIWZvcm1hdHRlZFN0cmluZy5wYXJlbnQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBzc2IgPSBuZXcgYW5kcm9pZC50ZXh0LlNwYW5uYWJsZVN0cmluZ0J1aWxkZXIoKTtcbiAgICBmb3IgKHZhciBpID0gMCwgc3BhblN0YXJ0ID0gMCwgc3Bhbkxlbmd0aCA9IDAsIGxlbmd0aF8yID0gZm9ybWF0dGVkU3RyaW5nLnNwYW5zLmxlbmd0aDsgaSA8IGxlbmd0aF8yOyBpKyspIHtcbiAgICAgICAgdmFyIHNwYW4gPSBmb3JtYXR0ZWRTdHJpbmcuc3BhbnMuZ2V0SXRlbShpKTtcbiAgICAgICAgdmFyIHRleHQgPSBzcGFuLnRleHQ7XG4gICAgICAgIHZhciB0ZXh0VHJhbnNmb3JtID0gZm9ybWF0dGVkU3RyaW5nLnBhcmVudC50ZXh0VHJhbnNmb3JtO1xuICAgICAgICB2YXIgc3BhblRleHQgPSAodGV4dCA9PT0gbnVsbCB8fCB0ZXh0ID09PSB1bmRlZmluZWQpID8gXCJcIiA6IHRleHQudG9TdHJpbmcoKTtcbiAgICAgICAgaWYgKHRleHRUcmFuc2Zvcm0gJiYgdGV4dFRyYW5zZm9ybSAhPT0gXCJub25lXCIpIHtcbiAgICAgICAgICAgIHNwYW5UZXh0ID0gZ2V0VHJhbnNmb3JtZWRUZXh0KHNwYW5UZXh0LCB0ZXh0VHJhbnNmb3JtKTtcbiAgICAgICAgfVxuICAgICAgICBzcGFuTGVuZ3RoID0gc3BhblRleHQubGVuZ3RoO1xuICAgICAgICBpZiAoc3Bhbkxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHNzYi5pbnNlcnQoc3BhblN0YXJ0LCBzcGFuVGV4dCk7XG4gICAgICAgICAgICBzZXRTcGFuTW9kaWZpZXJzKHNzYiwgc3Bhbiwgc3BhblN0YXJ0LCBzcGFuU3RhcnQgKyBzcGFuTGVuZ3RoKTtcbiAgICAgICAgICAgIHNwYW5TdGFydCArPSBzcGFuTGVuZ3RoO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzc2I7XG59XG5mdW5jdGlvbiBzZXRTcGFuTW9kaWZpZXJzKHNzYiwgc3Bhbiwgc3RhcnQsIGVuZCkge1xuICAgIHZhciBzcGFuU3R5bGUgPSBzcGFuLnN0eWxlO1xuICAgIHZhciBib2xkID0gdGV4dF9iYXNlX2NvbW1vbl8xLmlzQm9sZChzcGFuU3R5bGUuZm9udFdlaWdodCk7XG4gICAgdmFyIGl0YWxpYyA9IHNwYW5TdHlsZS5mb250U3R5bGUgPT09IFwiaXRhbGljXCI7XG4gICAgaWYgKGJvbGQgJiYgaXRhbGljKSB7XG4gICAgICAgIHNzYi5zZXRTcGFuKG5ldyBhbmRyb2lkLnRleHQuc3R5bGUuU3R5bGVTcGFuKGFuZHJvaWQuZ3JhcGhpY3MuVHlwZWZhY2UuQk9MRF9JVEFMSUMpLCBzdGFydCwgZW5kLCBhbmRyb2lkLnRleHQuU3Bhbm5lZC5TUEFOX0VYQ0xVU0lWRV9FWENMVVNJVkUpO1xuICAgIH1cbiAgICBlbHNlIGlmIChib2xkKSB7XG4gICAgICAgIHNzYi5zZXRTcGFuKG5ldyBhbmRyb2lkLnRleHQuc3R5bGUuU3R5bGVTcGFuKGFuZHJvaWQuZ3JhcGhpY3MuVHlwZWZhY2UuQk9MRCksIHN0YXJ0LCBlbmQsIGFuZHJvaWQudGV4dC5TcGFubmVkLlNQQU5fRVhDTFVTSVZFX0VYQ0xVU0lWRSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGl0YWxpYykge1xuICAgICAgICBzc2Iuc2V0U3BhbihuZXcgYW5kcm9pZC50ZXh0LnN0eWxlLlN0eWxlU3BhbihhbmRyb2lkLmdyYXBoaWNzLlR5cGVmYWNlLklUQUxJQyksIHN0YXJ0LCBlbmQsIGFuZHJvaWQudGV4dC5TcGFubmVkLlNQQU5fRVhDTFVTSVZFX0VYQ0xVU0lWRSk7XG4gICAgfVxuICAgIHZhciBmb250RmFtaWx5ID0gc3Bhbi5mb250RmFtaWx5O1xuICAgIGlmIChmb250RmFtaWx5KSB7XG4gICAgICAgIHZhciBmb250ID0gbmV3IGZvbnRfMS5Gb250KGZvbnRGYW1pbHksIDAsIChpdGFsaWMpID8gXCJpdGFsaWNcIiA6IFwibm9ybWFsXCIsIChib2xkKSA/IFwiYm9sZFwiIDogXCJub3JtYWxcIik7XG4gICAgICAgIHZhciB0eXBlZmFjZSA9IGZvbnQuZ2V0QW5kcm9pZFR5cGVmYWNlKCkgfHwgYW5kcm9pZC5ncmFwaGljcy5UeXBlZmFjZS5jcmVhdGUoZm9udEZhbWlseSwgMCk7XG4gICAgICAgIHZhciB0eXBlZmFjZVNwYW4gPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkN1c3RvbVR5cGVmYWNlU3Bhbihmb250RmFtaWx5LCB0eXBlZmFjZSk7XG4gICAgICAgIHNzYi5zZXRTcGFuKHR5cGVmYWNlU3Bhbiwgc3RhcnQsIGVuZCwgYW5kcm9pZC50ZXh0LlNwYW5uZWQuU1BBTl9FWENMVVNJVkVfRVhDTFVTSVZFKTtcbiAgICB9XG4gICAgdmFyIHJlYWxGb250U2l6ZSA9IHNwYW4uZm9udFNpemU7XG4gICAgaWYgKHJlYWxGb250U2l6ZSkge1xuICAgICAgICBzc2Iuc2V0U3BhbihuZXcgYW5kcm9pZC50ZXh0LnN0eWxlLkFic29sdXRlU2l6ZVNwYW4ocmVhbEZvbnRTaXplICogdGV4dF9iYXNlX2NvbW1vbl8xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpKSwgc3RhcnQsIGVuZCwgYW5kcm9pZC50ZXh0LlNwYW5uZWQuU1BBTl9FWENMVVNJVkVfRVhDTFVTSVZFKTtcbiAgICB9XG4gICAgdmFyIGNvbG9yID0gc3Bhbi5jb2xvcjtcbiAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgc3NiLnNldFNwYW4obmV3IGFuZHJvaWQudGV4dC5zdHlsZS5Gb3JlZ3JvdW5kQ29sb3JTcGFuKGNvbG9yLmFuZHJvaWQpLCBzdGFydCwgZW5kLCBhbmRyb2lkLnRleHQuU3Bhbm5lZC5TUEFOX0VYQ0xVU0lWRV9FWENMVVNJVkUpO1xuICAgIH1cbiAgICB2YXIgYmFja2dyb3VuZENvbG9yO1xuICAgIGlmIChzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuaXNTZXQoc3BhblN0eWxlKSkge1xuICAgICAgICBiYWNrZ3JvdW5kQ29sb3IgPSBzcGFuU3R5bGUuYmFja2dyb3VuZENvbG9yO1xuICAgIH1cbiAgICBlbHNlIGlmIChzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuaXNTZXQoc3Bhbi5wYXJlbnQuc3R5bGUpKSB7XG4gICAgICAgIGJhY2tncm91bmRDb2xvciA9IHNwYW4ucGFyZW50LnN0eWxlLmJhY2tncm91bmRDb2xvcjtcbiAgICB9XG4gICAgZWxzZSBpZiAoc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmlzU2V0KHNwYW4ucGFyZW50LnBhcmVudC5zdHlsZSkpIHtcbiAgICAgICAgYmFja2dyb3VuZENvbG9yID0gc3Bhbi5wYXJlbnQucGFyZW50LnN0eWxlLmJhY2tncm91bmRDb2xvcjtcbiAgICB9XG4gICAgaWYgKGJhY2tncm91bmRDb2xvcikge1xuICAgICAgICBzc2Iuc2V0U3BhbihuZXcgYW5kcm9pZC50ZXh0LnN0eWxlLkJhY2tncm91bmRDb2xvclNwYW4oYmFja2dyb3VuZENvbG9yLmFuZHJvaWQpLCBzdGFydCwgZW5kLCBhbmRyb2lkLnRleHQuU3Bhbm5lZC5TUEFOX0VYQ0xVU0lWRV9FWENMVVNJVkUpO1xuICAgIH1cbiAgICB2YXIgdmFsdWVTb3VyY2U7XG4gICAgaWYgKHRleHRfYmFzZV9jb21tb25fMS50ZXh0RGVjb3JhdGlvblByb3BlcnR5LmlzU2V0KHNwYW5TdHlsZSkpIHtcbiAgICAgICAgdmFsdWVTb3VyY2UgPSBzcGFuU3R5bGU7XG4gICAgfVxuICAgIGVsc2UgaWYgKHRleHRfYmFzZV9jb21tb25fMS50ZXh0RGVjb3JhdGlvblByb3BlcnR5LmlzU2V0KHNwYW4ucGFyZW50LnN0eWxlKSkge1xuICAgICAgICB2YWx1ZVNvdXJjZSA9IHNwYW4ucGFyZW50LnN0eWxlO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dERlY29yYXRpb25Qcm9wZXJ0eS5pc1NldChzcGFuLnBhcmVudC5wYXJlbnQuc3R5bGUpKSB7XG4gICAgICAgIHZhbHVlU291cmNlID0gc3Bhbi5wYXJlbnQucGFyZW50LnN0eWxlO1xuICAgIH1cbiAgICBpZiAodmFsdWVTb3VyY2UpIHtcbiAgICAgICAgdmFyIHRleHREZWNvcmF0aW9ucyA9IHZhbHVlU291cmNlLnRleHREZWNvcmF0aW9uO1xuICAgICAgICB2YXIgdW5kZXJsaW5lXzEgPSB0ZXh0RGVjb3JhdGlvbnMuaW5kZXhPZihcInVuZGVybGluZVwiKSAhPT0gLTE7XG4gICAgICAgIGlmICh1bmRlcmxpbmVfMSkge1xuICAgICAgICAgICAgc3NiLnNldFNwYW4obmV3IGFuZHJvaWQudGV4dC5zdHlsZS5VbmRlcmxpbmVTcGFuKCksIHN0YXJ0LCBlbmQsIGFuZHJvaWQudGV4dC5TcGFubmVkLlNQQU5fRVhDTFVTSVZFX0VYQ0xVU0lWRSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHN0cmlrZXRocm91Z2ggPSB0ZXh0RGVjb3JhdGlvbnMuaW5kZXhPZihcImxpbmUtdGhyb3VnaFwiKSAhPT0gLTE7XG4gICAgICAgIGlmIChzdHJpa2V0aHJvdWdoKSB7XG4gICAgICAgICAgICBzc2Iuc2V0U3BhbihuZXcgYW5kcm9pZC50ZXh0LnN0eWxlLlN0cmlrZXRocm91Z2hTcGFuKCksIHN0YXJ0LCBlbmQsIGFuZHJvaWQudGV4dC5TcGFubmVkLlNQQU5fRVhDTFVTSVZFX0VYQ0xVU0lWRSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD10ZXh0LWJhc2UuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGVkaXRhYmxlX3RleHRfYmFzZV8xID0gcmVxdWlyZShcIi4uL2VkaXRhYmxlLXRleHQtYmFzZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9lZGl0YWJsZS10ZXh0LWJhc2VcIikpO1xudmFyIFRleHRGaWVsZEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUZXh0RmllbGRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRleHRGaWVsZEJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGV4dEZpZWxkQmFzZS5yZXR1cm5QcmVzc0V2ZW50ID0gXCJyZXR1cm5QcmVzc1wiO1xuICAgIFRleHRGaWVsZEJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgZWRpdGFibGVfdGV4dF9iYXNlXzEuQ1NTVHlwZShcIlRleHRGaWVsZFwiKVxuICAgIF0sIFRleHRGaWVsZEJhc2UpO1xuICAgIHJldHVybiBUZXh0RmllbGRCYXNlO1xufShlZGl0YWJsZV90ZXh0X2Jhc2VfMS5FZGl0YWJsZVRleHRCYXNlKSk7XG5leHBvcnRzLlRleHRGaWVsZEJhc2UgPSBUZXh0RmllbGRCYXNlO1xuVGV4dEZpZWxkQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuc2VjdXJlUHJvcGVydHkgPSBuZXcgZWRpdGFibGVfdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcInNlY3VyZVwiLCBkZWZhdWx0VmFsdWU6IGZhbHNlLCB2YWx1ZUNvbnZlcnRlcjogZWRpdGFibGVfdGV4dF9iYXNlXzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuc2VjdXJlUHJvcGVydHkucmVnaXN0ZXIoVGV4dEZpZWxkQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10ZXh0LWZpZWxkLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRleHRfZmllbGRfY29tbW9uXzEgPSByZXF1aXJlKFwiLi90ZXh0LWZpZWxkLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3RleHQtZmllbGQtY29tbW9uXCIpKTtcbnZhciBUZXh0RmllbGQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUZXh0RmllbGQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGV4dEZpZWxkKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRleHRGaWVsZC5wcm90b3R5cGUuX2NvbmZpZ3VyZUVkaXRUZXh0ID0gZnVuY3Rpb24gKGVkaXRUZXh0KSB7XG4gICAgICAgIGVkaXRUZXh0LnNldElucHV0VHlwZShhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfVEVYVCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX1ZBUklBVElPTl9OT1JNQUwgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0NBUF9TRU5URU5DRVMgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX05PX1NVR0dFU1RJT05TKTtcbiAgICAgICAgZWRpdFRleHQuc2V0TGluZXMoMSk7XG4gICAgICAgIGVkaXRUZXh0LnNldE1heExpbmVzKDEpO1xuICAgICAgICBlZGl0VGV4dC5zZXRIb3Jpem9udGFsbHlTY3JvbGxpbmcodHJ1ZSk7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlLl9vblJldHVyblByZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5vdGlmeSh7IGV2ZW50TmFtZTogVGV4dEZpZWxkLnJldHVyblByZXNzRXZlbnQsIG9iamVjdDogdGhpcyB9KTtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5zZWN1cmVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNldFNlY3VyZUFuZEtleWJvYXJkVHlwZSgpO1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZVt0ZXh0X2ZpZWxkX2NvbW1vbl8xLmtleWJvYXJkVHlwZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2V0U2VjdXJlQW5kS2V5Ym9hcmRUeXBlKCk7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlLnNldFNlY3VyZUFuZEtleWJvYXJkVHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlucHV0VHlwZTtcbiAgICAgICAgaWYgKHRoaXMuc2VjdXJlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5rZXlib2FyZFR5cGUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfTlVNQkVSIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX05VTUJFUl9WQVJJQVRJT05fUEFTU1dPUkQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfVEVYVCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX1ZBUklBVElPTl9QQVNTV09SRDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlucHV0VHlwZSA9IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9DTEFTU19URVhUIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfVkFSSUFUSU9OX05PUk1BTDtcbiAgICAgICAgICAgIGlmICh0aGlzLmF1dG9jb3JyZWN0KSB7XG4gICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gaW5wdXRUeXBlIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19BVVRPX0NPTVBMRVRFO1xuICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGlucHV0VHlwZSB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQVVUT19DT1JSRUNUO1xuICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGlucHV0VHlwZSAmIH5hbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX05PX1NVR0dFU1RJT05TO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3dpdGNoICh0aGlzLmF1dG9jYXBpdGFsaXphdGlvblR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwid29yZHNcIjpcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gaW5wdXRUeXBlIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfV09SRFM7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJzZW50ZW5jZXNcIjpcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gaW5wdXRUeXBlIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfU0VOVEVOQ0VTO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiYWxsY2hhcmFjdGVyc1wiOlxuICAgICAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBpbnB1dFR5cGUgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0NBUF9DSEFSQUNURVJTO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5rZXlib2FyZFR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiZGF0ZXRpbWVcIjpcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX0RBVEVUSU1FIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0RBVEVUSU1FX1ZBUklBVElPTl9OT1JNQUw7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJwaG9uZVwiOlxuICAgICAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfUEhPTkU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJudW1iZXJcIjpcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX05VTUJFUiB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9OVU1CRVJfVkFSSUFUSU9OX05PUk1BTCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9OVU1CRVJfRkxBR19TSUdORUQgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfTlVNQkVSX0ZMQUdfREVDSU1BTDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInVybFwiOlxuICAgICAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfVEVYVCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX1ZBUklBVElPTl9VUkk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJlbWFpbFwiOlxuICAgICAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfVEVYVCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX1ZBUklBVElPTl9FTUFJTF9BRERSRVNTO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zZXRJbnB1dFR5cGUoaW5wdXRUeXBlKTtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS53aGl0ZVNwYWNlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcIm5vd3JhcFwiO1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZVt0ZXh0X2ZpZWxkX2NvbW1vbl8xLndoaXRlU3BhY2VQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICByZXR1cm4gVGV4dEZpZWxkO1xufSh0ZXh0X2ZpZWxkX2NvbW1vbl8xLlRleHRGaWVsZEJhc2UpKTtcbmV4cG9ydHMuVGV4dEZpZWxkID0gVGV4dEZpZWxkO1xuVGV4dEZpZWxkLnByb3RvdHlwZS5faXNTaW5nbGVMaW5lID0gdHJ1ZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRleHQtZmllbGQuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGVkaXRhYmxlX3RleHRfYmFzZV8xID0gcmVxdWlyZShcIi4uL2VkaXRhYmxlLXRleHQtYmFzZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIikpO1xudmFyIFRleHRWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGV4dFZpZXcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGV4dFZpZXcoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGV4dFZpZXcucHJvdG90eXBlLl9jb25maWd1cmVFZGl0VGV4dCA9IGZ1bmN0aW9uIChlZGl0VGV4dCkge1xuICAgICAgICBlZGl0VGV4dC5zZXRJbnB1dFR5cGUoYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX1RFWFQgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9WQVJJQVRJT05fTk9STUFMIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfU0VOVEVOQ0VTIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19NVUxUSV9MSU5FIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19OT19TVUdHRVNUSU9OUyk7XG4gICAgICAgIGVkaXRUZXh0LnNldEdyYXZpdHkoYW5kcm9pZC52aWV3LkdyYXZpdHkuVE9QIHwgYW5kcm9pZC52aWV3LkdyYXZpdHkuU1RBUlQpO1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRHcmF2aXR5KGFuZHJvaWQudmlldy5HcmF2aXR5LlRPUCB8IGFuZHJvaWQudmlldy5HcmF2aXR5LlNUQVJUKTtcbiAgICB9O1xuICAgIFRleHRWaWV3ID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGVkaXRhYmxlX3RleHRfYmFzZV8xLkNTU1R5cGUoXCJUZXh0Vmlld1wiKVxuICAgIF0sIFRleHRWaWV3KTtcbiAgICByZXR1cm4gVGV4dFZpZXc7XG59KGVkaXRhYmxlX3RleHRfYmFzZV8xLkVkaXRhYmxlVGV4dEJhc2UpKTtcbmV4cG9ydHMuVGV4dFZpZXcgPSBUZXh0VmlldztcblRleHRWaWV3LnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGV4dC12aWV3LmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgZGF0ZUNvbXBhcmVyID0gZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuICh4IDw9IHkgJiYgeCA+PSB5KTsgfTtcbmZ1bmN0aW9uIGdldFZhbGlkVGltZShwaWNrZXIsIGhvdXIsIG1pbnV0ZSkge1xuICAgIGlmIChwaWNrZXIubWludXRlSW50ZXJ2YWwgPiAxKSB7XG4gICAgICAgIHZhciBtaW51dGVGbG9vciA9IG1pbnV0ZSAtIChtaW51dGUgJSBwaWNrZXIubWludXRlSW50ZXJ2YWwpO1xuICAgICAgICBtaW51dGUgPSBtaW51dGVGbG9vciArIChtaW51dGUgPT09IG1pbnV0ZUZsb29yICsgMSA/IHBpY2tlci5taW51dGVJbnRlcnZhbCA6IDApO1xuICAgICAgICBpZiAobWludXRlID09PSA2MCkge1xuICAgICAgICAgICAgaG91cisrO1xuICAgICAgICAgICAgbWludXRlID0gMDtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgdGltZSA9IHsgaG91cjogaG91ciwgbWludXRlOiBtaW51dGUgfTtcbiAgICBpZiAoIWlzTGVzc1RoYW5NYXhUaW1lKHBpY2tlciwgaG91ciwgbWludXRlKSkge1xuICAgICAgICB0aW1lID0geyBob3VyOiBwaWNrZXIubWF4SG91ciwgbWludXRlOiBwaWNrZXIubWF4TWludXRlIH07XG4gICAgfVxuICAgIGlmICghaXNHcmVhdGVyVGhhbk1pblRpbWUocGlja2VyLCBob3VyLCBtaW51dGUpKSB7XG4gICAgICAgIHRpbWUgPSB7IGhvdXI6IHBpY2tlci5taW5Ib3VyLCBtaW51dGU6IHBpY2tlci5taW5NaW51dGUgfTtcbiAgICB9XG4gICAgcmV0dXJuIHRpbWU7XG59XG5leHBvcnRzLmdldFZhbGlkVGltZSA9IGdldFZhbGlkVGltZTtcbmZ1bmN0aW9uIGlzVmFsaWRUaW1lKHBpY2tlcikge1xuICAgIHJldHVybiBpc0dyZWF0ZXJUaGFuTWluVGltZShwaWNrZXIpICYmIGlzTGVzc1RoYW5NYXhUaW1lKHBpY2tlcik7XG59XG5mdW5jdGlvbiBpc0hvdXJWYWxpZCh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIgJiYgdmFsdWUgPj0gMCAmJiB2YWx1ZSA8PSAyMztcbn1cbmZ1bmN0aW9uIGlzTWludXRlVmFsaWQodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiICYmIHZhbHVlID49IDAgJiYgdmFsdWUgPD0gNTk7XG59XG5mdW5jdGlvbiBpc01pbnV0ZUludGVydmFsVmFsaWQodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiICYmIHZhbHVlID49IDEgJiYgdmFsdWUgPD0gMzAgJiYgNjAgJSB2YWx1ZSA9PT0gMDtcbn1cbmZ1bmN0aW9uIGdldE1pbnV0ZXMoaG91cikge1xuICAgIHJldHVybiBob3VyICogNjA7XG59XG5mdW5jdGlvbiBpc0RlZmluZWQodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZDtcbn1cbmV4cG9ydHMuaXNEZWZpbmVkID0gaXNEZWZpbmVkO1xuZnVuY3Rpb24gaXNHcmVhdGVyVGhhbk1pblRpbWUocGlja2VyLCBob3VyLCBtaW51dGUpIHtcbiAgICBpZiAocGlja2VyLm1pbkhvdXIgPT09IHVuZGVmaW5lZCB8fCBwaWNrZXIubWluTWludXRlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBnZXRNaW51dGVzKGhvdXIgIT09IHVuZGVmaW5lZCA/IGhvdXIgOiBwaWNrZXIuaG91cikgKyAobWludXRlICE9PSB1bmRlZmluZWQgPyBtaW51dGUgOiBwaWNrZXIubWludXRlKSA+PSBnZXRNaW51dGVzKHBpY2tlci5taW5Ib3VyKSArIHBpY2tlci5taW5NaW51dGU7XG59XG5mdW5jdGlvbiBpc0xlc3NUaGFuTWF4VGltZShwaWNrZXIsIGhvdXIsIG1pbnV0ZSkge1xuICAgIGlmICghaXNEZWZpbmVkKHBpY2tlci5tYXhIb3VyKSB8fCAhaXNEZWZpbmVkKHBpY2tlci5tYXhNaW51dGUpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZ2V0TWludXRlcyhpc0RlZmluZWQoaG91cikgPyBob3VyIDogcGlja2VyLmhvdXIpICsgKGlzRGVmaW5lZChtaW51dGUpID8gbWludXRlIDogcGlja2VyLm1pbnV0ZSkgPD0gZ2V0TWludXRlcyhwaWNrZXIubWF4SG91cikgKyBwaWNrZXIubWF4TWludXRlO1xufVxuZnVuY3Rpb24gdG9TdHJpbmcodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSArIFwiXCI7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZSA8IDEwID8gXCIwXCIgKyB2YWx1ZSA6IFwiXCIgKyB2YWx1ZTtcbn1cbmZ1bmN0aW9uIGdldE1pbk1heFRpbWVFcnJvck1lc3NhZ2UocGlja2VyKSB7XG4gICAgcmV0dXJuIFwiTWluIHRpbWU6IChcIiArIHRvU3RyaW5nKHBpY2tlci5taW5Ib3VyKSArIFwiOlwiICsgdG9TdHJpbmcocGlja2VyLm1pbk1pbnV0ZSkgKyBcIiksIG1heCB0aW1lOiAoXCIgKyB0b1N0cmluZyhwaWNrZXIubWF4SG91cikgKyBcIjpcIiArIHRvU3RyaW5nKHBpY2tlci5tYXhNaW51dGUpICsgXCIpXCI7XG59XG5mdW5jdGlvbiBnZXRFcnJvck1lc3NhZ2UocGlja2VyLCBwcm9wZXJ0eU5hbWUsIG5ld1ZhbHVlKSB7XG4gICAgcmV0dXJuIHByb3BlcnR5TmFtZSArIFwiIHByb3BlcnR5IHZhbHVlIChcIiArIHRvU3RyaW5nKG5ld1ZhbHVlKSArIFwiOlwiICsgdG9TdHJpbmcocGlja2VyLm1pbnV0ZSkgKyBcIikgaXMgbm90IHZhbGlkLiBcIiArIGdldE1pbk1heFRpbWVFcnJvck1lc3NhZ2UocGlja2VyKSArIFwiLlwiO1xufVxudmFyIFRpbWVQaWNrZXJCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGltZVBpY2tlckJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGltZVBpY2tlckJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGltZVBpY2tlckJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJUaW1lUGlja2VyXCIpXG4gICAgXSwgVGltZVBpY2tlckJhc2UpO1xuICAgIHJldHVybiBUaW1lUGlja2VyQmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuVGltZVBpY2tlckJhc2UgPSBUaW1lUGlja2VyQmFzZTtcblRpbWVQaWNrZXJCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy5taW5Ib3VyUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1pbkhvdXJcIiwgZGVmYXVsdFZhbHVlOiAwLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uIChwaWNrZXIsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAoIWlzSG91clZhbGlkKG5ld1ZhbHVlKSB8fCAhaXNWYWxpZFRpbWUocGlja2VyKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGdldEVycm9yTWVzc2FnZShwaWNrZXIsIFwibWluSG91clwiLCBuZXdWYWx1ZSkpO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLm1pbkhvdXJQcm9wZXJ0eS5yZWdpc3RlcihUaW1lUGlja2VyQmFzZSk7XG5leHBvcnRzLm1heEhvdXJQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWF4SG91clwiLCBkZWZhdWx0VmFsdWU6IDIzLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uIChwaWNrZXIsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAoIWlzSG91clZhbGlkKG5ld1ZhbHVlKSB8fCAhaXNWYWxpZFRpbWUocGlja2VyKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGdldEVycm9yTWVzc2FnZShwaWNrZXIsIFwibWF4SG91clwiLCBuZXdWYWx1ZSkpO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLm1heEhvdXJQcm9wZXJ0eS5yZWdpc3RlcihUaW1lUGlja2VyQmFzZSk7XG5leHBvcnRzLm1pbk1pbnV0ZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtaW5NaW51dGVcIiwgZGVmYXVsdFZhbHVlOiAwLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uIChwaWNrZXIsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAoIWlzTWludXRlVmFsaWQobmV3VmFsdWUpIHx8ICFpc1ZhbGlkVGltZShwaWNrZXIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZ2V0RXJyb3JNZXNzYWdlKHBpY2tlciwgXCJtaW5NaW51dGVcIiwgbmV3VmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5taW5NaW51dGVQcm9wZXJ0eS5yZWdpc3RlcihUaW1lUGlja2VyQmFzZSk7XG5leHBvcnRzLm1heE1pbnV0ZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtYXhNaW51dGVcIiwgZGVmYXVsdFZhbHVlOiA1OSwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAocGlja2VyLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKCFpc01pbnV0ZVZhbGlkKG5ld1ZhbHVlKSB8fCAhaXNWYWxpZFRpbWUocGlja2VyKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGdldEVycm9yTWVzc2FnZShwaWNrZXIsIFwibWF4TWludXRlXCIsIG5ld1ZhbHVlKSk7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMubWF4TWludXRlUHJvcGVydHkucmVnaXN0ZXIoVGltZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5taW51dGVJbnRlcnZhbFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtaW51dGVJbnRlcnZhbFwiLCBkZWZhdWx0VmFsdWU6IDEsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHBpY2tlciwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICghaXNNaW51dGVJbnRlcnZhbFZhbGlkKG5ld1ZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGdldEVycm9yTWVzc2FnZShwaWNrZXIsIFwibWludXRlSW50ZXJ2YWxcIiwgbmV3VmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5taW51dGVJbnRlcnZhbFByb3BlcnR5LnJlZ2lzdGVyKFRpbWVQaWNrZXJCYXNlKTtcbmV4cG9ydHMubWludXRlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1pbnV0ZVwiLCBkZWZhdWx0VmFsdWU6IDAsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHBpY2tlciwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICghaXNNaW51dGVWYWxpZChuZXdWYWx1ZSkgfHwgIWlzVmFsaWRUaW1lKHBpY2tlcikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihnZXRFcnJvck1lc3NhZ2UocGlja2VyLCBcIm1pbnV0ZVwiLCBuZXdWYWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIHBpY2tlci50aW1lID0gbmV3IERhdGUoMCwgMCwgMCwgcGlja2VyLmhvdXIsIHBpY2tlci5taW51dGUpO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5taW51dGVQcm9wZXJ0eS5yZWdpc3RlcihUaW1lUGlja2VyQmFzZSk7XG5leHBvcnRzLmhvdXJQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaG91clwiLCBkZWZhdWx0VmFsdWU6IDAsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHBpY2tlciwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICghaXNIb3VyVmFsaWQobmV3VmFsdWUpIHx8ICFpc1ZhbGlkVGltZShwaWNrZXIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZ2V0RXJyb3JNZXNzYWdlKHBpY2tlciwgXCJIb3VyXCIsIG5ld1ZhbHVlKSk7XG4gICAgICAgIH1cbiAgICAgICAgcGlja2VyLnRpbWUgPSBuZXcgRGF0ZSgwLCAwLCAwLCBwaWNrZXIuaG91ciwgcGlja2VyLm1pbnV0ZSk7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLmhvdXJQcm9wZXJ0eS5yZWdpc3RlcihUaW1lUGlja2VyQmFzZSk7XG5leHBvcnRzLnRpbWVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidGltZVwiLCBkZWZhdWx0VmFsdWU6IG5ldyBEYXRlKCksIGVxdWFsaXR5Q29tcGFyZXI6IGRhdGVDb21wYXJlcixcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uIChwaWNrZXIsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAoIWlzVmFsaWRUaW1lKHBpY2tlcikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihnZXRFcnJvck1lc3NhZ2UocGlja2VyLCBcInRpbWVcIiwgbmV3VmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBwaWNrZXIuaG91ciA9IG5ld1ZhbHVlLmdldEhvdXJzKCk7XG4gICAgICAgIHBpY2tlci5taW51dGUgPSBuZXdWYWx1ZS5nZXRNaW51dGVzKCk7XG4gICAgfVxufSk7XG5leHBvcnRzLnRpbWVQcm9wZXJ0eS5yZWdpc3RlcihUaW1lUGlja2VyQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10aW1lLXBpY2tlci1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0aW1lX3BpY2tlcl9jb21tb25fMSA9IHJlcXVpcmUoXCIuL3RpbWUtcGlja2VyLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3RpbWUtcGlja2VyLWNvbW1vblwiKSk7XG52YXIgVGltZUNoYW5nZWRMaXN0ZW5lcjtcbmZ1bmN0aW9uIGluaXRpYWxpemVUaW1lQ2hhbmdlZExpc3RlbmVyKCkge1xuICAgIGlmIChUaW1lQ2hhbmdlZExpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYXBpTGV2ZWwgPSBhbmRyb2lkLm9zLkJ1aWxkLlZFUlNJT04uU0RLX0lOVDtcbiAgICB2YXIgVGltZUNoYW5nZWRMaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoVGltZUNoYW5nZWRMaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFRpbWVDaGFuZ2VkTGlzdGVuZXJJbXBsKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFRpbWVDaGFuZ2VkTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblRpbWVDaGFuZ2VkID0gZnVuY3Rpb24gKHBpY2tlciwgaG91ciwgbWludXRlKSB7XG4gICAgICAgICAgICB2YXIgdGltZVBpY2tlciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAodGltZVBpY2tlci51cGRhdGluZ05hdGl2ZVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZhbGlkVGltZSA9IHRpbWVfcGlja2VyX2NvbW1vbl8xLmdldFZhbGlkVGltZSh0aW1lUGlja2VyLCBob3VyLCBtaW51dGUpO1xuICAgICAgICAgICAgdGltZV9waWNrZXJfY29tbW9uXzEudGltZVByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKHRpbWVQaWNrZXIsIG5ldyBEYXRlKDAsIDAsIDAsIHZhbGlkVGltZS5ob3VyLCB2YWxpZFRpbWUubWludXRlKSk7XG4gICAgICAgIH07XG4gICAgICAgIFRpbWVDaGFuZ2VkTGlzdGVuZXJJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLndpZGdldC5UaW1lUGlja2VyLk9uVGltZUNoYW5nZWRMaXN0ZW5lcl0pXG4gICAgICAgIF0sIFRpbWVDaGFuZ2VkTGlzdGVuZXJJbXBsKTtcbiAgICAgICAgcmV0dXJuIFRpbWVDaGFuZ2VkTGlzdGVuZXJJbXBsO1xuICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgIFRpbWVDaGFuZ2VkTGlzdGVuZXIgPSBUaW1lQ2hhbmdlZExpc3RlbmVySW1wbDtcbn1cbnZhciBhcGlMZXZlbDtcbnZhciBUaW1lUGlja2VyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGltZVBpY2tlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUaW1lUGlja2VyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRpbWVQaWNrZXIucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgYW5kcm9pZC53aWRnZXQuVGltZVBpY2tlcih0aGlzLl9jb250ZXh0KTtcbiAgICB9O1xuICAgIFRpbWVQaWNrZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpbml0aWFsaXplVGltZUNoYW5nZWRMaXN0ZW5lcigpO1xuICAgICAgICB2YXIgbGlzdGVuZXIgPSBuZXcgVGltZUNoYW5nZWRMaXN0ZW5lcih0aGlzKTtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRPblRpbWVDaGFuZ2VkTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgICAgICBuYXRpdmVWaWV3Lmxpc3RlbmVyID0gbGlzdGVuZXI7XG4gICAgICAgIHZhciBjYWxlbmRhciA9IG5hdGl2ZVZpZXcuY2FsZW5kYXIgPSBqYXZhLnV0aWwuQ2FsZW5kYXIuZ2V0SW5zdGFuY2UoKTtcbiAgICAgICAgdmFyIGhvdXIgPSB0aW1lX3BpY2tlcl9jb21tb25fMS5ob3VyUHJvcGVydHkuaXNTZXQodGhpcykgPyB0aGlzLmhvdXIgOiBjYWxlbmRhci5nZXQoamF2YS51dGlsLkNhbGVuZGFyLkhPVVJfT0ZfREFZKTtcbiAgICAgICAgdmFyIG1pbnV0ZSA9IHRpbWVfcGlja2VyX2NvbW1vbl8xLm1pbnV0ZVByb3BlcnR5LmlzU2V0KHRoaXMpID8gdGhpcy5taW51dGUgOiBjYWxlbmRhci5nZXQoamF2YS51dGlsLkNhbGVuZGFyLk1JTlVURSk7XG4gICAgICAgIHZhciB2YWxpZFRpbWUgPSB0aW1lX3BpY2tlcl9jb21tb25fMS5nZXRWYWxpZFRpbWUodGhpcywgaG91ciwgbWludXRlKTtcbiAgICAgICAgaWYgKCF0aW1lX3BpY2tlcl9jb21tb25fMS50aW1lUHJvcGVydHkuaXNTZXQodGhpcykpIHtcbiAgICAgICAgICAgIHRoaXMudGltZSA9IG5ldyBEYXRlKDAsIDAsIDAsIHZhbGlkVGltZS5ob3VyLCB2YWxpZFRpbWUubWludXRlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGltZVBpY2tlci5wcm90b3R5cGVbdGltZV9waWNrZXJfY29tbW9uXzEubWludXRlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnVwZGF0aW5nTmF0aXZlVmFsdWUgPSB0cnVlO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKGFwaUxldmVsID49IDIzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldE1pbnV0ZSh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0Q3VycmVudE1pbnV0ZShuZXcgamF2YS5sYW5nLkludGVnZXIodmFsdWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRpbmdOYXRpdmVWYWx1ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUaW1lUGlja2VyLnByb3RvdHlwZVt0aW1lX3BpY2tlcl9jb21tb25fMS5ob3VyUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnVwZGF0aW5nTmF0aXZlVmFsdWUgPSB0cnVlO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKGFwaUxldmVsID49IDIzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEhvdXIodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEN1cnJlbnRIb3VyKG5ldyBqYXZhLmxhbmcuSW50ZWdlcih2YWx1ZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGluZ05hdGl2ZVZhbHVlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBUaW1lUGlja2VyO1xufSh0aW1lX3BpY2tlcl9jb21tb25fMS5UaW1lUGlja2VyQmFzZSkpO1xuZXhwb3J0cy5UaW1lUGlja2VyID0gVGltZVBpY2tlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRpbWUtcGlja2VyLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRyYW5zaXRpb25fMSA9IHJlcXVpcmUoXCIuL3RyYW5zaXRpb25cIik7XG52YXIgRmFkZVRyYW5zaXRpb24gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGYWRlVHJhbnNpdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBGYWRlVHJhbnNpdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBGYWRlVHJhbnNpdGlvbi5wcm90b3R5cGUuY3JlYXRlQW5kcm9pZEFuaW1hdG9yID0gZnVuY3Rpb24gKHRyYW5zaXRpb25UeXBlKSB7XG4gICAgICAgIHZhciBhbHBoYVZhbHVlcyA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDIpO1xuICAgICAgICBzd2l0Y2ggKHRyYW5zaXRpb25UeXBlKSB7XG4gICAgICAgICAgICBjYXNlIHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZW50ZXI6XG4gICAgICAgICAgICBjYXNlIHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUucG9wRW50ZXI6XG4gICAgICAgICAgICAgICAgYWxwaGFWYWx1ZXNbMF0gPSAwO1xuICAgICAgICAgICAgICAgIGFscGhhVmFsdWVzWzFdID0gMTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbl8xLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5leGl0OlxuICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLnBvcEV4aXQ6XG4gICAgICAgICAgICAgICAgYWxwaGFWYWx1ZXNbMF0gPSAxO1xuICAgICAgICAgICAgICAgIGFscGhhVmFsdWVzWzFdID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgYW5pbWF0b3IgPSBhbmRyb2lkLmFuaW1hdGlvbi5PYmplY3RBbmltYXRvci5vZkZsb2F0KG51bGwsIFwiYWxwaGFcIiwgYWxwaGFWYWx1ZXMpO1xuICAgICAgICB2YXIgZHVyYXRpb24gPSB0aGlzLmdldER1cmF0aW9uKCk7XG4gICAgICAgIGlmIChkdXJhdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBhbmltYXRvci5zZXREdXJhdGlvbihkdXJhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgYW5pbWF0b3Iuc2V0SW50ZXJwb2xhdG9yKHRoaXMuZ2V0Q3VydmUoKSk7XG4gICAgICAgIHJldHVybiBhbmltYXRvcjtcbiAgICB9O1xuICAgIHJldHVybiBGYWRlVHJhbnNpdGlvbjtcbn0odHJhbnNpdGlvbl8xLlRyYW5zaXRpb24pKTtcbmV4cG9ydHMuRmFkZVRyYW5zaXRpb24gPSBGYWRlVHJhbnNpdGlvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZhZGUtdHJhbnNpdGlvbi5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0cmFuc2l0aW9uXzEgPSByZXF1aXJlKFwiLi90cmFuc2l0aW9uXCIpO1xudmFyIEZsaXBUcmFuc2l0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRmxpcFRyYW5zaXRpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRmxpcFRyYW5zaXRpb24oZGlyZWN0aW9uLCBkdXJhdGlvbiwgY3VydmUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZHVyYXRpb24sIGN1cnZlKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fZGlyZWN0aW9uID0gZGlyZWN0aW9uO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEZsaXBUcmFuc2l0aW9uLnByb3RvdHlwZS5jcmVhdGVBbmRyb2lkQW5pbWF0b3IgPSBmdW5jdGlvbiAodHJhbnNpdGlvblR5cGUpIHtcbiAgICAgICAgdmFyIG9iamVjdEFuaW1hdG9ycztcbiAgICAgICAgdmFyIHZhbHVlcztcbiAgICAgICAgdmFyIGFuaW1hdG9yO1xuICAgICAgICB2YXIgYW5pbWF0b3JTZXQgPSBuZXcgYW5kcm9pZC5hbmltYXRpb24uQW5pbWF0b3JTZXQoKTtcbiAgICAgICAgdmFyIGZ1bGxEdXJhdGlvbiA9IHRoaXMuZ2V0RHVyYXRpb24oKSB8fCAzMDA7XG4gICAgICAgIHZhciBpbnRlcnBvbGF0b3IgPSB0aGlzLmdldEN1cnZlKCk7XG4gICAgICAgIHZhciByb3RhdGlvblkgPSB0aGlzLl9kaXJlY3Rpb24gPT09IFwicmlnaHRcIiA/IDE4MCA6IC0xODA7XG4gICAgICAgIHN3aXRjaCAodHJhbnNpdGlvblR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbl8xLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5lbnRlcjpcbiAgICAgICAgICAgICAgICBvYmplY3RBbmltYXRvcnMgPSBBcnJheS5jcmVhdGUoYW5kcm9pZC5hbmltYXRpb24uQW5pbWF0b3IsIDMpO1xuICAgICAgICAgICAgICAgIHZhbHVlcyA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDIpO1xuICAgICAgICAgICAgICAgIHZhbHVlc1swXSA9IDEuMDtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMV0gPSAwLjA7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3IgPSBhbmRyb2lkLmFuaW1hdGlvbi5PYmplY3RBbmltYXRvci5vZkZsb2F0KG51bGwsIFwiYWxwaGFcIiwgdmFsdWVzKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5zZXREdXJhdGlvbigwKTtcbiAgICAgICAgICAgICAgICBvYmplY3RBbmltYXRvcnNbMF0gPSBhbmltYXRvcjtcbiAgICAgICAgICAgICAgICB2YWx1ZXMgPSBBcnJheS5jcmVhdGUoXCJmbG9hdFwiLCAyKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMF0gPSByb3RhdGlvblk7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzFdID0gMC4wO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yID0gYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChudWxsLCBcInJvdGF0aW9uWVwiLCB2YWx1ZXMpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldEludGVycG9sYXRvcihpbnRlcnBvbGF0b3IpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldER1cmF0aW9uKGZ1bGxEdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgb2JqZWN0QW5pbWF0b3JzWzFdID0gYW5pbWF0b3I7XG4gICAgICAgICAgICAgICAgdmFsdWVzID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMik7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzBdID0gMC4wO1xuICAgICAgICAgICAgICAgIHZhbHVlc1sxXSA9IDEuMDtcbiAgICAgICAgICAgICAgICBhbmltYXRvciA9IGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yLm9mRmxvYXQobnVsbCwgXCJhbHBoYVwiLCB2YWx1ZXMpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldFN0YXJ0RGVsYXkoZnVsbER1cmF0aW9uIC8gMik7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3Iuc2V0RHVyYXRpb24oMSk7XG4gICAgICAgICAgICAgICAgb2JqZWN0QW5pbWF0b3JzWzJdID0gYW5pbWF0b3I7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZXhpdDpcbiAgICAgICAgICAgICAgICBvYmplY3RBbmltYXRvcnMgPSBBcnJheS5jcmVhdGUoYW5kcm9pZC5hbmltYXRpb24uQW5pbWF0b3IsIDIpO1xuICAgICAgICAgICAgICAgIHZhbHVlcyA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDIpO1xuICAgICAgICAgICAgICAgIHZhbHVlc1swXSA9IDAuMDtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMV0gPSAtcm90YXRpb25ZO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yID0gYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChudWxsLCBcInJvdGF0aW9uWVwiLCB2YWx1ZXMpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldEludGVycG9sYXRvcihpbnRlcnBvbGF0b3IpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldER1cmF0aW9uKGZ1bGxEdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgb2JqZWN0QW5pbWF0b3JzWzBdID0gYW5pbWF0b3I7XG4gICAgICAgICAgICAgICAgdmFsdWVzID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMik7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzBdID0gMS4wO1xuICAgICAgICAgICAgICAgIHZhbHVlc1sxXSA9IDAuMDtcbiAgICAgICAgICAgICAgICBhbmltYXRvciA9IGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yLm9mRmxvYXQobnVsbCwgXCJhbHBoYVwiLCB2YWx1ZXMpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldFN0YXJ0RGVsYXkoZnVsbER1cmF0aW9uIC8gMik7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3Iuc2V0RHVyYXRpb24oMSk7XG4gICAgICAgICAgICAgICAgb2JqZWN0QW5pbWF0b3JzWzFdID0gYW5pbWF0b3I7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUucG9wRW50ZXI6XG4gICAgICAgICAgICAgICAgb2JqZWN0QW5pbWF0b3JzID0gQXJyYXkuY3JlYXRlKGFuZHJvaWQuYW5pbWF0aW9uLkFuaW1hdG9yLCAzKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXMgPSBBcnJheS5jcmVhdGUoXCJmbG9hdFwiLCAyKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMF0gPSAxLjA7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzFdID0gMC4wO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yID0gYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChudWxsLCBcImFscGhhXCIsIHZhbHVlcyk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3Iuc2V0RHVyYXRpb24oMCk7XG4gICAgICAgICAgICAgICAgb2JqZWN0QW5pbWF0b3JzWzBdID0gYW5pbWF0b3I7XG4gICAgICAgICAgICAgICAgdmFsdWVzID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMik7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzBdID0gLXJvdGF0aW9uWTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMV0gPSAwLjA7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3IgPSBhbmRyb2lkLmFuaW1hdGlvbi5PYmplY3RBbmltYXRvci5vZkZsb2F0KG51bGwsIFwicm90YXRpb25ZXCIsIHZhbHVlcyk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3Iuc2V0SW50ZXJwb2xhdG9yKGludGVycG9sYXRvcik7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3Iuc2V0RHVyYXRpb24oZnVsbER1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICBvYmplY3RBbmltYXRvcnNbMV0gPSBhbmltYXRvcjtcbiAgICAgICAgICAgICAgICB2YWx1ZXMgPSBBcnJheS5jcmVhdGUoXCJmbG9hdFwiLCAyKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMF0gPSAwLjA7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzFdID0gMS4wO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yID0gYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChudWxsLCBcImFscGhhXCIsIHZhbHVlcyk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3Iuc2V0U3RhcnREZWxheShmdWxsRHVyYXRpb24gLyAyKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5zZXREdXJhdGlvbigxKTtcbiAgICAgICAgICAgICAgICBvYmplY3RBbmltYXRvcnNbMl0gPSBhbmltYXRvcjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbl8xLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFeGl0OlxuICAgICAgICAgICAgICAgIG9iamVjdEFuaW1hdG9ycyA9IEFycmF5LmNyZWF0ZShhbmRyb2lkLmFuaW1hdGlvbi5BbmltYXRvciwgMik7XG4gICAgICAgICAgICAgICAgdmFsdWVzID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMik7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzBdID0gMC4wO1xuICAgICAgICAgICAgICAgIHZhbHVlc1sxXSA9IHJvdGF0aW9uWTtcbiAgICAgICAgICAgICAgICBhbmltYXRvciA9IGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yLm9mRmxvYXQobnVsbCwgXCJyb3RhdGlvbllcIiwgdmFsdWVzKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5zZXRJbnRlcnBvbGF0b3IoaW50ZXJwb2xhdG9yKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5zZXREdXJhdGlvbihmdWxsRHVyYXRpb24pO1xuICAgICAgICAgICAgICAgIG9iamVjdEFuaW1hdG9yc1swXSA9IGFuaW1hdG9yO1xuICAgICAgICAgICAgICAgIHZhbHVlcyA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDIpO1xuICAgICAgICAgICAgICAgIHZhbHVlc1swXSA9IDEuMDtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMV0gPSAwLjA7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3IgPSBhbmRyb2lkLmFuaW1hdGlvbi5PYmplY3RBbmltYXRvci5vZkZsb2F0KG51bGwsIFwiYWxwaGFcIiwgdmFsdWVzKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5zZXRTdGFydERlbGF5KGZ1bGxEdXJhdGlvbiAvIDIpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldER1cmF0aW9uKDEpO1xuICAgICAgICAgICAgICAgIG9iamVjdEFuaW1hdG9yc1sxXSA9IGFuaW1hdG9yO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGFuaW1hdG9yU2V0LnBsYXlUb2dldGhlcihvYmplY3RBbmltYXRvcnMpO1xuICAgICAgICByZXR1cm4gYW5pbWF0b3JTZXQ7XG4gICAgfTtcbiAgICByZXR1cm4gRmxpcFRyYW5zaXRpb247XG59KHRyYW5zaXRpb25fMS5UcmFuc2l0aW9uKSk7XG5leHBvcnRzLkZsaXBUcmFuc2l0aW9uID0gRmxpcFRyYW5zaXRpb247XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mbGlwLXRyYW5zaXRpb24uYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdHJhbnNpdGlvbiA9IHJlcXVpcmUoXCIuL3RyYW5zaXRpb25cIik7XG52YXIgcGxhdGZvcm0gPSByZXF1aXJlKFwiLi4vLi4vcGxhdGZvcm1cIik7XG52YXIgbGF6eV8xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL2xhenlcIik7XG52YXIgc2NyZWVuV2lkdGggPSBsYXp5XzEuZGVmYXVsdChmdW5jdGlvbiAoKSB7IHJldHVybiBwbGF0Zm9ybS5zY3JlZW4ubWFpblNjcmVlbi53aWR0aFBpeGVsczsgfSk7XG52YXIgc2NyZWVuSGVpZ2h0ID0gbGF6eV8xLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcGxhdGZvcm0uc2NyZWVuLm1haW5TY3JlZW4uaGVpZ2h0UGl4ZWxzOyB9KTtcbnZhciBTbGlkZVRyYW5zaXRpb24gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTbGlkZVRyYW5zaXRpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2xpZGVUcmFuc2l0aW9uKGRpcmVjdGlvbiwgZHVyYXRpb24sIGN1cnZlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGR1cmF0aW9uLCBjdXJ2ZSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2RpcmVjdGlvbiA9IGRpcmVjdGlvbjtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTbGlkZVRyYW5zaXRpb24ucHJvdG90eXBlLmNyZWF0ZUFuZHJvaWRBbmltYXRvciA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uVHlwZSkge1xuICAgICAgICB2YXIgdHJhbnNsYXRpb25WYWx1ZXMgPSBBcnJheS5jcmVhdGUoXCJmbG9hdFwiLCAyKTtcbiAgICAgICAgc3dpdGNoICh0aGlzLl9kaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgXCJsZWZ0XCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0cmFuc2l0aW9uVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIHRyYW5zaXRpb24uQW5kcm9pZFRyYW5zaXRpb25UeXBlLmVudGVyOlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMF0gPSBzY3JlZW5XaWR0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbi5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZXhpdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzFdID0gLXNjcmVlbldpZHRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFbnRlcjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gLXNjcmVlbldpZHRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1sxXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFeGl0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMF0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMV0gPSBzY3JlZW5XaWR0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInJpZ2h0XCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0cmFuc2l0aW9uVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIHRyYW5zaXRpb24uQW5kcm9pZFRyYW5zaXRpb25UeXBlLmVudGVyOlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMF0gPSAtc2NyZWVuV2lkdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzFdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIHRyYW5zaXRpb24uQW5kcm9pZFRyYW5zaXRpb25UeXBlLmV4aXQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1swXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1sxXSA9IHNjcmVlbldpZHRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFbnRlcjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gc2NyZWVuV2lkdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzFdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIHRyYW5zaXRpb24uQW5kcm9pZFRyYW5zaXRpb25UeXBlLnBvcEV4aXQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1swXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1sxXSA9IC1zY3JlZW5XaWR0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInRvcFwiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAodHJhbnNpdGlvblR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5lbnRlcjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gc2NyZWVuSGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1sxXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5leGl0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMF0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMV0gPSAtc2NyZWVuSGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFbnRlcjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gLXNjcmVlbkhlaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbi5BbmRyb2lkVHJhbnNpdGlvblR5cGUucG9wRXhpdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzFdID0gc2NyZWVuSGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiYm90dG9tXCI6XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0cmFuc2l0aW9uVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIHRyYW5zaXRpb24uQW5kcm9pZFRyYW5zaXRpb25UeXBlLmVudGVyOlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMF0gPSAtc2NyZWVuSGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1sxXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5leGl0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMF0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMV0gPSBzY3JlZW5IZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIHRyYW5zaXRpb24uQW5kcm9pZFRyYW5zaXRpb25UeXBlLnBvcEVudGVyOlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMF0gPSBzY3JlZW5IZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzFdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIHRyYW5zaXRpb24uQW5kcm9pZFRyYW5zaXRpb25UeXBlLnBvcEV4aXQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1swXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1sxXSA9IC1zY3JlZW5IZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHJvcDtcbiAgICAgICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PT0gXCJsZWZ0XCIgfHwgdGhpcy5fZGlyZWN0aW9uID09PSBcInJpZ2h0XCIpIHtcbiAgICAgICAgICAgIHByb3AgPSBcInRyYW5zbGF0aW9uWFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcHJvcCA9IFwidHJhbnNsYXRpb25ZXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFuaW1hdG9yID0gYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChudWxsLCBwcm9wLCB0cmFuc2xhdGlvblZhbHVlcyk7XG4gICAgICAgIHZhciBkdXJhdGlvbiA9IHRoaXMuZ2V0RHVyYXRpb24oKTtcbiAgICAgICAgaWYgKGR1cmF0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGFuaW1hdG9yLnNldER1cmF0aW9uKGR1cmF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBhbmltYXRvci5zZXRJbnRlcnBvbGF0b3IodGhpcy5nZXRDdXJ2ZSgpKTtcbiAgICAgICAgcmV0dXJuIGFuaW1hdG9yO1xuICAgIH07XG4gICAgU2xpZGVUcmFuc2l0aW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0aGlzKSArIFwiIFwiICsgdGhpcy5fZGlyZWN0aW9uO1xuICAgIH07XG4gICAgcmV0dXJuIFNsaWRlVHJhbnNpdGlvbjtcbn0odHJhbnNpdGlvbi5UcmFuc2l0aW9uKSk7XG5leHBvcnRzLlNsaWRlVHJhbnNpdGlvbiA9IFNsaWRlVHJhbnNpdGlvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNsaWRlLXRyYW5zaXRpb24uYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYW5pbWF0aW9uXzEgPSByZXF1aXJlKFwiLi4vYW5pbWF0aW9uXCIpO1xudmFyIGxhenlfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy9sYXp5XCIpO1xudmFyIF9kZWZhdWx0SW50ZXJwb2xhdG9yID0gbGF6eV8xLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IGFuZHJvaWQudmlldy5hbmltYXRpb24uQWNjZWxlcmF0ZURlY2VsZXJhdGVJbnRlcnBvbGF0b3IoKTsgfSk7XG52YXIgQW5kcm9pZFRyYW5zaXRpb25UeXBlO1xuKGZ1bmN0aW9uIChBbmRyb2lkVHJhbnNpdGlvblR5cGUpIHtcbiAgICBBbmRyb2lkVHJhbnNpdGlvblR5cGUuZW50ZXIgPSBcImVudGVyXCI7XG4gICAgQW5kcm9pZFRyYW5zaXRpb25UeXBlLmV4aXQgPSBcImV4aXRcIjtcbiAgICBBbmRyb2lkVHJhbnNpdGlvblR5cGUucG9wRW50ZXIgPSBcInBvcEVudGVyXCI7XG4gICAgQW5kcm9pZFRyYW5zaXRpb25UeXBlLnBvcEV4aXQgPSBcInBvcEV4aXRcIjtcbn0pKEFuZHJvaWRUcmFuc2l0aW9uVHlwZSA9IGV4cG9ydHMuQW5kcm9pZFRyYW5zaXRpb25UeXBlIHx8IChleHBvcnRzLkFuZHJvaWRUcmFuc2l0aW9uVHlwZSA9IHt9KSk7XG52YXIgdHJhbnNpdGlvbklkID0gMDtcbnZhciBUcmFuc2l0aW9uID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBUcmFuc2l0aW9uKGR1cmF0aW9uLCBjdXJ2ZSkge1xuICAgICAgICB0aGlzLl9kdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICB0aGlzLl9pbnRlcnBvbGF0b3IgPSBjdXJ2ZSA/IGFuaW1hdGlvbl8xLl9yZXNvbHZlQW5pbWF0aW9uQ3VydmUoY3VydmUpIDogX2RlZmF1bHRJbnRlcnBvbGF0b3IoKTtcbiAgICAgICAgdGhpcy5faWQgPSB0cmFuc2l0aW9uSWQrKztcbiAgICB9XG4gICAgVHJhbnNpdGlvbi5wcm90b3R5cGUuZ2V0RHVyYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kdXJhdGlvbjtcbiAgICB9O1xuICAgIFRyYW5zaXRpb24ucHJvdG90eXBlLmdldEN1cnZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW50ZXJwb2xhdG9yO1xuICAgIH07XG4gICAgVHJhbnNpdGlvbi5wcm90b3R5cGUuYW5pbWF0ZUlPU1RyYW5zaXRpb24gPSBmdW5jdGlvbiAoY29udGFpbmVyVmlldywgZnJvbVZpZXcsIHRvVmlldywgb3BlcmF0aW9uLCBjb21wbGV0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFic3RyYWN0IG1ldGhvZCBjYWxsXCIpO1xuICAgIH07XG4gICAgVHJhbnNpdGlvbi5wcm90b3R5cGUuY3JlYXRlQW5kcm9pZEFuaW1hdG9yID0gZnVuY3Rpb24gKHRyYW5zaXRpb25UeXBlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFic3RyYWN0IG1ldGhvZCBjYWxsXCIpO1xuICAgIH07XG4gICAgVHJhbnNpdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcIlRyYW5zaXRpb25AXCIgKyB0aGlzLl9pZDtcbiAgICB9O1xuICAgIHJldHVybiBUcmFuc2l0aW9uO1xufSgpKTtcbmV4cG9ydHMuVHJhbnNpdGlvbiA9IFRyYW5zaXRpb247XG4vLyMgc291cmNlTWFwcGluZ1VSTD10cmFuc2l0aW9uLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIGZpbGVfc3lzdGVtXzEgPSByZXF1aXJlKFwiLi4vLi4vZmlsZS1zeXN0ZW1cIik7XG5leHBvcnRzLkZpbGUgPSBmaWxlX3N5c3RlbV8xLkZpbGU7XG5leHBvcnRzLmtub3duRm9sZGVycyA9IGZpbGVfc3lzdGVtXzEua25vd25Gb2xkZXJzO1xuZXhwb3J0cy5wYXRoID0gZmlsZV9zeXN0ZW1fMS5wYXRoO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG5leHBvcnRzLnNyY1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwic3JjXCIgfSk7XG52YXIgV2ViVmlld0Jhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhXZWJWaWV3QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBXZWJWaWV3QmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBXZWJWaWV3QmFzZV8xID0gV2ViVmlld0Jhc2U7XG4gICAgV2ViVmlld0Jhc2UucHJvdG90eXBlLl9vbkxvYWRGaW5pc2hlZCA9IGZ1bmN0aW9uICh1cmwsIGVycm9yKSB7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgZXZlbnROYW1lOiBXZWJWaWV3QmFzZV8xLmxvYWRGaW5pc2hlZEV2ZW50LFxuICAgICAgICAgICAgb2JqZWN0OiB0aGlzLFxuICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICBuYXZpZ2F0aW9uVHlwZTogdW5kZWZpbmVkLFxuICAgICAgICAgICAgZXJyb3I6IGVycm9yXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubm90aWZ5KGFyZ3MpO1xuICAgIH07XG4gICAgV2ViVmlld0Jhc2UucHJvdG90eXBlLl9vbkxvYWRTdGFydGVkID0gZnVuY3Rpb24gKHVybCwgbmF2aWdhdGlvblR5cGUpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICBldmVudE5hbWU6IFdlYlZpZXdCYXNlXzEubG9hZFN0YXJ0ZWRFdmVudCxcbiAgICAgICAgICAgIG9iamVjdDogdGhpcyxcbiAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgbmF2aWdhdGlvblR5cGU6IG5hdmlnYXRpb25UeXBlLFxuICAgICAgICAgICAgZXJyb3I6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLm5vdGlmeShhcmdzKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXZWJWaWV3QmFzZS5wcm90b3R5cGUsIFwiY2FuR29CYWNrXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGlzIG1lbWJlciBpcyBhYnN0cmFjdC5cIik7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXZWJWaWV3QmFzZS5wcm90b3R5cGUsIFwiY2FuR29Gb3J3YXJkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGlzIG1lbWJlciBpcyBhYnN0cmFjdC5cIik7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFdlYlZpZXdCYXNlLnByb3RvdHlwZVtleHBvcnRzLnNyY1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9O1xuICAgIFdlYlZpZXdCYXNlLnByb3RvdHlwZVtleHBvcnRzLnNyY1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAoc3JjKSB7XG4gICAgICAgIHRoaXMuc3RvcExvYWRpbmcoKTtcbiAgICAgICAgaWYgKHNyYy5pbmRleE9mKFwifi9cIikgPT09IDApIHtcbiAgICAgICAgICAgIHNyYyA9IFwiZmlsZTovLy9cIiArIGZpbGVfc3lzdGVtXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoICsgXCIvXCIgKyBzcmMuc3Vic3RyKDIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNyYy5pbmRleE9mKFwiL1wiKSA9PT0gMCkge1xuICAgICAgICAgICAgc3JjID0gXCJmaWxlOi8vXCIgKyBzcmM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNyYy50b0xvd2VyQ2FzZSgpLmluZGV4T2YoXCJmaWxlOi8vL1wiKSA9PT0gMCkge1xuICAgICAgICAgICAgc3JjID0gZW5jb2RlVVJJKHNyYyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNyYy50b0xvd2VyQ2FzZSgpLmluZGV4T2YoXCJodHRwOi8vXCIpID09PSAwIHx8XG4gICAgICAgICAgICBzcmMudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwiaHR0cHM6Ly9cIikgPT09IDAgfHxcbiAgICAgICAgICAgIHNyYy50b0xvd2VyQ2FzZSgpLmluZGV4T2YoXCJmaWxlOi8vL1wiKSA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5fbG9hZFVybChzcmMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fbG9hZERhdGEoc3JjKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdmFyIFdlYlZpZXdCYXNlXzE7XG4gICAgV2ViVmlld0Jhc2UubG9hZFN0YXJ0ZWRFdmVudCA9IFwibG9hZFN0YXJ0ZWRcIjtcbiAgICBXZWJWaWV3QmFzZS5sb2FkRmluaXNoZWRFdmVudCA9IFwibG9hZEZpbmlzaGVkXCI7XG4gICAgV2ViVmlld0Jhc2UgPSBXZWJWaWV3QmFzZV8xID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiV2ViVmlld1wiKVxuICAgIF0sIFdlYlZpZXdCYXNlKTtcbiAgICByZXR1cm4gV2ViVmlld0Jhc2U7XG59KHZpZXdfMS5Db250YWluZXJWaWV3KSk7XG5leHBvcnRzLldlYlZpZXdCYXNlID0gV2ViVmlld0Jhc2U7XG5leHBvcnRzLnNyY1Byb3BlcnR5LnJlZ2lzdGVyKFdlYlZpZXdCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXdlYi12aWV3LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHdlYl92aWV3X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vd2ViLXZpZXctY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vd2ViLXZpZXctY29tbW9uXCIpKTtcbnZhciBXZWJWaWV3Q2xpZW50O1xuZnVuY3Rpb24gaW5pdGlhbGl6ZVdlYlZpZXdDbGllbnQoKSB7XG4gICAgaWYgKFdlYlZpZXdDbGllbnQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgV2ViVmlld0NsaWVudEltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoV2ViVmlld0NsaWVudEltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFdlYlZpZXdDbGllbnRJbXBsKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFdlYlZpZXdDbGllbnRJbXBsLnByb3RvdHlwZS5zaG91bGRPdmVycmlkZVVybExvYWRpbmcgPSBmdW5jdGlvbiAodmlldywgdXJsKSB7XG4gICAgICAgICAgICBpZiAod2ViX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB3ZWJfdmlld19jb21tb25fMS50cmFjZVdyaXRlKFwiV2ViVmlld0NsaWVudENsYXNzLnNob3VsZE92ZXJyaWRlVXJsTG9hZGluZyhcIiArIHVybCArIFwiKVwiLCB3ZWJfdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuRGVidWcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9O1xuICAgICAgICBXZWJWaWV3Q2xpZW50SW1wbC5wcm90b3R5cGUub25QYWdlU3RhcnRlZCA9IGZ1bmN0aW9uICh2aWV3LCB1cmwsIGZhdmljb24pIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUub25QYWdlU3RhcnRlZC5jYWxsKHRoaXMsIHZpZXcsIHVybCwgZmF2aWNvbik7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJXZWJWaWV3Q2xpZW50Q2xhc3Mub25QYWdlU3RhcnRlZChcIiArIHVybCArIFwiLCBcIiArIGZhdmljb24gKyBcIilcIiwgd2ViX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb3duZXIuX29uTG9hZFN0YXJ0ZWQodXJsLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBXZWJWaWV3Q2xpZW50SW1wbC5wcm90b3R5cGUub25QYWdlRmluaXNoZWQgPSBmdW5jdGlvbiAodmlldywgdXJsKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uUGFnZUZpbmlzaGVkLmNhbGwodGhpcywgdmlldywgdXJsKTtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAod2ViX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgd2ViX3ZpZXdfY29tbW9uXzEudHJhY2VXcml0ZShcIldlYlZpZXdDbGllbnRDbGFzcy5vblBhZ2VGaW5pc2hlZChcIiArIHVybCArIFwiKVwiLCB3ZWJfdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuRGVidWcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvd25lci5fb25Mb2FkRmluaXNoZWQodXJsLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBXZWJWaWV3Q2xpZW50SW1wbC5wcm90b3R5cGUub25SZWNlaXZlZEVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSBhcmd1bWVudHNbMF07XG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gNCkge1xuICAgICAgICAgICAgICAgIHZhciBlcnJvckNvZGUgPSBhcmd1bWVudHNbMV07XG4gICAgICAgICAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gYXJndW1lbnRzWzJdO1xuICAgICAgICAgICAgICAgIHZhciBmYWlsaW5nVXJsID0gYXJndW1lbnRzWzNdO1xuICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUub25SZWNlaXZlZEVycm9yLmNhbGwodGhpcywgdmlldywgZXJyb3JDb2RlLCBkZXNjcmlwdGlvbiwgZmFpbGluZ1VybCk7XG4gICAgICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWJfdmlld19jb21tb25fMS50cmFjZVdyaXRlKFwiV2ViVmlld0NsaWVudENsYXNzLm9uUmVjZWl2ZWRFcnJvcihcIiArIGVycm9yQ29kZSArIFwiLCBcIiArIGRlc2NyaXB0aW9uICsgXCIsIFwiICsgZmFpbGluZ1VybCArIFwiKVwiLCB3ZWJfdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuRGVidWcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG93bmVyLl9vbkxvYWRGaW5pc2hlZChmYWlsaW5nVXJsLCBkZXNjcmlwdGlvbiArIFwiKFwiICsgZXJyb3JDb2RlICsgXCIpXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gYXJndW1lbnRzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IGFyZ3VtZW50c1syXTtcbiAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uUmVjZWl2ZWRFcnJvci5jYWxsKHRoaXMsIHZpZXcsIHJlcXVlc3QsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgICAgICAgICBpZiAod2ViX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJXZWJWaWV3Q2xpZW50Q2xhc3Mub25SZWNlaXZlZEVycm9yKFwiICsgZXJyb3IuZ2V0RXJyb3JDb2RlKCkgKyBcIiwgXCIgKyBlcnJvci5nZXREZXNjcmlwdGlvbigpICsgXCIsIFwiICsgKGVycm9yLmdldFVybCAmJiBlcnJvci5nZXRVcmwoKSkgKyBcIilcIiwgd2ViX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBvd25lci5fb25Mb2FkRmluaXNoZWQoZXJyb3IuZ2V0VXJsICYmIGVycm9yLmdldFVybCgpLCBlcnJvci5nZXREZXNjcmlwdGlvbigpICsgXCIoXCIgKyBlcnJvci5nZXRFcnJvckNvZGUoKSArIFwiKVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBXZWJWaWV3Q2xpZW50SW1wbDtcbiAgICB9KGFuZHJvaWQud2Via2l0LldlYlZpZXdDbGllbnQpKTtcbiAgICBXZWJWaWV3Q2xpZW50ID0gV2ViVmlld0NsaWVudEltcGw7XG59XG52YXIgV2ViVmlldyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFdlYlZpZXcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gV2ViVmlldygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBXZWJWaWV3LnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IG5ldyBhbmRyb2lkLndlYmtpdC5XZWJWaWV3KHRoaXMuX2NvbnRleHQpO1xuICAgICAgICBuYXRpdmVWaWV3LmdldFNldHRpbmdzKCkuc2V0SmF2YVNjcmlwdEVuYWJsZWQodHJ1ZSk7XG4gICAgICAgIG5hdGl2ZVZpZXcuZ2V0U2V0dGluZ3MoKS5zZXRCdWlsdEluWm9vbUNvbnRyb2xzKHRydWUpO1xuICAgICAgICByZXR1cm4gbmF0aXZlVmlldztcbiAgICB9O1xuICAgIFdlYlZpZXcucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIGluaXRpYWxpemVXZWJWaWV3Q2xpZW50KCk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgY2xpZW50ID0gbmV3IFdlYlZpZXdDbGllbnQodGhpcyk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0V2ViVmlld0NsaWVudChjbGllbnQpO1xuICAgICAgICBuYXRpdmVWaWV3LmNsaWVudCA9IGNsaWVudDtcbiAgICB9O1xuICAgIFdlYlZpZXcucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgICAgIG5hdGl2ZVZpZXcuY2xpZW50Lm93bmVyID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgV2ViVmlldy5wcm90b3R5cGUuX2xvYWRVcmwgPSBmdW5jdGlvbiAoc3JjKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAoIW5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBuYXRpdmVWaWV3LmxvYWRVcmwoc3JjKTtcbiAgICB9O1xuICAgIFdlYlZpZXcucHJvdG90eXBlLl9sb2FkRGF0YSA9IGZ1bmN0aW9uIChzcmMpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmICghbmF0aXZlVmlldykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYXNlVXJsID0gXCJmaWxlOi8vL1wiICsgd2ViX3ZpZXdfY29tbW9uXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoICsgXCIvXCI7XG4gICAgICAgIG5hdGl2ZVZpZXcubG9hZERhdGFXaXRoQmFzZVVSTChiYXNlVXJsLCBzcmMsIFwidGV4dC9odG1sXCIsIFwidXRmLThcIiwgbnVsbCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV2ViVmlldy5wcm90b3R5cGUsIFwiY2FuR29CYWNrXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNhbkdvQmFjaygpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBXZWJWaWV3LnByb3RvdHlwZS5zdG9wTG9hZGluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnN0b3BMb2FkaW5nKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXZWJWaWV3LnByb3RvdHlwZSwgXCJjYW5Hb0ZvcndhcmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgaWYgKG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmF0aXZlVmlldy5jYW5Hb0ZvcndhcmQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgV2ViVmlldy5wcm90b3R5cGUuZ29CYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiBuYXRpdmVWaWV3LmdvQmFjaygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBXZWJWaWV3LnByb3RvdHlwZS5nb0ZvcndhcmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldykge1xuICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXcuZ29Gb3J3YXJkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFdlYlZpZXcucHJvdG90eXBlLnJlbG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICByZXR1cm4gbmF0aXZlVmlldy5yZWxvYWQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFdlYlZpZXc7XG59KHdlYl92aWV3X2NvbW1vbl8xLldlYlZpZXdCYXNlKSk7XG5leHBvcnRzLldlYlZpZXcgPSBXZWJWaWV3O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9d2ViLXZpZXcuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZmlsZV9zeXN0ZW1fMSA9IHJlcXVpcmUoXCIuLi9maWxlLXN5c3RlbVwiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uL3BsYXRmb3JtXCIpO1xuZXhwb3J0cy5kZWJ1ZyA9IHRydWU7XG52YXIgYXBwbGljYXRpb25Sb290UGF0aDtcbmZ1bmN0aW9uIGVuc3VyZUFwcFJvb3RQYXRoKCkge1xuICAgIGlmICghYXBwbGljYXRpb25Sb290UGF0aCkge1xuICAgICAgICBhcHBsaWNhdGlvblJvb3RQYXRoID0gZmlsZV9zeXN0ZW1fMS5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGg7XG4gICAgICAgIGFwcGxpY2F0aW9uUm9vdFBhdGggPSBhcHBsaWNhdGlvblJvb3RQYXRoLnN1YnN0cigwLCBhcHBsaWNhdGlvblJvb3RQYXRoLmxlbmd0aCAtIFwiYXBwL1wiLmxlbmd0aCk7XG4gICAgfVxufVxudmFyIFNvdXJjZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU291cmNlKHVyaSwgbGluZSwgY29sdW1uKSB7XG4gICAgICAgIGVuc3VyZUFwcFJvb3RQYXRoKCk7XG4gICAgICAgIGlmICh1cmkubGVuZ3RoID4gYXBwbGljYXRpb25Sb290UGF0aC5sZW5ndGggJiYgdXJpLnN1YnN0cigwLCBhcHBsaWNhdGlvblJvb3RQYXRoLmxlbmd0aCkgPT09IGFwcGxpY2F0aW9uUm9vdFBhdGgpIHtcbiAgICAgICAgICAgIHRoaXMuX3VyaSA9IFwiZmlsZTovL1wiICsgdXJpLnN1YnN0cihhcHBsaWNhdGlvblJvb3RQYXRoLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl91cmkgPSB1cmk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbGluZSA9IGxpbmU7XG4gICAgICAgIHRoaXMuX2NvbHVtbiA9IGNvbHVtbjtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNvdXJjZS5wcm90b3R5cGUsIFwidXJpXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl91cmk7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTb3VyY2UucHJvdG90eXBlLCBcImxpbmVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX2xpbmU7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTb3VyY2UucHJvdG90eXBlLCBcImNvbHVtblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fY29sdW1uOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdXJpICsgXCI6XCIgKyB0aGlzLl9saW5lICsgXCI6XCIgKyB0aGlzLl9jb2x1bW47XG4gICAgfTtcbiAgICBTb3VyY2UuZ2V0ID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgICByZXR1cm4gb2JqZWN0W1NvdXJjZS5fc291cmNlXTtcbiAgICB9O1xuICAgIFNvdXJjZS5zZXQgPSBmdW5jdGlvbiAob2JqZWN0LCBzcmMpIHtcbiAgICAgICAgb2JqZWN0W1NvdXJjZS5fc291cmNlXSA9IHNyYztcbiAgICB9O1xuICAgIFNvdXJjZS5fc291cmNlID0gU3ltYm9sKFwic291cmNlXCIpO1xuICAgIHJldHVybiBTb3VyY2U7XG59KCkpO1xuZXhwb3J0cy5Tb3VyY2UgPSBTb3VyY2U7XG52YXIgU2NvcGVFcnJvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNjb3BlRXJyb3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2NvcGVFcnJvcihpbm5lciwgbWVzc2FnZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgZm9ybWF0dGVkTWVzc2FnZTtcbiAgICAgICAgaWYgKG1lc3NhZ2UgJiYgaW5uZXIubWVzc2FnZSkge1xuICAgICAgICAgICAgZm9ybWF0dGVkTWVzc2FnZSA9IG1lc3NhZ2UgKyBcIlxcbiA+IFwiICsgaW5uZXIubWVzc2FnZS5yZXBsYWNlKFwiXFxuXCIsIFwiXFxuICBcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmb3JtYXR0ZWRNZXNzYWdlID0gbWVzc2FnZSB8fCBpbm5lci5tZXNzYWdlIHx8IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZvcm1hdHRlZE1lc3NhZ2UpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnN0YWNrID0gcGxhdGZvcm1fMS5pc0FuZHJvaWQgPyBcIkVycm9yOiBcIiArIF90aGlzLm1lc3NhZ2UgKyBcIlxcblwiICsgaW5uZXIuc3RhY2suc3Vic3RyKGlubmVyLnN0YWNrLmluZGV4T2YoXCJcXG5cIikgKyAxKSA6IGlubmVyLnN0YWNrO1xuICAgICAgICBfdGhpcy5tZXNzYWdlID0gZm9ybWF0dGVkTWVzc2FnZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICByZXR1cm4gU2NvcGVFcnJvcjtcbn0oRXJyb3IpKTtcbmV4cG9ydHMuU2NvcGVFcnJvciA9IFNjb3BlRXJyb3I7XG52YXIgU291cmNlRXJyb3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTb3VyY2VFcnJvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTb3VyY2VFcnJvcihjaGlsZCwgc291cmNlLCBtZXNzYWdlKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBjaGlsZCwgbWVzc2FnZSA/IG1lc3NhZ2UgKyBcIiBAXCIgKyBzb3VyY2UgKyBcIlwiIDogc291cmNlICsgXCJcIikgfHwgdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIFNvdXJjZUVycm9yO1xufShTY29wZUVycm9yKSk7XG5leHBvcnRzLlNvdXJjZUVycm9yID0gU291cmNlRXJyb3I7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWJ1Zy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBsYXp5KGFjdGlvbikge1xuICAgIHZhciBfdmFsdWU7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF92YWx1ZSB8fCAoX3ZhbHVlID0gYWN0aW9uKCkpOyB9O1xufVxuZXhwb3J0cy5kZWZhdWx0ID0gbGF6eTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxhenkuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gZGlzcGF0Y2hUb01haW5UaHJlYWQoZnVuYykge1xuICAgIG5ldyBhbmRyb2lkLm9zLkhhbmRsZXIoYW5kcm9pZC5vcy5Mb29wZXIuZ2V0TWFpbkxvb3BlcigpKVxuICAgICAgICAucG9zdChuZXcgamF2YS5sYW5nLlJ1bm5hYmxlKHtcbiAgICAgICAgcnVuOiBmdW5jXG4gICAgfSkpO1xufVxuZXhwb3J0cy5kaXNwYXRjaFRvTWFpblRocmVhZCA9IGRpc3BhdGNoVG9NYWluVGhyZWFkO1xuZnVuY3Rpb24gaXNNYWluVGhyZWFkKCkge1xuICAgIHJldHVybiBhbmRyb2lkLm9zLkxvb3Blci5teUxvb3BlcigpID09PSBhbmRyb2lkLm9zLkxvb3Blci5nZXRNYWluTG9vcGVyKCk7XG59XG5leHBvcnRzLmlzTWFpblRocmVhZCA9IGlzTWFpblRocmVhZDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1haW50aHJlYWQtaGVscGVyLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGVwc2lsb24gPSAxRS0wNTtcbmZ1bmN0aW9uIGFyZUNsb3NlKHZhbHVlMSwgdmFsdWUyKSB7XG4gICAgcmV0dXJuIChNYXRoLmFicyh2YWx1ZTEgLSB2YWx1ZTIpIDwgZXBzaWxvbik7XG59XG5leHBvcnRzLmFyZUNsb3NlID0gYXJlQ2xvc2U7XG5mdW5jdGlvbiBncmVhdGVyVGhhbk9yQ2xvc2UodmFsdWUxLCB2YWx1ZTIpIHtcbiAgICByZXR1cm4gKHZhbHVlMSA+IHZhbHVlMikgfHwgYXJlQ2xvc2UodmFsdWUxLCB2YWx1ZTIpO1xufVxuZXhwb3J0cy5ncmVhdGVyVGhhbk9yQ2xvc2UgPSBncmVhdGVyVGhhbk9yQ2xvc2U7XG5mdW5jdGlvbiBncmVhdGVyVGhhbih2YWx1ZTEsIHZhbHVlMikge1xuICAgIHJldHVybiAodmFsdWUxID4gdmFsdWUyKSAmJiAhYXJlQ2xvc2UodmFsdWUxLCB2YWx1ZTIpO1xufVxuZXhwb3J0cy5ncmVhdGVyVGhhbiA9IGdyZWF0ZXJUaGFuO1xuZnVuY3Rpb24gbGVzc1RoYW4odmFsdWUxLCB2YWx1ZTIpIHtcbiAgICByZXR1cm4gKHZhbHVlMSA8IHZhbHVlMikgJiYgIWFyZUNsb3NlKHZhbHVlMSwgdmFsdWUyKTtcbn1cbmV4cG9ydHMubGVzc1RoYW4gPSBsZXNzVGhhbjtcbmZ1bmN0aW9uIGlzWmVybyh2YWx1ZSkge1xuICAgIHJldHVybiAoTWF0aC5hYnModmFsdWUpIDwgZXBzaWxvbik7XG59XG5leHBvcnRzLmlzWmVybyA9IGlzWmVybztcbmZ1bmN0aW9uIGdyZWF0ZXJUaGFuWmVybyh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA+IDA7XG59XG5leHBvcnRzLmdyZWF0ZXJUaGFuWmVybyA9IGdyZWF0ZXJUaGFuWmVybztcbmZ1bmN0aW9uIG5vdE5lZ2F0aXZlKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID49IDA7XG59XG5leHBvcnRzLm5vdE5lZ2F0aXZlID0gbm90TmVnYXRpdmU7XG5leHBvcnRzLnJhZGlhbnNUb0RlZ3JlZXMgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYSAqICgxODAgLyBNYXRoLlBJKTsgfTtcbmV4cG9ydHMuZGVncmVlc1RvUmFkaWFucyA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhICogKE1hdGguUEkgLyAxODApOyB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bnVtYmVyLXV0aWxzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIGlzU3RyaW5nKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiB8fCB2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZztcbn1cbmV4cG9ydHMuaXNTdHJpbmcgPSBpc1N0cmluZztcbmZ1bmN0aW9uIGlzTnVtYmVyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIiB8fCB2YWx1ZSBpbnN0YW5jZW9mIE51bWJlcjtcbn1cbmV4cG9ydHMuaXNOdW1iZXIgPSBpc051bWJlcjtcbmZ1bmN0aW9uIGlzQm9vbGVhbih2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwiYm9vbGVhblwiIHx8IHZhbHVlIGluc3RhbmNlb2YgQm9vbGVhbjtcbn1cbmV4cG9ydHMuaXNCb29sZWFuID0gaXNCb29sZWFuO1xuZnVuY3Rpb24gaXNGdW5jdGlvbih2YWx1ZSkge1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCI7XG59XG5leHBvcnRzLmlzRnVuY3Rpb24gPSBpc0Z1bmN0aW9uO1xuZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIjtcbn1cbmV4cG9ydHMuaXNPYmplY3QgPSBpc09iamVjdDtcbmZ1bmN0aW9uIGlzVW5kZWZpbmVkKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQ7XG59XG5leHBvcnRzLmlzVW5kZWZpbmVkID0gaXNVbmRlZmluZWQ7XG5mdW5jdGlvbiBpc0RlZmluZWQodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlICE9PSBcInVuZGVmaW5lZFwiO1xufVxuZXhwb3J0cy5pc0RlZmluZWQgPSBpc0RlZmluZWQ7XG5mdW5jdGlvbiBpc051bGxPclVuZGVmaW5lZCh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsO1xufVxuZXhwb3J0cy5pc051bGxPclVuZGVmaW5lZCA9IGlzTnVsbE9yVW5kZWZpbmVkO1xuZnVuY3Rpb24gdmVyaWZ5Q2FsbGJhY2sodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgJiYgIWlzRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYWxsYmFjayBtdXN0IGJlIGEgdmFsaWQgZnVuY3Rpb24uXCIpO1xuICAgIH1cbn1cbmV4cG9ydHMudmVyaWZ5Q2FsbGJhY2sgPSB2ZXJpZnlDYWxsYmFjaztcbnZhciBjbGFzc0luZm9zTWFwID0gbmV3IE1hcCgpO1xudmFyIGZ1bmNOYW1lUmVnZXggPSAvZnVuY3Rpb24gKFtfYS16QS1aMC05XXsxLH0pXFwoLztcbmZ1bmN0aW9uIGdldENsYXNzKG9iamVjdCkge1xuICAgIHJldHVybiBnZXRDbGFzc0luZm8ob2JqZWN0KS5uYW1lO1xufVxuZXhwb3J0cy5nZXRDbGFzcyA9IGdldENsYXNzO1xuZnVuY3Rpb24gZ2V0Q2xhc3NJbmZvKG9iamVjdCkge1xuICAgIHZhciBjb25zdHJ1Y3RvciA9IG9iamVjdC5jb25zdHJ1Y3RvcjtcbiAgICB2YXIgcmVzdWx0ID0gY2xhc3NJbmZvc01hcC5nZXQoY29uc3RydWN0b3IpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJlc3VsdCA9IG5ldyBDbGFzc0luZm8oY29uc3RydWN0b3IpO1xuICAgICAgICBjbGFzc0luZm9zTWFwLnNldChjb25zdHJ1Y3RvciwgcmVzdWx0KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuZ2V0Q2xhc3NJbmZvID0gZ2V0Q2xhc3NJbmZvO1xuZnVuY3Rpb24gZ2V0QmFzZUNsYXNzZXMob2JqZWN0KSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIHZhciBpbmZvID0gZ2V0Q2xhc3NJbmZvKG9iamVjdCk7XG4gICAgd2hpbGUgKGluZm8pIHtcbiAgICAgICAgcmVzdWx0LnB1c2goaW5mby5uYW1lKTtcbiAgICAgICAgaW5mbyA9IGluZm8uYmFzZUNsYXNzSW5mbztcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuZ2V0QmFzZUNsYXNzZXMgPSBnZXRCYXNlQ2xhc3NlcztcbnZhciBDbGFzc0luZm8gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENsYXNzSW5mbyh0eXBlQ29zbnRydWN0b3IpIHtcbiAgICAgICAgdGhpcy5fdHlwZUNvc250cnVjdG9yID0gdHlwZUNvc250cnVjdG9yO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ2xhc3NJbmZvLnByb3RvdHlwZSwgXCJuYW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX25hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IChmdW5jTmFtZVJlZ2V4KS5leGVjKHRoaXMuX3R5cGVDb3NudHJ1Y3Rvci50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9uYW1lID0gKHJlc3VsdHMgJiYgcmVzdWx0cy5sZW5ndGggPiAxKSA/IHJlc3VsdHNbMV0gOiBcIlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25hbWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDbGFzc0luZm8ucHJvdG90eXBlLCBcImJhc2VDbGFzc0luZm9cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChpc1VuZGVmaW5lZCh0aGlzLl9iYXNlQ2xhc3NJbmZvKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Jhc2VDbGFzc0luZm8gPSBDbGFzc0luZm8uX2dldEJhc2UodGhpcyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Jhc2VDbGFzc0luZm8gJiYgdGhpcy5fYmFzZUNsYXNzSW5mby5uYW1lID09PSB0aGlzLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYmFzZUNsYXNzSW5mbyA9IENsYXNzSW5mby5fZ2V0QmFzZSh0aGlzLl9iYXNlQ2xhc3NJbmZvKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFzZUNsYXNzSW5mbztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQ2xhc3NJbmZvLl9nZXRCYXNlID0gZnVuY3Rpb24gKGluZm8pIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgICAgIHZhciBjb25zdHJ1Y3RvclByb3RvID0gaW5mby5fdHlwZUNvc250cnVjdG9yLnByb3RvdHlwZTtcbiAgICAgICAgaWYgKGNvbnN0cnVjdG9yUHJvdG8uX19wcm90b19fKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBnZXRDbGFzc0luZm8oY29uc3RydWN0b3JQcm90by5fX3Byb3RvX18pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICByZXR1cm4gQ2xhc3NJbmZvO1xufSgpKTtcbmV4cG9ydHMuQ2xhc3NJbmZvID0gQ2xhc3NJbmZvO1xuZnVuY3Rpb24gdG9VSVN0cmluZyhvYmopIHtcbiAgICByZXR1cm4gaXNOdWxsT3JVbmRlZmluZWQob2JqKSA/IFwiXCIgOiBvYmogKyBcIlwiO1xufVxuZXhwb3J0cy50b1VJU3RyaW5nID0gdG9VSVN0cmluZztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXR5cGVzLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdHlwZXMgPSByZXF1aXJlKFwiLi90eXBlc1wiKTtcbnZhciBtYWludGhyZWFkX2hlbHBlcl8xID0gcmVxdWlyZShcIi4vbWFpbnRocmVhZC1oZWxwZXJcIik7XG52YXIgbW9kdWxlX25hbWVfc2FuaXRpemVyXzEgPSByZXF1aXJlKFwiLi4vdWkvYnVpbGRlci9tb2R1bGUtbmFtZS1zYW5pdGl6ZXJcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9tYWludGhyZWFkLWhlbHBlclwiKSk7XG5leHBvcnRzLlJFU09VUkNFX1BSRUZJWCA9IFwicmVzOi8vXCI7XG5leHBvcnRzLkZJTEVfUFJFRklYID0gXCJmaWxlOi8vL1wiO1xuZnVuY3Rpb24gZXNjYXBlUmVnZXhTeW1ib2xzKHNvdXJjZSkge1xuICAgIHZhciBlc2NhcGVSZWdleCA9IC9bXFwtXFxbXFxdXFwvXFx7XFx9XFwoXFwpXFwqXFwrXFw/XFwuXFxcXFxcXlxcJFxcfF0vZztcbiAgICByZXR1cm4gc291cmNlLnJlcGxhY2UoZXNjYXBlUmVnZXgsIFwiXFxcXCQmXCIpO1xufVxuZXhwb3J0cy5lc2NhcGVSZWdleFN5bWJvbHMgPSBlc2NhcGVSZWdleFN5bWJvbHM7XG5mdW5jdGlvbiBjb252ZXJ0U3RyaW5nKHZhbHVlKSB7XG4gICAgdmFyIHJlc3VsdDtcbiAgICBpZiAoIXR5cGVzLmlzU3RyaW5nKHZhbHVlKSB8fCB2YWx1ZS50cmltKCkgPT09IFwiXCIpIHtcbiAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgdmFsdWVBc051bWJlciA9ICt2YWx1ZTtcbiAgICAgICAgaWYgKCFpc05hTih2YWx1ZUFzTnVtYmVyKSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWVBc051bWJlcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSAmJiAodmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJ0cnVlXCIgfHwgdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJmYWxzZVwiKSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJ0cnVlXCIgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZXhwb3J0cy5jb252ZXJ0U3RyaW5nID0gY29udmVydFN0cmluZztcbmZ1bmN0aW9uIGdldE1vZHVsZU5hbWUocGF0aCkge1xuICAgIHZhciBtb2R1bGVOYW1lID0gcGF0aC5yZXBsYWNlKFwiLi9cIiwgXCJcIik7XG4gICAgcmV0dXJuIG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShtb2R1bGVOYW1lKTtcbn1cbmV4cG9ydHMuZ2V0TW9kdWxlTmFtZSA9IGdldE1vZHVsZU5hbWU7XG52YXIgbGF5b3V0Q29tbW9uO1xuKGZ1bmN0aW9uIChsYXlvdXRDb21tb24pIHtcbiAgICB2YXIgTU9ERV9TSElGVCA9IDMwO1xuICAgIHZhciBNT0RFX01BU0sgPSAweDMgPDwgTU9ERV9TSElGVDtcbiAgICBsYXlvdXRDb21tb24uVU5TUEVDSUZJRUQgPSAwIDw8IE1PREVfU0hJRlQ7XG4gICAgbGF5b3V0Q29tbW9uLkVYQUNUTFkgPSAxIDw8IE1PREVfU0hJRlQ7XG4gICAgbGF5b3V0Q29tbW9uLkFUX01PU1QgPSAyIDw8IE1PREVfU0hJRlQ7XG4gICAgbGF5b3V0Q29tbW9uLk1FQVNVUkVEX0hFSUdIVF9TVEFURV9TSElGVCA9IDB4MDAwMDAwMTA7XG4gICAgbGF5b3V0Q29tbW9uLk1FQVNVUkVEX1NUQVRFX1RPT19TTUFMTCA9IDB4MDEwMDAwMDA7XG4gICAgbGF5b3V0Q29tbW9uLk1FQVNVUkVEX1NUQVRFX01BU0sgPSAweGZmMDAwMDAwO1xuICAgIGxheW91dENvbW1vbi5NRUFTVVJFRF9TSVpFX01BU0sgPSAweDAwZmZmZmZmO1xuICAgIGZ1bmN0aW9uIGdldE1vZGUobW9kZSkge1xuICAgICAgICBzd2l0Y2ggKG1vZGUpIHtcbiAgICAgICAgICAgIGNhc2UgbGF5b3V0Q29tbW9uLkVYQUNUTFk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiRXhhY3RcIjtcbiAgICAgICAgICAgIGNhc2UgbGF5b3V0Q29tbW9uLkFUX01PU1Q6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiQXRNb3N0XCI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBcIlVuc3BlY2lmaWVkXCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGF5b3V0Q29tbW9uLmdldE1vZGUgPSBnZXRNb2RlO1xuICAgIGZ1bmN0aW9uIGdldE1lYXN1cmVTcGVjTW9kZShzcGVjKSB7XG4gICAgICAgIHJldHVybiAoc3BlYyAmIE1PREVfTUFTSyk7XG4gICAgfVxuICAgIGxheW91dENvbW1vbi5nZXRNZWFzdXJlU3BlY01vZGUgPSBnZXRNZWFzdXJlU3BlY01vZGU7XG4gICAgZnVuY3Rpb24gZ2V0TWVhc3VyZVNwZWNTaXplKHNwZWMpIHtcbiAgICAgICAgcmV0dXJuIChzcGVjICYgfk1PREVfTUFTSyk7XG4gICAgfVxuICAgIGxheW91dENvbW1vbi5nZXRNZWFzdXJlU3BlY1NpemUgPSBnZXRNZWFzdXJlU3BlY1NpemU7XG4gICAgZnVuY3Rpb24gbWVhc3VyZVNwZWNUb1N0cmluZyhtZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgbW9kZSA9IGdldE1lYXN1cmVTcGVjTW9kZShtZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBzaXplID0gZ2V0TWVhc3VyZVNwZWNTaXplKG1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHRleHQgPSBcIk1lYXN1cmVTcGVjOiBcIjtcbiAgICAgICAgaWYgKG1vZGUgPT09IGxheW91dENvbW1vbi5VTlNQRUNJRklFRCkge1xuICAgICAgICAgICAgdGV4dCArPSBcIlVOU1BFQ0lGSUVEIFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG1vZGUgPT09IGxheW91dENvbW1vbi5FWEFDVExZKSB7XG4gICAgICAgICAgICB0ZXh0ICs9IFwiRVhBQ1RMWSBcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChtb2RlID09PSBsYXlvdXRDb21tb24uQVRfTU9TVCkge1xuICAgICAgICAgICAgdGV4dCArPSBcIkFUX01PU1QgXCI7XG4gICAgICAgIH1cbiAgICAgICAgdGV4dCArPSBzaXplO1xuICAgICAgICByZXR1cm4gdGV4dDtcbiAgICB9XG4gICAgbGF5b3V0Q29tbW9uLm1lYXN1cmVTcGVjVG9TdHJpbmcgPSBtZWFzdXJlU3BlY1RvU3RyaW5nO1xuICAgIGZ1bmN0aW9uIHJvdW5kKHZhbHVlKSB7XG4gICAgICAgIHZhciByZXMgPSBNYXRoLmZsb29yKHZhbHVlICsgMC41KTtcbiAgICAgICAgaWYgKHJlcyAhPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIGxheW91dENvbW1vbi5yb3VuZCA9IHJvdW5kO1xufSkobGF5b3V0Q29tbW9uID0gZXhwb3J0cy5sYXlvdXRDb21tb24gfHwgKGV4cG9ydHMubGF5b3V0Q29tbW9uID0ge30pKTtcbmZ1bmN0aW9uIGlzRmlsZU9yUmVzb3VyY2VQYXRoKHBhdGgpIHtcbiAgICBpZiAoIXR5cGVzLmlzU3RyaW5nKHBhdGgpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHBhdGguaW5kZXhPZihcIn4vXCIpID09PSAwIHx8XG4gICAgICAgIHBhdGguaW5kZXhPZihcIi9cIikgPT09IDAgfHxcbiAgICAgICAgcGF0aC5pbmRleE9mKGV4cG9ydHMuUkVTT1VSQ0VfUFJFRklYKSA9PT0gMDtcbn1cbmV4cG9ydHMuaXNGaWxlT3JSZXNvdXJjZVBhdGggPSBpc0ZpbGVPclJlc291cmNlUGF0aDtcbmZ1bmN0aW9uIGlzRm9udEljb25VUkkodXJpKSB7XG4gICAgaWYgKCF0eXBlcy5pc1N0cmluZyh1cmkpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGZpcnN0U2VnbWVudCA9IHVyaS50cmltKCkuc3BsaXQoXCIvL1wiKVswXTtcbiAgICByZXR1cm4gZmlyc3RTZWdtZW50ICYmIGZpcnN0U2VnbWVudC5pbmRleE9mKFwiZm9udDpcIikgPT09IDA7XG59XG5leHBvcnRzLmlzRm9udEljb25VUkkgPSBpc0ZvbnRJY29uVVJJO1xuZnVuY3Rpb24gaXNEYXRhVVJJKHVyaSkge1xuICAgIGlmICghdHlwZXMuaXNTdHJpbmcodXJpKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBmaXJzdFNlZ21lbnQgPSB1cmkudHJpbSgpLnNwbGl0KFwiLFwiKVswXTtcbiAgICByZXR1cm4gZmlyc3RTZWdtZW50ICYmIGZpcnN0U2VnbWVudC5pbmRleE9mKFwiZGF0YTpcIikgPT09IDAgJiYgZmlyc3RTZWdtZW50LmluZGV4T2YoXCJiYXNlNjRcIikgPj0gMDtcbn1cbmV4cG9ydHMuaXNEYXRhVVJJID0gaXNEYXRhVVJJO1xuZnVuY3Rpb24gbWVyZ2VTb3J0KGFyciwgY29tcGFyZUZ1bmMpIHtcbiAgICBpZiAoYXJyLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuIGFycjtcbiAgICB9XG4gICAgdmFyIG1pZGRsZSA9IGFyci5sZW5ndGggLyAyO1xuICAgIHZhciBsZWZ0ID0gYXJyLnNsaWNlKDAsIG1pZGRsZSk7XG4gICAgdmFyIHJpZ2h0ID0gYXJyLnNsaWNlKG1pZGRsZSwgYXJyLmxlbmd0aCk7XG4gICAgcmV0dXJuIG1lcmdlKG1lcmdlU29ydChsZWZ0LCBjb21wYXJlRnVuYyksIG1lcmdlU29ydChyaWdodCwgY29tcGFyZUZ1bmMpLCBjb21wYXJlRnVuYyk7XG59XG5leHBvcnRzLm1lcmdlU29ydCA9IG1lcmdlU29ydDtcbmZ1bmN0aW9uIG1lcmdlKGxlZnQsIHJpZ2h0LCBjb21wYXJlRnVuYykge1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICB3aGlsZSAobGVmdC5sZW5ndGggJiYgcmlnaHQubGVuZ3RoKSB7XG4gICAgICAgIGlmIChjb21wYXJlRnVuYyhsZWZ0WzBdLCByaWdodFswXSkgPD0gMCkge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2gobGVmdC5zaGlmdCgpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHJpZ2h0LnNoaWZ0KCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHdoaWxlIChsZWZ0Lmxlbmd0aCkge1xuICAgICAgICByZXN1bHQucHVzaChsZWZ0LnNoaWZ0KCkpO1xuICAgIH1cbiAgICB3aGlsZSAocmlnaHQubGVuZ3RoKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKHJpZ2h0LnNoaWZ0KCkpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZXhwb3J0cy5tZXJnZSA9IG1lcmdlO1xuZnVuY3Rpb24gaGFzRHVwbGljYXRlcyhhcnIpIHtcbiAgICByZXR1cm4gYXJyLmxlbmd0aCAhPT0gZWxpbWluYXRlRHVwbGljYXRlcyhhcnIpLmxlbmd0aDtcbn1cbmV4cG9ydHMuaGFzRHVwbGljYXRlcyA9IGhhc0R1cGxpY2F0ZXM7XG5mdW5jdGlvbiBlbGltaW5hdGVEdXBsaWNhdGVzKGFycikge1xuICAgIHJldHVybiBBcnJheS5mcm9tKG5ldyBTZXQoYXJyKSk7XG59XG5leHBvcnRzLmVsaW1pbmF0ZUR1cGxpY2F0ZXMgPSBlbGltaW5hdGVEdXBsaWNhdGVzO1xuZnVuY3Rpb24gZXhlY3V0ZU9uTWFpblRocmVhZChmdW5jKSB7XG4gICAgaWYgKG1haW50aHJlYWRfaGVscGVyXzEuaXNNYWluVGhyZWFkKCkpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmMoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG1haW50aHJlYWRfaGVscGVyXzEuZGlzcGF0Y2hUb01haW5UaHJlYWQoZnVuYyk7XG4gICAgfVxufVxuZXhwb3J0cy5leGVjdXRlT25NYWluVGhyZWFkID0gZXhlY3V0ZU9uTWFpblRocmVhZDtcbmZ1bmN0aW9uIG1haW5UaHJlYWRpZnkoZnVuYykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBhcmdzVG9QYXNzID0gYXJndW1lbnRzO1xuICAgICAgICBleGVjdXRlT25NYWluVGhyZWFkKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZ1bmMuYXBwbHkoX3RoaXMsIGFyZ3NUb1Bhc3MpOyB9KTtcbiAgICB9O1xufVxuZXhwb3J0cy5tYWluVGhyZWFkaWZ5ID0gbWFpblRocmVhZGlmeTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vdHJhY2VcIik7XG52YXIgdXRpbHNfY29tbW9uXzEgPSByZXF1aXJlKFwiLi91dGlscy1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi91dGlscy1jb21tb25cIikpO1xudmFyIGFwcGxpY2F0aW9uXzEgPSByZXF1aXJlKFwiLi4vYXBwbGljYXRpb25cIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi9wbGF0Zm9ybVwiKTtcbnZhciBmaWxlX3N5c3RlbV9hY2Nlc3NfMSA9IHJlcXVpcmUoXCIuLi9maWxlLXN5c3RlbS9maWxlLXN5c3RlbS1hY2Nlc3NcIik7XG52YXIgTUlOX1VSSV9TSEFSRV9SRVNUUklDVEVEX0FQS19WRVJTSU9OID0gMjQ7XG52YXIgbGF5b3V0O1xuKGZ1bmN0aW9uIChsYXlvdXQpIHtcbiAgICB2YXIgZGVuc2l0eTtcbiAgICB2YXIgTU9ERV9TSElGVCA9IDMwO1xuICAgIHZhciBNT0RFX01BU0sgPSAweDMgPDwgTU9ERV9TSElGVDtcbiAgICB2YXIgc2RrVmVyc2lvbjtcbiAgICB2YXIgdXNlT2xkTWVhc3VyZVNwZWMgPSBmYWxzZTtcbiAgICBmdW5jdGlvbiBtYWtlTWVhc3VyZVNwZWMoc2l6ZSwgbW9kZSkge1xuICAgICAgICBpZiAoc2RrVmVyc2lvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzZGtWZXJzaW9uID0gYWQuZ2V0QXBwbGljYXRpb25Db250ZXh0KCkuZ2V0QXBwbGljYXRpb25JbmZvKCkudGFyZ2V0U2RrVmVyc2lvbjtcbiAgICAgICAgICAgIHVzZU9sZE1lYXN1cmVTcGVjID0gc2RrVmVyc2lvbiA8PSBhbmRyb2lkLm9zLkJ1aWxkLlZFUlNJT05fQ09ERVMuSkVMTFlfQkVBTl9NUjE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVzZU9sZE1lYXN1cmVTcGVjKSB7XG4gICAgICAgICAgICByZXR1cm4gc2l6ZSArIG1vZGU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChzaXplICYgfk1PREVfTUFTSykgfCAobW9kZSAmIE1PREVfTUFTSyk7XG4gICAgfVxuICAgIGxheW91dC5tYWtlTWVhc3VyZVNwZWMgPSBtYWtlTWVhc3VyZVNwZWM7XG4gICAgZnVuY3Rpb24gZ2V0RGlzcGxheURlbnNpdHkoKSB7XG4gICAgICAgIGlmIChkZW5zaXR5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGRlbnNpdHkgPSBhZC5nZXRSZXNvdXJjZXMoKS5nZXREaXNwbGF5TWV0cmljcygpLmRlbnNpdHk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlbnNpdHk7XG4gICAgfVxuICAgIGxheW91dC5nZXREaXNwbGF5RGVuc2l0eSA9IGdldERpc3BsYXlEZW5zaXR5O1xuICAgIGZ1bmN0aW9uIHRvRGV2aWNlUGl4ZWxzKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSAqIGdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgfVxuICAgIGxheW91dC50b0RldmljZVBpeGVscyA9IHRvRGV2aWNlUGl4ZWxzO1xuICAgIGZ1bmN0aW9uIHRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlIC8gZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICB9XG4gICAgbGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMgPSB0b0RldmljZUluZGVwZW5kZW50UGl4ZWxzO1xuICAgIGZ1bmN0aW9uIG1lYXN1cmVOYXRpdmVWaWV3KG5hdGl2ZVZpZXcsIHdpZHRoLCB3aWR0aE1vZGUsIGhlaWdodCwgaGVpZ2h0TW9kZSkge1xuICAgICAgICB2YXIgdmlldyA9IG5hdGl2ZVZpZXc7XG4gICAgICAgIHZpZXcubWVhc3VyZShtYWtlTWVhc3VyZVNwZWMod2lkdGgsIHdpZHRoTW9kZSksIG1ha2VNZWFzdXJlU3BlYyhoZWlnaHQsIGhlaWdodE1vZGUpKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHdpZHRoOiB2aWV3LmdldE1lYXN1cmVkV2lkdGgoKSxcbiAgICAgICAgICAgIGhlaWdodDogdmlldy5nZXRNZWFzdXJlZEhlaWdodCgpXG4gICAgICAgIH07XG4gICAgfVxuICAgIGxheW91dC5tZWFzdXJlTmF0aXZlVmlldyA9IG1lYXN1cmVOYXRpdmVWaWV3O1xufSkobGF5b3V0ID0gZXhwb3J0cy5sYXlvdXQgfHwgKGV4cG9ydHMubGF5b3V0ID0ge30pKTtcbk9iamVjdC5hc3NpZ24obGF5b3V0LCB1dGlsc19jb21tb25fMS5sYXlvdXRDb21tb24pO1xudmFyIGFkO1xuKGZ1bmN0aW9uIChhZCkge1xuICAgIHZhciBhcHBsaWNhdGlvbjtcbiAgICB2YXIgYXBwbGljYXRpb25Db250ZXh0O1xuICAgIHZhciBjb250ZXh0UmVzb3VyY2VzO1xuICAgIHZhciBwYWNrYWdlTmFtZTtcbiAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkNvbnRleHQoKSB7XG4gICAgICAgIGlmICghYXBwbGljYXRpb25Db250ZXh0KSB7XG4gICAgICAgICAgICBhcHBsaWNhdGlvbkNvbnRleHQgPSBnZXRBcHBsaWNhdGlvbigpLmdldEFwcGxpY2F0aW9uQ29udGV4dCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcHBsaWNhdGlvbkNvbnRleHQ7XG4gICAgfVxuICAgIGFkLmdldEFwcGxpY2F0aW9uQ29udGV4dCA9IGdldEFwcGxpY2F0aW9uQ29udGV4dDtcbiAgICBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbigpIHtcbiAgICAgICAgaWYgKCFhcHBsaWNhdGlvbikge1xuICAgICAgICAgICAgYXBwbGljYXRpb24gPSBhcHBsaWNhdGlvbl8xLmdldE5hdGl2ZUFwcGxpY2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFwcGxpY2F0aW9uO1xuICAgIH1cbiAgICBhZC5nZXRBcHBsaWNhdGlvbiA9IGdldEFwcGxpY2F0aW9uO1xuICAgIGZ1bmN0aW9uIGdldFJlc291cmNlcygpIHtcbiAgICAgICAgaWYgKCFjb250ZXh0UmVzb3VyY2VzKSB7XG4gICAgICAgICAgICBjb250ZXh0UmVzb3VyY2VzID0gZ2V0QXBwbGljYXRpb24oKS5nZXRSZXNvdXJjZXMoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29udGV4dFJlc291cmNlcztcbiAgICB9XG4gICAgYWQuZ2V0UmVzb3VyY2VzID0gZ2V0UmVzb3VyY2VzO1xuICAgIGZ1bmN0aW9uIGdldFBhY2thZ2VOYW1lKCkge1xuICAgICAgICBpZiAoIXBhY2thZ2VOYW1lKSB7XG4gICAgICAgICAgICBwYWNrYWdlTmFtZSA9IGdldEFwcGxpY2F0aW9uQ29udGV4dCgpLmdldFBhY2thZ2VOYW1lKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhY2thZ2VOYW1lO1xuICAgIH1cbiAgICB2YXIgaW5wdXRNZXRob2RNYW5hZ2VyO1xuICAgIGZ1bmN0aW9uIGdldElucHV0TWV0aG9kTWFuYWdlcigpIHtcbiAgICAgICAgaWYgKCFpbnB1dE1ldGhvZE1hbmFnZXIpIHtcbiAgICAgICAgICAgIGlucHV0TWV0aG9kTWFuYWdlciA9IGdldEFwcGxpY2F0aW9uQ29udGV4dCgpLmdldFN5c3RlbVNlcnZpY2UoYW5kcm9pZC5jb250ZW50LkNvbnRleHQuSU5QVVRfTUVUSE9EX1NFUlZJQ0UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbnB1dE1ldGhvZE1hbmFnZXI7XG4gICAgfVxuICAgIGFkLmdldElucHV0TWV0aG9kTWFuYWdlciA9IGdldElucHV0TWV0aG9kTWFuYWdlcjtcbiAgICBmdW5jdGlvbiBzaG93U29mdElucHV0KG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgdmFyIGlucHV0TWFuYWdlciA9IGdldElucHV0TWV0aG9kTWFuYWdlcigpO1xuICAgICAgICBpZiAoaW5wdXRNYW5hZ2VyICYmIG5hdGl2ZVZpZXcgaW5zdGFuY2VvZiBhbmRyb2lkLnZpZXcuVmlldykge1xuICAgICAgICAgICAgaW5wdXRNYW5hZ2VyLnNob3dTb2Z0SW5wdXQobmF0aXZlVmlldywgYW5kcm9pZC52aWV3LmlucHV0bWV0aG9kLklucHV0TWV0aG9kTWFuYWdlci5TSE9XX0lNUExJQ0lUKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhZC5zaG93U29mdElucHV0ID0gc2hvd1NvZnRJbnB1dDtcbiAgICBmdW5jdGlvbiBkaXNtaXNzU29mdElucHV0KG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgdmFyIGlucHV0TWFuYWdlciA9IGdldElucHV0TWV0aG9kTWFuYWdlcigpO1xuICAgICAgICB2YXIgd2luZG93VG9rZW47XG4gICAgICAgIGlmIChuYXRpdmVWaWV3IGluc3RhbmNlb2YgYW5kcm9pZC52aWV3LlZpZXcpIHtcbiAgICAgICAgICAgIHdpbmRvd1Rva2VuID0gbmF0aXZlVmlldy5nZXRXaW5kb3dUb2tlbigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFwcGxpY2F0aW9uXzEuYW5kcm9pZC5mb3JlZ3JvdW5kQWN0aXZpdHkgaW5zdGFuY2VvZiBhbmRyb2lkeC5hcHBjb21wYXQuYXBwLkFwcENvbXBhdEFjdGl2aXR5KSB7XG4gICAgICAgICAgICB2YXIgZGVjb3JWaWV3ID0gYXBwbGljYXRpb25fMS5hbmRyb2lkLmZvcmVncm91bmRBY3Rpdml0eS5nZXRXaW5kb3coKS5nZXREZWNvclZpZXcoKTtcbiAgICAgICAgICAgIHdpbmRvd1Rva2VuID0gZGVjb3JWaWV3ID8gZGVjb3JWaWV3LmdldFdpbmRvd1Rva2VuKCkgOiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbnB1dE1hbmFnZXIgJiYgd2luZG93VG9rZW4pIHtcbiAgICAgICAgICAgIGlucHV0TWFuYWdlci5oaWRlU29mdElucHV0RnJvbVdpbmRvdyh3aW5kb3dUb2tlbiwgMCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWQuZGlzbWlzc1NvZnRJbnB1dCA9IGRpc21pc3NTb2Z0SW5wdXQ7XG4gICAgdmFyIGNvbGxlY3Rpb25zO1xuICAgIChmdW5jdGlvbiAoY29sbGVjdGlvbnMpIHtcbiAgICAgICAgZnVuY3Rpb24gc3RyaW5nQXJyYXlUb1N0cmluZ1NldChzdHIpIHtcbiAgICAgICAgICAgIHZhciBoYXNoU2V0ID0gbmV3IGphdmEudXRpbC5IYXNoU2V0KCk7XG4gICAgICAgICAgICBpZiAoc3RyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBlbGVtZW50IGluIHN0cikge1xuICAgICAgICAgICAgICAgICAgICBoYXNoU2V0LmFkZChcIlwiICsgc3RyW2VsZW1lbnRdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaGFzaFNldDtcbiAgICAgICAgfVxuICAgICAgICBjb2xsZWN0aW9ucy5zdHJpbmdBcnJheVRvU3RyaW5nU2V0ID0gc3RyaW5nQXJyYXlUb1N0cmluZ1NldDtcbiAgICAgICAgZnVuY3Rpb24gc3RyaW5nU2V0VG9TdHJpbmdBcnJheShzdHJpbmdTZXQpIHtcbiAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgICAgIGlmIChzdHJpbmdTZXQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHZhciBpdF8xID0gc3RyaW5nU2V0Lml0ZXJhdG9yKCk7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGl0XzEuaGFzTmV4dCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gXCJcIiArIGl0XzEubmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICBhcnIucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYXJyO1xuICAgICAgICB9XG4gICAgICAgIGNvbGxlY3Rpb25zLnN0cmluZ1NldFRvU3RyaW5nQXJyYXkgPSBzdHJpbmdTZXRUb1N0cmluZ0FycmF5O1xuICAgIH0pKGNvbGxlY3Rpb25zID0gYWQuY29sbGVjdGlvbnMgfHwgKGFkLmNvbGxlY3Rpb25zID0ge30pKTtcbiAgICB2YXIgcmVzb3VyY2VzO1xuICAgIChmdW5jdGlvbiAocmVzb3VyY2VzXzEpIHtcbiAgICAgICAgdmFyIGF0dHI7XG4gICAgICAgIHZhciBhdHRyQ2FjaGUgPSBuZXcgTWFwKCk7XG4gICAgICAgIGZ1bmN0aW9uIGdldERyYXdhYmxlSWQobmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIGdldElkKFwiOmRyYXdhYmxlL1wiICsgbmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzb3VyY2VzXzEuZ2V0RHJhd2FibGVJZCA9IGdldERyYXdhYmxlSWQ7XG4gICAgICAgIGZ1bmN0aW9uIGdldFN0cmluZ0lkKG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRJZChcIjpzdHJpbmcvXCIgKyBuYW1lKTtcbiAgICAgICAgfVxuICAgICAgICByZXNvdXJjZXNfMS5nZXRTdHJpbmdJZCA9IGdldFN0cmluZ0lkO1xuICAgICAgICBmdW5jdGlvbiBnZXRJZChuYW1lKSB7XG4gICAgICAgICAgICB2YXIgcmVzb3VyY2VzID0gZ2V0UmVzb3VyY2VzKCk7XG4gICAgICAgICAgICB2YXIgcGFja2FnZU5hbWUgPSBnZXRQYWNrYWdlTmFtZSgpO1xuICAgICAgICAgICAgdmFyIHVyaSA9IHBhY2thZ2VOYW1lICsgbmFtZTtcbiAgICAgICAgICAgIHJldHVybiByZXNvdXJjZXMuZ2V0SWRlbnRpZmllcih1cmksIG51bGwsIG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIHJlc291cmNlc18xLmdldElkID0gZ2V0SWQ7XG4gICAgICAgIGZ1bmN0aW9uIGdldFBhbGxldGVDb2xvcihuYW1lLCBjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0UGFsZXR0ZUNvbG9yKG5hbWUsIGNvbnRleHQpO1xuICAgICAgICB9XG4gICAgICAgIHJlc291cmNlc18xLmdldFBhbGxldGVDb2xvciA9IGdldFBhbGxldGVDb2xvcjtcbiAgICAgICAgZnVuY3Rpb24gZ2V0UGFsZXR0ZUNvbG9yKG5hbWUsIGNvbnRleHQpIHtcbiAgICAgICAgICAgIGlmIChhdHRyQ2FjaGUuaGFzKG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF0dHJDYWNoZS5nZXQobmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gMDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhdHRyKSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dHIgPSBqYXZhLmxhbmcuQ2xhc3MuZm9yTmFtZShcImFuZHJvaWR4LmFwcGNvbXBhdC5SJGF0dHJcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjb2xvcklEID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgZmllbGQgPSBhdHRyLmdldEZpZWxkKG5hbWUpO1xuICAgICAgICAgICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICBjb2xvcklEID0gZmllbGQuZ2V0SW50KG51bGwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY29sb3JJRCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZWRWYWx1ZSA9IG5ldyBhbmRyb2lkLnV0aWwuVHlwZWRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmdldFRoZW1lKCkucmVzb2x2ZUF0dHJpYnV0ZShjb2xvcklELCB0eXBlZFZhbHVlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdHlwZWRWYWx1ZS5kYXRhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDYW5ub3QgZ2V0IHBhbGxldGUgY29sb3I6IFwiICsgbmFtZSwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF0dHJDYWNoZS5zZXQobmFtZSwgcmVzdWx0KTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmVzb3VyY2VzXzEuZ2V0UGFsZXR0ZUNvbG9yID0gZ2V0UGFsZXR0ZUNvbG9yO1xuICAgIH0pKHJlc291cmNlcyA9IGFkLnJlc291cmNlcyB8fCAoYWQucmVzb3VyY2VzID0ge30pKTtcbn0pKGFkID0gZXhwb3J0cy5hZCB8fCAoZXhwb3J0cy5hZCA9IHt9KSk7XG5mdW5jdGlvbiBHQygpIHtcbiAgICBnYygpO1xufVxuZXhwb3J0cy5HQyA9IEdDO1xuZnVuY3Rpb24gcmVsZWFzZU5hdGl2ZU9iamVjdChvYmplY3QpIHtcbiAgICBfX3JlbGVhc2VOYXRpdmVDb3VudGVycGFydChvYmplY3QpO1xufVxuZXhwb3J0cy5yZWxlYXNlTmF0aXZlT2JqZWN0ID0gcmVsZWFzZU5hdGl2ZU9iamVjdDtcbmZ1bmN0aW9uIG9wZW5VcmwobG9jYXRpb24pIHtcbiAgICB2YXIgY29udGV4dCA9IGFkLmdldEFwcGxpY2F0aW9uQ29udGV4dCgpO1xuICAgIHRyeSB7XG4gICAgICAgIHZhciBpbnRlbnQgPSBuZXcgYW5kcm9pZC5jb250ZW50LkludGVudChhbmRyb2lkLmNvbnRlbnQuSW50ZW50LkFDVElPTl9WSUVXLCBhbmRyb2lkLm5ldC5VcmkucGFyc2UobG9jYXRpb24udHJpbSgpKSk7XG4gICAgICAgIGludGVudC5hZGRGbGFncyhhbmRyb2lkLmNvbnRlbnQuSW50ZW50LkZMQUdfQUNUSVZJVFlfTkVXX1RBU0spO1xuICAgICAgICBjb250ZXh0LnN0YXJ0QWN0aXZpdHkoaW50ZW50KTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgdHJhY2VfMS53cml0ZShcIkVycm9yIGluIE9wZW5VUkxcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbmV4cG9ydHMub3BlblVybCA9IG9wZW5Vcmw7XG5mdW5jdGlvbiBpc0V4dGVybmFsU3RvcmFnZVJlYWRPbmx5KCkge1xuICAgIHZhciBleHRTdG9yYWdlU3RhdGUgPSBhbmRyb2lkLm9zLkVudmlyb25tZW50LmdldEV4dGVybmFsU3RvcmFnZVN0YXRlKCk7XG4gICAgaWYgKGFuZHJvaWQub3MuRW52aXJvbm1lbnQuTUVESUFfTU9VTlRFRF9SRUFEX09OTFkgPT09IGV4dFN0b3JhZ2VTdGF0ZSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gaXNFeHRlcm5hbFN0b3JhZ2VBdmFpbGFibGUoKSB7XG4gICAgdmFyIGV4dFN0b3JhZ2VTdGF0ZSA9IGFuZHJvaWQub3MuRW52aXJvbm1lbnQuZ2V0RXh0ZXJuYWxTdG9yYWdlU3RhdGUoKTtcbiAgICBpZiAoYW5kcm9pZC5vcy5FbnZpcm9ubWVudC5NRURJQV9NT1VOVEVEID09PSBleHRTdG9yYWdlU3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGdldE1pbWVUeXBlTmFtZUZyb21FeHRlbnNpb24oZmlsZVBhdGgpIHtcbiAgICB2YXIgbWltZVR5cGVNYXAgPSBhbmRyb2lkLndlYmtpdC5NaW1lVHlwZU1hcC5nZXRTaW5nbGV0b24oKTtcbiAgICB2YXIgZXh0ZW5zaW9uID0gbmV3IGZpbGVfc3lzdGVtX2FjY2Vzc18xLkZpbGVTeXN0ZW1BY2Nlc3MoKVxuICAgICAgICAuZ2V0RmlsZUV4dGVuc2lvbihmaWxlUGF0aClcbiAgICAgICAgLnJlcGxhY2UoXCIuXCIsIFwiXCIpXG4gICAgICAgIC50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBtaW1lVHlwZU1hcC5nZXRNaW1lVHlwZUZyb21FeHRlbnNpb24oZXh0ZW5zaW9uKTtcbn1cbmZ1bmN0aW9uIG9wZW5GaWxlKGZpbGVQYXRoKSB7XG4gICAgdmFyIGNvbnRleHQgPSBhZC5nZXRBcHBsaWNhdGlvbkNvbnRleHQoKTtcbiAgICB0cnkge1xuICAgICAgICBpZiAoIWlzRXh0ZXJuYWxTdG9yYWdlQXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJcXG5FeHRlcm5hbCBzdG9yYWdlIGlzIHVuYXZhaWxhYmxlIChwbGVhc2UgY2hlY2sgYXBwIHBlcm1pc3Npb25zKS5cXG5BcHBsaWNhdGlvbnMgY2Fubm90IGFjY2VzcyBpbnRlcm5hbCBzdG9yYWdlIG9mIG90aGVyIGFwcGxpY2F0aW9uIG9uIEFuZHJvaWQgKHNlZTogaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vZ3VpZGUvdG9waWNzL2RhdGEvZGF0YS1zdG9yYWdlKS5cXG5cIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNFeHRlcm5hbFN0b3JhZ2VSZWFkT25seSgpKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiRXh0ZXJuYWwgc3RvcmFnZSBpcyByZWFkIG9ubHlcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWltZVR5cGUgPSBnZXRNaW1lVHlwZU5hbWVGcm9tRXh0ZW5zaW9uKGZpbGVQYXRoKTtcbiAgICAgICAgdmFyIGludGVudCA9IG5ldyBhbmRyb2lkLmNvbnRlbnQuSW50ZW50KGFuZHJvaWQuY29udGVudC5JbnRlbnQuQUNUSU9OX1ZJRVcpO1xuICAgICAgICB2YXIgY2hvb3NlckludGVudCA9IGFuZHJvaWQuY29udGVudC5JbnRlbnQuY3JlYXRlQ2hvb3NlcihpbnRlbnQsIFwiT3BlbiBGaWxlLi4uXCIpO1xuICAgICAgICBpbnRlbnQuYWRkRmxhZ3MoYW5kcm9pZC5jb250ZW50LkludGVudC5GTEFHX0FDVElWSVRZX05FV19UQVNLKTtcbiAgICAgICAgY2hvb3NlckludGVudC5hZGRGbGFncyhhbmRyb2lkLmNvbnRlbnQuSW50ZW50LkZMQUdfQUNUSVZJVFlfTkVXX1RBU0spO1xuICAgICAgICB2YXIgc2RrVmVyc2lvbiA9IHBhcnNlSW50KHBsYXRmb3JtXzEuZGV2aWNlLnNka1ZlcnNpb24sIDEwKTtcbiAgICAgICAgaWYgKHNka1ZlcnNpb24gJiYgc2RrVmVyc2lvbiA8IE1JTl9VUklfU0hBUkVfUkVTVFJJQ1RFRF9BUEtfVkVSU0lPTikge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcImRldGVjdGVkIHNkayB2ZXJzaW9uIFwiICsgc2RrVmVyc2lvbiArIFwiICg8IFwiICsgTUlOX1VSSV9TSEFSRV9SRVNUUklDVEVEX0FQS19WRVJTSU9OICsgXCIpLCB1c2luZyBzaW1wbGUgb3BlbkZpbGVcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgICAgIGludGVudC5zZXREYXRhQW5kVHlwZShhbmRyb2lkLm5ldC5VcmkuZnJvbUZpbGUobmV3IGphdmEuaW8uRmlsZShmaWxlUGF0aCkpLCBtaW1lVHlwZSk7XG4gICAgICAgICAgICBjb250ZXh0LnN0YXJ0QWN0aXZpdHkoY2hvb3NlckludGVudCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0cmFjZV8xLndyaXRlKFwiZGV0ZWN0ZWQgc2RrIHZlcnNpb24gXCIgKyBzZGtWZXJzaW9uICsgXCIgKD49IFwiICsgTUlOX1VSSV9TSEFSRV9SRVNUUklDVEVEX0FQS19WRVJTSU9OICsgXCIpLCB1c2luZyBVUkkgb3BlbkZpbGVcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgdmFyIHByb3ZpZGVyTmFtZSA9IGNvbnRleHQuZ2V0UGFja2FnZU5hbWUoKSArIFwiLnByb3ZpZGVyXCI7XG4gICAgICAgIHRyYWNlXzEud3JpdGUoXCJmdWxseS1xdWFsaWZpZWQgcHJvdmlkZXIgbmFtZSBbXCIgKyBwcm92aWRlck5hbWUgKyBcIl1cIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgdmFyIGFwa1VSSSA9IGFuZHJvaWR4LmNvcmUuY29udGVudC5GaWxlUHJvdmlkZXIuZ2V0VXJpRm9yRmlsZShjb250ZXh0LCBwcm92aWRlck5hbWUsIG5ldyBqYXZhLmlvLkZpbGUoZmlsZVBhdGgpKTtcbiAgICAgICAgaW50ZW50LmFkZEZsYWdzKGFuZHJvaWQuY29udGVudC5JbnRlbnQuRkxBR19HUkFOVF9SRUFEX1VSSV9QRVJNSVNTSU9OKTtcbiAgICAgICAgY2hvb3NlckludGVudC5hZGRGbGFncyhhbmRyb2lkLmNvbnRlbnQuSW50ZW50LkZMQUdfR1JBTlRfUkVBRF9VUklfUEVSTUlTU0lPTik7XG4gICAgICAgIGludGVudC5zZXREYXRhQW5kVHlwZShhcGtVUkksIG1pbWVUeXBlKTtcbiAgICAgICAgY29udGV4dC5zdGFydEFjdGl2aXR5KGNob29zZXJJbnRlbnQpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICB2YXIgbXNnXzEgPSBlcnIubWVzc2FnZSA/IFwiOiBcIiArIGVyci5tZXNzYWdlIDogXCJcIjtcbiAgICAgICAgdHJhY2VfMS53cml0ZShcIkVycm9yIGluIG9wZW5GaWxlXCIgKyBtc2dfMSwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgaWYgKG1zZ18xICYmXG4gICAgICAgICAgICBtc2dfMS5pbmNsdWRlcyhcIkF0dGVtcHQgdG8gaW52b2tlIHZpcnR1YWwgbWV0aG9kXCIpICYmXG4gICAgICAgICAgICBtc2dfMS5pbmNsdWRlcyhcImFuZHJvaWQuY29udGVudC5wbS5Qcm92aWRlckluZm8ubG9hZFhtbE1ldGFEYXRhXCIpICYmXG4gICAgICAgICAgICBtc2dfMS5pbmNsdWRlcyhcIm9uIGEgbnVsbCBvYmplY3QgcmVmZXJlbmNlXCIpKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiXFxuUGxlYXNlIGVuc3VyZSB5b3UgaGF2ZSB5b3VyIG1hbmlmZXN0IGNvcnJlY3RseSBjb25maWd1cmVkIHdpdGggdGhlIEZpbGVQcm92aWRlci5cXG4oc2VlOiBodHRwczovL2RldmVsb3Blci5hbmRyb2lkLmNvbS9yZWZlcmVuY2UvYW5kcm9pZC9zdXBwb3J0L3Y0L2NvbnRlbnQvRmlsZVByb3ZpZGVyI1Byb3ZpZGVyRGVmaW5pdGlvbilcXG5cIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuZXhwb3J0cy5vcGVuRmlsZSA9IG9wZW5GaWxlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXRpbHMuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZWFzeXNheCA9IHJlcXVpcmUoXCIuLi9qcy1saWJzL2Vhc3lzYXhcIik7XG52YXIgUGFyc2VyRXZlbnRUeXBlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQYXJzZXJFdmVudFR5cGUoKSB7XG4gICAgfVxuICAgIFBhcnNlckV2ZW50VHlwZS5TdGFydEVsZW1lbnQgPSBcIlN0YXJ0RWxlbWVudFwiO1xuICAgIFBhcnNlckV2ZW50VHlwZS5FbmRFbGVtZW50ID0gXCJFbmRFbGVtZW50XCI7XG4gICAgUGFyc2VyRXZlbnRUeXBlLlRleHQgPSBcIlRleHRcIjtcbiAgICBQYXJzZXJFdmVudFR5cGUuQ0RBVEEgPSBcIkNEQVRBXCI7XG4gICAgUGFyc2VyRXZlbnRUeXBlLkNvbW1lbnQgPSBcIkNvbW1lbnRcIjtcbiAgICByZXR1cm4gUGFyc2VyRXZlbnRUeXBlO1xufSgpKTtcbmV4cG9ydHMuUGFyc2VyRXZlbnRUeXBlID0gUGFyc2VyRXZlbnRUeXBlO1xudmFyIFBhcnNlckV2ZW50ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQYXJzZXJFdmVudChldmVudFR5cGUsIHBvc2l0aW9uLCBwcmVmaXgsIG5hbWVzcGFjZSwgZWxlbWVudE5hbWUsIGF0dHJpYnV0ZXMsIGRhdGEpIHtcbiAgICAgICAgdGhpcy5fZXZlbnRUeXBlID0gZXZlbnRUeXBlO1xuICAgICAgICB0aGlzLl9wb3NpdGlvbiA9IHBvc2l0aW9uO1xuICAgICAgICB0aGlzLl9wcmVmaXggPSBwcmVmaXg7XG4gICAgICAgIHRoaXMuX25hbWVzcGFjZSA9IG5hbWVzcGFjZTtcbiAgICAgICAgdGhpcy5fZWxlbWVudE5hbWUgPSBlbGVtZW50TmFtZTtcbiAgICAgICAgdGhpcy5fYXR0cmlidXRlcyA9IGF0dHJpYnV0ZXM7XG4gICAgICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xuICAgIH1cbiAgICBQYXJzZXJFdmVudC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBldmVudFR5cGU6IHRoaXMuZXZlbnRUeXBlLFxuICAgICAgICAgICAgcG9zaXRpb246IHRoaXMucG9zaXRpb24sXG4gICAgICAgICAgICBwcmVmaXg6IHRoaXMucHJlZml4LFxuICAgICAgICAgICAgbmFtZXNwYWNlOiB0aGlzLm5hbWVzcGFjZSxcbiAgICAgICAgICAgIGVsZW1lbnROYW1lOiB0aGlzLmVsZW1lbnROYW1lLFxuICAgICAgICAgICAgYXR0cmlidXRlczogdGhpcy5hdHRyaWJ1dGVzLFxuICAgICAgICAgICAgZGF0YTogdGhpcy5kYXRhXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhcnNlckV2ZW50LnByb3RvdHlwZSwgXCJldmVudFR5cGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9ldmVudFR5cGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXJzZXJFdmVudC5wcm90b3R5cGUsIFwicG9zaXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhcnNlckV2ZW50LnByb3RvdHlwZSwgXCJwcmVmaXhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcmVmaXg7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXJzZXJFdmVudC5wcm90b3R5cGUsIFwibmFtZXNwYWNlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbmFtZXNwYWNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFyc2VyRXZlbnQucHJvdG90eXBlLCBcImVsZW1lbnROYW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudE5hbWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXJzZXJFdmVudC5wcm90b3R5cGUsIFwiYXR0cmlidXRlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2F0dHJpYnV0ZXM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXJzZXJFdmVudC5wcm90b3R5cGUsIFwiZGF0YVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGE7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBQYXJzZXJFdmVudDtcbn0oKSk7XG5leHBvcnRzLlBhcnNlckV2ZW50ID0gUGFyc2VyRXZlbnQ7XG52YXIgX2FtcENvZGVzO1xudmFyIF9lbnRpdHlTZWFyY2hSZWdFeCA9IC8mIyhcXGQrKTt8JiN4KFswMTIzNDU2Nzg5YWJjZGVmXSspO3wmKFxcdyspOy9pZztcbmZ1bmN0aW9uIF9nZW5lcmF0ZUFtcE1hcCgpIHtcbiAgICB2YXIgb2JqQ29kZXMgPSB7IFRhYjogOSwgTmV3TGluZTogMTAsIGV4Y2w6IDMzLCBxdW90OiAzNCwgUVVPVDogMzQsIG51bTogMzUsIGRvbGxhcjogMzYsIHBlcmNlbnQ6IDM3LCBhbXA6IDM4LCBBTVA6IDM4LCBhcG9zOiAzOSwgbHBhcjogNDAsIHJwYXI6IDQxLCBhc3Q6IDQyLCBtaWRhc3Q6IDQyLCBwbHVzOiA0MywgY29tbWE6IDQ0LCBwZXJpb2Q6IDQ2LCBzb2w6IDQ3LCBjb2xvbjogNTgsIHNlbWk6IDU5LCBsdDogNjAsIExUOiA2MCwgZXF1YWxzOiA2MSwgZ3Q6IDYyLCBHVDogNjIsIHF1ZXN0OiA2MywgY29tbWF0OiA2NCwgbHNxYjogOTEsIGxicmFjazogOTEsIGJzb2w6IDkyLCByc3FiOiA5MiwgcmJyYWNrOiA5MiwgSGF0OiA5NCwgbG93YmFyOiA5NSwgZ3JhdmU6IDk2LCBEaWFjcml0aWNhbEdyYXZlOiA5NiwgbGN1YjogMTIzLCBsYnJhY2U6IDEyMywgdmVyYmFyOiAxMjQsIHZlcnQ6IDEyNCwgVmVydGljYWxMaW5lOiAxMjQsIHJjdWI6IDEyNSwgcmJyYWNlOiAxMjUsIG5ic3A6IDE2MCwgaWV4Y2w6IDE2MSwgY2VudDogMTYyLCBwb3VuZDogMTYzLCBjdXJyZW46IDE2NCwgeWVuOiAxNjUsIGJydmJhcjogMTY2LCBicmtiYXI6IDE2Niwgc2VjdDogMTY3LCB1bWw6IDE2OCwgY29weTogMTY5LCBvcmRmOiAxNzAsIGxhcXVvOiAxNzEsIG5vdDogMTcyLCBzaHk6IDE3MywgcmVnOiAxNzQsIG1hY3I6IDE3NSwgaGliYXI6IDE3NSwgZGVnOiAxNzYsIHBsdXNtbjogMTc3LCBzdXAyOiAxNzgsIHN1cDM6IDE3OSwgYWN1dGU6IDE4MCwgbWljcm86IDE4MSwgcGFyYTogMTgyLCBtaWRkb3Q6IDE4MywgY2VkaWw6IDE4NCwgc3VwMTogMTg1LCBvcmRtOiAxODYsIHJhcXVvOiAxODcsIGZyYWMxNDogMTg4LCBmcmFjMTI6IDE4OSwgZnJhYzM0OiAxOTAsIGlxdWVzdDogMTkxLCBBZ3JhdmU6IDE5MiwgQWFjdXRlOiAxOTMsIEFjaXJjOiAxOTQsIEF0aWxkZTogMTk1LCBBdW1sOiAxOTYsIEFyaW5nOiAxOTcsIEFFbGlnOiAxOTgsIENjZWRpbDogMTk5LCBFZ3JhdmU6IDIwMCwgRWFjdXRlOiAyMDEsIEVjaXJjOiAyMDIsIEV1bWw6IDIwMywgSWdyYXZlOiAyMDQsIElhY3V0ZTogMjA1LCBJY2lyYzogMjA2LCBJdW1sOiAyMDcsIEVUSDogMjA4LCBEc3Ryb2s6IDIwOCwgTnRpbGRlOiAyMDksIE9ncmF2ZTogMjEwLCBPYWN1dGU6IDIxMSwgT2NpcmM6IDIxMiwgT3RpbGRlOiAyMTMsIE91bWw6IDIxNCwgdGltZXM6IDIxNSwgT3NsYXNoOiAyMTYsIFVncmF2ZTogMjE3LCBVYWN1dGU6IDIxOCwgVWNpcmM6IDIxOSwgVXVtbDogMjIwLCBZYWN1dGU6IDIyMSwgVEhPUk46IDIyMiwgc3psaWc6IDIyMywgYWdyYXZlOiAyMjQsIGFhY3V0ZTogMjI1LCBhY2lyYzogMjI2LCBhdGlsZGU6IDIyNywgYXVtbDogMjI4LCBhcmluZzogMjI5LCBhZWxpZzogMjMwLCBjY2VkaWw6IDIzMSwgZWdyYXZlOiAyMzIsIGVhY3V0ZTogMjMzLCBlY2lyYzogMjM0LCBldW1sOiAyMzUsIGlncmF2ZTogMjM2LCBpYWN1dGU6IDIzNywgaWNpcmM6IDIzOCwgaXVtbDogMjM5LCBldGg6IDI0MCwgbnRpbGRlOiAyNDEsIG9ncmF2ZTogMjQyLCBvYWN1dGU6IDI0Mywgb2NpcmM6IDI0NCwgb3RpbGRlOiAyNDUsIG91bWw6IDI0NiwgZGl2aWRlOiAyNDcsIG9zbGFzaDogMjQ4LCB1Z3JhdmU6IDI0OSwgdWFjdXRlOiAyNTAsIHVjaXJjOiAyNTEsIHV1bWw6IDI1MiwgeWFjdXRlOiAyNTMsIHRob3JuOiAyNTQsIHl1bWw6IDI1NSwgZm5vZjogNDAyLCBpbXBlZDogNDM3LCBnYWN1dGU6IDUwMSwgam1hdGg6IDU2NywgY2lyYzogNzEwLCBjYXJvbjogNzExLCBIYWNlazogNzExLCBicmV2ZTogNzI4LCBCcmV2ZTogNzI4LCBkb3Q6IDcyOSwgRGlhY3JpdGljYWxEb3Q6IDcyOSwgcmluZzogNzMwLCBvZ29uOiA3MzEsIHRpbGRlOiA3MzIsIERpYWNyaXRpY2FsVGlsZGU6IDczMiwgZGJsYWM6IDczMywgRGlhY3JpdGljYWxEb3VibGVBY3V0ZTogNzMzLCBEb3duQnJldmU6IDc4NSwgVW5kZXJCYXI6IDgxOCwgQWxwaGE6IDkxMywgQmV0YTogOTE0LCBHYW1tYTogOTE1LCBEZWx0YTogOTE2LCBFcHNpbG9uOiA5MTcsIFpldGE6IDkxOCwgRXRhOiA5MTksIFRoZXRhOiA5MjAsIElvdGE6IDkyMSwgS2FwcGE6IDkyMiwgTGFtYmRhOiA5MjMsIE11OiA5MjQsIE51OiA5MjUsIFhpOiA5MjYsIE9taWNyb246IDkyNywgUGk6IDkyOCwgUmhvOiA5MjksIFNpZ21hOiA5MzEsIFRhdTogOTMyLCBVcHNpbG9uOiA5MzMsIFBoaTogOTM0LCBDaGk6IDkzNSwgUHNpOiA5MzYsIE9tZWdhOiA5MzcsIGFscGhhOiA5NDUsIGJldGE6IDk0NiwgZ2FtbWE6IDk0NywgZGVsdGE6IDk0OCwgZXBzaWxvbjogOTQ5LCBlcHNpdjogOTQ5LCB2YXJlcHNpbG9uOiA5NDksIHpldGE6IDk1MCwgZXRhOiA5NTEsIHRoZXRhOiA5NTIsIGlvdGE6IDk1Mywga2FwcGE6IDk1NCwgbGFtYmRhOiA5NTUsIG11OiA5NTYsIG51OiA5NTcsIHhpOiA5NTgsIG9taWNyb246IDk1OSwgcGk6IDk2MCwgcmhvOiA5NjEsIHNpZ21hZjogOTYyLCBzaWdtYXY6IDk2MiwgdmFyc2lnbWE6IDk2Miwgc2lnbWE6IDk2MywgdGF1OiA5NjQsIHVwc2lsb246IDk2NSwgcGhpOiA5NjYsIGNoaTogOTY3LCBwc2k6IDk2OCwgb21lZ2E6IDk2OSwgdGhldGF2OiA5NzcsIHZhcnRoZXRhOiA5NzcsIHRoZXRhc3ltOiA5NzcsIFVwc2k6IDk3OCwgdXBzaWg6IDk3OCwgc3RyYWlnaHRwaGk6IDk4MSwgcGl2OiA5ODIsIHZhcnBpOiA5ODIsIEdhbW1hZDogOTg4LCBnYW1tYWQ6IDk4OSwgZGlnYW1tYTogOTg5LCBrYXBwYXY6IDEwMDgsIHZhcmthcHBhOiAxMDA4LCByaG92OiAxMDA5LCB2YXJyaG86IDEwMDksIGVwc2k6IDEwMTMsIHN0cmFpZ2h0ZXBzaWxvbjogMTAxMywgYmVwc2k6IDEwMTQsIGJhY2tlcHNpbG9uOiAxMDE0LCBldXJvOiA4MzY0LCB0cmFkZTogODQ4MiwgVFJBREU6IDg0ODIsIGZvcmFsbDogODcwNCwgcGFydDogODcwNiwgbGFycjogODU5MiwgcmFycjogODU5MywgaHlwaGVuOiA4MjA4LCBkYXNoOiA4MjA4LCBuZGFzaDogODIxMSwgbWRhc2g6IDgyMTIsIGhvcmJhcjogODIxMywgVmVydDogODIxNCwgVmVyYmFyOiA4MjE0LCBsc3F1bzogODIxNiwgT3BlbkN1cmx5UXVvdGU6IDgyMTYsIHJzcXVvOiA4MjE3LCByc3F1b3I6IDgyMTcsIENsb3NlQ3VybHlRdW90ZTogODIxNywgbHNxdW9yOiA4MjE4LCBzYnF1bzogODIxOCwgbGRxdW86IDgyMjAsIE9wZW5DdXJseURvdWJsZVF1b3RlOiA4MjIwLCByZHF1bzogODIyMSwgcmRxdW9yOiA4MjIxLCBDbG9zZUN1cmx5RG91YmxlUXVvdGU6IDgyMjEsIGxkcXVvcjogODIyMiwgYmRxdW86IDgyMjIsIGRhZ2dlcjogODIyNCwgRGFnZ2VyOiA4MjI1LCBkZGFnZ2VyOiA4MjI1LCBidWxsOiA4MjI2LCBidWxsZXQ6IDgyMjYsIG5sZHI6IDgyMjksIGhlbGxpcDogODIzMCwgbWxkcjogODIzMCwgaHlidWxsOiA4MjU5LCB0ZG90OiA4NDExLCBUcmlwbGVEb3Q6IDg0MTEsIERvdERvdDogODQxMiwgc3RhcjogOTczNCwgcGhvbmU6IDk3NDIsIHNwYWRlczogOTgyNCwgY2x1YnM6IDk4MjcsIGhlYXJ0czogOTgyOSwgZGlhbXM6IDk4MzAsIGZlbWFsZTogOTc5MiwgbWFsZTogOTc5NCwgY2hlY2s6IDEwMDAzLCBjaGVja21hcms6IDEwMDAzLCBjcm9zczogMTAwMDcsIFZlcnRpY2FsU2VwYXJhdG9yOiAxMDA3MiwgRW1wdHlTbWFsbFNxdWFyZTogOTcyMywgRmlsbGVkU21hbGxTcXVhcmU6IDk3MjQsIHN0YXJmOiA5NzMzLCBiaWdzdGFyOiA5NzMzLCBzcXVhcmU6IDk2MzMsIHNxdTogOTYzMywgU3F1YXJlOiA5NjMzIH07XG4gICAgdmFyIGFtcENvZGVzID0gbmV3IE1hcCgpO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmpDb2Rlcykge1xuICAgICAgICBpZiAob2JqQ29kZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgYW1wQ29kZXMuc2V0KGtleSwgb2JqQ29kZXNba2V5XSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGFtcENvZGVzO1xufVxuaWYgKGdsb2JhbC5fX3NuYXBzaG90KSB7XG4gICAgX2FtcENvZGVzID0gX2dlbmVyYXRlQW1wTWFwKCk7XG59XG5mdW5jdGlvbiBfSGFuZGxlQW1wRW50aXRpZXMoZm91bmQsIGRlY2ltYWxWYWx1ZSwgaGV4VmFsdWUsIHdvcmRWYWx1ZSkge1xuICAgIGlmICh3b3JkVmFsdWUpIHtcbiAgICAgICAgaWYgKCFfYW1wQ29kZXMpIHtcbiAgICAgICAgICAgIF9hbXBDb2RlcyA9IF9nZW5lcmF0ZUFtcE1hcCgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXMgPSBfYW1wQ29kZXMuZ2V0KHdvcmRWYWx1ZSk7XG4gICAgICAgIGlmIChyZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNvZGVQb2ludChyZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9XG4gICAgaWYgKGRlY2ltYWxWYWx1ZSkge1xuICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21Db2RlUG9pbnQocGFyc2VJbnQoZGVjaW1hbFZhbHVlLCAxMCkpO1xuICAgIH1cbiAgICByZXR1cm4gU3RyaW5nLmZyb21Db2RlUG9pbnQocGFyc2VJbnQoaGV4VmFsdWUsIDE2KSk7XG59XG52YXIgWG1sUGFyc2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBYbWxQYXJzZXIob25FdmVudCwgb25FcnJvciwgcHJvY2Vzc05hbWVzcGFjZXMpIHtcbiAgICAgICAgdGhpcy5fcHJvY2Vzc05hbWVzcGFjZXMgPSBwcm9jZXNzTmFtZXNwYWNlcztcbiAgICAgICAgdGhpcy5fcGFyc2VyID0gbmV3IGVhc3lzYXguRWFzeVNBWFBhcnNlcigpO1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHRoaXMuX3BhcnNlci5vbihcInN0YXJ0Tm9kZVwiLCBmdW5jdGlvbiAoZWxlbSwgYXR0ciwgdXEsIHRhZ2VuZCwgc3RyLCBwb3MpIHtcbiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVzID0gYXR0cigpO1xuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzW2tleV0gPSBYbWxQYXJzZXIuX2RlcmVmZXJlbmNlRW50aXRpZXMoYXR0cmlidXRlc1trZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwcmVmaXggPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB2YXIgbmFtZXNwYWNlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBlbGVtO1xuICAgICAgICAgICAgaWYgKHRoYXQuX3Byb2Nlc3NOYW1lc3BhY2VzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YWNrRW50cnkgPSBYbWxQYXJzZXIuX2dldE5hbWVzcGFjZXNTdGFja0VudHJ5KGF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIHRoYXQuX25hbWVzcGFjZVN0YWNrLnB1c2goc3RhY2tFbnRyeSk7XG4gICAgICAgICAgICAgICAgdmFyIHJlc29sdmVkID0gdGhhdC5fcmVzb2x2ZU5hbWVzcGFjZShuYW1lKTtcbiAgICAgICAgICAgICAgICBwcmVmaXggPSByZXNvbHZlZC5wcmVmaXg7XG4gICAgICAgICAgICAgICAgbmFtZXNwYWNlID0gcmVzb2x2ZWQubmFtZXNwYWNlO1xuICAgICAgICAgICAgICAgIG5hbWUgPSByZXNvbHZlZC5uYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb25FdmVudChuZXcgUGFyc2VyRXZlbnQoUGFyc2VyRXZlbnRUeXBlLlN0YXJ0RWxlbWVudCwgcG9zKCksIHByZWZpeCwgbmFtZXNwYWNlLCBuYW1lLCBhdHRyaWJ1dGVzLCB1bmRlZmluZWQpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3BhcnNlci5vbihcInRleHROb2RlXCIsIGZ1bmN0aW9uICh0ZXh0LCB1cSwgcG9zKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHVxKFhtbFBhcnNlci5fZGVyZWZlcmVuY2VFbnRpdGllcyh0ZXh0KSk7XG4gICAgICAgICAgICBvbkV2ZW50KG5ldyBQYXJzZXJFdmVudChQYXJzZXJFdmVudFR5cGUuVGV4dCwgcG9zKCksIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgZGF0YSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fcGFyc2VyLm9uKFwiZW5kTm9kZVwiLCBmdW5jdGlvbiAoZWxlbSwgdXEsIHRhZ3N0YXJ0LCBzdHIsIHBvcykge1xuICAgICAgICAgICAgdmFyIHByZWZpeCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHZhciBuYW1lc3BhY2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IGVsZW07XG4gICAgICAgICAgICBpZiAodGhhdC5fcHJvY2Vzc05hbWVzcGFjZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzb2x2ZWQgPSB0aGF0Ll9yZXNvbHZlTmFtZXNwYWNlKG5hbWUpO1xuICAgICAgICAgICAgICAgIHByZWZpeCA9IHJlc29sdmVkLnByZWZpeDtcbiAgICAgICAgICAgICAgICBuYW1lc3BhY2UgPSByZXNvbHZlZC5uYW1lc3BhY2U7XG4gICAgICAgICAgICAgICAgbmFtZSA9IHJlc29sdmVkLm5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvbkV2ZW50KG5ldyBQYXJzZXJFdmVudChQYXJzZXJFdmVudFR5cGUuRW5kRWxlbWVudCwgcG9zKCksIHByZWZpeCwgbmFtZXNwYWNlLCBuYW1lLCB1bmRlZmluZWQsIHVuZGVmaW5lZCkpO1xuICAgICAgICAgICAgaWYgKHRoYXQuX3Byb2Nlc3NOYW1lc3BhY2VzKSB7XG4gICAgICAgICAgICAgICAgdGhhdC5fbmFtZXNwYWNlU3RhY2sucG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9wYXJzZXIub24oXCJjZGF0YVwiLCBmdW5jdGlvbiAoZGF0YSwgcmVzLCBwb3MpIHtcbiAgICAgICAgICAgIG9uRXZlbnQobmV3IFBhcnNlckV2ZW50KFBhcnNlckV2ZW50VHlwZS5DREFUQSwgcG9zKCksIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgZGF0YSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fcGFyc2VyLm9uKFwiY29tbWVudFwiLCBmdW5jdGlvbiAodGV4dCwgdXEsIHBvcykge1xuICAgICAgICAgICAgb25FdmVudChuZXcgUGFyc2VyRXZlbnQoUGFyc2VyRXZlbnRUeXBlLkNvbW1lbnQsIHBvcygpLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHRleHQpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLl9wYXJzZXIub24oXCJlcnJvclwiLCBmdW5jdGlvbiAobXNnLCBwb3MpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihtc2cpLCBwb3MoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWG1sUGFyc2VyLnByb3RvdHlwZSwgXCJhbmd1bGFyU3ludGF4XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcGFyc2VyLmFuZ3VsYXJTeW50YXg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9wYXJzZXIuYW5ndWxhclN5bnRheCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBYbWxQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKHhtbFN0cmluZykge1xuICAgICAgICBpZiAodGhpcy5fcHJvY2Vzc05hbWVzcGFjZXMpIHtcbiAgICAgICAgICAgIHRoaXMuX25hbWVzcGFjZVN0YWNrID0gW107XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcGFyc2VyLnBhcnNlKHhtbFN0cmluZyk7XG4gICAgfTtcbiAgICBYbWxQYXJzZXIuX2dldE5hbWVzcGFjZXNTdGFja0VudHJ5ID0gZnVuY3Rpb24gKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgdmFyIHN0YWNrRW50cnkgPSB7fTtcbiAgICAgICAgaWYgKCFhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICByZXR1cm4gc3RhY2tFbnRyeTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXR0cmlidXRlTmFtZTtcbiAgICAgICAgdmFyIG5hbWVzcGFjZVByZWZpeDtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIGlmICghYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lID0ga2V5O1xuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZU5hbWUuaW5kZXhPZihcInhtbG5zXCIpICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuYW1lc3BhY2VQcmVmaXggPSBcIlwiO1xuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZU5hbWUuaW5kZXhPZihcIjpcIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgbmFtZXNwYWNlUHJlZml4ID0gYXR0cmlidXRlTmFtZS5zcGxpdChcIjpcIilbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdGFja0VudHJ5W25hbWVzcGFjZVByZWZpeF0gPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0YWNrRW50cnk7XG4gICAgfTtcbiAgICBYbWxQYXJzZXIucHJvdG90eXBlLl9yZXNvbHZlTmFtZXNwYWNlID0gZnVuY3Rpb24gKGZ1bGxOYW1lKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB7IHByZWZpeDogdW5kZWZpbmVkLCBuYW1lc3BhY2U6IHVuZGVmaW5lZCwgbmFtZTogdW5kZWZpbmVkIH07XG4gICAgICAgIHJlc3VsdC5wcmVmaXggPSBcIlwiO1xuICAgICAgICBpZiAoZnVsbE5hbWUuaW5kZXhPZihcIjpcIikgIT09IC0xKSB7XG4gICAgICAgICAgICB2YXIgc3BsaXQgPSBmdWxsTmFtZS5zcGxpdChcIjpcIik7XG4gICAgICAgICAgICByZXN1bHQucHJlZml4ID0gc3BsaXRbMF07XG4gICAgICAgICAgICByZXN1bHQubmFtZSA9IHNwbGl0WzFdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSBmdWxsTmFtZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3RhY2tFbnRyeTtcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuX25hbWVzcGFjZVN0YWNrLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBzdGFja0VudHJ5ID0gdGhpcy5fbmFtZXNwYWNlU3RhY2tbaV07XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gc3RhY2tFbnRyeSkge1xuICAgICAgICAgICAgICAgIGlmICghc3RhY2tFbnRyeS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnByZWZpeCA9PT0ga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5uYW1lc3BhY2UgPSBzdGFja0VudHJ5W2tleV07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBYbWxQYXJzZXIuX2RlcmVmZXJlbmNlRW50aXRpZXMgPSBmdW5jdGlvbiAocykge1xuICAgICAgICBzID0gU3RyaW5nKHMpO1xuICAgICAgICBpZiAocy5sZW5ndGggPiAzICYmIHMuaW5kZXhPZihcIiZcIikgIT09IC0xKSB7XG4gICAgICAgICAgICBzID0gcy5yZXBsYWNlKF9lbnRpdHlTZWFyY2hSZWdFeCwgX0hhbmRsZUFtcEVudGl0aWVzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcztcbiAgICB9O1xuICAgIHJldHVybiBYbWxQYXJzZXI7XG59KCkpO1xuZXhwb3J0cy5YbWxQYXJzZXIgPSBYbWxQYXJzZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD14bWwuanMubWFwIiwiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKVxyXG4gICAgICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICAgICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheXMoKSB7XHJcbiAgICBmb3IgKHZhciBzID0gMCwgaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHMgKz0gYXJndW1lbnRzW2ldLmxlbmd0aDtcclxuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcclxuICAgICAgICBmb3IgKHZhciBhID0gYXJndW1lbnRzW2ldLCBqID0gMCwgamwgPSBhLmxlbmd0aDsgaiA8IGpsOyBqKyssIGsrKylcclxuICAgICAgICAgICAgcltrXSA9IGFbal07XHJcbiAgICByZXR1cm4gcjtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIHJlc3VsdFtrXSA9IG1vZFtrXTtcclxuICAgIHJlc3VsdC5kZWZhdWx0ID0gbW9kO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuIiwidmFyIGc7XG5cbi8vIFRoaXMgd29ya3MgaW4gbm9uLXN0cmljdCBtb2RlXG5nID0gKGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gdGhpcztcbn0pKCk7XG5cbnRyeSB7XG5cdC8vIFRoaXMgd29ya3MgaWYgZXZhbCBpcyBhbGxvd2VkIChzZWUgQ1NQKVxuXHRnID0gZyB8fCBuZXcgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO1xufSBjYXRjaCAoZSkge1xuXHQvLyBUaGlzIHdvcmtzIGlmIHRoZSB3aW5kb3cgcmVmZXJlbmNlIGlzIGF2YWlsYWJsZVxuXHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gXCJvYmplY3RcIikgZyA9IHdpbmRvdztcbn1cblxuLy8gZyBjYW4gc3RpbGwgYmUgdW5kZWZpbmVkLCBidXQgbm90aGluZyB0byBkbyBhYm91dCBpdC4uLlxuLy8gV2UgcmV0dXJuIHVuZGVmaW5lZCwgaW5zdGVhZCBvZiBub3RoaW5nIGhlcmUsIHNvIGl0J3Ncbi8vIGVhc2llciB0byBoYW5kbGUgdGhpcyBjYXNlLiBpZighZ2xvYmFsKSB7IC4uLn1cblxubW9kdWxlLmV4cG9ydHMgPSBnO1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihtb2R1bGUpIHtcblx0aWYgKCFtb2R1bGUud2VicGFja1BvbHlmaWxsKSB7XG5cdFx0bW9kdWxlLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uKCkge307XG5cdFx0bW9kdWxlLnBhdGhzID0gW107XG5cdFx0Ly8gbW9kdWxlLnBhcmVudCA9IHVuZGVmaW5lZCBieSBkZWZhdWx0XG5cdFx0aWYgKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2R1bGUsIFwibG9hZGVkXCIsIHtcblx0XHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gbW9kdWxlLmw7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJpZFwiLCB7XG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIG1vZHVsZS5pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xuXHR9XG5cdHJldHVybiBtb2R1bGU7XG59O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgd2luZG93ID0gcmVxdWlyZShcImdsb2JhbC93aW5kb3dcIilcbnZhciBpc0Z1bmN0aW9uID0gcmVxdWlyZShcImlzLWZ1bmN0aW9uXCIpXG52YXIgcGFyc2VIZWFkZXJzID0gcmVxdWlyZShcInBhcnNlLWhlYWRlcnNcIilcbnZhciB4dGVuZCA9IHJlcXVpcmUoXCJ4dGVuZFwiKVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZVhIUlxuLy8gQWxsb3cgdXNlIG9mIGRlZmF1bHQgaW1wb3J0IHN5bnRheCBpbiBUeXBlU2NyaXB0XG5tb2R1bGUuZXhwb3J0cy5kZWZhdWx0ID0gY3JlYXRlWEhSO1xuY3JlYXRlWEhSLlhNTEh0dHBSZXF1ZXN0ID0gd2luZG93LlhNTEh0dHBSZXF1ZXN0IHx8IG5vb3BcbmNyZWF0ZVhIUi5YRG9tYWluUmVxdWVzdCA9IFwid2l0aENyZWRlbnRpYWxzXCIgaW4gKG5ldyBjcmVhdGVYSFIuWE1MSHR0cFJlcXVlc3QoKSkgPyBjcmVhdGVYSFIuWE1MSHR0cFJlcXVlc3QgOiB3aW5kb3cuWERvbWFpblJlcXVlc3RcblxuZm9yRWFjaEFycmF5KFtcImdldFwiLCBcInB1dFwiLCBcInBvc3RcIiwgXCJwYXRjaFwiLCBcImhlYWRcIiwgXCJkZWxldGVcIl0sIGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgIGNyZWF0ZVhIUlttZXRob2QgPT09IFwiZGVsZXRlXCIgPyBcImRlbFwiIDogbWV0aG9kXSA9IGZ1bmN0aW9uKHVyaSwgb3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICAgICAgb3B0aW9ucyA9IGluaXRQYXJhbXModXJpLCBvcHRpb25zLCBjYWxsYmFjaylcbiAgICAgICAgb3B0aW9ucy5tZXRob2QgPSBtZXRob2QudG9VcHBlckNhc2UoKVxuICAgICAgICByZXR1cm4gX2NyZWF0ZVhIUihvcHRpb25zKVxuICAgIH1cbn0pXG5cbmZ1bmN0aW9uIGZvckVhY2hBcnJheShhcnJheSwgaXRlcmF0b3IpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGl0ZXJhdG9yKGFycmF5W2ldKVxuICAgIH1cbn1cblxuZnVuY3Rpb24gaXNFbXB0eShvYmope1xuICAgIGZvcih2YXIgaSBpbiBvYmope1xuICAgICAgICBpZihvYmouaGFzT3duUHJvcGVydHkoaSkpIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZVxufVxuXG5mdW5jdGlvbiBpbml0UGFyYW1zKHVyaSwgb3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICB2YXIgcGFyYW1zID0gdXJpXG5cbiAgICBpZiAoaXNGdW5jdGlvbihvcHRpb25zKSkge1xuICAgICAgICBjYWxsYmFjayA9IG9wdGlvbnNcbiAgICAgICAgaWYgKHR5cGVvZiB1cmkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHBhcmFtcyA9IHt1cmk6dXJpfVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcGFyYW1zID0geHRlbmQob3B0aW9ucywge3VyaTogdXJpfSlcbiAgICB9XG5cbiAgICBwYXJhbXMuY2FsbGJhY2sgPSBjYWxsYmFja1xuICAgIHJldHVybiBwYXJhbXNcbn1cblxuZnVuY3Rpb24gY3JlYXRlWEhSKHVyaSwgb3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICBvcHRpb25zID0gaW5pdFBhcmFtcyh1cmksIG9wdGlvbnMsIGNhbGxiYWNrKVxuICAgIHJldHVybiBfY3JlYXRlWEhSKG9wdGlvbnMpXG59XG5cbmZ1bmN0aW9uIF9jcmVhdGVYSFIob3B0aW9ucykge1xuICAgIGlmKHR5cGVvZiBvcHRpb25zLmNhbGxiYWNrID09PSBcInVuZGVmaW5lZFwiKXtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY2FsbGJhY2sgYXJndW1lbnQgbWlzc2luZ1wiKVxuICAgIH1cblxuICAgIHZhciBjYWxsZWQgPSBmYWxzZVxuICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIGNiT25jZShlcnIsIHJlc3BvbnNlLCBib2R5KXtcbiAgICAgICAgaWYoIWNhbGxlZCl7XG4gICAgICAgICAgICBjYWxsZWQgPSB0cnVlXG4gICAgICAgICAgICBvcHRpb25zLmNhbGxiYWNrKGVyciwgcmVzcG9uc2UsIGJvZHkpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWFkeXN0YXRlY2hhbmdlKCkge1xuICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQobG9hZEZ1bmMsIDApXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRCb2R5KCkge1xuICAgICAgICAvLyBDaHJvbWUgd2l0aCByZXF1ZXN0VHlwZT1ibG9iIHRocm93cyBlcnJvcnMgYXJyb3VuZCB3aGVuIGV2ZW4gdGVzdGluZyBhY2Nlc3MgdG8gcmVzcG9uc2VUZXh0XG4gICAgICAgIHZhciBib2R5ID0gdW5kZWZpbmVkXG5cbiAgICAgICAgaWYgKHhoci5yZXNwb25zZSkge1xuICAgICAgICAgICAgYm9keSA9IHhoci5yZXNwb25zZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYm9keSA9IHhoci5yZXNwb25zZVRleHQgfHwgZ2V0WG1sKHhocilcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc0pzb24pIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYm9keSA9IEpTT04ucGFyc2UoYm9keSlcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYm9keVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVycm9yRnVuYyhldnQpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRUaW1lcilcbiAgICAgICAgaWYoIShldnQgaW5zdGFuY2VvZiBFcnJvcikpe1xuICAgICAgICAgICAgZXZ0ID0gbmV3IEVycm9yKFwiXCIgKyAoZXZ0IHx8IFwiVW5rbm93biBYTUxIdHRwUmVxdWVzdCBFcnJvclwiKSApXG4gICAgICAgIH1cbiAgICAgICAgZXZ0LnN0YXR1c0NvZGUgPSAwXG4gICAgICAgIHJldHVybiBjYWxsYmFjayhldnQsIGZhaWx1cmVSZXNwb25zZSlcbiAgICB9XG5cbiAgICAvLyB3aWxsIGxvYWQgdGhlIGRhdGEgJiBwcm9jZXNzIHRoZSByZXNwb25zZSBpbiBhIHNwZWNpYWwgcmVzcG9uc2Ugb2JqZWN0XG4gICAgZnVuY3Rpb24gbG9hZEZ1bmMoKSB7XG4gICAgICAgIGlmIChhYm9ydGVkKSByZXR1cm5cbiAgICAgICAgdmFyIHN0YXR1c1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dFRpbWVyKVxuICAgICAgICBpZihvcHRpb25zLnVzZVhEUiAmJiB4aHIuc3RhdHVzPT09dW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvL0lFOCBDT1JTIEdFVCBzdWNjZXNzZnVsIHJlc3BvbnNlIGRvZXNuJ3QgaGF2ZSBhIHN0YXR1cyBmaWVsZCwgYnV0IGJvZHkgaXMgZmluZVxuICAgICAgICAgICAgc3RhdHVzID0gMjAwXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdGF0dXMgPSAoeGhyLnN0YXR1cyA9PT0gMTIyMyA/IDIwNCA6IHhoci5zdGF0dXMpXG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3BvbnNlID0gZmFpbHVyZVJlc3BvbnNlXG4gICAgICAgIHZhciBlcnIgPSBudWxsXG5cbiAgICAgICAgaWYgKHN0YXR1cyAhPT0gMCl7XG4gICAgICAgICAgICByZXNwb25zZSA9IHtcbiAgICAgICAgICAgICAgICBib2R5OiBnZXRCb2R5KCksXG4gICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogc3RhdHVzLFxuICAgICAgICAgICAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgICAgICAgICAgIHVybDogdXJpLFxuICAgICAgICAgICAgICAgIHJhd1JlcXVlc3Q6IHhoclxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycyl7IC8vcmVtZW1iZXIgeGhyIGNhbiBpbiBmYWN0IGJlIFhEUiBmb3IgQ09SUyBpbiBJRVxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLmhlYWRlcnMgPSBwYXJzZUhlYWRlcnMoeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXJyID0gbmV3IEVycm9yKFwiSW50ZXJuYWwgWE1MSHR0cFJlcXVlc3QgRXJyb3JcIilcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2FsbGJhY2soZXJyLCByZXNwb25zZSwgcmVzcG9uc2UuYm9keSlcbiAgICB9XG5cbiAgICB2YXIgeGhyID0gb3B0aW9ucy54aHIgfHwgbnVsbFxuXG4gICAgaWYgKCF4aHIpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuY29ycyB8fCBvcHRpb25zLnVzZVhEUikge1xuICAgICAgICAgICAgeGhyID0gbmV3IGNyZWF0ZVhIUi5YRG9tYWluUmVxdWVzdCgpXG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgeGhyID0gbmV3IGNyZWF0ZVhIUi5YTUxIdHRwUmVxdWVzdCgpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIga2V5XG4gICAgdmFyIGFib3J0ZWRcbiAgICB2YXIgdXJpID0geGhyLnVybCA9IG9wdGlvbnMudXJpIHx8IG9wdGlvbnMudXJsXG4gICAgdmFyIG1ldGhvZCA9IHhoci5tZXRob2QgPSBvcHRpb25zLm1ldGhvZCB8fCBcIkdFVFwiXG4gICAgdmFyIGJvZHkgPSBvcHRpb25zLmJvZHkgfHwgb3B0aW9ucy5kYXRhXG4gICAgdmFyIGhlYWRlcnMgPSB4aHIuaGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycyB8fCB7fVxuICAgIHZhciBzeW5jID0gISFvcHRpb25zLnN5bmNcbiAgICB2YXIgaXNKc29uID0gZmFsc2VcbiAgICB2YXIgdGltZW91dFRpbWVyXG4gICAgdmFyIGZhaWx1cmVSZXNwb25zZSA9IHtcbiAgICAgICAgYm9keTogdW5kZWZpbmVkLFxuICAgICAgICBoZWFkZXJzOiB7fSxcbiAgICAgICAgc3RhdHVzQ29kZTogMCxcbiAgICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICAgIHVybDogdXJpLFxuICAgICAgICByYXdSZXF1ZXN0OiB4aHJcbiAgICB9XG5cbiAgICBpZiAoXCJqc29uXCIgaW4gb3B0aW9ucyAmJiBvcHRpb25zLmpzb24gIT09IGZhbHNlKSB7XG4gICAgICAgIGlzSnNvbiA9IHRydWVcbiAgICAgICAgaGVhZGVyc1tcImFjY2VwdFwiXSB8fCBoZWFkZXJzW1wiQWNjZXB0XCJdIHx8IChoZWFkZXJzW1wiQWNjZXB0XCJdID0gXCJhcHBsaWNhdGlvbi9qc29uXCIpIC8vRG9uJ3Qgb3ZlcnJpZGUgZXhpc3RpbmcgYWNjZXB0IGhlYWRlciBkZWNsYXJlZCBieSB1c2VyXG4gICAgICAgIGlmIChtZXRob2QgIT09IFwiR0VUXCIgJiYgbWV0aG9kICE9PSBcIkhFQURcIikge1xuICAgICAgICAgICAgaGVhZGVyc1tcImNvbnRlbnQtdHlwZVwiXSB8fCBoZWFkZXJzW1wiQ29udGVudC1UeXBlXCJdIHx8IChoZWFkZXJzW1wiQ29udGVudC1UeXBlXCJdID0gXCJhcHBsaWNhdGlvbi9qc29uXCIpIC8vRG9uJ3Qgb3ZlcnJpZGUgZXhpc3RpbmcgYWNjZXB0IGhlYWRlciBkZWNsYXJlZCBieSB1c2VyXG4gICAgICAgICAgICBib2R5ID0gSlNPTi5zdHJpbmdpZnkob3B0aW9ucy5qc29uID09PSB0cnVlID8gYm9keSA6IG9wdGlvbnMuanNvbilcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSByZWFkeXN0YXRlY2hhbmdlXG4gICAgeGhyLm9ubG9hZCA9IGxvYWRGdW5jXG4gICAgeGhyLm9uZXJyb3IgPSBlcnJvckZ1bmNcbiAgICAvLyBJRTkgbXVzdCBoYXZlIG9ucHJvZ3Jlc3MgYmUgc2V0IHRvIGEgdW5pcXVlIGZ1bmN0aW9uLlxuICAgIHhoci5vbnByb2dyZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBJRSBtdXN0IGRpZVxuICAgIH1cbiAgICB4aHIub25hYm9ydCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGFib3J0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICB4aHIub250aW1lb3V0ID0gZXJyb3JGdW5jXG4gICAgeGhyLm9wZW4obWV0aG9kLCB1cmksICFzeW5jLCBvcHRpb25zLnVzZXJuYW1lLCBvcHRpb25zLnBhc3N3b3JkKVxuICAgIC8vaGFzIHRvIGJlIGFmdGVyIG9wZW5cbiAgICBpZighc3luYykge1xuICAgICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gISFvcHRpb25zLndpdGhDcmVkZW50aWFsc1xuICAgIH1cbiAgICAvLyBDYW5ub3Qgc2V0IHRpbWVvdXQgd2l0aCBzeW5jIHJlcXVlc3RcbiAgICAvLyBub3Qgc2V0dGluZyB0aW1lb3V0IG9uIHRoZSB4aHIgb2JqZWN0LCBiZWNhdXNlIG9mIG9sZCB3ZWJraXRzIGV0Yy4gbm90IGhhbmRsaW5nIHRoYXQgY29ycmVjdGx5XG4gICAgLy8gYm90aCBucG0ncyByZXF1ZXN0IGFuZCBqcXVlcnkgMS54IHVzZSB0aGlzIGtpbmQgb2YgdGltZW91dCwgc28gdGhpcyBpcyBiZWluZyBjb25zaXN0ZW50XG4gICAgaWYgKCFzeW5jICYmIG9wdGlvbnMudGltZW91dCA+IDAgKSB7XG4gICAgICAgIHRpbWVvdXRUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmIChhYm9ydGVkKSByZXR1cm5cbiAgICAgICAgICAgIGFib3J0ZWQgPSB0cnVlLy9JRTkgbWF5IHN0aWxsIGNhbGwgcmVhZHlzdGF0ZWNoYW5nZVxuICAgICAgICAgICAgeGhyLmFib3J0KFwidGltZW91dFwiKVxuICAgICAgICAgICAgdmFyIGUgPSBuZXcgRXJyb3IoXCJYTUxIdHRwUmVxdWVzdCB0aW1lb3V0XCIpXG4gICAgICAgICAgICBlLmNvZGUgPSBcIkVUSU1FRE9VVFwiXG4gICAgICAgICAgICBlcnJvckZ1bmMoZSlcbiAgICAgICAgfSwgb3B0aW9ucy50aW1lb3V0IClcbiAgICB9XG5cbiAgICBpZiAoeGhyLnNldFJlcXVlc3RIZWFkZXIpIHtcbiAgICAgICAgZm9yKGtleSBpbiBoZWFkZXJzKXtcbiAgICAgICAgICAgIGlmKGhlYWRlcnMuaGFzT3duUHJvcGVydHkoa2V5KSl7XG4gICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCBoZWFkZXJzW2tleV0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMuaGVhZGVycyAmJiAhaXNFbXB0eShvcHRpb25zLmhlYWRlcnMpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkhlYWRlcnMgY2Fubm90IGJlIHNldCBvbiBhbiBYRG9tYWluUmVxdWVzdCBvYmplY3RcIilcbiAgICB9XG5cbiAgICBpZiAoXCJyZXNwb25zZVR5cGVcIiBpbiBvcHRpb25zKSB7XG4gICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSBvcHRpb25zLnJlc3BvbnNlVHlwZVxuICAgIH1cblxuICAgIGlmIChcImJlZm9yZVNlbmRcIiBpbiBvcHRpb25zICYmXG4gICAgICAgIHR5cGVvZiBvcHRpb25zLmJlZm9yZVNlbmQgPT09IFwiZnVuY3Rpb25cIlxuICAgICkge1xuICAgICAgICBvcHRpb25zLmJlZm9yZVNlbmQoeGhyKVxuICAgIH1cblxuICAgIC8vIE1pY3Jvc29mdCBFZGdlIGJyb3dzZXIgc2VuZHMgXCJ1bmRlZmluZWRcIiB3aGVuIHNlbmQgaXMgY2FsbGVkIHdpdGggdW5kZWZpbmVkIHZhbHVlLlxuICAgIC8vIFhNTEh0dHBSZXF1ZXN0IHNwZWMgc2F5cyB0byBwYXNzIG51bGwgYXMgYm9keSB0byBpbmRpY2F0ZSBubyBib2R5XG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9uYXVndHVyL3hoci9pc3N1ZXMvMTAwLlxuICAgIHhoci5zZW5kKGJvZHkgfHwgbnVsbClcblxuICAgIHJldHVybiB4aHJcblxuXG59XG5cbmZ1bmN0aW9uIGdldFhtbCh4aHIpIHtcbiAgICAvLyB4aHIucmVzcG9uc2VYTUwgd2lsbCB0aHJvdyBFeGNlcHRpb24gXCJJbnZhbGlkU3RhdGVFcnJvclwiIG9yIFwiRE9NRXhjZXB0aW9uXCJcbiAgICAvLyBTZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1hNTEh0dHBSZXF1ZXN0L3Jlc3BvbnNlWE1MLlxuICAgIHRyeSB7XG4gICAgICAgIGlmICh4aHIucmVzcG9uc2VUeXBlID09PSBcImRvY3VtZW50XCIpIHtcbiAgICAgICAgICAgIHJldHVybiB4aHIucmVzcG9uc2VYTUxcbiAgICAgICAgfVxuICAgICAgICB2YXIgZmlyZWZveEJ1Z1Rha2VuRWZmZWN0ID0geGhyLnJlc3BvbnNlWE1MICYmIHhoci5yZXNwb25zZVhNTC5kb2N1bWVudEVsZW1lbnQubm9kZU5hbWUgPT09IFwicGFyc2VyZXJyb3JcIlxuICAgICAgICBpZiAoeGhyLnJlc3BvbnNlVHlwZSA9PT0gXCJcIiAmJiAhZmlyZWZveEJ1Z1Rha2VuRWZmZWN0KSB7XG4gICAgICAgICAgICByZXR1cm4geGhyLnJlc3BvbnNlWE1MXG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7fVxuXG4gICAgcmV0dXJuIG51bGxcbn1cblxuZnVuY3Rpb24gbm9vcCgpIHt9XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGV4dGVuZFxuXG52YXIgaGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuXG5mdW5jdGlvbiBleHRlbmQoKSB7XG4gICAgdmFyIHRhcmdldCA9IHt9XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldXG5cbiAgICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRhcmdldFxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==